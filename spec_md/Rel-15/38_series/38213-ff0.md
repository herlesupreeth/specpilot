3GPP TS 38.213 V15.15.0 (2022-06)

Technical Specification

3rd Generation Partnership Project;

Technical Specification Group Radio Access Network;

NR;\
Physical layer procedures for control

(Release 15)

![5G-logo\_175px](./media/image1.jpeg){width="1.325in"
height="0.9166666666666666in"}
![3GPP-logo\_web](./media/image2.png){width="1.775in"
height="1.0416666666666667in"}

The present document has been developed within the 3rd Generation
Partnership Project (3GPP ^TM^) and may be further elaborated for the
purposes of 3GPP..\
The present document has not been subject to any approval process by the
3GPP Organizational Partners and shall not be implemented.\
This Specification is provided for future development work within 3GPP
only. The Organizational Partners accept no liability for any use of
this Specification.\
Specifications and Reports for implementation of the 3GPP ^TM^ system
should be obtained via the 3GPP Organizational Partners\' Publications
Offices.

> Keywords
>
> 3GPP, New Radio, Layer 1
>
> ***3GPP***
>
> Postal address
>
> 3GPP support office address
>
> 650 Route des Lucioles - Sophia Antipolis
>
> Valbonne - FRANCE
>
> Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16
>
> Internet
>
> http://www.3gpp.org

***Copyright Notification***

No part may be reproduced except as authorized by written permission.\
The copyright and the foregoing restriction extend to reproduction in
all media.

© 2022, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI,
TTA, TTC).

All rights reserved.

UMTS™ is a Trade Mark of ETSI registered for the benefit of its members

3GPP™ is a Trade Mark of ETSI registered for the benefit of its Members
and of the 3GPP Organizational Partners\
LTE™ is a Trade Mark of ETSI registered for the benefit of its Members
and of the 3GPP Organizational Partners

GSM® and the GSM logo are registered and owned by the GSM Association

 Contents {#contents .TT}
========

Foreword 5

1 Scope 6

2 References 6

3 Definitions, symbols and abbreviations 6

3.1 Definitions 6

3.2 Symbols 6

3.3 Abbreviations 7

4 Synchronization procedures 9

4.1 Cell search 9

4.2 Transmission timing adjustments 10

4.3 Timing for secondary cell activation / deactivation 11

5 Radio link monitoring 12

6 Link recovery procedures 13

7 Uplink Power control 14

7.1 Physical uplink shared channel 14

7.1.1 UE behaviour 15

7.2 Physical uplink control channel 20

7.2.1 UE behaviour 20

7.3 Sounding reference signals 24

7.3.1 UE behaviour 25

7.4 Physical random access channel 27

7.5 Prioritizations for transmission power reductions 28

7.6 Dual connectivity 28

7.6.1 EN-DC 28

7.6.1A NE-DC 29

7.6.2 NR-DC 30

7.7 Power headroom report 30

7.7.1 Type 1 PH report 31

7.7.2 Type 2 PH report 32

7.7.3 Type 3 PH report 32

8 Random access procedure 33

8.1 Random access preamble 33

8.2 Random access response 35

8.3 PUSCH scheduled by RAR UL grant 37

8.4 PDSCH with UE contention resolution identity 38

9 UE procedure for reporting control information 38

9.1 HARQ-ACK codebook determination 40

9.1.1 CBG-based HARQ-ACK codebook determination 40

9.1.2 Type-1 HARQ-ACK codebook determination 40

9.1.2.1 Type-1 HARQ-ACK codebook in physical uplink control channel 41

9.1.2.2 Type-1 HARQ-ACK codebook in physical uplink shared channel 46

9.1.3 Type-2 HARQ-ACK codebook determination 46

9.1.3.1 Type-2 HARQ-ACK codebook in physical uplink control channel 46

9.1.3.2 Type-2 HARQ-ACK codebook in physical uplink shared channel 52

9.2 UCI reporting in physical uplink control channel 53

9.2.1 PUCCH Resource Sets 53

9.2.2 PUCCH Formats for UCI transmission 55

9.2.3 UE procedure for reporting HARQ-ACK 56

9.2.4 UE procedure for reporting SR 59

9.2.5 UE procedure for reporting multiple UCI types 59

9.2.5.1 UE procedure for multiplexing HARQ-ACK or CSI and SR in a PUCCH
64

9.2.5.2 UE procedure for multiplexing HARQ-ACK/SR/CSI in a PUCCH 65

9.2.6 PUCCH repetition procedure 68

9.3 UCI reporting in physical uplink shared channel 70

10 UE procedure for receiving control information 74

10.1 UE procedure for determining physical downlink control channel
assignment 75

10.2 PDCCH validation for DL SPS and UL grant Type 2 84

11 UE-group common signalling 84

11.1 Slot configuration 85

11.1.1 UE procedure for determining slot format 88

11.2 Interrupted transmission indication 93

11.3 Group TPC commands for PUCCH/PUSCH 94

11.4 SRS switching 95

12 Bandwidth part operation 95

13 UE procedure for monitoring Type0-PDCCH CSS sets 98

Annex A: Change history 108

 Foreword
========

This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).

The contents of the present document are subject to continuing work
within the TSG and may change following formal TSG approval. Should the
TSG modify the contents of the present document, it will be re-released
by the TSG with an identifying change of release date and an increase in
version number as follows:

Version x.y.z

where:

x the first digit:

1 presented to TSG for information;

2 presented to TSG for approval;

3 or greater indicates TSG approved document under change control.

y the second digit is incremented for all changes of substance, i.e.
technical enhancements, corrections, updates, etc.

z the third digit is incremented when editorial only changes have been
incorporated in the document.

 1 Scope
=======

The present document specifies and establishes the characteristics of
the physical layer procedures for control operations in 5G-NR.

2 References
============

The following documents contain provisions which, through reference in
this text, constitute provisions of the present document.

\[1\] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\"

\[2\] 3GPP TS 38.201: \"NR; Physical Layer -- General Description\"

\[3\] 3GPP TS 38.202: \"NR; Services provided by the physical layer\"

\[4\] 3GPP TS 38.211: \"NR; Physical channels and modulation\"

\[5\] 3GPP TS 38.212: \"NR; Multiplexing and channel coding\"

\[6\] 3GPP TS 38.214: \"NR; Physical layer procedures for data\"

\[7\] 3GPP TS 38.215: \"NR; Physical layer measurements\"

\[8-1\] 3GPP TS 38.101-1: \"NR; User Equipment (UE) radio transmission
and reception; Part 1: Range 1 Standalone\"

\[8-2\] 3GPP TS 38.101-2: \"NR; User Equipment (UE) radio transmission
and reception; Part 2: Range 2 Standalone\"

\[8-3\] 3GPP TS 38.101-3: \"NR; User Equipment (UE) radio transmission
and reception; Part 3: Range 1 and Range 2 Interworking operation with
other radios\"

\[9\] 3GPP TS 38.104: \"NR; Base Station (BS) radio transmission and
reception\"

\[10\] 3GPP TS 38.133: \"NR; Requirements for support of radio resource
management\"

\[11\] 3GPP TS 38.321: \"NR; Medium Access Control (MAC) protocol
specification\"

\[12\] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC); Protocol
specification\"

\[13\] 3GPP TS 36.213: \"Evolved Universal Terrestrial Radio Access
(E-UTRA); Physical layer procedures\"

\[14\] 3GPP TS 36.321: \"Evolved Universal Terrestrial Radio Access
(E-UTRA); Medium Access Control (MAC) protocol specification\"

3 Definitions, symbols and abbreviations
========================================

3.1 Definitions
---------------

For the purposes of the present document, the terms and definitions
given in \[1, TR 21.905\] and the following apply. A term defined in the
present document takes precedence over the definition of the same term,
if any, in \[1, TR 21.905\]. A parameter referenced in *italics* is
provided by higher layers.

3.2 Symbols
-----------

For the purposes of the present document, the following symbols apply:

3.3 Abbreviations
-----------------

For the purposes of the present document, the abbreviations given in
TR 21.905 \[1\] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in \[1, TR 21.905\].

BPRE Bits per resource element

BWP Bandwidth part

CB Code block

CBG Code block group

CCE Control channel element

CORESET Control resource set

CP Cyclic prefix

CRC Cyclic redundancy check

CSI Channel state information

CSS Common search space

DAI Downlink assignment index

DC Dual connectivity

DCI Downlink control information

DL Downlink

DL-SCH Downlink shared channel

EPRE Energy per resource element

EN-DC E-UTRA NR dual connectivity with MCG using E-UTRA and SCG using NR

FR1 Frequency range 1

FR2 Frequency range 2

GSCN Global synchronization channel number

HARQ-ACK Hybrid automatic repeat request acknowledgement

MCG Master cell group

MCS Modulation and coding scheme

NE-DC E-UTRA NR dual connectivity with MCG using NR and SCG using E-UTRA

NR-DC NR NR dual connectivity

PBCH Physical broadcast channel

PCell Primary cell

PDCCH Physical downlink control channel

PDSCH Physical downlink shared channel

PRACH Physical random access channel

PRB Physical resource block

PRG Physical resource block group

PSCell Primary secondary cell

PSS Primary synchronization signal

PUCCH Physical uplink control channel

PUCCH-SCell PUCCH SCell

PUSCH Physical uplink shared channel

QCL Quasi co-location

RB Resource block

RE Resource element

RLM Radio link monitoring

RRM Radio resource management

RS Reference signal

RSRP Reference signal received power

SCG Secondary cell group

SCS Subcarrier spacing

SFN System frame number

SLIV Start and length indicator value

SPS Semi-persistent scheduling

SR Scheduling request

SRI SRS resource indicator

SRS Sounding reference signal

SSS Secondary synchronization signal

TA Timing advance

TAG Timing advance group

TCI Transmission Configuration Indicator

UCI Uplink control information

UE User equipment

UL Uplink

UL-SCH Uplink shared channel

USS UE-specific search space

 4 Synchronization procedures
============================

4.1 Cell search
---------------

Cell search is the procedure for a UE to acquire time and frequency
synchronization with a cell and to detect the physical layer Cell ID of
the cell.

A UE receives the following synchronization signals (SS) in order to
perform cell search: the primary synchronization signal (PSS) and
secondary synchronization signal (SSS) as defined in \[4, TS 38.211\].

A UE assumes that reception occasions of a physical broadcast channel
(PBCH), PSS, and SSS are in consecutive symbols, as defined in \[4, TS
38.211\], and form a SS/PBCH block. The UE assumes that SSS, PBCH DM-RS,
and PBCH data have same EPRE. The UE may assume that the ratio of PSS
EPRE to SSS EPRE in a SS/PBCH block is either 0 dB or 3 dB. If the UE
has not been provided dedicated higher layer parameters, the UE may
assume that the ratio of PDCCH DMRS EPRE to SSS EPRE is within -8 dB and
8 dB when the UE monitors PDCCHs for a DCI format 1\_0 with CRC
scrambled by SI-RNTI, P-RNTI, or RA-RNTI.

For a half frame with SS/PBCH blocks, the first symbol indexes for
candidate SS/PBCH blocks are determined according to the SCS of SS/PBCH
blocks as follows, where index 0 corresponds to the first symbol of the
first slot in a half-frame.

\- Case A - 15 kHz SCS: the first symbols of the candidate SS/PBCH
blocks have indexes of . For carrier frequencies smaller than or equal
to 3 GHz, . For carrier frequencies within FR1 larger than 3 GHz, .

\- Case B - 30 kHz SCS: the first symbols of the candidate SS/PBCH
blocks have indexes . For carrier frequencies smaller than or equal to 3
GHz, . For carrier frequencies within FR1 larger than 3 GHz, .

\- Case C - 30 kHz SCS: the first symbols of the candidate SS/PBCH
blocks have indexes .

\- For paired spectrum operation

\- For carrier frequencies smaller than or equal to 3 GHz, . For carrier
frequencies within FR1 larger than 3 GHz, .

\- For unpaired spectrum operation

\- For carrier frequencies smaller than 1.88 GHz, . For carrier
frequencies within FR1 equal to or larger than 1.88 GHz, .

\- Case D - 120 kHz SCS: the first symbols of the candidate SS/PBCH
blocks have indexes . For carrier frequencies within FR2, .

\- Case E - 240 kHz SCS: the first symbols of the candidate SS/PBCH
blocks have indexes . For carrier frequencies within FR2, .

From the above cases, if the SCS of SS/PBCH blocks is not provided by
*ssbSubcarrierSpacing*, the applicable cases for a cell depend on a
respective frequency band, as provided in \[8-1, TS 38.101-1\] and
\[8-2, TS 38.101-2\]. A same case applies for all SS/PBCH blocks on the
cell. If a 30 kHz SS/PBCH block SCS is indicated by
*ssbSubcarrierSpacing*, Case B applies for frequency bands with only 15
kHz SS/PBCH block SCS as specified in \[8-1, TS 38.101-1\], and the case
specified for 30 kHz SS/PBCH block SCS in \[8-1, TS 38.101-1\] applies
for frequency bands with 30 kHz SS/PBCH block SCS or both 15 kHz and 30
kHz SS/PBCH block SCS as specified in \[8-1, TS 38.101-1\]. For a UE
configured to operate with carrier aggregation over a set of cells in a
frequency band of FR2 or with frequency-contiguous carrier aggregation
over a set of cells in a frequency band of FR1, if the UE is provided
SCS values by *ssbSubcarrierSpacing* for receptions of SS/PBCH blocks on
any cells from the set of cells, the UE expects the SCS values to be
same.

The candidate SS/PBCH blocks in a half frame are indexed in an ascending
order in time from 0 to . A UE determines the 2 LSB bits, for *,* or the
3 LSB bits, for *,* of a SS/PBCH block index per half frame from a
one-to-one mapping with an index of the DM-RS sequence transmitted in
the PBCH. For , the UE determines the 3 MSB bits of the SS/PBCH block
index per half frame from PBCH payload bits as described in \[5, TS
38.212\].

A UE can be provided per serving cell by *ssb-periodicityServingCell* a
periodicity of the half frames for reception of the SS/PBCH blocks for
the serving cell. If the UE is not configured a periodicity of the half
frames for receptions of the SS/PBCH blocks, the UE assumes a
periodicity of a half frame. A UE assumes that the periodicity is same
for all SS/PBCH blocks in the serving cell.

For initial cell selection, a UE may assume that half frames with
SS/PBCH blocks occur with a periodicity of 2 frames.

Upon detection of a SS/PBCH block, the UE determines from *MIB* that a
CORESET for Type0-PDCCH CSS set, as described in Clause 13, is present
if \[4, TS 38.211\] for FR1 or if for FR2. The UE determines from *MIB*
that a CORESET for Type0-PDCCH CSS set is not present if for FR1 or if
for FR2; the CORESET for Type0-PDCCH CSS set may be provided by
*PDCCH-ConfigCommon*.

For a serving cell without transmission of SS/PBCH blocks, a UE acquires
time and frequency synchronization with the serving cell based on
receptions of SS/PBCH blocks on the PCell, or on the PSCell, of the cell
group for the serving cell.

4.2 Transmission timing adjustments
-----------------------------------

A UE can be provided a value of a timing advance offset for a serving
cell by *n-TimingAdvanceOffset* for the serving cell. If the UE is not
provided *n-TimingAdvanceOffset* for a serving cell, the UE determines a
default value of the timing advance offset for the serving cell as
described in \[10, TS 38.133\].

If a UE is configured with two UL carriers for a serving cell, a same
timing advance offset value applies to both carriers.

Upon reception of a timing advance command for a TAG, the UE adjusts
uplink timing for PUSCH/SRS/PUCCH transmission on all the serving cells
in the TAG based on a value that the UE expects to be same for all the
serving cells in the TAG and based on the received timing advance
command where the uplink timing for PUSCH/SRS/PUCCH transmissions is the
same for all the serving cells in the TAG.

For a band with synchronous contiguous intra-band EN-DC in a band
combination with non-applicable maximum transmit timing difference
requirements as described in Note 1 of Table 7.5.3-1 of \[10, TS
38.133\], if the UE indicates *ul-TimingAlignmentEUTRA-NR* as
\'required\' and uplink transmission timing based on timing adjustment
indication for a TAG from MCG and a TAG from SCG are determined to be
different by the UE, the UE adjusts the transmission timing for
PUSCH/SRS/PUCCH transmission on all serving cells part of the band with
the synchronous contiguous intra-band EN-DC based on timing adjustment
indication for a TAG from a serving cell in MCG in the band. The UE is
not expected to transmit a PUSCH/SRS/PUCCH in one CG when the
PUSCH/SRS/PUCCH is overlapping in time, even partially, with random
access preamble transmitted in another CG.

For a SCS of kHz, the timing advance command for a TAG indicates the
change of the uplink timing relative to the current uplink timing for
the TAG in multiples of . The start timing of the random access preamble
is described in \[4, TS 38.211\].

In case of random access response, a timing advance command \[11, TS
38.321\], , for a TAG indicates values by index values of = 0, 1, 2,
\..., 3846, where an amount of the time alignment for the TAG with SCS
of kHz is . is defined in \[4, TS 38.211\] and is relative to the SCS of
the first uplink transmission from the UE after the reception of the
random access response.

In other cases, a timing advance command \[11, TS 38.321\], , for a TAG
indicates adjustment of a current value, , to the new value, , by index
values of = 0, 1, 2,\..., 63, where for a SCS of kHz, .

If a UE has multiple active UL BWPs, as described in Clause 12, in a
same TAG, including UL BWPs in two UL carriers of a serving cell, the
timing advance command value is relative to the largest SCS of the
multiple active UL BWPs. The applicable value for an UL BWP with lower
SCS may be rounded to align with the timing advance granularity for the
UL BWP with the lower SCS while satisfying the timing advance accuracy
requirements in \[10, TS38.133\].

Adjustment of an value by a positive or a negative amount indicates
advancing or delaying the uplink transmission timing for the TAG by a
corresponding amount, respectively.

For a timing advance command received on uplink slot and for a
transmission other than a PUSCH scheduled by a RAR UL grant as described
in Clause 8.3, the corresponding adjustment of the uplink transmission
timing applies from the beginning of uplink slot where , is a time
duration in msec of symbols corresponding to a PDSCH processing time for
UE processing capability 1 when additional PDSCH DM-RS is configured, is
a time duration in msec of symbols corresponding to a PUSCH preparation
time for UE processing capability 1 \[6, TS 38.214\], is the maximum
timing advance value in msec that can be provided by a TA command field
of 12 bits, is the number of slots per subframe, and is the subframe
duration of 1 msec. and are determined with respect to the minimum SCS
among the SCSs of all configured UL BWPs for all uplink carriers in the
TAG and of all configured DL BWPs for the corresponding downlink
carriers. For , the UE assumes \[6, TS 38.214\]. Slot and are determined
with respect to the minimum SCS among the SCSs of all configured UL BWPs
for all uplink carriers in the TAG. is determined with respect to the
minimum SCS among the SCSs of all configured UL BWPs for all uplink
carriers in the TAG and for all configured initial UL BWPs provided by
*initialUplinkBWP*. The uplink slot is the last slot among uplink
slot(s) overlapping with the slot(s) of PDSCH reception assuming
$T_{\text{TA}} = 0$, where the PDSCH provides the timing advance command
and $T_{\text{TA}}$ is defined in \[4, TS 38.211\].

If a UE changes an active UL BWP between a time of a timing advance
command reception and a time of applying a corresponding adjustment for
the uplink transmission timing, the UE determines the timing advance
command value based on the SCS of the new active UL BWP. If the UE
changes an active UL BWP after applying an adjustment for the uplink
transmission timing, the UE assumes a same absolute timing advance
command value before and after the active UL BWP change.

If the received downlink timing changes and is not compensated or is
only partly compensated by the uplink timing adjustment without timing
advance command as described in \[10, TS 38.133\], the UE changes
accordingly.

If two adjacent slots overlap due to a TA command, the latter slot is
reduced in duration relative to the former slot.

4.3 Timing for secondary cell activation / deactivation
-------------------------------------------------------

With reference to slots for PUCCH transmissions, when a UE receives in a
PDSCH an activation command \[11, TS 38.321\] for a secondary cell
ending in slot *n*, the UE applies the corresponding actions in \[11, TS
38.321\] no later than the minimum requirement defined in \[10, TS
38.133\] and no earlier than slot , except for the following:

\- the actions related to CSI reporting on a serving cell that is active
in slot

\- the actions related to the *sCellDeactivationTimer* associated with
the secondary cell \[11, TS 38.321\] that the UE applies in slot

\- the actions related to CSI reporting on a serving cell which is not
active in slot that the UE applies in the earliest slot after in which
the serving cell is active.

The value of is where is a number of slots for a PUCCH transmission with
HARQ-ACK information for the PDSCH reception and is indicated by the
PDSCH-to-HARQ\_feedback timing indicator field in the DCI format
scheduling the PDSCH reception as described in Clause 9.2.3 and is a
number of slots per subframe for the SCS configuration of the PUCCH
transmission.

With reference to slots for PUCCH transmissions, if a UE receives a
deactivation command \[11, TS 38.321\] for a secondary cell ending in
slot , the UE applies the corresponding actions in \[11, TS 38.321\] no
later than the minimum requirement defined in \[10, TS 38.133\]*,
except* for the actions related to CSI reporting on an activated serving
cell which the UE applies in slot *.*

If *the sCellDeactivationTimer associated with the secondary cell
expires* in slot , the UE applies the corresponding actions in \[11, TS
38.321\] no later than the minimum requirement defined in \[10, TS
38.133\]*, except* for the actions related to CSI reporting on an
activated serving cell which the UE applies in the first slot that is
after slot where is the SCS configuration for PDSCH reception on the
secondary cell.

5 Radio link monitoring
=======================

The downlink radio link quality of the primary cell is monitored by a UE
for the purpose of indicating out-of-sync/in-sync status to higher
layers. The UE is not required to monitor the downlink radio link
quality in DL BWPs other than the active DL BWP, as described in Clause
12, on the primary cell. If the active DL BWP is the initial DL BWP and
for SS/PBCH block and CORESET multiplexing pattern 2 or 3, as described
in Clause 13, the UE is expected to perform RLM using the associated
SS/PBCH block when the associated SS/PBCH block index is provided by
*RadioLinkMonitoringRS*.

If the UE is configured with a SCG, as described in \[12, TS 38.331\],
and the parameter *rlf-TimersAndConstants* is provided by higher layers
and is not set to release, the downlink radio link quality of the PSCell
of the SCG is monitored by the UE for the purpose of indicating
out-of-sync/in-sync status to higher layers. The UE is not required to
monitor the downlink radio link quality in DL BWPs other than the active
DL BWP on the PSCell.

A UE can be configured for each DL BWP of a SpCell \[11, TS 38.321\]
with a set of resource indexes, through a corresponding set of
*RadioLinkMonitoringRS*, for radio link monitoring by
*failureDetectionResources*. The UE is provided either a CSI-RS resource
configuration index, by *csi-RS-Index*, or a SS/PBCH block index, by
*ssb-Index*. The UE can be configured with up to *RadioLinkMonitoringRS*
for link recovery procedures, as decribed in Clause 6, and for radio
link monitoring. From the *RadioLinkMonitoringRS*, up to
*RadioLinkMonitoringRS* can be used for radio link monitoring depending
on a maximum number of candidate SS/PBCH blocks per half frame as
described in Clause 4.1, and up to two *RadioLinkMonitoringRS* can be
used for link recovery procedures.

If the UE is not provided *RadioLinkMonitoringRS and the UE is provided
for PDCCH receptions TCI states that include one or more of a CSI-RS*

\- the UE uses for radio link monitoring the RS provided for the active
TCI state for PDCCH *reception* if the active TCI state for PDCCH
reception includes only one RS

\- if the active TCI state for PDCCH reception includes two RS, the UE
expects that one RS has QCL-TypeD \[6, TS 38.214\] and the UE uses the
RS with QCL-TypeD for radio link monitoring; the UE does not expect both
RS to have QCL-TypeD

\- the UE is not required to use for radio link monitoring an aperiodic
or semi-persistent RS

\- For , the UE selects the RS provided for active TCI states for PDCCH
receptions in CORESETs associated with the search space sets in an order
from the shortest monitoring periodicity. If more than one CORESETs are
associated with search space sets having same monitoring periodicity,
the UE determines the order of the CORESET from the highest CORESET
index as described in Clause 10.1.

A UE does not expect to use more than *RadioLinkMonitoringRS* for radio
link monitoring when the UE is not provided *RadioLinkMonitoringRS*.

Values of and for different values of are given in Table 5-1.

Table 5-1: and as a function of *maximum number of SS/PBCH blocks per
half frame*

  ---- --- ---
  4    2   2
  8    6   4
  64   8   8
  ---- --- ---

For a CSI-RS resource configuration, *powerControlOffsetSS* is not
applicable and a UE expects to be provided only \'noCDM\' from
*cdm-Type,* only \'one\' and \'three\' from *density*, and only \'1
port\' from *nrofPorts* \[6, TS 38.214\].

If a UE is configured with multiple DL BWPs for a serving cell, the UE
performs RLM using the RS(s) corresponding to resource indexes provided
by *RadioLinkMonitoringRS* for the active DL BWP or, if
*RadioLinkMonitoringRS* is not provided for the active DL BWP, using the
RS(s) provided *for the active TCI state for PDCCH receptions* in
CORESETs on the active DL BWP.

In non-DRX mode operation, the physical layer in the UE assesses once
per indication period the radio link quality, evaluated over the
previous time period defined in \[10, TS 38.133\] against thresholds
(Q~out~ and Q~in~) configured by *rlmInSyncOutOfSyncThreshold*. The UE
determines the indication period as the maximum between the shortest
periodicity for radio link monitoring resources *and 10 msec.*

In DRX mode operation, the physical layer in the UE assesses once per
indication period the radio link quality, evaluated over the previous
time period defined in \[10, TS 38.133\], against thresholds (Q~out~ and
Q~in~) provided by *rlmInSyncOutOfSyncThreshold*. The UE determines the
indication period as the maximum between the shortest periodicity for
radio link monitoring resources *and the DRX period.*

The physical layer in the UE indicates, in frames where the radio link
quality is assessed, out-of-sync to higher layers when the radio link
quality is worse than the threshold Q~out~ for all resources in the set
of resources for radio link monitoring. When the radio link quality is
better than the threshold Q~in~ for any resource in the set of resources
for radio link monitoring, the physical layer in the UE indicates, in
frames where the radio link quality is assessed, in-sync to higher
layers.

6 Link recovery procedures
==========================

A UE can be provided, for each BWP of a serving cell, a set *of periodic
CSI-RS resource configuration indexes by failureDetectionResources and*
a set of periodic CSI-RS resource configuration indexes and/or SS/PBCH
block indexes by *candidateBeamRSList* for radio link quality
measurements on the BWP of the serving cell. If the UE is not provided
*failureDetectionResources, the UE determines the set to include
periodic CSI-RS resource configuration indexes with same values as the
RS indexes in the RS sets indicated by* *TCI-State* for respective
CORESETs that the UE uses for monitoring PDCCH and, if there are two RS
indexes in a TCI state, the set includes RS indexes with QCL-TypeD
configuration for the corresponding TCI states. The UE expects the set
to include up to two RS indexes. The UE expects single port RS in the
*set .*

The thresholds Q~out,LR~ and Q~in,LR~ correspond to the default value of
*rlmInSyncOutOfSyncThreshold*, as described in \[10, TS 38.133\] for
Q~out~, and to the value provided by *rsrp-ThresholdSSB*, respectively.

The physical layer in the UE assesses the radio link quality according
to the set of resource configurations against the threshold Q~out,LR~.
For the set *, the UE* assesses the radio link quality only according to
periodic *CSI-RS resource configurations or SS/PBCH blocks that* are
quasi co-located, as described in \[6, TS 38.214\], with the DM-RS of
PDCCH receptions monitored by the UE. The UE applies the Q~in,LR~
threshold to the L1-RSRP measurement obtained from a SS/PBCH block. The
UE applies the Q~in,LR~ threshold to the L1-RSRP measurement obtained
for a CSI-RS resource after scaling a respective CSI-RS reception power
with a value provided by *powerControlOffsetSS*.

In non-DRX mode operation, the physical layer in the UE provides an
indication to higher layers when the radio link quality for all
corresponding resource configurations in the set *that the UE uses to
assess the radio link quality* is worse than the threshold Q~out,LR~.
The physical layer informs the higher layers when the *radio link
quality* is worse than the threshold Q~out,LR~ with a periodicity
determined by the maximum between the shortest periodicity among the
periodic CSI-RS configurations and/or SS/PBCH blocks in the set *that
the UE uses to assess the radio link quality and 2 msec. In DRX mode
operation, the physical layer* provides an indication to higher layers
*when the radio link quality is worse than the threshold Q~out,LR~ with
a periodicity determined as described in \[10, TS 38.133\].*

Upon request from higher layers, the UE provides to higher layers the
periodic CSI-RS configuration indexes and/or SS/PBCH block indexes from
the set *and the corresponding L1-RSRP measurements that are larger than
or equal to the* Q~in,LR~ *threshold.*

A UE can be provided a CORESET through a link to a search space set
provided by *recoverySearchSpaceId,* as described in Clause 10.1, for
monitoring PDCCH in the CORESET. If the UE is provided
*recoverySearchSpaceId*, the UE does not expect to be provided another
search space set for monitoring PDCCH in the CORESET associated with the
search space set provided by *recoverySearchSpaceId*.

The UE may receive by *PRACH-ResourceDedicatedBFR*, a configuration for
PRACH transmission as described in Clause 8.1. For PRACH transmission in
slot and according to antenna port quasi co-location parameters
associated with periodic CSI-RS resource configuration or with SS/PBCH
block associated with index *provided by higher layers* \[11, TS
38.321\], the UE monitors PDCCH in a search space set provided by
*recoverySearchSpaceId* for detection of a DCI format with CRC scrambled
by C-RNTI or MCS-C-RNTI starting from slot within a window configured by
*BeamFailureRecoveryConfig. For PDCCH monitoring* in a search space set
provided by *recoverySearchSpaceId* *and for corresponding PDSCH
reception, the UE assumes the same antenna port quasi-collocation
parameters as the ones associated with* index *until the UE receives by
higher layers an activation for a TCI state or any of the parameters
tci-StatesPDCCH-ToAddList and/or tci-StatesPDCCH-ToReleaseList.* After
the UE detects a DCI format with CRC scrambled by C-RNTI or MCS-C-RNTI
in the search space set provided by *recoverySearchSpaceId*, the UE
continues to monitor PDCCH candidates in the search space set provided
by *recoverySearchSpaceId* until the UE receives a MAC CE activation
command for a TCI state or *tci-StatesPDCCH-ToAddList and/or
tci-StatesPDCCH-ToReleaseList.*

*After 28 symbols from a last symbol of* a first PDCCH reception in a
search space set provided by *recoverySearchSpaceId* for which the UE
detects a DCI format with CRC scrambled by C-RNTI or MCS-C-RNTI *and*
until the UE receives an activation command for
*PUCCH-SpatialRelationInfo* \[11, TS 38.321\] or is provided
*PUCCH-SpatialRelationInfo* for PUCCH resource(s), t*he UE transmits a
PUCCH on a same cell as the PRACH transmission using*

\- *a* same spatial filter as for the last PRACH transmission

\- *a* power determined as described in Clause 7.2.1 with , , and

*After 28 symbols from a last symbol of a first PDCCH reception in a
search space set provided by recoverySearchSpaceId where a UE detects a
DCI format with CRC scrambled by C-RNTI or MCS-C-RNTI, the UE assumes
same antenna port quasi-collocation parameters as the ones associated
with index for PDCCH monitoring in a CORESET with index 0.*

7 Uplink Power control
======================

Uplink power control determines a power for PUSCH, PUCCH, SRS, and PRACH
transmissions.

*A UE does not expect to simultaneously maintain more than four pathloss
estimates per serving cell for all PUSCH/PUCCH/SRS transmissions as
described in Clauses 7.1.1, 7.2.1, and 7.3.1.*

*A PUSCH/PUCCH/SRS/PRACH transmission occasion is defined by a* slot
index within a frame with system frame number , a first symbol within
the slot, and a number of consecutive symbols .

7.1 Physical uplink shared channel
----------------------------------

For a PUSCH transmission on active UL BWP *, as described in Clause 12,
of* carrier *of* serving cell *,* a UE first calculates a linear value
*of the* transmit power *, with parameters as defined in Clause 7.1.1.
For a* PUSCH transmission scheduled by a DCI format 0\_1 or configured
by *ConfiguredGrantConfig* or *semiPersistentOnPUSCH*, if *txConfig* in
*PUSCH-Config* is set to \'codebook\' and each SRS resource in the
*SRS-ResourceSet* with *usage* set to \'codebook\' has more than one SRS
port*, the UE scales the linear value* by the ratio of the number of
antenna ports with a non-zero PUSCH transmission power to the maximum
number of SRS ports supported by the UE in one SRS resource. The UE
splits the power equally across the antenna ports on which the UE
transmits the PUSCH with non-zero power.

### 7.1.1 UE behaviour

If a UE transmits a PUSCH on active UL BWP *of* carrier *of* serving
cell *using* parameter set configuration *with index and* PUSCH power
control adjustment state with index , the UE determines the PUSCH
transmission power in PUSCH transmission occasion as

\[dBm\]

where,

\- is the UE configured maximum output power defined in \[8-1, TS
38.101-1\], \[8-2, TS38.101-2\] and \[8-3, TS38.101-3\] for carrier *of*
serving cell in PUSCH transmission occasion .

\- is a parameter composed of the sum of a component and a component
where .

\- If a UE is not provided *P0-PUSCH-AlphaSet* or for a PUSCH
(re)transmission corresponding to a RAR UL grant as described in Clause
8.3, , , and , where the parameter *preambleReceivedTargetPower* \[11,
TS 38.321\] (for ) and *msg3-DeltaPreamble* (for ) are provided by
higher layers, or dB if *msg3-DeltaPreamble is not provided*, for
carrier *of* serving cell

\- For a PUSCH (re)transmission configured by *ConfiguredGrantConfig*, ,
is provided by *p0-NominalWithoutGrant*, or if *p0-NominalWithoutGrant*
is not provided, and is provided by *p0* obtained from *p0-PUSCH-Alpha*
in *ConfiguredGrantConfig* that provides an index *P0-PUSCH-AlphaSetId*
to a set of *P0-PUSCH-AlphaSet* for active UL BWP of carrier *of*
serving cell

\- For , a value, applicable for all , is provided by
*p0-NominalWithGrant,* or if *p0-NominalWithGrant* is not provided, for
each carrier *of* serving cell and a set of values are provided by a set
of *p0* in *P0-PUSCH-AlphaSet* indicated by a respective set of
*p0-PUSCH-AlphaSetId* for active UL BWP of carrier *of* serving cell

\- If the UE is provided by *SRI-PUSCH-PowerControl* more than one
values of *p0-PUSCH-AlphaSetId* and if DCI format 0\_1 includes a SRI
field, the UE obtains a mapping from *sri-PUSCH-PowerControlId* in
*SRI-PUSCH-PowerControl* between a set of values for the SRI field in
DCI format 0\_1 \[5, TS 38.212\] and a set of indexes provided by
*p0-PUSCH-AlphaSetId* that map to a set of *P0-PUSCH-AlphaSet* values.
If the PUSCH transmission is scheduled by a DCI format 0\_1 that
includes a SRI field, the UE determines the value of from the
*p0-PUSCH-AlphaSetId* value that is mapped to the SRI field value

\- If the PUSCH transmission except for the PUSCH retransmission
corresponding to a RAR UL grant is scheduled by a DCI format 0\_0 or by
a DCI format 0\_1 that does not include a SRI field, or if
*SRI-PUSCHPowerControl* is not provided to the UE, , and the UE
determines from the value of the first *P0-PUSCH-AlphaSet* in
*p0-AlphaSets*

\- For

\- For , is a value of *msg3-Alpha*, when provided; otherwise,

\- For , is provided by *alpha* obtained from *p0-PUSCH-Alpha* in
*ConfiguredGrantConfig* providing an index *P0-PUSCH-AlphaSetId* to a
set of *P0-PUSCH-AlphaSet* for active UL BWP of carrier *of* serving
cell

\- For , a set of values are provided by a set of *alpha* in
*P0-PUSCH-AlphaSet* indicated by a respective set of
*p0-PUSCH-AlphaSetId* for active UL BWP of carrier *of* serving cell

\- If the UE is provided *SRI-PUSCH-PowerControl* and more than one
values of *p0-PUSCH-AlphaSetId*, and if DCI format 0\_1 includes a SRI
field, the UE obtains a mapping from *sri-PUSCH-PowerControlId* in
*SRI-PUSCH-PowerControl* between a set of values for the SRI field in
DCI format 0\_1 \[5, TS 38.212\] and a set of indexes provided by
*p0-PUSCH-AlphaSetId* that map to a set of *P0-PUSCH-AlphaSet* values.
If the PUSCH transmission is scheduled by a DCI format 0\_1 that
includes a SRI field, the UE determines the values of from the
*p0-PUSCH-AlphaSetId* value that is mapped to the SRI field value

\- If the PUSCH transmission except for the PUSCH retransmission
corresponding to a RAR UL grant is scheduled by a DCI format 0\_0 or by
a DCI format 0\_1 that does not include a SRI field, or if
*SRI-PUSCH-PowerControl* is not provided to the UE, , and the UE
determines from the value of the first *P0-PUSCH-AlphaSet* in
*p0-AlphaSets*

\- is the bandwidth of the PUSCH resource assignment expressed in number
of resource blocks for PUSCH transmission occasion on active UL BWP of
carrier *of* serving cell and is a SCS configuration defined in \[4, TS
38.211\]

\- is a downlink pathloss estimate in dB calculated by the UE using
reference signal (RS) index
![](./media/image127.wmf){width="0.18680555555555556in"
height="0.21944444444444444in"} for the active DL BWP, as described in
Clause 12, *of carrier of* serving cell

\- If the UE is not provided *PUSCH-PathlossReferenceRS* or before the
UE is provided dedicated higher layer parameters*, the UE calculates*
*using a RS resource from the SS/PBCH block that the UE uses to obtain
MIB*

\- If the UE is configured with a number of RS resource indexes, up to
the value of *maxNrofPUSCH-PathlossReferenceRSs*, and a respective set
of RS configurations for the number of RS resource indexes by
*PUSCH-PathlossReferenceRS*, the set of RS resource indexes can include
one or both of a set of SS/PBCH block indexes, each provided by
*ssb-Index* when a value of a corresponding
*pusch-PathlossReferenceRS-Id* maps to a SS/PBCH block index, and a set
of CSI-RS resource indexes, each provided by *csi-RS-Index* when a value
of a corresponding *pusch-PathlossReferenceRS-Id* maps to a CSI-RS
resource index*.* The UE identifies a RS resource index in the set of RS
resource indexes to correspond either to a SS/PBCH block index or to a
CSI-RS resource index as provided by *pusch-PathlossReferenceRS-Id* in
*PUSCH-PathlossReferenceRS*

\- If the PUSCH transmission is scheduled by a RAR UL grant as described
in Clause 8.3*, the UE uses the same RS resource index* *as for a
corresponding PRACH transmission*

\- If the UE is provided *SRI-PUSCH-PowerControl* and more than one
values of *PUSCH-PathlossReferenceRS-Id*, the UE obtains a mapping from
*sri-PUSCH-PowerControlId* in *SRI-PUSCH-PowerControl* between a set of
values for the SRI field in DCI format 0\_1 and a set of
*PUSCH-PathlossReferenceRS-Id* values. If the PUSCH transmission is
scheduled by a DCI format 0\_1 that includes a SRI field, the UE
determines the RS resource index from the value of
*PUSCH-PathlossReferenceRS-Id* that is mapped to the SRI field value
where the RS resource is either on serving cell or, if provided, on a
serving cell indicated by a value of *pathlossReferenceLinking*

\- If the PUSCH transmission is scheduled by a DCI format 0\_0, and if
the UE is provided a spatial setting by *PUCCH-SpatialRelationInfo* for
a PUCCH resource with a lowest index for active UL BWP of each carrier
*and* serving cell , as described in Clause 9.2.2, *the UE uses the same
RS resource index* *as for a PUCCH transmission in the PUCCH resource
with the lowest index*

\- If the PUSCH transmission is scheduled by a DCI format 0\_0 and if
the UE is not provided a spatial setting for a PUCCH transmission, or by
a DCI format 0\_1 that does not include a SRI field, or if
*SRI-PUSCH-PowerControl* is not provided to the UE, the UE determines a
RS resource index with a respective *PUSCH-PathlossReferenceRS-Id* value
being equal to zero where the RS resource is either on serving cell or,
if provided, on a serving cell indicated by a value of
*pathlossReferenceLinking*

\- For a PUSCH transmission configured by *ConfiguredGrantConfig,* if
*rrc-ConfiguredUplinkGrant* is included in *ConfiguredGrantConfig* , a
RS resource index is provided by a value of *pathlossReferenceIndex*
included in *rrc-ConfiguredUplinkGrant* where the RS resource is either
on serving cell or, if provided, on a serving cell indicated by a value
of *pathlossReferenceLinking*

\- For a PUSCH transmission configured by *ConfiguredGrantConfig that
does not include* *rrc-ConfiguredUplinkGrant*, the UE determines a RS
resource index from a value of *PUSCH-PathlossReferenceRS-Id* that is
mapped to a SRI field value in a DCI format activating the PUSCH
transmission. If the DCI format activating the PUSCH transmission does
not include a SRI field, the UE determines a RS resource index with a
respective *PUSCH-PathlossReferenceRS-Id* value being equal to zero
where the RS resource is either on serving cell or, if provided, on a
serving cell indicated by a value of *pathlossReferenceLinking*

= *referenceSignalPower* -- higher layer filtered RSRP, where
*referenceSignalPower* is provided by higher layers and RSRP is defined
in \[7, TS 38.215\] for the reference serving cell and the higher layer
filter configuration provided by *QuantityConfig* is defined in \[12, TS
38.331\] for the reference serving cell

If the UE is not configured periodic CSI-RS reception,
*referenceSignalPower* is provided by *ss-PBCH-BlockPower*. If the UE is
configured periodic CSI-RS reception, *referenceSignalPower* is provided
either by *ss-PBCH-BlockPower* or by *powerControlOffsetSS* providing an
offset of the CSI-RS transmission power relative to the SS/PBCH block
transmission power \[6, TS 38.214\]. If *powerControlOffsetSS* is not
provided to the UE, the UE assumes an offset of 0 dB.

\- for and for where is provided by *deltaMCS* for each UL BWP of each
carrier *and* serving cell . If the PUSCH transmission is over more than
one layer \[6, TS 38.214\], . and , for active UL BWP of each carrier
*and* each serving cell , are computed as below

\- for PUSCH with UL-SCH data and for CSI transmission in a PUSCH
without UL-SCH data, where

\- is a number of transmitted code blocks, is a size for code block ,
and is a number of resource elements determined as , where is a number
of symbols for PUSCH transmission occasion on active UL BWP of carrier
*of* serving cell , is a number of subcarriers excluding DM-RS
subcarriers and phase-tracking RS samples \[4, TS 38.211\] in PUSCH
symbol , , and , are defined in \[5, TS 38.212\]

\- when the PUSCH includes UL-SCH data and , as described in Clause 9.3,
when the PUSCH includes CSI and does not include UL-SCH data

\- is the modulation order and is the target code rate, as described in
\[6, TS 38.214\], provided by the DCI format scheduling the PUSCH
transmission that includes CSI and does not include UL-SCH data

\- For the PUSCH power control adjustment state for active UL BWP of
carrier *of* serving cell in PUSCH transmission occasion

\- is a TPC command value included in a DCI format *0\_0 or DCI format
0\_1* *that schedules the PUSCH transmission* occasion *on* active UL
BWP of carrier *of* serving cell or jointly coded with other TPC
commands in a DCI format 2\_2 with CRC scrambled by TPC-PUSCH-RNTI, as
described in Clause 11.3

\- if the UE is configured with *twoPUSCH-PC-AdjustmentStates* and
![](./media/image157.wmf){width="0.3076388888888889in"
height="0.18680555555555556in"} if the UE is not configured with
*twoPUSCH-PC-AdjustmentStates* or if the PUSCH transmission is scheduled
by a RAR UL grant as described in Clause 8.3

\- For a PUSCH (re)transmission configured by *ConfiguredGrantConfig*,
the value of is provided to the UE by *powerControlLoopToUse*

\- If the UE is provided *SRI-PUSCH-PowerControl*, the UE obtains a
mapping between a set of values for the SRI field in DCI format 0\_1 and
the value(s) provided by *sri-PUSCH-ClosedLoopIndex*. If the PUSCH
transmission is scheduled by a DCI format 0\_1 and if DCI format 0\_1
includes a SRI field, the UE determines the value that is mapped to the
SRI field value

\- If the PUSCH transmission is scheduled by a DCI format 0\_0 or by a
DCI format 0\_1 that does not include a SRI field, or if a
*SRI-PUSCH-PowerControl* is not provided to the UE,

\- If the UE obtains one TPC command from a DCI format 2\_2 with CRC
scrambled by a TPC-PUSCH-RNTI, the value is provided by the closed loop
indicator field in DCI format 2\_2

\- is the PUSCH power control adjustment state for active UL BWP of
carrier *of* serving cell and PUSCH transmission occasion if the UE is
not provided *tpc-Accumulation*, where

\- The values are given in Table 7.1.1-1

\- is a sum of TPC command values in a set of TPC command values with
cardinality that the UE receives between symbols before PUSCH
transmission occasion and symbols before PUSCH transmission occasion on
active UL BWP of carrier *of* serving cell for PUSCH power control
adjustment state , where is the smallest integer for which symbols
before PUSCH transmission occasion is earlier than symbols before PUSCH
transmission occasion

\- If a PUSCH transmission is scheduled by a DCI format 0\_0 or DCI
format 0\_1, is a number of symbols for active UL BWP of carrier *of*
serving cell after a last symbol of a corresponding PDCCH reception and
before a first symbol of the PUSCH transmission

\- If a PUSCH transmission is configured by *ConfiguredGrantConfig*, is
a number of symbols equal to the product of a number of symbols per
slot, , and the minimum of the values provided by *k2* in
*PUSCH-ConfigCommon* for active UL BWP of carrier *of* serving cell

\- If the UE has reached maximum power for active UL BWP of carrier *of*
serving cell at PUSCH transmission occasion and , then

\- If UE has reached minimum power for active UL BWP of carrier *of*
serving cell at PUSCH transmission occasion and , then

\- A UE resets accumulation of a PUSCH power control adjustment state
for active UL BWP of carrier *of* serving cell to

\- If a configuration for a corresponding value is provided by higher
layers

\- If a configuration for a corresponding value is provided by higher
layers

where *is determined from* the value of as

\- If and the UE is provided higher *SRI-PUSCH-PowerControl*, is the
*sri-PUSCH-ClosedLoopIndex* value(s) configured in any
*SRI-PUSCH-PowerControl* with the *sri-P0-PUSCH-AlphaSetId* value
corresponding to

\- If and the UE is not provided *SRI-PUSCH-PowerControl* or $j = 0$,

\- If , is provided by the value of *powerControlLoopToUse*

\- is the PUSCH power control adjustment state for active UL BWP of
carrier *of* serving cell and PUSCH transmission occasion if the UE is
provided *tpc-Accumulation*, where

\- absolute values are given in Table 7.1.1-1

\- If the UE receives a random access response message in response to a
PRACH transmission on active UL BWP of carrier *of* serving cell as
described in Clause 8

\- , where and

\- is a TPC command value indicated in the random access response grant
of the random access response message corresponding to the PRACH
transmission on active UL BWP *of* carrier in the serving cell , and

\- and is provided by higher layers and corresponds to the total power
ramp-up requested by higher layers from the first to the last random
access preamble for carrier in the serving cell , is the bandwidth of
the PUSCH resource assignment expressed in number of resource blocks for
the first PUSCH transmission on active UL BWP of carrier of serving cell
, and ![](./media/image201.wmf){width="0.6923611111111111in"
height="0.21944444444444444in"} is the power adjustment of first PUSCH
transmission on active UL BWP of carrier of serving cell .

Table 7.1.1-1: Mapping of TPC Command Field in DCI format *0\_0, DCI
format 0\_1, or DCI format* 2\_2, with CRC scrambled by TPC-PUSCH-RNTI,
or DCI format 2\_3, to absolute and accumulated values or values

  TPC Command Field   Accumulated ![](./media/image204.wmf) or ![](./media/image205.wmf) \[dB\]   Absolute ![](./media/image206.wmf){width="0.6027777777777777in" height="0.22083333333333333in"} or ![](./media/image207.wmf){width="0.5in" height="0.22083333333333333in"} \[dB\]
  ------------------- --------------------------------------------------------------------------- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  0                   -1                                                                          -4
  1                   0                                                                           -1
  2                   1                                                                           1
  3                   3                                                                           4

7.2 Physical uplink control channel
-----------------------------------

If the UE is configured with a SCG, the UE shall apply the procedures
described in this clause for both MCG and SCG.

\- When the procedures are applied for MCG, the term \'serving cell\' in
this clause refers to serving cell belonging to the MCG.

\- When the procedures are applied for SCG, the term \'serving cell\' in
this clause refers to serving cell belonging to the SCG. The term
\'primary cell\' in this clause refers to the PSCell of the SCG.

If the UE is configured with a PUCCH-SCell, the UE shall apply the
procedures described in this clause for both primary PUCCH group and
secondary PUCCH group.

\- When the procedures are applied for the primary PUCCH group, the term
\'serving cell\' in this clause refers to serving cell belonging to the
primary PUCCH group.

\- When the procedures are applied for the secondary PUCCH group, the
term \'serving cell\' in this clause refers to serving cell belonging to
the secondary PUCCH group. The term \'primary cell\' in this clause
refers to the PUCCH-SCell of the secondary PUCCH group.

### 7.2.1 UE behaviour

If a UE transmits a PUCCH on active UL BWP of carrier in the primary
cell *using* PUCCH power control adjustment state with index , the UE
determines the PUCCH transmission power in PUCCH transmission occasion
as

\[dBm\]

where

\- is the UE configured maximum output power defined in \[8-1, TS
38.101-1\], \[8-2, TS38.101-2\] and \[8-3, TS38.101-3\] for carrier *of*
serving cell in PUCCH transmission occasion

\- is a parameter composed of the sum of a component , provided by
*p0-nominal*, or dBm if *p0-nominal* is not provided, for carrier of
primary cell and, if provided, a component provided by *p0-PUCCH-Value*
in *P0-PUCCH* for active UL BWP of carrier of primary cell , where . is
a size for a set of values provided by *maxNrofPUCCH-P0-PerSet*. The set
of values is provided by *p0-Set*. If *p0-Set* is not provided to the
UE, ,

\- If the UE is provided *PUCCH-SpatialRelationInfo*, the UE obtains a
mapping, by an index provided by *p0-PUCCH-Id*, between a set of
*pucch-SpatialRelationInfoId* values and a set of *p0-PUCCH-Value*
values. If the UE is provided more than one values for
*pucch-SpatialRelationInfoId* and the UE receives *an* activation
command \[11, TS 38.321\] indicating a value of
*pucch-SpatialRelationInfoId*, the UE determines the *p0-PUCCH-Value*
value through the link to a corresponding *p0-PUCCH-Id* index. The UE
applies the activation command in the first slot that is after slot
where is the slot where the UE would transmit a PUCCH with HARQ-ACK
information for the PDSCH providing the activation command and is the
SCS configuration for the PUCCH

\- If the UE is not provided *PUCCH-SpatialRelationInfo*, the UE obtains
the *p0-PUCCH-Value* value from the *P0-PUCCH* with *p0-PUCCH-Id* value
equal to the minimum *p0-PUCCH-Id* value in *p0-Set*

\- is a bandwidth of the PUCCH resource assignment expressed in number
of resource blocks for PUCCH transmission occasion on active UL BWP of
carrier *of* serving cell and is a SCS configuration defined in \[4, TS
38.211\]

\- is a downlink pathloss estimate in dB calculated by the UE using RS
resource index as described in Clause 7.1.1 for the active DL BWP of
carrier of the primary cell as described in Clause 12

\- If the UE is not provided *pathlossReferenceRSs* or before the UE is
provided dedicated higher layer parameters*, the UE calculates* using *a
RS resource obtained from the SS/PBCH block that the UE uses to obtain
MIB*

\- If the UE is provided a number of RS resource indexes, the UE
calculates using RS resource with index , where . is a size for a set of
RS resources provided by *maxNrofPUCCH-PathlossReferenceRSs*. The set of
RS resources is provided by *pathlossReferenceRSs*. The set of RS
resources can include one or both of a set of SS/PBCH block indexes,
each provided by *ssb-Index* in *PUCCH-PathlossReferenceRS* when a value
of a corresponding *pucch-PathlossReferenceRS-Id* maps to a SS/PBCH
block index, and a set of CSI-RS resource indexes, each provided by
*csi-RS-Index* when a value of a corresponding
*pucch-PathlossReferenceRS-Id* maps to a CSI-RS resource index. The UE
identifies a RS resource in the set of RS resources to correspond either
to a SS/PBCH block index or to a CSI-RS resource index as provided by
*pucch-PathlossReferenceRS-Id* in *PUCCH-PathlossReferenceRS*

\- If the UE is provided *pathlossReferenceRSs* and
*PUCCH-SpatialRelationInfo*, the UE obtains a mapping, by indexes
provided by corresponding values of *pucch-PathlossReferenceRS-Id*,
between a set of *pucch-SpatialRelationInfoId* values and a set of
*referenceSignal* values provided by *PUCCH-PathlossReferenceRS*. If the
UE is provided more than one values for *pucch-SpatialRelationInfoId*
and the UE receives *an* activation command \[11, TS 38.321\] indicating
a value of *pucch-SpatialRelationInfoId*, the UE determines the
*referenceSignal* value in *PUCCH-PathlossReferenceRS* through the link
to a corresponding *pucch-PathlossReferenceRS-Id* index. The UE applies
the activation command in the first slot that is after slot where is the
slot where the UE would transmit a PUCCH with HARQ-ACK information for
the PDSCH providing the activation command and is the SCS configuration
for the PUCCH

\- If *PUCCH-SpatialRelationInfo* includes *servingCellId* indicating a
serving cell, the UE receives the RS for resource index on the active DL
BWP of the serving cell

\- If the UE is provided *pathlossReferenceRSs* and is not provided
*PUCCH-SpatialRelationInfo*, the UE obtains the *referenceSignal* value
in *PUCCH-PathlossReferenceRS* from the *pucch-PathlossReferenceRS-Id*
with index 0 in *PUCCH-PathlossReferenceRS* where the RS resource is
either on a same serving cell or, if provided, on a serving cell
indicated by a value of *pathlossReferenceLinking*

\- The parameter is a value of *deltaF-PUCCH-f0* for PUCCH format 0,
*deltaF-PUCCH-f1* for PUCCH format 1, *deltaF-PUCCH-f2* for PUCCH format
2, *deltaF-PUCCH-f3* for PUCCH format 3, and *deltaF-PUCCH-f4* for PUCCH
format 4, if provided; otherwise
$\Delta_{\text{F\_PUCCH}}\left( F \right) = 0$**.**

\- is a PUCCH transmission power adjustment component on active UL BWP
of carrier of primary cell

\- For a PUCCH transmission using PUCCH format 0 or PUCCH format 1,
where

\- is a number of PUCCH format 0 symbols or PUCCH format 1 symbols for
the PUCCH transmission as described in Clause 9.2.

\- for PUCCH format 0

\- for PUCCH format 1

\- for PUCCH format 0

\- for PUCCH format 1, where is a number of UCI bits in PUCCH
*transmission occasion*

\- For a PUCCH transmission using PUCCH format 2 or PUCCH format 3 or
PUCCH format 4 and for a number of UCI bits smaller than or equal to 11,
, where

\-

\- is a number of HARQ-ACK information bits that the UE determines as
described in Clause 9.1.2.1 for Type-1 HARQ-ACK codebook and as
described in Clause 9.1.3.1 for Type-2 HARQ-ACK codebook. If the UE is
not provided with *pdsch-HARQ-ACK-Codebook*, if the UE includes a
HARQ-ACK information bit in the PUCCH transmission; otherwise,

\- is a number of SR information bits that the UE determines as
described in Clause 9.2.5.1

\- is a number of CSI information bits that the UE determines as
described in Clause 9.2.5.2

> \- is a number of resource elements determined as , where is a number
> of subcarriers per resource block excluding subcarriers used for DM-RS
> transmission, and is a number of symbols excluding symbols used for
> DM-RS transmission, as defined in Clause 9.2.5.2, for PUCCH
> transmission occasion on active UL BWP of carrier *of* serving cell

\- For a PUCCH transmission using PUCCH format 2 or PUCCH format 3 or
PUCCH format 4 and for a number of UCI bits larger than 11, , where

\-

\-

\- is a number of HARQ-ACK information bits that the UE determines as
described in Clause 9.1.2.1 for Type-1 HARQ-ACK codebook and as
described in Clause 9.1.3.1 for Type-2 HARQ-ACK codebook. If the UE is
not provided *pdsch-HARQ-ACK-Codebook*, if the UE includes a HARQ-ACK
information bit in the PUCCH transmission; otherwise,

\- is a number of SR information bits that the UE determines as
described in Clause 9.2.5.1

\- is a number of CSI information bits that the UE determines as
described in Clause 9.2.5.2

\- is a number of CRC bits that the UE determines as described in Clause
9.2

\- is a number of resource elements that the UE determines as , where is
a number of subcarriers per resource block excluding subcarriers used
for DM-RS transmission, and is a number of symbols excluding symbols
used for DM-RS transmission, as defined in Clause 9.2.5.2, for PUCCH
transmission occasion on active UL BWP of carrier *of* serving cell .

\- For the PUCCH power control adjustment state for active UL BWP of
carrier of primary cell and PUCCH transmission occasion

\- is a TPC command value and is included in a DCI format 1\_0 or DCI
format 1\_1 for active UL BWP of carrier of the primary cell that the UE
detects for PUCCH transmission occasion or is jointly coded with other
TPC commands in a DCI format 2\_2 with CRC scrambled by TPC-PUCCH-RNTI
\[5, TS 38.212\], as described in Clause 11.3

\- if the UE is provided *twoPUCCH-PC-AdjustmentStates* and
*PUCCH-SpatialRelationInfo* and
![](./media/image157.wmf){width="0.2965277777777778in"
height="0.18680555555555556in"} if the UE is not provided
*twoPUCCH-PC-AdjustmentStates* or *PUCCH-SpatialRelationInfo*

\- If the UE obtains a TPC command value from a DCI format 1\_0 or a DCI
format 1\_1 and if the UE is provided *PUCCH-SpatialRelationInfo*, the
UE obtains a mapping, by an index provided by *p0-PUCCH-Id*, between a
set of *pucch-SpatialRelationInfoId* values and a set of values for
*closedLoopIndex* that provide the value(s). If the UE receives *an*
activation command indicating a value of *pucch-SpatialRelationInfoId*,
the UE determines the value *closedLoopIndex* that provides the value of
through the link to a corresponding *p0-PUCCH-Id* index

\- If the UE obtains one TPC command from a DCI format 2\_2 with CRC
scrambled by a TPC-PUCCH-RNTI, the value is provided by the closed loop
indicator field in DCI format 2\_2

\- is the current PUCCH power control adjustment state for active UL BWP
of carrier *of* serving cell and PUCCH transmission occasion , where

\- The values are given in Table 7.1.2-1

\- is a sum of TPC command values in a set of TPC command values with
cardinality that the UE receives between symbols before PUCCH
transmission occasion and symbols before PUCCH transmission occasion on
active UL BWP of carrier *of* serving cell for PUCCH power control
adjustment state, where is the smallest integer for which symbols before
PUCCH transmission occasion is earlier than symbols before PUCCH
transmission occasion

\- If the PUCCH transmission is in response to a detection by the UE of
a DCI format 1\_0 or DCI format 1\_1, is a number of symbols for active
UL BWP of carrier *of* serving cell after a last symbol of a
corresponding PDCCH reception and before a first symbol of the PUCCH
transmission

\- If the PUCCH transmission is not in response to a detection by the UE
of a DCI format 1\_0 or DCI format 1\_1, is a number of symbols equal to
the product of a number of symbols per slot, , and the minimum of the
values provided by *k2* in *PUSCH-ConfigCommon* for active UL BWP of
carrier *of* serving cell

\- If the UE has reached maximum power for active UL BWP of carrier *of*
primary cell at PUCCH transmission occasion and , then

\- If UE has reached minimum power for active UL BWP of carrier *of*
primary cell at PUCCH transmission occasion and , then

\- If a configuration of a value for a corresponding PUCCH power control
adjustment state for active UL BWP of carrier *of* serving cell is
provided by higher layers,

\-

If the UE is provided *PUCCH-SpatialRelationInfo*, the UE determines the
value of from the value of based on a *pucch-SpatialRelationInfoId*
value associated with the *p0-PUCCH-Id* value corresponding to and with
the *closedLoopIndex* value corresponding to ; otherwise,

\- Else,

\- , where , and is the TPC command value indicated in a random access
response grant corresponding to a PRACH transmission or is the TPC
command value in a DCI format *with CRC scrambled by C-RNTI or
MCS-C-RNTI* that the UE detects in a first PDCCH reception in a *search
space set provided by recoverySearchSpaceId if* the PUCCH transmission
is a first PUCCH transmission after 28 symbols *from a last symbol of
the first PDCCH reception*, and, if the UE transmits PUCCH on active UL
BWP of carrier *of* serving cell ,

;

otherwise,

where is provided by higher layers and corresponds to the total power
ramp-up requested by higher layers from the first to the last preamble
for active UL BWP of carrier of primary cell , and corresponds to PUCCH
format 0 or PUCCH format 1

Table 7.2.1-1: Mapping of TPC Command Field in DCI format 1\_0 or DCI
format 1\_1 or DCI format 2\_2 with CRC scrambled by TPC-PUCCH-RNTI to
accumulated values

  TPC Command Field   Accumulated ![](./media/image292.wmf) \[dB\]
  ------------------- ----------------------------------------------
  0                   -1
  1                   0
  2                   1
  3                   3

7.3 Sounding reference signals
------------------------------

For SRS, a UE splits a linear value of the transmit power on active UL
BWP of carrier of serving cell equally across the configured antenna
ports for SRS.

### 7.3.1 UE behaviour

If a UE transmits SRS on active UL BWP of carrier *of* serving cell
*using* SRS power control adjustment state with index , the UE
determines the SRS transmission power in SRS transmission occasion as

\[dBm\]

where,

\- is the UE configured maximum output power defined in \[8, TS
38.101-1\], \[8-2, TS38.101-2\] and \[TS 38.101-3\] for carrier *of*
serving cell in SRS transmission occasion

> \- is provided by *p0* for active UL BWP of carrier *of* serving cell
> *and* SRS resource set provided by *SRS-ResourceSet* and
> *SRS-ResourceSetId*

\- is a SRS bandwidth expressed in number of resource blocks for SRS
transmission occasion on active UL BWP of carrier *of* serving cell and
is a SCS configuration defined in \[4, TS 38.211\]

\- is provided by *alpha* for active UL BWP of carrier *of* serving cell
*and* SRS resource set

\- is a downlink pathloss estimate in dB calculated by the UE using RS
resource index as described in Clause 7.1.1 for the active DL BWP *of*
serving cell and SRS resource set \[6, TS 38.214\]. The RS resource
index is provided by *pathlossReferenceRS* associated with the SRS
resource set and is either a *ssb-Index* providing a SS/PBCH block index
or a *csi-RS-Index* providing a CSI-RS resource index

\- If the UE is not provided *pathlossReferenceRS* or before the UE is
provided dedicated higher layer parameters*, the UE calculates* using *a
RS resource obtained from the SS/PBCH block that the UE uses to obtain
MIB*

\- If the UE is provided *pathlossReferenceLinking*, the RS resource is
on a serving cell indicated by a value of *pathlossReferenceLinking*

\- For the SRS power control adjustment state for active UL BWP of
carrier *of* serving cell and SRS transmission occasion

\- , where is the current PUSCH power control adjustment state as
described in Clause 7.1.1, if *srs-PowerControlAdjustmentStates*
indicates a same power control adjustment state for SRS transmissions
and PUSCH transmissions; or

\- if the UE is not configured for PUSCH transmissions on active UL BWP
of carrier *of* serving cell *, or* if
*srs-PowerControlAdjustmentStates* indicates separate power control
adjustment states between SRS transmissions and PUSCH transmissions, and
if *tpc-Accumulation* is not provided, where

\- The values are given in Table 7.1.1-1

\- is jointly coded with other TPC commands in a PDCCH with DCI format
2\_3, as described in Clause 11.4

\- is a sum of TPC command values in a set of TPC command values with
cardinality that the UE receives between symbols before SRS transmission
occasion and symbols before SRS transmission occasion on active UL BWP
of carrier *of* serving cell for SRS power control adjustment state,
where is the smallest integer for which symbols before SRS transmission
occasion is earlier than symbols before SRS transmission occasion

\- if the SRS transmission is aperiodic, is a number of symbols for
active UL BWP of carrier *of* serving cell after a last symbol of a
corresponding PDCCH triggering the SRS transmission and before a first
symbol of the SRS transmission

\- if the SRS transmission is semi-persistent or periodic, is a number
of symbols equal to the product of a number of symbols per slot, , and
the minimum of the values provided by *k2* in *PUSCH-ConfigCommon* for
active UL BWP of carrier *of* serving cell

\- If the UE has reached maximum power for active UL BWP of carrier *of*
serving cell at SRS transmission occasion and , then

\- If UE has reached minimum power for active UL BWP of carrier *of*
serving cell at SRS transmission occasion and , then

\- If a configuration for a value or for a value for a corresponding SRS
power control adjustment state for active UL BWP of carrier *of* serving
cell is provided by higher layers

> \-
>
> \- Else
>
> \-
>
> where
>
> is the TPC command value indicated in the random access response grant
> corresponding to the random access preamble that the UE transmitted on
> active UL BWP *of* carrier of the serving cell , and
>
> ;
>
> where is provided by higher layers and corresponds to the total power
> ramp-up requested by higher layers from the first to the last preamble
> for active UL BWP of carrier of serving cell .

\- if the UE is not configured for PUSCH transmissions on active UL BWP
of carrier *of* serving cell *, or* if
*srs-PowerControlAdjustmentStates* indicates separate power control
adjustment states between SRS transmissions and PUSCH transmissions, and
*tpc-Accumulation* is provided, and the UE detects a DCI format 2\_3
symbols before a first symbol of SRS transmission occasion , where
absolute values of are provided in Table 7.1.1-1

\- if *srs-PowerControlAdjustmentStates* indicates a same power control
adjustment state for SRS transmissions and PUSCH transmissions, the
update of the power control adjustment state for SRS transmission
occasion occurs at the beginning of each SRS resource in the SRS
resource set ; otherwise, the update of the power control adjustment
state SRS transmission occasion occurs at the beginning of the first
transmitted SRS resource in the SRS resource set .

7.4 Physical random access channel
----------------------------------

A UE determines a transmission power for a physical random access
channel (PRACH), , on active UL BWP of carrier of serving cell based on
DL RS for serving cell in transmission occasion as

\[dBm\],

where is the UE configured maximum output power defined in \[8-1, TS
38.101-1\], \[8-2, TS38.101-2\] and \[38.101-3\] for carrier of serving
cell within transmission occasion , is the PRACH target reception power
*PREAMBLE\_RECEIVED\_TARGET\_POWER* provided by higher layers \[11, TS
38.321\] for the active UL BWP of carrier of serving cell , and is a
pathloss for the active UL BWP of carrier *based on* the DL RS
associated with the PRACH transmission on the active DL BWP *of* serving
cell and calculated by the UE in dB as *referenceSignalPower* -- higher
layer filtered RSRP in dBm, where RSRP is defined in \[7, TS 38.215\]
and the higher layer filter configuration is defined in \[12, TS
38.331\]. If the active DL BWP is the initial DL BWP and for SS/PBCH
block and CORESET multiplexing pattern 2 or 3, as described in Clause
13, the UE determines based on the SS/PBCH block associated with the
PRACH transmission.

If a PRACH transmission from a UE is not in response to a detection of a
PDCCH order by the UE, or is in response to a detection of a PDCCH order
by the UE that triggers a contention based random access procedure, or
is associated with a link recovery procedure where a corresponding index
*is associated with a SS/PBCH block, as described in Clause 6,*
*referenceSignalPower* is provided by *ss-PBCH-BlockPower*.

If a PRACH transmission from a UE is in response to a detection of a
PDCCH order by the UE that triggers a contention-free random access
procedure and depending on the DL RS that the DM-RS of the PDCCH order
is quasi-collocated with as described in Clause 10.1,
*referenceSignalPower* is provided by *ss-PBCH-BlockPower* or, if the UE
is configured resources for a periodic CSI-RS reception or the PRACH
transmission is associated with a link recovery procedure where a
corresponding index *is associated with a periodic CSI-RS configuration*
*as described in Clause 6*, *referenceSignalPower* is obtained by
*ss-PBCH-BlockPower* and *powerControlOffsetSS* where
*powerControlOffsetSS* provides an offset of CSI-RS transmission power
relative to SS/PBCH block transmission power \[6, TS 38.214\]. If
*powerControlOffsetSS* is not provided to the UE, the UE assumes an
offset of 0 dB. If the active TCI state for the PDCCH that provides the
PDCCH order includes two RS, the UE expects that one RS has QCL-TypeD
properties and the UE uses the one RS when applying a value provided by
*powerControlOffsetSS*.

If within a random access response window, as described in Clause 8.2,
the UE does not receive a random access response that contains a
preamble identifier corresponding to the preamble sequence transmitted
by the UE, the UE determines a transmission power for a subsequent PRACH
transmission, if any, as described in \[11, TS 38.321\].

If prior to a PRACH retransmission, a UE changes the spatial domain
transmission filter, Layer 1 notifies higher layers to suspend the power
ramping counter as described in \[11, TS 38.321\].

If due to power allocation *to* PUSCH/PUCCH/PRACH*/SRS transmissions as
described in Clause 7.5, or due to power allocation in EN-DC or NE-DC
operation as described in Clause 7.6.1 or Clause 7.6.1A, respectively,*
the UE does not transmit a PRACH *in a transmission occasion*, Layer 1
notifies higher layers to suspend the corresponding power ramping
counter. If due to power allocation *to* PUSCH/PUCCH/PRACH*/SRS
transmissions as described in Clause 7.5, or due to power allocation in
EN-DC or NE-DC operation as described in Clause 7.6.1 or Clause 7.6.1A,
respectively,* the UE transmits a PRACH with reduced power *in a
transmission occasion*, Layer 1 may notify higher layers to suspend the
corresponding power ramping counter.

7.5 Prioritizations for transmission power reductions
-----------------------------------------------------

For single cell operation with two uplink carriers or for operation with
carrier aggregation, if a *total UE transmit power for PUSCH or PUCCH or
PRACH or SRS transmissions on serving cells in a frequency range in a
respective transmission occasion would exceed , where is the linear
value of in transmission occasion as defined in \[8-1, TS 38.101-1\] for
FR1* and \[8-2, TS38.101-2\] *for FR2, the UE allocates power to*
PUSCH/PUCCH/PRACH*/SRS transmissions according to the following priority
order (in descending order) so that the total UE transmit power for
transmissions on serving cells in the frequency range is smaller than or
equal to for that frequency range in every symbol of transmission
occasion . When determining a total transmit power for serving cells in
a frequency range in a symbol of transmission occasion , the UE does not
include power for transmissions starting after the symbol of
transmission occasion . The total UE transmit power in a symbol of a
slot is defined as the sum of the linear values of UE transmit powers
for PUSCH, PUCCH, PRACH, and SRS in the symbol of the slot.*

\- PRACH transmission on the PCell

\- PUCCH transmission with HARQ-ACK information and/or SR or PUSCH
transmission with HARQ-ACK information

\- PUCCH transmission with CSI or PUSCH transmission with CSI

\- PUSCH transmission without HARQ-ACK information or CSI

\- SRS transmission, with aperiodic SRS having higher priority than
semi-persistent and/or periodic SRS, or PRACH transmission on a serving
cell other than the PCell

In case of same priority order and for operation with carrier
aggregation, the UE prioritizes power allocation for transmissions on
the primary cell of the MCG or the SCG over transmissions on a secondary
cell. In case of same priority order and for operation with two UL
carriers, the UE prioritizes power allocation for transmissions on the
carrier where the UE is configured to transmit PUCCH. If *PUCCH* is not
configured for any of the *two UL carriers, the UE prioritizes power
allocation for transmissions on* the non-supplementary UL carrier.

7.6 Dual connectivity
---------------------

### 7.6.1 EN-DC

If a UE is configured with a MCG using E-UTRA radio access and with a
SCG using NR radio access, the UE is configured a maximum power for
transmissions on the MCG by *p-MaxEUTRA* and a maximum power for
transmissions in FR1 on the SCG by *p-NR-FR1*.

The UE determines a transmission power for the MCG as described in \[13,
TS 36.213\] using as the maximum transmission power. The UE determines
transmission power for the SCG in FR1 as described Clauses 7.1 through
7.5 using as the maximum transmission power. The UE determines
transmission power for the SCG in FR2 as described Clauses 7.1 through
7.5.

A UE does not expect to be configured for operation with shortened TTI
and/or processing time \[13, TS 36.213\] on a cell that is included in
an EN-DC configuration.

If a UE is configured with , where is the linear value of , is the
linear value of , and is the linear value of a configured maximum
transmission power for EN-DC operation as *defined in* \[8-3, TS
38.101-3\] for FR1, the UE determines a transmission power for the SCG
as follows.

\- If the UE is configured with reference TDD configuration for E-UTRA
(by *tdm-PatternConfig-r15* in \[13, TS 36.213\])

\- If the UE does not indicate a capability for dynamic power sharing
between E-UTRA and NR for EN-DC, the UE does not expect to transmit in a
slot on the SCG in FR1 when a corresponding subframe on the MCG is an UL
subframe in the reference TDD configuration.

\- If the UE indicates a capability for dynamic power sharing between
E-UTRA and NR for EN-DC and

\- if UE transmission(s) in subframe of the MCG overlap in time with UE
transmission(s) in slot of the SCG in FR1, and

\- if in any portion of slot of the SCG,

the UE reduces transmission power in any portion of slot of the SCG so
that in any portion of slot , where and are the linear values of the
total UE transmission powers in subframe of the MCG and in slot of the
SCG in FR1, respectively. The UE is not required to transmit in any
portion of slot of the SCG if  would need to be reduced by more than the
value provided by *X~SCALE~* in order for  in any portion of slot of the
SCG. The UE is required to transmit in slot of the SCG if  would not
need to be reduced by more than the value provided by *X~SCALE~* in
order for  in all portions of slot .

\- If the UE does not indicate a capability for dynamic power sharing
between E-UTRA and NR for EN-DC, the UE expects to be configured with
reference TDD configuration for E-UTRA (by *tdm-PatternConfig-r15* in
\[13, TS 36.213\]).

### 7.6.1A NE-DC

If a UE is configured with a MCG using NR radio access and with a SCG
using E-UTRA radio access, the UE is configured a maximum power for
transmissions in FR1 on the MCG by *p-NR-FR1* and a maximum power for
transmissions on the SCG by *p-MaxEUTRA*.

The UE determines transmission power for the MCG in FR1 as described
Clauses 7.1 through 7.5 using as the maximum transmission power for .
The UE determines transmission power for the MCG in FR2 as described
Clauses 7.1 through 7.5.

If the UE is not provided *tdd-UL-DL-ConfigurationCommon for the MCG,
t*he UE determines a transmission power for the SCG as described in
\[13, TS 36.213\] using as the maximum transmission power.

If at least one symbol of slot of the MCG that is indicated as uplink or
flexible by *tdd-UL-DL-ConfigurationCommon* or
*tdd*-*UL-DL-ConfigurationDedicated* overlaps with subframe of the SCG

\- for subframe , the UE determines a transmission power for the SCG as
described in \[13, TS 36.213\] using as the maximum transmission power

otherwise

\- the UE determines a transmission power for the SCG as described in
\[13, TS 36.213\] without considering as the maximum transmission power

If a UE is configured with , where is the linear value of , is the
linear value of , and is the linear value of a configured maximum
transmission power for NE-DC operation as *defined in* \[8-3, TS
38.101-3\] for FR1, the UE determines a transmission power for the MCG
as follows

\- If the UE is configured with reference TDD configuration for E-UTRA
(by *tdm-PatternConfigNE-DC-r15* in \[13, TS 36.213\])

\- If the UE does not indicate a capability for dynamic power sharing
between E-UTRA and NR for NE-DC, the UE does not expect to transmit in a
slot on the MCG in FR1 when a corresponding subframe on the SCG is an UL
subframe in the reference TDD configuration.

\- If the UE indicates a capability for dynamic power sharing between
E-UTRA and NR for NE-DC and

\- if the UE transmission(s) in slot of the MCG in FR1 overlap in time
with UE transmission(s) in subframe of the SCG, and

\- if in any portion of slot of the MCG,

the UE reduces transmission power in any portion of slot of the MCG so
that in all portions of slot , where and are the linear values of the
total UE transmission powers in slot of the MCG in FR1 and in subframe
of the SCG, respectively.

\- If the UE does not indicate a capability for dynamic power sharing
between E-UTRA and NR for NE-DC, the UE expects to be configured with
reference TDD configuration for E-UTRA (by *tdm-PatternConfigNE-DC-r15*
in \[13, TS 36.213\]).

### 7.6.2 NR-DC

If a UE is configured with a MCG using NR radio access in FR1 or in FR2
and with a SCG using NR radio access in FR2 or in FR1, respectively, the
UE performs transmission power control independently per cell group as
described in Clauses 7.1 through 7.5.

7.7 Power headroom report
-------------------------

The types of UE power headroom reports are the following. A Type 1 UE
power headroom that is valid for PUSCH transmission occasion on active
UL BWP of carrier *of* serving cell . A Type 3 UE power headroom that is
valid for SRS transmission occasion on active UL BWP of carrier *of*
serving cell .

A UE determines whether a power headroom report for an activated serving
cell \[11, TS 38.321\] is based on an actual transmission or a reference
format based on the higher layer signalling of configured grant and
periodic/semi-persistent sounding reference signal transmissions and
downlink control information the UE received until and including the
PDCCH monitoring occasion where the UE detects the first DCI format 0\_0
or DCI format 0\_1 scheduling an initial transmission of a transport
block since a power headroom report was triggered if the power headroom
report is reported on a PUSCH triggered by the first DCI. Otherwise, a
UE determines whether a power headroom report is based on an actual
transmission or a reference format based on the higher layer signalling
of configured grant and periodic/semi-persistent sounding reference
signal transmissions and downlink control information the UE received
until the first uplink symbol of a configured PUSCH transmission minus
*T\'~proc,2~*=*T~proc,2~* where *T~proc,2\ ~*is determined according to
\[6, TS 38.214\] assuming *d~2,1\ ~*= 1, *d~2,2~*=0, and with *µ~DL~*
corresponding to the subcarrier spacing of the active downlink BWP of
the scheduling cell for a configured grant if the power headroom report
is reported on the PUSCH using the configured grant.

If a UE

\- is configured with two UL carriers for a serving cell, and

\- determines a Type 1 power headroom report and a Type 3 power headroom
report for the serving cell

the UE

\- provides the Type 1 power headroom report if both the Type 1 and Type
3 power headroom reports are based on respective actual transmissions or
on respective reference transmissions

\- provides the power headroom report that is based on a respective
actual transmission if either the Type 1 report or the Type 3 report is
based on a respective reference transmission

If a UE is configured with a SCG and if *phr-ModeOtherCG* for a CG
indicates \'virtual\' then, for power headroom reports transmitted on
the CG, the UE computes *PH* assuming that the UE does not transmit
PUSCH/PUCCH on any serving cell of the other CG.

If the UE is configured with a SCG,

\- For computing power headroom for cells belonging to MCG, the term
\'serving cell\' in this clause refers to serving cell belonging to the
MCG.

\- For computing power headroom for cells belonging to SCG, the term
\'serving cell\' in this clause refers to serving cell belonging to the
SCG. The term \'primary cell\' in this clause refers to the PSCell of
the SCG.

If the UE is configured with a PUCCH-SCell,

\- For computing power headroom for cells belonging to primary PUCCH
group, the term \'serving cell\' in this clause refers to serving cell
belonging to the primary PUCCH group.

\- For computing power headroom for cells belonging to secondary PUCCH
group, the term \'serving cell\' in this clause refers to serving cell
belonging to the secondary PUCCH group. The term \'primary cell\' in
this clause refers to the PUCCH-SCell of the secondary PUCCH group.

For a UE configured with EN-DC/NE-DC and capable of dynamic power
sharing, if E-UTRA Dual Connectivity PHR \[14, TS 36.321\] is triggered
and,

\- if the duration of NR slot on active UL BWP is different from that of
E-UTRA subframe carrying the Dual Connectivity PHR, the UE provides
power headroom of the first NR slot that fully overlaps with the E-UTRA
subframe;

\- if the duration of NR slot on active UL BWP is the same as that of
E-UTRA subframe carrying the Dual Connectivity PHR for asynchronous
EN-DC/NE-DC \[10, TS 38.133\], the UE provides power headroom of the
first NR slot that overlaps with the E-UTRA subframe.

### 7.7.1 Type 1 PH report

If a UE determines that a Type 1 power headroom report for an activated
serving cell is based on an actual PUSCH transmission then, for PUSCH
transmission occasion on active UL BWP *of* carrier *of* serving cell ,
the UE computes the Type 1 power headroom report as

\[dB\]

where , , , , , and are defined in Clause 7.1.1.

If a UE is configured with multiple cells for PUSCH transmissions, where
a SCS configuration on active UL BWP *of* carrier of serving cell *is
smaller than a* SCS configuration on active UL BWP *of* carrier of
serving cell *, and if the UE provides a Type 1 power headroom report in
a PUSCH transmission in a slot on active* UL BWP *that overlaps with
multiple slots on active* UL BWP *, the UE provides a Type 1 power
headroom report for the first PUSCH, if any, on the first slot of the
multiple slots on active* UL BWP that fully overlaps with the slot on
active UL BWP . If a UE is configured with multiple cells for PUSCH
transmissions, where a same SCS configuration on active UL BWP *of*
carrier of serving cell *and* active UL BWP *of* carrier of serving cell
*, and if the UE provides a Type 1 power headroom report in a PUSCH
transmission in a slot on active* UL BWP *, the UE provides a Type 1
power headroom report for the first PUSCH, if any, on the slot on
active* UL BWP that overlaps with the slot on active UL BWP .

For a UE configured with EN-DC/NE-DC and capable of dynamic power
sharing, if E-UTRA Dual Connectivity PHR \[14, TS 36.321\] is triggered,
the UE provides power headroom of the first PUSCH, if any, on the
determined NR slot as described in clause 7.7.

If a UE is configured with multiple cells for PUSCH transmissions, the
UE does not consider for computation of a Type 1 power headroom report
in a first PUSCH transmission that includes an initial transmission of
transport block on active UL BWP *of* carrier of serving cell *, a
second* PUSCH transmission on active UL BWP *of* carrier of serving cell
*that overlaps with the first PUSCH transmission if*

\- the second PUSCH transmission is scheduled by a DCI format 0\_0 or a
DCI format 0\_1 in a PDCCH received in a second PDCCH monitoring
occasion, and

\- the second PDCCH monitoring occasion is after a first PDCCH
monitoring occasion where the UE detects the earliest DCI format 0\_0 or
DCI format 0\_1 scheduling an initial transmission of a transport block
after a power headroom report was triggered

or

\- the second PUSCH transmission is after the first uplink symbol of the
first PUSCH transmission minus *T\'~proc,2~*=*T~proc,2~* where
*T~proc,2~* is determined according to \[6, TS 38.214\] assuming
*d~2,1\ ~*=1, *d~2,2~*=0, and with *µ~DL~* corresponding to the
subcarrier spacing of the active downlink BWP of the scheduling cell for
a configured grant if the first PUSCH transmission is on a configured
grant after a power headroom report was triggered.

If the UE determines that a Type 1 power headroom report for an
activated serving cell is based on a reference PUSCH transmission then,
for PUSCH transmission occasion on active UL BWP *of* carrier of serving
cell , the UE computes the Type 1 power headroom report as

\[dB\]

where is computed assuming MPR=0 dB, A-MPR=0 dB, P-MPR=0 dB. ∆T~C~ = 0
dB. MPR, A-MPR, P-MPR and ∆T~C~ are defined in \[8-1, TS 38.101-1\],
\[8-2, TS38.101-2\] and \[8-3, TS 38.101-3\]. The remaining parameters
are defined in Clause 7.1.1 where and are obtained using and
*p0-PUSCH-AlphaSetId* *=* 0*,* is obtained using
*pusch-PathlossReferenceRS-Id =* 0, and .

If a UE is configured with two UL carriers for a serving cell and the UE
determines a Type 1 power headroom report for the serving cell based on
a reference PUSCH transmission, the UE computes a Type 1 power headroom
report for the serving cell assuming a reference PUSCH transmission on
the UL carrier provided by *pusch-Config*. If the UE is provided
*pusch-Config* for both UL carriers, the UE computes a Type 1 power
headroom report for the serving cell assuming a reference PUSCH
transmission on the UL carrier provided by *pucch-Config*. If
*pucch-Config* is not provided to the UE for any of the two UL carriers,
the UE computes a Type 1 power headroom report for the serving cell
assuming a reference PUSCH transmission on the non-supplementary UL
carrier.

### 7.7.2 Type 2 PH report

This clause is reserved.

### 7.7.3 Type 3 PH report

If a UE determines that a Type 3 power headroom report for an activated
serving cell is based on an actual SRS transmission then, for SRS
transmission occasion on active UL BWP *of* carrier *of* serving cell
and if the UE is not configured for PUSCH transmissions on carrier *of*
serving cell , the UE computes a Type 3 power headroom report as

\[dB\]

where , , , , and are defined in Clause 7.3.1.

If the UE determines that a Type 3 power headroom report for an
activated serving cell is based on a reference SRS transmission then,
for SRS transmission occasion on UL BWP *of* carrier *of* serving cell ,
and if the UE is not configured for PUSCH transmissions on UL BWP *of*
carrier *of* serving cell , the UE computes a Type 3 power headroom
report as

\[dB\]

where is a SRS resource set corresponding to *SRS-ResourceSetId = 0* for
UL BWP and , , and are defined in Clause 7.3.1 with corresponding values
obtained from *SRS-ResourceSetId = 0* for UL BWP . is computed assuming
MPR=0 dB, A-MPR=0 dB, P-MPR=0 dB and ∆T~C~ =0 dB. MPR, A-MPR, P-MPR and
∆T~C~ are defined in \[8-1, TS 38.101-1\], \[8-2, TS38.101-2\] and
\[8-3, TS 38.101-3\].

If a UE is configured with two UL carriers for a serving cell and the UE
determines a Type 3 power headroom report for the serving cell based on
a reference SRS transmission, the UE computes a Type 3 power headroom
report for the serving cell assuming a reference SRS transmission on the
UL carrier provided by *pucch-Config*. If *pucch-Config* is not provided
to the UE for any of the two UL carriers, the UE computes a Type 3 power
headroom report for the serving cell assuming a reference SRS
transmission on the non-supplementary UL carrier.

8 Random access procedure
=========================

Prior to initiation of the physical random access procedure, Layer 1
receives from higher layers a set of SS/PBCH block indexes and provides
to higher layers a corresponding set of RSRP measurements.

Prior to initiation of the physical random access procedure, Layer 1
receives the following information from the higher layers:

\- Configuration of physical random access channel (PRACH) transmission
parameters (PRACH preamble format, time resources, and frequency
resources for PRACH transmission).

\- Parameters for determining the root sequences and their cyclic shifts
in the PRACH preamble sequence set (index to logical root sequence
table, cyclic shift (), and set type (unrestricted, restricted set A, or
restricted set B)).

From the physical layer perspective, the L1 random access procedure
includes the transmission of random access preamble (Msg1) in a PRACH,
random access response (RAR) message with a PDCCH/PDSCH (Msg2), and when
applicable, the transmission of a PUSCH scheduled by a RAR UL grant, and
PDSCH for contention resolution.

If a random access procedure is initiated by a PDCCH order to the UE, a
PRACH transmission is with a same SCS as a PRACH transmission initiated
by higher layers.

If a UE is configured with two UL carriers for a serving cell and the UE
detects a PDCCH order, the UE uses the UL/SUL indicator field value from
the detected PDCCH order to determine the UL carrier for the
corresponding PRACH transmission.

8.1 Random access preamble
--------------------------

Physical random access procedure is triggered upon request of a PRACH
transmission by higher layers or by a PDCCH order. A configuration by
higher layers for a PRACH transmission includes the following:

\- A configuration for PRACH transmission \[4, TS 38.211\].

\- A preamble index, a preamble SCS, , a corresponding RA-RNTI, and a
PRACH resource.

A PRACH is transmitted using the selected PRACH format with transmission
power , as described in Clause 7.4, on the indicated PRACH resource.

A UE is provided a number of SS/PBCH blocks associated with one PRACH
occasion and a number of contention based preambles per SS/PBCH block
per valid PRACH occasion by *ssb-perRACH-OccasionAndCB-PreamblesPerSSB*.
If , one SS/PBCH block is mapped to consecutive valid PRACH occasions
and contention based preambles with consecutive indexes associated with
the SS/PBCH block per valid PRACH occasion start from preamble index 0.
If , contention based preambles with consecutive indexes associated with
SS/PBCH block , , per valid PRACH occasion start from preamble index
where is provided by *totalNumberOfRA-Preambles* and is an integer
multiple of .

For link recovery, a UE is provided SS/PBCH blocks associated with one
PRACH occasion by *ssb-perRACH-Occasion* in *BeamFailureRecoveryConfig*.
For a dedicated RACH configuration provided by *RACH-ConfigDedicated*,
if *cfra* is provided, a UE is provided SS/PBCH blocks associated with
one PRACH occasion by *ssb-perRACH-Occasion* in *occasions*. If , one
SS/PBCH block is mapped to  consecutive valid PRACH occasions. If , all
consecutive SS/PBCH blocks are associated with one PRACH occasion.

SS/PBCH block indexes provided by *ssb-PositionsInBurst* in *SIB1* or in
*ServingCellConfigCommon* are mapped to valid PRACH occasions in the
following order where the parameters are described in \[4, TS 38.211\].

\- First, in increasing order of preamble indexes within a single PRACH
occasion

\- Second, in increasing order of frequency resource indexes for
frequency multiplexed PRACH occasions

\- Third, in increasing order of time resource indexes for time
multiplexed PRACH occasions within a PRACH slot

\- Fourth, in increasing order of indexes for PRACH slots

An association period, starting from frame 0, for mapping SS/PBCH blocks
to PRACH occasions is the smallest value in the set determined by the
PRACH configuration period according Table 8.1-1 such that SS/PBCH
blocks are mapped at least once to the PRACH occasions within the
association period, where a UE obtains from the value of
*ssb-PositionsInBurst* in *SIB1* or in *ServingCellConfigCommon*. If
after an integer number of SS/PBCH blocks to PRACH occasions mapping
cycles within the association period there is a set of PRACH occasions
or PRACH preambles that are not mapped to SS/PBCH blocks, no SS/PBCH
blocks are mapped to the set of PRACH occasions or PRACH preambles. An
association pattern period includes one or more association periods and
is determined so that a pattern between PRACH occasions and SS/PBCH
blocks repeats at most every 160 msec. PRACH occasions not associated
with SS/PBCH blocks after an integer number of association periods, if
any, are not used for PRACH transmissions.

For a PRACH transmission triggered by a PDCCH order, the PRACH mask
index field \[5, TS 38.212\], if the value of the random access preamble
index field is not zero, indicates the PRACH occasion for the PRACH
transmission where the PRACH occasions are associated with the SS/PBCH
block index indicated by the SS/PBCH block index field of the PDCCH
order.

For a PRACH transmission triggered by higher layers, if
*ssb-ResourceList* is provided, the PRACH mask index is indicated by
*ra-ssb-OccasionMaskIndex* which indicates the PRACH occasions for the
PRACH transmission where the PRACH occasions are associated with the
selected SS/PBCH block index.

The PRACH occasions are mapped consecutively per corresponding SS/PBCH
block index. The indexing of the PRACH occasion indicated by the mask
index value is reset per mapping cycle of consecutive PRACH occasions
per SS/PBCH block index. The UE selects for a PRACH transmission the
PRACH occasion indicated by PRACH mask index value for the indicated
SS/PBCH block index in the first available mapping cycle.

For the indicated preamble index, the ordering of the PRACH occasions is

\- First, in increasing order of frequency resource indexes for
frequency multiplexed PRACH occasions

\- Second, in increasing order of time resource indexes for time
multiplexed PRACH occasions within a PRACH slot

\- Third, in increasing order of indexes for PRACH slots

For a PRACH transmission triggered upon request by higher layers, a
value of *ra-OccasionList* \[12, TS 38.331\], if *csirs-ResourceList* is
provided, indicates a list of PRACH occasions for the PRACH transmission
where the PRACH occasions are associated with the selected CSI-RS index
indicated by *csi-RS*. The indexing of the PRACH occasions indicated by
*ra-OccasionList* is reset per association pattern period.

Table 8.1-1: Mapping between PRACH configuration period and SS/PBCH
block to PRACH occasion association period

  PRACH configuration period (msec)   Association period (number of PRACH configuration periods)
  ----------------------------------- ------------------------------------------------------------
  10                                  {1, 2, 4, 8, 16}
  20                                  {1, 2, 4, 8}
  40                                  {1, 2, 4}
  80                                  {1, 2}
  160                                 {1}

For paired spectrum or supplementary uplink band all PRACH occasions are
valid. For unpaired spectrum, if a UE is not provided
*tdd-UL-DL-ConfigurationCommon*, a PRACH occasion in a PRACH slot is
valid if it does not precede a SS/PBCH block in the PRACH slot and
starts at least symbols after a last SS/PBCH block symbol, where is
provided in Table 8.1-2.

If a UE is provided *tdd-UL-DL-ConfigurationCommon*, a PRACH occasion in
a PRACH slot is valid if

\- it is within UL symbols, or

\- it does not precede a SS/PBCH block in the PRACH slot and starts at
least symbols after a last downlink symbol and at least symbols after a
last SS/PBCH block symbol, where is provided in Table 8.1-2.

For preamble format B4 \[4, TS 38.211\],
![](./media/image425.wmf){width="0.5277777777777778in"
height="0.21944444444444444in"}.

Table 8.1-2: values for different preamble SCS

  Preamble SCS                            
  --------------------------------------- ---
  1.25 kHz or 5 kHz                       0
  15 kHz or 30 kHz or 60 kHz or 120 kHz   2

If a random access procedure is initiated by a PDCCH order, the UE, if
requested by higher layers, transmits a PRACH in the selected PRACH
occasion, as described in \[11, TS 38.321\], for which a time between
the last symbol of the PDCCH order reception and the first symbol of the
PRACH transmission is larger than or equal to msec, where is a time
duration of symbols corresponding to a PUSCH preparation time for UE
processing capability 1 \[6, TS 38.214\] assuming corresponds to the
smallest SCS configuration between the SCS configuration of the PDCCH
order and the SCS configuration of the corresponding PRACH transmission,
if the active UL BWP does not change and is defined in \[10, TS 38.133\]
otherwise, and msec for FR1 and msec for FR2. For a PRACH transmission
using 1.25 kHz or 5 kHz SCS, the UE determines assuming SCS
configuration .

For single cell operation or for operation with carrier aggregation in a
same frequency band, a UE does not transmit PRACH and PUSCH/PUCCH/SRS in
a same slot or when a gap between the first or last symbol of a PRACH
transmission in a first slot is separated by less than symbols from the
last or first symbol, respectively, of a PUSCH/PUCCH/SRS transmission in
a second slot where for or , for or , and is the SCS configuration for
the active UL BWP.

8.2 Random access response
--------------------------

In response to a PRACH transmission, a UE attempts to detect a DCI
format 1\_0 with CRC scrambled by a corresponding RA-RNTI during a
window controlled by higher layers \[11, TS 38.321\]. The window starts
at the first symbol of the earliest CORESET the UE is configured to
receive PDCCH for Type1-PDCCH CSS set, as defined in Clause 10.1, that
is at least one symbol, after the last symbol of the PRACH occasion
corresponding to the PRACH transmission, where the symbol duration
corresponds to the SCS for Type1-PDCCH CSS set as defined in Clause
10.1. The length of the window in number of slots, based on the SCS for
Type1-PDCCH CSS set, is provided by *ra-ResponseWindow*.

If the UE detects the DCI format 1\_0 with CRC scrambled by the
corresponding RA-RNTI and a transport block in a corresponding PDSCH
within the window, the UE passes the transport block to higher layers.
The higher layers parse the transport block for a random access preamble
identity (RAPID) associated with the PRACH transmission. If the higher
layers identify the RAPID in RAR message(s) of the transport block, the
higher layers indicate an uplink grant to the physical layer. This is
referred to as random access response (RAR) UL grant in the physical
layer.

If the UE does not detect the DCI format 1\_0 with CRC scrambled by the
corresponding RA-RNTI within the window, or if the UE does not correctly
receive the transport block in the corresponding PDSCH within the
window, or if the higher layers do not identify the RAPID associated
with the PRACH transmission from the UE, the higher layers can indicate
to the physical layer to transmit a PRACH. If requested by higher
layers, the UE shall be ready to transmit a PRACH no later than msec
after the last symbol of the window, or the last symbol of the PDSCH
reception, where is a time duration of symbols corresponding to a PDSCH
processing time for UE processing capability 1 assuming corresponds to
the smallest SCS configuration among the SCS configurations for the
PDCCH carrying the DCI format 1\_0, the corresponding PDSCH when
additional PDSCH DM-RS is configured, and the corresponding PRACH. For ,
the UE assumes \[6, TS 38.214\]. For a PRACH transmission using 1.25 kHz
or 5 kHz SCS, the UE determines assuming SCS configuration .

If the UE detects a DCI format 1\_0 with CRC scrambled by the
corresponding RA-RNTI and receives a transport block in a corresponding
PDSCH, the UE may assume same DM-RS antenna port quasi co-location
properties, as described in \[6, TS 38.214\], as for a SS/PBCH block or
a CSI-RS resource the UE used for PRACH association, as described in
Clause 8.1, regardless of whether or not the UE is provided *TCI-State*
for the CORESET where the UE receives the PDCCH with the DCI format
1\_0. If the UE attempts to detect the DCI format 1\_0 with CRC
scrambled by the corresponding RA-RNTI in response to a PRACH
transmission initiated by a PDCCH order that triggers a contention-free
random access procedure for the SpCell \[11, TS 38.321\], the UE may
assume that the PDCCH that includes the DCI format 1\_0 and the PDCCH
order have same DM-RS antenna port quasi co-location properties. If the
UE attempts to detect the DCI format 1\_0 with CRC scrambled by the
corresponding RA-RNTI in response to a PRACH transmission initiated by a
PDCCH order that triggers a contention-free random access procedure for
a secondary cell, the UE may assume the DM-RS antenna port quasi
co-location properties of the CORESET associated with the Type1-PDCCH
CSS set for receiving the PDCCH that includes the DCI format 1\_0.

A RAR UL grant schedules a PUSCH transmission from the UE. The contents
of the RAR UL grant, starting with the MSB and ending with the LSB, are
given in Table 8.2-1.

If the value of the frequency hopping flag is 0, the UE transmits the
PUSCH without frequency hopping; otherwise, the UE transmits the PUSCH
with frequency hopping.

The UE determines the MCS of the PUSCH transmission from the first
sixteen indexes of the applicable MCS index table for PUSCH as described
in \[6, TS 38.214\].

The TPC command value is used for setting the power of the PUSCH
transmission, as described in Clause 7.1.1, and is interpreted according
to Table 8.2-2.

The CSI request field is reserved.

Table 8.2-1: Random Access Response Grant Content field size

  RAR grant field                       Number of bits
  ------------------------------------- ----------------
  Frequency hopping flag                1
  PUSCH frequency resource allocation   14
  PUSCH time resource allocation        4
  MCS                                   4
  TPC command for PUSCH                 3
  CSI request                           1

Table 8.2-2: TPC Command for PUSCH

  TPC Command   Value (in dB)
  ------------- ---------------
  0             -6
  1             -4
  2             -2
  3             0
  4             2
  5             4
  6             6
  7             8

Unless the UE is configured a SCS, the UE receives subsequent PDSCH
using same SCS as for the PDSCH reception providing the RAR message.

If the UE does not detect the DCI format with CRC scrambled by the
corresponding RA-RNTI or the UE does not correctly receive a
corresponding transport block within the window, the UE procedure is as
described in \[11, TS 38.321\].

8.3 PUSCH scheduled by RAR UL grant
-----------------------------------

An active UL BWP, as described in Clause 12 and in \[4, TS 38.211\], for
a PUSCH transmission scheduled by a RAR UL grant is indicated by higher
layers. For determining the frequency domain resource allocation for the
PUSCH transmission within the active UL BWP

\- if the active UL BWP and the initial UL BWP have same SCS and same CP
length and the active UL BWP includes all RBs of the initial UL BWP, or
the active UL BWP is the initial UL BWP, the initial UL BWP is used

\- else, the RB numbering starts from the first RB of the active UL BWP
and the maximum number of RBs for frequency domain resource allocation
equals the number of RBs in the initial UL BWP

The frequency domain resource allocation is by uplink resource
allocation type 1 \[6, TS 38.214\]. For an initial UL BWP size of RBs, a
UE processes the frequency domain resource assignment field as follows

\- if

\- truncate the frequency domain resource assignment field to its least
significant bits and interpret the truncated frequency resource
assignment field as for the frequency resource assignment field in DCI
format 0\_0 as described in \[5, TS 38.212\]

\- else

\- insert most significant bits with value set to \'0\' after the bits
to the frequency domain resource assignment field, where if the
frequency hopping flag is set to \'0\' and is provided in Table 8.3-1 if
the hopping flag bit is set to \'1\', and interpret the expanded
frequency resource assignment field as for the frequency resource
assignment field in DCI format 0\_0 as described in \[5, TS 38.212\]

\- end if

A UE determines whether or not to apply transform precoding as described
in \[6, TS 38.214\].

For a PUSCH transmission with frequency hopping scheduled by RAR UL
grant or for a Msg3 PUSCH retransmission, the frequency offset for the
second hop \[6, TS 38.214\] is given in Table 8.3-1.

Table 8.3-1: Frequency offset for second hop of PUSCH transmission with
frequency hopping scheduled by RAR UL grant or of Msg3 PUSCH
retransmission

  **Number of PRBs in initial UL BWP**   Value of Hopping Bits   Frequency offset for 2^nd^ hop
  -------------------------------------- ----------------------- --------------------------------
                                         0                       ![](./media/image455.wmf)
                                         1                       ![](./media/image456.wmf)
                                         00                      ![](./media/image458.wmf)
                                         01                      ![](./media/image459.wmf)
                                         10                      ![](./media/image460.wmf)
                                         11                      Reserved

A SCS for the PUSCH transmission is provided by *subcarrierSpacing* in
*BWP-UplinkCommon*. A UE transmits PRACH and the PUSCH on a same uplink
carrier of a same serving cell.

A UE transmits a transport block in a PUSCH scheduled by a RAR UL grant
in a corresponding RAR message using redundancy version number 0. If a
TC-RNTI is provided by higher layers, the scrambling initialization of
the PUSCH corresponding to the RAR UL grant in clause 8.2 is by TC-RNTI.
Otherwise, the scrambling initialization of the PUSCH corresponding to
the RAR UL grant in clause 8.2 is by C-RNTI. Msg3 PUSCH retransmissions,
if any, of the transport block, are scheduled by a DCI format 0\_0 with
CRC scrambled by a TC-RNTI provided in the corresponding RAR message
\[11, TS 38.321\]. The UE always transmits the PUSCH scheduled by a RAR
UL grant without repetitions[.]{.underline}

With reference to slots for a PUSCH transmission scheduled by a RAR UL
grant, if a UE receives a PDSCH with a RAR message ending in slot for a
corresponding PRACH transmission from the UE, the UE transmits the PUSCH
in slot , where and are provided in \[6, TS 38.214\].

The UE may assume a minimum time between the last symbol of a PDSCH
reception conveying a RAR message with a RAR UL grant and the first
symbol of a corresponding PUSCH transmission scheduled by the RAR UL
grant is equal to msec, where is a time duration of symbols
corresponding to a PDSCH processing time for UE processing capability 1
when additional PDSCH DM-RS is configured, is a time duration of symbols
corresponding to a PUSCH preparation time for UE processing capability 1
\[6, TS 38.214\] and, for determining the minimum time, the UE considers
that and correspond to the smaller of the SCS configurations for the
PDSCH and the PUSCH. For , the UE assumes \[6, TS 38.214\].

8.4 PDSCH with UE contention resolution identity
------------------------------------------------

In response to a PUSCH transmission scheduled by a RAR UL grant when a
UE has not been provided a C-RNTI, the UE attempts to detect a DCI
format 1\_0 with CRC scrambled by a corresponding TC-RNTI scheduling a
PDSCH that includes a UE contention resolution identity \[11, TS
38.321\]. In response to the PDSCH reception with the UE contention
resolution identity, the UE transmits HARQ-ACK information in a PUCCH.
The PUCCH transmission is within a same active UL BWP as the PUSCH
transmission. A minimum time between the last symbol of the PDSCH
reception and the first symbol of the corresponding PUCCH transmission
with the HARQ-ACK information is equal to msec. is a time duration of
symbols corresponding to a PDSCH processing time for UE processing
capability 1 when additional PDSCH DM-RS is configured. For , the UE
assumes \[6, TS 38.214\].

When detecting a DCI format in response to a PUSCH transmission
scheduled by a RAR UL grant, as described in \[11, TS 38.321\], or
corresponding PUSCH retransmission scheduled by a DCI format 0\_0 with
CRC scrambled by a TC-RNTI provided in the corresponding RAR message
\[11, TS 38.321\], the UE may assume the PDCCH carrying the DCI format
has the same DM-RS antenna port quasi co-location properties, as
described in \[6, TS 38.214\], as for a SS/PBCH block the UE used for
PRACH association, as described in Clause 8.1, regardless of whether or
not the UE is provided TCI-State for the CORESET where the UE receives
the PDCCH with the DCI format.

9 UE procedure for reporting control information
================================================

If a UE is configured with a SCG, the UE shall apply the procedures
described in this clause for both MCG and SCG.

\- When the procedures are applied for MCG, the terms \'secondary
cell\', \'secondary cells\' , \'serving cell\', \'serving cells\' in
this clause refer to secondary cell, secondary cells, serving cell,
serving cells belonging to the MCG respectively.

\- When the procedures are applied for SCG, the terms \'secondary
cell\', \'secondary cells\', \'serving cell\', \'serving cells\' in this
clause refer to secondary cell, secondary cells (not including PSCell),
serving cell, serving cells belonging to the SCG respectively. The term
\'primary cell\' in this clause refers to the PSCell of the SCG.

If the UE is configured with a PUCCH-SCell, the UE shall apply the
procedures described in this clause for both primary PUCCH group and
secondary PUCCH group

\- When the procedures are applied for the primary PUCCH group, the
terms \'secondary cell\', \'secondary cells\' , \'serving cell\',
\'serving cells\' in this clause refer to secondary cell, secondary
cells, serving cell, serving cells belonging to the primary PUCCH group
respectively.

\- When the procedures are applied for secondary PUCCH group, the terms
\'secondary cell\', \'secondary cells\', \'serving cell\', \'serving
cells\' in this clause refer to secondary cell, secondary cells (not
including the PUCCH-SCell), serving cell, serving cells belonging to the
secondary PUCCH group respectively. The term \'primary cell\' in this
clause refers to the PUCCH-SCell of the secondary PUCCH group.

If a UE is configured for NR-DC operation, the UE does not expect to be
configured with a PUCCH-SCell.

If a UE would transmit on a serving cell a PUSCH without UL-SCH that
overlaps with a PUCCH transmission on a serving cell that includes
positive SR information, the UE does not transmit the PUSCH.

If a UE would transmit CSI reports on overlapping physical channels, the
UE applies the priority rules described in \[6, TS 38.214\] for the
multiplexing of CSI reports.

If a UE has overlapping resources for PUCCH transmissions in a slot and
at least one of the PUCCH transmissions is with repetitions over
multiple slots, the UE first follows the procedures described in Clause
9.2.6 for resolving the overlapping among the resources for the PUCCH
transmissions.

If a UE

\- would multiplex UCI in a PUCCH transmission that overlaps with a
PUSCH transmission, and

\- the PUSCH and PUCCH transmissions fulfill the conditions in Clause
9.2.5 for UCI multiplexing,

the UE

\- multiplexes only HARQ-ACK information, if any, from the UCI in the
PUSCH transmission and does not transmit the PUCCH if the UE multiplexes
aperiodic or semi-persistent CSI reports in the PUSCH;

\- multiplexes only HARQ-ACK information and CSI reports, if any, from
the UCI in the PUSCH transmission and does not transmit the PUCCH if the
UE does not multiplex aperiodic or semi-persistent CSI reports in the
PUSCH.

A UE does not expect to multiplex in a PUSCH transmission in one slot
with SCS configuration UCI of same type that the UE would transmit in
PUCCHs in different slots with SCS configuration if .

**A UE does not expect a PUCCH resource that results from multiplexing
overlapped PUCCH resources, if applicable, to overlap with more than one
PUSCHs if each of the more than one PUSCHs includes** aperiodic CSI
reports.

A UE does not expect to detect a DCI format scheduling a PDSCH reception
or a SPS PDSCH release and indicating a resource for a PUCCH
transmission with corresponding HARQ-ACK information in a slot if the UE
previously detects a DCI format scheduling a PUSCH transmission in the
slot and if the UE multiplexes HARQ-ACK information in the PUSCH
transmission.

If a UE multiplexes aperiodic CSI in a PUSCH and the UE would multiplex
UCI that includes HARQ-ACK information in a PUCCH that overlaps with the
PUSCH and the timing conditions for overlapping PUCCHs and PUSCHs in
Clause 9.2.5 are fulfilled, the UE multiplexes only the HARQ-ACK
information in the PUSCH and does not transmit the PUCCH.

If a UE transmits multiple PUSCHs in a slot on respective serving cells
that include first PUSCHs that are scheduled by DCI format(s) 0\_0 or
DCI format(s) 0\_1 and second PUSCHs configured by respective
*ConfiguredGrantConfig* or *semiPersistentOnPUSCH*, and the UE would
multiplex UCI in one of the multiple PUSCHs, and the multiple PUSCHs
fulfil the conditions in Clause 9.2.5 for UCI multiplexing, the UE
multiplexes the UCI in a PUSCH from the first PUSCHs.

If a UE transmits multiple PUSCHs in a slot on respective serving cells
and the UE would multiplex UCI in one of the multiple PUSCHs and the UE
does not multiplex aperiodic CSI in any of the multiple PUSCHs, the UE
multiplexes the UCI in a PUSCH of the serving cell with the smallest
*ServCellIndex* subject to the conditions in Clause 9.2.5 for UCI
multiplexing being fulfilled. If the UE transmits more than one PUSCHs
in the slot on the serving cell with the smallest *ServCellIndex* that
fulfil the conditions in Clause 9.2.5 for UCI multiplexing, the UE
multiplexes the UCI in the earliest PUSCH that the UE transmits in the
slot.

If a UE transmits a PUSCH over multiple slots and the UE would transmit
a PUCCH with HARQ-ACK and/or CSI information over a single slot and in a
slot that overlaps with the PUSCH transmission in one or more slots of
the multiple slots, and the PUSCH transmission in the one or more slots
fulfills the conditions in Clause 9.2.5 for multiplexing the HARQ-ACK
and/or CSI information, the UE multiplexes the HARQ-ACK and/or CSI
information in the PUSCH transmission in the one or more slots. The UE
does not multiplex HARQ-ACK and/or CSI information in the PUSCH
transmission in a slot from the multiple slots if the UE would not
transmit a single-slot PUCCH with HARQ-ACK and/or CSI information in the
slot in case the PUSCH transmission was absent.

If the PUSCH transmission over the multiple slots is scheduled by a DCI
format 0\_1, the same value of a DAI field is applicable for
multiplexing HARQ-ACK information in the PUSCH transmission in any slot
from the multiple slots where the UE multiplexes HARQ-ACK information.

A HARQ-ACK information bit value of 0 represents a negative
acknowledgement (NACK) while a HARQ-ACK information bit value of 1
represents a positive acknowledgement (ACK).

9.1 HARQ-ACK codebook determination
-----------------------------------

If a UE receives a PDSCH without receiving a corresponding PDCCH, or if
the UE receives a PDCCH indicating a SPS PDSCH release, the UE generates
one corresponding HARQ-ACK information bit.

If a UE is not provided *PDSCH-CodeBlockGroupTransmission*, the UE
generates one HARQ-ACK information bit per transport block.

For a HARQ-ACK information bit, a UE generates an ACK if the UE detects
a DCI format 1\_0 that provides a SPS PDSCH release or correctly decodes
a transport block, and generates a NACK if the UE does not correctly
decode the transport block.

A UE does not expect to be indicated to transmit HARQ-ACK information
for more than one SPS PDSCH receptions in a same PUCCH.

In the following, the CRC for DCI format 1\_0 or DCI format 1\_1 is
scrambled with a C-RNTI, an MCS-C-RNTI, or a CS-RNTI.

### 9.1.1 CBG-based HARQ-ACK codebook determination

If a UE is provided *PDSCH-CodeBlockGroupTransmission* for a serving
cell, the UE receives a PDSCH scheduled by DCI format 1\_1, that
includes code block groups (CBGs) of a transport block. The UE is also
provided *maxCodeBlockGroupsPerTransportBlock* indicating a maximum
number ![](./media/image472.wmf){width="0.6375in"
height="0.25277777777777777in"} of CBGs for generating respective
HARQ-ACK information bits for a transport block reception for the
serving cell.

For a number of code blocks (CBs) in a transport block, the UE
determines a number of CBGs according to Clause 5.1.7.1 of \[6, TS
38.214\] and determines a number of HARQ-ACK bits for the transport
block as .

The UE generates an ACK for the HARQ-ACK information bit of a CBG if the
UE correctly received all code blocks of the CBG and generates a NACK
for the HARQ-ACK information bit of a CBG if the UE incorrectly received
at least one code block of the CBG. If the UE receives two transport
blocks, the UE concatenates the HARQ-ACK information bits for CBGs of
the second transport block after the HARQ-ACK information bits for CBGs
of the first transport block.

The HARQ-ACK codebook includes the HARQ-ACK information bits and, if for
a transport block, the UE generates a NACK value for the last HARQ-ACK
information bits for the transport block in the HARQ-ACK codebook.

If the UE generates a HARQ-ACK codebook in response to a retransmission
of a transport block, corresponding to a same HARQ process as a previous
transmission of the transport block, the UE generates an ACK for each
CBG that the UE correctly decoded in a previous transmission of the
transport block.

If a UE correctly detects each of the CBGs and does not correctly detect
the transport block for the CBGs, the UE generates a NACK value for each
of the CBGs.

### 9.1.2 Type-1 HARQ-ACK codebook determination

This clause applies if the UE is configured with
*pdsch-HARQ-ACK-Codebook = semi-static*.

A UE reports HARQ-ACK information for a corresponding PDSCH reception or
SPS PDSCH release only in a HARQ-ACK codebook that the UE transmits in a
slot indicated by a value of a PDSCH-to-HARQ\_feedback timing indicator
field in a corresponding DCI format 1\_0 or DCI format 1\_1. The UE
reports NACK value(s) for HARQ-ACK information bit(s) in a HARQ-ACK
codebook that the UE transmits in a slot not indicated by a value of a
PDSCH-to-HARQ\_feedback timing indicator field in a corresponding DCI
format 1\_0 or DCI format 1\_1.

If the UE is provided *pdsch-AggregationFactor*, is a value of
*pdsch-AggregationFactor*; otherwise, . The UE reports HARQ-ACK
information for a PDSCH reception from slot to slot only in a HARQ-ACK
codebook that the UE includes in a PUCCH or PUSCH transmission in slot ,
where is a number of slots indicated by the PDSCH-to-HARQ\_feedback
timing indicator field in a corresponding DCI format or provided by
*dl-DataToUL-ACK* if the PDSCH-to-HARQ\_feedback timing indicator field
is not present in the DCI format. If the UE reports HARQ-ACK information
for the PDSCH reception in a slot other than slot , the UE sets a value
for each corresponding HARQ-ACK information bit to NACK.

If a UE reports HARQ-ACK information in a PUCCH only for

\- a SPS PDSCH release indicated by DCI format 1\_0 with counter DAI
field value of 1 on the PCell, or

\- a PDSCH reception scheduled by DCI format 1\_0 with counter DAI field
value of 1 on the PCell, or

\- SPS PDSCH reception

within the occasions for candidate PDSCH receptions as determined in
Clause 9.1.2.1, the UE determines a HARQ-ACK codebook only for the SPS
PDSCH release or only for the PDSCH reception or only for the SPS PDSCH
reception according to corresponding occasion(s) on respective serving
cell(s), where the value of counter DAI in DCI format 1\_0 is according
to Table 9.1.3-1; otherwise, the procedures in Clause 9.1.2.1 and Clause
9.1.2.2 for a HARQ-ACK codebook determination apply.

#### 9.1.2.1 Type-1 HARQ-ACK codebook in physical uplink control channel

For a serving cell , an active DL BWP, and an active UL BWP, as
described in Clause 12, the UE determines a set of occasions for
candidate PDSCH receptions for which the UE can transmit corresponding
HARQ-ACK information in a PUCCH in slot . If serving cell is
deactivated, the UE uses as the active DL BWP for determining the set of
occasions for candidate PDSCH receptions a DL BWP provided by
*firstActiveDownlinkBWP-Id*. The determination is based:

a\) on a set of slot timing values associated with the active UL BWP

a\) If the UE is configured to monitor PDCCH for DCI format 1\_0 and is
not configured to monitor PDCCH for DCI format 1\_1 on serving cell , is
provided by the slot timing values {1, 2, 3, 4, 5, 6, 7, 8} for DCI
format 1\_0

b\) If the UE is configured to monitor PDCCH for DCI format 1\_1 for
serving cell , is provided by *dl-DataToUL-ACK* for DCI format 1\_1

b\) on a set of row indexes of a table that is provided either by a
first set of row indexes of a table that is provided by
*pdsch-TimeDomainAllocationList* in *pdsch-ConfigCommon* or by Default
PDSCH time domain resource allocation A \[6, TS 38.214\], or by the
union of the first set of row indexes and a second set of row indexes,
if provided by *pdsch-TimeDomainAllocationList* in *pdsch-Config*,
associated with the active DL BWP and defining respective sets of slot
offsets , start and length indicators *SLIV*, and PDSCH mapping types
for PDSCH reception as described in \[6, TS 38.214\]

c\) on the ratio between the downlink SCS configuration and the uplink
SCS configuration provided by *subcarrierSpacing* in *BWP-Downlink* and
*BWP-Uplink* for the active DL BWP and the active UL BWP, respectively

d\) if provided, on *tdd-UL-DL-ConfigurationCommon* and
*tdd-UL-DL-ConfigurationDedicated* as described in Clause 11.1.

For the set of slot timing values , the UE determines a set of occasions
for candidate PDSCH receptions or SPS PDSCH releases according to the
following pseudo-code. A location in the Type-1 HARQ-ACK codebook for
HARQ-ACK information corresponding to a SPS PDSCH release is same as for
a corresponding SPS PDSCH reception.

Set - index of occasion for candidate PDSCH reception or SPS PDSCH
release

Set

Set

Set to the cardinality of set

Set *k* =0 -- index of slot timing values , in descending order of the
slot timing values, in set for serving cell

while

if

Set -- index of a DL slot within an UL slot

while

Set to the set of rows

Set to the cardinality of

Set -- index of row in set

> if slot starts at a same time as or after a slot for an active DL BWP
> change on serving cell or an active UL BWP change on the PCell and
> slot is before the slot for the active DL BWP change on serving cell
> or the active UL BWP change on the PCell

$n_{D} = n_{D} + 1$;

else

while

> if the UE is provided *tdd-UL-DL-ConfigurationCommon*, or
> *tdd-UL-DL-ConfigurationDedicated* and, for each slot from slot to
> slot , at least one symbol of the PDSCH time resource derived by row
> is configured as UL where is the *k*-th slot timing value in set ,
>
> ;

else

> ;

end if

end while

if the UE does not indicate a capability to receive more than one
unicast PDSCH per slot and ,

;

;

The UE does not expect to receive SPS PDSCH release and unicast PDSCH in
a same slot;

else

Set to the cardinality of

Set to the smallest last OFDM symbol index, as determined by the *SLIV*,
among all rows of

while

> Set
>
> while
>
> if for start OFDM symbol index for row
>
> ; - index of occasion for candidate PDSCH reception or SPS PDSCH
> release associated with row
>
> ;
>
> ;
>
> else
>
> ;
>
> end if
>
> end while
>
> ;
>
> Set to the smallest last OFDM symbol index among all rows of ;

end while

end if

$n_{D} = n_{D} + 1$;

end if

end while

end if

;

end while

If the UE indicates a capability to receive more than one PDSCH per
slot, for occasions of candidate PDSCH receptions corresponding to rows
of associated with a same value of , where , the UE does not expect to
receive more than one PDSCH in a same DL slot.

If a UE receives a SPS PDSCH, or a SPS PDSCH release, or a PDSCH that is
scheduled by a DCI format 1\_0 and if

\- the UE is configured with one serving cell, and

\- , and

\- *PDSCH-CodeBlockGroupTransmission* is provided to the UE

the UE generates HARQ-ACK information only for the transport block in
the PDSCH or only for the SPS PDSCH release.

If a UE receives a SPS PDSCH, or a SPS PDSCH release, or a PDSCH that is
scheduled by a DCI format 1\_0 and if

\- the UE is configured with more than one serving cells, or

\- , and

\- *PDSCH-CodeBlockGroupTransmission* is provided to the UE

the UE repeats times the HARQ-ACK information for the transport block in
the PDSCH or for the SPS PDSCH release.

A UE does not expect to detect a DCI format switching a DL BWP within
symbols prior to a first symbol of a PUCCH transmission where the UE
multiplexes HARQ-ACK information, where is defined in Clause 9.2.3.

If a UE is provided *dl-DataToUL-ACK*, the UE does not expect to be
indicated by DCI format 1\_0 a slot timing value for transmission of
HARQ-ACK information that does not belong to the intersection of the set
of slot timing values {1, 2, 3, 4, 5, 6, 7, 8} and the set of slot
timing values provided by *dl-DataToUL-ACK* for the active DL BWP of a
corresponding serving cell.

If *maxNrofCodeWordsScheduledByDCI* indicates reception of two transport
blocks, when the UE receives a PDSCH with one transport block or a SPS
PDSCH release, the HARQ-ACK information is associated with the first
transport block and the UE generates a NACK for the second transport
block if *harq-ACK-SpatialBundlingPUCCH* is not provided and generates
HARQ-ACK information with value of ACK for the second transport block if
*harq-ACK-SpatialBundlingPUCCH* is provided.

A UE determines
${\widetilde{o}}_{0}^{\text{ACK}}\text{,\ }{\widetilde{o}}_{1}^{\text{ACK}}\text{,...,}{\widetilde{o}}_{O_{\text{ACK}} - 1}^{\text{ACK}}$
HARQ-ACK information bits, for a total number of HARQ-ACK information
bits, of a HARQ-ACK codebook for transmission in a PUCCH according to
the following pseudo-code. In the following pseudo-code, if the UE does
not receive a transport block or a CBG, due to the UE not detecting a
corresponding DCI format 1\_0 or DCI format 1\_1, the UE generates a
NACK value for the transport block or the CBG. The cardinality of the
set defines a total number of occasions for PDSCH reception or SPS PDSCH
release for serving cell corresponding to the HARQ-ACK information bits.

Set -- serving cell index: lower indexes correspond to lower RRC indexes
of corresponding cell

Set - HARQ-ACK information bit index

Set to the number of serving cells configured by higher layers for the
UE

while

Set -- index of occasion for candidate PDSCH reception or SPS PDSCH
release

while

if *harq-ACK-SpatialBundlingPUCCH* is not provided,
*PDSCH-CodeBlockGroupTransmission* is not provided, and the UE is
configured by *maxNrofCodeWordsScheduledByDCI* with reception of two
transport blocks for the active DL BWP of serving cell ,

= HARQ-ACK information bit corresponding to a first transport block of
this cell;

;

= HARQ-ACK information bit corresponding to a second transport block of
this cell;

;

elseif *harq-ACK-SpatialBundlingPUCCH* is provided, and the UE is
configured by *maxNrofCodeWordsScheduledByDCI* with reception of two
transport blocks for the active DL BWP of serving cell ,

= binary AND operation of the HARQ-ACK information bits corresponding to
first and second transport blocks of this cell - if the UE receives one
transport block, the UE assumes ACK for the second transport block;

;

elseif *PDSCH-CodeBlockGroupTransmission* is provided, and CBGs are
indicated by *maxCodeBlockGroupsPerTransportBlock* for serving cell ,

Set - CBG index

while

= HARQ-ACK information bit corresponding to CBG of the first transport
block;

if the UE is configured by *maxNrofCodeWordsScheduledByDCI* with
reception of two transport blocks for the active DL BWP of serving cell

= HARQ-ACK information bit corresponding to CBG of the second transport
block;

end if

;

end while

, where is the value of *maxNrofCodeWordsScheduledByDCI* for the active
DL BWP of serving cell ;

else

= HARQ-ACK information bit of serving cell ;

;

end if

;

end while

;

end while

If , the UE determines a number of HARQ-ACK information bits for
obtaining a transmission power for a PUCCH, as described in Clause
7.2.1, as where

\- is the number of transport blocks the UE receives in PDSCH reception
occasion for serving cell if *harq-ACK-SpatialBundlingPUCCH* and
*PDSCH-CodeBlockGroupTransmission* are not provided, or the number of
transport blocks the UE receives in PDSCH reception occasion for serving
cell if *PDSCH-CodeBlockGroupTransmission* is provided and the PDSCH
reception is scheduled by a DCI format 1\_0, or the number of PDSCH
receptions if *harq-ACK-SpatialBundlingPUCCH* is provided or SPS PDSCH
release in PDSCH reception occasion for serving cell and the UE reports
corresponding HARQ-ACK information in the PUCCH.

\- is the number of CBGs the UE receives in a PDSCH reception occasion
for serving cell if *PDSCH-CodeBlockGroupTransmission* is provided and
the PDSCH reception is scheduled by a DCI format 1\_1 and the UE reports
corresponding HARQ-ACK information in the PUCCH.

#### 9.1.2.2 Type-1 HARQ-ACK codebook in physical uplink shared channel

If a UE would multiplex HARQ-ACK information in a PUSCH transmission
that is not scheduled by a DCI format or is scheduled by DCI format
0\_0, then

*- if the* UE has not received any PDSCH or SPS PDSCH release that the
UE transmits corresponding HARQ-ACK information in the PUSCH, based on a
value of a respective PDSCH-to-HARQ\_feedback timing indicator field in
a DCI format scheduling the PDSCH reception or the SPS PDSCH release or
on the value of *dl-DataToUL-ACK* if the PDSCH-to-HARQ\_feedback timing
indicator field is not present in the DCI format, in any of the
occasions for candidate PDSCH receptions by DCI format 1\_0 or DCI
format 1\_1 or SPS PDSCH on any serving cell , as described in Clause
9.1.2.1*,* the UE does not multiplex HARQ-ACK information in the PUSCH
transmission;

\- else the UE generates the HARQ-ACK codebook as described in Clause
9.1.2.1, except that *harq-ACK-SpatialBundlingPUCCH* is replaced by
*harq-ACK-SpatialBundlingPUSCH*, unless the UE receives only a SPS PDSCH
release, or only SPS PDSCH reception, or only a PDSCH that is scheduled
by DCI format 1\_0 with a counter DAI field value of 1 on the PCell in
the occasions for candidate PDSCH receptions in which case the UE
generates HARQ-ACK information only for the SPS PDSCH release or only
for the PDSCH reception as described in Clause 9.1.2.

A UE sets to NACK value in the HARQ-ACK codebook any HARQ-ACK
information corresponding to PDSCH reception or SPS PDSCH release that
the UE detects in a PDCCH monitoring occasion that starts after a PDCCH
monitoring occasion where the UE detects a DCI format 0\_0 or a DCI
format 0\_1 scheduling the PUSCH transmission.

A UE does not expect to detect a DCI format switching a DL BWP within
symbols prior to a first symbol of a PUSCH transmission where the UE
multiplexes HARQ-ACK information, where is defined in \[6, TS 38.214\].

If a UE multiplexes HARQ-ACK information in a PUSCH transmission that is
scheduled by DCI format 0\_1, the UE generates the HARQ-ACK codebook as
described in Clause 9.1.2.1 when a value of the DAI field in DCI format
0\_1 is except that *harq-ACK-SpatialBundlingPUCCH* is replaced by
*harq-ACK-SpatialBundlingPUSCH*. The UE does not generate a HARQ-ACK
codebook for multiplexing in the PUSCH transmission when unless the UE
receives only a SPS PDSCH release, or only a SPS PDSCH, or only a PDSCH
that is scheduled by DCI format 1\_0 with a counter DAI field value of 1
on the PCell in the occasions for candidate PDSCH receptions in which
case the UE generates HARQ-ACK information only for the SPS PDSCH
release or only for the PDSCH reception as described in Clause 9.1.2. if
the DAI field in DCI format 0\_1 is set to \'0\'; otherwise, .

### 9.1.3 Type-2 HARQ-ACK codebook determination 

This clause applies if the UE is configured with
*pdsch-HARQ-ACK-Codebook = dynamic*.

#### 9.1.3.1 Type-2 HARQ-ACK codebook in physical uplink control channel

A UE determines monitoring occasions for PDCCH with DCI format 1\_0 or
DCI format 1\_1 for scheduling PDSCH receptions or SPS PDSCH release on
an active DL BWP of a serving cell , as described in Clause 10.1, and
for which the UE transmits HARQ-ACK information in a same PUCCH in slot
based on

\- PDSCH-to-HARQ\_feedback timing indicator field values for PUCCH
transmission with HARQ-ACK information in slot in response to PDSCH
receptions or SPS PDSCH release

\- slot offsets \[6, TS 38.214\] provided by time domain resource
assignment field in DCI format 1\_0 or DCI format 1\_1 for scheduling
PDSCH receptions and by *pdsch-AggregationFactor*, when provided.

The set of PDCCH monitoring occasions for DCI format 1\_0 or DCI format
1\_1 for scheduling PDSCH receptions or SPS PDSCH release is defined as
the union of PDCCH monitoring occasions across active DL BWPs of
configured serving cells, ordered in ascending order of start time of
the search space set associated with a PDCCH monitoring occasion. The
cardinality of the set of PDCCH monitoring occasions defines a total
number of PDCCH monitoring occasions.

A value of the counter downlink assignment indicator (DAI) field in DCI
format 1\_0 or DCI format 1\_1 denotes the accumulative number of
{serving cell, PDCCH monitoring occasion}-pair(s) in which PDSCH
reception(s) or SPS PDSCH release associated with DCI format 1\_0 or DCI
format 1\_1 is present, up to the current serving cell and current PDCCH
monitoring occasion, first in ascending order of serving cell index and
then in ascending order of PDCCH monitoring occasion index , where .

The value of the total DAI, when present \[5, TS 38.212\], in DCI format
1\_1 denotes the total number of {serving cell, PDCCH monitoring
occasion}-pair(s) in which PDSCH reception(s) or SPS PDSCH release
associated with DCI format 1\_0 or DCI format 1\_1 is present, up to the
current PDCCH monitoring occasion and is updated from PDCCH monitoring
occasion to PDCCH monitoring occasion.

Denote by the value of the counter DAI in DCI format 1\_0 or DCI format
1\_1 for scheduling on serving cell in PDCCH monitoring occasion
according to Table 9.1.3-1. Denote by the value of the total DAI in DCI
format 1\_1 in PDCCH monitoring occasion according to Table 9.1.3-1. The
UE assumes a same value of total DAI in all DCI formats 1\_1 in PDCCH
monitoring occasion .

If the UE transmits HARQ-ACK information in a PUCCH in slot and for any
PUCCH format, the UE determines the , for a total number of HARQ-ACK
information bits, according to the following pseudo-code:

Set -- PDCCH with DCI format 1\_0 or DCI format 1\_1 monitoring occasion
index: lower index corresponds to earlier PDCCH with DCI format 1\_0 or
DCI format 1\_1 monitoring occasion

Set

Set

Set

Set

Set to the number of serving cells configured by higher layers for the
UE

Set to the number of PDCCH monitoring occasion(s)

while

Set -- serving cell index: lower indexes correspond to lower RRC indexes
of corresponding cell

while

> if PDCCH monitoring occasion is before an active DL BWP change on
> serving cell or an active UL BWP change on the PCell and an active DL
> BWP change is not triggered by a DCI format 1\_1 in PDCCH monitoring
> occasion

;

else

> if there is a PDSCH on serving cell associated with PDCCH in PDCCH
> monitoring occasion , or there is a PDCCH indicating SPS PDSCH release
> on serving cell

if

end if

if

else

end if

> if *harq-ACK-SpatialBundlingPUCCH* is not provided and is a monitoring
> occasion for PDCCH with DCI format 1\_0 or DCI format 1\_1 and the UE
> is configured by *maxNrofCodeWordsScheduledByDCI* with reception of
> two transport blocks for at least one configured DL BWP of at least
> one serving cell,
>
> = HARQ-ACK information bit corresponding to the first transport block
> of this cell
>
> = HARQ-ACK information bit corresponding to the second transport block
> of this cell
>
> elseif *harq-ACK-SpatialBundlingPUCCH* is provided to the UE and is a
> monitoring occasion for PDCCH with DCI format 1\_1 and the UE is
> configured by *maxNrofCodeWordsScheduledByDCI* with reception of two
> transport blocks in at least one configured DL BWP of a serving cell,
>
> = binary AND operation of the HARQ-ACK information bits corresponding
> to the first and second transport blocks of this cell

else

> = HARQ-ACK information bit of this cell

end if

end if

end if

end while

end while

if

end if

> if *harq-ACK-SpatialBundlingPUCCH* is not provided to the UE and the
> UE is configured by *maxNrofCodeWordsScheduledByDCI* with reception of
> two transport blocks for at least one configured DL BWP of a serving
> cell,

else

end if

for any

Set

while

> if SPS PDSCH reception is activated for a UE and the UE is configured
> to receive SPS PDSCH in a slot for serving cell , where is the
> PDSCH-to-HARQ-feedback timing value for SPS PDSCH on serving cell

= HARQ-ACK information bit associated with the SPS PDSCH reception

end if

;

end while

For a PDCCH monitoring occasion with DCI format 1\_0 or DCI format 1\_1
in the active DL BWP of a serving cell, when a UE receives a PDSCH with
one transport block or a SPS PDSCH release, and the value of
*maxNrofCodeWordsScheduledByDCI* is 2, the HARQ-ACK information is
associated with the first transport block and the UE generates a NACK
for the second transport block if *harq-ACK-SpatialBundlingPUCCH* is not
provided and generates HARQ-ACK information with value of ACK for the
second transport block if *harq-ACK-SpatialBundlingPUCCH* is provided.

If a UE is not provided *PDSCH-CodeBlockGroupTransmission* for each of
the serving cells, or for PDSCH receptions scheduled by DCI format 1\_0,
or for SPS PDSCH reception, or for SPS PDSCH release, and if , the UE
determines a number of HARQ-ACK information bits for obtaining a
transmission power for a PUCCH, as described in Clause 7.2.1, as

where

\- if , is the value of the counter DAI in the last DCI format 1\_0 or
DCI format 1\_1 scheduling PDSCH reception or indicating SPS PDSCH
release for any serving cell that the UE detects within the PDCCH
monitoring occasions.

> \- if
>
> \- if the UE does not detect any DCI format 1\_1 in a last PDCCH
> monitoring occasion within the PDCCH monitoring occasions where the UE
> detects at least one DCI format scheduling PDSCH reception or
> indicating SPS PDSCH release for any serving cell , is the value of
> the counter DAI in a last DCI format 1\_0 the UE detects in the last
> PDCCH monitoring occasion
>
> \- if the UE detects at least one DCI format 1\_1 in a last PDCCH
> monitoring occasion within the PDCCH monitoring occasions where the UE
> detects at least one DCI format scheduling PDSCH reception or
> indicating SPS PDSCH release for any serving cell , is the value of
> the total DAI in the at least one DCI format 1\_1

\- if the UE does not detect any DCI format 1\_0 or DCI format 1\_1
scheduling PDSCH reception or indicating SPS PDSCH release for any
serving cell in any of the PDCCH monitoring occasions.

\- is the total number of DCI format 1\_0 and DCI format 1\_1 scheduling
PDSCH receptions or indicating SPS PDSCH release that the UE detects
within the PDCCH monitoring occasions for serving cell . if the UE does
not detect any DCI format 1\_0 or DCI format 1\_1 scheduling PDSCH
reception or indicating SPS PDSCH release for serving cell in any of the
PDCCH monitoring occasions.

\- if the value of *maxNrofCodeWordsScheduledByDCI* is 2 for any serving
cell and *harq-ACK-SpatialBundlingPUCCH* is not provided; otherwise, .

\- is the number of transport blocks the UE receives in a PDSCH
scheduled by DCI format 1\_0 or DCI format 1\_1 that the UE detects in
PDCCH monitoring occasion for serving cell if
*harq-ACK-SpatialBundlingPUCCH* is not provided, or the number of PDSCH
scheduled by DCI format 1\_0 and DCI format 1\_1 that the UE detects in
PDCCH monitoring occasion for serving cell if
*harq-ACK-SpatialBundlingPUCCH* is provided, or the number of DCI format
1\_0 that the UE detects and indicate SPS PDSCH release in PDCCH
monitoring occasion for serving cell .

\- is the number of SPS PDSCH receptions by the UE on serving cell for
which the UE transmits corresponding HARQ-ACK information in the same
PUCCH as for HARQ-ACK information corresponding to PDSCH receptions
within the PDCCH monitoring occasions.

If a UE

\- is provided *PDSCH-CodeBlockGroupTransmission* for serving cells; and

\- is not provided *PDSCH-CodeBlockGroupTransmission*, for serving cells
where

the UE determines the according to the previous pseudo-code with the
following modifications

\- is used for the determination of a first HARQ-ACK sub-codebook for
SPS PDSCH release, SPS PDSCH reception, and for TB-based PDSCH
receptions scheduled by DCI formats 1\_0 on the serving cells and by DCI
formats 1\_0 and DCI formats 1\_1 on the serving cells

\- is replaced by for the determination of a second HARQ-ACK
sub-codebook corresponding to the serving cells for CBG-based PDSCH
receptions scheduled by DCI format 1\_1, and

\- Instead of generating one HARQ-ACK information bit per transport
block for a serving cell from the serving cells, the UE generates
HARQ-ACK information bits, where is the maximum value of across all
serving cells and is the value of *maxNrofCodeWordsScheduledByDCI* for
serving cell . If for a serving cell it is , the UE generates NACK for
the last HARQ-ACK information bits for serving cell

\- The pseudo-code operation when *harq-ACK-SpatialBundlingPUCCH* is
provided is not applicable

\- The counter DAI value and the total DAI value apply separately for
each HARQ-ACK sub-codebook

\- The UE generates the HARQ-ACK codebook by appending the second
HARQ-ACK sub-codebook to the first HARQ-ACK sub-codebook

> If , the UE also determines for obtaining a PUCCH transmission power,
> as described in Clause 7.2.1, with
>
> where

\- if , is the value of the counter DAI in the last DCI format 1\_1
scheduling CBG-based PDSCH reception for any serving cell that the UE
detects within the PDCCH monitoring occasions

\- if , is the value of the total DAI in the last DCI format 1\_1
scheduling CBG-based PDSCH reception for any serving cell that the UE
detects within the PDCCH monitoring occasions

\- if the UE does not detect any DCI format 1\_1 scheduling CBG-based
PDSCH reception for any serving cell in any of the PDCCH monitoring
occasions

\- is the total number of DCI format 1\_1 scheduling CBG-based PDSCH
receptions that the UE detects within the PDCCH monitoring occasions for
serving cell . if the UE does not detect any DCI format 1\_1 scheduling
CBG-based PDSCH reception for serving cell in any of the PDCCH
monitoring occasions

\- is the number of CBGs the UE receives in a PDSCH scheduled by DCI
format 1\_1 that the UE detects in PDCCH monitoring occasion for serving
cell and the UE reports corresponding HARQ-ACK information in the PUCCH

Table 9.1.3-1: Value of counter DAI in DCI format 1\_0 and of counter
DAI or total DAI in DCI format 1\_1

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  DAI\       or   Number of {serving cell, PDCCH monitoring occasion}-pair(s) in which PDSCH transmission(s) associated with PDCCH or PDCCH indicating SPS PDSCH release is present, denoted as and
  MSB, LSB        
  ---------- ---- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  0,0        1    

  0,1        2    

  1,0        3    

  1,1        4    
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#### 9.1.3.2 Type-2 HARQ-ACK codebook in physical uplink shared channel

If a UE would multiplex HARQ-ACK information in a PUSCH transmission
that is not scheduled by a DCI format or is scheduled by DCI format
0\_0, then

*- if the* UE has not received any PDCCH within the monitoring occasions
for DCI format 1\_0 or DCI format 1\_1 for scheduling PDSCH receptions
or SPS PDSCH release on any serving cell and the UE does not have
HARQ-ACK information in response to a SPS PDSCH reception to multiplex
in the PUSCH, as described in Clause 9.1.3.1*,* the UE does not
multiplex HARQ-ACK information in the PUSCH transmission;

\- else, the UE generates the HARQ-ACK codebook as described in Clause
9.1.3.1, except that *harq-ACK-SpatialBundlingPUCCH* is replaced by
*harq-ACK-SpatialBundlingPUSCH*.

If a UE multiplexes HARQ-ACK information in a PUSCH transmission that is
scheduled by DCI format 0\_1, the UE generates the HARQ-ACK codebook as
described in Clause 9.1.3.1, with the following modifications:

\- For the pseudo-code for the HARQ-ACK codebook generation in Clause
9.1.3.1, after the completion of the and loops, the UE sets
$V_{temp2} = V_{\text{T-}\text{DAI}}^{\text{UL}}$ where
$V_{\text{T-}\text{DAI}}^{\text{UL}}$ is the value of the DAI field in
DCI format 0\_1 according to Table 9.1.3-2

\- For the case of first and second HARQ-ACK sub-codebooks, DCI format
0\_1 includes a first DAI field corresponding to the first HARQ-ACK
sub-codebook and a second DAI field corresponding to the second HARQ-ACK
sub-codebook

*- harq-ACK-SpatialBundlingPUCCH* is replaced by
*harq-ACK-SpatialBundlingPUSCH*.

If a UE is not provided *PDSCH-CodeBlockGroupTransmission* and the UE is
scheduled for a PUSCH transmission by DCI format 0\_1 with DAI field
value and the UE has not received any PDCCH within the monitoring
occasions for PDCCH with DCI format 1\_0 or DCI format 1\_1 for
scheduling PDSCH receptions or SPS PDSCH release on any serving cell and
the UE does not have HARQ-ACK information in response to a SPS PDSCH
reception to multiplex in the PUSCH, as described in Clause 9.1.3.1, the
UE does not multiplex HARQ-ACK information in the PUSCH transmission.

If a UE is provided *PDSCH-CodeBlockGroupTransmission* and the UE is
scheduled for a PUSCH transmission by DCI format 0\_1 with first DAI
field value or with second DAI field value and the UE has not received
any PDCCH within the monitoring occasions for PDCCH with DCI format 1\_0
or with DCI format 1\_1, respectively, for scheduling PDSCH receptions
or SPS PDSCH release on any serving cell and the UE does not have
HARQ-ACK information in response to a SPS PDSCH reception to multiplex
in the PUSCH, as described in Clause 9.1.3.1, the UE does not multiplex
HARQ-ACK information for the first sub-codebook or for the second
sub-codebook, respectively, in the PUSCH transmission.

Table 9.1.3-2: Value of DAI in DCI format 0\_1

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  DAI\           Number of {serving cell, PDCCH monitoring occasion}-pair(s) in which PDSCH transmission(s) associated with PDCCH or PDCCH indicating SPS PDSCH release is present, denoted as and
  MSB, LSB       
  ---------- --- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  0,0        1   

  0,1        2   

  1,0        3   

  1,1        4   
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

9.2 UCI reporting in physical uplink control channel
----------------------------------------------------

UCI types reported in a PUCCH include HARQ-ACK information, SR, and CSI.
UCI bits include HARQ-ACK information bits, if any, SR information bits,
if any, and CSI bits, if any. The HARQ-ACK information bits correspond
to a HARQ-ACK codebook as described in Clause 9.1.

A UE may transmit one or two PUCCHs on a serving cell in different
symbols within a slot of symbols as defined in \[4, TS 38.211\]. When
the UE transmits two PUCCHs in a slot, at least one of the two PUCCHs
uses PUCCH format 0 or PUCCH format 2.

In Clauses 9.2.3, 9.2.5.1 and 9.2.5.2, a UE assumes 11 CRC bits if a
number of respective UCI bits is larger than or equal to 360; otherwise,
the UE determines a number of CRC bits based on the number of respective
UCI bits as described in \[5, TS 38.212\].

### 9.2.1 PUCCH Resource Sets

If a UE does not have dedicated PUCCH resource configuration, provided
by *PUCCH-ResourceSet* in *PUCCH-Config*, a PUCCH resource set is
provided by *pucch-ResourceCommon* through an index to a row of Table
9.2.1-1 for transmission of HARQ-ACK information on PUCCH in an initial
UL BWP of PRBs. The PUCCH resource set includes sixteen resources, each
corresponding to a PUCCH format, a first symbol, a duration, a PRB
offset , and a cyclic shift index set for a PUCCH transmission. The UE
transmits a PUCCH using frequency hopping. An orthogonal cover code with
index 0 is used for a PUCCH resource with PUCCH format 1 in Table
9.2.1-1. The UE transmits the PUCCH using the same spatial domain
transmission filter as for a PUSCH transmission scheduled by a RAR UL
grant as described in Clause 8.3.

If a UE is not provided *pdsch-HARQ-ACK-Codebook*, the UE generates at
most one HARQ-ACK information bit.

If the UE provides HARQ-ACK information in a PUCCH transmission in
response to detecting a DCI format 1\_0 or DCI format 1\_1, the UE
determines a PUCCH resource with index , , as , where is a number of
CCEs in a CORESET of a PDCCH reception with DCI format 1\_0 or DCI
format 1\_1, as described in Clause 10.1, is the index of a first CCE
for the PDCCH reception, and is a value of the PUCCH resource indicator
field in the DCI format 1\_0 or DCI format 1\_1.

If

\- the UE determines the PRB index of the PUCCH transmission in the
first hop as and the PRB index of the PUCCH transmission in the second
hop as , where is the total number of initial cyclic shift indexes in
the set of initial cyclic shift indexes

\- the UE determines the initial cyclic shift index in the set of
initial cyclic shift indexes as

If

\- the UE determines the PRB index of the PUCCH transmission in the
first hop as and the PRB index of the PUCCH transmission in the second
hop as

\- the UE determines the initial cyclic shift index in the set of
initial cyclic shift indexes as

Table 9.2.1-1: PUCCH resource sets before dedicated PUCCH resource
configuration

  **Index**   **PUCCH format**   **First symbol**   **Number of symbols**   **PRB offset** ![](./media/image695.wmf){width="0.4284722222222222in" height="0.24166666666666667in"}   **Set of initial CS indexes**
  ----------- ------------------ ------------------ ----------------------- ------------------------------------------------------------------------------------------------------- -------------------------------
  0           0                  12                 2                       0                                                                                                       {0, 3}
  1           0                  12                 2                       0                                                                                                       {0, 4, 8}
  2           0                  12                 2                       3                                                                                                       {0, 4, 8}
  3           1                  10                 4                       0                                                                                                       {0, 6}
  4           1                  10                 4                       0                                                                                                       {0, 3, 6, 9}
  5           1                  10                 4                       2                                                                                                       {0, 3, 6, 9}
  6           1                  10                 4                       4                                                                                                       {0, 3, 6, 9}
  7           1                  4                  10                      0                                                                                                       {0, 6}
  8           1                  4                  10                      0                                                                                                       {0, 3, 6, 9}
  9           1                  4                  10                      2                                                                                                       {0, 3, 6, 9}
  10          1                  4                  10                      4                                                                                                       {0, 3, 6, 9}
  11          1                  0                  14                      0                                                                                                       {0, 6}
  12          1                  0                  14                      0                                                                                                       {0, 3, 6, 9}
  13          1                  0                  14                      2                                                                                                       {0, 3, 6, 9}
  14          1                  0                  14                      4                                                                                                       {0, 3, 6, 9}
  15          1                  0                  14                      ![](./media/image696.wmf){width="0.6041666666666666in" height="0.24166666666666667in"}                  {0, 3, 6, 9}

If a UE has dedicated PUCCH resource configuration, the UE is provided
by higher layers with one or more PUCCH resources.

A PUCCH resource includes the following parameters:

\- a PUCCH resource index provided by *pucch-ResourceId*

\- an index of the first PRB prior to frequency hopping or for no
frequency hopping by *startingPRB*

\- an index of the first PRB after frequency hopping by *secondHopPRB*;

\- an indication for intra-slot frequency hopping by
*intraSlotFrequencyHopping*

\- a configuration for a PUCCH format, from PUCCH format 0 through PUCCH
format 4, provided by *format*

If the *format* indicates *PUCCH-format0*, the PUCCH format configured
for a PUCCH resource is PUCCH format 0, where the PUCCH resource also
includes an index for an initial cyclic shift provided by
*initialCyclicShift*, a number of symbols for a PUCCH transmission
provided by *nrofSymbols*, a first symbol for the PUCCH transmission
provided by *startingSymbolIndex*.

If the *format* indicates *PUCCH-format1*, the PUCCH format configured
for a PUCCH resource is PUCCH format 1, where the PUCCH resource also
includes an index for an initial cyclic shift provided by
*initialCyclicShift*, a number of symbols for a PUCCH transmission
provided by *nrofSymbols*, a first symbol for the PUCCH transmission
provided by *startingSymbolIndex*, and an index for an orthogonal cover
code by *timeDomainOCC*.

If the *format* indicates *PUCCH-format2* or *PUCCH-format3*, the PUCCH
format configured for a PUCCH resource is PUCCH format 2 or PUCCH format
3, respectively, where the PUCCH resource also includes a number of PRBs
provided by *nrofPRBs*, a number of symbols for a PUCCH transmission
provided by *nrofSymbols*, and a first symbol for the PUCCH transmission
provided by *startingSymbolIndex*.

If the *format* indicates *PUCCH-format4*, the PUCCH format configured
for a PUCCH resource is PUCCH format 4, where the PUCCH resource also
includes a number of symbols for a PUCCH transmission provided by
*nrofSymbols*, a length for an orthogonal cover code by *occ-Length*, an
index for an orthogonal cover code by *occ-Index*, and a first symbol
for the PUCCH transmission provided by *startingSymbolIndex*.

A UE can be configured up to four sets of PUCCH resources. A PUCCH
resource set is provided by *PUCCH-ResourceSet* and is associated with a
PUCCH resource set index provided by *pucch-ResourceSetId*, with a set
of PUCCH resource indexes provided by *resourceList* that provides a set
of *pucch-ResourceId* used in the PUCCH resource set, and with a maximum
number of UCI information bits the UE can transmit using a PUCCH
resource in the PUCCH resource set provided by *maxPayloadSize*. For the
first PUCCH resource set, the maximum number of UCI information bits is
2. A maximum number of PUCCH resource indexes for a set of PUCCH
resources is provided by *maxNrofPUCCH-ResourcesPerSet*. The maximum
number of PUCCH resources in the first PUCCH resource set is 32 and the
maximum number of PUCCH resources in the other PUCCH resource sets is 8.

If the UE transmits UCI information bits, that include HARQ-ACK
information bits, the UE determines a PUCCH resource set to be

\- a first set of PUCCH resources with *pucch-ResourceSetId* = 0 if
including 1 or 2 HARQ-ACK information bits and a positive or negative SR
on one SR transmission occasion if transmission of HARQ-ACK information
and SR occurs simultaneously, or

\- a second set of PUCCH resources with *pucch-ResourceSetId* = 1, if
provided by higher layers, if where is equal to *maxPayloadSize* if
*maxPayloadSize* is provided for the PUCCH resource set with
*pucch-ResourceSetId* = 1; otherwise is equal to 1706, or

\- a third set of PUCCH resources with *pucch-ResourceSetId* = 2, if
provided by higher layers, if where is equal to *maxPayloadSize* if
*maxPayloadSize* is provided for the PUCCH resource set with
*pucch-ResourceSetId* = 2; otherwise is equal to 1706, or

\- a fourth set of PUCCH resources with *pucch-ResourceSetId* = 3, if
provided by higher layers, if .

### 9.2.2 PUCCH Formats for UCI transmission

If a UE is not transmitting PUSCH, and the UE is transmitting UCI, the
UE transmits UCI in a PUCCH using

\- PUCCH format 0 if

\- the transmission is over 1 symbol or 2 symbols,

\- the number of HARQ-ACK information bits with positive or negative SR
(HARQ-ACK/SR bits) is 1 or 2

\- PUCCH format 1 if

\- the transmission is over 4 or more symbols,

\- the number of HARQ-ACK/SR bits is 1 or 2

\- PUCCH format 2 if

\- the transmission is over 1 symbol or 2 symbols,

\- the number of UCI bits is more than 2

\- PUCCH format 3 if

\- the transmission is over 4 or more symbols,

\- the number of UCI bits is more than 2,

\- the PUCCH resource does not include an orthogonal cover code

\- PUCCH format 4 if

\- the transmission is over 4 or more symbols,

\- the number of UCI bits is more than 2,

\- the PUCCH resource includes an orthogonal cover code

A spatial setting for a PUCCH transmission is provided by
*PUCCH-SpatialRelationInfo* if the UE is configured with a single value
for *pucch-SpatialRelationInfoId*; otherwise, if the UE is provided
multiple values for *PUCCH-SpatialRelationInfo*, the UE determines a
spatial setting for the PUCCH transmission as described in \[11, TS
38.321\]. **The UE applies corresponding actions in \[11, TS 38.321\]
and a corresponding setting for a spatial domain filter to transmit
PUCCH** in the first slot that is after slot where is the slot **where
the UE would transmit a PUCCH with HARQ-ACK information with ACK value
corresponding to a PDSCH reception providing the
*PUCCH-SpatialRelationInfo ***and is the SCS configuration for the PUCCH

\- If *PUCCH-SpatialRelationInfo* provides *ssb-Index*, the UE transmits
the PUCCH using a same spatial domain filter as for a reception of a
SS/PBCH block with index provided by *ssb-Index* for a same serving cell
or, if *servingCellId* is provided, for a serving cell indicated by
*servingCellId*

\- else if *PUCCH-SpatialRelationInfo* provides *csi-RS-Index*, the UE
transmits the PUCCH using a same spatial domain filter as for a
reception of a CSI-RS with resource index provided by *csi-RS-Index* for
a same serving cell or, if *servingCellId* is provided, for a serving
cell indicated by *servingCellId*

\- else *PUCCH-SpatialRelationInfo* provides *srs*, the UE transmits the
PUCCH using a same spatial domain filter as for a transmission of a SRS
with resource index provided by *resource* for a same serving cell
*and/or active UL BWP* or, if *servingCellId* and/or *uplinkBWP* are
provided, for a serving cell indicated by *servingCellId and/or for an
UL BWP indicated by uplinkBWP*

A number of DMRS symbols for a PUCCH transmission using PUCCH format 3
or 4 is provided by *additionalDMRS*.

Use of π/2-BPSK, instead of QPSK, for a PUCCH transmission using PUCCH
format 3 or 4 is indicated by *pi2BPSK*.

### 9.2.3 UE procedure for reporting HARQ-ACK

A UE does not expect to transmit more than one PUCCH with HARQ-ACK
information in a slot.

For DCI format 1\_0, the PDSCH-to-HARQ\_feedback timing indicator field
values map to {1, 2, 3, 4, 5, 6, 7, 8}. For DCI format 1\_1, if present,
the PDSCH-to-HARQ\_feedback timing indicator field values map to values
for a set of number of slots provided by *dl-DataToUL-ACK* as defined in
Table 9.2.3-1.

For a SPS PDSCH reception ending in slot , the UE transmits the PUCCH in
slot where is provided by the PDSCH-to-HARQ\_feedback timing indicator
field in DCI format 1\_0 or, if present, in DCI format 1\_1 activating
the SPS PDSCH reception.

If the UE detects a DCI format 1\_1 that does not include a
PDSCH-to-HARQ\_feedback timing indicator field and schedules a PDSCH
reception or activates a SPS PDSCH reception ending in slot , the UE
provides corresponding HARQ-ACK information in a PUCCH transmission
within slot where is provided by *dl-DataToUL-ACK*.

With reference to slots for PUCCH transmissions, if the UE detects a DCI
format 1\_0 or a DCI format 1\_1 scheduling a PDSCH reception ending in
slot or if the UE detects a DCI format 1\_0 indicating a SPS PDSCH
release through a PDCCH reception ending in slot , the UE provides
corresponding HARQ-ACK information in a PUCCH transmission within slot ,
where is a number of slots and is indicated by the
PDSCH-to-HARQ\_feedback timing indicator field in the DCI format, if
present, or provided by *dl-DataToUL-ACK*. corresponds to the last slot
of the PUCCH transmission that overlaps with the PDSCH reception or with
the PDCCH reception in case of SPS PDSCH release.

A PUCCH transmission with HARQ-ACK information is subject to the
limitations for UE transmissions described in Clause 11.1 and Clause
11.1.1.

Table 9.2.3-1: Mapping of PDSCH-to-HARQ\_feedback timing indicator field
values to numbers of slots

  ------------------------------------------ ----------------- --------- -------------------------------------------
  PDSCH-to-HARQ\_feedback timing indicator   Number of slots             
  1 bit                                      2 bits            3 bits    
  \'0\'                                      \'00\'            \'000\'   1^st^ value provided by *dl-DataToUL-ACK*
  \'1\'                                      \'01\'            \'001\'   2^nd^ value provided by *dl-DataToUL-ACK*
                                             \'10\'            \'010\'   3^rd^ value provided by *dl-DataToUL-ACK*
                                             \'11\'            \'011\'   4^th^ value provided by *dl-DataToUL-ACK*
                                                               \'100\'   5^th^ value provided by *dl-DataToUL-ACK*
                                                               \'101\'   6^th^ value provided by *dl-DataToUL-ACK*
                                                               \'110\'   7^th^ value provided by *dl-DataToUL-ACK*
                                                               \'111\'   8^th^ value provided by *dl-DataToUL-ACK*
  ------------------------------------------ ----------------- --------- -------------------------------------------

For a PUCCH transmission with HARQ-ACK information, a UE determines a
PUCCH resource after determining a set of PUCCH resources for HARQ-ACK
information bits, as described in Clause 9.2.1. The PUCCH resource
determination is based on a PUCCH resource indicator field \[5, TS
38.212\] in a last DCI format 1\_0 or DCI format 1\_1, among the DCI
formats 1\_0 or DCI formats 1\_1 that have a value of a
PDSCH-to-HARQ\_feedback timing indicator field indicating a same slot
for the PUCCH transmission, that the UE detects and for which the UE
transmits corresponding HARQ-ACK information in the PUCCH where, for
PUCCH resource determination, detected DCI formats are first indexed in
an ascending order across serving cells indexes for a same PDCCH
monitoring occasion and are then indexed in an ascending order across
PDCCH monitoring occasion indexes.

The PUCCH resource indicator field values map to values of a set of
PUCCH resource indexes, as defined in Table 9.2.3-2, provided by
*resourceList* for PUCCH resources from a set of PUCCH resources
provided by *PUCCH-ResourceSet* with a maximum of eight PUCCH resources.

For the first set of PUCCH resources and when the size of *resourceList*
is larger than eight, when a UE provides HARQ-ACK information in a PUCCH
transmission in response to detecting a last DCI format 1\_0 or DCI
format 1\_1 in a PDCCH reception, among DCI formats 1\_0 or DCI formats
1\_1 with a value of the PDSCH-to-HARQ\_feedback timing indicator field
indicating a same slot for the PUCCH transmission, the UE determines a
PUCCH resource with index , , as

where is a number of CCEs in CORESET of the PDCCH reception for the DCI
format 1\_0 or DCI format 1\_1 as described in Clause 10.1, is the index
of a first CCE for the PDCCH reception, and is a value of the PUCCH
resource indicator field in the DCI format 1\_0 or DCI format 1\_1.

Table 9.2.3-2: Mapping of PUCCH resource indication field values to a
PUCCH resource in a PUCCH resource set with maximum 8 PUCCH resources

  -------------------------- -----------------------------------------------------------------------------------------------------
  PUCCH resource indicator   PUCCH resource
  \'000\'                    1^st^ PUCCH resource provided by *pucch-ResourceId* obtained from the 1^st^ value of *resourceList*
  \'001\'                    2^nd^ PUCCH resource provided by *pucch-ResourceId* obtained from the 2^nd^ value of *resourceList*
  \'010\'                    3^rd^ PUCCH resource provided by *pucch-ResourceId* obtained from the 3^rd^ value of *resourceList*
  \'011\'                    4^th^ PUCCH resource provided by *pucch-ResourceId* obtained from the 4^th^ value of *resourceList*
  \'100\'                    5^th^ PUCCH resource provided by *pucch-ResourceId* obtained from the 5^th^ value of *resourceList*
  \'101\'                    6^th^ PUCCH resource provided by *pucch-ResourceId* obtained from the 6^th^ value of *resourceList*
  \'110\'                    7^th^ PUCCH resource provided by *pucch-ResourceId* obtained from the 7^th^ value of *resourceList*
  \'111\'                    8^th^ PUCCH resource provided by *pucch-ResourceId* obtained from the 8^th^ value of *resourceList*
  -------------------------- -----------------------------------------------------------------------------------------------------

If a UE detects a first DCI format 1\_0 or DCI format 1\_1 indicating a
first resource for a PUCCH transmission with corresponding HARQ-ACK
information in a slot and also detects at a later time a second DCI
format 1\_0 or DCI format 1\_1 indicating a second resource for a PUCCH
transmission with corresponding HARQ-ACK information in the slot, the UE
does not expect to multiplex HARQ-ACK information corresponding to the
second DCI format in a PUCCH resource in the slot if the PDCCH reception
that includes the second DCI format is not earlier than from the
beginning of a first symbol of the first resource for PUCCH transmission
in the slot where, $\kappa$ and $T_{c}$ are defined in clause 4.1 of
\[4, TS 38.211\] and corresponds to the smallest SCS configuration among
the SCS configurations of the PDCCHs providing the DCI formats and the
SCS configuration of the PUCCH. If *processingType2Enabled* of
*PDSCH-ServingCellConfig* is set to *enable* for the serving cell with
the second DCI format and for all serving cells with corresponding
HARQ-ACK information multiplexed in the PUCCH transmission in the slot,
for , for , for ; otherwise , for , for , for , for .

If a UE transmits HARQ-ACK information corresponding only to a PDSCH
reception without a corresponding PDCCH, a PUCCH resource for
corresponding PUCCH transmission with HARQ-ACK information is provided
by *n1PUCCH-AN*.

If a UE transmits a PUCCH with HARQ-ACK information using PUCCH format
0, the UE determines values and for computing a value of cyclic shift
\[4, TS 38.211\] where is provided by *initialCyclicShift* of
*PUCCH-format0* or, if *initialCyclicShift* is not provided, by the
initial cyclic shift index as described in Clause 9.2.1 and is
determined from the value of one HARQ-ACK information bit or from the
values of two HARQ-ACK information bits as in Table 9.2.3-3 and Table
9.2.3-4, respectively.

Table 9.2.3-3: Mapping of values for one HARQ-ACK information bit to
sequences for PUCCH format 0

  --------------------------- --- ---
  HARQ-ACK Value              0   1
  **Sequence cyclic shift**       
  --------------------------- --- ---

Table 9.2.3-4: Mapping of values for two HARQ-ACK information bits to
sequences for PUCCH format 0

  --------------------------- -------- -------- -------- --------
  HARQ-ACK Value              {0, 0}   {0, 1}   {1, 1}   {1, 0}
  **Sequence cyclic shift**                              
  --------------------------- -------- -------- -------- --------

If a UE transmits a PUCCH with HARQ-ACK information using PUCCH format
1, the UE is provided a value for by *initialCyclicShift* of
*PUCCH-format1* or, if *initialCyclicShift* is not provided, by the
initial cyclic shift index as described in Clause 9.2.1.

If a UE transmits a PUCCH with HARQ-ACK information bits and bits using
PUCCH format 2 or PUCCH format 3 in a PUCCH resource that includes PRBs,
the UE determines a number of PRBs for the PUCCH transmission to be the
minimum number of PRBs, that is smaller than or equal to a number of
PRBs provided respectively by *nrofPRBs* of *PUCCH-format2* or
*nrofPRBs* of *PUCCH-format3* and start from the first PRB from the
number of PRBs, that results to and, if , , where , , , and are defined
in Clause 9.2.5.2. For PUCCH format 3, if is not equal according to \[4,
TS 38.211\], is increased to the nearest allowed value of *nrofPRBs* for
*PUCCH-format3* \[12, TS 38.331\]. If , the UE transmits the PUCCH over
PRBs.

### 9.2.4 UE procedure for reporting SR

A UE is configured by higher layer paremater
*SchedulingRequestResourceConfig* a set of configurations for SR in a
PUCCH transmission using either PUCCH format 0 or PUCCH format 1.

The UE is configured a PUCCH resource by *SchedulingRequestResourceId*
providing a PUCCH format 0 resource or a PUCCH format 1 resource as
described in Clause 9.2.1. The UE is also configured a periodicity in
symbols or slots and an offset in slots by *periodicityAndOffset* for a
PUCCH transmission conveying SR. If is larger than one slot, the UE
determines a SR transmission occasion in a PUCCH to be in a slot with
number \[4, TS 38.211\] in a frame with number if .

If is one slot, the UE expects that and every slot is a SR transmission
occasion in a PUCCH.

If is smaller than one slot, the UE determines a SR transmission
occasion in a PUCCH to start in a symbol with index \[4, TS 38.211\] if
where is the value of *startingSymbolIndex*.

If the UE determines that, for a SR transmission occasion in a PUCCH,
the number of symbols available for the PUCCH transmission in a slot is
smaller than the value provided by *nrofSymbols*, the UE does not
transmit the PUCCH in the slot.

SR transmission occasions in a PUCCH are subject to the limitations for
UE transmissions described in Clause 11.1 and Clause 11.1.1.

The UE transmits a PUCCH in the PUCCH resource for the corresponding SR
configuration only when the UE transmits a positive SR. For a positive
SR transmission using PUCCH format 0, the UE transmits the PUCCH as
described in \[4, TS 38.211\] by obtaining as described for HARQ-ACK
information in Clause 9.2.3 and by setting . For a positive SR
transmission using PUCCH format 1, the UE transmits the PUCCH as
described in \[4, TS 38.211\] by setting .

### 9.2.5 UE procedure for reporting multiple UCI types

This Clause is applicable to the case that a UE has overlapping
resources for PUCCH transmissions or for PUCCH and PUSCH transmissions
and each PUCCH transmission is over a single slot without repetition.
Any case that a PUCCH transmission is with repetitions over multiple
slots is described in Clause 9.2.6. If a UE is configured with multiple
PUCCH resources in a slot to transmit CSI reports

\- if the UE is not provided *multi-CSI-PUCCH-ResourceList* or if PUCCH
resources for transmissions of CSI reports do not overlap in the slot,
the UE determines a first resource corresponding to a CSI report with
the highest priority \[6, TS 38.214\]

\- if the first resource includes PUCCH format 2, and if there are
remaining resources in the slot that do not overlap with the first
resource, the UE determines a CSI report with the highest priority,
among the CSI reports with corresponding resources from the remaining
resources, and a corresponding second resource as an additional resource
for CSI reporting

\- if the first resource includes PUCCH format 3 or PUCCH format 4, and
if there are remaining resources in the slot that include PUCCH format 2
and do not overlap with the first resource, the UE determines a CSI
report with the highest priority, among the CSI reports with
corresponding resources from the remaining resources, and a
corresponding second resource as an additional resource for CSI
reporting

\- if the UE is provided *multi-CSI-PUCCH-ResourceList* and if any of
the multiple PUCCH resources overlap, the UE multiplexes all CSI reports
in a resource from the resources provided by
*multi-CSI-PUCCH-ResourceList*, as described in Clause 9.2.5.2.

A UE multiplexes HARQ-ACK information, with or without SR, and CSI
resport(s) in a same PUCCH if the UE is provided
*simultaneousHARQ-ACK-CSI*; otherwise, the UE drops the CSI report(s)
and includes only HARQ-ACK information, with or without SR, in the
PUCCH. If the UE would transmit multiple PUCCHs in a slot that include
HARQ-ACK information and CSI report(s), the UE expects to be provided a
same configuration for *simultaneousHARQ-ACK-CSI* each of PUCCH formats
2, 3, and 4.

If a UE would multiplex CSI reports that include Part 2 CSI reports in a
PUCCH resource, the UE determines the PUCCH resource and a number of
PRBs for the PUCCH resource or a number of Part 2 CSI reports assuming
that each of the CSI reports indicates rank 1.

If a UE would transmit multiple overlapping PUCCHs in a slot or
overlapping PUCCH(s) and PUSCH(s) in a slot and, when applicable as
described in Clauses 9.2.5.1 and 9.2.5.2, the UE is configured to
multiplex different UCI types in one PUCCH, and at least one of the
multiple overlapping PUCCHs or PUSCHs is in response to a DCI format
detection by the UE, the UE multiplexes all corresponding UCI types if
the following conditions are met. If one of the PUCCH transmissions or
PUSCH transmissions is in response to a DCI format detection by the UE,
the UE expects that the first symbol of the earliest PUCCH or PUSCH,
among a group overlapping PUCCHs and PUSCHs in the slot, satisfies the
following timeline conditions

\- is not before a symbol with CP starting after
$T_{proc,1}^{\text{mux}}$ after a last symbol of any corresponding
PDSCH, $T_{proc,1}^{\text{mux}}$ is given by maximum of
$\left\{ T_{proc,1}^{mux,1},\cdots,T_{proc,1}^{mux,i},\cdots \right\}$
where for the i-th PDSCH with corresponding HARQ-ACK transmission on a
PUCCH which is in the group of overlapping PUCCHs and PUSCHs,
$T_{proc,1}^{mux,i} = \left( N_{1} + d_{1,1} + 1 \right) \cdot \left( 2048 + 144 \right) \cdot \kappa \cdot 2^{- \mu} \cdot T_{C}$,
$d_{1,1}$ is selected for the i-th PDSCH following \[6, TS 38.214\],
$N_{1}$ is selected based on the UE PDSCH processing capability of the
i-th PDSCH and SCS configuration $\mu$, where $\mu$ corresponds to the
smallest SCS configuration among the SCS configurations used for the
PDCCH scheduling the i-th PDSCH, the i-th PDSCH, the PUCCH with
corresponding HARQ-ACK transmission for the i-th PDSCH, and all PUSCHs
in the group of overlapping PUCCHs and PUSCHs.

\- is not before a symbol with CP starting after
$T_{proc,release}^{\text{mux}}$ after a last symbol of any corresponding
SPS PDSCH release. $T_{proc,release}^{\text{mux}}$ is given by maximum
of
$\left\{ T_{proc,release}^{mux,1},\cdots,T_{proc,release}^{mux,i},\cdots \right\}$
where for the i-th PDCCH providing the SPS PDSCH release with
corresponding HARQ-ACK transmission on a PUCCH which is in the group of
overlapping PUCCHs and PUSCHs,
$T_{proc,release}^{mux,i} = \left( N + 1 \right) \cdot \left( 2048 + 144 \right) \cdot \kappa \cdot 2^{- \mu} \cdot T_{C}$,
$N$ is described in Clause 10.2, where $\mu$ corresponds to the smallest
SCS configuration among the SCS configurations used for the PDCCH
providing the i-th SPS PDSCH release, the PUCCH with corresponding
HARQ-ACK transmission for the i-th SPS PDSCH release, and all PUSCHs in
the group of overlapping PUCCHs and PUSCHs.

\- if there is no aperiodic CSI report multiplexed in a PUSCH in the
group of overlapping PUCCHs and PUSCHs, is not before a symbol with CP
starting after $T_{proc,2}^{\text{mux}}$ after a last symbol of

\- any PDCCH with the DCI format scheduling an overlapping PUSCH, and

\- any PDCCH scheduling a PDSCH or SPS PDSCH release with corresponding
HARQ-ACK information in an overlapping PUCCH in the slot

> If there is at least one PUSCH in the group of overlapping PUCCHs and
> PUSCHs, $T_{proc,2}^{\text{mux}}$is given by maximum of
> $\left\{ T_{proc,2}^{mux,1},\cdots,T_{proc,2}^{mux,i},\cdots \right\}$
> where for the i-th PUSCH which is in the group of overlapping PUCCHs
> and PUSCHs,
> $T_{proc,2}^{mux,i} = \max\left( \left( N_{2} + d_{2,1} + 1 \right) \cdot \left( 2048 + 144 \right) \cdot \kappa \cdot 2^{- \mu} \cdot T_{C},d_{2,2} \right)$,
> $d_{2,1}$and $d_{2,2}$are selected for the i-th PUSCH following \[6,
> TS 38.214\], $N_{2}$ is selected based on the UE PUSCH processing
> capability of the i-th PUSCH and SCS configuration $\mu$, where $\mu$
> corresponds to the smallest SCS configuration among the SCS
> configurations used for the PDCCH scheduling the i-th PUSCH, the
> PDCCHs scheduling the PDSCHs or providing the SPS PDSCH releases with
> corresponding HARQ-ACK transmission on a PUCCH which is in the group
> of overlapping PUCCHs/PUSCHs, and all PUSCHs in the group of
> overlapping PUCCHs and PUSCHs.
>
> If there is no PUSCH in the group of overlapping PUCCHs and PUSCHs,
> $T_{proc,2}^{\text{mux}}$is given by maximum of
> $\left\{ T_{proc,2}^{mux,1},\cdots,T_{proc,2}^{mux,i},\cdots \right\}$
> where for the i-th PDSCH or the i-th SPS PDSCH release with
> corresponding HARQ-ACK transmission on a PUCCH which is in the group
> of overlapping PUCCHs,
> $T_{proc,2}^{mux,i} = \left( N_{2} + 1 \right) \cdot \left( 2048 + 144 \right) \cdot \kappa \cdot 2^{- \mu} \cdot T_{C}$,
> $N_{2}$is selected based on the UE PUSCH processing capability of the
> PUCCH serving cell if configured.  $N_{2}$ is selected based on the UE
> PUSCH processing capability 1, if PUSCH processing capability is not
> configured for the PUCCH serving cell. $\mu$ is selected based on the
> smallest SCS configuration between the SCS configuration used for the
> PDCCH scheduling the i-th PDSCH or providing the i-th SPS PDSCH
> release with corresponding HARQ-ACK transmission on a PUCCH which is
> in the group of overlapping PUCCHs, and the SCS configuration for the
> PUCCH serving cell.

\- if there is an aperiodic CSI report multiplexed in a PUSCH in the
group of overlapping PUCCHs and PUSCHs, is not before a symbol with CP
starting after after a last symbol of

\- any PDCCH with the DCI format scheduling an overlapping PUSCH, and

\- any PDCCH scheduling a PDSCH or SPS PDSCH release with corresponding
HARQ-ACK information in an overlapping PUCCH in the slot

> where corresponds to the smallest SCS configuration among the SCS
> configuration of the PDCCHs, the smallest SCS configuration for the
> group of the overlapping PUSCHs, and the smallest SCS configuration of
> CSI-RS associated with the DCI format scheduling the PUSCH with the
> multiplexed aperiodic CSI report, and for , for and for

\- , , , , , and are defined in \[6, TS 38.214\], and and are defined in
\[4, TS 38.211\].

If a UE would transmit multiple overlapping PUCCHs in a slot or
overlapping PUCCH(s) and PUSCH(s) in a slot, one of the PUCCHs includes
HARQ-ACK information in response to an SPS PDSCH reception, and any
PUSCH is not in response to a DCI format detection, the UE expects that
the first symbol of the earliest PUCCH or PUSCH satisfies the first of
the previous timeline conditions with the exception that components
associated to a SCS configuration for a PDCCH scheduling a PDSCH or a
PUSCH are absent from the timeline conditions.

A UE does not expect a PUCCH or a PUSCH that is in response to a DCI
format detection to overlap with any other PUCCH or PUSCH that does not
satisfy the above timing conditions.

If there is one or more aperiodic CSI reports multiplexed on a PUSCH in
the group of overlapping PUCCHs and PUSCHs and if symbol is before
symbol that is a next uplink symbol with CP starting after after the end
of the last symbol of

\- the last symbol of aperiodic CSI-RS resource for channel
measurements, and

\- the last symbol of aperiodic CSI-IM used for interference
measurements, and

\- the last symbol of aperiodic NZP CSI-RS for interference
measurements, when aperiodic CSI-RS is used for channel measurement for
triggered CSI report

the UE is not required to update the CSI report for the triggered CSI
report *.* is defined in \[6, TS 38.214\] and corresponds to the
smallest SCS configuration among the SCS configurations of the PDCCHs
scheduling the PUSCHs, the smallest SCS configuration of aperiodic
CSI-RSs associated with DCI formats provided by the PDCCHs triggering
the aperiodic CSI reports, and the smallest SCS configuration of the
overlapping PUCCHs and PUSCHs and for , for and for .

If a UE would transmit multiple PUCCHs in a slot that include HARQ-ACK
information, SR, and CSI reports and any PUCCH with HARQ-ACK information
in the slot satisfies the above timing conditions and does not overlap
with any other PUCCH or PUSCH in the slot that does not satisfy the
above timing conditions, the UE multiplexes HARQ-ACK information, SR,
and CSI reports and determines corresponding PUCCH(s) for transmission
in the slot according to the following pseudo-code. If the multiple
PUCCHs do not include HARQ-ACK information and do not overlap with any
PUSCH transmission by the UE in response to a DCI format detection by
the UE, the timing conditions do not apply.

If

\- a UE is not provided *multi-CSI-PUCCH-ResourceList*, and

\- a resource for a PUCCH transmission with HARQ-ACK information in
response to SPS PDSCH reception and/or a resource for a PUCCH associated
with a SR occasion overlap in time with two resources for respective
PUCCH transmissions with two CSI reports, and

\- there is no resource for a PUCCH transmission with HARQ-ACK
information in response to a DCI format detection that overlaps in time
with any of the previous resources, and

\- the following pseudo code results to the UE attempting to determine a
single PUCCH resource from the HARQ-ACK and/or the SR resource and the
two PUCCH resources with CSI reports

the UE

\- multiplexes the HARQ-ACK information and/or the SR in the resource
for the PUCCH transmission with the CSI report having the higher
priority, and

\- does not transmit the PUCCH with the CSI report having the lower
priority

Set to the set of resources for transmission of corresponding PUCCHs in
a single slot without repetitions where

\- a resource with earlier first symbol is placed before a resource with
later first symbol

\- for two resources with same first symbol, the resource with longer
duration is placed before the resource with shorter duration

\- for two resources with same first symbol and same duration, the
placement is arbitrary

\- the above three steps for the set are according to a subsequent
pseudo-code for a function

\- a resource for negative SR transmission that does not overlap with a
resource for HARQ-ACK or CSI transmission is excluded from set

\- if the UE is not provided *simultaneousHARQ-ACK-CSI* and resources
for transmission of HARQ-ACK information include PUCCH format 0 or PUCCH
format 2, resources that include PUCCH format 2, or PUCCH format 3, or
PUCCH format 4 for transmission of CSI reports are excluded from the set
if they overlap with any resource from the resources for transmission of
HARQ-ACK information

\- if the UE is not provided *simultaneousHARQ-ACK-CSI* and at least one
of the resources for transmission of HARQ-ACK information includes PUCCH
format 1, PUCCH format 3, or PUCCH format 4

\- resources that include PUCCH format 3 or PUCCH format 4 for
transmission of CSI reports are excluded from the set

\- resources that include PUCCH format 2 for transmission of CSI reports
are excluded from the set if they overlap with any resource from the
resources for transmission of HARQ-ACK information

Set to the cardinality of

Set to be the first symbol of resource in the slot

Set to be the number of symbols of resource in the slot

Set - index of first resource in set

Set - counter of overlapped resources

while

if and resource overlaps with resource

else

if

determine a single resource for multiplexing UCI associated with
resources as described in Clauses 9.2.5.1 and 9.2.5.2

set the index of the single resource to
![](./media/image808.wmf){width="0.125in"
height="0.19930555555555557in"}

\% start from the beginning after reordering unmerged resources at next
step

\% function that re-orders resources in current set

Set to the cardinality of

else

end if

end if

end while

The function performs the following pseudo-code

{

while % the next two while loops are to re-order the unmerged resources

while

if OR

end if

end while

end while

}

For each PUCCH resource in the set that satisfies the aforementioned
timing conditions, when applicable,

\- the UE transmits a PUCCH using the PUCCH resource if the PUCCH
resource does not overlap in time with a PUSCH transmission after
multiplexing UCI following the procedures described in Clauses 9.2.5.1
and 9.2.5.2

\- the UE multiplexes HARQ-ACK information and/or CSI reports in a PUSCH
if the PUCCH resource overlaps in time with a PUSCH transmission, as
described in Clause 9.3, and does not transmit SR. In case the PUCCH
resource overlaps in time with multiple PUSCH transmissions, the PUSCH
for multiplexing HARQ-ACK information and/or CSI is selected as
described in Clause 9. If the PUSCH transmission by the UE is not in
response to a DCI format detection and the UE multiplexes only CSI
reports, the timing conditions are not applicable

\- the UE does not expect the resource to overlap with a second resource
of a PUCCH transmission over multiple slots if the resource is obtained
from a group of resources that do not overlap with the second resource.

Clauses 9.2.5.1 and 9.2.5.2 assume the following

\- resources for transmissions of UCI types, prior to multiplexing or
dropping, overlap in a slot

\- multiplexing conditions of corresponding UCI types in a single PUCCH
are satisfied, and

\- the UE does not transmit any PUSCH time-overlapping with PUCCH in the
slot.

#### 9.2.5.1 UE procedure for multiplexing HARQ-ACK or CSI and SR in a PUCCH

In the following, a UE is configured to transmit PUCCHs for respective
SRs in a slot, as determined by a set of *schedulingRequestResourceId*,
with SR transmission occasions that would overlap with a transmission of
a PUCCH with HARQ-ACK information from the UE in the slot or with a
transmission of a PUCCH with CSI report(s) from the UE in the slot.

If a UE would transmit a PUCCH with positive SR and at most two HARQ-ACK
information bits in a resource using PUCCH format 0, the UE transmits
the PUCCH in the resource using PUCCH format 0 in PRB(s) for HARQ-ACK
information as described in Clause 9.2.3. The UE determines a value of
and for computing a value of cyclic shift \[4, TS 38.211\] where is
provided by *initialcyclicshift* of *PUCCH-format0*, and is determined
from the value of one HARQ-ACK information bit or from the values of two
HARQ-ACK information bits as in Table 9.2.5-1 and Table 9.2.5-2,
respectively.

If the UE would transmit negative SR and a PUCCH with at most two
HARQ-ACK information bits in a resource using PUCCH format 0, the UE
transmits the PUCCH in the resource using PUCCH format 0 for HARQ-ACK
information as described in Clause 9.2.3.

Table 9.2.5-1: Mapping of values for one HARQ-ACK information bit and
positive SR to sequences for PUCCH format 0

  --------------------------- --- ---
  HARQ-ACK Value              0   1
  **Sequence cyclic shift**       
  --------------------------- --- ---

Table 9.2.5-2: Mapping of values for two HARQ-ACK information bits and
positive SR to sequences for PUCCH format 0

  --------------------------- -------- -------- -------- --------
  HARQ-ACK Value              {0, 0}   {0, 1}   {1, 1}   {1, 0}
  **Sequence cyclic shift**                              
  --------------------------- -------- -------- -------- --------

If a UE would transmit positive or negative SR in a resource using PUCCH
format 0 and HARQ-ACK information bits in a resource using PUCCH format
1 in a slot, the UE transmits only a PUCCH with the HARQ-ACK information
bits in the resource using PUCCH format 1.

If the UE would transmit positive SR in a first resource using PUCCH
format 1 and at most two HARQ-ACK information bits in a second resource
using PUCCH format 1 in a slot, the UE transmits a PUCCH with HARQ-ACK
information bits in the first resource using PUCCH format 1 as described
in Clause 9.2.3. If a UE would transmit negative SR in a resource using
PUCCH format 1 and at most two HARQ-ACK information bits in a resource
using PUCCH format 1 in a slot, the UE transmits a PUCCH in the resource
using PUCCH format 1 for HARQ-ACK information as described in Clause
9.2.3.

If a UE would transmit a PUCCH with HARQ-ACK information bits in a
resource using PUCCH format 2 or PUCCH format 3 or PUCCH format 4 in a
slot, as described in Clause 9.2.3, bits representing a negative or
positive SR, in ascending order of the values of
*schedulingRequestResourceId*, are appended to the HARQ-ACK information
bits and the UE transmits the combined UCI bits in a PUCCH using a
resource with PUCCH format 2 or PUCCH format 3 or PUCCH format 4 that
the UE determines as described in Clauses 9.2.1 and 9.2.3. An all-zero
value for the bits represents a negative SR value across all SRs.

If a UE would transmit a PUCCH with CSI report bits in a resource using
PUCCH format 2 or PUCCH format 3 or PUCCH format 4 in a slot, bits
representing corresponding negative or positive SR, in ascending order
of the values of *schedulingRequestResourceId*, are prepended to the CSI
information bits as described in Clause 9.2.5.2 and the UE transmits a
PUCCH with the combined UCI bits in a resource using the PUCCH format 2
or PUCCH format 3 or PUCCH format 4 for CSI reporting. An all-zero value
for the bits represents a negative SR value across all SRs.

If a UE transmits a PUCCH with HARQ-ACK information bits, SR bits, and
CRC bits using PUCCH format 2 or PUCCH format 3 in a PUCCH resource that
includes PRBs, the UE determines a number of PRBs for the PUCCH
transmission to be the minimum number of PRBs, that is smaller than or
equal to a number of PRBs provided respectively by *nrofPRBs* in
*PUCCH-format2* or *nrofPRBs* in *PUCCH-format3* and starts from the
first PRB from the number of PRBs, that results to and, if , , where , ,
, and are defined in Clause 9.2.5.2. For PUCCH format 3, if is not equal
according to \[4, TS 38.211\], is increased to the nearest allowed value
of *nrofPRBs* for *PUCCH-format3* \[12, TS 38.331\]. If , the UE
transmits the PUCCH over the PRBs.

#### 9.2.5.2 UE procedure for multiplexing HARQ-ACK/SR/CSI in a PUCCH

For a transmission occasion of a single CSI report, a PUCCH resource is
provided by *pucch-CSI-ResourceList*. For a transmission occasion of
multiple CSI reports, corresponding PUCCH resources can be provided by
*multi-CSI-PUCCH-ResourceList*.

If a UE is provided only one PUCCH resource set for transmission of
HARQ-ACK information in response to PDSCH reception scheduled by a DCI
format or in response to a SPS PDSCH release, the UE does not expect to
be provided *simultaneousHARQ-ACK-CSI*.

A UE is configured by *maxCodeRate* a code rate for multiplexing
HARQ-ACK, SR, and CSI report(s) in a PUCCH transmission using PUCCH
format 2, PUCCH format 3, or PUCCH format 4.

If a UE transmits CSI reports using PUCCH format 2, the UE transmits
only wideband CSI for each CSI report \[6, TS 38.214\]. In the
following, a Part 1 CSI report refers either to a CSI report with only
wideband CSI or to a Part 1 CSI report with wideband CSI and sub-band
CSI.

Denote as

\- a total number of HARQ-ACK information bits, if any

\- a total number of SR bits. if there is no scheduling request bit;
otherwise, as described in Clause 9.2.5.1

\- , where is a number of Part 1 CSI report bits for CSI report with
priority value , is a number of Part 2 CSI report bits, if any, for CSI
report with priority value \[6, TS 38.214\], and is a number of CSI
reports that include overlapping CSI reports

\- , where is a number of CRC bits, if any, for encoding HARQ-ACK, SR
and Part 1 CSI report bits and is a number of CRC bits, if any, for
encoding Part 2 CSI report bits

In the following

\- is a code rate given by *maxCodeRate* as in Table 9.2.5.2-1.

\- is a number of PRBs for *PUCCH format 2, or PUCCH format 3, or PUCCH
format 4,* respectively, where is provided by *nrofPRBs* in
*PUCCH-format2* for PUCCH format 2 or by *nrofPRBs* in *PUCCH-format3*
for PUCCH format 3, and for PUCCH format 4

\- for PUCCH format 2, for PUCCH format 3, and for PUCCH format 4, where
is a number of subcarriers per resource block \[4, TS 38.211\]

\- is equal to a number of PUCCH symbols for *PUCCH format 2* provided
by *nrofSymbols* in *PUCCH-format2. For PUCCH format 3 or for PUCCH
format 4,* *is equal to a number of PUCCH symbols* f*or PUCCH format 3
or equal to a number of PUCCH symbols* f*or PUCCH format 4* provided by
*nrofSymbols* in *PUCCH-format3* or *nrofSymbols* in *PUCCH-format4*,
respectively, after excluding a number of symbols used for DM-RS
transmission for PUCCH format 3 or for PUCCH format 4, respectively \[4,
TS 38.211\]

\- if pi/2-BPSK is the modulation scheme and if QPSK is the modulation
scheme as indicated by *pi2BPSK* for PUCCH format 3 or PUCCH format 4.
For PUCCH format 2,

If a UE has one or more CSI reports and zero or more HARQ-ACK/SR
information bits to transmit in a PUCCH where the HARQ-ACK, if any, is
in response to a PDSCH reception without a corresponding PDCCH

\- if any of the CSI reports are overlapping and the UE is provided by
*multi-CSI-PUCCH-ResourceList* with PUCCH resources in a slot, for PUCCH
format 2 and/or PUCCH format 3 and/or PUCCH format 4, as described in
Clause 9.2.1, where the resources are indexed according to an ascending
order for the product of a number of corresponding REs, modulation order
, and configured code rate ;

\- if , the UE uses PUCCH format 2 resource , or the PUCCH format 3
resource , or the PUCCH format 4 resource

\- else if and , , the UE transmits a PUCCH conveying HARQ-ACK
information, SR and CSI report(s) in a respective PUCCH where the UE
uses the PUCCH format 2 resource , or the PUCCH format 3 resource , or
the PUCCH format 4 resource

\- else the UE uses the PUCCH format 2 resource , or the PUCCH format 3
resource , or the PUCCH format 4 resource and the UE selects CSI
report(s) for transmission together with HARQ-ACK information and SR,
when any, in ascending priority value as described in \[6, TS 38.214\]

\- else, the UE transmits the bits in a PUCCH resource provided by
*pucch-CSI-ResourceList* and determined as described in Clause 9.2.5

If a UE has HARQ-ACK, SR and wideband or sub-band CSI reports to
transmit and the UE determines a PUCCH resource with PUCCH format 2, or
the UE has HARQ-ACK, SR and wideband CSI reports \[6, TS 38.214\] to
transmit and the UE determines a PUCCH resource with PUCCH format 3 or
PUCCH format 4, where

> \- the UE determines the PUCCH resource using the PUCCH resource
> indicator field \[5, TS 38.212\] in a last DCI format 1\_0 or DCI
> format 1\_1, from DCI formats 1\_0 or DCI formats 1\_1 that have a
> value of a PDSCH-to-HARQ\_feedback timing indicator field indicating a
> same slot for the PUCCH transmission, from a PUCCH resource set
> provided to the UE for HARQ-ACK transmission, and
>
> \- the UE determines the PUCCH resource set as described in Clause
> 9.2.1 and Clause 9.2.3 for UCI bits

and

\- if , the UE transmits the HARQ-ACK, SR, and CSI reports bits by
selecting the minimum number of the PRBs satisfying as described in
Clauses 9.2.3 and 9.2.5.1;

\- else, the UE selects CSI report(s), from the CSI reports, for
transmission together with HARQ-ACK and SR in ascending priority value
\[6, TS 38.214\], where the value of satisfies and , where is a number
of CRC bits corresponding to UCI bits, and is a number of CRC bits
corresponding to UCI bits.

If a UE has HARQ-ACK, SR and sub-band CSI reports to transmit and the UE
determines a PUCCH resource with PUCCH format 3 or PUCCH format 4, where

> \- the UE determines the PUCCH resource using the PUCCH resource
> indicator field \[5, TS 38.212\] in a last DCI format 1\_0 or DCI
> format 1\_1, from DCI formats 1\_0 or DCI formats 1\_1 that have a
> value of a PDSCH-to-HARQ\_feedback timing indicator field indicating a
> same slot for the PUCCH transmission, from a PUCCH resource set
> provided to the UE for HARQ-ACK transmission, and
>
> \- the UE determines the PUCCH resource set as described in Clause
> 9.2.1 and Clause 9.2.3 for UCI bits

and

\- if ![](./media/image895.wmf){width="3.5in" height="0.25in"}, the UE
transmits the HARQ-ACK, SR and the CSI report bits by selecting the
minimum number of PRBs from the PRBs satisfying as described in Clauses
9.2.3 and 9.2.5.1

\- else,

\- if for Part 2 CSI report priority value(s), it is

and

,

the UE selects the first Part 2 CSI reports, according to respective
priority value(s) \[6, TS 38.214\], for transmission together with the
HARQ-ACK, SR and Part 1 CSI reports , where is the number of Part 1 CSI
report bits for the CSI report and is the number of Part 2 CSI report
bits for the CSI report priority value, is a number of CRC bits
corresponding to , and is a number of CRC bits corresponding to

\- else, the UE drops all Part 2 CSI reports and selects Part 1 CSI
report(s), from the CSI reports in ascending priority value \[6, TS
38.214\], for transmission together with the HARQ-ACK and SR information
bits where the value of satisfies and , where is a number of CRC bits
corresponding to UCI bits, and is a number of CRC bits corresponding to
UCI bits.

Table 9.2.5.2-1: Code rate corresponding to value of *maxCodeRate*

  --------------- ---------------
  *maxCodeRate*   **Code rate**
                  
  0               0.08
  1               0.15
  2               0.25
  3               0.35
  4               0.45
  5               0.60
  6               0.80
  7               Reserved
  --------------- ---------------

### 9.2.6 PUCCH repetition procedure

For PUCCH formats 1, 3, or 4, a UE can be configured a number of slots,
, for repetitions of a PUCCH transmission by respective *nrofSlots*.

For ,

\- the UE repeats the PUCCH transmission with the UCI over slots

\- a PUCCH transmission in each of the slots has a same number of
consecutive symbols, as provided by *nrofSymbols* in *PUCCH-format1*,
*nrofSymbols* in *PUCCH-format3*, or *nrofSymbols* in *PUCCH-format4*

\- a PUCCH transmission in each of the slots has a same first symbol, as
provided by *startingSymbolIndex* in *PUCCH-format1*,
*startingSymbolIndex* in *PUCCH-format3*, or *startingSymbolIndex* in
*PUCCH-format4*

\- the UE is configured by *interslotFrequencyHopping* whether or not to
perform frequency hopping for PUCCH transmissions in different slots

\- if the UE is configured to perform frequency hopping for PUCCH
transmissions across different slots

\- the UE performs frequency hopping per slot

\- the UE transmits the PUCCH starting from a first PRB, provided by
*startingPRB*, in slots with even number and starting from the second
PRB, provided by *secondHopPRB*, in slots with odd number. The slot
indicated to the UE for the first PUCCH transmission has number 0 and
each subsequent slot until the UE transmits the PUCCH in slots is
counted regardless of whether or not the UE transmits the PUCCH in the
slot

\- the UE does not expect to be configured to perform frequency hopping
for a PUCCH transmission within a slot

\- If the UE is not configured to perform frequency hopping for PUCCH
transmissions across different slots and if the UE is configured to
perform frequency hopping for PUCCH transmissions within a slot, the
frequency hopping pattern between the first PRB and the second PRB is
same within each slot

If the UE determines that, for a PUCCH transmission in a slot, the
number of symbols available for the PUCCH transmission is smaller than
the value provided by *nrofSymbols* for the corresponding PUCCH format,
the UE does not transmit the PUCCH in the slot.

A SS/PBCH block symbol is a symbol indicated to a UE by
*ssb-PositionsInBurst* in *SIB1* or *ssb-PositionsInBurst* in
*ServingCellConfigCommon*.

For unpaired spectrum, the UE determines the slots for a PUCCH
transmission starting from a slot indicated to the UE as described in
Clause 9.2.3 and having

\- an UL symbol, as described in Clause 11.1, or flexible symbol that is
not SS/PBCH block symbol provided by *startingSymbolIndex* in
*PUCCH-format1*, or in *PUCCH-format3*, or in *PUCCH-format4* as a first
symbol, and

\- consecutive UL symbols, as described in Clause 11.1, or flexible
symbols that are not SS/PBCH block symbols, starting from the first
symbol, equal to or larger than a number of symbols provided by
*nrofsymbols* in *PUCCH-format1*, or in *PUCCH-format3*, or in
*PUCCH-format4*

For paired spectrum or supplementary uplink band, the UE determines the
slots for a PUCCH transmission as the consecutive slots starting from a
slot indicated to the UE as described in Clause 9.2.3.

If a UE would transmit a PUCCH over a first number of slots and the UE
would transmit a PUSCH over a second number of slots, and the PUCCH
transmission would overlap with the PUSCH transmission in one or more
slots, and the conditions in Clause 9.2.5 for multiplexing the UCI in
the PUSCH are satisfied in the overlapping slots, the UE transmits the
PUCCH and does not transmit the PUSCH in the overlapping slots.

A UE does not multiplex different UCI types in a PUCCH transmission with
repetitions over slots. If a UE would transmit a first PUCCH over more
than one slot and at least a second PUCCH over one or more slots, and
the transmissions of the first PUCCH and the second PUCCH would overlap
in a number of slots then, for each slot of the number of slots and with
UCI type priority of HARQ-ACK \> SR \> CSI with higher priority \> CSI
with lower priority

\- the UE does not expect the first PUCCH and any of the second PUCCHs
to start at a same slot and include a UCI type with same priority

\- if the first PUCCH and any of the second PUCCHs include a UCI type
with same priority, the UE transmits the PUCCH starting at an earlier
slot and does not transmit the PUCCH starting at a later slot

\- if the first PUCCH and any of the second PUCCHs do not include a UCI
type with same priority, the UE transmits the PUCCH that includes the
UCI type with higher priority and does not transmit the PUCCH that
include the UCI type with lower priority

A UE does not expect a PUCCH that is in response to a DCI format
detection to overlap with any other PUCCH that does not satisfy the
corresponding timing conditions in Clause 9.2.5.

If a UE would transmit a PUCCH over slots and the UE does not transmit
the PUCCH in a slot from the slots due to overlapping with another PUCCH
transmission in the slot, the UE counts the slot in the number of slots.

9.3 UCI reporting in physical uplink shared channel
---------------------------------------------------

Offset values are defined for a UE to determine a number of resources
for multiplexing HARQ-ACK information and for multiplexing CSI reports
in a PUSCH. The offset values are signalled to a UE either by a DCI
format scheduling the PUSCH transmission or by higher layers.

If DCI format 0\_0, or DCI format 0\_1 that does not include a
beta\_offset indicator field, schedules the PUSCH transmission from the
UE and the UE is provided *betaOffsets = \'semiStatic\'*, the UE applies
the , , and values that are provided by *betaOffsets = \'semiStatic\'*
for the corresponding HARQ-ACK information, Part 1 CSI reports and Part
2 CSI reports.

If the PUSCH transmission is with a configured grant and the UE is
provided *CG-UCI-OnPUSCH= \'semiStatic\'*, the UE applies the , , and
values that are provided by *CG-UCI-OnPUSCH = \'semiStatic\'* for the
corresponding HARQ-ACK information, Part 1 CSI reports and Part 2 CSI
reports.

If the PUSCH is scheduled by DCI format 0\_0 and the UE is provided
*betaOffsets = \'dynamic\'*, the UE applies the , , and values that are
determined from the first value of  *betaOffsets = \'dynamic\'*.

If the PUSCH is a configured grant Type 2 PUSCH activated by DCI format
0\_0 and the UE is provided *CG-UCI-OnPUSCH* =*\'dynamic\'*, the UE
applies the , , and values that are determined from the first value of
*CG-UCI-OnPUSCH = \'dynamic\'*.

HARQ-ACK information offsets are configured to values according to Table
9.3-1. The *betaOffsetACK-Index1*, *betaOffsetACK-Index2*, and
*betaOffsetACK-Index3* respectively provide indexes , , and for the UE
to use if the UE multiplexes up to 2 HARQ-ACK information bits, more
than 2 and up to 11 HARQ-ACK information bits, and more than 11 bits in
the PUSCH, respectively.

Part 1 CSI report and Part 2 CSI report offsets and , respectively, are
configured to values according to Table 9.3-2. The
*betaOffsetCSI-Part1-Index1* and *betaOffsetCSI-Part2-Index1*
respectively provide indexes and for the UE to use if the UE multiplexes
up to 11 bits for Part 1 CSI reports or Part 2 CSI reports in the PUSCH.
The *betaOffsetCSI-Part1-Index2* and *betaOffsetCSI-Part2-Index2*
respectively provide indexes or for the UE to use if the UE multiplexes
more than 11 bits for Part 1 CSI reports or Part 2 CSI reports in the
PUSCH.

If a DCI format 0\_1 schedules the PUSCH transmission from the UE and if
DCI format 0\_1 includes a beta\_offset indicator field, as configured
by *uci-OnPUSCH*, the UE is provided by each of {*betaOffsetACK-Index1*,
*betaOffsetACK-Index2*, *betaOffsetACK-Index3*} a set of four indexes,
by each of {*betaOffsetCSI-Part1-Index1*, *betaOffsetCSI-Part1-Index2*}
a set of four indexes and by each of {*betaOffsetCSI-Part2-Index1*,
*betaOffsetCSI-Part2-Index2*} a set of four indexes from Table 9.3-1 and
9.3-2, respectively, for multiplexing HARQ-ACK information, Part 1 CSI
reports, and Part 2 CSI reports, respectively, in the PUSCH
transmission. The beta\_offset indicator field indicates a value, a
value and a value from the respective sets of values, with the mapping
defined in Table 9.3-3.

Table 9.3-1: Mapping of beta\_offset values for HARQ-ACK information and
the index signalled by higher layers

  or or   
  ------- ----------
  0       1.000
  1       2.000
  2       2.500
  3       3.125
  4       4.000
  5       5.000
  6       6.250
  7       8.000
  8       10.000
  9       12.625
  10      15.875
  11      20.000
  12      31.000
  13      50.000
  14      80.000
  15      126.000
  16      Reserved
  17      Reserved
  18      Reserved
  19      Reserved
  20      Reserved
  21      Reserved
  22      Reserved
  23      Reserved
  24      Reserved
  25      Reserved
  26      Reserved
  27      Reserved
  28      Reserved
  29      Reserved
  30      Reserved
  31      Reserved

Table 9.3-2: Mapping of beta\_offset values for CSI and the index
signalled by higher layers

+----+----------+
| or |          |
|    |          |
| or |          |
+====+==========+
| 0  | 1.125    |
+----+----------+
| 1  | 1.250    |
+----+----------+
| 2  | 1.375    |
+----+----------+
| 3  | 1.625    |
+----+----------+
| 4  | 1.750    |
+----+----------+
| 5  | 2.000    |
+----+----------+
| 6  | 2.250    |
+----+----------+
| 7  | 2.500    |
+----+----------+
| 8  | 2.875    |
+----+----------+
| 9  | 3.125    |
+----+----------+
| 10 | 3.500    |
+----+----------+
| 11 | 4.000    |
+----+----------+
| 12 | 5.000    |
+----+----------+
| 13 | 6.250    |
+----+----------+
| 14 | 8.000    |
+----+----------+
| 15 | 10.000   |
+----+----------+
| 16 | 12.625   |
+----+----------+
| 17 | 15.875   |
+----+----------+
| 18 | 20.000   |
+----+----------+
| 19 | Reserved |
+----+----------+
| 20 | Reserved |
+----+----------+
| 21 | Reserved |
+----+----------+
| 22 | Reserved |
+----+----------+
| 23 | Reserved |
+----+----------+
| 24 | Reserved |
+----+----------+
| 25 | Reserved |
+----+----------+
| 26 | Reserved |
+----+----------+
| 27 | Reserved |
+----+----------+
| 28 | Reserved |
+----+----------+
| 29 | Reserved |
+----+----------+
| 30 | Reserved |
+----+----------+
| 31 | Reserved |
+----+----------+

Table 9.3-3: Mapping of beta\_offset indicator values to offset indexes

  ------------------------ ----------------------------------------------
  beta\_offset indicator   ( or or ), ( or ), ( or )
  \'00\'                   1^st^ offset index provided by higher layers
  \'01\'                   2^nd^ offset index provided by higher layers
  \'10\'                   3^rd^ offset index provided by higher layers
  \'11\'                   4^th^ offset index provided by higher layers
  ------------------------ ----------------------------------------------

10 UE procedure for receiving control information
=================================================

If the UE is configured with a SCG, the UE shall apply the procedures
described in this clause for both MCG and SCG except for PDCCH
monitoring in Type0/0A/2-PDCCH CSS sets where the UE is not required to
apply the procedures in this clause for the SCG

\- When the procedures are applied for MCG, the terms \'secondary
cell\', \'secondary cells\' , \'serving cell\', \'serving cells\' in
this clause refer to secondary cell, secondary cells, serving cell,
serving cells belonging to the MCG respectively.

\- When the procedures are applied for SCG, the terms \'secondary
cell\', \'secondary cells\', \'serving cell\', \'serving cells\' in this
clause refer to secondary cell, secondary cells (not including PSCell),
serving cell, serving cells belonging to the SCG respectively. The term
\'primary cell\' in this clause refers to the PSCell of the SCG.

A UE monitors a set of PDCCH candidates in one or more CORESETs on the
active DL BWP on each activated serving cell configured with PDCCH
monitoring according to corresponding search space sets where monitoring
implies decoding each PDCCH candidate according to the monitored DCI
formats.

For monitoring of a PDCCH candidate in a slot

\- If the UE has received *ssb-PositionsInBurst* in *SIB1* and has not
received *ssb-PositionsInBurst* in *ServingCellConfigCommon* for a
serving cell and if the UE does not monitor PDCCH candidates in a
Type0-PDCCH CSS set and at least one RE for a PDCCH candidate overlaps
with at least one RE corresponding to a SS/PBCH block index provided by
*ssb-PositionsInBurst* in *SIB1*, the UE is not required to monitor the
PDCCH candidate.

\- If a UE has received *ssb-PositionsInBurst* in
*ServingCellConfigCommon* for a serving cell and if the UE does not
monitor PDCCH candidates in a Type0-PDCCH CSS set and at least one RE
for a PDCCH candidate overlaps with at least one RE corresponding to a
SS/PBCH block index provided by *ssb-PositionsInBurst* in
*ServingCellConfigCommon*, the UE is not required to monitor the PDCCH
candidate.

\- If the UE monitors the PDCCH candidate for a Type0-PDCCH CSS set on
the serving cell according to the procedure described in Clause 13, the
UE may assume that no SS/PBCH block is transmitted in REs used for
monitoring the PDCCH candidate on the serving cell.

\- If *at least one RE of a PDCCH candidate on the serving cell overlaps
with at least one RE of lte-CRS-ToMatchAround*, *the UE is not required
to monitor the PDCCH candidate*.

If a UE indicates in *UE-NR-Capability* a carrier aggregation capability
larger than 4 serving cells, the UE includes in *UE-NR-Capability* an
indication for a maximum number of PDCCH candidates the UE can monitor
per slot when the UE is configured for carrier aggregation operation
over more than 4 cells. When a UE is not configured for NR-DC operation,
the UE determines a capability to monitor a maximum number of PDCCH
candidates per slot that corresponds to downlink cells, where

\- is the number of configured downlink cells if the UE does not provide
*pdcch-BlindDetectionCA*

\- otherwise, is the value of *pdcch-BlindDetectionCA*

When a UE is configured for NR-DC operation, the UE determines a
capability to monitor a maximum number of PDCCH candidates per slot that
corresponds to downlink cells for the MCG where is provided by
*pdcch-BlindDetection* for the MCG and determines a capability to
monitor a maximum number of PDCCH candidates per slot that corresponds
to downlink cells for the SCG where is provided by
*pdcch-BlindDetection* for the SCG. When the UE is configured for
carrier aggregation operation over more than 4 cells, or for a cell
group when the UE is configured for NR-DC operation, the UE does not
expect to monitor per slot a number of PDCCH candidates that is larger
than the maximum number as derived from the corresponding value of .

When a UE is configured for NR-DC operation with a total of downlink
cells on both the MCG and the SCG, the UE expects to be provided
*pdcch-BlindDetection* for the MCG and *pdcch-BlindDetection* for the
SCG with values that satisfy

\- *pdcch-BlindDetection* for the MCG + *pdcch-BlindDetection* for the
SCG \<= *pdcch-BlindDetectionCA*, if the UE reports
*pdcch-BlindDetectionCA, or*

\- *pdcch-BlindDetection* for the MCG + *pdcch-BlindDetection* for the
SCG \<= , if the UE does not report *pdcch-BlindDetectionCA.*

For NR-DC operation, the UE may indicate, through
*pdcch-BlindDetectionMCG-UE* and *pdcch-BlindDetectionSCG-UE*,
respective maximum values for *pdcch-BlindDetection* for the MCG and
*pdcch-BlindDetection for the SCG.*

If the UE reports *pdcch-BlindDetectionCA,*

\- the value range of *pdcch-BlindDetectionMCG-UE* or of
*pdcch-BlindDetectionSCG-UE* is \[1, ..., *pdcch-BlindDetectionCA-*1\],
and

*- pdcch-BlindDetectionMCG-UE* + *pdcch-BlindDetectionSCG-UE \>=
pdcch-BlindDetectionCA.*

*Otherwise,* if  is a maximum total number of downlink cells that the UE
can be configured on both the MCG and the SCG for NR-DC as indicated in
*UE-NR-Capability*,

\- the value range of *pdcch-BlindDetectionMCG-UE* or of
*pdcch-BlindDetectionSCG-UE* is \[1, 2, 3\], and

*- pdcch-BlindDetectionMCG-UE* + *pdcch-BlindDetectionSCG-UE \>=* .

10.1 UE procedure for determining physical downlink control channel assignment 
------------------------------------------------------------------------------

A set of PDCCH candidates for a UE to monitor is defined in terms of
PDCCH search space sets. A search space set can be a CSS set or a USS
set. A UE monitors PDCCH candidates in one or more of the following
search spaces sets

\- a Type0-PDCCH CSS set configured by *pdcch-ConfigSIB1* in *MIB* or by
*searchSpaceSIB1 in PDCCH-ConfigCommon* or by *searchSpaceZero* *in
PDCCH-ConfigCommon* for a DCI format with CRC scrambled by a SI-RNTI on
the primary cell of the MCG

\- a Type0A-PDCCH CSS set configured by
*searchSpaceOtherSystemInformation* *in PDCCH-ConfigCommon* for a DCI
format with CRC scrambled by a SI-RNTI on the primary cell of the MCG

\- a Type1-PDCCH CSS set configured by *ra-SearchSpace* *in
PDCCH-ConfigCommon* for a DCI format with CRC scrambled by a RA-RNTI or
a TC-RNTI on the primary cell

\- a Type2-PDCCH CSS set configured by *pagingSearchSpace* *in
PDCCH-ConfigCommon* for a DCI format with CRC scrambled by a P-RNTI on
the primary cell of the MCG

\- a Type3-PDCCH CSS set configured by *SearchSpace* in *PDCCH-Config*
with *searchSpaceType* = *common* for DCI formats with CRC scrambled by
INT-RNTI, SFI-RNTI, TPC-PUSCH-RNTI, TPC-PUCCH-RNTI, or TPC-SRS-RNTI and,
only for the primary cell, C-RNTI, MCS-C-RNTI, or CS-RNTI(s), and

\- a USS set configured by *SearchSpace* in *PDCCH-Config* with
*searchSpaceType* = *ue-Specific* for DCI formats with CRC scrambled by
C-RNTI, MCS-C-RNTI, SP-CSI-RNTI, or CS-RNTI(s).

For a DL BWP, if a UE is not provided *searchSpaceSIB1* for Type0-PDCCH
CSS set by *PDCCH-ConfigCommon*, the UE does not monitor PDCCH
candidates for a Type0-PDCCH CSS set on the DL BWP. The Type0-PDCCH CSS
set is defined by the CCE aggregation levels and the number of PDCCH
candidates per CCE aggregation level given in Table 10.1-1. If the
active DL BWP and the initial DL BWP have same SCS and same CP length
and the active DL BWP includes all RBs of the CORESET with index 0, or
the active DL BWP is the initial DL BWP, the CORESET configured for
Type0-PDCCH CSS set has CORESET index 0 and the Type0-PDCCH CSS set has
search space set index 0.

For a DL BWP, if a UE is not provided
*searchSpaceOtherSystemInformation* for Type0A-PDCCH CSS set, the UE
does not monitor PDCCH for Type0A-PDCCH CSS set on the DL BWP. The CCE
aggregation levels and the number of PDCCH candidates per CCE
aggregation level for Type0A-PDCCH CSS set are given in Table 10.1-1.

For a DL BWP, if a UE is not provided *ra-SearchSpace* for Type1-PDCCH
CSS set, the UE does not monitor PDCCH for Type1-PDCCH CSS set on the DL
BWP*.* If the UE has not been provided a Type3-PDCCH CSS set or a USS
set and the UE has received a C-RNTI and has been provided a Type1-PDCCH
CSS set, the UE monitors PDCCH candidates for DCI format 0\_0 and DCI
format 1\_0 with CRC scrambled by the C-RNTI in the Type1-PDCCH CSS set.

If a UE is not provided *pagingSearchSpace* for Type2-PDCCH CSS set, the
UE does not monitor PDCCH for Type2-PDCCH CSS set on the DL BWP. The CCE
aggregation levels and the number of PDCCH candidates per CCE
aggregation level for Type2-PDCCH CSS set are given in Table 10.1-1.

If a UE is provided a zero value for *searchSpaceID in
PDCCH-ConfigCommon* *for* a Type0/0A/2-PDCCH CSS set, the UE determines
monitoring occasions for PDCCH candidates of the Type0/0A/2-PDCCH CSS
set as described in Clause 13, and the UE is provided a C-RNTI, the UE
monitors PDCCH candidates only at monitoring occasions associated with a
SS/PBCH block, where the SS/PBCH block is determined by the most recent
of

\- a MAC CE activation command indicating a TCI state of the active BWP
that includes a CORESET with index 0, as described in \[6, TS 38.214\],
where the TCI-state includes a CSI-RS which is quasi-co-located with the
SS/PBCH block, or

\- a random access procedure that is not initiated by a PDCCH order that
triggers a contention-free random access procedure

If a UE monitors PDCCH candidates for DCI formats with CRC scrambled by
a C-RNTI and the UE is provided a non-zero value for *searchSpaceID in
PDCCH-ConfigCommon* *for* a Type0/0A/2-PDCCH CSS set, the UE determines
monitoring occasions for PDCCH candidates of the Type0/0A/2-PDCCH CSS
set based on the search space set associated with the value of
*searchSpaceID*.

The UE may assume that the DM-RS antenna port associated with PDCCH
receptions in the CORESET configured by *pdcch-ConfigSIB1* in *MIB, the
DM-RS antenna port associated with* corresponding PDSCH receptions, and
the corresponding SS/PBCH block are quasi co-located with respect to
average gain, QCL-TypeA, and QCL-TypeD properties, when applicable \[6,
TS 38.214\], if the UE is not provided a TCI state indicating quasi
co-location information of the DM-RS antenna port for PDCCH reception in
the CORESET. The value for the DM-RS scrambling sequence initialization
is the cell ID. A SCS is provided by *subCarrierSpacingCommon* in *MIB*.

For single cell operation or for operation with carrier aggregation in a
same frequency band, a UE does not expect to monitor a PDCCH in a
Type0/0A/2/3-PDCCH CSS set or in a USS set if a DM-RS for monitoring a
PDCCH in a Type1-PDCCH CSS set does not have same QCL-TypeD properties
\[6, TS 38.214\] with a DM-RS for monitoring the PDCCH in the
Type0/0A/2/3-PDCCH CSS set or in the USS set, and if the PDCCH or an
associated PDSCH overlaps in at least one symbol with a PDCCH the UE
monitors in a Type1-PDCCH CSS set or with an associated PDSCH.

If a UE is provided

\- one or more search space sets by corresponding one or more of
*searchSpaceZero, searchSpaceSIB1, searchSpaceOtherSystemInformation*,
*pagingSearchSpace*, *ra-SearchSpace*, and

\- a C-RNTI, an MCS-C-RNTI, or a CS-RNTI,

the UE monitors PDCCH candidates for DCI format 0\_0 and DCI format 1\_0
with CRC scrambled by the C-RNTI, the MCS-C-RNTI, or the CS-RNTI in the
one or more search space sets in a slot where the UE monitors PDCCH
candidates for at least a DCI format 0\_0 or a DCI format 1\_0 with CRC
scrambled by SI-RNTI, RA-RNTI or P-RNTI.

If a UE is provided

\- one or more search space sets by corresponding one or more of
*searchSpaceZero, searchSpaceSIB1, searchSpaceOtherSystemInformation*,
*pagingSearchSpace*, *ra-SearchSpace*, or a CSS set by *PDCCH-Config*,
and

\- a SI-RNTI, a P-RNTI, a RA-RNTI, a SFI-RNTI, an INT-RNTI, a
TPC-PUSCH-RNTI, a TPC-PUCCH-RNTI, or a TPC-SRS-RNTI

then, for a RNTI from any of these RNTIs, the UE does not expect to
process information from more than one DCI format with CRC scrambled
with the RNTI per slot.

Table 10.1-1: CCE aggregation levels and maximum number of PDCCH
candidates per CCE aggregation level for CSS sets configured by
*searchSpaceSIB1*

  ----------------------- ----------------------
  CCE Aggregation Level   Number of Candidates
  4                       4
  8                       2
  16                      1
  ----------------------- ----------------------

For each DL BWP configured to a UE in a serving cell, a UE can be
provided by higher layer signalling with CORESETs. For each CORESET, the
UE is provided the following by *ControlResourceSet*:

\- a CORESET index , , by *controlResourceSetId*;

\- a DM-RS scrambling sequence initialization value by
*pdcch-DMRS-ScramblingID*;

\- a precoder granularity for a number of REGs in the frequency domain
where the UE can assume use of a same DM-RS precoder by
*precoderGranularity*;

\- a number of consecutive symbols provided by *duration*;

\- a set of resource blocks provided by *frequencyDomainResources*;

\- CCE-to-REG mapping parameters provided by *cce-REG-MappingType*;

\- an antenna port quasi co-location, from a set of antenna port quasi
co-locations provided by *TCI-State*, indicating quasi co-location
information of the DM-RS antenna port for PDCCH reception in a
respective CORESET;

\- an indication for a presence or absence of a transmission
configuration indication (TCI) field for DCI format 1\_1 transmitted by
a PDCCH in CORESET , by *tci-PresentInDCI*.

When *precoderGranularity* = *allContiguousRBs*, a UE does not expect

\- to be configured a set of resource blocks of a CORESET that includes
more than four sub-sets of resource blocks that are not contiguous in
frequency

\- any RE of a CORESET to overlap with any RE determined from
*lte-CRS-ToMatchAround* or with any RE of a SS/PBCH block.

For each CORESET in a DL BWP of a serving cell, a respective
*frequencyDomainResources* provides a bitmap. The bits of the bitmap
have a one-to-one mapping with non-overlapping groups of 6 consecutive
PRBs, in ascending order of the PRB index in the DL BWP bandwidth of
PRBs with starting common RB position where the first common RB of the
first group of 6 PRBs has common RB index .

For a CORESET other than a CORESET with index 0,

\- if a UE has not been provided a configuration of TCI state(s) by
*tci-StatesPDCCH-ToAddList* and *tci-StatesPDCCH-ToReleaseList* for the
CORESET, or has been provided initial configuration of more than one TCI
states for the CORESET by *tci-StatesPDCCH-ToAddList* and
*tci-StatesPDCCH-ToReleaseList* but has not received a MAC CE activation
command for one of the TCI states as described in \[11, TS 38.321\], the
UE assumes that the DM-RS antenna port associated with PDCCH receptions
is quasi co-located with the SS/PBCH block the UE identified during the
initial access procedure;

\- if a UE has been provided a configuration of more than one TCI states
by *tci-StatesPDCCH-ToAddList* and *tci-StatesPDCCH-ToReleaseList* for
the CORESET as part of Reconfiguration with sync procedure as described
in \[12, TS 38.331\] but has not received a MAC CE activation command
for one of the TCI states as described in \[11, TS 38.321\], the UE
assumes that the DM-RS antenna port associated with PDCCH receptions is
quasi co-located with the SS/PBCH block or the CSI-RS resource the UE
identified during the random access procedure initiated by the
Reconfiguration with sync procedure as described in \[12, TS 38.331\].

For a CORESET with index 0, the UE assumes that a DM-RS antenna port for
PDCCH receptions in the CORESET is quasi co-located with

\- the one or more DL RS configured by a TCI state, where the TCI state
is indicated by a MAC CE activation command for the CORESET, if any, or

\- a SS/PBCH block the UE identified during a most recent random access
procedure not initiated by a PDCCH order that triggers a contention-free
random access procedure, if no MAC CE activation command indicating a
TCI state for the CORESET is received after the most recent random
access procedure.

For a CORESET other than a CORESET with index 0, if a UE is provided a
single TCI state for a CORESET, or if the UE receives a MAC CE
activation command for one of the provided TCI states for a CORESET, the
UE assumes that the DM-RS antenna port associated with PDCCH receptions
in the CORESET is quasi co-located with the one or more DL RS configured
by the TCI state. For a CORESET with index 0, the UE expects that
QCL-TypeD of a CSI-RS in a TCI state indicated by a MAC CE activation
command for the CORESET is provided by a SS/PBCH block

\- if the UE receives a MAC CE activation command for one of the TCI
states, the UE applies the activation command in the first slot that is
after slot where is the slot where the UE would transmit a PUCCH with
HARQ-ACK information for the PDSCH providing the activation command and
is the SCS configuration for the PUCCH. The active BWP is defined as the
active BWP in the slot when the activation command is applied.

For each DL BWP configured to a UE in a serving cell, the UE is provided
by higher layers with search space sets where, for each search space set
from the search space sets, the UE is provided the following by
*SearchSpace*:

\- a search space set index , , by *searchSpaceId*

\- an association between the search space set and a CORESET by
*controlResourceSetId*

\- a PDCCH monitoring periodicity of slots and a PDCCH monitoring offset
of slots, by *monitoringSlotPeriodicityAndOffset*

\- a PDCCH monitoring pattern within a slot, indicating first symbol(s)
of the CORESET within a slot for PDCCH monitoring, by
*monitoringSymbolsWithinSlot*

\- a duration of slots indicating a number of slots that the search
space set exists by *duration*

\- a number of PDCCH candidates *per CCE aggregation level* by
*aggregationLevel1*, *aggregationLevel2*, *aggregationLevel4*,
*aggregationLevel8*, and *aggregationLevel16*, for CCE aggregation level
1, CCE aggregation level 2, CCE aggregation level 4, CCE aggregation
level 8, and CCE aggregation level 16, respectively

\- an indication that search space set is either a CSS set or a USS set
by *searchSpaceType*

\- if search space set is a CSS set

\- an indication by *dci-Format0-0-AndFormat1-0* to monitor PDCCH
candidates for DCI format 0\_0 and DCI format 1\_0

\- an indication by *dci-Format2-0* to monitor one or two PDCCH
candidates for DCI format 2\_0 and a corresponding CCE aggregation level

\- an indication by *dci-Format2-1* to monitor PDCCH candidates for DCI
format 2\_1

\- an indication by *dci-Format2-2* to monitor PDCCH candidates for DCI
format 2\_2

\- an indication by *dci-Format2-3* to monitor PDCCH candidates for DCI
format 2\_3

> \- if search space set is a USS set, an indication by *dci-Formats* to
> monitor PDCCH candidates either for DCI format 0\_0 and DCI format
> 1\_0, or for DCI format 0\_1 and DCI format 1\_1

If the *monitoringSymbolsWithinSlot* indicates to a UE to monitor PDCCH
in a subset of up to three consecutive symbols that are same in every
slot where the UE monitors PDCCH for all search space sets, the UE does
not expect to be configured with a PDCCH SCS other than 15 kHz if the
subset includes at least one symbol after the third symbol.

A UE does not expect to be provided a first symbol and a number of
consecutive symbols for a CORESET that results to a PDCCH candidate
mapping to symbols of different slots.

A UE does not expect any two PDCCH monitoring occasions on an active DL
BWP, for a same search space set or for different search space sets, in
a same CORESET to be separated by a non-zero number of symbols that is
smaller than the CORESET duration.

A UE determines a PDCCH monitoring occasion on an active DL BWP from the
PDCCH monitoring periodicity, the PDCCH monitoring offset, and the PDCCH
monitoring pattern within a slot. For search space set , the UE
determines that a PDCCH monitoring occasion(s) exists in a slot with
number \[4, TS 38.211\] in a frame with number if
$\left( n_{f}N_{\text{slot}}^{frame,\mu} + n_{s,f}^{\mu} - o_{p,s} \right)\text{mod\ }k_{p,s} = 0$[.]{.underline}
The UE monitors PDCCH candidates for search space set for consecutive
slots, starting from slot , and does not monitor PDCCH candidates for
search space set for the next consecutive slots.

A USS at CCE aggregation level is defined by a set of PDCCH candidates
for CCE aggregation level .

If a UE is configured with *CrossCarrierSchedulingConfig* for a serving
cell the carrier indicator field value corresponds to the value
indicated by *CrossCarrierSchedulingConfig.*

For an active DL BWP of a serving cell on which a UE monitors PDCCH
candidates in a USS, if the UE is not configured with a carrier
indicator field, the UE monitors the PDCCH candidates without carrier
indicator field. For an active DL BWP of a serving cell on which a UE
monitors PDCCH candidates in a USS, if a UE is configured with a carrier
indicator field, the UE monitors the PDCCH candidates with carrier
indicator field.

A UE does not expect to monitor PDCCH candidates on an active DL BWP of
a secondary cell if the UE is configured to monitor PDCCH candidates
with carrier indicator field corresponding to that secondary cell in
another serving cell. For the active DL BWP of a serving cell on which
the UE monitors PDCCH candidates, the UE monitors PDCCH candidates at
least for the same serving cell.

For a search space set associated with CORESET , the CCE indexes for
aggregation level corresponding to PDCCH candidate of the search space
set in slot for an active DL BWP of a serving cell corresponding to
carrier indicator field value are given by

where

for any CSS, ;

for a USS, , , for , for , for , and ;

;

is the number of CCEs, numbered from 0 to , in CORESET ;

is the carrier indicator field value if the UE is configured with a
carrier indicator field by *CrossCarrierSchedulingConfig* for the
serving cell on which PDCCH is monitored; otherwise, including for any
CSS, ;

, where is the number of PDCCH candidates the UE is configured to
monitor for aggregation level of a search space set for a serving cell
corresponding to ;

for any CSS, ;

for a USS, is the maximum of over all configured values for a CCE
aggregation level of search space set ;

the RNTI value used for is the C-RNTI.

A UE that

\- is configured for operation with carrier aggregation, and

\- indicates support of search space sharing through
*searchSpaceSharingCA-UL* or through *searchSpaceSharingCA-DL*, and

\- has a PDCCH candidate with CCE aggregation level in CORESET for a DCI
format 0\_1 or a DCI format 1\_1 having a first size and associated with
serving cell ,

can receive a corresponding PDCCH through a PDCCH candidate with CCE
aggregation level in CORESET for a DCI format 0\_1 or a DCI format 1\_1,
respectively, having a second size and associated with serving cell if
the first size and the second size are same.

A UE expects to monitor PDCCH candidates for up to 4 sizes of DCI
formats that include up to 3 sizes of DCI formats with CRC scrambled by
C-RNTI per serving cell. The UE counts a number of sizes for DCI formats
per serving cell based on a number of configured PDCCH candidates in
respective search space sets for the corresponding active DL BWP.

A PDCCH candidate with index for a search space set using a set of CCEs
in a CORESET on the active DL BWP for serving cell is not counted for
monitoring if there is a PDCCH candidate with index for a search space
set , or if there is a PDCCH candidate with index and , in the CORESET
on the active DL BWP for serving cell using a same set of CCEs, the
PDCCH candidates have identical scrambling, and the corresponding DCI
formats for the PDCCH candidates have a same size; otherwise, the PDCCH
candidate with index is counted for monitoring.

Table 10.1-2 provides the maximum number of monitored PDCCH candidates,
, for a DL BWP with SCS configuration for a UE per slot for operation
with a single serving cell.

Table 10.1-2: Maximum number of monitored PDCCH candidates per slot for
a DL BWP with SCS configuration for a single serving cell

  --- ----------------------------------------------------------------------------
      Maximum number of monitored PDCCH candidates per slot and per serving cell
  0   44
  1   36
  2   22
  3   20
  --- ----------------------------------------------------------------------------

Table 10.1-3 provides the maximum number of non-overlapped CCEs, , for a
DL BWP with SCS configuration that a UE is expected to monitor
corresponding PDCCH candidates per slot for operation with a single
serving cell.

CCEs for PDCCH candidates are non-overlapped if they correspond to

\- different CORESET indexes, or

\- different first symbols for the reception of the respective PDCCH
candidates.

Table 10.1-3: Maximum number of non-overlapped CCEs per slot for a DL
BWP with SCS configuration for a single serving cell

  --- ---------------------------------------------------------------------
      Maximum number of non-overlapped CCEs per slot and per serving cell
  0   56
  1   56
  2   48
  3   32
  --- ---------------------------------------------------------------------

If a UE is configured with downlink cells with DL BWPs having SCS
configuration where , the UE is not required to monitor, on the active
DL BWP of the scheduling cell, more than PDCCH candidates or more than
non-overlapped CCEs per slot for each scheduled cell.

If a UE is configured with downlink cells with DL BWPs having SCS
configuration , where , a DL BWP of an activated cell is the active DL
BWP of the activated cell, and a DL BWP of a deactivated cell is the DL
BWP with index provided by *firstActiveDownlinkBWP-Id* for the
deactivated cell, the UE is not required to monitor more than PDCCH
candidates or more than non-overlapped CCEs per slot on the active DL
BWP(s) of scheduling cell(s) from the downlink cells.

For each scheduled cell, the UE is not required to monitor on the active
DL BWP with SCS configuration of the scheduling cell more than PDCCH
candidates or more than non-overlapped CCEs per slot.

A UE does not expect to be configured CSS sets that result to
corresponding total, or per scheduled cell, numbers of monitored PDCCH
candidates and non-overlapped CCEs per slot that exceed the
corresponding maximum numbers per slot.

For same cell scheduling or for cross-carrier scheduling where a
scheduling cell and scheduled cell(s) have DL BWPs with same SCS
configuration , a UE does not expect a number of PDCCH candidates, and a
number of corresponding non-overlapped CCEs per slot on a secondary cell
to be larger than the corresponding numbers that the UE is capable of
monitoring on the secondary cell per slot.

For cross-carrier scheduling, the number of PDCCH candidates for
monitoring and the number of non-overlapped CCEs per slot are separately
counted for each scheduled cell.

For all search space sets within a slot , denote by a set of CSS sets
with cardinality of and by a set of USS sets with cardinality of . The
location of USS sets , , in is according to an ascending order of the
search space set index.

Denote by , , the number of counted PDCCH candidates for monitoring for
CSS set and by , , the number of counted PDCCH candidates for monitoring
for USS set .

For the CSS sets, a UE monitors PDCCH candidates requiring a total of
non-overlapping CCEs in a slot.

The UE allocates PDCCH candidates for monitoring to USS sets for the
primary cell having an active DL BWP with SCS configuration in slot
according to the following pseudocode. A UE does not expect to monitor
PDCCH in a USS set without allocated PDCCH candidates for monitoring.

Denote by the set of non-overlapping CCEs for search space set and by
the cardinality of where the non-overlapping CCEs for search space set
are determined considering the allocated PDCCH candidates for monitoring
for the CSS sets and the allocated PDCCH candidates for monitoring for
all search space sets , .

Set

Set

Set

while AND

allocate PDCCH candidates for monitoring to USS set

;

;

;

end while

If a UE

\- is configured for single cell operation or for operation with carrier
aggregation in a same frequency band, and

\- monitors PDCCH candidates in overlapping PDCCH monitoring occasions
in multiple CORESETs that have same or different QCL-TypeD properties on
active DL BWP(s) of one or more cells

the UE monitors PDCCHs only in a CORESET, and in any other CORESET from
the multiple CORESETs having same QCL-TypeD properties as the CORESET,
on the active DL BWP of a cell from the one or more cells

\- the CORESET corresponds to the CSS set with the lowest index in the
cell with the lowest index containing CSS, if any; otherwise, to the USS
set with the lowest index in the cell with lowest index

\- the lowest USS set index is determined over all USS sets with at
least one PDCCH candidate in overlapping PDCCH monitoring occasions

\- for the purpose of determining the CORESET, a SS/PBCH block is
considered to have different QCL-TypeD properties than a CSI-RS

\- for the purpose of determining the CORESET, a first CSI-RS associated
with a SS/PBCH block in a first cell and a second CSI-RS in a second
cell that is also associated with the SS/PBCH block are assumed to have
same QCL-TypeD properties

\- the allocation of non-overlapping CCEs and of PDCCH candidates for
PDCCH monitoring is according to all search space sets associated with
the multiple CORESETs on the active DL BWP(s) of the one or more cells

\- the number of active TCI states is determined from the multiple
CORESETs

If a UE

\- is configured for single cell operation or for operation with carrier
aggregation in a same frequency band, and

\- monitors PDCCH candidates in overlapping PDCCH monitoring occasions
in multiple CORESETs where none of the CORESETs has TCI-states with
\'QCL-TypeD\',

the UE is required to monitor PDCCH candidates in overlapping PDCCH
monitoring occasions for search space sets associated with different
CORESETs.

For a scheduled cell and at any time, a UE expects to have received at
most 16 PDCCHs for DCI formats 1\_0 or 1\_1 with CRC scrambled by
C-RNTI, CS-RNTI, or MCS-C-RNTI scheduling 16 PDSCH receptions for which
the UE has not received any corresponding PDSCH symbol and at most 16
PDCCHs for DCI formats 0\_0 or 0\_1 with CRC scrambled by C-RNTI,
CS-RNTI, or MCS-C-RNTI scheduling 16 PUSCH transmissions for which the
UE has not transmitted any corresponding PUSCH symbol.

If a UE

\- is not configured for NR-DC operation and indicates through
*pdcch-BlindDetectionCA* a capability to monitor PDCCH candidates for
downlink cells and the UE is configured with downlink cells or uplink
cells, or

\- is configured with NR-DC operation and for a cell group with downlink
cells or uplink cells

the UE expects to have respectively received at most PDCCHs for

\- DCI formats 1\_0 or 1\_1 with CRC scrambled by a C-RNTI, or a
CS-RNTI, or a MCS-C-RNTI scheduling PDSCH receptions for which the UE
has not received any corresponding PDSCH symbol over all downlink cells

\- DCI formats 0\_0 or 0\_1 with CRC scrambled by a C-RNTI, or a
CS-RNTI, or a MCS-C-RNTI scheduling PUSCH transmissions for which the UE
has not transmitted any corresponding PUSCH symbol over all uplink cells

If a UE

\- is configured to monitor a first PDCCH candidate for a DCI format
0\_0 and a DCI format 1\_0 from a CSS set and a second PDCCH candidate
for a DCI format 0\_0 and a DCI format 1\_0 from a USS set in a CORESET
with index zero on an active DL BWP, and

\- the DCI formats 0\_0/1\_0 associated with the first PDCCH candidate
and the DCI formats 0\_0/1\_0 associated with the second PDCCH candidate
have same size, and

\- the UE receives the first PDCCH candidate and the second PDCCH
candidate over a same set of CCEs, and

\- the first PDCCH candidate and the second PDCCH candidate have
identical scrambling, and

\- the DCI formats 0\_0/1\_0 for the first PDCCH candidate and the DCI
formats 0\_0/1\_0 for the second PDCCH candidate have CRC scrambled by
either C-RNTI, or MCS-C-RNTI, or CS-RNTI

the UE decodes only the DCI formats 0\_0/1\_0 associated with the first
PDCCH candidate.

If a UE detects a DCI format with inconsistent information, the UE
discards **all** the information in the DCI format.

A UE configured with a bandwidth part indicator in DCI formats 0\_1 or
1\_1 determines, in case of an active DL BWP or of an active UL BWP
change, the DCI information applicable to the new active DL BWP or UL
BWP, respectively, as described in Clause 12.

For unpaired spectrum operation, if a UE is not configured for
PUSCH/PUCCH transmission on serving cell , the UE does not expect to
monitor PDCCH on serving cell if the PDCCH overlaps in time with SRS
transmission (including any interruption due to uplink or downlink RF
retuning time \[10, TS 38.133\]) on serving cell and if the UE is not
capable of simultaneous reception and transmission on serving cell and
serving cell .

If a UE is provided *resourceBlocks* and s*ymbolsInResourceBlock* in
*RateMatchPattern*, or if the UE is additionally provided
*periodicityAndPattern* in *RateMatchPattern*, the UE can determine a
set of RBs in symbols of a slot that are not available for PDSCH
reception as described in \[6, TS 38.214\]. If a PDCCH candidate in a
slot is mapped to one or more REs that overlap with REs of any RB in the
set of RBs in symbols of the slot, the UE does not expect to monitor the
PDCCH candidate.

10.2 PDCCH validation for DL SPS and UL grant Type 2
----------------------------------------------------

A UE validates, for scheduling activation or scheduling release, a DL
SPS assignment PDCCH or configured UL grant Type 2 PDCCH if

\- the CRC of a corresponding DCI format is scrambled with a CS-RNTI
provided by *cs-RNTI*, and

\- the new data indicator field for the enabled transport block is set
to \'0\'.

Validation of the DCI format is achieved if all fields for the DCI
format are set according to Table 10.2-1 or Table 10.2-2.

If validation is achieved, the UE considers the information in the DCI
format as a valid activation or valid release of DL SPS or configured UL
grant Type 2. If validation is not achieved, the UE discards all the
information in the DCI format.

**Table 10.2-1: Special fields for DL SPS and UL grant Type 2 scheduling
activation PDCCH validation**

  --------------------- ---------------------- ------------------- ------------------------------------------------
                        DCI format 0\_0/0\_1   DCI format 1\_0     DCI format 1\_1
  HARQ process number   set to all \'0\'s      set to all \'0\'s   set to all \'0\'s
  Redundancy version    set to \'00\'          set to \'00\'       For the enabled transport block: set to \'00\'
  --------------------- ---------------------- ------------------- ------------------------------------------------

Table 10.2-2: Special fields for DL SPS and UL grant Type 2 scheduling
release PDCCH validation

  -------------------------------------- ------------------- -------------------
                                         DCI format 0\_0     DCI format 1\_0
  HARQ process number                    set to all \'0\'s   set to all \'0\'s
  Redundancy version                     set to \'00\'       set to \'00\'
  Modulation and coding scheme           set to all \'1\'s   set to all \'1\'s
  Frequency domain resource assignment   set to all \'1\'s   set to all \'1\'s
  -------------------------------------- ------------------- -------------------

A UE is expected to provide HARQ-ACK information in response to a SPS
PDSCH release after symbols from the last symbol of a PDCCH providing
the SPS PDSCH release. If *processingType2Enabled* of
*PDSCH-ServingCellConfig* is set to *enable* for the serving cell with
the PDCCH providing the SPS PDSCH release, for , for , and for ,
otherwise, for , for , for , and for , wherein corresponds to the
smallest SCS configuration between the SCS configuration of the PDCCH
providing the SPS PDSCH release and the SCS configuration of a PUCCH
carrying the HARQ-ACK information in response to a SPS PDSCH release.

11 UE-group common signalling 
=============================

If the UE is configured with a SCG, the UE shall apply the procedures
described in this clause for both MCG and SCG

\- When the procedures are applied for MCG, the terms \'secondary
cell\', \'secondary cells\' , \'serving cell\', \'serving cells\' in
this clause refer to secondary cell, secondary cells, serving cell,
serving cells belonging to the MCG respectively.

\- When the procedures are applied for SCG, the terms \'secondary
cell\', \'secondary cells\', \'serving cell\', \'serving cells\' in this
clause refer to secondary cell, secondary cells (not including PSCell),
serving cell, serving cells belonging to the SCG respectively. The term
\'primary cell\' in this clause refers to the PSCell of the SCG.

11.1 Slot configuration
-----------------------

A slot format includes downlink symbols, uplink symbols, and flexible
symbols.

The following are applicable for each serving cell.

If a UE is provided *tdd-UL-DL-ConfigurationCommon*, the UE sets the
slot format per slot over a number of slots as indicated by
*tdd-UL-DL-ConfigurationCommon*.

The *tdd-UL-DL-ConfigurationCommon* provides

\- a reference SCS configuration by *referenceSubcarrierSpacing*

> \- a *pattern1*.

The *pattern1* provides

\- a slot configuration period of msec by
*dl-UL-TransmissionPeriodicity*

\- a number of slots with only downlink symbols by *nrofDownlinkSlots*

\- a number of downlink symbols by *nrofDownlinkSymbols*

\- a number of slots with only uplink symbols by *nrofUplinkSlots*

\- a number of uplink symbols by *nrofUplinkSymbols*

A value msec is valid only for . A value msec is valid only for or . A
value msec is valid only for , or , or .

A slot configuration period of msec includes slots with SCS
configuration . From the slots, a first slots include only downlink
symbols and a last slots include only uplink symbols. The symbols after
the first slots are downlink symbols. The symbols before the last slots
are uplink symbols. The remaining are flexible symbols.

The first symbol every periods is a first symbol in an even frame.

If *tdd-UL-DL-ConfigurationCommon* provides both *pattern1* and
*pattern2*, the UE sets the slot format per slot over a first number of
slots as indicated by *pattern1* and the UE sets the slot format per
slot over a second number of slots as indicated by *pattern2*.

The *pattern2* provides

\- a slot configuration period of msec by
*dl-UL-TransmissionPeriodicity*

\- a number of slots with only downlink symbols by *nrofDownlinkSlots*

\- a number of downlink symbols by *nrofDownlinkSymbols*

\- a number of slots with only uplink symbols by *nrofUplinkSlots*

\- a number of uplink symbols by *nrofUplinkSymbols*

The applicable values of are same as the applicable values for .

A slot configuration period of msec includes first slots and second
slots.

From the slots, a first slots include only downlink symbols and a last
include only uplink symbols. The symbols after the first slots are
downlink symbols. The symbols before the last slots are uplink symbols.
The remaining are flexible symbols.

A UE expects that divides 20 msec.

The first symbol every periods is a first symbol in an even frame.

A UE expects that the reference SCS configuration is smaller than or
equal to a SCS configuration for any configured DL BWP or UL BWP. Each
slot provided by *pattern1* or *pattern2* is applicable to consecutive
slots in the active DL BWP or the active UL BWP where the first slot
starts at a same time as a first slot for the reference SCS
configuration and each downlink or flexible or uplink symbol for the
reference SCS configuration corresponds to consecutive downlink or
flexible or uplink symbols for the SCS configuration .

If the UE is additionally provided *tdd-UL-DL-ConfigurationDedicated*,
the parameter *tdd-UL-DL-ConfigurationDedicated* overrides only flexible
symbols per slot over the number of slots as provided by
*tdd-UL-DL-ConfigurationCommon*.

The *tdd-UL-DL-ConfigurationDedicated* provides

\- a set of slot configurations by
*slotSpecificConfigurationsToAddModList*

\- for each slot configuration from the set of slot configurations

\- a slot index for a slot provided by *slotIndex*

\- a set of symbols for a slot by *symbols* where

\- if *symbols* = *allDownlink*, all symbols in the slot are downlink

\- if *symbols* = *allUplink*, all symbols in the slot are uplink

\- if *symbols* = *explicit*, *nrofDownlinkSymbols* provides a number of
downlink first symbols in the slot and *nrofUplinkSymbols* provides a
number of uplink last symbols in the slot. If *nrofDownlinkSymbols* is
not provided, there are no downlink first symbols in the slot and if
*nrofUplinkSymbols* is not provided, there are no uplink last symbols in
the slot. The remaining symbols in the slot are flexible

For each slot having a corresponding index provided by *slotIndex*, the
UE applies a format provided by a corresponding *symbols*. The UE does
not expect *tdd-UL-DL-ConfigurationDedicated* to indicate as uplink or
as downlink a symbol that *tdd-UL-DL-ConfigurationCommon* indicates as a
downlink or as an uplink symbol, respectively.

For each slot configuration provided by
*tdd-UL-DL-ConfigurationDedicated*, a reference SCS configuration is the
reference SCS configuration
![](./media/image1128.wmf){width="0.25277777777777777in"
height="0.21944444444444444in"} provided by
*tdd-UL-DL-ConfigurationCommon*.

A slot configuration period and a number of downlink symbols, uplink
symbols, and flexible symbols in each slot of the slot configuration
period are determined from *tdd-UL-DL-ConfigurationCommon* and
*tdd-UL-DL-ConfigurationDedicated* and are common to each configured
BWP.

A UE considers symbols in a slot indicated as downlink by
*tdd-UL-DL-ConfigurationCommon*, or *tdd-UL-DL-ConfigurationDedicated*
to be available for receptions and considers symbols in a slot indicated
as uplink by *tdd-UL-DL-ConfigurationCommon*, or by
*tdd*-*UL-DL-ConfigurationDedicated* to be available for transmissions.

If a UE is not configured to monitor PDCCH for DCI format 2\_0, for a
set of symbols of a slot that are indicated as flexible by
*tdd-UL-DL-ConfigurationCommon* and *tdd*-*UL-DL-ConfigurationDedicated*
if provided, or when *tdd-UL-DL-ConfigurationCommon* and
*tdd*-*UL-DL-ConfigurationDedicated* are not provided to the UE

\- the UE receives PDSCH or CSI-RS in the set of symbols of the slot if
the UE receives a corresponding indication by a DCI format 1\_0, DCI
format 1\_1, or DCI format 0\_1

\- the UE transmits PUSCH, PUCCH, PRACH, or SRS in the set of symbols of
the slot if the UE receives a corresponding indication by a DCI format
0\_0, DCI format 0\_1, DCI format 1\_0, DCI format 1\_1, DCI format
2\_3, or a RAR UL grant

For operation on a single carrier in unpaired spectrum, if a UE is
configured by higher layers to receive a PDCCH, or a PDSCH, or a CSI-RS
in a set of symbols of a slot, the UE receives the PDCCH, the PDSCH, or
the CSI-RS if the UE does not detect a DCI format 0\_0, DCI format 0\_1,
DCI format 1\_0, DCI format 1\_1, or DCI format 2\_3 that indicates to
the UE to transmit a PUSCH, a PUCCH, a PRACH, or a SRS in at least one
symbol of the set of symbols of the slot; otherwise, the UE does not
receive the PDCCH, or the PDSCH, or the CSI-RS in the set of symbols of
the slot.

For operation on a single carrier in unpaired spectrum, if a UE is
configured by higher layers to transmit SRS, or PUCCH, or PUSCH, or
PRACH in a set of symbols of a slot and the UE detects a DCI format
1\_0, DCI format 1\_1, or DCI format 0\_1 indicating to the UE to
receive CSI-RS or PDSCH in a subset of symbols from the set of symbols,
then

\- the UE does not expect to cancel the transmission of the PUCCH or
PUSCH or PRACH in the set of symbols if the first symbol in the set
occurs within $T_{proc,2}$ relative to a last symbol of a CORESET where
the UE detects the DCI format;

\- otherwise, the UE cancels the PUCCH, or PUSCH, or PRACH transmission
in the set of symbols.

\- the UE does not expect to cancel the transmission of SRS in symbols
from the subset of symbols that occur within $T_{proc,2}$ relative to a
last symbol of CORESET where the UE detects the DCI format. The UE
cancels the SRS transmission in remaining symbols from the subset of
symbols.

$T_{proc,2}$ is the PUSCH preparation time for the corresponding UE
processing capability \[6, TS38.214\] assuming $d_{2,1} = 1$ and $\mu$
corresponds to the smallest SCS configuration between the SCS
configuration of the PDCCH carrying the DCI format and the SCS
configuration of the SRS, PUCCH, PUSCH or $\mu_{r}$, where $\mu_{r}$
corresponds to the SCS configuration of the PRACH if it is 15kHz or
higher; otherwise $\mu_{r} = 0.$

For a set of symbols of a slot that are indicated to a UE as uplink by
*tdd-UL-DL-ConfigurationCommon*, or *tdd-UL-DL-ConfigurationDedicated*,
the UE does not receive PDCCH, PDSCH, or CSI-RS when the PDCCH, PDSCH,
or CSI-RS overlaps, even partially, with the set of symbols of the slot.

For a set of symbols of a slot that are indicated to a UE as downlink by
*tdd-UL-DL-ConfigurationCommon*, or *tdd-UL-DL-ConfigurationDedicated*,
the UE does not transmit PUSCH, PUCCH, PRACH, or SRS when the PUSCH,
PUCCH, PRACH, or SRS overlaps, even partially, with the set of symbols
of the slot.

For a set of symbols of a slot that are indicated to a UE as flexible by
*tdd-UL-DL-ConfigurationCommon*, and *tdd-UL-DL-ConfigurationDedicated*
if provided, the UE does not expect to receive both dedicated higher
layer parameters configuring transmission from the UE in the set of
symbols of the slot and dedicated higher layer parameters configuring
reception by the UE in the set of symbols of the slot.

For operation on a single carrier in unpaired spectrum, for a set of
symbols of a slot that are indicated to a UE by *ssb-PositionsInBurst*
in *SIB1* or *ssb-PositionsInBurst* in *ServingCellConfigCommon*, for
reception of SS/PBCH blocks, the UE does not transmit PUSCH, PUCCH,
PRACH in the slot if a transmission would overlap with any symbol from
the set of symbols and the UE does not transmit SRS in the set of
symbols of the slot. The UE does not expect the set of symbols of the
slot to be indicated as uplink by *tdd-UL-DL-ConfigurationCommon*, or
*tdd-UL-DL-ConfigurationDedicated*, when provided to the UE.

For a set of symbols of a slot corresponding to a valid PRACH occasion
and symbols before the valid PRACH occasion, as described in Sublcause
8.1, the UE does not receive PDCCH, PDSCH, or CSI-RS in the slot if a
reception would overlap with any symbol from the set of symbols. The UE
does not expect the set of symbols of the slot to be indicated as
downlink by *tdd-UL-DL-ConfigurationCommon* or
*tdd-UL-DL-ConfigurationDedicated*.

For a set of symbols of a slot indicated to a UE by *pdcch-ConfigSIB1*
in *MIB* for a CORESET for Type0-PDCCH CSS set, the UE does not expect
the set of symbols to be indicated as uplink by
*tdd-UL-DL-ConfigurationCommon*, or *tdd-UL-DL-ConfigurationDedicated*.

If a UE is scheduled by a DCI format 1\_1 to receive PDSCH over multiple
slots, and if *tdd-UL-DL-ConfigurationCommon*, or
*tdd-UL-DL-ConfigurationDedicated*, indicate that, for a slot from the
multiple slots, at least one symbol from a set of symbols where the UE
is scheduled PDSCH reception in the slot is an uplink symbol, the UE
does not receive the PDSCH in the slot.

If a UE is scheduled by a DCI format 0\_1 to transmit PUSCH over
multiple slots, and if *tdd-UL-DL-ConfigurationCommon*, or
*tdd-UL-DL-ConfigurationDedicated*, indicates that, for a slot from the
multiple slots, at least one symbol from a set of symbols where the UE
is scheduled PUSCH transmission in the slot is a downlink symbol, the UE
does not transmit the PUSCH in the slot.

### 11.1.1 UE procedure for determining slot format

This clause applies for a serving cell that is included in a set of
serving cells configured to a UE by *slotFormatCombToAddModList* and
*slotFormatCombToReleaseList*.

If a UE is configured by higher layers with parameter
*SlotFormatIndicator*, the UE is provided a SFI-RNTI by *sfi-RNTI* and
with a payload size of DCI format 2\_0 by *dci-PayloadSize*.

The UE is also provided in one or more serving cells with a
configuration for a search space set and a corresponding CORESET for
monitoring PDCCH candidates for DCI format 2\_0 with a CCE aggregation
level of CCEs as described in Clause 10.1. The PDCCH candidates are the
first PDCCH candidates *for CCE aggregation level* for search space set
in CORESET .

For each serving cell in the set of serving cells, the UE can be
provided:

\- an identity of the serving cell by *servingCellId*

\- a location of a SFI-index field in DCI format 2\_0 by *positionInDCI*

\- a set of slot format combinations by *slotFormatCombinations*, where
each slot format combination in the set of slot format combinations
includes

\- one or more slot formats indicated by a respective *slotFormats* for
the slot format combination, and

\- a mapping for the slot format combination provided by *slotFormats*
to a corresponding SFI-index field value in DCI format 2\_0 provided by
*slotFormatCombinationId*

\- for unpaired spectrum operation, a reference SCS configuration by
*subcarrierSpacing* and, when a supplementary UL carrier is configured
for the serving cell, a reference SCS configuration by
*subcarrierSpacing2* for the supplementary UL carrier

\- for paired spectrum operation, a reference SCS configuration for a DL
BWP by *subcarrierSpacing* and a reference SCS configuration for an UL
BWP by *subcarrierSpacing2*

A SFI-index field value in a DCI format 2\_0 indicates to a UE a slot
format for each slot in a number of slots for each DL BWP or each UL BWP
starting from a slot where the UE detects the DCI format 2\_0. The
number of slots is equal to or larger than a PDCCH monitoring
periodicity for DCI format 2\_0. The SFI-index field includes bits where
maxSFIindex is the maximum value of the values provided by corresponding
*slotFormatCombinationId*. A slot format is identified by a
corresponding format index as provided in Table 11.1.1-1 where \'D\'
denotes a downlink symbol, \'U\' denotes an uplink symbol, and \'F\'
denotes a flexible symbol.

If a PDCCH monitoring periodicity for DCI format 2\_0, provided to a UE
for the search space set by *monitoringSlotPeriodicityAndOffset*, is
smaller than a duration of a slot format combination the UE obtains at a
PDCCH monitoring occasion for DCI format 2\_0 by a corresponding
SFI-index field value, and the UE detects more than one DCI formats 2\_0
indicating a slot format for a slot, the UE expects each of the more
than one DCI formats 2\_0 to indicate a same format for the slot.

A UE does not expect to be configured to monitor PDCCH for DCI format
2\_0 on a second serving cell that uses larger SCS than the serving
cell.

Table 11.1.1-1: Slot formats for normal cyclic prefix

  **Format**   **Symbol number in a slot**                                                                                                                                                                                                                                          
  ------------ ----------------------------------------------------------------------------------------------------------------------------------------------------------------- ------- ------- ------- ------- ------- ------- ------- ------- ------- -------- -------- -------- --------
               **0**                                                                                                                                                             **1**   **2**   **3**   **4**   **5**   **6**   **7**   **8**   **9**   **10**   **11**   **12**   **13**
  0            D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       D        D        D        D
  1            U                                                                                                                                                                 U       U       U       U       U       U       U       U       U       U        U        U        U
  2            F                                                                                                                                                                 F       F       F       F       F       F       F       F       F       F        F        F        F
  3            D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       D        D        D        F
  4            D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       D        D        F        F
  5            D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       D        F        F        F
  6            D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       F        F        F        F
  7            D                                                                                                                                                                 D       D       D       D       D       D       D       D       F       F        F        F        F
  8            F                                                                                                                                                                 F       F       F       F       F       F       F       F       F       F        F        F        U
  9            F                                                                                                                                                                 F       F       F       F       F       F       F       F       F       F        F        U        U
  10           F                                                                                                                                                                 U       U       U       U       U       U       U       U       U       U        U        U        U
  11           F                                                                                                                                                                 F       U       U       U       U       U       U       U       U       U        U        U        U
  12           F                                                                                                                                                                 F       F       U       U       U       U       U       U       U       U        U        U        U
  13           F                                                                                                                                                                 F       F       F       U       U       U       U       U       U       U        U        U        U
  14           F                                                                                                                                                                 F       F       F       F       U       U       U       U       U       U        U        U        U
  15           F                                                                                                                                                                 F       F       F       F       F       U       U       U       U       U        U        U        U
  16           D                                                                                                                                                                 F       F       F       F       F       F       F       F       F       F        F        F        F
  17           D                                                                                                                                                                 D       F       F       F       F       F       F       F       F       F        F        F        F
  18           D                                                                                                                                                                 D       D       F       F       F       F       F       F       F       F        F        F        F
  19           D                                                                                                                                                                 F       F       F       F       F       F       F       F       F       F        F        F        U
  20           D                                                                                                                                                                 D       F       F       F       F       F       F       F       F       F        F        F        U
  21           D                                                                                                                                                                 D       D       F       F       F       F       F       F       F       F        F        F        U
  22           D                                                                                                                                                                 F       F       F       F       F       F       F       F       F       F        F        U        U
  23           D                                                                                                                                                                 D       F       F       F       F       F       F       F       F       F        F        U        U
  24           D                                                                                                                                                                 D       D       F       F       F       F       F       F       F       F        F        U        U
  25           D                                                                                                                                                                 F       F       F       F       F       F       F       F       F       F        U        U        U
  26           D                                                                                                                                                                 D       F       F       F       F       F       F       F       F       F        U        U        U
  27           D                                                                                                                                                                 D       D       F       F       F       F       F       F       F       F        U        U        U
  28           D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       D        D        F        U
  29           D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       D        F        F        U
  30           D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       F        F        F        U
  31           D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       D        F        U        U
  32           D                                                                                                                                                                 D       D       D       D       D       D       D       D       D       F        F        U        U
  33           D                                                                                                                                                                 D       D       D       D       D       D       D       D       F       F        F        U        U
  34           D                                                                                                                                                                 F       U       U       U       U       U       U       U       U       U        U        U        U
  35           D                                                                                                                                                                 D       F       U       U       U       U       U       U       U       U        U        U        U
  36           D                                                                                                                                                                 D       D       F       U       U       U       U       U       U       U        U        U        U
  37           D                                                                                                                                                                 F       F       U       U       U       U       U       U       U       U        U        U        U
  38           D                                                                                                                                                                 D       F       F       U       U       U       U       U       U       U        U        U        U
  39           D                                                                                                                                                                 D       D       F       F       U       U       U       U       U       U        U        U        U
  40           D                                                                                                                                                                 F       F       F       U       U       U       U       U       U       U        U        U        U
  41           D                                                                                                                                                                 D       F       F       F       U       U       U       U       U       U        U        U        U
  42           D                                                                                                                                                                 D       D       F       F       F       U       U       U       U       U        U        U        U
  43           D                                                                                                                                                                 D       D       D       D       D       D       D       D       F       F        F        F        U
  44           D                                                                                                                                                                 D       D       D       D       D       F       F       F       F       F        F        U        U
  45           D                                                                                                                                                                 D       D       D       D       D       F       F       U       U       U        U        U        U
  46           D                                                                                                                                                                 D       D       D       D       F       U       D       D       D       D        D        F        U
  47           D                                                                                                                                                                 D       F       U       U       U       U       D       D       F       U        U        U        U
  48           D                                                                                                                                                                 F       U       U       U       U       U       D       F       U       U        U        U        U
  49           D                                                                                                                                                                 D       D       D       F       F       U       D       D       D       D        F        F        U
  50           D                                                                                                                                                                 D       F       F       U       U       U       D       D       F       F        U        U        U
  51           D                                                                                                                                                                 F       F       U       U       U       U       D       F       F       U        U        U        U
  52           D                                                                                                                                                                 F       F       F       F       F       U       D       F       F       F        F        F        U
  53           D                                                                                                                                                                 D       F       F       F       F       U       D       D       F       F        F        F        U
  54           F                                                                                                                                                                 F       F       F       F       F       F       D       D       D       D        D        D        D
  55           D                                                                                                                                                                 D       F       F       F       U       U       U       D       D       D        D        D        D
  56 -- 254    Reserved                                                                                                                                                                                                                                                             
  255          UE determines the slot format for the slot based on *tdd-UL-DL-ConfigurationCommon*, or *tdd-UL-DL-ConfigurationDedicated* and, if any, on detected DCI formats                                                                                                      

For unpaired spectrum operation for a UE on a serving cell, the UE is
provided by *subcarrierSpacing* a reference SCS configuration for each
slot format in a combination of slot formats indicated by a SFI-index
field value in DCI format 2\_0. The UE expects that for a reference SCS
configuration and for an active DL BWP or an active UL BWP with SCS
configuration , it is . Each slot format in the combination of slot
formats indicated by the SFI-index field value in DCI format 2\_0 is
applicable to consecutive slots in the active DL BWP or the active UL
BWP where the first slot starts at a same time as a first slot for the
reference SCS configuration and each downlink or flexible or uplink
symbol for the reference SCS configuration  corresponds to  consecutive
downlink or flexible or uplink symbols for the SCS configuration .

For paired spectrum operation for a UE on a serving cell, the SFI-index
field in DCI format 2\_0 indicates a combination of slot formats that
includes a combination of slot formats for a reference DL BWP and a
combination of slot formats for a reference UL BWP of the serving cell.
The UE is provided by *subcarrierSpacing* a reference SCS configuration
for the combination of slot formats indicated by the SFI-index field
value in DCI format 2\_0 for the reference DL BWP of the serving cell.
The UE is provided by *subcarrierSpacing2* a reference SCS configuration
for the combination of slot formats indicated by the SFI-index field
value in DCI format 2\_0 for the reference UL BWP of the serving cell.
If and for each values provided by a value of *slotFormats*, where the
value of *slotFormats* is determined by a value of
*slotFormatCombinationId* in *slotFormatCombination* and the value of
*slotFormatCombinationId* is set by the value of the SFI-index field
value in DCI format 2\_0, the first values for the combination of slot
formats are applicable to the reference DL BWP and the next value is
applicable to the reference UL BWP. If and for each values provided by
*slotFormats*, the first value for the combination of slot formats is
applicable to the reference DL BWP and the next values are applicable to
the reference UL BWP.

The UE is provided a reference SCS configuration so that for an active
DL BWP with SCS configuration , it is . The UE is provided a reference
SCS configuration so that for an active UL BWP with SCS configuration ,
it is . Each slot format for a combination of slot formats indicated by
the SFI-index field value in DCI format 2\_0 for the reference DL BWP,
by indicating a value for *slotFormatCombinationId* that is mapped to a
value of *slotFormats* in *slotFormatCombination*, is applicable to
consecutive slots for the active DL BWP where the first slot starts at a
same time as a first slot in the reference DL BWP and each downlink or
flexible symbol for the reference SCS configuration  corresponds to
 consecutive downlink or flexible symbols for the SCS configuration .
Each slot format for the combination of slot formats for the reference
UL BWP is applicable to consecutive slots for the active UL BWP where
the first slot starts at a same time as a first slot in the reference UL
BWP and each uplink or flexible symbol for the reference SCS
configuration corresponds to  consecutive uplink or flexible symbols for
the SCS configuration .

For unpaired spectrum operation with a second UL carrier for a UE on a
serving cell, the SFI-index field value in DCI format 2\_0 indicates a
combination of slot formats that includes a combination of slot formats
for a reference first UL carrier of the serving cell and a combination
of slot formats for a reference second UL carrier of the serving cell.
The UE is provided by *subcarrierSpacing* a reference SCS configuration
for the combination of slot formats indicated by the SFI-index field in
DCI format 2\_0 for the reference first UL carrier of the serving cell.
The UE is provided by *subcarrierSpacing2* a reference SCS configuration
for the combination of slot formats indicated by the SFI-index field
value in DCI format 2\_0 for the reference second UL carrier of the
serving cell. For each values of *slotFormats*, the first values for the
combination of slot formats are applicable to the reference first UL
carrier and the next value is applicable to the reference second UL
carrier.

The UE expects to be provided a reference SCS configuration so that for
an active UL BWP in the second UL carrier with SCS configuration , it is
. Each slot format for a combination of slot formats indicated by the
SFI-index field in DCI format 2\_0 for the reference first UL carrier is
applicable to consecutive slots for the active DL BWP and the active UL
BWP in the first UL carrier where the first slot starts at a same time
as a first slot in the reference first UL carrier. Each slot format for
the combination of slot formats for the reference second UL carrier is
applicable to consecutive slots for the active UL BWP in the second UL
carrier where the first slot starts at a same time as a first slot in
the reference second UL carrier.

If a BWP in the serving cell is configured with and with extended CP,
the UE expects , , or . A format for a slot with extended CP is
determined from a format for a slot with normal CP. A UE determines an
extended CP symbol to be a downlink/uplink/flexible symbol if the
overlapping normal CP symbols that are downlink/uplink/flexible symbols,
respectively. A UE determines an extended CP symbol to be a flexible
symbol if one of the overlapping normal CP symbols is flexible. A UE
determines an extended CP symbol to be a flexible symbol if the pair of
the overlapping normal CP symbols includes a downlink and an uplink
symbol.

A reference SCS configuration , or , or , or is either 0, or 1, or 2 for
FR1 and is either 2 or 3 for FR2.

For a set of symbols of a slot, a UE does not expect to detect a DCI
format 2\_0 with an SFI-index field value indicating the set of symbols
of the slot as uplink and to detect a DCI format 1\_0, a DCI format
1\_1, or DCI format 0\_1 indicating to the UE to receive PDSCH or CSI-RS
in the set of symbols of the slot.

For a set of symbols of a slot, a UE does not expect to detect a DCI
format 2\_0 with an SFI-index field value indicating the set of symbols
in the slot as downlink and to detect a DCI format 0\_0, DCI format
0\_1, DCI format 1\_0, DCI format 1\_1, DCI format 2\_3, or a RAR UL
grant indicating to the UE to transmit PUSCH, PUCCH, PRACH, or SRS in
the set of symbols of the slot.

For a set of symbols of a slot that are indicated as downlink/uplink by
*tdd-UL-DL-ConfigurationCommon*, or *tdd-UL-DL-ConfigurationDedicated*,
the UE does not expect to detect a DCI format 2\_0 with an SFI-index
field value indicating the set of symbols of the slot as
uplink/downlink, respectively, or as flexible.

For a set of symbols of a slot indicated to a UE by
*ssb-PositionsInBurst* in *SIB1* or *ssb-PositionsInBurst* in
*ServingCellConfigCommon* for reception of SS/PBCH blocks, the UE does
not expect to detect a DCI format 2\_0 with an SFI-index field value
indicating the set of symbols of the slot as uplink.

For a set of symbols of a slot corresponding to a valid PRACH occasion
and symbols before the valid PRACH occasion, as described in Sublcause
8.1, the UE does not expect to detect a DCI format 2\_0 with an
SFI-index field value indicating the set of symbols of the slot as
downlink.

For a set of symbols of a slot indicated to a UE by *pdcch-ConfigSIB1*
in *MIB* for a CORESET for Type0-PDCCH CSS set, the UE does not expect
to detect a DCI format 2\_0 with an SFI-index field value indicating the
set of symbols of the slot as uplink.

For a set of symbols of a slot indicated to a UE as flexible by
*tdd-UL-DL-ConfigurationCommon* and *tdd-UL-DL-ConfigurationDedicated*
if provided, or when *tdd-UL-DL-ConfigurationCommon* and
*tdd-UL-DL-ConfigurationDedicated* are not provided to the UE, and if
the UE detects a DCI format 2\_0 providing a format for the slot using a
slot format value other than 255

\- if one or more symbols from the set of symbols are symbols in a
CORESET configured to the UE for PDCCH monitoring, the UE receives PDCCH
in the CORESET only if an SFI-index field value in DCI format 2\_0
indicates that the one or more symbols are downlink symbols

\- if an SFI-index field value in DCI format 2\_0 indicates the set of
symbols of the slot as flexible and the UE detects a DCI format 1\_0,
DCI format 1\_1, or DCI format 0\_1 indicating to the UE to receive
PDSCH or CSI-RS in the set of symbols of the slot, the UE receives PDSCH
or CSI-RS in the set of symbols of the slot

\- if an SFI-index field value in DCI format 2\_0 indicates the set of
symbols of the slot as flexible and the UE detects a DCI format 0\_0,
DCI format 0\_1, DCI format 1\_0, DCI format 1\_1, DCI format 2\_3, or a
RAR UL grant indicating to the UE to transmit PUSCH, PUCCH, PRACH, or
SRS in the set of symbols of the slot the UE transmits the PUSCH, PUCCH,
PRACH, or SRS in the set of symbols of the slot

\- if an SFI-index field value in DCI format 2\_0 indicates the set of
symbols of the slot as flexible, and the UE does not detect a DCI format
1\_0, DCI format 1\_1, or DCI format 0\_1 indicating to the UE to
receive PDSCH or CSI-RS, or the UE does not detect a DCI format 0\_0,
DCI format 0\_1, DCI format 1\_0, DCI format 1\_1, DCI format 2\_3, or a
RAR UL grant indicating to the UE to transmit PUSCH, PUCCH, PRACH, or
SRS in the set of symbols of the slot, the UE does not transmit or
receive in the set of symbols of the slot

\- if the UE is configured by higher layers to receive PDSCH or CSI-RS
in the set of symbols of the slot, the UE receives the PDSCH or the
CSI-RS in the set of symbols of the slot only if an SFI-index field
value in DCI format 2\_0 indicates the set of symbols of the slot as
downlink

\- if the UE is configured by higher layers to transmit PUCCH, or PUSCH,
or PRACH in the set of symbols of the slot, the UE transmits the PUCCH,
or the PUSCH, or the PRACH in the slot only if an SFI-index field value
in DCI format 2\_0 indicates the set of symbols of the slot as uplink

\- if the UE is configured by higher layers to transmit SRS in the set
of symbols of the slot, the UE transmits the SRS only in a subset of
symbols from the set of symbols of the slot indicated as uplink symbols
by an SFI-index field value in DCI format 2\_0

\- a UE does not expect to detect an SFI-index field value in DCI format
2\_0 indicating the set of symbols of the slot as downlink and also
detect a DCI format 0\_0, DCI format 0\_1, DCI format 1\_0, DCI format
1\_1, DCI format 2\_3, or a RAR UL grant indicating to the UE to
transmit SRS, PUSCH, PUCCH, or PRACH, in one or more symbols from the
set of symbols of the slot

\- a UE does not expect to detect an SFI-index field value in DCI format
2\_0 indicating the set of symbols of the slot as downlink or flexible
if the set of symbols of the slot includes symbols corresponding to any
repetition of a PUSCH transmission activated by an UL Type 2 grant PDCCH
as described in Clause 10.2

\- a UE does not expect to detect an SFI-index field value in DCI format
2\_0 indicating the set of symbols of the slot as uplink and also detect
a DCI format 1\_0 or DCI format 1\_1 or DCI format 0\_1 indicating to
the UE to receive PDSCH or CSI-RS in one or more symbols from the set of
symbols of the slot

If a UE is configured by higher layers to receive a CSI-RS or a PDSCH in
a set of symbols of a slot and the UE detects a DCI format 2\_0 with a
slot format value other than 255 that indicates a slot format with a
subset of symbols from the set of symbols as uplink or flexible, or the
UE detects a DCI format 0\_0, DCI format 0\_1, DCI format 1\_0, DCI
format 1\_1, or DCI format 2\_3 indicating to the UE to transmit PUSCH,
PUCCH, SRS, or PRACH in at least one symbol in the set of the symbols,
the UE cancels the CSI-RS reception in the set of symbols of the slot or
cancels the PDSCH reception in the slot.

If a UE is configured by higher layers to transmit SRS, or PUCCH, or
PUSCH, or PRACH in a set of symbols of a slot and the UE detects a DCI
format 2\_0 with a slot format value other than 255 that indicates a
slot format with a subset of symbols from the set of symbols as downlink
or flexible, or the UE detects a DCI format 1\_0, DCI format 1\_1, or
DCI format 0\_1 indicating to the UE to receive CSI-RS or PDSCH in a
subset of symbols from the set of symbols, then

> \- the UE does not expect to cancel the transmission of the PUCCH or
> PUSCH or PRACH in the set of symbols if the first symbol in the set
> occurs within $T_{proc,2}$ relative to a last symbol of a CORESET
> where the UE detects the DCI format;

\- otherwise, the UE cancels the PUCCH, or PUSCH, or PRACH transmission
in the set of symbols.

\- the UE does not expect to cancel the transmission of SRS in symbols
from the subset of symbols that occur within $T_{proc,2}$ relative to a
last symbol of CORESET where the UE detects the DCI format. The UE
cancels the SRS transmission in remaining symbols from the subset of
symbols.

$T_{proc,2}$ is the PUSCH preparation time for the corresponding UE
processing capability \[6, TS38.214\] assuming $d_{2,1} = 1$ and $\mu$
corresponds to the smallest SCS configuration between the SCS
configuration of the PDCCH carrying the DCI format and the SCS
configuration of the SRS, PUCCH, PUSCH or $\mu_{r}$, where $\mu_{r}$
corresponds to the SCS configuration of the PRACH if it is 15kHz or
higher; otherwise $\mu_{r} = 0.$

A UE assumes that flexible symbols in a CORESET configured to the UE for
PDCCH monitoring are downlink symbols if the UE does not detect an
SFI-index field value in DCI format 2\_0 indicating the set of symbols
of the slot as flexible or uplink and the UE does not detect a DCI
format 0\_0, DCI format 0\_1, DCI format 1\_0, DCI format 1\_1, or DCI
format 2\_3 indicating to the UE to transmit SRS, PUSCH, PUCCH, or PRACH
in the set of symbols.

For a set of symbols of a slot that are indicated as flexible by
*tdd-UL-DL-ConfigurationCommon*, and *tdd-UL-DL-ConfigurationDedicated*
if provided, or when *tdd-UL-DL-ConfigurationCommon*, and
*tdd-UL-DL-ConfigurationDedicated* are not provided to the UE, and if
the UE does not detect a DCI format 2\_0 providing a slot format for the
slot

\- the UE receives PDSCH or CSI-RS in the set of symbols of the slot if
the UE receives a corresponding indication by a DCI format 1\_0, DCI
format 1\_1, or DCI format 0\_1

\- the UE transmits PUSCH, PUCCH, PRACH, or SRS in the set of symbols of
the slot if the UE receives a corresponding indication by a DCI format
0\_0, DCI format 0\_1, DCI format 1\_0, DCI format 1\_1, DCI format
2\_3, or a RAR UL grant

\- the UE receives PDCCH as described in Clause 10.1

\- if the UE is configured by higher layers to receive PDSCH or CSI-RS
in the set of symbols of the slot, the UE does not receive the PDSCH or
the CSI-RS in the set of symbols of the slot

\- if the UE is configured by higher layers to transmit SRS, or PUCCH,
or PUSCH, or PRACH in the set of symbols of the slot, the UE

\- does not expect to cancel the transmission of the PUCCH, or the
PUSCH, or the PRACH in the slot if the first symbol of the PUCCH or the
PUSCH or the PRACH in the slot occurs within relative to a last symbol
of a CORESET where the UE is configured to monitor PDCCH for DCI format
2\_0. Otherwise, the UE cancels the PUCCH, or the PUSCH, or the PRACH
transmission in the slot.

\- does not expect to cancel the transmission of SRS in symbols from the
set of symbols that occur within $T_{proc,2}$ relative to a last symbol
of a CORESET where the UE is configured to monitor PDCCH for DCI format
2\_0. The UE cancels the SRS transmission in remaining symbols from the
set of symbols.

\- is the PUSCH preparation time for the corresponding UE processing
capability \[6, TS 38.214\] assuming and corresponds to the smallest SCS
configuration between the SCS configuration of the PDCCH carrying the
DCI format 2\_0 and the SCS configuration of the SRS, PUCCH, PUSCH or
*μ~r~*, where *μ~r~* corresponds to the SCS configuration of the PRACH
if it is 15kHz or higher; otherwise *μ~r~*=0.

For unpaired spectrum operation for a UE on a cell in a frequency band
of FR1, and when the scheduling restrictions due to RRM measurements
\[10, TS 38.133\] are not applicable, if the UE detects a DCI format
0\_0, DCI format 0\_1, DCI format 1\_0, DCI format 1\_1, or DCI format
2\_3 indicating to the UE to transmit in a set of symbols, the UE is not
required to perform RRM measurements \[10, TS 38.133\] based on a
SS/PBCH block or CSI-RS reception on a different cell in the frequency
band if the SS/PBCH block or CSI-RS reception includes at least one
symbol from the set of symbols.

11.2 Interrupted transmission indication 
----------------------------------------

If a UE is provided *DownlinkPreemption*, the UE is configured with an
INT-RNTI provided by *int-RNTI* for monitoring PDCCH conveying DCI
format 2\_1 \[5, TS 38.212\]. The UE is additionally configured with

\- a set of serving cells by *int-ConfigurationPerServingCell* that
includes a set of serving cell indexes provided by corresponding
*servingCellId* and a corresponding set of locations for fields in DCI
format 2\_1 by *positionInDCI*

\- an information payload size for DCI format 2\_1 by *dci-PayloadSize*

\- an indication granularity for time-frequency resources by
*timeFrequencySet*

If a UE detects a DCI format 2\_1 for a serving cell from the configured
set of serving cells, the UE may assume that no transmission to the UE
is present in PRBs and in symbols that are indicated by the DCI format
2\_1, from a set of PRBs and a set of symbols of the last monitoring
period. The indication by the DCI format 2\_1 is not applicable to
receptions of SS/PBCH blocks.

The set of PRBs is equal to the active DL BWP as defined in Clause 12
and includes PRBs.

If a UE detects a DCI format 2\_1 in a PDCCH transmitted in a CORESET in
a slot, the set of symbols is the last symbols prior to the first symbol
of the CORESET in the slot where is the PDCCH monitoring periodicity
provided by the value of *monitoringSlotPeriodicityAndOffset,* as
described in Clause 10.1, is the number of symbols per slot, is the SCS
configuration for a serving cell with mapping to a respective field in
the DCI format 2\_1, is the SCS configuration of the DL BWP where the UE
receives the PDCCH with the DCI format 2\_1. If the UE is provided
*tdd-UL-DL-ConfigurationCommon*, symbols indicated as uplink by
*tdd-UL-DL-ConfigurationCommon* are excluded from the last symbols prior
to the first symbol of the CORESET in the slot. The resulting set of
symbols includes a number of symbols that is denoted as .

The UE does not expect to be provided values of , , and resulting to a
value of that is not an integer. The UE does not expect to be configured
by *monitoringSymbolsWithinSlot* with more than one PDCCH monitoring
occasion for DCI format 2\_1 in a slot.

A UE is provided the indication granularity for the set of PRBs and for
the set of symbols by *timeFrequencySet*.

If the value of *timeFrequencySet* is \'set0\', 14 bits from MSB of a
field in DCI format 2\_1 have a one-to-one mapping with 14 groups of
consecutive symbols from the set of symbols where each of the first
symbol groups includes symbols, each of the last symbol groups includes
symbols, a bit value of 0 indicates transmission to the UE in the
corresponding symbol group and a bit value of 1 indicates no
transmission to the UE in the corresponding symbol group.

If the value of *timeFrequencySet* is \'set1\', 7 pairs of bits from MSB
of a field in the DCI format 2\_1 have a one-to-one mapping with 7
groups of consecutive symbols where each of the first symbol groups
includes symbols, each of the last symbol groups includes symbols, a
first bit in a pair of bits for a symbol group is applicable to the
subset of first PRBs from the set of PRBs, a second bit in the pair of
bits for the symbol group is applicable to the subset of last PRBs from
the set of PRBs, a bit value of 0 indicates transmission to the UE in
the corresponding symbol group and subset of PRBs, and a bit value of 1
indicates no transmission to the UE in the corresponding symbol group
and subset of PRBs.

11.3 Group TPC commands for PUCCH/PUSCH
---------------------------------------

For PUCCH transmission on a serving cell, a UE can be provided

\- a TPC-PUCCH-RNTI for a DCI format 2\_2 by *tpc-PUCCH-RNTI*

\- a field in DCI format 2\_2 is a TPC command of 2 bits mapping to
values as described in Clause 7.2.1

\- an index for a location in DCI format 2\_2 of a first bit for a TPC
command field for the PCell, or for a carrier of the PCell by
*tpc-IndexPCell*

\- an index for a location in DCI format 2\_2 of a first bit for a TPC
command field for the PUCCH-SCell or for a carrier for the PUCCH-SCell
by *tpc-IndexPUCCH-Scell*

\- a mapping for the PUCCH power control adjustment state , by a
corresponding {0, 1} value of a closed loop index field that is appended
to the TPC command field in DCI format 2\_2 if the UE indicates a
capability to support two PUCCH power control adjustment states by
*twoDifferentTPC-Loop-PUCCH*, and if the UE is configured for two PUCCH
power control adjustment states by *twoPUCCH-PC-AdjustmentStates*

The UE is also provided on a serving cell with a configuration for a
search space set and a corresponding CORESET for monitoring PDCCH
candidates for DCI format 2\_2 with CRC scrambled by a TPC-PUCCH-RNTI as
described in Clause 10.1.

For PUSCH transmission on a serving cell, a UE can be provided

\- a TPC-PUSCH-RNTI for a DCI format 2\_2 by *tpc-PUSCH-RNTI*

\- a field in DCI format 2\_2 is a TPC command of 2 bits mapping to
values as described in Clause 7.1.1

\- an index for a location in DCI format 2\_2 of a first bit for a TPC
command field for an uplink carrier of the serving cell by *tpc-Index*

\- an index for a location in DCI format 2\_2 of a first bit for a TPC
command field for a supplementary uplink carrier of the serving cell by
*tpc-IndexSUL*

\- an index of the serving cell by *targetCell*. If *targetCell* is not
provided, the serving cell is the cell of the PDCCH reception for DCI
format 2\_2

\- a mapping for the PUSCH power control adjustment state , by a
corresponding {0, 1} value of a closed loop index field that is appended
to the TPC command field for the uplink carrier or for the supplementary
uplink carrier of the serving cell in DCI format 2\_2 if the UE
indicates a capability to support two PUSCH power control adjustment
states, by *twoDifferentTPC-Loop-PUSCH*, and if the UE is configured for
two PUSCH power control adjustment states by
*twoPUSCH-PC-AdjustmentStates*

The UE is also provided for the serving cell of the PDCCH reception for
DCI format 2\_2 with a configuration for a search space set and a
corresponding CORESET for monitoring PDCCH candidates for DCI format
2\_2 with CRC scrambled by a TPC-PUSCH-RNTI as described in Clause 10.1.

11.4 SRS switching
------------------

DCI format 2\_3 is applicable for uplink carrier(s) of serving cells
where a UE is not configured for PUSCH/PUCCH transmission or for uplink
carrier(s) of a serving cell where *srs-PowerControlAdjustmentStates*
indicates a separate power control adjustment state between SRS
transmissions and PUSCH transmissions.

A UE configured by higher layers with parameter *carrierSwitching* is
provided

\- a TPC-SRS-RNTI for a DCI format 2\_3 by *tpc-SRS-RNTI*

\- an index of a serving cell where the UE interrupts transmission in
order to transmit SRS on one or more other serving cells by
*srs-SwitchFromServCellIndex*

\- an indication of an uplink carrier where the UE interrupts
transmission in order to transmit SRS on one or more other serving cells
by *srs-SwitchFromCarrier*

\- a DCI format 2\_3 field configuration type by *typeA* or *typeB*

\- for *typeA*, an index for a set of serving cells is provided by
*cc-SetIndex*, indexes of serving cells in the set of serving cells are
provided by *cc-IndexInOneCC-Set*, and a DCI format 2\_3 field includes
a TPC command for each serving cell from the set of serving cells and
can also include a SRS request for SRS transmission on the set of
serving cells

\- for *typeB*, DCI format 2\_3 field includes a TPC command for a
serving cell index and can also include a SRS request for SRS
transmission on the serving cell

\- an indication for a serving cell for whether or not a field in DCI
format 2\_3 includes a SRS request by *fieldTypeFormat2-3* where a value
of 0/1 indicates absence/presence of the SRS request -- a mapping for a
2 bit SRS request to SRS resource sets is as provided in \[6, TS
38.214\]

\- an index for a location in DCI format 2\_3 of a first bit for a field
for a non-supplementary uplink carrier of the serving cell by
*startingBitOfFormat2-3*

\- an index for a location in DCI format 2\_3 of a first bit for a field
for a supplementary uplink carrier of the serving cell by
*startingBitOfFormat2-3SUL-v1530*

12 Bandwidth part operation 
===========================

If the UE is configured with a SCG, the UE shall apply the procedures
described in this clause for both MCG and SCG

\- When the procedures are applied for MCG, the terms \'secondary
cell\', \'secondary cells\' , \'serving cell\', \'serving cells\' in
this clause refer to secondary cell, secondary cells, serving cell,
serving cells belonging to the MCG respectively.

\- When the procedures are applied for SCG, the terms \'secondary
cell\', \'secondary cells\', \'serving cell\', \'serving cells\' in this
clause refer to secondary cell, secondary cells (not including PSCell),
serving cell, serving cells belonging to the SCG respectively. The term
\'primary cell\' in this clause refers to the PSCell of the SCG.

A UE configured for operation in bandwidth parts (BWPs) of a serving
cell, is configured by higher layers for the serving cell a set of at
most four bandwidth parts (BWPs) for receptions by the UE (DL BWP set)
in a DL bandwidth by parameter *BWP-Downlink* or by parameter
*initialDownlinkBWP* with a set of parameters configured by
*BWP-DownlinkCommon* and *BWP-DownlinkDedicated*, and a set of at most
four BWPs for transmissions by the UE (UL BWP set) in an UL bandwidth by
parameter *BWP-Uplink* or by parameter *initialUplinkBWP* with a set of
parameters configured by *BWP-UplinkCommon* and *BWP-UplinkDedicated*.

If a UE is not provided *initialDownlinkBWP*, an initial DL BWP is
defined by a location and number of contiguous PRBs, starting from a PRB
with the lowest index and ending at a PRB with the highest index among
PRBs of a CORESET for Type0-PDCCH CSS set, and a SCS and a cyclic prefix
for PDCCH reception in the CORESET for Type0-PDCCH CSS set; otherwise,
the initial DL BWP is provided by *initialDownlinkBWP*. For operation on
the primary cell or on a secondary cell, a UE is provided an initial UL
BWP by *initialUplinkBWP*. If the UE is configured with a supplementary
UL carrier, the UE can be provided an initial UL BWP on the
supplementary UL carrier by *initialUplinkBWP*.

If a UE has dedicated BWP configuration, the UE can be provided by
*firstActiveDownlinkBWP-Id* a first active DL BWP for receptions and by
*firstActiveUplinkBWP-Id* a first active UL BWP for transmissions on a
carrier of the primary cell.

For each DL BWP or UL BWP in a set of DL BWPs or UL BWPs, respectively,
the UE is provided the following parameters for the serving cell as
defined in \[4, TS 38.211\] or \[6, TS 38.214\]:

\- a SCS by *subcarrierSpacing*

\- a cyclic prefix by *cyclicPrefix*

\- a common RB and a number of contiguous RBs provided by
*locationAndBandwidth* that indicates an offset and a length as RIV
according to \[6, TS 38.214\], setting , and a value provided by
*offsetToCarrier* for the *subcarrierSpacing*

\- an index in the set of DL BWPs or UL BWPs by respective *BWP-Id*

\- a set of BWP-common and a set of BWP-dedicated parameters by
*BWP-DownlinkCommon* and *BWP-DownlinkDedicated* for the DL BWP, or
*BWP-UplinkCommon* and *BWP-UplinkDedicated* for the UL BWP \[12, TS
38.331\]

For unpaired spectrum operation, a DL BWP from the set of configured DL
BWPs with index provided by *BWP-Id* is linked with an UL BWP from the
set of configured UL BWPs with index provided by *BWP-Id* when the DL
BWP index and the UL BWP index are same. For unpaired spectrum
operation, a UE does not expect to receive a configuration where the
center frequency for a DL BWP is different than the center frequency for
an UL BWP when the *BWP-Id* of the DL BWP is same as the *BWP-Id* of the
UL BWP.

For each DL BWP in a set of DL BWPs of the PCell, a UE can be configured
CORESETs for every type of CSS sets and for USS as described in Clause
10.1. The UE does not expect to be configured without a CSS set on the
PCell in the active DL BWP.

If a UE is provided *controlResourceSetZero* and *searchSpaceZero* in
*PDCCH-ConfigSIB1 or PDCCH-ConfigCommon, the UE determines a CORESET for
a* search space set from *controlResourcesetZero* as described in Clause
13 and for Tables 13-1 through 13-10, and determines corresponding PDCCH
monitoring occasions as described in Clause 13 and for Tables 13-11
through 13-15. If the active DL BWP is not the initial DL BWP, t*he UE*
determines PDCCH monitoring occasions *for the* search space set only if
the CORESET bandwidth *is within the active DL BWP and the active DL BWP
has same SCS configuration and same cyclic prefix as the initial DL
BWP*.

For each UL BWP in a set of UL BWPs of the PCell or of the PUCCH-SCell,
the UE is configured resource sets for PUCCH transmissions as described
in Clause 9.2.1.

A UE receives PDCCH and PDSCH in a DL BWP according to a configured SCS
and CP length for the DL BWP. A UE transmits PUCCH and PUSCH in an UL
BWP according to a configured SCS and CP length for the UL BWP.

If a bandwidth part indicator field is configured in DCI format 1\_1,
the bandwidth part indicator field value indicates the active DL BWP,
from the configured DL BWP set, for DL receptions as described in \[5,
TS 38.212\]. If a bandwidth part indicator field is configured in DCI
format 0\_1, the bandwidth part indicator field value indicates the
active UL BWP, from the configured UL BWP set, for UL transmissions as
described in \[5, TS 38.212\]. If a bandwidth part indicator field is
configured in DCI format 0\_1 or DCI format 1\_1 and indicates an UL BWP
or a DL BWP different from the active UL BWP or DL BWP, respectively,
the UE shall

\- for each information field in the received DCI format 0\_1 or DCI
format 1\_1

\- if the size of the information field is smaller than the one required
for the DCI format 0\_1 or DCI format 1\_1 interpretation for the UL BWP
or DL BWP that is indicated by the bandwidth part indicator,
respectively, the UE prepends zeros to the information field until its
size is the one required for the interpretation of the information field
for the UL BWP or DL BWP prior to interpreting the DCI format 0\_1 or
DCI format 1\_1 information fields, respectively

\- if the size of the information field is larger than the one required
for the DCI format 0\_1 or DCI format 1\_1 interpretation for the UL BWP
or DL BWP that is indicated by the bandwidth part indicator,
respectively, the UE uses a number of least significant bits of DCI
format 0\_1 or DCI format 1\_1 equal to the one required for the UL BWP
or DL BWP indicated by bandwidth part indicator prior to interpreting
the DCI format 0\_1 or DCI format 1\_1 information fields, respectively

\- set the active UL BWP or DL BWP to the UL BWP or DL BWP indicated by
the bandwidth part indicator in the DCI format 0\_1 or DCI format 1\_1,
respectively

A UE does not expect to detect a DCI format 1\_1 or a DCI format 0\_1
indicating respectively an active DL BWP or an active UL BWP change with
the corresponding time domain resource assignment field providing a slot
offset value for a PDSCH reception or PUSCH transmission that is smaller
than a delay required by the UE for an active DL BWP change or UL BWP
change \[10, TS 38.133\].

If a UE detects a DCI format 1\_1 indicating an active DL BWP change for
a cell, the UE is not required to receive or transmit in the cell during
a time duration from the end of the third symbol of a slot where the UE
receives the PDCCH that includes the DCI format 1\_1 in a scheduling
cell until the beginning of a slot indicated by the slot offset value of
the time domain resource assignment field in the DCI format 1\_1.

If a UE detects a DCI format 0\_1 indicating an active UL BWP change for
a cell, the UE is not required to receive or transmit in the cell during
a time duration from the end of the third symbol of a slot where the UE
receives the PDCCH that includes the DCI format 0\_1 in the scheduling
cell until the beginning of a slot indicated by the slot offset value of
the time domain resource assignment field in the DCI format 0\_1.

A UE does not expect to detect a DCI format 1\_1 indicating an active DL
BWP change or a DCI format 0\_1 indicating an active UL BWP change for a
scheduled cell within FR1 (or FR2) in a slot other than the first slot
of a set of slots for the DL SCS of the scheduling cell that overlaps
with a time duration where the UE is not required to receive or transmit
for an active BWP change in a different cell from the scheduled cell
within FR1 (or FR2).

A UE expects to detect a DCI format 0\_1 indicating active UL BWP
change, or a DCI format 1\_1 indicating active DL BWP change, only if a
corresponding PDCCH is received within the first 3 symbols of a slot.

For a serving cell, a UE can be provided by *defaultDownlinkBWP-Id* a
default DL BWP among the configured DL BWPs. If a UE is not provided a
default DL BWP by *defaultDownlinkBWP-Id*, the default DL BWP is the
initial DL BWP.

If a UE is provided by *bwp-InactivityTimer* a timer value for the
serving cell \[11, TS 38.321\] and the timer is running, the UE
decrements the timer at the end of a subframe for FR1 or at the end of a
half subframe for FR2 if the restarting conditions in \[11, TS 38.321\]
are not met during the interval of the subframe for FR1 or of the half
subframe for FR2.

For a cell where a UE changes an active DL BWP due to a BWP inactivity
timer expiration and for accommodating a delay in the active DL BWP
change or the active UL BWP change required by the UE \[10, TS 38.133\],
the UE is not required to receive or transmit in the cell during a time
duration from the beginning of a subframe for FR1, or of half of a
subframe for FR2, that is immediately after the BWP inactivity timer
expires until the beginning of a slot where the UE can receive or
transmit.

When a UE\'s BWP inactivity timer for a cell within FR1 (or FR2) expires
within a time duration where the UE is not required to receive or
transmit for an active UL/DL BWP change in the cell or in a different
cell within FR1 (or FR2), the UE delays the active UL/DL BWP change
triggered by the BWP inactivity timer expiration until a subframe for
FR1 or half a subframe for FR2 that is immediately after the UE
completes the active UL/DL BWP change in the cell or in the different
cell within FR1 (or FR2).

If a UE is provided by *firstActiveDownlinkBWP-Id* a first active DL BWP
and by *firstActiveUplinkBWP-Id* a first active UL BWP on a carrier of a
secondary cell, the UE uses the indicated DL BWP and the indicated UL
BWP as the respective first active DL BWP on the secondary cell and
first active UL BWP on the carrier of the secondary cell.

A UE does not expect to monitor PDCCH when the UE performs RRM
measurements \[10, TS 38.133\] over a bandwidth that is not within the
active DL BWP for the UE.

13 UE procedure for monitoring Type0-PDCCH CSS sets
===================================================

If during cell search a UE determines from *MIB* that a CORESET for
Type0-PDCCH CSS set is present, as described in Clause 4.1, the UE
determines a number of consecutive resource blocks and a number of
consecutive symbols for the CORESET of the Type0-PDCCH CSS set from
*controlResourceSetZero in* *pdcch-ConfigSIB1*, as described in Tables
13-1 through 13-10, and determines PDCCH monitoring occasions from
*searchSpaceZero in pdcch-ConfigSIB1*, included in *MIB*, as described
in Tables 13-11 through 13-15. and are the SFN and slot index within a
frame of the CORESET based on SCS of the CORESET and and are the SFN and
slot index based on SCS of the CORESET, respectively, where the SS/PBCH
block with index overlaps in time with system frame and slot . The
symbols of the CORESET associated with *pdcch-ConfigSIB1* in *MIB* or
with *searchSpaceSIB1 in PDCCH-ConfigCommon have normal cyclic prefix.*

The offset in Tables 13-1 through 13-10 is defined with respect to the
SCS of the CORESET for Type0-PDCCH CSS set, provided by
*subCarrierSpacingCommon,* from the smallest RB index of the CORESET for
Type0-PDCCH CSS set to the smallest RB index of the common RB
overlapping with the first RB of the corresponding SS/PBCH block. In
Tables 13-7, 13-8, and 13-10 is defined in \[4, TS 38.211\].

For the SS/PBCH block and CORESET multiplexing pattern 1, a UE monitors
PDCCH in the Type0-PDCCH CSS set over two consecutive slots starting
from slot . For SS/PBCH block with index , the UE determines an index of
slot as located in a frame with system frame number (SFN) satisfying if
or in a frame with SFN satisfying if . and are provided by Tables 13-11
and 13-12, and based on the SCS for PDCCH receptions in the CORESET \[4,
TS 38.211\]. The index for the first symbol of the CORESET in slots and
is the first symbol index provided by Tables 13-11 and 13-12.

For the SS/PBCH block and CORESET multiplexing patterns 2 and 3, a UE
monitors PDCCH in the Type0-PDCCH CSS set over one slot with Type0-PDCCH
CSS set periodicity equal to the periodicity of SS/PBCH block. For the
SS/PBCH block and CORESET multiplexing patterns 2 and 3, if the active
DL BWP is the initial DL BWP, the UE is expected to be able to perform
radio link monitoring, as described in Clause 5, and measurements for
radio resource management \[10, TS 38.133\] using a SS/PBCH block that
provides a CORESET for Type0-PDCCH CSS set. For a SS/PBCH block with
index , the UE determines the slot index and based on parameters
provided by Tables 13-13 through 13-15.

Table 13-1: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {15, 15}
kHz for frequency bands with minimum channel bandwidth 5 MHz or 10 MHz

  **Index**   SS/PBCH block and CORESET multiplexing pattern   Number of RBs   Number of Symbols   Offset (RBs)
  ----------- ------------------------------------------------ --------------- ------------------- --------------
  0           1                                                24              2                   0
  1           1                                                24              2                   2
  2           1                                                24              2                   4
  3           1                                                24              3                   0
  4           1                                                24              3                   2
  5           1                                                24              3                   4
  6           1                                                48              1                   12
  7           1                                                48              1                   16
  8           1                                                48              2                   12
  9           1                                                48              2                   16
  10          1                                                48              3                   12
  11          1                                                48              3                   16
  12          1                                                96              1                   38
  13          1                                                96              2                   38
  14          1                                                96              3                   38
  15          Reserved                                                                             

Table 13-2: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {15, 30}
kHz for frequency bands with minimum channel bandwidth 5 MHz or 10 MHz

  **Index**   SS/PBCH block and CORESET multiplexing pattern   Number of RBs   Number of Symbols   Offset (RBs)
  ----------- ------------------------------------------------ --------------- ------------------- --------------
  0           1                                                24              2                   5
  1           1                                                24              2                   6
  2           1                                                24              2                   7
  3           1                                                24              2                   8
  4           1                                                24              3                   5
  5           1                                                24              3                   6
  6           1                                                24              3                   7
  7           1                                                24              3                   8
  8           1                                                48              1                   18
  9           1                                                48              1                   20
  10          1                                                48              2                   18
  11          1                                                48              2                   20
  12          1                                                48              3                   18
  13          1                                                48              3                   20
  14          Reserved                                                                             
  15          Reserved                                                                             

Table 13-3: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {30, 15}
kHz for frequency bands with minimum channel bandwidth 5 MHz or 10 MHz

  **Index**   SS/PBCH block and CORESET multiplexing pattern   Number of RBs   Number of Symbols   Offset (RBs)
  ----------- ------------------------------------------------ --------------- ------------------- --------------
  0           1                                                48              1                   2
  1           1                                                48              1                   6
  2           1                                                48              2                   2
  3           1                                                48              2                   6
  4           1                                                48              3                   2
  5           1                                                48              3                   6
  6           1                                                96              1                   28
  7           1                                                96              2                   28
  8           1                                                96              3                   28
  9           Reserved                                                                             
  10          Reserved                                                                             
  11          Reserved                                                                             
  12          Reserved                                                                             
  13          Reserved                                                                             
  14          Reserved                                                                             
  15          Reserved                                                                             

Table 13-4: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {30, 30}
kHz for frequency bands with minimum channel bandwidth 5 MHz or 10 MHz

  **Index**   SS/PBCH block and CORESET multiplexing pattern   Number of RBs   Number of Symbols   Offset (RBs)
  ----------- ------------------------------------------------ --------------- ------------------- --------------
  0           1                                                24              2                   0
  1           1                                                24              2                   1
  2           1                                                24              2                   2
  3           1                                                24              2                   3
  4           1                                                24              2                   4
  5           1                                                24              3                   0
  6           1                                                24              3                   1
  7           1                                                24              3                   2
  8           1                                                24              3                   3
  9           1                                                24              3                   4
  10          1                                                48              1                   12
  11          1                                                48              1                   14
  12          1                                                48              1                   16
  13          1                                                48              2                   12
  14          1                                                48              2                   14
  15          1                                                48              2                   16

Table 13-5: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {30, 15}
kHz for frequency bands with minimum channel bandwidth 40MHz

  **Index**   SS/PBCH block and CORESET multiplexing pattern   Number of RBs   Number of Symbols   Offset (RBs)
  ----------- ------------------------------------------------ --------------- ------------------- --------------
  0           1                                                48              1                   4
  1           1                                                48              2                   4
  2           1                                                48              3                   4
  3           1                                                96              1                   0
  4           1                                                96              1                   56
  5           1                                                96              2                   0
  6           1                                                96              2                   56
  7           1                                                96              3                   0
  8           1                                                96              3                   56
  9           Reserved                                                                             
  10          Reserved                                                                             
  11          Reserved                                                                             
  12          Reserved                                                                             
  13          Reserved                                                                             
  14          Reserved                                                                             
  15          Reserved                                                                             

Table 13-6: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {30, 30}
kHz for frequency bands with minimum channel bandwidth 40MHz

  **Index**   SS/PBCH block and CORESET multiplexing pattern   Number of RBs   Number of Symbols   Offset (RBs)
  ----------- ------------------------------------------------ --------------- ------------------- --------------
  0           1                                                24              2                   0
  1           1                                                24              2                   4
  2           1                                                24              3                   0
  3           1                                                24              3                   4
  4           1                                                48              1                   0
  5           1                                                48              1                   28
  6           1                                                48              2                   0
  7           1                                                48              2                   28
  8           1                                                48              3                   0
  9           1                                                48              3                   28
  10          Reserved                                                                             
  11          Reserved                                                                             
  12          Reserved                                                                             
  13          Reserved                                                                             
  14          Reserved                                                                             
  15          Reserved                                                                             

Table 13-7: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {120,
60} kHz

+-----------+-------------+-------------+-------------+-------------+
| **Index** | SS/PBCH     | Number of   | Number of   | Offset      |
|           | block and   | RBs         | Symbols     | (RBs)       |
|           | CORESET     |             |             |             |
|           | m           |             |             |             |
|           | ultiplexing |             |             |             |
|           | pattern     |             |             |             |
+===========+=============+=============+=============+=============+
| 0         | 1           | 48          | 1           | 0           |
+-----------+-------------+-------------+-------------+-------------+
| 1         | 1           | 48          | 1           | 8           |
+-----------+-------------+-------------+-------------+-------------+
| 2         | 1           | 48          | 2           | 0           |
+-----------+-------------+-------------+-------------+-------------+
| 3         | 1           | 48          | 2           | 8           |
+-----------+-------------+-------------+-------------+-------------+
| 4         | 1           | 48          | 3           | 0           |
+-----------+-------------+-------------+-------------+-------------+
| 5         | 1           | 48          | 3           | 8           |
+-----------+-------------+-------------+-------------+-------------+
| 6         | 1           | 96          | 1           | 28          |
+-----------+-------------+-------------+-------------+-------------+
| 7         | 1           | 96          | 2           | 28          |
+-----------+-------------+-------------+-------------+-------------+
| 8         | 2           | 48          | 1           | -41 if      |
|           |             |             |             |             |
|           |             |             |             | -42 if      |
+-----------+-------------+-------------+-------------+-------------+
| 9         | 2           | 48          | 1           | 49          |
+-----------+-------------+-------------+-------------+-------------+
| 10        | 2           | 96          | 1           | -41 if      |
|           |             |             |             |             |
|           |             |             |             | -42 if      |
+-----------+-------------+-------------+-------------+-------------+
| 11        | 2           | 96          | 1           | 97          |
+-----------+-------------+-------------+-------------+-------------+
| 12        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 13        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 14        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 15        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+

Table 13-8: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {120,
120} kHz

+-----------+-------------+-------------+-------------+-------------+
| **Index** | SS/PBCH     | Number of   | Number of   | Offset      |
|           | block and   | RBs         | Symbols     | (RBs)       |
|           | CORESET     |             |             |             |
|           | m           |             |             |             |
|           | ultiplexing |             |             |             |
|           | pattern     |             |             |             |
+===========+=============+=============+=============+=============+
| 0         | 1           | 24          | 2           | 0           |
+-----------+-------------+-------------+-------------+-------------+
| 1         | 1           | 24          | 2           | 4           |
+-----------+-------------+-------------+-------------+-------------+
| 2         | 1           | 48          | 1           | 14          |
+-----------+-------------+-------------+-------------+-------------+
| 3         | 1           | 48          | 2           | 14          |
+-----------+-------------+-------------+-------------+-------------+
| 4         | 3           | 24          | 2           | -20 if      |
|           |             |             |             |             |
|           |             |             |             | -21 if      |
+-----------+-------------+-------------+-------------+-------------+
| 5         | 3           | 24          | 2           | 24          |
+-----------+-------------+-------------+-------------+-------------+
| 6         | 3           | 48          | 2           | -20 if      |
|           |             |             |             |             |
|           |             |             |             | -21 if      |
+-----------+-------------+-------------+-------------+-------------+
| 7         | 3           | 48          | 2           | 48          |
+-----------+-------------+-------------+-------------+-------------+
| 8         | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 9         | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 10        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 11        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 12        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 13        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 14        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 15        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+

Table 13-9: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {240,
60} kHz

  **Index**   SS/PBCH block and CORESET multiplexing pattern   Number of RBs   Number of Symbols   Offset (RBs)
  ----------- ------------------------------------------------ --------------- ------------------- --------------
  0           1                                                96              1                   0
  1           1                                                96              1                   16
  2           1                                                96              2                   0
  3           1                                                96              2                   16
  4           Reserved                                                                             
  5           Reserved                                                                             
  6           Reserved                                                                             
  7           Reserved                                                                             
  8           Reserved                                                                             
  9           Reserved                                                                             
  10          Reserved                                                                             
  11          Reserved                                                                             
  12          Reserved                                                                             
  13          Reserved                                                                             
  14          Reserved                                                                             
  15          Reserved                                                                             

Table 13-10: Set of resource blocks and slot symbols of CORESET for
Type0-PDCCH search space set when {SS/PBCH block, PDCCH} SCS is {240,
120} kHz

+-----------+-------------+-------------+-------------+-------------+
| **Index** | SS/PBCH     | Number of   | Number of   | Offset      |
|           | block and   | RBs         | Symbols     | (RBs)       |
|           | CORESET     |             |             |             |
|           | m           |             |             |             |
|           | ultiplexing |             |             |             |
|           | pattern     |             |             |             |
+===========+=============+=============+=============+=============+
| 0         | 1           | 48          | 1           | 0           |
+-----------+-------------+-------------+-------------+-------------+
| 1         | 1           | 48          | 1           | 8           |
+-----------+-------------+-------------+-------------+-------------+
| 2         | 1           | 48          | 2           | 0           |
+-----------+-------------+-------------+-------------+-------------+
| 3         | 1           | 48          | 2           | 8           |
+-----------+-------------+-------------+-------------+-------------+
| 4         | 2           | 24          | 1           | -41 if      |
|           |             |             |             |             |
|           |             |             |             | -42 if      |
+-----------+-------------+-------------+-------------+-------------+
| 5         | 2           | 24          | 1           | 25          |
+-----------+-------------+-------------+-------------+-------------+
| 6         | 2           | 48          | 1           | -41 if      |
|           |             |             |             | ![](        |
|           |             |             |             | ./media/ima |
|           |             |             |             | ge1224.wmf) |
|           |             |             |             |             |
|           |             |             |             | -42 if      |
|           |             |             |             | ![](        |
|           |             |             |             | ./media/ima |
|           |             |             |             | ge1225.wmf) |
+-----------+-------------+-------------+-------------+-------------+
| 7         | 2           | 48          | 1           | 49          |
+-----------+-------------+-------------+-------------+-------------+
| 8         | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 9         | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 10        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 11        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 12        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 13        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 14        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+
| 15        | Reserved    |             |             |             |
+-----------+-------------+-------------+-------------+-------------+

Table 13-11: Parameters for PDCCH monitoring occasions for Type0-PDCCH
CSS set - SS/PBCH block and CORESET multiplexing pattern 1 and FR1

  **Index**       Number of search space sets per slot         **First symbol index**
  ----------- --- -------------------------------------- ----- --------------------------------
  0           0   1                                      1     0
  1           0   2                                      1/2   {0, if is even}, {, if is odd}
  2           2   1                                      1     0
  3           2   2                                      1/2   {0, if is even}, {, if is odd}
  4           5   1                                      1     0
  5           5   2                                      1/2   {0, if is even}, {, if is odd}
  6           7   1                                      1     0
  7           7   2                                      1/2   {0, if is even}, {, if is odd}
  8           0   1                                      2     0
  9           5   1                                      2     0
  10          0   1                                      1     1
  11          0   1                                      1     2
  12          2   1                                      1     1
  13          2   1                                      1     2
  14          5   1                                      1     1
  15          5   1                                      1     2

Table 13-12: Parameters for PDCCH monitoring occasions for Type0-PDCCH
CSS set - SS/PBCH block and CORESET multiplexing pattern 1 and FR2

  **Index**              Number of search space sets per slot         **First symbol index**
  ----------- ---------- -------------------------------------- ----- ----------------------------------------------------------------------------------------------------------------
  0           0          1                                      1     0
  1           0          2                                      1/2   {0, if is even}, {7, if is odd}
  2           2.5        1                                      1     0
  3           2.5        2                                      1/2   {0, if is even}, {7, if is odd}
  4           5          1                                      1     0
  5           5          2                                      1/2   {0, if is even}, {7, if is odd}
  6           0          2                                      1/2   {0, if is even}, {, if is odd}
  7           2.5        2                                      1/2   {0, if ![](./media/image1228.wmf) is even}, {![](./media/image1222.wmf), if ![](./media/image1229.wmf) is odd}
  8           5          2                                      1/2   {0, if ![](./media/image1228.wmf) is even}, {![](./media/image1222.wmf), if ![](./media/image1229.wmf) is odd}
  9           7.5        1                                      1     0
  10          7.5        2                                      1/2   {0, if ![](./media/image1228.wmf) is even}, {7, if ![](./media/image1229.wmf) is odd}
  11          7.5        2                                      1/2   {0, if ![](./media/image1228.wmf) is even}, {![](./media/image1222.wmf), if ![](./media/image1229.wmf) is odd}
  12          0          1                                      2     0
  13          5          1                                      2     0
  14          Reserved                                                
  15          Reserved                                                

Table 13-13: PDCCH monitoring occasions for Type0-PDCCH CSS set -
SS/PBCH block and CORESET multiplexing pattern 2 and {SS/PBCH block,
PDCCH} SCS {120, 60} kHz

+-----------+---------------------------+---------------------------+
| **Index** | PDCCH monitoring          | **First symbol index**    |
|           | occasions (SFN and slot   |                           |
|           | number)                   | **(*k* = 0, 1, ... 15)**  |
+===========+===========================+===========================+
| 0         | !                         | 0, 1, 6, 7 for            |
|           | [](./media/image1230.wmf) |                           |
|           |                           | ![                        |
|           | !                         | ](./media/image1232.wmf), |
|           | [](./media/image1231.wmf) | ![                        |
|           |                           | ](./media/image1233.wmf), |
|           |                           | ![                        |
|           |                           | ](./media/image1234.wmf), |
|           |                           | !                         |
|           |                           | [](./media/image1235.wmf) |
+-----------+---------------------------+---------------------------+
| 1         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 2         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 3         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 4         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 5         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 6         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 7         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 8         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 9         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 10        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 11        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 12        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 13        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 14        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 15        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+

Table 13-14: PDCCH monitoring occasions for Type0-PDCCH CSS set -
SS/PBCH block and CORESET multiplexing pattern 2 and {SS/PBCH block,
PDCCH} SCS {240, 120} kHz

+-----------+---------------------------+---------------------------+
| **Index** | PDCCH monitoring          | **First symbol index**    |
|           | occasions (SFN and slot   |                           |
|           | number)                   | **(*k* = 0, 1, ..., 7)**  |
+===========+===========================+===========================+
| 0         | !                         | 0, 1, 2, 3, 0, 1 in       |
|           | [](./media/image1236.wmf) | ![                        |
|           |                           | ](./media/image1239.wmf), |
|           | !                         | ![                        |
|           | [](./media/image1237.wmf) | ](./media/image1240.wmf), |
|           | or                        | ![                        |
|           | !                         | ](./media/image1241.wmf), |
|           | [](./media/image1238.wmf) | ![                        |
|           |                           | ](./media/image1242.wmf), |
|           |                           | ![                        |
|           |                           | ](./media/image1243.wmf), |
|           |                           | !                         |
|           |                           | [](./media/image1244.wmf) |
|           |                           | (![                       |
|           |                           | ](./media/image1245.wmf)) |
|           |                           |                           |
|           |                           | 12, 13 in                 |
|           |                           | ![                        |
|           |                           | ](./media/image1246.wmf), |
|           |                           | !                         |
|           |                           | [](./media/image1247.wmf) |
|           |                           | (![                       |
|           |                           | ](./media/image1248.wmf)) |
+-----------+---------------------------+---------------------------+
| 1         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 2         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 3         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 4         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 5         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 6         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 7         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 8         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 9         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 10        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 11        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 12        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 13        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 14        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 15        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+

Table 13-15: PDCCH monitoring occasions for Type0-PDCCH CSS set -
SS/PBCH block and CORESET multiplexing pattern 3 and {SS/PBCH block,
PDCCH} SCS {120, 120} kHz

+-----------+---------------------------+---------------------------+
| **Index** | PDCCH monitoring          | **First symbol index**    |
|           | occasions (SFN and slot   |                           |
|           | number)                   | **(*k* = 0, 1, ... 15)**  |
+===========+===========================+===========================+
| 0         | !                         | 4, 8, 2, 6 in             |
|           | [](./media/image1249.wmf) |                           |
|           |                           | ![                        |
|           | !                         | ](./media/image1232.wmf), |
|           | [](./media/image1250.wmf) | ![                        |
|           |                           | ](./media/image1233.wmf), |
|           |                           | ![                        |
|           |                           | ](./media/image1234.wmf), |
|           |                           | !                         |
|           |                           | [](./media/image1235.wmf) |
+-----------+---------------------------+---------------------------+
| 1         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 2         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 3         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 4         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 5         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 6         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 7         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 8         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 9         | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 10        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 11        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 12        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 13        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 14        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+
| 15        | Reserved                  |                           |
+-----------+---------------------------+---------------------------+

If a UE detects a first SS/PBCH block and determines that a CORESET for
Type0-PDCCH CSS set is not present, and for ![](./media/image1251.wmf)
for FR1 or for ![](./media/image1252.wmf) for FR2, the UE may determine
the nearest (in the corresponding frequency direction) global
synchronization channel number (GSCN) of a second SS/PBCH block having a
CORESET for an associated Type0-PDCCH CSS set as
![](./media/image1253.wmf). ![](./media/image1254.wmf) is the GSCN of
the first SS/PBCH block and ![](./media/image1255.wmf) is a GSCN offset
provided by Table 13-16 for FR1 and Table 13-17 for FR2. If the UE
detects the second SS/PBCH block and the second SS/PBCH block does not
provide a CORESET for Type0-PDCCH CSS set, as described in Clause 4.1,
the UE may ignore the information related to GSCN of SS/PBCH block
locations for performing cell search.

If a UE detects a SS/PBCH block and determines that a CORESET for
Type0-PDCCH CSS set is not present, and for ![](./media/image1256.wmf)
for FR1 or for ![](./media/image1257.wmf) for FR2, the UE determines
that there is no SS/PBCH block having an associated Type0-PDCCH CSS set
within a GSCN range ![](./media/image1258.wmf).
![](./media/image1259.wmf)and ![](./media/image1260.wmf) are
respectively determined by *controlResourceSetZero* and *searchSpaceZero
in pdcch-ConfigSIB1.* If the GSCN range is ![](./media/image1261.wmf),
the UE determines that there is no information for a second SS/PBCH
block with a CORESET for an associated Type0-PDCCH CSS set on the
detected SS/PBCH block*.*

If a UE does not detect any SS/PBCH block providing a CORESET for
Type0-PDCCH CSS set, as described in Clause 4.1, within a time period
determined by the UE, the UE may ignore the information related to GSCN
of SS/PBCH locations in performing cell search.

Table 13-16: Mapping between the combination of
![](./media/image1262.wmf) and *controlResourceSetZero* and
*searchSpaceZero in pdcch-ConfigSIB1* to ![](./media/image1263.wmf) for
FR1

  ![](./media/image1262.wmf)   *16×controlResourceSetZero +searchSpaceZero*   ![](./media/image1263.wmf)
  ---------------------------- ---------------------------------------------- -----------------------------------
  24                           0, 1, ..., 255                                 1, 2, ..., 256
  25                           0, 1, ..., 255                                 257, 258, ..., 512
  26                           0, 1, ..., 255                                 513, 514, ...., 768
  27                           0, 1, ..., 255                                 -1, -2, ..., -256
  28                           0, 1, ..., 255                                 -257, -258, ..., -512
  29                           0, 1, ..., 255                                 -513, -514, ...., -768
  30                           0, 1, ..., 255                                 Reserved, Reserved, ..., Reserved

Table 13-17: Mapping between the combination of
![](./media/image1262.wmf) and *controlResourceSetZero* and
*searchSpaceZero in pdcch-ConfigSIB1* to ![](./media/image1263.wmf) for
FR2

  ![](./media/image1262.wmf)   *16×controlResourceSetZero +searchSpaceZero*   ![](./media/image1263.wmf)
  ---------------------------- ---------------------------------------------- -----------------------------------
  12                           0, 1, ..., 255                                 1, 2, ..., 256
  13                           0, 1, ..., 255                                 -1, -2, ..., -256
  14                           0, 1, ..., 255                                 Reserved, Reserved, ..., Reserved

#########  Annex A: Change history

  ---------- ------------- -------------- -------- --------- --------- ------------------------------------------------------------------------------------------------------------------------------- -----------------
  **Date**   **TSG \#**    **TSG Doc.**   **CR**   **Rev**   **Cat**   **Subject/Comment**                                                                                                             **New version**
  2017-04    RAN1\#89      R1-1707925                                  Draft skeleton                                                                                                                  0.0.0
  2017-07    AH\_NR2       R1-1712015                                  Inclusion of agreements until RAN1-adhoc\#2                                                                                     0.0.1
  2017-08    RAN1\#90      R1-1714553                                  Inclusion of agreements on CA and first revisions                                                                               0.0.2
  2017-08    RAN1\#90      R1-1714565                                  Second revisions                                                                                                                0.0.3
  2017-08    RAN1\#90      R1-1714658                                  Endorsed by RAN1\#90                                                                                                            0.1.0
  2017-08    RAN1\#90      R1-1715323                                  Inclusion of agreements from RAN1\#90                                                                                           0.1.1
  2017-08    RAN1\#90      R1-1715330                                  Updated editor\'s version                                                                                                       0.1.2
  2017-09    RAN\#77       RP-171995                                   For information to plenary                                                                                                      1.0.0
  2017-09    RAN1\#90bis   R1-1716929                                  Inclusion of agreements until RAN1-adhoc\#3                                                                                     1.0.1
  2017-10    RAN1\#90bis   R1-1719107                                  Endorsed by RAN1\#90bis                                                                                                         1.1.0
  2017-11    RAN1\#90bis   R1-1719226                                  Inclusion of agreements from RAN1\#90bis                                                                                        1.1.1
  2017-11    RAN1\#90bis   R1-1719243                                  Updated editor\'s version                                                                                                       1.1.2
  2017-11    RAN1\#90bis   R1-1721050                                  Endorsed by RAN1\#90bis                                                                                                         1.2.0
  2017-12    RAN1\#91      R1-1721343                                  Inclusion of agreements from RAN1\#91                                                                                           1.3.0
  2017-12    RAN\#78       RP-172703                                   Endorsed version for approval by plenary                                                                                        2.0.0
  2017-12    RAN\#78                                                   Approved by plenary -- Rel-15 spec under change control                                                                         15.0.0
  2018-03    RAN\#79       RP-180200      0001     \-        F         CR capturing the NR ad-hoc 1801 and RAN1\#92 meeting agreements                                                                 15.1.0
  2018-06    RAN\#80       RP-181172      0002     1         F         CR to TS 38.213 capturing the RAN1\#92bis and RAN1\#93 meeting agreements and aligning higher layer parameters with TS 38.331   15.2.0
  2018-09    RAN\#81       RP-181789      0005     \-        F         CR to 38.213 capturing the RAN1\#94 meeting agreements                                                                          15.3.0
  2018-09    RAN\#81       RP-182071      0006     \-        C         Support maximum 8 SS/PBCH blocks for unpaired spectrum beyond 2.4GHz                                                            15.3.0
  2018-12    RAN\#82       RP-182523      0007     2         F         Combined CR of all essential corrections to 38.213 from RAN1\#94bis and RAN1\#95.                                               15.4.0
  2019-03    RAN\#83       RP-190449      0009     \-        F         Correction on search space sharing                                                                                              15.5.0
  2019-03    RAN\#83       RP-190449      0010     \-        F         CR on timing adjustment indicator                                                                                               15.5.0
  2019-03    RAN\#83       RP-190449      0011     \-        F         CR on SSB-RO association                                                                                                        15.5.0
  2019-03    RAN\#83       RP-190449      0012     \-        F         Removal of CSI request in RAR grant                                                                                             15.5.0
  2019-03    RAN\#83       RP-190449      0014     \-        F         Correction to dynamic HARQ codebook in NR                                                                                       15.5.0
  2019-03    RAN\#83       RP-190449      0015     1         F         Corrections to TS 38.213                                                                                                        15.5.0
  2019-03    RAN\#83       RP-190449      0016     \-        F         CR on simultaneous active BWP switching across carriers                                                                         15.5.0
  2019-03    RAN\#83       RP-190449      0017     \-        F         CR on using CORESET\#0 in dedicated DL BWP                                                                                      15.5.0
  2019-03    RAN\#83       RP-190449      0018     \-        F         PDCCH monitoring for overlapped CORESETs                                                                                        15.5.0
  2019-03    RAN\#83       RP-190449      0019     \-        F         Correction to last PUCCH resource set configuration                                                                             15.5.0
  2019-03    RAN\#83       RP-190449      0020     \-        F         Correction on physical downlink control channel                                                                                 15.5.0
  2019-03    RAN\#83       RP-190449      0021     \-        F         Correction to align RAN1 and RAN4 specifications for EN-DC power control                                                        15.5.0
  2019-03    RAN\#83       RP-190449      0022     \-        F         (Late Drop) CR on PRACH Power Ramping Counter Suspension                                                                        15.5.0
  2019-03    RAN\#83       RP-190449      0023     \-        F         QCL properties of Msg4 in CONNECTED Mode                                                                                        15.5.0
  2019-03    RAN\#83       RP-190449      0024     \-        F         CR on latency after gNB response for recovery                                                                                   15.5.0
  2019-03    RAN\#83       RP-190449      0025     \-        F         Clarifying DL reception and UL transmission related restrictions                                                                15.5.0
  2019-03    RAN\#83       RP-190449      0026     \-        F         CR on QCL assumption for receiving PDCCH for RAR                                                                                15.5.0
  2019-03    RAN\#83       RP-190449      0027     \-        F         CR on identifying transmission occasion after resetting a PC closed loop                                                        15.5.0
  2019-03    RAN\#83       RP-190449      0028     \-        F         CR on overlapping of CSI and PUSCH with slot aggregation                                                                        15.5.0
  2019-03    RAN\#83       RP-190449      0029     \-        F         Correction on PHR timing for configured grant                                                                                   15.5.0
  2019-03    RAN\#83       RP-190449      0030     \-        F         CR on QCL assumption for a CORESET other than 0                                                                                 15.5.0
  2019-03    RAN\#83       RP-190449      0031     \-        F         Correction on DCI format 2\_3 for SUL cell in TS 38.213                                                                         15.5.0
  2019-03    RAN\#83       RP-190449      0032     \-        F         Correction to support FR1 extension to 7.125 GHz                                                                                15.5.0
  2019-03    RAN\#83       RP-190449      0033     \-        F         CR on UE procedure for reporting multiple UCI types                                                                             15.5.0
  2019-03    RAN\#83       RP-190449      0034     \-        F         Correction to transmission timing adjustments in TS 38.213                                                                      15.5.0
  2019-06    RAN\#84       RP-191283      0035     \-        F         CR on missing case for DCI format 1\_1 with CS-RNTI                                                                             15.6.0
  2019-06    RAN\#84       RP-191283      0036     1         F         CR on the determination of the minimum number of PRBs for PUCCH transmission                                                    15.6.0
  2019-06    RAN\#84       RP-191283      0037     \-        F         CR on PHR determination and transmission                                                                                        15.6.0
  2019-06    RAN\#84       RP-191283      0038     4         F         Corrections to 38.213 including alignment of terminology across specifications                                                  15.6.0
  2019-06    RAN\#84       RP-191283      0039     1         F         Correction on PUSCH power scaling                                                                                               15.6.0
  2019-06    RAN\#84       RP-191283      0040     \-        F         Correction on PDCCH monitoring                                                                                                  15.6.0
  2019-06    RAN\#84       RP-191283      0041     \-        F         Correction on CRC assumption for multi-CSI resource selection and CSI report(s) selection                                       15.6.0
  2019-06    RAN\#84       RP-191283      0042     \-        F         Clarification of reference to PDSCH processing capability 1 in TS 38.213                                                        15.6.0
  2019-06    RAN\#84       RP-191283      0043     \-        F         Correction on the timeline condition of multiplexing two HARQ-ACK information in one slot                                       15.6.0
  2019-06    RAN\#84       RP-191283      0044     \-        F         CR on Type-1 HARQ-ACK codebook determination                                                                                    15.6.0
  2019-06    RAN\#84       RP-191283      0045     \-        F         Correction on PHR in EN-DC                                                                                                      15.6.0
  2019-06    RAN\#84       RP-191283      0046     \-        F         CR to 38.213 on deactivation timing for ScellDeactivationTimer                                                                  15.6.0
  2019-06    RAN\#84       RP-191283      0047     \-        F         CR on single transmission timing for synchronous intra-band EN-DC                                                               15.6.0
  2019-06    RAN\#84       RP-191283      0048     \-        F         CR on PDCCH Monitoring for NR-DC                                                                                                15.6.0
  2019-06    RAN\#84       RP-191283      0049     \-        F         CR on Timing for MAC CE Applicability                                                                                           15.6.0
  2019-09    RAN\#85       RP-191942      0051     \-        F         Correction on RA procedure triggered by higher layers                                                                           15.7.0
  2019-09    RAN\#85       RP-191942      0052     1         F         CR on UE procedure for reporting multiple UCI types                                                                             15.7.0
  2019-09    RAN\#85       RP-191942      0053     \-        F         CR to 38.213 fix to HARQ-ACK Type-1 codebook pseudo-code                                                                        15.7.0
  2019-09    RAN\#85       RP-191942      0054     \-        F         CR to 38.213 on clarification of the RNTI used for scrambling a PUSCH transmission scheduled by RAR UL grant                    15.7.0
  2019-09    RAN\#85       RP-191942      0055     2         F         Corrections to 38.213 including alignment of terminology across specifications in RAN1\#98                                      15.7.0
  2019-09    RAN\#85       RP-191942      0056     \-        F         Correction on intra-band EN-DC with single TAG                                                                                  15.7.0
  2019-09    RAN\#85       RP-191942      0057     \-        F         Correction on PHR in EN-DC/NE-DC/NR-CA                                                                                          15.7.0
  2019-09    RAN\#85       RP-191942      0058     \-        F         Correction on the time gap definition                                                                                           15.7.0
  2019-09    RAN\#85       RP-191942      0059     \-        F         Correction on slot configuration                                                                                                15.7.0
  2019-09    RAN\#85       RP-191942      0060     \-        F         CR to 38.213 on PUCCH configuration for NR-DC                                                                                   15.7.0
  2019-09    RAN\#85       RP-191942      0061     \-        F         Correction on PUCCH power control                                                                                               15.7.0
  2019-12    RAN\#86       RP-192626      0062     1         F         CR on beta\_offset values for UCI reporting in PUSCH                                                                            15.8.0
  2019-12    RAN\#86       RP-192626      0063     \-        F         Correction on RACH occasion                                                                                                     15.8.0
  2019-12    RAN\#86       RP-192626      0064     \-        F         Correction on HARQ-ACK transmission with BWP change                                                                             15.8.0
  2019-12    RAN\#86       RP-192626      0065     \-        F         CR on slot configuration regarding PUSCH scheduled by RAR                                                                       15.8.0
  2019-12    RAN\#86       RP-192626      0066     \-        F         Correction on power control for NE-DC                                                                                           15.8.0
  2019-12    RAN\#86       RP-192626      0067     \-        F         Correction on time gap definition for HARQ-ACK transmission                                                                     15.8.0
  2019-12    RAN\#86       RP-192626      0068     \-        F         Correction on time gap definition for random access procedure                                                                   15.8.0
  2019-12    RAN\#86       RP-192626      0069     3         F         Corrections to 38.213 including alignment of terminology across specifications in RAN1\#98bis and RAN1\#99                      15.8.0
  2020-03    RAN\#87-e     RP-200181      0096     \-        F         Corrections to 38.213 including alignment of terminology across specifications in RAN1\#100-e                                   15.9.0
  2020-06    RAN\#88-e     RP-200683      0101     \-        F         Correction on PDCCH Blind Detection for NR-DC                                                                                   15.10.0
  2020-06    RAN\#88-e     RP-201348      0116     1         F         Extending 8 SSB support to the newly introduced 30 kHz Case C SSB pattern on band n40                                           15.10.0
  2020-09    RAN\#89-e     RP-201803      0118     \-        F         Correction on the definition for timeline condition                                                                             15.11.0
  2020-09    RAN\#89-e     RP-201803      0122     \-        F         CR on determining P0 for a PUSCH retransmission corresponding to a RAR UL grant in TS 38.213                                    15.11.0
  2020-09    RAN\#89-e     RP-201803      0130     \-        F         Correction on supplementary uplink in 38.213                                                                                    15.11.0
  2020-09    RAN\#89-e     RP-202014      0140     1         F         Extending 8 SSB support to the TDD bands with newly introduced 30 kHz Case C SSB pattern                                        15.11.0
  2020-12    RAN\#90-e     RP-202379      0143     \-        F         CR on HARQ-ACK Determination for SPS Release                                                                                    15.12.0
  2020-12    RAN\#90-e     RP-202379      0157     \-        F         Correction on HARQ-ACK generation for DL transmission with single TB when multi-TB is configured                                15.12.0
  2020-12    RAN\#90-e     RP-202379      0164     \-        F         Correction on supplementary uplink in 38.213                                                                                    15.12.0
  2021-03    RAN\#91-e     RP-210047      0181     \-        F         Correction on the search space configuration of PUCCH-SCell                                                                     15.13.0
  2021-03    RAN\#91-e     RP-210047      0185     \-        F         Correction for cancellation due to PDSCH/CSI-RS/SFI                                                                             15.13.0
  2021-06    RAN\#92-e     RP-211233      0227     1         F         Rel-15 editorial corrections for TS 38.213                                                                                      15.14.0
  2022-06    RAN\#96       RP-221596      0310     \-        F         Timeline requirement for retransmitting MSG1                                                                                    15.15.0
  ---------- ------------- -------------- -------- --------- --------- ------------------------------------------------------------------------------------------------------------------------------- -----------------
