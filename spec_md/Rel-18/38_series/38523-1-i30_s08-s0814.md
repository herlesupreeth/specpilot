8 RRC
=====

8.1 NR RRC
----------

### *8.1.1* RRC connection management procedures

#### 8.1.1.1 Paging

##### 8.1.1.1.1 RRC / Paging for connection / Multiple paging records

##### 8.1.1.1.1.1 Test Purpose (TP) {#test-purpose-tp .H6}

##### (1) {#section .H6}

**with** { UE in NR RRC\_IDLE state }

**ensure that** {

**when** { UE receives a Paging message including only unmatched
identities }

**then** { UE does not establish any RRC connection }

}

##### (2) {#section-1 .H6}

**with** { UE in NR RRC\_IDLE state }

**ensure that** {

**when** { UE receives a Paging message including a matched identity
*ng-5G-S-TMSI* }

**then** { UE successfully establishes the RRC connection }

}

##### (3) {#section-2 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { UE receives a Paging message including only unmatched
identities }

**then** { UE does not resume RRC connection }

}

##### (4) {#section-3 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { UE receives a Paging message including a matched identity
*fullI-RNTI* }

**then** { UE successfully resumes the RRC connection }

}

##### 8.1.1.1.1.2 Conformance requirements {#conformance-requirements .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.2.3.

\[TS 38.331, clause 5.3.2.3\]

Upon receiving the *Paging* message, the UE shall:

1\> if in RRC\_IDLE, for each of the *PagingRecord*, if any, included in
the *Paging* message:

2\> if the *ue-Identity* included in the *PagingRecord* matches the UE
identity allocated by upper layers:

3\> forward the *ue-Identity* and *accessType* (if present) to the upper
layers;

1\> if in RRC\_INACTIVE, for each of the *PagingRecord*, if any,
included in the *Paging* message:

2\> if the *ue-Identity* included in the *PagingRecord* matches the
UE\'s stored *full*I-RNTI:

3\> if the UE is configured by upper layers with Access Identity 1:

4\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *mps-PriorityAccess*;

3\> else if the UE is configured by upper layers with Access Identity 2:

4\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *mcs-PriorityAccess*;

3\> else if the UE is configured by upper layers with one or more Access
Identities equal to 11-15:

4\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *highPriorityAccess*;

3\> else:

4\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *mt-Access*;

2\> else if the *ue-Identity* included in the *PagingRecord* matches the
UE identity allocated by upper layers:

3\> forward the *ue-Identity* to upper layers and *accessType* (if
present) to the upper layers;

3\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11
with release cause \'other\'.

##### 8.1.1.1.1.3 Test Description {#test-description .H6}

##### 8.1.1.1.1.3.1 Pre-test conditions {#pre-test-conditions .H6}

##### System Simulator: {#system-simulator .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell.

##### UE: {#ue .H6}

\- None.

##### Preamble: {#preamble .H6}

\- The UE is in 5GS state 1N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-1.

##### 8.1.1.1.1.3.2 Test procedure sequence {#test-procedure-sequence .H6}

Table 8.1.1.1.1.3.2-1: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | only        |             |             |         |    |
|       | unmatched   |             |             |         |    |
|       | identities  |             |             |         |    |
|       | (incorrect  |             |             |         |    |
|       | *ng-5       |             |             |         |    |
|       | G-S-TMSI*). |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | Check: Does | \--\>       | NR RRC:     | 1       | F  |
|       | the UE      |             | *RRCSe      |         |    |
|       | transmit an |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message     |             |             |         |    |
|       | within 10s? |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | two         |             |             |         |    |
|       | unmatched   |             |             |         |    |
|       | identities  |             |             |         |    |
|       | (incorrect  |             |             |         |    |
|       | *ng-        |             |             |         |    |
|       | 5G-S-TMSI*) |             |             |         |    |
|       | and a       |             |             |         |    |
|       | matched     |             |             |         |    |
|       | identity    |             |             |         |    |
|       | (correct    |             |             |         |    |
|       | *ng-5       |             |             |         |    |
|       | G-S-TMSI)*. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | Check: Does | \--\>       | NR RRC:     | 2       | P  |
|       | the UE      |             | *RRCSe      |         |    |
|       | transmit an |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSetup*  |         |    |
|       | an          |             |             |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmit an |             | *RRCSet     |         |    |
|       | *RRCSet     |             | upComplete* |         |    |
|       | upComplete* |             |             |         |    |
|       | message     |             | 5GMM:       |         |    |
|       | including   |             | SERVICE     |         |    |
|       | SERVICE     |             | REQUEST     |         |    |
|       | REQUEST to  |             |             |         |    |
|       | confirm the |             |             |         |    |
|       | successful  |             |             |         |    |
|       | completion  |             |             |         |    |
|       | of the      |             |             |         |    |
|       | connection  |             |             |         |    |
|       | est         |             |             |         |    |
|       | ablishment. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7-10  | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the NR |             |             |         |    |
|       | RRC         |             |             |         |    |
|       | \_CONNECTED |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| \-    | EXCEPTION:  | \-          | *-*         | \-      | \- |
|       | Steps       |             |             |         |    |
|       | 11a1-11a7   |             |             |         |    |
|       | describe    |             |             |         |    |
|       | behaviour   |             |             |         |    |
|       | that        |             |             |         |    |
|       | depends on  |             |             |         |    |
|       | UE          |             |             |         |    |
|       | con         |             |             |         |    |
|       | figuration; |             |             |         |    |
|       | the \"lower |             |             |         |    |
|       | case        |             |             |         |    |
|       | letter\"    |             |             |         |    |
|       | identifies  |             |             |         |    |
|       | a step      |             |             |         |    |
|       | sequence    |             |             |         |    |
|       | that takes  |             |             |         |    |
|       | place if    |             |             |         |    |
|       | in          |             |             |         |    |
|       | activeState |             |             |         |    |
|       | is          |             |             |         |    |
|       | configured  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11 a1 | IF          | \<\--       | NR RRC:     | \-      | \- |
|       | pc\_in      |             | *           |         |    |
|       | activeState |             | RRCRelease* |         |    |
|       | THEN the SS |             |             |         |    |
|       | transmits   |             |             |         |    |
|       | an          |             |             |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | s*usp       |             |             |         |    |
|       | endConfig*. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11a2  | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | only        |             |             |         |    |
|       | unmatched   |             |             |         |    |
|       | identities  |             |             |         |    |
|       | (incorrect  |             |             |         |    |
|       | *fu         |             |             |         |    |
|       | llI-RNTI*). |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11a3  | Check: Does | \--\>       | NR RRC:     | 3       | F  |
|       | the UE      |             | *RRCRes     |         |    |
|       | transmit an |             | umeRequest* |         |    |
|       | *RRCRes     |             |             |         |    |
|       | umeRequest* |             |             |         |    |
|       | message     |             |             |         |    |
|       | within 10s? |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11a4  | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | two         |             |             |         |    |
|       | unmatched   |             |             |         |    |
|       | identities  |             |             |         |    |
|       | (incorrect  |             |             |         |    |
|       | *f          |             |             |         |    |
|       | ullI-RNTI*) |             |             |         |    |
|       | and a       |             |             |         |    |
|       | matched     |             |             |         |    |
|       | identity    |             |             |         |    |
|       | (correct    |             |             |         |    |
|       | *fu         |             |             |         |    |
|       | llI-RNTI*). |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11a5  | Check: Does | \--\>       | NR RRC:     | 4       | P  |
|       | the UE      |             | *RRCRes     |         |    |
|       | transmit an |             | umeRequest* |         |    |
|       | *RRCRes     |             |             |         |    |
|       | umeRequest* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11a6  | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCResume* |         |    |
|       | an          |             |             |         |    |
|       | *RRCResume* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11a7  | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCResu    |         |    |
|       | an          |             | meComplete* |         |    |
|       | *RRCResu    |             |             |         |    |
|       | meComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12-17 | Void        | \-          | \-          | \-      | \- |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.1.1.1.3.3 Specific message contents {#specific-message-contents .H6}

Table 8.1.1.1.1.3.3-1: *Paging* (step 1, Table 8.1.1.1.1.3.2-1)

  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9                                                                                              
  Information Element                                                     Value/remark                                                 Comment   Condition
  Paging ::= SEQUENCE {                                                                                                                          
  pagingRecordList SEQUENCE (SIZE(1..maxNrofPageRec)) OF PagingRecord {   3 entries                                                              
  PagingRecord\[1\] SEQUENCE {                                                                                                         entry 1   
  ue-Identity CHOICE {                                                                                                                           
  ng-5G-S-TMSI                                                            Set to the different value from the NG-5G-S-TMSI of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  PagingRecord\[2\] SEQUENCE {                                                                                                         entry 2   
  ue-Identity CHOICE {                                                                                                                           
  ng-5G-S-TMSI                                                            Set to the different value from the NG-5G-S-TMSI of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  PagingRecord\[3\] SEQUENCE {                                                                                                         entry 3   
  ue-Identity CHOICE {                                                                                                                           
  ng-5G-S-TMSI                                                            Set to the different value from the NG-5G-S-TMSI of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------

Table 8.1.1.1.1.3.3-2: *Paging* (step 3, Table 8.1.1.1.1.3.2-1)

  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1\[4\], Table 4.6.1-9                                                                                               
  Information Element                                                     Value/remark                                                 Comment   Condition
  Paging ::= SEQUENCE {                                                                                                                          
  pagingRecordList SEQUENCE (SIZE(1..maxNrofPageRec)) OF PagingRecord {   3 entries                                                              
  PagingRecord\[1\] SEQUENCE {                                                                                                         entry 1   
  ue-Identity CHOICE {                                                                                                                           
  ng-5G-S-TMSI                                                            Set to the different value from the NG-5G-S-TMSI of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  PagingRecord\[2\] SEQUENCE {                                                                                                         entry 2   
  ue-Identity CHOICE {                                                                                                                           
  ng-5G-S-TMSI                                                            Set to the different value from the NG-5G-S-TMSI of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  PagingRecord\[3\] SEQUENCE {                                                                                                         entry 3   
  ue-Identity CHOICE {                                                                                                                           
  ng-5G-S-TMSI                                                            Set to the value of the NG-5G-S-TMSI of the UE                         
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------

Table 8.1.1.1.1.3.3-3: *RRCSetupRequest* (step 4, Table 8.1.1.1.1.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-23                            
  Information Element                                  Value/remark   Comment   Condition
  RRCSetupRequest ::= SEQUENCE {                                                
  rrcSetupRequest SEQUENCE {                                                    
  establishmentCause                                   mt-Access                
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.1.1.1.3.3-4: *Paging* (step 11a2, Table 8.1.1.1.1.3.2-1)

  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 Table 4.6.1-9                                                                                                     
  Information Element                                                     Value/remark                                                 Comment   Condition
  Paging ::= SEQUENCE {                                                                                                                          
  pagingRecordList SEQUENCE (SIZE(1..maxNrofPageRec)) OF PagingRecord {   3 entries                                                              
  PagingRecord\[1\] SEQUENCE {                                                                                                         entry 1   
  ue-Identity CHOICE {                                                                                                                           
  *fullI*-RNTI                                                            Set to the different value from the I-RNTI-Value of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  PagingRecord\[2\] SEQUENCE {                                                                                                         entry 2   
  ue-Identity CHOICE {                                                                                                                           
  *fullI*-RNTI                                                            Set to the different value from the I-RNTI-Value of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  PagingRecord\[3\] SEQUENCE {                                                                                                         entry 3   
  ue-Identity CHOICE {                                                                                                                           
  *fullI*-RNTI                                                            Set to the different value from the I-RNTI-Value of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------

Table 8.1.1.1.1.3.3-5: *Paging* (step 11a4, Table 8.1.1.1.1.3.2-1)

  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 Table 4.6.1-9                                                                                                     
  Information Element                                                     Value/remark                                                 Comment   Condition
  Paging ::= SEQUENCE {                                                                                                                          
  pagingRecordList SEQUENCE (SIZE(1..maxNrofPageRec)) OF PagingRecord {   3 entries                                                              
  PagingRecord\[1\] SEQUENCE {                                                                                                         entry 1   
  ue-Identity CHOICE {                                                                                                                           
  *fullI*-RNTI                                                            Set to the different value from the I-RNTI-Value of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  PagingRecord\[2\] SEQUENCE {                                                                                                         entry 2   
  ue-Identity CHOICE {                                                                                                                           
  *fullI*-RNTI                                                            Set to the different value from the I-RNTI-Value of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  PagingRecord\[3\] SEQUENCE {                                                                                                         entry 3   
  ue-Identity CHOICE {                                                                                                                           
  *fullI*-RNTI                                                            Set to the value of the I-RNTI-Value of the UE                         
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------

##### 8.1.1.1.2 RRC / Paging for connection / Shared network environment

##### 8.1.1.1.2.1 Test Purpose (TP) {#test-purpose-tp-1 .H6}

##### (1) {#section-4 .H6}

**with** { UE in NR RRC\_IDLE state having been registered in the TA of
the current cell which has broadcasted a SIB1 message including multiple
PLMN identities }

**ensure that** {

**when** { UE receives a Paging message including an IE ue-Identity set
to the ng-5G-S-TMSI which was allocated to the UE during the UE
registration procedure }

**then** { UE initiates RRCSetupRequest with ue-Identity set to
ng-5G-S-TMSI-Part1 }

}

##### (2) {#section-5 .H6}

**with** { UE having sent RRCSetupRequest with ue-Identity set to
ng-5G-S-TMSI-Part1 }

**ensure that** {

**when** { the UE receives RRCSetup message }

**then** { UE will set the ng-5G-S-TMSI-Value to ng-5G-S-TMSI-Part2 in
RRCSetupComplete message }

}

##### (3) {#section-6 .H6}

**with** { UE in NR RRC\_INACTIVE state having been registered in the TA
of the current cell which has broadcasted a SIB1 message including
multiple PLMN identities }

**ensure that** {

**when** { UE receives a Paging message including an IE ue-Identity set
to the ng-5G-S-TMSI which was allocated to the UE during the UE
registration procedure }

**then** { UE releases RRC connection with release cause 'other' and
goes to NR RRC\_IDLE state }

}

##### 8.1.1.1.2.2 Conformance requirements {#conformance-requirements-1 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.2.3,5.3.3.3 5.3.3.4 and 5.3.11, TS
24.501, clause 5.3.1.4 and 5.6.1.1. Unless otherwise stated these are
Rel-15 requirements.

\[TS 38.331, clause 5.3.2.3\]

Upon receiving the *Paging* message, the UE shall:

1\> if in RRC\_IDLE, for each of the *PagingRecord*, if any, included in
the *Paging* message:

2\> if the *ue-Identity* included in the *PagingRecord* matches the UE
identity allocated by upper layers:

3\> forward the *ue-Identity* and *accessType* (if present) to the upper
layers;

1\> if in RRC\_INACTIVE, for each of the *PagingRecord*, if any,
included in the *Paging* message:

2\> if the *ue-Identity* included in the *PagingRecord* matches the
UE\'s stored *full*I-RNTI:

...

2\> else if the *ue-Identity* included in the *PagingRecord* matches the
UE identity allocated by upper layers:

3\> forward the *ue-Identity* to upper layers and *accessType* (if
present) to the upper layers;

3\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11
with release cause \'other\'.

\[TS 38.331, clause 5.3.3.3\]

The UE shall set the contents of *RRCSetupRequest* message as follows:

1\> set the *ue-Identity* as follows:

2\> if upper layers provide an *5G-S-TMSI*:

3\> set the *ue-Identity* to *ng-5G-S-TMSI-Part1*;

2\> else:

3\> draw a 39-bit random value in the range 0..2^39^-1 and set the
*ue-Identity* to this value;

NOTE 1: Upper layers provide the *5G-S-TMSI* if the UE is registered in
the TA of the current cell.

1\> set the *establishmentCause* in accordance with the information
received from upper layers;

The UE shall submit the *RRCSetupRequest* message to lower layers for
transmission.

The UE shall continue cell re-selection related measurements as well as
cell re-selection evaluation. If the conditions for cell re-selection
are fulfilled, the UE shall perform cell re-selection as specified in
5.3.3.6.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1\> set the content of *RRCSetupComplete* message as follows:

2\> if upper layers provide an *5G-S-TMSI*:

3\> if the *RRCSetup* is received in response to an *RRCSetupRequest*:

4\> set the *ng-5G-S-TMSI-Value* to *ng-5G-S-TMSI-Part2*;

3\> else:

4\> set the *ng-5G-S-TMSI-Value* to *ng-5G-S-TMSI*;

...

1\> submit the *RRCSetupComplete* message to lower layers for
transmission, upon which the procedure ends

\[TS 38.331, clause 5.3.11\]

The UE shall:

1\> reset MAC;

1\> set the variable *pendingRNA-Update* to *false*, if that is set to
*true*;

1\> if going to RRC\_IDLE was triggered by reception of the *RRCRelease*
message including a *waitTime*:

2\> if T302 is running:

3\> stop timer T302;

2\> start timer T302 with the value set to the *waitTime*;

2\> inform upper layers that access barring is applicable for all access
categories except categories \'0\' and \'2\'.

1\> else:

2\> if T302 is running:

3\> stop timer T302;

3\> perform the actions as specified in 5.3.14.4;

1\> if T390 is running:

2\> stop timer T390 for all access categories;

2\> perform the actions as specified in 5.3.14.4;

1\> if the UE is leaving RRC\_INACTIVE:

2\> if going to RRC\_IDLE was not triggered by reception of the
*RRCRelease message*:

3\> if stored, discard the cell reselection priority information
provided by the *cellReselectionPriorities*;

3\> stop the timer T320, if running;

1\> stop all timers that are running except T302, T320 and T325;

1\> discard the UE Inactive AS context, if any;

1\> release the *suspendConfig*, if configured;

1\> discard the K~gNB~ key, the S-K~gNB~ key, the S-K~eNB~ key, the
K~RRCenc~ key, the K~RRCint~ key, the K~UPint~ key and the K~UPenc~ key,
if any;

1\> release all radio resources, including release of the RLC entity,
the MAC configuration and the associated PDCP entity and SDAP for all
established RBs;

1\> indicate the release of the RRC connection to upper layers together
with the release cause;

1\> except if going to RRC\_IDLE was triggered by inter-RAT cell
reselection while the UE is in RRC\_INACTIVE or RRC\_IDLE or when
selecting an inter-RAT cell while T311 was running:

2\> enter RRC\_IDLE and perform cell selection as specified in TS 38.304
\[20\];

\[TS 24.501, clause 5.3.1.4\]

...

Upon receiving AMF paging indication from the lower layers, the UE shall
transition from 5GMM-CONNECTED mode with RRC inactive indication to
5GMM-IDLE mode over 3GPP access and handle the AMF paging same as the
paging request received in the 5GMM-IDLE mode over 3GPP access as
specified in clause 5.6.1.

\[TS 24.501, clause 5.6.1.1\]

...

The UE shall invoke the service request procedure when:

a\) the UE, in 5GMM-IDLE mode over 3GPP access, receives a paging
request from the network;

##### 8.1.1.1.2.3 Test description {#test-description-1 .H6}

##### 8.1.1.1.2.3.1 Pre-test conditions {#pre-test-conditions-1 .H6}

##### System Simulator: {#system-simulator-1 .H6}

\- NR Cell 1.

##### UE: {#ue-1 .H6}

\- None.

##### Preamble: {#preamble-1 .H6}

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], clause 4.4A
on NR Cell 1 and 5G-GUTI is allocated in REGISTRATION ACCEPT.

##### 8.1.1.1.2.3.2 Test procedure sequence {#test-procedure-sequence-1 .H6}

Table 8.1.1.1.2.3.2-1: Main behaviour

  St         Procedure                                                                                                                                                                                                                                                                                    Message Sequence   TP                           Verdict   
  ---------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ---------------------------- --------- ----
                                                                                                                                                                                                                                                                                                          U - S              Message                                
  1          The SS transmits a *Paging* message including a matched ng-5G-S-TMSI.                                                                                                                                                                                                                        \<\--              *NR RRC: Paging*             \-        \-
  2          Check: Does the UE transmit an *RRCSetupRequest* message with ue-Identity set to ng-5G-S-TMSI-Part1?                                                                                                                                                                                         \--\>              *NR RRC: RRCSetupRequest*    1         P
  3          The SS transmits an *RRCSetup* message.                                                                                                                                                                                                                                                      \<\--              *NR RRC: RRCSetup*           \-        \-
  4          Check: Does the UE transmit an *RRCSetupComplete* message including ng-5G-S-TMSI-Part2 and a SERVICE REQUEST message and an IE *selectedPLMN-Identity* corresponding to the PLMN on which the UE has been registered to confirm the successful completion of the connection establishment?   \--\>              *NR RRC: RRCSetupComplete*   2         P
  5-8        Steps 5 to 8 of the generic radio bearer establishment procedure (TS 38.508-1 \[4\] Table 4.5.4.2-3) are executed to successfully complete the service request procedure.                                                                                                                    \-                 *-*                          \-        \-
  \-         EXCEPTION: Steps 9a1-9b1 describe behaviour that depends on UE configuration; the \"lower case letter\" identifies a step sequence that takes place if inactiveState is configured                                                                                                           \-                 *-*                          \-        \-
  9 a1       IF pc\_inactiveState THEN the SS transmits an *RRCRelease* message with suspendConfig to suspend RRC connection and move to RRC\_INACTIVE state.                                                                                                                                             \<\--              *NR RRC: RRCRelease*         \-        \-
  9a2        Wait 5s and the SS transmits a *Paging* message including a matched ng-5G-S-TMSI.                                                                                                                                                                                                            \<\--              *NR RRC: Paging*             \-        \-
  9a3        Check: Does the UE transmit an *RRCSetupRequest* message on the cell specified in the test case?                                                                                                                                                                                             \--\>              *NR RRC: RRCSetupRequest*    3         P
  9a49a10-   Steps 3-9 of Generic procedure for checking UE is in state 5GC RRC\_IDLE on a certain cell as specified in Table 4.9.4.2.2-1 of TS 38.508-1 \[4\] are performed.                                                                                                                             \-                 *-*                          \-        \-
  9b1        ELSE the SS transmits an RRCRelease message                                                                                                                                                                                                                                                  \<\--              *NR RRC: RRCRelease*         \-        \-
  10-18      Void                                                                                                                                                                                                                                                                                         \-                 *-*                          \-        \-

##### 8.1.1.1.2.3.3 Specific message contents {#specific-message-contents-1 .H6}

Table 8.1.1.1.2.3.3-1: *SIB1* (preamble and all steps, Table
8.1.1.1.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-28                                     
  --------------------------------------------------- ----------------------- --------- -----------
  Information Element                                 Value/remark            Comment   Condition
  SIB1 ::= SEQUENCE {                                                                   
  CellAccessRelatedInfo SEQUENCE {                                                      
  plmn-IdentityList                                   PLMN-IdentityInfoList             
  }                                                                                     
  }                                                                                     

Table 8.1.1.1.2.3.3-2: *PLMN-IdentityInfoList* (Table 8.1.1.1.2.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-108                                                                     
  ------------------------------------------------------------------------------- ---------------------------- --------- -----------
  Information Element                                                             Value/remark                 Comment   Condition
  PLMN-IdentityInfoList ::= SEQUENCE (SIZE (1..maxPLMN)) OF PLMN-IdentityInfo {   1 entry                                
  PLMN-IdentityInfo\[1\] SEQUENCE {                                                                            entry 1   
  plmn-IdentityList SEQUENCE (SIZE (1..maxPLMN)) OF PLMN-Identity {               2 entries                              
  plmn-Identity\[1\] SEQUENCE {                                                                                entry 1   
  mcc                                                                             See Table 8.1.1.1.2.3.3-2A   PLMN1     
  mnc                                                                             See Table 8.1.1.1.2.3.3-2A   PLMN1     
  }                                                                                                                      
  plmn-Identity\[2\] SEQUENCE {                                                                                entry 2   
  mcc                                                                             See Table 8.1.1.1.2.3.3-2A   PLMN2     
  mnc                                                                             See Table 8.1.1.1.2.3.3-2A   PLMN2     
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      

The PLMN Identity list broadcasted on the BCCH in NR Cell 1 shall be
configured as defined in the table below.

Table 8.1.1.1.2.3.3-2A: *PLMN Identity List broadcasted* for NR Cell 1

  Cell   PLMN Identity \[1\]   PLMN Identity \[2\]                
  ------ --------------------- --------------------- ------------ ------------
         MCC digits            MNC digits            MCC digits   MNC digits
  1      PLMN 1                PLMN 1                PLMN 2       PLMN 2

The definition of each PLMN code is found in table below:

Table 8.1.1.1.2.3.3-2B: definition of each PLMN code

  PLMN   MCC digit   MNC digit                
  ------ ----------- ----------- --- ---- --- ---
         1           2           3   1    2   3
  1      (NOTE 2)    (NOTE 2)                 
  2      (NOTE 3)    0           2   \-       

NOTE 1: \"--\" (dash) denotes \"not present\".

NOTE 2: Set to the same Mobile Country Code and Mobile Network Code
stored in EF~IMSI~ on the test USIM card for PLMN 1.

NOTE 3: Set to the same Mobile Country Code stored in EF~IMSI~ on the
test USIM card for PLMN 2.

Table 8.1.1.1.2.3.3-3: *RRCSetupRequest* (step 2, 9a3, Table
8.1.1.1.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-23                                                                                                                                                                       
  ---------------------------------------------------- -------------------- ---------------------------------------------------------------------------------------------------------------------------------------------- -----------
  Information Element                                  Value/remark         Comment                                                                                                                                        Condition
  RRCSetupRequest ::= SEQUENCE {                                                                                                                                                                                           
  rrcSetupRequest SEQUENCE {                                                                                                                                                                                               
  ue-Identity CHOICE {                                                                                                                                                                                                     
  ng-5G-S-TMSI-Part1                                   ng-5G-S-TMSI-Part1   ng-5G-S-TMSI-Part1 is rightmost 39 bits of 5G-S-TMSI. 5G-S-TMSI is derived from 5G-GUTI in REGISTRATION ACCEPT according to TS 23.003 \[34\]   
  }                                                                                                                                                                                                                        
  establishmentCause                                   mt-Access                                                                                                                                                           
  }                                                                                                                                                                                                                        
  }                                                                                                                                                                                                                        

Table 8.1.1.1.2.3.3-4: *RRCSetupComplete* (step 4, Table
8.1.1.1.2.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.1-22  |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| RRCS            |                 |                 |           |
| etupComplete::= |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rrc-Transa      | RRC-Transa      |                 |           |
| ctionIdentifier | ctionIdentifier |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| r               |                 |                 |           |
| rcSetupComplete |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ng-             | ng-             | ng-             |           |
| 5G-S-TMSI-Value | 5G-S-TMSI-Part2 | 5G-S-TMSI-Part2 |           |
|                 |                 | is the leftmost |           |
|                 |                 | 9 bits of       |           |
|                 |                 | 5G-S-TMSI.      |           |
|                 |                 | 5G-S-TMSI is    |           |
|                 |                 | derived from    |           |
|                 |                 | 5G-GUTI in      |           |
|                 |                 | REGISTRATION    |           |
|                 |                 | ACCEPT          |           |
|                 |                 | according to TS |           |
|                 |                 | 23.003 \[34\]   |           |
+-----------------+-----------------+-----------------+-----------+
| select          | 1 or 2          | PLMN1 or PLMN2  |           |
| edPLMN-Identity |                 |                 |           |
|                 |                 | Note1           |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Note1: If RPLMN |                 |                 |           |
| is PLMN1, UE    |                 |                 |           |
| will select     |                 |                 |           |
| PLMN1; if RPLMN |                 |                 |           |
| is PLMN2, UE    |                 |                 |           |
| will select     |                 |                 |           |
| PLMN2           |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.1.1.2.3.3-5: *RRCRelease* (step 9a1, Table 8.1.1.1.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                                                                     
  ------------------------------------------------------------------------- --------------------------- ------------------------------- -----------
  Information Element                                                       Value/remark                Comment                         Condition
  RRCRelease ::= SEQUENCE {                                                                                                             
  rrc-TransactionIdentifier                                                 RRC-TransactionIdentifier                                   
  criticalExtensions CHOICE {                                                                                                           
  rrcRelease SEQUENCE {                                                                                                                 
  suspendConfig SEQUENCE {                                                                                                              
  fullI-RNTI                                                                *I-RNTI-Value*              38.508-1\[4\] Table 4.6.3-64    
  shortI-RNTI                                                               *ShortI-RNTI-Value*         38.508-1\[4\] Table 4.6.3-170   
  ran-PagingCycle                                                           rf256                                                       
  ran-NotificationAreaInfo CHOICE {                                                                                                     
  cellList SEQUENCE (SIZE (1.. maxPLMNIdentities)) OF PLMN-RAN-AreaCell {   2 entries                                                   
  PLMN-RAN-AreaCellList\[1\] SEQUENCE {                                                                 entry 1                         
  plmn-Identity                                                             PLMN1                                                       
  ran-AreaCells SEQUENCE (SIZE (1..32)) OF CellIdentity {                   1 entry                                                     
  CellIdentity\[1\]                                                         CellIdentity of NR Cell 1   entry 1                         
  }                                                                                                                                     
  }                                                                                                                                     
  PLMN-RAN-AreaCellList\[2\] SEQUENCE {                                                                 entry 2                         
  plmn-Identity                                                             PLMN2                                                       
  ran-AreaCells SEQUENCE (SIZE (1..32)) OF CellIdentity {                   1 entry                                                     
  CellIdentity\[1\]                                                         CellIdentity of NR Cell 1   entry 1                         
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  t380                                                                      Not Present                                                 
  nextHopChainingCount                                                      *NextHopChainingCount*      38.508-1\[4\] Table 4.6.3-83    
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     

#### 8.1.1.1a Paging Early Indication and Subgrouping

##### 8.1.1.1a.1 Paging Early Indication with Subgrouping / RRC\_IDLE / lastUsedCellOnly not configured / Subgroup ID selection

##### 8.1.1.1a.1.1 Test Purpose (TP) {#a.1.1-test-purpose-tp .H6}

##### (1) {#section-7 .H6}

**with** { UE in NR RRC\_IDLE state and PEI configuration and
subgroupConfig is provided in SIB1 }

**ensure that** {

**when** { UE detects PEI and the PEI indicates the subgroup the UE
belongs to }

**then** { UE monitors the associated PO and reacts to paging with
matching UE ID }

}

##### (2) {#section-8 .H6}

**with** { UE in NR RRC\_IDLE state and PEI configuration and
subgroupConfig is provided in SIB1 }

**ensure that** {

**when** { UE detects that subgroupsNumForUEID = subgroupsNumPerPO }

**then** { UE uses subgroup ID based on UE\_ID based subgrouping }

}

##### (3) {#section-9 .H6}

**with** { UE in NR RRC\_IDLE state and PEI configuration and
subgroupConfig is provided in SIB1 without lastUsedCellOnly of the cell
where it has received the most recent RRCRelease }

**ensure that** {

**when** { UE has received RRCRelease without noLastCellUpdate in this
cell }

**then** { UE monitors the PEI and the associated PO in the camped cell
and does not react to paging in the old cell }

}

##### (4) {#section-10 .H6}

**with** { UE in NR RRC\_IDLE state and PEI configuration and
subgroupConfig is provided in SIB1 }

**ensure that** {

**when** { UE detects that subgroupsNumForUEID \< subgroupsNumPerPO and
no CN assigned subgrouping is available }

**then** { UE uses subgroup ID based on UE\_ID based subgrouping }

##### 8.1.1.1a.1.2 Conformance requirements {#a.1.2-conformance-requirements .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.304 clauses 7.2, 7.3.0 and 7.3.2. Unless otherwise
stated these are Rel-17 requirements.

\[TS 38.304, clause 7.2\]

The UE may use Paging Early Indication (PEI) in RRC\_IDLE and
RRC\_INACTIVE states in order to reduce power consumption. If PEI
configuration is provided in system information, the UE in RRC\_IDLE or
RRC\_INACTIVE state supporting PEI (except for the UEs expecting
multicast session activation notification) can monitor PEI using PEI
parameters in system information according to the procedure described
below.

If *lastUsedCellOnly* is configured in system information of a cell, the
UE monitors PEI in the cell only if the UE most recently received
*RRCRelease* without *noLastCellUpdate* in this cell. Otherwise (i.e.,
if *lastUsedCellOnly* is not configured in system information of a
cell), the UE monitors PEI in the camped cell.

The UE monitors one PEI occasion per DRX cycle. A PEI occasion (PEI-O)
is a set of PDCCH monitoring occasions (MOs) and can consist of multiple
time slots (e.g. subframes or OFDM symbols) where PEI can be sent (TS
38.213 \[4\]). In multi-beam operations, the UE assumes that the same
PEI is repeated in all transmitted beams and thus the selection of the
beam(s) for the reception of the PEI is up to UE implementation.

\[TS 38.304, clause 7.3.0\]

If PEI and subgrouping are configured, UEs monitoring the same PO can be
divided into one or more subgroups. With subgrouping, the UE monitors
the associated PO if the corresponding bit for subgroup the UE belongs
to is indicated as 1 by PEI corresponding to its PO, as specified in
clause 10.4a in TS 38.213 \[4\].

The following parameters are used for the determination of subgroup ID:

\- subgroupsNumPerPO: total number of subgroups for both CN assigned
subgrouping (if any) and UE\_ID based subgrouping (if any) in a PO,
which is broadcasted in system information;

\- subgroupsNumForUEID: number of subgroups for UE\_ID based subgrouping
in a PO, which is broadcasted in system information.

\[TS 38.304, clause 7.3.2\]

Paging with UE\_ID based subgrouping is used in the cell which supports
UE\_ID based subgrouping, as described in clause 7.3.0.

If the UE is not configured with a CN assigned subgroup ID, or if the UE
configured with a CN assigned subgroup ID is in a cell supporting only
UE\_ID based subgrouping, the subgroup ID of the UE is determined by the
formula below:

SubgroupID = (floor(UE\_ID/(N\*Ns)) mod **subgroupsNumForUEID**) +
(subgroupsNumPerPO - **subgroupsNumForUEID**),

where:

N: number of total paging frames in T, which is the DRX cycle of
RRC\_IDLE state as specified in clause 7.1

Ns: number of paging **occasions** for a PF

**UE\_ID:** 5G-S-TMSI mod X, where X is 32768, if eDRX is applied;
otherwise, X is 8192

subgroupsNumForUEID: number of subgroups for UE\_ID based subgrouping in
a PO, which is broadcasted in system information

The UE belonging to the SubgroupID monitors its associated PEI which
indicates the paged subgroup(s) as specified in clause 7.2.

##### 8.1.1.1a.1.3 Test Description {#a.1.3-test-description .H6}

##### 8.1.1.1a.1.3.1 Pre-test conditions {#a.1.3.1-pre-test-conditions .H6}

##### System Simulator: {#system-simulator-2 .H6}

\- 2 NR cells: NR Cell 1 and NR Cell 2

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-2 .H6}

\- None.

##### Preamble: {#preamble-2 .H6}

\- The UE is in 5GS state 1N-A on NR Cell 1 according to TS 38.508-1
\[4\], clause 4.4A.2 Table 4.4A.2-1.

##### 8.1.1.1a.1.3.2 Test procedure sequence {#a.1.3.2-test-procedure-sequence .H6}

Table 8.1.1.1a.1.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. The exact instants on which these values shall be
applied are described in the texts in this clause.

Table 8.1.1.1a.1.3.2-1: Time instances of cell power level and parameter
changes for FR1

+--------+-----------+---------+-----------+-----------+--------+
|        | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+========+===========+=========+===========+===========+========+
| **T0** | SS/PBCH   | dBm/SCS | -88       | Off       |        |
|        |           |         |           |           |        |
|        | SSS EPRE  |         |           |           |        |
+--------+-----------+---------+-----------+-----------+--------+
| **T1** | SS/PBCH   | dBm/SCS | -88       | -82       |        |
|        |           |         |           |           |        |
|        | SSS EPRE  |         |           |           |        |
+--------+-----------+---------+-----------+-----------+--------+

Table 8.1.1.1a.1.3.2-2: Time instances of cell power level and parameter
changes for FR2

+--------+-----------+---------+-----------+-----------+--------+
|        | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+========+===========+=========+===========+===========+========+
| **T0** | SS/PBCH   | dBm/SCS | -82       | Off       |        |
|        |           |         |           |           |        |
|        | SSS EPRE  |         |           |           |        |
+--------+-----------+---------+-----------+-----------+--------+
| **T1** | SS/PBCH   | dBm/SCS | -91       | -82       |        |
|        |           |         |           |           |        |
|        | SSS EPRE  |         |           |           |        |
+--------+-----------+---------+-----------+-----------+--------+

Table 8.1.1.1a.1.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| \-    | The         | \-          | *-*         | \-      | \- |
|       | following   |             |             |         |    |
|       | messages    |             |             |         |    |
|       | are sent    |             |             |         |    |
|       | and         |             |             |         |    |
|       | received on |             |             |         |    |
|       | NR Cell 1   |             |             |         |    |
|       | unless      |             |             |         |    |
|       | otherwise   |             |             |         |    |
|       | stated.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | PEI and the |             |             |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | an          |             |             |         |    |
|       | un-matched  |             |             |         |    |
|       | identity    |             |             |         |    |
|       | (incorrect  |             |             |         |    |
|       | *ng-        |             |             |         |    |
|       | 5G-S-TMSI*) |             |             |         |    |
|       | on the      |             |             |         |    |
|       | associated  |             |             |         |    |
|       | PO only.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | Check: Does | \--\>       | NR RRC:     | 1, 2    | F  |
|       | the UE      |             | *RRCSe      |         |    |
|       | transmit an |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message     |             |             |         |    |
|       | within 10s? |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | PEI and the |             |             |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including a |             |             |         |    |
|       | matched     |             |             |         |    |
|       | identity on |             |             |         |    |
|       | the         |             |             |         |    |
|       | associated  |             |             |         |    |
|       | PO only.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | Check: Does | \--\>       | NR RRC:     | 1, 2    | P  |
|       | the UE      |             | *RRCSe      |         |    |
|       | transmit an |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSetup*  |         |    |
|       | an          |             |             |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSet     |         |    |
|       | an          |             | upComplete* |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             | 5GMM:       |         |    |
|       | message     |             | SERVICE     |         |    |
|       | including   |             | REQUEST     |         |    |
|       | SERVICE     |             |             |         |    |
|       | REQUEST to  |             |             |         |    |
|       | confirm the |             |             |         |    |
|       | successful  |             |             |         |    |
|       | completion  |             |             |         |    |
|       | of the      |             |             |         |    |
|       | connection  |             |             |         |    |
|       | est         |             |             |         |    |
|       | ablishment. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7-10  | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the NR |             |             |         |    |
|       | RRC         |             |             |         |    |
|       | \_CONNECTED |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12    | The SS      | \-          | \-          | \-      | \- |
|       | adjusts the |             |             |         |    |
|       | cell power  |             |             |         |    |
|       | levels      |             |             |         |    |
|       | according   |             |             |         |    |
|       | to row      |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.1.1a    |             |             |         |    |
|       | .1.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 13    | Wait 5s so  | \-          | \-          | \-      | \- |
|       | the UE can  |             |             |         |    |
|       | camp on NR  |             |             |         |    |
|       | Cell 2.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | PEI and the |             |             |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including a |             |             |         |    |
|       | matched     |             |             |         |    |
|       | identity on |             |             |         |    |
|       | the         |             |             |         |    |
|       | associated  |             |             |         |    |
|       | PO only on  |             |             |         |    |
|       | NR Cell 1.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | Check: Does | \--\>       | NR RRC:     | 3       | F  |
|       | the UE      |             | *RRCSe      |         |    |
|       | transmit an |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message     |             |             |         |    |
|       | within 10s  |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 1?          |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| \-    | The         | \-          | *-*         | \-      | \- |
|       | following   |             |             |         |    |
|       | messages    |             |             |         |    |
|       | are sent    |             |             |         |    |
|       | and         |             |             |         |    |
|       | received on |             |             |         |    |
|       | NR Cell 2   |             |             |         |    |
|       | unless      |             |             |         |    |
|       | otherwise   |             |             |         |    |
|       | stated.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | PEI and the |             |             |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including a |             |             |         |    |
|       | matched     |             |             |         |    |
|       | identity on |             |             |         |    |
|       | the         |             |             |         |    |
|       | associated  |             |             |         |    |
|       | PO only.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 17    | Check: Does | \--\>       | NR RRC:     | 4       | P  |
|       | the UE      |             | *RRCSe      |         |    |
|       | transmit an |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 18    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSetup*  |         |    |
|       | an          |             |             |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 19    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSet     |         |    |
|       | an          |             | upComplete* |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             | 5GMM:       |         |    |
|       | message     |             | SERVICE     |         |    |
|       | including   |             | REQUEST     |         |    |
|       | SERVICE     |             |             |         |    |
|       | REQUEST to  |             |             |         |    |
|       | confirm the |             |             |         |    |
|       | successful  |             |             |         |    |
|       | completion  |             |             |         |    |
|       | of the      |             |             |         |    |
|       | connection  |             |             |         |    |
|       | est         |             |             |         |    |
|       | ablishment. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20-23 | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the NR |             |             |         |    |
|       | RRC         |             |             |         |    |
|       | \_CONNECTED |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.1.1a.1.3.3 Specific message contents {#a.1.3.3-specific-message-contents .H6}

Table 8.1.1.1a.1.3.3-1: SIB1 for NR Cell 1 (preamble and all steps,
Table 8.1.1.1a.1.3.2-3)

  -----------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-28 with condition PEI
  -----------------------------------------------------------------------

Table 8.1.1.1a.1.3.3-2: SIB1 for NR Cell 2 (preamble and all steps,
Table 8.1.1.1a.1.3.2-3)

  ----------------------------------------------------------------------- ------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-28 with condition PEI                                                                    
  Information Element                                                     Value/remark                                           Comment   Condition
  SIB1 :: = SEQUENCE {                                                                                                                     
  servingCellConfigCommon                                                 ServingCellConfigCommonSIB in Table 8.1.1.1a.1.3.3-3             
  }                                                                                                                                        
  ----------------------------------------------------------------------- ------------------------------------------------------ --------- -----------

Table 8.1.1.1a.1.3.3-3: ServingCellConfigCommonSIB (Table
8.1.1.1a.1.3.3-2)

  ------------------------------------------------------------------------ --------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-169 with condition PEI                                                                 
  Information Element                                                      Value/remark                                        Comment   Condition
  ServingCellConfigCommonSIB ::= SEQUENCE {                                                                                              
  downlinkConfigCommon                                                     DownlinkConfigCommonSIB in Table 8.1.1.1a.1.3.3-4             
  }                                                                                                                                      
  ------------------------------------------------------------------------ --------------------------------------------------- --------- -----------

Table 8.1.1.1a.1.3.3-4: DownlinkConfigCommonSIB (Table 8.1.1.1a.1.3.3-3)

  ----------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-53 with condition PEI                            
  Information Element                                                     Value/remark   Comment   Condition
  DownlinkConfigCommonSIB ::= SEQUENCE {                                                           
  pei-Config-r17 ::= SEQUENCE {                                                                    
  subgroupConfig-r17 ::= SEQUENCE {                                                                
  subgroupsNumForUEID-r17                                                 1                        
  }                                                                                                
  }                                                                                                
  }                                                                                                
  ----------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.1.1a.1.3.3-5: *Paging* (step 1, Table 8.1.1.1a.1.3.2-3)

  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9                                                                                              
  Information Element                                                     Value/remark                                                 Comment   Condition
  Paging ::= SEQUENCE {                                                                                                                          
  pagingRecordList SEQUENCE (SIZE(1..maxNrofPageRec)) OF PagingRecord {   1 entry                                                                
  PagingRecord\[1\] SEQUENCE {                                                                                                         entry 1   
  ue-Identity CHOICE {                                                                                                                           
  ng-5G-S-TMSI                                                            Set to the different value from the NG-5G-S-TMSI of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------

Table 8.1.1.1a.1.3.3-6: *RRCSetupRequest* (steps 4 and 17, Table
8.1.1.1a.1.3.2-3)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-23                            
  Information Element                                  Value/remark   Comment   Condition
  RRCSetupRequest ::= SEQUENCE {                                                
  rrcSetupRequest SEQUENCE {                                                    
  establishmentCause                                   mt-Access                
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

##### 8.1.1.1a.2 Paging Early Indication with Subgrouping / RRC\_INACTIVE / lastUsedCellOnly configured

##### 8.1.1.1a.2.1 Test Purpose (TP) {#a.2.1-test-purpose-tp .H6}

##### (1) {#section-11 .H6}

**with** { UE in NR RRC\_INACTIVE and PEI configuration is provided in
SIB1 }

**ensure that** {

**when** { UE detects PEI and the PEI indicates the subgroup the UE
belongs to }

**then** { UE monitors the associated PO }

}

##### (2) {#section-12 .H6}

**with** { UE in NR RRC\_INACTIVE and PEI configuration has been
provided in SIB1 with lastUsedCellOnly }

**ensure that** {

**when** { UE has received the RRCRelease in this cell and without
noLastCellUpdate }

**then** { UE monitors PEI in the cell }

}

##### (3) {#section-13 .H6}

**with** { UE in NR RRC\_INACTIVE and PEI configuration has been
provided in SIB1 with lastUsedCellOnly }

**ensure that** {

**when** { UE has received RRCRelease with noLastCellUpdate in this cell
}

**then** { UE does not monitor PEI in the cell }

}

##### 8.1.1.1a.2.2 Conformance requirements {#a.2.2-conformance-requirements .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.304, clause 7.2.1. Unless otherwise stated these are
Rel-17 requirements.

\[TS 38.304, clause 7.2.1\]

The UE may use Paging Early Indication (PEI) in RRC\_IDLE and
RRC\_INACTIVE states in order to reduce power consumption. If PEI
configuration is provided in system information, the UE in RRC\_IDLE or
RRC\_INACTIVE state supporting PEI (except for the UEs expecting MBS
group notification) can monitor PEI using PEI parameters in system
information according to the procedure described below.

If *lastUsedCellOnly* is configured in system information of a cell, the
UE monitors PEI in this cell only if the UE most recently received
*RRCRelease* without *noLastCellUpdate* in this cell. Otherwise (i.e.,
if *lastUsedCellOnly* is not configured in system information of a
cell), the UE monitors PEI in the camped cell.

The UE monitors one PEI occasion per DRX cycle. A PEI occasion (PEI-O)
is a set of PDCCH monitoring occasions (MOs) and can consist of multiple
time slots (e.g. subframes or OFDM symbols) where PEI can be sent (TS
38.213 \[4\]). In multi-beam operations, the UE assumes that the same
PEI is repeated in all transmitted beams and thus the selection of the
beam(s) for the reception of the PEI is up to UE implementation.

The time location of PEI-O for UE\'s PO is determined by a reference
point and an offset:

\- The reference point is the start of a reference frame determined by a
frame-level offset from the start of the first PF of the PF(s)
associated with the PEI-O, provided by *pei-FrameOffset* in SIB1;

\- The offset is a symbol-level offset from the reference point to the
start of the first PDCCH MO of this PEI-O, provided by
*firstPDCCH-MonitoringOccasionOfPEI-O* in SIB1.

If one PEI-O is associated with POs of two PFs, the two PFs are
consecutive PFs calculated by the parameters *PF\_offset*, *T*, *Ns*,
and *N*. The first PF of the PFs associated with the PEI-O is provided
by (SFN for PF) - floor (*i~PO~*/*Ns*)\**T*/*N*, where SFN for PF is
determined in clause 7.1, *i~PO~* is defined in clause 10.4a in TS
38.213\[4\], *T*, *Ns*, and *N* are determined in clause 7.1.

The PDCCH MOs for PEI are determined as specified in TS 38.213 \[4\]
according to ***pei-SearchSpace***, *pei-FrameOffset*,
*firstPDCCH-MonitoringOccasionOfPEI-O* and
*nrofPDCCH-MonitoringOccasionPerSSB-InPO* if configured as specified in
TS 38.331 \[3\]. When *SearchSpaceId* = 0 is configured for
***pei-SearchSpace***, the PDCCH MOs for PEI are same as for RMSI as
defined in clause 13 in TS 38.213 \[4\]. UE determines first PDCCH MO
for PEI-O based on *pei-FrameOffset* and
*firstPDCCH-MonitoringOccasionOfPEI-O*, as for the case with
*SearchSpaceId* \> 0 configured.

When *SearchSpaceId* = 0 is configured for *pei-SearchSpace*, the UE
monitors the PEI-O according to *searchSpaceZero*. When *SearchSpaceId*
other than 0 is configured for ***pei-SearchSpace**,* the UE monitors
the PEI-O according to the search space with the configured
*SearchSpaceId.*

A PEI occasion is a set of \'**S\*X\'** consecutive PDCCH MOs, where
\'S\' is the number of actual transmitted SSBs determined according to
*ssb-PositionsInBurst* in *SIB1,* **and X is the
*nrofPDCCH-MonitoringOccasionPerSSB-InPO* if configured or is equal to 1
otherwise**. The **\[x\*S+K\]^th^** PDCCH MO for PEI in the PEI-O
**corresponds to the K^th^ transmitted SSB**, where **x=0,1,...,X-1,**
K=1,2,...,S. The PDCCH MOs for PEI which do not overlap with UL symbols
(determined according to *tdd-UL-DL-ConfigurationCommon*) are
sequentially numbered from zero starting from the first PDCCH MO for PEI
in the PEI-O. When the UE detects a PEI within its PEI-O, the UE is not
required to monitor the subsequent MO(s) associated with the same PEI-O.

If the UE detects PEI and the PEI indicates the subgroup the UE belongs
to monitor its associated PO, as specified in clause 10.4a in TS 38.213
\[4\], the UE monitors the associated PO as specified in clause 7.1. If
the UE does not detect PEI on the monitored PEI occasion or the PEI does
not indicate the subgroup the UE belongs to monitor its associated PO,
as specified in clause 10.4a in TS 38.213 \[4\], the UE is not required
to monitor the associated PO as specified in clause 7.1.

If the UE is unable to monitor the PEI occasion (i.e. all valid PDCCH MO
for PEI) corresponding to its PO, e.g. during cell re-selection, the UE
monitors the associated PO according to clause 7.1.

In RRC\_INACTIVE state, when the UE uses the same i­\_s as for RRC\_IDLE
state as specified in clause 7.1, the UE shall use the same *i~PO~* as
for RRC\_IDLE state. Otherwise, the UE determines the *i~PO~* based on
the formula defined in clause 10.4a in TS 38.213 \[4\].

##### 8.1.1.1a.2.3 Test Description {#a.2.3-test-description .H6}

##### 8.1.1.1a.2.3.1 Pre-test conditions {#a.2.3.1-pre-test-conditions .H6}

##### System Simulator: {#system-simulator-3 .H6}

\- 2 NR cells: NR Cell 1 and NR Cell 2

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-3 .H6}

\- None.

##### Preamble: {#preamble-3 .H6}

\- The UE is in 5GS state 2N-A on NR Cell 1 according to TS 38.508-1
\[4\], clause 4.4A.2 Table 4.4A.2-2.

##### 8.1.1.1a.2.3.2 Test procedure sequence {#a.2.3.2-test-procedure-sequence .H6}

Table 8.1.1.1a.2.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. The exact instants on which these values shall be
applied are described in the texts in this clause.

Table 8.1.1.1a.2.3.2-1: Time instances of cell power level and parameter
changes for FR1

+--------+-----------+---------+-----------+-----------+--------+
|        | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+========+===========+=========+===========+===========+========+
| **T0** | SS/PBCH   | dBm/SCS | -88       | Off       |        |
|        |           |         |           |           |        |
|        | SSS EPRE  |         |           |           |        |
+--------+-----------+---------+-----------+-----------+--------+
| **T1** | SS/PBCH   | dBm/SCS | -88       | -82       |        |
|        |           |         |           |           |        |
|        | SSS EPRE  |         |           |           |        |
+--------+-----------+---------+-----------+-----------+--------+

Table 8.1.1.1a.2.3.2-2: Time instances of cell power level and parameter
changes for FR2

+--------+-----------+---------+-----------+-----------+--------+
|        | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+========+===========+=========+===========+===========+========+
| **T0** | SS/PBCH   | dBm/SCS | -82       | Off       |        |
|        |           |         |           |           |        |
|        | SSS EPRE  |         |           |           |        |
+--------+-----------+---------+-----------+-----------+--------+
| **T1** | SS/PBCH   | dBm/SCS | -91       | -82       |        |
|        |           |         |           |           |        |
|        | SSS EPRE  |         |           |           |        |
+--------+-----------+---------+-----------+-----------+--------+

Table 8.1.1.1a.2.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                                   Message Sequence   TP                            Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ----------------------------- --------- ----
                                                                                                                                                                                                   U - S              Message                                 
  \-   The following messages are sent and received on NR Cell 1 unless otherwise stated.                                                                                                          \-                 *-*                           \-        \-
  1    The SS transmits a PEI and the *Paging* message including an un-matched identity (incorrect *ng-5G-S-TMSI*) on the associated PO only.                                                      \<\--              NR RRC: *Paging*              \-        \-
  2    Check: Does the UE transmit an *RRCResumeRequest* message by setting *resumeIdentity* to the stored *shortI-RNTI* value?                                                                    \--\>              NR RRC: *RRCResumeRequest*    1         F
  3    The SS transmits a PEI and the *Paging* message including a matched identity on the associated PO only.                                                                                     \<\--              NR RRC: *Paging*              \-        \-
  4    Check: Does the UE transmit an *RRCResumeRequest* message by setting *resumeIdentity* to the stored *shortI-RNTI* value?                                                                    \--\>              NR RRC: *RRCResumeRequest*    1         P
  5    The SS transmits an *RRCResume* message.                                                                                                                                                    \<\--              NR RRC: *RRCResume*           \-        \-
  6    The UE transmits an *RRCResumeComplete* message.                                                                                                                                            \--\>              NR RRC: *RRCResumeComplete*   \-        \-
  7    The SS transmits an *RRCRelease* message including both *fullI-RNTI* and *shortI-RNTI* in s*uspendConfig*.                                                                                  \<\--              NR RRC: *RRCRelease*          \-        \-
  8    The SS adjusts the cell power levels according to row \"T1\" in table 8.1.1.1a.2.3.2-1/2.                                                                                                   \-                 \-                            \-        \-
  \-   The following messages are sent and received on NR Cell 2 unless otherwise stated.                                                                                                          \-                 *-*                           \-        \-
  9    The UE transmits an *RRCResumeRequest* message.                                                                                                                                             \--\>              NR RRC: *RRCResumeRequest*    \-        \-
  10   The SS transmits an *RRCResume* message.                                                                                                                                                    \<\--              NR RRC: *RRCResume*           \-        \-
  11   The UE transmit an *RRCResumeComplete* message.                                                                                                                                             \--\>              NR RRC: *RRCResumeComplete*   \-        \-
  12   The SS transmits an *RRCRelease* message including both *fullI-RNTI* and *shortI-RNTI* in s*uspendConfig*.                                                                                  \<\--              NR RRC: *RRCRelease*          \-        \-
  13   The SS transmits a PEI and the *Paging* message including a matched identity on the associated PO only.                                                                                     \<\--              NR RRC: *Paging*              \-        \-
  14   Check: Does the UE transmit an *RRCResumeRequest* message by setting *resumeIdentity* to the stored *shortI-RNTI* value?                                                                    \--\>              NR RRC: *RRCResumeRequest*    2         P
  15   The SS transmits an *RRCResume* message.                                                                                                                                                    \<\--              NR RRC: *RRCResume*           \-        \-
  16   The UE transmits an *RRCResumeComplete* message.                                                                                                                                            \--\>              NR RRC: *RRCResumeComplete*   \-        \-
  17   The SS transmits an *RRCRelease* message including both *fullI-RNTI* and *shortI-RNTI* in s*uspendConfig*. The *RRCRelease* message also includes the *noLastCellUpdate-r17* set to True.   \<\--              NR RRC: *RRCRelease*          \-        \-
  18   The SS transmits a PEI and the *Paging* message including a matched identity on the associated PO only.                                                                                     \<\--              NR RRC: *Paging*              \-        \-
  19   Check: Does the UE transmit an *RRCResumeRequest* message by setting *resumeIdentity* to the stored *shortI-RNTI* value within 10s ?                                                        \--\>              NR RRC: *RRCResumeRequest*    3         F
  20   The SS transmits a *Paging* message including a matched identity (correct *fullI-RNTI*).                                                                                                    \<\--              NR RRC: *Paging*              \-        \-
  21   The UE transmits an *RRCResumeRequest* message.                                                                                                                                             \--\>              NR RRC: *RRCResumeRequest*    3         P
  22   The SS transmits an *RRCResume* message.                                                                                                                                                    \<\--              NR RRC: *RRCResume*           \-        \-
  23   The UE transmits an *RRCResumeComplete* message.                                                                                                                                            \--\>              NR RRC: *RRCResumeComplete*   \-        \-

##### 8.1.1.1a.2.3.3 Specific message contents {#a.2.3.3-specific-message-contents .H6}

Table 8.1.1.1a.2.3.3-1: SIB1 for NR Cell 1 (preamble and all steps,
Table 8.1.1.1a.2.3.2-3)

  -----------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-28 with condition PEI
  -----------------------------------------------------------------------

Table 8.1.1.1a.2.3.3-2: SIB1 for NR Cell 2 (preamble and all steps,
Table 8.1.1.1a.2.3.2-3)

  ----------------------------------------------------------------------- ------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-28 with condition PEI                                                                    
  Information Element                                                     Value/remark                                           Comment   Condition
  SIB1 ::= SEQUENCE {                                                                                                                      
  servingCellConfigCommon                                                 ServingCellConfigCommonSIB in Table 8.1.1.1a.2.3.3-3             
  }                                                                                                                                        
  ----------------------------------------------------------------------- ------------------------------------------------------ --------- -----------

Table 8.1.1.1a.2.3.3-3: ServingCellConfigCommonSIB (Table
8.1.1.1a.2.3.3-2)

  ------------------------------------------------------------------------ --------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-169 with condition PEI                                                                 
  Information Element                                                      Value/remark                                        Comment   Condition
  ServingCellConfigCommonSIB ::= SEQUENCE {                                                                                              
  downlinkConfigCommon                                                     DownlinkConfigCommonSIB in Table 8.1.1.1a.2.3.3-4             
  }                                                                                                                                      
  ------------------------------------------------------------------------ --------------------------------------------------- --------- -----------

Table 8.1.1.1a.2.3.3-4: DownlinkConfigCommonSIB (Table 8.1.1.1a.2.3.3-3)

  ----------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-53 with condition PEI                            
  Information Element                                                     Value/remark   Comment   Condition
  DownlinkConfigCommonSIB ::= SEQUENCE {                                                           
  pei-Config-r17 ::= SEQUENCE {                                                                    
  lastUsedCellOnly-r17                                                    true                     
  }                                                                                                
  }                                                                                                
  ----------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.1.1a.2.3.3-5: *Paging* (step 1, Table 8.1.1.1a.2.3.2-3)

  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9                                                                                              
  Information Element                                                     Value/remark                                                 Comment   Condition
  Paging ::= SEQUENCE {                                                                                                                          
  pagingRecordList SEQUENCE (SIZE(1..maxNrofPageRec)) OF PagingRecord {   1 entry                                                                
  PagingRecord\[1\] SEQUENCE {                                                                                                         entry 1   
  ue-Identity CHOICE {                                                                                                                           
  ng-5G-S-TMSI                                                            Set to the different value from the NG-5G-S-TMSI of the UE             
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ----------------------------------------------------------------------- ------------------------------------------------------------ --------- -----------

Table 8.1.1.1a.2.3.3-6: *RRCResumeRequest* (step 9, Table
8.1.1.1a.2.3.2-3)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19                            
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeRequest ::= SEQUENCE {                                               
  rrcResumeRequest SEQUENCE {                                                   
  resumeCause                                          rna-Update               
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.1.1a.2.3.3-7: RRCRelease (steps 7 and 12, Table
8.1.1.1a.2.3.2-3)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE
  -------------------------------------------------------------------------------------

Table 8.1.1.1a.2.3.3-8: *RRCRelease* (step 17, Table 8.1.1.1a.2.3.2-3)

  ------------------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE                            
  Information Element                                                                   Value/remark   Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                                      
  criticalExtensions CHOICE {                                                                                    
  RRCRelease SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                
  nonCriticalExtension SEQUENCE {                                                                                
  nonCriticalExtension SEQUENCE {                                                                                
  nonCriticalExtension SEQUENCE {                                                                                
  RRCRelease-v1710-IEs SEQUENCE {                                                                                
  noLastCellUpdate-r17                                                                  true                     
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  ------------------------------------------------------------------------------------- -------------- --------- -----------

##### 8.1.1.1a.3 Paging Early Indication without Subgrouping / RRC\_IDLE

##### 8.1.1.1a.3.1 Test Purpose (TP) {#a.3.1-test-purpose-tp .H6}

##### (1) {#section-14 .H6}

**with** { UE in NR RRC\_IDLE and PEI configuration and subgroupConfig
are provided in SIB1 }

**ensure that** {

**when** { UE detects that subgroupsNumForUEID is absent in
subgroupConfig and has no CN assigned subgroup ID }

**then** { UE monitors one entire paging occasion per DRX cycle }

}

##### 8.1.1.1a.3.2 Conformance requirements {#a.3.2-conformance-requirements .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.304 clauses 7.1, 7.2 and 7.3.0. Unless otherwise
stated these are Rel-17 requirements.

\[TS 38.304, clause 7.1\]

The UE may use Discontinuous Reception (DRX) in RRC\_IDLE and
RRC\_INACTIVE state in order to reduce power consumption. The UE
monitors one paging occasion (PO) per DRX cycle. A PO is a set of PDCCH
monitoring occasions and can consist of multiple time slots (e.g.
subframe or OFDM symbol) where paging DCI can be sent (TS 38.213 \[4\]).
One Paging Frame (PF) is one Radio Frame and may contain one or multiple
PO(s) or starting point of a PO. A L2 U2N Relay UE monitors the paging
occasions of its PC5-RRC connected L2 U2N Remote UEs. In this case, the
DRX cycle and UE ID mentioned in this clause refer to those of the L2
U2N Remote UE.

In multi-beam operations, the UE assumes that the same paging message
and the same Short Message are repeated in all transmitted beams and
thus the selection of the beam(s) for the reception of the paging
message and Short Message is up to UE implementation. The paging message
is same for both RAN initiated paging and CN initiated paging.

The UE initiates RRC Connection Resume procedure upon receiving RAN
initiated paging. If the UE receives a CN initiated paging in
RRC\_INACTIVE state, the UE moves to RRC\_IDLE and informs NAS. However,
if a L2 U2N Relay UE in RRC\_INACTIVE state receives a CN initiated
paging for a L2 U2N Remote UE, the L2 U2N Relay UE does not move to
RRC\_IDLE state.

NOTE 0a: The L2 U2N Remote UE does not need to monitor the PO in order
to receive the paging message.

NOTE 0b: While the SDT procedure is ongoing in RRC\_INACTIVE state, the
UE monitors the PO in order to receive only the Short Message as
specified in TS 38.331 \[3\].

The PF and PO for paging are determined by the following formulae:

SFN for the PF is determined by:

(SFN + PF\_offset) mod T = (T div N)\*(UE\_ID mod N)

Index (i\_s), indicating the index of the PO is determined by:

i\_s = floor (UE\_ID/N) mod Ns

The PDCCH monitoring occasions for paging are determined according to
*pagingSearchSpace* as specified in TS 38.213 \[4\] and
*firstPDCCH-MonitoringOccasionOfPO* and
*nrofPDCCH-MonitoringOccasionPerSSB-InPO* if configured as specified in
TS 38.331 \[3\]. When *SearchSpaceId* = 0 is configured for
*pagingSearchSpace*, the PDCCH monitoring occasions for paging are same
as for RMSI as defined in clause 13 in TS 38.213 \[4\].

When *SearchSpaceId* = 0 is configured for *pagingSearchSpace***, Ns is
either 1 or 2. For Ns = 1, there is only one PO which starts from the
first PDCCH monitoring occasion for paging in the PF. For Ns = 2, PO is
either in the first half frame (i\_s = 0) or the second half frame (i\_s
= 1) of the PF.**

When *SearchSpaceId* other than 0 is configured for *pagingSearchSpace,*
the UE monitors the (i\_s + 1)^th^ PO. A PO is a set of \'S\*X \'
consecutive PDCCH monitoring occasions where \'S\' is the number of
actual transmitted SSBs determined according to *ssb-PositionsInBurst*
in *SIB1* and X is the *nrofPDCCH-MonitoringOccasionPerSSB-InPO* if
configured or is equal to 1 otherwise. The \[x\*S+K\]^th^ PDCCH
monitoring occasion for paging in the PO corresponds to the K^th^
transmitted SSB, where x=0,1,...,X-1, K=1,2,...,S. The PDCCH monitoring
occasions for paging which do not overlap with UL symbols (determined
according to *tdd-UL-DL-ConfigurationCommon*) are sequentially numbered
from zero starting from the first PDCCH monitoring occasion for paging
in the PF. When *firstPDCCH-MonitoringOccasionOfPO* is present, the
starting PDCCH monitoring occasion number of (i\_s + 1)^th^ PO is the
(i\_s + 1)^th^ value of the *firstPDCCH-MonitoringOccasionOfPO*
parameter; otherwise, it is equal to i\_s \* S\*X. If X \> 1, when the
UE detects a PDCCH transmission addressed to P-RNTI within its PO, the
UE is not required to monitor the subsequent PDCCH monitoring occasions
for this PO.

NOTE 1: A PO associated with a PF may start in the PF or after the PF.

NOTE 2: The PDCCH monitoring occasions for a PO can span multiple radio
frames. When *SearchSpaceId* other than 0 is configured for
*paging-SearchSpace* the PDCCH monitoring occasions for a PO can span
multiple periods of the paging search space.

The following parameters are used for the calculation of PF and i\_s
above:

**T: DRX cycle of the UE.**

If eDRX is not configured as defined in clause 7.4:

**-** T is determined by the shortest of the UE specific DRX value(s),
if configured by RRC and/or upper layers or provided in PC5-RRC
signalling in case of a L2 U2N Relay UE, and a default DRX value
broadcast in system information. In RRC\_IDLE state, if UE specific DRX
is not configured by upper layers, the default value is applied.

In RRC\_IDLE state, if eDRX is configured by upper layers, i.e.,
T~eDRX,\ CN~, according to clause 7.4:

\- If T~eDRX,\ CN~ is no longer than 1024 radio frames:

\- T = T~eDRX,\ CN~;

\- else:

\- During CN configured PTW, T is determined by the shortest of UE
specific DRX value, if configured by upper layers, and the default DRX
value broadcast in system information.

In RRC\_INACTIVE state, if eDRX is configured by RRC, i.e.,
T~eDRX,\ RAN~ , and/or upper layers, i.e., T~eDRX,\ CN~, as defined in
clause 7.4:

\- If both T~eDRX,\ CN~ and T~eDRX,\ RAN~ are no longer than 1024 radio
frames, T = min{T~eDRX,\ RAN~, T~eDRX,\ CN~}.

\- If T~eDRX,\ CN~ is no longer than 1024 radio frames and no
T~eDRX,\ RAN~ is configured, T is determined by the shortest of UE
specific DRX value configured by RRC and T~eDRX,\ CN~.

\- If T~eDRX,\ CN~ is longer than 1024 radio frames:

\- If T~eDRX,\ RAN~ is not configured:

\- During CN configured PTW, T is determined by the shortest of the UE
specific DRX value (s), if configured by RRC and/or upper layers, and a
default DRX value broadcast in system information. Outside the CN
configured PTW, T is determined by the UE specific DRX value configured
by RRC;

\- else if T~eDRX,\ RAN~ is no longer than 1024 radio frames:

\- During CN configured PTW, T is determined by the shortest of the UE
specific DRX value, if configured by upper layers and T~eDRX,\ RAN~, and
a default DRX value broadcast in system information. Outside the CN
configured PTW, T is determined by T~eDRX,\ RAN~.

**N: number of total paging frames in T**

Ns: number of paging **occasions** for a PF

PF\_offset: offset used for PF determination

**UE\_ID:**

If the UE operates in eDRX as specified in clause 7.4:

\- 5G-S-TMSI mod 4096

else:

\- 5G-S-TMSI mod 1024

Parameters *Ns*, *nAndPagingFrameOffset*,
*nrofPDCCH-MonitoringOccasionPerSSB-InPO*, and the length of default DRX
Cycle are signalled in *SIB1*. The values of N and PF\_offset are
derived from the parameter *nAndPagingFrameOffset* as defined in TS
38.331 \[3\]. The parameter *firstPDCCH-MonitoringOccasionOfPO* is
signalled in *SIB1* for paging in the BWP configured by
*initialDownlinkBWP*. For paging in a DL BWP other than the BWP
configured by *initialDownlinkBWP*, the parameter
*first-PDCCH-MonitoringOccasionOfPO* is signalled in the corresponding
BWP configuration.

If the UE has no 5G-S-TMSI, for instance when the UE has not yet
registered onto the network, the UE shall use as default identity UE\_ID
= 0 in the PF and i\_s formulas above.

5G-S-TMSI is a 48 bit long bit string as defined in TS 23.501 \[10\].
5G-S-TMSI shall in the formulae above be interpreted as a binary number
where the left most bit represents the most significant bit.

**In** RRC\_INACTIVE **state, if the** UE supports
*inactiveStatePO-Determination* and the network broadcasts
*ranPagingInIdlePO* with value \"true\", the UE shall use the same i\_s
as for RRC\_IDLE state. Otherwise, the UE determines the i\_s based on
the parameters and formula above.

In RRC\_INACTIVE state, if eDRX value configured by upper layers is no
longer than 1024 radio frames, the UE shall use the same i\_s as for
RRC\_IDLE state.

In RRC\_INACTIVE state, if eDRX value configured by upper layers is
longer than 1024 radio frames, during CN PTW, the UE shall use the same
i\_s as for RRC\_IDLE state.

\[TS 38.304, clause 7.2\]

The UE may use Paging Early Indication (PEI) in RRC\_IDLE and
RRC\_INACTIVE states in order to reduce power consumption. If PEI
configuration is provided in system information, the UE in RRC\_IDLE or
RRC\_INACTIVE state supporting PEI (except for the UEs expecting
multicast session activation notification) can monitor PEI using PEI
parameters in system information according to the procedure described
below.

If *lastUsedCellOnly* is configured in system information of a cell, the
UE monitors PEI in the cell only if the UE most recently received
*RRCRelease* without *noLastCellUpdate* in this cell. Otherwise (i.e.,
if *lastUsedCellOnly* is not configured in system information of a
cell), the UE monitors PEI in the camped cell.

The UE monitors one PEI occasion per DRX cycle. A PEI occasion (PEI-O)
is a set of PDCCH monitoring occasions (MOs) and can consist of multiple
time slots (e.g. subframes or OFDM symbols) where PEI can be sent (TS
38.213 \[4\]). In multi-beam operations, the UE assumes that the same
PEI is repeated in all transmitted beams and thus the selection of the
beam(s) for the reception of the PEI is up to UE implementation.

\[TS 38.304, clause 7.3.0\]

If PEI and subgrouping are configured, UEs monitoring the same PO can be
divided into one or more subgroups. With subgrouping, the UE monitors
the associated PO if the corresponding bit for subgroup the UE belongs
to is indicated as 1 by PEI corresponding to its PO, as specified in
clause 10.4a in TS 38.213 \[4\].

The following parameters are used for the determination of subgroup ID:

\- subgroupsNumPerPO: total number of subgroups for both CN assigned
subgrouping (if any) and UE\_ID based subgrouping (if any) in a PO,
which is broadcasted in system information;

\- subgroupsNumForUEID: number of subgroups for UE\_ID based subgrouping
in a PO, which is broadcasted in system information.

UE\'s subgroup can be either assigned by CN as specified in clause 7.3.1
or formed based on UE\_ID as specified in clause 7.3.2:

\- If ***subgroupsNumForUEID* is absent in** *subgroupConfig***, t**he
subgroup ID based on CN assigned subgrouping as specified in clause
7.3.1, if available for the UE, is used in the cell.

\- If both ***subgroupsNumPerPO*** **and *subgroupsNumForUEID* are
configured, and *subgroupsNumForUEID* has the same value as
*subgroupsNumPerPO*,** the subgroup ID based on UE\_ID based subgrouping
as specified in clause 7.3.2 is used in the cell.

\- If both ***subgroupsNumPerPO*** **and *subgroupsNumForUEID* are
configured, and *subgroupsNumForUEID* \< *subgroupsNumPerPO*:**

**- The subgroup ID based on CN assigned subgrouping** as specified in
clause 7.3.1, if available for the UE, is used in the cell

\- Otherwise, the subgroup ID based on UE\_ID based subgrouping as
specified in clause 7.3.2 is used in the cell.

If a UE has no CN assigned subgroup ID or does not support CN assigned
subgrouping, and there is no configuration for *subgroupsNumForUEID*,
the UE monitors the associated PO according to clause 7.1.

##### 8.1.1.1a.3.3 Test Description {#a.3.3-test-description .H6}

##### 8.1.1.1a.3.3.1 Pre-test conditions {#a.3.3.1-pre-test-conditions .H6}

##### System Simulator: {#system-simulator-4 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cell.

##### UE: {#ue-4 .H6}

\- None.

##### Preamble: {#preamble-4 .H6}

\- The UE is in 5GS state 1N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-1.

##### 8.1.1.1a.3.3.2 Test procedure sequence {#a.3.3.2-test-procedure-sequence .H6}

Table 8.1.1.1a.3.3.2-1: Main behaviour

+-----+--------------+--------------+--------------+---------+----+
| St  | Procedure    | Message      | TP           | Verdict |    |
|     |              | Sequence     |              |         |    |
+=====+==============+==============+==============+=========+====+
|     |              | U - S        | Message      |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1   | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *Paging*     |         |    |
|     | *Paging*     |              |              |         |    |
|     | message      |              |              |         |    |
|     | including a  |              |              |         |    |
|     | matched      |              |              |         |    |
|     | identity     |              |              |         |    |
|     | (correct     |              |              |         |    |
|     | ng           |              |              |         |    |
|     | -5G-S-TMSI). |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2   | Check: Does  | \--\>        | NR RRC:      | 1       | P  |
|     | the UE       |              | *RRCS        |         |    |
|     | transmit an  |              | etupRequest* |         |    |
|     | *RRCS        |              |              |         |    |
|     | etupRequest* |              |              |         |    |
|     | message?     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 3   | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCSetup*   |         |    |
|     | *RRCSetup*   |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 4   | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCSe       |         |    |
|     | *RRCSe       |              | tupComplete* |         |    |
|     | tupComplete* |              |              |         |    |
|     | message      |              | 5GMM:        |         |    |
|     | including    |              | SERVICE      |         |    |
|     | SERVICE      |              | REQUEST      |         |    |
|     | REQUEST to   |              |              |         |    |
|     | confirm the  |              |              |         |    |
|     | successful   |              |              |         |    |
|     | completion   |              |              |         |    |
|     | of the       |              |              |         |    |
|     | connection   |              |              |         |    |
|     | es           |              |              |         |    |
|     | tablishment. |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 5-8 | Steps 5 to 8 | \-           | *-*          | \-      | \- |
|     | of the NR    |              |              |         |    |
|     | RR           |              |              |         |    |
|     | C\_CONNECTED |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | \[4\] Table  |              |              |         |    |
|     | 4.5.4.2-3    |              |              |         |    |
|     | are executed |              |              |         |    |
|     | to           |              |              |         |    |
|     | successfully |              |              |         |    |
|     | complete the |              |              |         |    |
|     | service      |              |              |         |    |
|     | request      |              |              |         |    |
|     | procedure.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+

##### 8.1.1.1a.3.3.3 Specific message contents {#a.3.3.3-specific-message-contents .H6}

Table 8.1.1.1a.3.3.3-1: SIB1 for NR Cell 1 (preamble and all steps,
Table 8.1.1.1a.3.3.2-1)

  ----------------------------------------------------------------------- ------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-28 with condition PEI                                                                    
  Information Element                                                     Value/remark                                           Comment   Condition
  SIB1 ::= SEQUENCE {                                                                                                                      
  servingCellConfigCommon                                                 ServingCellConfigCommonSIB in Table 8.1.1.1a.3.3.3-2             
  }                                                                                                                                        
  ----------------------------------------------------------------------- ------------------------------------------------------ --------- -----------

Table 8.1.1.1a.3.3.3-2: ServingCellConfigCommonSIB (Table
8.1.1.1a.3.3.3-1)

  ------------------------------------------------------------------------ --------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-169 with condition PEI                                                                 
  Information Element                                                      Value/remark                                        Comment   Condition
  ServingCellConfigCommonSIB ::= SEQUENCE {                                                                                              
  downlinkConfigCommon                                                     DownlinkConfigCommonSIB in Table 8.1.1.1a.3.3.3-3             
  }                                                                                                                                      
  ------------------------------------------------------------------------ --------------------------------------------------- --------- -----------

Table 8.1.1.1a.3.3.3-3: DownlinkConfigCommonSIB (Table 8.1.1.1a.3.3.3-2)

  ----------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-53 with condition PEI                            
  Information Element                                                     Value/remark   Comment   Condition
  DownlinkConfigCommonSIB ::= SEQUENCE {                                                           
  pei-Config-r17 SEQUENCE {                                                                        
  subgroupConfig-r17 SEQUENCE {                                                                    
  subgroupsNumForUEID-r17                                                 Not Present              
  }                                                                                                
  }                                                                                                
  }                                                                                                
  ----------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.1.1a.3.3.3-4: *RRCSetupRequest* (Step 2, Table
8.1.1.1a.3.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-23                            
  Information Element                                  Value/remark   Comment   Condition
  RRCSetupRequest ::= SEQUENCE {                                                
  rrcSetupRequest SEQUENCE {                                                    
  establishmentCause                                   mt-Access                
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

#### 8.1.1.2 RRC connection establishment

##### 8.1.1.2.1 RRC connection establishment / Return to idle state after T300 expiry / connEstFailOffsetValidity / T300 expired

##### 8.1.1.2.1.1 Test Purpose (TP) {#test-purpose-tp-2 .H6}

##### (1) {#section-15 .H6}

**with** { UE in NR RRC\_IDLE state having sent an RRCSetupRequest
message }

**ensure that** {

**when** { the SS does not answer to the UE during T300 }

**then** { UE goes to RRC\_IDLE state }

}

##### (2) {#section-16 .H6}

**with** { UE in NR RRC\_IDLE state }

**ensure that** {

**when** { T300 has expired a consecutive connEstFailCount times on the
same cell for which connEstFailureControl is included in SIB1 for a
period as indicated by connEstFailOffsetValidity }

**then** { UE uses connEstFailOffset for the parameter Qoffsettemp when
performing cell reselection }

}

##### (3) {#section-17 .H6}

**with** { UE in NR RRC\_IDLE state }

**ensure that** {

**when** { connEstFailOffsetValidity has expired }

**then** { UE stops using the parameter Qoffsettemp when performing cell
reselection }

}

##### (4) {#section-18 .H6}

**with** { UE in NR RRC\_IDLE state }

**ensure that** {

**when** { UE receives a short message transmitted on PDCCH using P-RNTI
indicating a systemInfoModification }

**then** {UE re-acquires and applies the new system information }

}

##### 8.1.1.2.1.2 Conformance requirements {#conformance-requirements-2 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.3.7. Unless otherwise stated these
are Rel-15 requirements.

\[TS 38.331, clause 5.3.3.7\]

The UE shall:

1\> if timer T300 expires:

2\> reset MAC, release the MAC configuration and re-establish RLC for
all RBs that are established;

2\> if the T300 has expired a consecutive *connEstFailCount* times on
the same cell for which *connEstFailureControl* is included in *SIB1*:

3\> for a period as indicated by *connEstFailOffsetValidity*:

4\> use *connEstFailOffset* for the parameter *Qoffsettemp* for the
concerned cell when performing cell selection and reselection according
to TS 38.304 \[20\] and TS 36.304 \[27\];

NOTE: When performing cell selection, if no suitable or acceptable cell
can be found, it is up to UE implementation whether to stop using
*connEstFailOffset* for the parameter *Qoffsettemp* during
*connEstFailOffsetValidity* for the concerned cell.

2\> inform upper layers about the failure to establish the RRC
connection, upon which the procedure ends;

##### 8.1.1.2.1.3 Test description {#test-description-2 .H6}

##### 8.1.1.2.1.3.1 Pre-test conditions {#pre-test-conditions-2 .H6}

##### System Simulator: {#system-simulator-5 .H6}

\- NR Cell 1 and NR Cell 3.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cells.

##### UE: {#ue-5 .H6}

\- None.

##### Preamble: {#preamble-5 .H6}

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], clause 4.4A
on NR Cell 1 and 5G-GUTI is allocated in REGISTRATION ACCEPT.

##### 8.1.1.2.1.3.2 Test procedure sequence {#test-procedure-sequence-2 .H6}

Table 8.1.1.2.1.3.2-1/2 illustrates the downlink power levels and other
changing parameters to be applied for the NR cells at various time
instants of the test execution. The exact instants on which these values
shall be applied are described in the texts in this clause. The
configuration \"T0\" indicates the initial conditions. Subsequent
configuration marked \"T1\" is applied at the points indicated in the
Main behaviour description in Table 8.1.1.2.1.3.2-3.

Table 8.1.1.2.1.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----------+----------+---------+----------+----------+--------+
|          | P        | Unit    | NR Cell  | NR Cell  | Remark |
|          | arameter |         | 1        | 3        |        |
+==========+==========+=========+==========+==========+========+
| T0       | SS/PBCH  | dBm/SCS | -78      | Off      |        |
|          |          |         |          |          |        |
|          | SSS EPRE |         |          |          |        |
+----------+----------+---------+----------+----------+--------+
| T1       | SS/PBCH  | dBm/SCS | -78      | -88      |        |
|          |          |         |          |          |        |
|          | SSS EPRE |         |          |          |        |
+----------+----------+---------+----------+----------+--------+
| Note:    |          |         |          |          |        |
| Power    |          |         |          |          |        |
| level    |          |         |          |          |        |
| \"Off\"  |          |         |          |          |        |
| is       |          |         |          |          |        |
| defined  |          |         |          |          |        |
| in TS    |          |         |          |          |        |
| 38.508-1 |          |         |          |          |        |
| \[4\]    |          |         |          |          |        |
| Table    |          |         |          |          |        |
| 6.       |          |         |          |          |        |
| 2.2.1-3. |          |         |          |          |        |
+----------+----------+---------+----------+----------+--------+

Table 8.1.1.2.1.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+-----------+---------+-----------------+------------------+--------+
|    | Parameter | Unit    | NR Cell 1       | NR Cell 3        | Remark |
+====+===========+=========+=================+==================+========+
| T0 | SS/PBCH   | dBm/SCS | -82             | Off              |        |
|    |           |         |                 |                  |        |
|    | SSS EPRE  |         |                 |                  |        |
+----+-----------+---------+-----------------+------------------+--------+
|    | Qrxlevmin | dBm     | -91+Delta(NRf1) | \-               |        |
+----+-----------+---------+-----------------+------------------+--------+
| T1 | SS/PBCH   | dBm/SCS | -82             | -91              |        |
|    |           |         |                 |                  |        |
|    | SSS EPRE  |         |                 |                  |        |
+----+-----------+---------+-----------------+------------------+--------+
|    | Qrxlevmin | dBm     | -91+Delta(NRf1) | -100+Delta(NRf2) |        |
+----+-----------+---------+-----------------+------------------+--------+

Table 8.1.1.2.1.3.2-3: Main behaviour

  St    Procedure                                                                                                                                                                      Message Sequence   TP                                Verdict   
  ----- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ --------------------------------- --------- ----
                                                                                                                                                                                       U - S              Message                                     
  1     The SS transmits a *Paging* message including a matched ng-5G-S-TMSI.                                                                                                          \<\--              NR RRC: *Paging*                  \-        \-
  2     The UE transmits an *RRCSetupRequest* message.                                                                                                                                 \--\>              NR RRC: *RRCSetupRequest*         \-        \-
  3     The SS waits for 2s (T300 expire).                                                                                                                                             \-                 *-*                               \-        \-
  4     Check: Does UE send *RRCSetupRequest in 5 second?*                                                                                                                             \--\>              NR RRC: *RRCSetupRequest*         1         F
  5     Check: Does the test result of generic test procedure step 1-8 in TS 38.508-1 \[4\] Table 4.9.4.2.2-1 indicate that the UE is in RRC\_IDLE?                                    \-                 *-*                               1         \-
  6     SS transmits an *RRCRelease* message to release RRC connection and move the UE to RRC\_IDLE                                                                                    \<\--              NR RRC: *RRCRelease*              \-        \-
  7     The SS remove connEstFailOffset in SIB1.                                                                                                                                       \-                 \-                                \-        \-
  8     The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                  \-                 PDCCH (DCI 1\_0): Short Message   \-        \-
  8A    Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                         \-                 \-                                \-        \-
  9     Void                                                                                                                                                                           \-                 \-                                \-        \-
  10    The SS transmits a *Paging* message including a matched ng-5G-S-TMSI.                                                                                                          \<\--              NR RRC*: Paging*                  \-        \-
  11    The UE transmits an *RRCSetupRequest* message.                                                                                                                                 \--\>              *NR RRC: RRCSetupRequest*         \-        \-
  12    The SS waits for 2s to let T300 expire.                                                                                                                                        \-                 *-*                               \-        \-
  12A   The SS re-adjusts the SS levels according to row \"T1\" in table 8.1.1.2.1.3.2-1/2 and waits for 35s to allow UE to perform cell reselection.                                  \-                 *-*                               \-        \-
  13    The SS transmits a *Paging* message including a matched ng-5G-S-TMSI on NR Cell 1.                                                                                             \<\--              NR RRC*: Paging*                  \-        \-
  14    Check: Does UE send *RRCSetupRequest in 5 second?*                                                                                                                             \--\>              NR RRC: *RRCSetupRequest*         2         F
  15    Void                                                                                                                                                                           \-                 *-*                               \-        \-
  16    After expiry of connEstFailOffsetValidity, the SS waits 35s to allow UE to perform cell reselection.                                                                           \-                 *-*                               \-        \-
  17    Check: Does the test result of generic test procedure step 1-9a1 in TS 38.508-1 \[4\] Table 4.9.4.2.2-1 indicate that the UE is in RRC\_IDLE on NR Cell 1?                     \-                 *-*                               3         \-
  18    The SS changes NR Cell 3 to high priority in SIB4 and the *ValueTag* of *SIB4* in the SI-SchedulingInfo of *SIB1* is increased on NR Cell 1.                                   \-                 *-*                               \-        \-
  18A   The SS changes NR cell reselection priority of NR Cell 3 in the SIB2 of NR Cell 3 and the *ValueTag* of *SIB2* in the SI-SchedulingInfo of *SIB1* is increased on NR Cell 3.   \-                 *-*                               \-        \-
  19    The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                  \-                 PDCCH (DCI 1\_0): Short Message   \-        \-
  20    Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                         \-                 \-                                \-        \-
  21    Check: Does the test result of generic test procedure step 1-9a1 in TS 38.508-1 \[4\] Table 4.9.4.2.2-1 indicate that the UE is in RRC\_IDLE on NR Cell 3?                     \-                 *-*                               4         \-

##### 8.1.1.2.1.3.3 Specific message contents {#specific-message-contents-2 .H6}

Table 8.1.1.2.1.3.3-1: *RRCSetupRequest* (steps 2 and 11, Table
8.1.1.2.1.3.2-3)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-23                            
  Information Element                                  Value/remark   Comment   Condition
  RRCSetupRequest ::= SEQUENCE {                                                
  rrcSetupRequest SEQUENCE {                                                    
  establishmentCause                                   mt-Access                
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.1.2.1.3.3-2: *SIB1* (step 7, Table 8.1.1.2.1.3.2-3)

  ---------------------------------------------------- ----------------------- ----------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                                                   
  **Information Element**                              **Value/remark**        **Comment**             **Condition**
  SIB1 ::= SEQUENCE {                                                                                  
  connEstFailureControl                                ConnEstFailureControl   Table 8.1.1.2.1.3.3-3   
  }                                                                                                    
  ---------------------------------------------------- ----------------------- ----------------------- ---------------

Table 8.1.1.2.1.3.3-3: *ConnEstFailureControl* (Table 8.1.1.2.1.3.3-2)

  ---------------------------------------------------- ------------------ ------------------------------------------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-27                                                                              
  **Information Element**                              **Value/remark**   **Comment**                                             **Condition**
  ConnEstFailureControl ::= SEQUENCE {                                                                                            
  connEstFailOffsetValidity                            s60                                                                        
  connEstFailOffset                                    Not present        Value of infinity shall be used for **Qoffset~temp~**   
  }                                                                                                                               
  ---------------------------------------------------- ------------------ ------------------------------------------------------- ---------------

Table 8.1.1.2.1.3.3-4: *SIB4 of NR Cell 1* (steps 18, Table
8.1.1.2.1.3.2-3)

+-------------------+--------------+-------------------+-----------+
| Derivation Path:  |              |                   |           |
| TS 38.508-1 \[4\] |              |                   |           |
| Table 4.6.2-3     |              |                   |           |
+===================+==============+===================+===========+
| Information       | Value/remark | Comment           | Condition |
| Element           |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| SIB4 ::= SEQUENCE |              |                   |           |
| {                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+
|                   | 1 entry      |                   |           |
| interFr           |              |                   |           |
| eqCarrierFreqList |              |                   |           |
| SEQUENCE (SIZE    |              |                   |           |
| (1..maxFreq)) OF  |              |                   |           |
| InterFr           |              |                   |           |
| eqCarrierFreqInfo |              |                   |           |
| {                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| InterFreqCar      |              | entry 1           |           |
| rierFreqInfo\[1\] |              |                   |           |
| SEQUENCE {        |              | The entry         |           |
|                   |              | corresponding to  |           |
|                   |              | the carrier of NR |           |
|                   |              | Cell 3            |           |
+-------------------+--------------+-------------------+-----------+
| cellRe            | 7            | Higer priority    |           |
| selectionPriority |              | than NR Cell 1    |           |
+-------------------+--------------+-------------------+-----------+
| }                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| }                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| }                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+

Table 8.1.1.2.1.3.3-5: *SIB2 of NR Cell 3* (steps 18A, Table
8.1.1.2.1.3.2-3)

  --------------------------------------------------- -------------- ------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-1                                                  
  Information Element                                 Value/remark   Comment                         Condition
  SIB2::= SEQUENCE {                                                                                 
  cellReselectionServingFreqInfo SEQUENCE{                                                           
  cellReselectionPriority                             7              Higer priority than NR Cell 1   
  }                                                                                                  
  }                                                                                                  
  --------------------------------------------------- -------------- ------------------------------- -----------

Table 8.1.1.2.1.3.3-6: *SIB1 of NR Cell 1 (Step 18),* Table
8.1.1.2.1.3.2-3*)*

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                                 
  ---------------------------------------------------- ------------------- --------- -----------
  Information Element                                  Value/remark        Comment   Condition
  SIB1 ::= SEQUENCE {                                                                
  si-SchedulingInfo                                    SI-SchedulingInfo             
  }                                                                                  

Table 8.1.1.2.1.3.3-7: SI-SchedulingInfo (si-SchedulingInfo in Table
8.1.1.2.1.3.3-6)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-173                                                 
  -------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                        Value/remark   Comment   Condition
  SI-SchedulingInfo ::= SEQUENCE {                                                                    
  schedulingInfoList SEQUENCE (SIZE(1..maxSI-Message)) OF SchedulingInfo {   1 entry                  
  SchedulingInfo\[1\] SEQUENCE {                                                            entry 1   
  sib-MappingInfo SEQUENCE (SIZE (1..maxSIB)) OF SIB-TypeInfo {              2 entries                
  SIB-TypeInfo\[1\] SEQUENCE {                                                              entry 1   
  Type\[1\]                                                                  sibType2                 
  valueTag\[1\]                                                              0                        
  }                                                                                                   
  SIB-TypeInfo\[1\] SEQUENCE {                                                              entry 2   
  Type\[1\]                                                                  sibType4                 
  valueTag\[1\]                                                              1                        
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   

Table 8.1.1.2.1.3.3-8: *SIB1 of NR Cell 3 (Step 18A),* Table
8.1.1.2.1.3.2-3*)*

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                                 
  ---------------------------------------------------- ------------------- --------- -----------
  Information Element                                  Value/remark        Comment   Condition
  SIB1 ::= SEQUENCE {                                                                
  si-SchedulingInfo                                    SI-SchedulingInfo             
  }                                                                                  

Table 8.1.1.2.1.3.3-9: SI-SchedulingInfo (si-SchedulingInfo in Table
8.1.1.2.1.3.3-8)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-173                                                 
  -------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                        Value/remark   Comment   Condition
  SI-SchedulingInfo ::= SEQUENCE {                                                                    
  schedulingInfoList SEQUENCE (SIZE(1..maxSI-Message)) OF SchedulingInfo {   1 entry                  
  SchedulingInfo\[1\] SEQUENCE {                                                            entry 1   
  sib-MappingInfo SEQUENCE (SIZE (1..maxSIB)) OF SIB-TypeInfo {              2 entries                
  SIB-TypeInfo\[1\] SEQUENCE {                                                              entry 1   
  Type\[1\]                                                                  sibType2                 
  valueTag\[1\]                                                              1                        
  }                                                                                                   
  SIB-TypeInfo\[1\] SEQUENCE {                                                              entry 2   
  Type\[1\]                                                                  sibType4                 
  valueTag\[1\]                                                              0                        
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   

##### 8.1.1.2.2 Void

##### 8.1.1.2.3 RRC connection establishment / RRC Reject with wait time

##### 8.1.1.2.3.1 Test Purpose (TP) {#test-purpose-tp-3 .H6}

##### (1) {#section-19 .H6}

with { UE in NR RRC\_IDLE state and has sent an RRCSetupRequest message
}

ensure that {

when { UE receives an RRCReject message including an IE waitTime }

then { UE doesn\'t re-send RRCSetupRequest message before the waitTime
is expired }

}

##### 8.1.1.2.3.2 Conformance requirements {#conformance-requirements-3 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.15.2.

\[TS 38.331, clause 5.3.15.2\]

The UE shall:

1\> stop timer T300, if running;

1\> stop timer T319, if running;

1\> stop timer T302, if running;

1\> reset MAC and release the default MAC Cell Group configuration;

1\> if *waitTime* is configured in the *RRCReject*:

2\> start timer T302, with the timer value set to the *waitTime*;

1\> if *RRCReject* is received in response to a request from upper
layers:

2\> inform the upper layer that access barring is applicable for all
access categories except categories \'0\' and \'2\';

1\> if *RRCReject* is received in response to an *RRCSetupRequest*:

2\> inform upper layers about the failure to setup the RRC connection,
upon which the procedure ends;

1\> else if *RRCReject* is received in response to an *RRCResumeRequest*
or an *RRCResumeRequest1*:

2\> if resume is triggered by upper layers:

3\> inform upper layers about the failure to resume the RRC connection;

2\> if resume is triggered due to an RNA update:

3\> set the variable *pendingRnaUpdate* to *true*;

2\> discard the current K~gNB~ key, the K~RRCenc~ key, the K~RRCint~
key, the K~UPint~ key and the K~UPenc~ key derived in accordance with
5.3.13.3;

2\> suspend SRB1, upon which the procedure ends;

The RRC\_INACTIVE UE shall continue to monitor paging while the timer
T302 is running.

##### 8.1.1.2.3.3 Test Description {#test-description-3 .H6}

##### 8.1.1.2.3.3.1 Pre-test conditions {#pre-test-conditions-3 .H6}

##### System Simulator: {#system-simulator-6 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell.

##### UE: {#ue-6 .H6}

\- None.

##### Preamble: {#preamble-6 .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3 and Test Loop Function (On) with UE test loop mode
B is established.

##### 8.1.1.2.3.3.2 Test procedure sequence {#test-procedure-sequence-3 .H6}

Table 8.1.1.2.3.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \-        | *-*       | \-      | \- |
|           | transmits |           |           |         |    |
|           | one IP    |           |           |         |    |
|           | packet to |           |           |         |    |
|           | the UE on |           |           |         |    |
|           | the DRB   |           |           |         |    |
|           | a         |           |           |         |    |
|           | ssociated |           |           |         |    |
|           | with the  |           |           |         |    |
|           | first PDU |           |           |         |    |
|           | session   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | Wait for  | \-        | *-*       | \-      | \- |
|           | 1 second  |           |           |         |    |
|           | after the |           |           |         |    |
|           | IP packet |           |           |         |    |
|           | has been  |           |           |         |    |
|           | tr        |           |           |         |    |
|           | ansmitted |           |           |         |    |
|           | in step   |           |           |         |    |
|           | 1. (Note  |           |           |         |    |
|           | 1)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4-4A      | Steps 1-2 | \-        | \-        | \-      | \- |
|           | of the NR |           |           |         |    |
|           | RRC\_     |           |           |         |    |
|           | CONNECTED |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in table  |           |           |         |    |
|           | 4.5.4.2-3 |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.5      |           |           |         |    |
|           | 08-1\[4\] |           |           |         |    |
|           | are       |           |           |         |    |
|           | p         |           |           |         |    |
|           | erformed. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | responds  |           | *R        |         |    |
|           | with      |           | RCReject* |         |    |
|           | *R        |           |           |         |    |
|           | RCReject* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with IE   |           |           |         |    |
|           | *         |           |           |         |    |
|           | waitTime* |           |           |         |    |
|           | set to    |           |           |         |    |
|           | 10s.      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | Check:    | \--\>     | NR RRC:   | 1       | F  |
|           | Does the  |           | *RRCSetu  |         |    |
|           | UE        |           | pRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RRCSetu  |           |           |         |    |
|           | pRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | while     |           |           |         |    |
|           | timer     |           |           |         |    |
|           | T302 is   |           |           |         |    |
|           | running?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6A        | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | timer     |           |           |         |    |
|           | Timer\_1  |           |           |         |    |
|           | = 10 s.   |           |           |         |    |
|           | (Note 4)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | E         | \-        | \-        | \-      | \- |
|           | XCEPTION: |           |           |         |    |
|           | Steps     |           |           |         |    |
|           | 15a1 to   |           |           |         |    |
|           | 15b1      |           |           |         |    |
|           | describe  |           |           |         |    |
|           | a         |           |           |         |    |
|           |           |           |           |         |    |
|           | tr        |           |           |         |    |
|           | ansaction |           |           |         |    |
|           | that      |           |           |         |    |
|           | depends   |           |           |         |    |
|           | on the UE |           |           |         |    |
|           | b         |           |           |         |    |
|           | ehaviour; |           |           |         |    |
|           |           |           |           |         |    |
|           | the       |           |           |         |    |
|           | \"lower   |           |           |         |    |
|           | case      |           |           |         |    |
|           | letter\"  |           |           |         |    |
|           | i         |           |           |         |    |
|           | dentifies |           |           |         |    |
|           | a step    |           |           |         |    |
|           |           |           |           |         |    |
|           | sequence  |           |           |         |    |
|           | that      |           |           |         |    |
|           | takes     |           |           |         |    |
|           | place if  |           |           |         |    |
|           | a         |           |           |         |    |
|           | specific  |           |           |         |    |
|           |           |           |           |         |    |
|           | behaviour |           |           |         |    |
|           | happens.  |           |           |         |    |
|           | (Note 3)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7-14      | Void      | \-        | \-        | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 15a1      | Ch        | \-        | NR RRC:   | 1       | P  |
|           | eck: Does |           | *RRCSetu  |         |    |
|           | UE        |           | pRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | *RRCSet   |           |           |         |    |
|           | upRequest |           |           |         |    |
|           | message*  |           |           |         |    |
|           | for       |           |           |         |    |
|           | sending   |           |           |         |    |
|           | the IP    |           |           |         |    |
|           | packet    |           |           |         |    |
|           | received  |           |           |         |    |
|           | in step 1 |           |           |         |    |
|           | after     |           |           |         |    |
|           | timer     |           |           |         |    |
|           | T302      |           |           |         |    |
|           | expires?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15a2-15a6 | Steps 3   | \-        | *-*       | \-      | \- |
|           | to 7 of   |           |           |         |    |
|           | the NR    |           |           |         |    |
|           | RRC\_     |           |           |         |    |
|           | CONNECTED |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.5.4.2-3 |           |           |         |    |
|           | are       |           |           |         |    |
|           | executed. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | E         | \-        | *-*       | \-      | \- |
|           | XCEPTION: |           |           |         |    |
|           | Steps     |           |           |         |    |
|           | 15a7 and  |           |           |         |    |
|           | 15a8 can  |           |           |         |    |
|           | occur in  |           |           |         |    |
|           | any       |           |           |         |    |
|           | order.    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15a7      | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCReconf |         |    |
|           | *         |           | iguration |         |    |
|           | RRCReconf |           | Complete* |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on Cell   |           |           |         |    |
|           | 1.        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15a8      | The UE    | \-        | *-*       | \-      | \- |
|           | loop      |           |           |         |    |
|           | backs the |           |           |         |    |
|           | IP packet |           |           |         |    |
|           | received  |           |           |         |    |
|           | in step 1 |           |           |         |    |
|           | on the    |           |           |         |    |
|           | DRB       |           |           |         |    |
|           | a         |           |           |         |    |
|           | ssociated |           |           |         |    |
|           | with the  |           |           |         |    |
|           | first PDU |           |           |         |    |
|           | session   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15a9      | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | R         |         |    |
|           | an        |           | RCRelease |         |    |
|           | R         |           |           |         |    |
|           | RCRelease |           |           |         |    |
|           | message   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15b1      | The SS    | \-        | \-        | \-      | \- |
|           | waits for |           |           |         |    |
|           | Timer\_1  |           |           |         |    |
|           | expiry    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| The 1     |           |           |           |         |    |
| second    |           |           |           |         |    |
| delay is  |           |           |           |         |    |
| used to   |           |           |           |         |    |
| secure    |           |           |           |         |    |
| that the  |           |           |           |         |    |
| UE has    |           |           |           |         |    |
| received  |           |           |           |         |    |
| and       |           |           |           |         |    |
| forwarded |           |           |           |         |    |
| the IP    |           |           |           |         |    |
| Packet    |           |           |           |         |    |
| tr        |           |           |           |         |    |
| ansmitted |           |           |           |         |    |
| by the SS |           |           |           |         |    |
| in step 1 |           |           |           |         |    |
| to the UE |           |           |           |         |    |
| test loop |           |           |           |         |    |
| function  |           |           |           |         |    |
| before    |           |           |           |         |    |
| the       |           |           |           |         |    |
| *RR       |           |           |           |         |    |
| CRelease* |           |           |           |         |    |
| message   |           |           |           |         |    |
| is sent   |           |           |           |         |    |
| by the SS |           |           |           |         |    |
| in step   |           |           |           |         |    |
| 3.        |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 2:   |           |           |           |         |    |
| Void      |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 3: A |           |           |           |         |    |
| UE may or |           |           |           |         |    |
| may not   |           |           |           |         |    |
| send      |           |           |           |         |    |
| RRCSet    |           |           |           |         |    |
| upRequest |           |           |           |         |    |
| for the   |           |           |           |         |    |
| pending   |           |           |           |         |    |
| data sent |           |           |           |         |    |
| at step   |           |           |           |         |    |
| 1.        |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 4:   |           |           |           |         |    |
| Timer\_1  |           |           |           |         |    |
| is an     |           |           |           |         |    |
| arbitrary |           |           |           |         |    |
| timer to  |           |           |           |         |    |
| check     |           |           |           |         |    |
| whether   |           |           |           |         |    |
| the UE    |           |           |           |         |    |
| sends     |           |           |           |         |    |
| RRCSet    |           |           |           |         |    |
| upRequest |           |           |           |         |    |
| or not.   |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.1.2.3.3.3 Specific message contents {#specific-message-contents-3 .H6}

Table 8.1.1.2.3.3.3-1: *RRCReject* (step 5, table 8.1.1.2.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-15                               
  --------------------------------------------------- -------------- ------------ -----------
  Information Element                                 Value/remark   Comment      Condition
  RRCReject ::= SEQUENCE {                                                        
  criticalExtensions CHOICE {                                                     
  rrcReject SEQUENCE {                                                            
  waitTime                                            10             10 seconds   
  }                                                                               
  }                                                                               
  }                                                                               

Table 8.1.1.2.3.3.3-2: CLOSE UE TEST LOOP (Preamble, Table
8.1.1.2.3.3.2-1)

  ------------------------------------------------------------------------------- ---------------- ----------- -----------
  Derivation Path: TS 36.508 \[7\], Table 4.7A-3, condition UE TEST LOOP MODE B                                
  Information Element                                                             Value/remark     Comment     Condition
  UE test loop mode B LB setup                                                                                 
  IP PDU delay                                                                    \'0000 0101\'B   5 seconds   
  ------------------------------------------------------------------------------- ---------------- ----------- -----------

Table 8.1.1.2.3.3.3-3: SERVICE REQUEST (Step 15a3, Table
8.1.1.2.3.3.2-1)

  --------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1\[4\], Table 4.7.1-16                            
  Information Element                                 Value/remark   Comment   Condition
  Service type                                        \'0001\'B      data      
  --------------------------------------------------- -------------- --------- -----------

##### 8.1.1.2.4 RRC connection establishment / Extended value, spare fields and non-critical extensions in SI

##### 8.1.1.2.4.1 Test Purpose (TP) {#test-purpose-tp-4 .H6}

##### (1) {#section-20 .H6}

**with** { UE is powered on and receives system information }

**ensure that** {

**when** { system information messages include extended value / spare
field / non-critical extension that is not defined in the version of the
ASN.1 transfer syntax supported by the UE }

**then** { UE considers the extended value / spare field / non-critical
extension as not comprehended, treats the system information messages as
if those fields were absent and UE establishes an RRC connection }

}

##### 8.1.1.2.4.2 Conformance requirements {#conformance-requirements-4 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.2.2.3.1, 10.1, 10.3, 10.5 and A.3.3.
Unless otherwise stated, these are Rel-15 requirements.

\[TS 38.331, clause 5.2.2.3.1\]

The UE shall:

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> if the UE is in RRC\_IDLE or in RRC\_INACTIVE; or

1\> if the UE is in RRC\_CONNECTED while T311 is running:

2\> acquire the *MIB,* which is scheduled as specified in TS 38.213
\[13\];

2\> if the UE is unable to acquire the *MIB*;

3\> perform the actions as specified in clause 5.2.2.5;

2\> else:

3\> perform the actions specified in clause 5.2.2.4.1.

1\> if the UE is in RRC\_CONNECTED with an active BWP with common search
space configured by *searchSpaceSIB1* and *pagingSearchSpace* and has
received an indication about change of system information; or

1\> if the UE is in RRC\_IDLE or in RRC\_INACTIVE; or

1\> if the UE is in RRC\_CONNECTED while T311 is running:

2\> if *ssb-SubcarrierOffset* indicates *SIB1* is transmitted in the
cell (TS 38.213 \[13\]) and if *SIB1* acquisition is required for the
UE:

3\> acquire the *SIB1,* which is scheduled as specified in TS 38.213
\[13\];

3\> if the UE is unable to acquire the *SIB1*:

4\> perform the actions as specified in clause 5.2.2.5;

3\> else:

4\> upon acquiring *SIB1*, perform the actions specified in clause
5.2.2.4.2.

2\> else if *SIB1* acquisition is required for the UE and
*ssb-SubcarrierOffset* indicates that *SIB1* is not scheduled in the
cell:

3\> perform the actions as specified in clause 5.2.2.5.

NOTE: The UE in RRC\_CONNECTED is only required to acquire broadcasted
*SIB1* if the UE can acquire it without disrupting unicast data
reception, i.e. the broadcast and unicast beams are quasi co-located.

\[TS 38.331, clause 10.1\]

The generic error handling defined in the subsequent clauses applies
unless explicitly specified otherwise e.g. within the procedure specific
error handling.

The UE shall consider a value as not comprehended when it is set:

\- to an extended value that is not defined in the version of the
transfer syntax supported by the UE;

\- to a spare or reserved value unless the specification defines
specific behaviour that the UE shall apply upon receiving the concerned
spare/reserved value.

The UE shall consider a field as not comprehended when it is defined:

\- as spare or reserved unless the specification defines specific
behaviour that the UE shall apply upon receiving the concerned
spare/reserved field.

\[TS 38.331 clause 10.3\]

The UE shall, when receiving an RRC message on any logical channel:

1\> if the message includes a field that has a value that the UE does
not comprehend:

2\> if a default value is defined for this field:

3\> treat the message while using the default value defined for this
field;

2\> else if the concerned field is optional:

3\> treat the message as if the field were absent and in accordance with
the need code for absence of the concerned field;

2\> else:

> 3\> treat the message as if the field were absent and in accordance
> with clause 10.4.

\[TS 38.331 clause 10.5\]

The UE shall, when receiving an RRC message on any logical channel:

1\> if the message includes a field that the UE does not comprehend:

2\> treat the rest of the message as if the field was absent.

NOTE: This clause does not apply to the case of an extension to the
value range of a field. Such cases are addressed instead by the
requirements in clause 10.3.

\[TS 38.331 clause A.3.3\]

Each PDU (message) type is specified in an ASN.1 section similar to the
one shown in the example below.

\-- /example/ ASN1START

RRCConnectionReconfiguration ::= SEQUENCE {

rrc-TransactionIdentifier RRC-TransactionIdentifier,

criticalExtensions CHOICE {

c1 CHOICE{

rrcConnectionReconfiguration-r8 RRCConnectionReconfiguration-r8-IEs,

spare3 NULL, spare2 NULL, spare1 NULL

},

criticalExtensionsFuture SEQUENCE {}

}

}

RRCConnectionReconfiguration-r8-IEs ::= SEQUENCE {

\-- Enter the IEs here.

\...

}

\-- ASN1STOP

Hooks for *critical* and *non-critical* extension should normally be
included in the PDU type specification. How these hooks are used is
further described in clause A.4.

Critical extensions are characterised by a redefinition of the PDU
contents and need to be governed by a mechanism for protocol version
agreement between the encoder and the decoder of the PDU, such that the
encoder is prevented from sending a critically extended version of the
PDU type, which is not comprehended by the decoder.

Critical extension of a PDU type is facilitated by a two-level CHOICE
structure, where the alternative PDU contents are alternatives within
the inner level *c1* CHOICE. Spare alternatives (i.e., *spare3* down to
*spare1* in this case) may be included within the *c1* CHOICE. The
number of spare alternatives to be included in the original PDU
specification should be decided case by case, based on the expected rate
of critical extension in the future releases of the protocol.

Further critical extension, when the spare alternatives from the
original specifications are used up, is facilitated using the
*criticalExtensionsFuture* in the outer level CHOICE.

In PDU types where critical extension is not expected in the future
releases of the protocol, the inner level *c1* CHOICE and the spare
alternatives may be excluded, as shown in the example below.

\-- /example/ ASN1START

RRCConnectionReconfigurationComplete ::= SEQUENCE {

rrc-TransactionIdentifier RRC-TransactionIdentifier,

criticalExtensions CHOICE {

rrcConnectionReconfigurationComplete-r8

RRCConnectionReconfigurationComplete-r8-IEs,

criticalExtensionsFuture SEQUENCE {}

}

}

RRCConnectionReconfigurationComplete-r8-IEs ::= SEQUENCE {

\-- Enter the fields here.

\...

}

\-- ASN1STOP

Non-critical extensions are characterised by the addition of new
information to the original specification of the PDU type. If not
comprehended, a non-critical extension may be skipped by the decoder,
whilst the decoder is still able to complete the decoding of the
comprehended parts of the PDU contents.

Non-critical extensions at locations other than the end of the message
or other than at the end of a field contained in a BIT or OCTET STRING
are facilitated by use of the ASN.1 extension marker \"\...\". The
original specification of a PDU type should normally include the
extension marker at the end of the sequence of information elements
contained.

Non-critical extensions at the end of the message or at the end of a
field that is contained in a BIT or OCTET STRING may be facilitated by
use of an empty sequence that is marked OPTIONAL e.g. as shown in the
following example:

\-- /example/ ASN1START

RRCMessage-r8-IEs ::= SEQUENCE {

field1 InformationElement1,

field2 InformationElement2,

nonCriticalExtension SEQUENCE {} OPTIONAL

}

\-- ASN1STOP

The ASN.1 section specifying the contents of a PDU type may be followed
by a *field description* table where a further description of, e.g., the
semantic properties of the fields may be included. The general format of
this table is shown in the example below. The field description table is
absent in case there are no fields for which further description needs
to be provided e.g. because the PDU does not include any fields, or
because an IE is defined for each field while there is nothing specific
regarding the use of this IE that needs to be specified.

+-----------------------------------------------+
| ***%PDU-TypeIdentifier%* field descriptions** |
+===============================================+
| ***%field identifier%***                      |
|                                               |
| Field description.                            |
+-----------------------------------------------+
| ***%field identifier%***                      |
|                                               |
| Field description.                            |
+-----------------------------------------------+

The field description table has one column. The header row shall contain
the ASN.1 type identifier of the PDU type.

The following rows are used to provide field descriptions. Each row
shall include a first paragraph with a *field identifier* (in ***bold
and italic*** font style) referring to the part of the PDU to which it
applies. The following paragraphs at the same row may include (in
regular font style), e.g., semantic description, references to other
specifications and/or specification of value units, which are relevant
for the particular part of the PDU.

The parts of the PDU contents that do not require a field description
shall be omitted from the field description table.

##### 8.1.1.2.4.3 Test description {#test-description-4 .H6}

##### 8.1.1.2.4.3.1 Pre-test conditions {#pre-test-conditions-4 .H6}

##### System Simulator: {#system-simulator-7 .H6}

\- NR Cell 1.

##### UE: {#ue-7 .H6}

None.

##### Preamble: {#preamble-7 .H6}

\- The UE is switched off.

##### 8.1.1.2.4.3.2 Test procedure sequence {#test-procedure-sequence-4 .H6}

Table 8.1.1.2.4.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | System    | \<\--     | NR RRC:   | \-      | \- |
|           | in        |           | SYSTEM    |         |    |
|           | formation |           | IN        |         |    |
|           | messages, |           | FORMATION |         |    |
|           | that      |           | (BCCH)    |         |    |
|           | include   |           |           |         |    |
|           | fields    |           |           |         |    |
|           | and       |           |           |         |    |
|           | values    |           |           |         |    |
|           | that the  |           |           |         |    |
|           | UE does   |           |           |         |    |
|           | not       |           |           |         |    |
|           | co        |           |           |         |    |
|           | mprehend, |           |           |         |    |
|           | are       |           |           |         |    |
|           | br        |           |           |         |    |
|           | oadcasted |           |           |         |    |
|           | on BCCH.  |           |           |         |    |
|           |           |           |           |         |    |
|           | (Notes 1  |           |           |         |    |
|           | to 4)     |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The UE is | \-        | \-        | \-      | \- |
|           | switched  |           |           |         |    |
|           | on.       |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | Check:    | \--\>     | *NR RRC:  | 1       | P  |
|           | Does the  |           | RRCSetu   |         |    |
|           | UE        |           | pRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RRCSetu  |           |           |         |    |
|           | pRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1?   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | RRCSetup* |         |    |
|           | an        |           |           |         |    |
|           | *         |           |           |         |    |
|           | RRCSetup* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | Check:    | \--\>     | *NR RRC:  | 1       | P  |
|           | Does the  |           | RRCSetup  |         |    |
|           | UE        |           | Complete* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           | 5GMM:     |         |    |
|           | *RRCSetup |           | REG       |         |    |
|           | Complete* |           | ISTRATION |         |    |
|           | message   |           | REQUEST   |         |    |
|           | to        |           |           |         |    |
|           | confirm   |           |           |         |    |
|           | the       |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of the    |           |           |         |    |
|           | c         |           |           |         |    |
|           | onnection |           |           |         |    |
|           | esta      |           |           |         |    |
|           | blishment |           |           |         |    |
|           | and       |           |           |         |    |
|           | initiates |           |           |         |    |
|           | the       |           |           |         |    |
|           | reg       |           |           |         |    |
|           | istration |           |           |         |    |
|           | procedure |           |           |         |    |
|           | by        |           |           |         |    |
|           | including |           |           |         |    |
|           | the       |           |           |         |    |
|           | REG       |           |           |         |    |
|           | ISTRATION |           |           |         |    |
|           | REQUEST   |           |           |         |    |
|           | message?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6-21a1    | Steps 5   | \-        | \-        | \-      | \- |
|           | to 20a1   |           |           |         |    |
|           | of the    |           |           |         |    |
|           | reg       |           |           |         |    |
|           | istration |           |           |         |    |
|           | procedure |           |           |         |    |
|           | described |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.5.2.2-2 |           |           |         |    |
|           | are       |           |           |         |    |
|           | performed |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| The       |           |           |           |         |    |
| co        |           |           |           |         |    |
| mbination |           |           |           |         |    |
| NR-2 in   |           |           |           |         |    |
| Table     |           |           |           |         |    |
| 4.        |           |           |           |         |    |
| 4.3.1.2-1 |           |           |           |         |    |
| of TS     |           |           |           |         |    |
| 38.508-1  |           |           |           |         |    |
| \[4\] is  |           |           |           |         |    |
| used with |           |           |           |         |    |
| SIB1      |           |           |           |         |    |
| according |           |           |           |         |    |
| to Table  |           |           |           |         |    |
| 8.1.1.2   |           |           |           |         |    |
| .4.3.3-2A |           |           |           |         |    |
| and       |           |           |           |         |    |
| *         |           |           |           |         |    |
| SystemInf |           |           |           |         |    |
| ormation* |           |           |           |         |    |
| according |           |           |           |         |    |
| to Table  |           |           |           |         |    |
| 8.1.1.2   |           |           |           |         |    |
| .4.3.3-2. |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 2:   |           |           |           |         |    |
| MIB       |           |           |           |         |    |
| content   |           |           |           |         |    |
| covers    |           |           |           |         |    |
| the       |           |           |           |         |    |
| handling  |           |           |           |         |    |
| of spare  |           |           |           |         |    |
| field in  |           |           |           |         |    |
| UE up to  |           |           |           |         |    |
| Rel-17.   |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 3:   |           |           |           |         |    |
| *         |           |           |           |         |    |
| SystemInf |           |           |           |         |    |
| ormation* |           |           |           |         |    |
| covers    |           |           |           |         |    |
| the       |           |           |           |         |    |
| handling  |           |           |           |         |    |
| of        |           |           |           |         |    |
| non-c     |           |           |           |         |    |
| ritically |           |           |           |         |    |
| extended  |           |           |           |         |    |
| field in  |           |           |           |         |    |
| UE up to  |           |           |           |         |    |
| Rel-17.   |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 4:   |           |           |           |         |    |
| SIB1      |           |           |           |         |    |
| content   |           |           |           |         |    |
| covers    |           |           |           |         |    |
| the       |           |           |           |         |    |
| handling  |           |           |           |         |    |
| of spare  |           |           |           |         |    |
| value and |           |           |           |         |    |
| *non      |           |           |           |         |    |
| CriticalE |           |           |           |         |    |
| xtension* |           |           |           |         |    |
| in UE up  |           |           |           |         |    |
| to        |           |           |           |         |    |
| Rel-17.   |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### **8.1.1.2.4.3.3 Specific message contents** {#specific-message-contents-4 .H6}

Table 8.1.1.2.4.3.3-1: *MIB* (step 1, Table 8.1.1.2.4.3.2-1)

  -------------------------------------------- -------------- ------------------------------------------------------------------------------------------ ------------------
  Derivation Path: TS 38.508-1 Table 4.6.1-6                                                                                                             
  Information Element                          Value/remark   Comment                                                                                    Condition
  MIB ::= SEQUENCE {                                                                                                                                     
  spare                                        '1'B           In Rel-15 to Rel-17, the lowest bit is considered a spare according to TS 38.331 \[12\].   Rel-15 to Rel-17
  }                                                                                                                                                      
  -------------------------------------------- -------------- ------------------------------------------------------------------------------------------ ------------------

Table 8.1.1.2.4.3.3-2: *SystemInformation* (step 1, Table
8.1.1.2.4.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1, Table |                 |                 |           |
| 4.6.1-29        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Sy              |                 |                 |           |
| stemInformation |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sy              |                 |                 |           |
| stemInformation |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sib-TypeAndInfo | 2 entries       |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..maxSIB)) OF |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sib2            | SIB2            | entry 1         |           |
+-----------------+-----------------+-----------------+-----------+
| sib22-v1800     | SIB22 (Table    | entry 2         |           |
|                 | 8               |                 |           |
|                 | .1.1.2.4.3.3-4) | For Rel-15 to   |           |
|                 |                 | Rel-17 UE,      |           |
|                 |                 | SIB22 is        |           |
|                 |                 | considered as a |           |
|                 |                 | not             |           |
|                 |                 | comprehended,   |           |
|                 |                 | non-critically  |           |
|                 |                 | extended field  |           |
|                 |                 | according to TS |           |
|                 |                 | 38.331 \[12\].  |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| lateNonCr       | Not present     |                 |           |
| iticalExtension |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| nonCr           | Not present     |                 |           |
| iticalExtension |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.1.2.4.3.3-2A: *SIB1* (step 1, Table 8.1.1.2.4.3.2-1)

  --------------------------------------------------------------------------- ------------------- ------------------------------------------------------------------------------------------------------------ -----------
  Derivation Path: TS 38.508-1, Table 4.6.1-28                                                                                                                                                                 
  Information Element                                                         Value/remark        Comment                                                                                                      Condition
  SIB1 ::= SEQUENCE {                                                                                                                                                                                          
  si-SchedulingInfo::= SEQUENCE {                                             SI-SchedulingInfo                                                                                                                
  schedulingInfoList SEQUENCE (SIZE (1..maxSI-Message)) OF SchedulingInfo {   1 entry                                                                                                                          
  SchedulingInfo\[1\] SEQUENCE {                                                                  entry 1                                                                                                      
  si-BroadcastStatus                                                          broadcasting                                                                                                                     
  si-Periodicity                                                              rf32                                                                                                                             
  sib-MappingInfo SEQUENCE (SIZE (1..maxSIB)) OF SIB-TypeInfo {               2 entries                                                                                                                        
  SIB-TypeInfo\[1\] SEQUENCE {                                                                    entry 1                                                                                                      
  type                                                                        sibType2                                                                                                                         
  valueTag                                                                    0                                                                                                                                
  areaScope                                                                   Not present                                                                                                                      
  }                                                                                                                                                                                                            
  SIB-TypeInfo\[2\] SEQUENCE {                                                                    entry 2                                                                                                      
  type                                                                        spare3              To simulate an extended SI that is considered as a not comprehended spare value for a Rel-15 to Rel-17 UE.   
  valueTag                                                                    0                                                                                                                                
  areaScope                                                                   Not present                                                                                                                      
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  nonCriticalExtension SEQUENCE {                                                                 SIB1-v1610-IEs                                                                                               
  nonCriticalExtension SEQUENCE {                                                                 SIB1-v1630-IEs                                                                                               
  nonCriticalExtension SEQUENCE {                                                                 SIB1-v1700-IEs                                                                                               
  nonCriticalExtension SEQUENCE {                                                                 SIB1-v1740-IEs                                                                                               
  nonCriticalExtension SEQUENCE {                                                                 SIB1-v1800-IEs                                                                                               
  ncr-Support-r18                                                             true                To simulate handling of a not comprehended nonCriticalExtension for a Rel-15 to Rel-17 UE.                   
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  }                                                                                                                                                                                                            
  --------------------------------------------------------------------------- ------------------- ------------------------------------------------------------------------------------------------------------ -----------

Table 8.1.1.2.4.3.3-3: *Void*

Table 8.1.1.2.4.3.3-4: SIB22 (Table 8.1.1.2.4.3.3-2)

  ---------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1, Table 4.6.2-21                            
  Information Element                            Value/remark   Comment   Condition
  SIB22-r18 ::= SEQUENCE {                                                
  atg-Config-r18                                 Not present              
  hs-ATG-cellReselectionSet-r18                  Not present              
  atg-NeighCellConfigList-r18                    Not present              
  lateNonCriticalExtension                       Not present              
  }                                                                       
  ---------------------------------------------- -------------- --------- -----------

##### 8.1.1.2.5 RRC connection establishment / MUSIM / early indication

##### 8.1.1.2.5.1 Test Purpose (TP) {#test-purpose-tp-5 .H6}

##### (1) {#section-21 .H6}

**with { UE received *SIB1* containing *musim-CapRestrictionAllowed*,
and is in *RRC\_CONNECTED* state in network A }**

**ensure that {**

**when { UE capability is restricted for MUSIM operation and it is going
on RRC Setup procedure on network B }**

**then { UE includes the *musim-CapRestrictionInd* in the
*RRCSetupComplete* message }**

}

##### 8.1.1.2.5.2 Conformance requirements {#conformance-requirements-5 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.3.4, and TS 38.300, clause 20.4.
Unless otherwise stated these are Rel-18 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1.  set the content of *RRCSetupComplete* message as follows:

> ...
>
> 2\> if *SIB1* contains *musim-CapRestrictionAllowed*:
>
> 3\> if supported, include the *musim-CapRestrictionInd* in the
> *RRCSetupComplete* message upon determining it has temporary
> capability restriction;

\[TS 38.300, clause 20.4\]

**For MUSIM operation, a MUSIM** device in RRC\_CONNECTED state in
Network A may **indicate its preference on temporary UE capability
restriction or removal of restriction with Network A when the MUSIM
device needs transmission or reception in Network B (e.g., including
start/stop connection to Network B). Network A is NR and Network B can
either be E-UTRA or NR. The MUSIM device may request a temporary
capability restriction only after the Network signals via RRC that this
is allowed.**

**When configured to do so, a MUSIM device can indicate** one or more of
the following temporary capability restriction or removal of restriction
to the Network A:

\- A MUSIM device can explicitly request SCell(s) or SCG to be released;

\- A MUSIM device can indicate its preference on temporary maximum MIMO
layers and/or supported channel bandwidth for specific serving cells for
both UL/DL;

\- A MUSIM device can indicate its preference on the temporary maximum
number of CCs per UL/DL;

\- A MUSIM device can indicate its preference on the concerned band(s)
or band combination(s) (e.g. forbidden and/or affected band(s) or band
combination(s)) based on a band-filter list configured by network. For
affected band(s) and band combination(s), this preference can include
temporary maximum MIMO layers and/or supported channel bandwidth for
both UL/DL;

\- A MUSIM device can indicate the measurement gap requirement changes.

**When it is allowed by Network A in SIB1, a MUSIM device can indicate
to the Network A that its capabilities are temporarily restricted in
*RRCSetupComplete/RRCResumeComplete* message while the MUSIM device is
already in RRC\_CONNECTED state in Network B.**

**When a MUSIM device is in RRC\_CONNECTED state in both Network A and
Network B, if Network B is NR, it is up to UE implementation to select
which network to request temporary UE capability restriction; if Network
B is E-UTRA, the request for temporary UE capability restriction can
only be performed on Network A.**

##### 8.1.1.2.5.3 Test description {#test-description-5 .H6}

##### 8.1.1.2.5.3.1 Pre-test conditions {#pre-test-conditions-5 .H6}

##### System Simulator: {#system-simulator-8 .H6}

\- NR Cell 1(home PLMN1) and NR Cell 12 (home PLMN2) are configured
according to table 4.4.2-3 in TS 38.508-1 \[4\] and belong to the
different frequency.

\- NR Cell 1 (belongs to TAI-1, home PLMN1, MCC=001, MNC=01) is set to
\'\'Serving cell\'\'.

\- NR Cell 12 (belongs to TAI-3, home PLMN2, MCC=001, MNC=02) is set to
\'\' Non-Suitable Off cell\'\'.

##### UE: {#ue-8 .H6}

\- The UE is a MUSIM UE;

\- The UE is equipped with two USIMs with configuration as defined in TS
38.508-1 \[4\] Tables 6.4.1-27 and 6.4.1-28.

Preamble:- The UE is in 5GS state 3N-A on NR Cell 1 according to TS
38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- The SIB1 of NR Cell 12 and NR Cell 1 are defined in TS 38.508-1
\[4\], clause 4.6.1-28 with condition MUSIM\_r18 for all steps.

##### 8.1.1.2.5.3.2 Test procedure sequence {#test-procedure-sequence-5 .H6}

Table 8.1.1.2.5.3.2-1 for FR1 and table 8.1.1.2.5.3.2-2 for FR2
illustrate the downlink power levels to be applied for the cells at
various time instants of the test execution. Row marked \"T0\" denotes
the initial conditions after preamble, while columns marked \"T1\" is to
be applied subsequently in the Main behaviour. The exact instants on
which these values shall be applied are described in the texts in this
clause.

Table 8.1.1.2.5.3.2-1: Cell configuration changes over time for FR1

+----+-----------+---------+-----------+------------+---------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 12 | Remarks |
+====+===========+=========+===========+============+=========+
| T0 | SS/PBCH   | dBm/SCS | -88       | "Off"      |         |
|    |           |         |           |            |         |
|    | SSS EPRE  |         |           |            |         |
+----+-----------+---------+-----------+------------+---------+
| T1 | SS/PBCH   | dBm/SCS | -88       | -88        |         |
|    |           |         |           |            |         |
|    | SSS EPRE  |         |           |            |         |
+----+-----------+---------+-----------+------------+---------+

Table 8.1.1.2.5.3.2-2: Cell configuration changes over time for FR2

+----+-----------+---------+-----------+------------+---------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 12 | Remarks |
+====+===========+=========+===========+============+=========+
| T0 | SS/PBCH   | dBm/SCS | -82       | "Off"      |         |
|    |           |         |           |            |         |
|    | SSS EPRE  |         |           |            |         |
+----+-----------+---------+-----------+------------+---------+
| T1 | SS/PBCH   | dBm/SCS | -82       | -82        |         |
|    |           |         |           |            |         |
|    | SSS EPRE  |         |           |            |         |
+----+-----------+---------+-----------+------------+---------+

##### 8.1.1.2.5.3.3 Test procedure sequence {#test-procedure-sequence-6 .H6}

Table 8.1.1.2.5.3.3-1: Main behaviour

  St     Procedure                                                                                                               Message Sequence   TP                               Verdict   
  ------ ----------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------- --------- -------
                                                                                                                                 U - S              Message                                    
  1      The SS re-adjusts the cell-specific reference signal level according to row \"T1\".                                     **-**              **-**                            **-**     **-**
  \-     The following messages are to be observed on NR Cell 12 unless explicitly stated otherwise.                             **-**              **-**                            **-**     **-**
  2      The UE transmits an *RRCSetupRequest* message.                                                                          **\--\>**          **NR RRC: *RRCSetupRequest***    **-**     **-**
  3      The SS transmits an *RRCSetup* message.                                                                                 **\<\--**          **NR RRC: *RRCSetup***           **-**     **-**
  4      Check: Does UE transmit an *RRCSetupComplete* message including *musim-CapRestrictionInd* set to true*?*                **\--\>**          **NR RRC: *RRCSetupComplete***   **1**     **P**
  5-20   Steps 5 to 20a1 of the generic procedure for NR RRC\_IDLE specified in TS 38.508-1 subclause 4.5.2.2-2 are performed.   **-**              **-**                            **-**     **-**

##### 8.1.1.2.5.3.4 Specific message contents {#specific-message-contents-5 .H6}

Table 8.1.1.2.5.3.4-1: RRCSetupComplete (step 4, Table 8.1.1.2.5.3.3-1)

  Derivation Path: TS 38.508-1 \[4\], clause 4.6.1-22                                         
  ----------------------------------------------------- --------------------------- --------- -----------
  Information Element                                   Value/remark                Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                             
  rrc-TransactionIdentifier                             RRC-TransactionIdentifier             
  criticalExtensions CHOICE {                                                                 
  rrcSetupComplete SEQUENCE {                                                                 
  selectedPLMN-Identity                                 Not checked                           
  registeredAMF                                         Not checked                           
  guami-Type                                            Not checked                           
  s-nssai-List                                          Not checked                           
  dedicatedNAS-Message                                  DedicatedNAS-Message                  
  ng-5G-S-TMSI-Value                                    Not checked                           
  lateNonCriticalExtension                              Not checked                           
  nonCriticalExtension SEQUENCE {                                                             
  iab-NodeIndication-r16                                Not present                           
  idleMeasAvailable-r16                                 Not present                           
  ue-MeasurementsAvailable-r16                          Not present                           
  mobilityHistoryAvail-r16                              Not present                           
  mobilityState-r16                                     Not present                           
  nonCriticalExtension SEQUENCE {                                                             
  ul-RRC-Segmentation-r16                               Not present                           
  nonCriticalExtension SEQUENCE {                                                             
  onboardingRequest-r17                                 Not present                           
  nonCriticalExtension SEQUENCE {                                                             
  ncr-NodeIndication-r18                                Not present                           
  musim-CapRestrictionInd-r18                           true                                  
  flightPathInfoAvailable-r18                           Not present                           
  measConfigReportAppLayerAvailable-r18                 Not present                           
  mobileIAB-NodeIndication-r18                          Not present                           
  reselectionMeasAvailable-r18                          Not present                           
  nonCriticalExtension                                  Not present                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           

#### 8.1.1.3 RRC release

##### 8.1.1.3.1 RRC connection release / Redirection to another NR frequency

##### 8.1.1.3.1.1 Test Purpose (TP) {#test-purpose-tp-6 .H6}

##### (1) {#section-22 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCRelease message including an IE
redirectedCarrierInfo with nr and carrierFreq different from the
frequency UE was on in RRC\_CONNECTED state }

**then** { UE enters RRC\_IDLE state on new frequency included in IE
redirectedCarrierInfo }

}

##### 8.1.1.3.1.2 Conformance requirements {#conformance-requirements-6 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.8.3, TS 38.304, clause
5.2.4.1.Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> delay the following actions defined in this clause 60ms from the
moment the *RRCRelease* message was received or optionally when lower
layers indicate that the receipt of the *RRCRelease* message has been
successfully acknowledged, whichever is earlier;

1\> stop timer T320, if running;

1\> if the *RRCRelease* message includes *redirectedCarrierInfo*
indicating redirection to *eutra*:

2\> if *cnType* is included:

3\> the received *cnType* is provided to upper layers;

NOTE: Handling the case if the E-UTRA cell selected after the
redirection does not support the core network type specified by the
*cnType,* is up to UE implementation.

1\> if the *RRCRelease* message includes the
*cellReselectionPriorities*:

2\> store the cell reselection priority information provided by the
*cellReselectionPriorities*;

2\> if the *t320* is included:

3\> start timer T320, with the timer value set according to the value of
*t320*;

1\> else:

2\> apply the cell reselection priority information broadcast in the
system information;

\[TS 38.304, clause 5.2.4.1\]

The UE shall only perform cell reselection evaluation for NR frequencies
and inter-RAT frequencies that are given in system information and for
which the UE has a priority provided.

\[TS 38.304, clause 5.2.6\]

On transition from RRC\_CONNECTED to RRC\_IDLE state or RRC\_INACTIVE
state, UE shall attempt to camp on a suitable cell according to
*redirectedCarrierInfo* if included in the *RRCRelease* message used for
this transition. If the UE cannot find a suitable cell, the UE is
allowed to camp on any suitable cell of the indicated RAT. If the
*RRCRelease* message does not contain the *redirectedCarrierInfo,* UE
shall attempt to select a suitable cell on an NR carrier. If no suitable
cell is found according to the above, the UE shall perform cell
selection using stored information in order to find a suitable cell to
camp on.

When returning to RRC\_IDLE state after UE moved to RRC\_CONNECTED state
from *camped on any cell* state, UE shall attempt to camp on an
acceptable cell according to *redirectedCarrierInfo*, if included in the
*RRCRelease* message. If the UE cannot find an acceptable cell, the UE
is allowed to camp on any acceptable cell of the indicated RAT. If the
*RRCRelease* message does not contain *redirectedCarrierInfo* UE shall
attempt to select an acceptable cell on an NR frequency. If no
acceptable cell is found according to the above, the UE shall continue
to search for an acceptable cell of any PLMN in state *any cell
selection*.

##### 8.1.1.3.1.3 Test description {#test-description-6 .H6}

##### 8.1.1.3.1.3.1 Pre-test conditions {#pre-test-conditions-6 .H6}

##### System Simulator: {#system-simulator-9 .H6}

\- 2 cells on different NR frequencies and different tracking areas:

\- NR Cell 1 (TAI-1) serving cell

\- NR Cell 23 (TAI-2) suitable neighbour inter-frequency cell

\- Cell power levels are selected according to TS 38.508-1 \[4\] Table
6.2.2.1-3 for FR1 or Table 6.2.2.2.2-2 for FR2. NR Cell 23 is switched
on after UE has registered on NR Cell 1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-9 .H6}

\- None.

##### Preamble: {#preamble-8 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.1.3.1.3.2 Test procedure sequence {#test-procedure-sequence-7 .H6}

Table 8.1.1.3.1.3.2-1: Main behaviour

+-----+--------------+--------------+--------------+---------+----+
| St  | Procedure    | Message      | TP           | Verdict |    |
|     |              | Sequence     |              |         |    |
+=====+==============+==============+==============+=========+====+
|     |              | U - S        | Message      |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1   | The SS       | \<\--        | *NR          | \-      | \- |
|     | transmits an |              | RRC          |         |    |
|     | *RRCRelease* |              | :RRCRelease* |         |    |
|     | message (IE  |              |              |         |    |
|     | *redirected  |              |              |         |    |
|     | CarrierInfo* |              |              |         |    |
|     | including    |              |              |         |    |
|     | *NR Cell     |              |              |         |    |
|     | 23*).        |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2A  | Check: Does  | \--\>        | *NR RRC:     | 1       | P  |
|     | the UE       |              | RRCS         |         |    |
|     | transmit an  |              | etupRequest* |         |    |
|     | RRC          |              |              |         |    |
|     | SetupRequest |              |              |         |    |
|     | message?     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2B  | SS transmit  | \<\--        | *NR RRC:     | \-      | \- |
|     | an RRCSetup  |              | RRCSetup*    |         |    |
|     | message on   |              |              |         |    |
|     | the NGC Cell |              |              |         |    |
|     | 23.          |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2C  | Check: Does  | \--\>        | *NR RRC:     | 1       | P  |
|     | the UE       |              | RRCSe        |         |    |
|     | transmit an  |              | tupComplete* |         |    |
|     | RRCS         |              |              |         |    |
|     | etupComplete |              | *5GMM:       |         |    |
|     | message to   |              | REGISTRATION |         |    |
|     | confirm the  |              | REQUEST*     |         |    |
|     | successful   |              |              |         |    |
|     | completion   |              |              |         |    |
|     | of the       |              |              |         |    |
|     | connection   |              |              |         |    |
|     | e            |              |              |         |    |
|     | stablishment |              |              |         |    |
|     | and a        |              |              |         |    |
|     | REGISTRATION |              |              |         |    |
|     | REQUEST      |              |              |         |    |
|     | message      |              |              |         |    |
|     | indicating   |              |              |         |    |
|     | \"mobility   |              |              |         |    |
|     | registration |              |              |         |    |
|     | updating\"   |              |              |         |    |
|     | is sent to   |              |              |         |    |
|     | update the   |              |              |         |    |
|     | registration |              |              |         |    |
|     | of the       |              |              |         |    |
|     | actual       |              |              |         |    |
|     | tracking     |              |              |         |    |
|     | area?        |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 3   | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *Security    |         |    |
|     | Securit      |              | ModeCommand* |         |    |
|     | yModeCommand |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 4   | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *SecurityM   |         |    |
|     | Security     |              | odeComplete* |         |    |
|     | ModeComplete |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 5-6 | Steps 4-5 of | \-           | \-           | \-      | \- |
|     | TS 38.508-1  |              |              |         |    |
|     | \[4\] Table  |              |              |         |    |
|     | 4.9.5.2.2-1  |              |              |         |    |
|     | of the       |              |              |         |    |
|     | generic      |              |              |         |    |
|     | procedure    |              |              |         |    |
|     | are          |              |              |         |    |
|     | performed.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 7   | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCReco     |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message to   |              |              |         |    |
|     | establish    |              |              |         |    |
|     | SRB2 and     |              |              |         |    |
|     | DRB.         |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 8   | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRC         |         |    |
|     | *RRC         |              | Reconfigurat |         |    |
|     | Reconfigurat |              | ionComplete* |         |    |
|     | ionComplete* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 9   | Check: Does  | \-           | \-           | 1       | \- |
|     | the test     |              |              |         |    |
|     | result of    |              |              |         |    |
|     | generic test |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | \[4\] clause |              |              |         |    |
|     | 4.9.1        |              |              |         |    |
|     | indicate     |              |              |         |    |
|     | that the UE  |              |              |         |    |
|     | is capable   |              |              |         |    |
|     | of           |              |              |         |    |
|     | exchanging   |              |              |         |    |
|     | IP data on   |              |              |         |    |
|     | DRB\#n       |              |              |         |    |
|     | associated   |              |              |         |    |
|     | with the     |              |              |         |    |
|     | first PDU    |              |              |         |    |
|     | session?     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+

##### 8.1.1.3.1.3.3 Specific message contents {#specific-message-contents-6 .H6}

Table 8.1.1.3.1.3.3-1: SIB4 for NR cells 1 and 23 (preamble and all
steps, Table 8.1.1.3.1.3.2-1)

  ------------------------------------------------------------------------------------- ----------------------------------------------- --------- ------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.2-3                                                                                                
  Information Element                                                                   Value/remark                                    Comment   Condition
  SIB4 ::= SEQUENCE {                                                                                                                             
  interFreqCarrierFreqList SEQUENCE (SIZE (1..maxFreq)) OF InterFreqCarrierFreqInfo {   1 entry                                                   
  InterFreqCarrierFreqInfo\[1\] SEQUENCE {                                                                                              entry 1   
  dl-CarrierFreq                                                                        Same downlink NR ARFCN as used for NR Cell 23             NR Cell 1
                                                                                        Same downlink NR ARFCN as used for NR Cell 1              NR Cell 23
  cellReselectionPriority                                                               Not present                                               
  }                                                                                                                                               
  }                                                                                                                                               
  }                                                                                                                                               
  ------------------------------------------------------------------------------------- ----------------------------------------------- --------- ------------

Table 8.1.1.3.1.3.3-2: *RRCRelease* message (step 1, Table
8.1.1.3.1.3.2-1)

  --------------------------------------------------- ------------------------------------------ -------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                                                               
  Information Element                                 Value/remark                               Comment                          Condition
  RRCRelease ::= SEQUENCE {                                                                                                       
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier                                                   
  criticalExtensions CHOICE {                                                                                                     
  rrcRelease SEQUENCE {                                                                                                           
  redirectedCarrierInfo CHOICE {                                                                                                  
  nr SEQUENCE {                                                                                                                   
  carrierFreq                                         ARFCN-ValueNR for NR Cell 23 frequency                                      
  ssbSubcarrierSpacing                                Subcarrier spacing of SSB for NR Cell 23                                    
  smtc                                                SSB-MTC                                    38.508-1 \[4\] Table 4.6.3-185   
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  --------------------------------------------------- ------------------------------------------ -------------------------------- -----------

Table 8.1.1.3.1.3.3-3: *RRCReconfiguration* message (step 7, Table
8.1.1.3.1.3.2-1)

  --------------------------------------------------- ----------------------------------- ------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                                                                       
  Information Element                                 Value/remark                        Comment                         Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                       
  criticalExtensions CHOICE {                                                                                             
  rrcReconfiguration SEQUENCE {                                                                                           
  radioBearerConfig                                   RadioBearerConfig-SRB2-DRB (n, m)   38.508-1 \[4\] Table 4.8.1-4    
  nonCriticalExtension SEQUENCE {                                                                                         
  masterCellGroup                                     CellGroupConfig-SRB2-DRB(n, m)      38.508-1 \[4\] Table 4.8.1-2B   
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  --------------------------------------------------- ----------------------------------- ------------------------------- -----------

##### 8.1.1.3.2 RRC connection release / Redirection from NR to E-UTRA

##### 8.1.1.3.2.1 Test Purpose (TP) {#test-purpose-tp-7 .H6}

##### (1) {#section-23 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCRelease message including an IE
redirectionInformation with E-UTRA frequency }

**then** { UE enters RRC\_IDLE state on E-UTRA frequency included in IE
redirectionInformation }

}

##### 8.1.1.3.2.2 Conformance requirements {#conformance-requirements-7 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clause 5.3.8.3, TS 38.304, clause 5.2.6.

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> delay the following actions defined in this clause 60ms from the
moment the *RRCRelease* message was received or optionally when lower
layers indicate that the receipt of the *RRCRelease* message has been
successfully acknowledged, whichever is earlier;

1\> stop timer T320, if running;

1\> if the *RRCRelease* message includes *redirectedCarrierInfo*
indicating redirection to *eutra*:

2\> if *cnType* is included:

3\> after the cell selection, indicate the available CN Type(s) and the
received *cnType* to upper layers;

NOTE: Handling the case if the E-UTRA cell selected after the
redirection does not support the core network type specified by the
*cnType,* is up to UE implementation.

\[TS 38.304, clause 5.2.6\]

At reception of *RRCRelease* message to transition the UE to RRC\_IDLE
or RRC\_INACTIVE, UE shall attempt to camp on a suitable cell according
to *redirectedCarrierInfo* if included in the *RRCRelease* message used
for this transition. If the UE cannot find a suitable cell, the UE is
allowed to camp on any suitable cell of the indicated RAT. If the
*RRCRelease* message does not contain the *redirectedCarrierInfo,* UE
shall attempt to select a suitable cell on an NR carrier. If no suitable
cell is found according to the above, the UE shall perform cell
selection using stored information in order to find a suitable cell to
camp on.

When returning to RRC\_IDLE state after UE moved to RRC\_CONNECTED state
from *camped on any cell* state, UE shall attempt to camp on an
acceptable cell according to *redirectedCarrierInfo*, if included in the
*RRCRelease* message. If the UE cannot find an acceptable cell, the UE
is allowed to camp on any acceptable cell of the indicated RAT. If the
*RRCRelease* message does not contain *redirectedCarrierInfo* UE shall
attempt to select an acceptable cell on an NR frequency. If no
acceptable cell is found according to the above, the UE shall continue
to search for an acceptable cell of any PLMN in state *any cell
selection*.

##### 8.1.1.3.2.3 Test description {#test-description-7 .H6}

##### 8.1.1.3.2.3.1 Pre-test conditions {#pre-test-conditions-7 .H6}

##### System Simulator: {#system-simulator-10 .H6}

\- NR Cell 1 is the serving cell. System information combination NR-6 as
defined in TS 38.508 -1 \[4\] clause 4.4.3.1.2 is used

\- E-UTRA Cell 1 is a suitable neighbour cell. System information
combination 31 as defined in TS 38.508 \[7\], clause 4.4.3.1.1

\- The parameters settings and power levels for NR Cell 1, E-UTRA Cell 1
are selected to ensure that camping on NR Cell 1 is guaranteed and no
cell re-selection to E-UTRA Cell 1 can take place (E -UTRA Cell 1
priority is lower than serving NR Cell 1).

##### UE: {#ue-10 .H6}

\- None

##### Preamble:  {#preamble-9 .H6}

\- With E-UTRA Cell 1 \"Serving cell\" and NR Cell 1 \"Non-suitable
\"Off\" cell\", the UE is brought to state 1E-A, RRC\_IDLE using generic
procedure parameters Connectivity (*E-UTRA/EPC*) and Unrestricted nr PDN
(*On*), in accordance with the procedure described in TS 38.508-1 \[4\],
clause 4.5.2.

\- the UE is switched-off

\- With E-UTRA Cell 1 and NR Cell 1 power levels set according to T0,
the UE is brought to state 3N-A as defined in TS 38.508-1 \[4\], clause
4.4A.2.

##### 8.1.1.3.2.3.2 Test procedure sequence {#test-procedure-sequence-8 .H6}

Tables 8.1.1.3.2.3.2-1/ 8.1.1.3.2.3.2-1A illustrates the downlink power
levels to be applied for NR Cell 1, E-UTRA Cell 1 for the test
execution.

Table 8.1.1.3.2.3.2-1: Time instances of cell power level and parameter
changes for conducted test environment

+----+-----------+-----------+-----------+-----------+-----------+
|    | Parameter | Unit      | NR Cell 1 | E-UTRA    | Remark    |
|    |           |           |           | Cell 1    |           |
+====+===========+===========+===========+===========+===========+
| T0 | Cell      | dBm/15kHz |           | \"Off\"   |           |
|    | -specific |           |           |           |           |
|    | RS EPRE   |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -85       | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T1 | Cell      | dBm/15kHz |           | -91       | The power |
|    | -specific |           |           |           | levels    |
|    | RS EPRE   |           |           |           | are such  |
|    |           |           |           |           | that      |
|    |           |           |           |           | camping   |
|    |           |           |           |           | on NR     |
|    |           |           |           |           | Cell 1 is |
|    |           |           |           |           | gu        |
|    |           |           |           |           | aranteed. |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -85       | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T2 | Cell      | dBm/15kHz |           | -91       | The power |
|    | -specific |           |           |           | levels    |
|    | RS EPRE   |           |           |           | are such  |
|    |           |           |           |           | that UE   |
|    |           |           |           |           | performs  |
|    |           |           |           |           | dereg     |
|    |           |           |           |           | istration |
|    |           |           |           |           | on E-UTRA |
|    |           |           |           |           | cell and  |
|    |           |           |           |           | does not  |
|    |           |           |           |           | reselect  |
|    |           |           |           |           | NR Cell   |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -110      | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+

Table 8.1.1.3.2.3.2-1/1A: Time instances of cell power level and
parameter changes for OTA test environment

+----+-----------+-----------+-----------+-----------+-----------+
|    | Parameter | Unit      | NR Cell 1 | E-UTRA    | Remark    |
|    |           |           |           | Cell 1    |           |
+====+===========+===========+===========+===========+===========+
| T0 | Cell      | dBm/15kHz |           | "Off"     |           |
|    | -specific |           |           |           |           |
|    | RS EPRE   |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -82       | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T1 | Cell      | dBm/15kHz |           | -96       | The power |
|    | -specific |           |           |           | levels    |
|    | RS EPRE   |           |           |           | are such  |
|    |           |           |           |           | that      |
|    |           |           |           |           | camping   |
|    |           |           |           |           | on NR     |
|    |           |           |           |           | Cell 1 is |
|    |           |           |           |           | gu        |
|    |           |           |           |           | aranteed. |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -82       | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T2 | Cell      | dBm/15kHz |           | -96       | The power |
|    | -specific |           |           |           | levels    |
|    | RS EPRE   |           |           |           | are such  |
|    |           |           |           |           | that UE   |
|    |           |           |           |           | performs  |
|    |           |           |           |           | dereg     |
|    |           |           |           |           | istration |
|    |           |           |           |           | on E-UTRA |
|    |           |           |           |           | cell and  |
|    |           |           |           |           | does not  |
|    |           |           |           |           | reselect  |
|    |           |           |           |           | NR Cell   |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -139      | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+

Table 8.1.1.3.2.3.2-2: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 0  | The SS       | \-           | \-           | \-      | \- |
|    | changes NR   |              |              |         |    |
|    | Cell 1 and   |              |              |         |    |
|    | E-UTRA Cell  |              |              |         |    |
|    | 1 level      |              |              |         |    |
|    | according to |              |              |         |    |
|    | the row      |              |              |         |    |
|    | \"T1\" in    |              |              |         |    |
|    | Table        |              |              |         |    |
|    | 8.1.1.       |              |              |         |    |
|    | 3.2.3.2-1/1A |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | SS transmits | \<\--        | *NR RRC:     | \-      | \- |
|    | an           |              | RRCRelease*  |         |    |
|    | *RRCRelease* |              |              |         |    |
|    | message (IE  |              |              |         |    |
|    | *redirection |              |              |         |    |
|    | Information* |              |              |         |    |
|    | including    |              |              |         |    |
|    | ARFC         |              |              |         |    |
|    | N-ValueEUTRA |              |              |         |    |
|    | *of E-UTRA   |              |              |         |    |
|    | Cell 1*).    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | Check: Does  | \-           | \-           | 1       | \- |
|    | the test     |              |              |         |    |
|    | result of    |              |              |         |    |
|    | generic test |              |              |         |    |
|    | procedure in |              |              |         |    |
|    | TS 38.508-1  |              |              |         |    |
|    | Table        |              |              |         |    |
|    | 4.9.7.2.2-1  |              |              |         |    |
|    | is performed |              |              |         |    |
|    | and the UE   |              |              |         |    |
|    | is camped on |              |              |         |    |
|    | E-UTRAN Cell |              |              |         |    |
|    | 1, with      |              |              |         |    |
|    | connected    |              |              |         |    |
|    | without      |              |              |         |    |
|    | release''?   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2A | SS changes   | \-           | \-           | \-      | \- |
|    | NR Cell 1    |              |              |         |    |
|    | SSS levels   |              |              |         |    |
|    | according to |              |              |         |    |
|    | the row      |              |              |         |    |
|    | \"T2\" in    |              |              |         |    |
|    | Table        |              |              |         |    |
|    | 8.1.1.3      |              |              |         |    |
|    | .2.3.2-1/1A. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | At the end   | \-           | \-           | \-      | \- |
|    | of this test |              |              |         |    |
|    | procedure    |              |              |         |    |
|    | sequence,    |              |              |         |    |
|    | the UE is in |              |              |         |    |
|    | end state    |              |              |         |    |
|    | E-UTRA       |              |              |         |    |
|    | connected    |              |              |         |    |
|    |              |              |              |         |    |
|    | (E2\_T3440)  |              |              |         |    |
|    | according to |              |              |         |    |
|    | TS 36.508    |              |              |         |    |
|    | \[7\].       |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.1.3.2.3.3 Specific message contents {#specific-message-contents-7 .H6}

Table 8.1.1.3.2.3.3-1 *RRCRelease* (step 1, Table 8.1.1.3.2.3.2-2)

  --------------------------------------------- ------------------------- --------- -----------
  Derivation Path: TS 38.508-1 table 4.6.1-16                                       
  Information Element                           Value/remark              Comment   Condition
  RRCRelease ::= SEQUENCE {                                                         
  criticalExtensions CHOICE {                                                       
  rrcRelease SEQUENCE {                                                             
  redirectedCarrierInfo CHOICE {                                                    
  eutra SEQUENCE {                                                                  
  eutraFrequency                                EARFCN of E-UTRA Cell 1             
  cnType                                        epc                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  --------------------------------------------- ------------------------- --------- -----------

##### 8.1.1.3.3 RRC connection release / Success / With priority information / T320 expiry

##### 8.1.1.3.3.1 Test Purpose (TP) {#test-purpose-tp-8 .H6}

##### (1) {#section-24 .H6}

**with** { UE in NR RRC\_IDLE state having received an RRCRelease
message with the freqPriorityListNR with higher priority frequency }

**ensure that** {

**when** { UE detects the cell re-selection criteria are met for the
cell which belongs to the higher priority frequency }

**then** { UE reselects the cell which belongs to the higher priority
frequency }

}

##### (2) {#section-25 .H6}

**with** { UE in NR RRC\_IDLE state having received an RRCRelease
message with the freqPriorityListNR with higher priority frequency and
timer T320 }

**ensure that** {

**when** { T320 timer expires }

**then** { UE discards the cell reselection priority information
provided by the cellReselectionPriorities and apply the cell reselection
priority information broadcast in the system information to perform
reselection to another NR cell }

}

##### 8.1.1.3.3.2 Conformance requirements {#conformance-requirements-8 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.8.3 and TS38.304, clause 5.2.4.1,
5.2.4.2 and 5.2.4.5. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> delay the following actions defined in this clause 60 ms from the
moment the *RRCRelease* message was received or optionally when lower
layers indicate that the receipt of the *RRCRelease* message has been
successfully acknowledged, whichever is earlier;

1\> stop timer T380, if running;

1\> stop timer T320, if running;

1\> stop timer T390, if running;

1\> if the security is not activated, perform the actions upon going to
RRC\_IDLE as specified in 5.3.11 with the release cause \'other\' upon
which the procedure ends;

1\> if the *RRCRelease* message includes *redirectedCarrierInfo*
indicating redirection to *eutra*:

2\> if *cnType* is included:

3\> after the cell selection, indicate the available CN Type(s) and the
received *cnType* to upper layers;

NOTE: Handling the case if the E-UTRA cell selected after the
redirection does not support the core network type specified by the
*cnType,* is up to UE implementation.

1\> if the *RRCRelease* message includes the
*cellReselectionPriorities*:

2\> store the cell reselection priority information provided by the
*cellReselectionPriorities*;

2\> if the *t320* is included:

3\> start timer T320, with the timer value set according to the value of
*t320*;

1\> else:

2\> apply the cell reselection priority information broadcast in the
system information;

1\> if *deprioritisationReq* is included:

2\> start or restart timer T325 with the timer value set to the
*deprioritisationTimer* signalled;

2\> store the *deprioritisationReq* until T325 expiry;

1\> if the *RRCRelease* includes *suspendConfig*:

2\> apply the received *suspendConfig*;

2\> reset MAC and release the default MAC Cell Group configuration, if
any;

2\> re-establish RLC entities for SRB1;

2\> if the *RRCRelease* message with *suspendConfig* was received in
response to an *RRCResumeRequest* or an *RRCResumeRequest1*:

3\> stop the timer T319 if running;

3\> in the stored UE Inactive AS context:

4\> replace the K~gNB~ and K~RRCint~ keys with the current K~gNB~ and
K~RRCint~ keys;

4\> replace the C-RNTI with the temporary C-RNTI in the cell the UE has
received the *RRCRelease* message;

4\> replace the *cellIdentity* with the *cellIdentity* of the cell the
UE has received the *RRCRelease* message;

4\> replace the physical cell identity with the physical cell identity
of the cell the UE has received the *RRCRelease* message;

4\> replace the *suspendConfig* with the current *suspendConfig*;

2\> else:

3\> store in the UE Inactive AS Context the received *suspendConfig*,
all current parameters configured with *RRCReconfiguration* or
*RRCResume*, the current K~gNB~ and K~RRCint~ keys, the ROHC state, the
C-RNTI used in the source PCell, the *cellIdentity* and the physical
cell identity of the source PCell;

2\> suspend all SRB(s) and DRB(s), except SRB0;

2\> indicate PDCP suspend to lower layers of all DRBs;

2\> if the *t380* is included:

3\> start timer T380, with the timer value set to *t380*;

2\> if the *RRCRelease* message is including the *waitTime*:

3\> start timer T302 with the value set to the *waitTime*;

3\> inform the upper layer that access barring is applicable for all
access categories except categories \'0\' and \'2\';

2\> indicate the suspension of the RRC connection to upper layers;

2\> enter RRC\_INACTIVE and perform cell selection as specified in TS
38.304 \[20\];

1\> else

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with the release cause \'other\'.

\[TS 38.331, clause 5.3.8.4\]

The UE shall:

1\> if T320 expires:

2\> if stored, discard the cell reselection priority information
provided by the *cellReselectionPriorities* or inherited from another
RAT;

2\> apply the cell reselection priority information broadcast in the
system information.

\[TS 38.304, clause 5.2.4.1\]

Absolute priorities of different NR frequencies or inter-RAT frequencies
may be provided to the UE in the system information, in the *RRCRelease*
message, or by inheriting from another RAT at inter-RAT cell
(re)selection. In the case of system information, an NR frequency or
inter-RAT frequency may be listed without providing a priority (i.e. the
field *cellReselectionPriority* is absent for that frequency). If
priorities are provided in dedicated signalling, the UE shall ignore all
the priorities provided in system information. If UE is in *camped on
any cell* state, UE shall only apply the priorities provided by system
information from current cell, and the UE preserves priorities provided
by dedicated signalling and *deprioritisationReq* received in
*RRCRelease* unless specified otherwise. When the UE in camped normally
state, has only dedicated priorities other than for the current
frequency, the UE shall consider the current frequency to be the lowest
priority frequency (i.e. lower than any of the network configured
values).

The UE shall only perform cell reselection evaluation for NR frequencies
and inter-RAT frequencies that are given in system information and for
which the UE has a priority provided.

In case UE receives *RRCRelease* with *deprioritisationReq*, UE shall
consider current frequency and stored frequencies due to the previously
received *RRCRelease* with *deprioritisationReq* or all the frequencies
of NR to be the lowest priority frequency (i.e. lower than any of the
network configured values) while T325 is running irrespective of camped
RAT. The UE shall delete the stored deprioritisation request(s) when a
PLMN selection is performed on request by NAS (TS 23.122 \[9\]).

NOTE: UE should search for a higher priority layer for cell reselection
as soon as possible after the change of priority. The minimum related
performance requirements specified in TS 38.133 \[8\] are still
applicable.

The UE shall delete priorities provided by dedicated signalling when:

\- the UE enters a different RRC state; or

\- the optional validity time of dedicated priorities (T320) expires; or

\- a PLMN selection is performed on request by NAS (TS 23.122 \[9\]).

NOTE 2: Equal priorities between RATs are not supported.

The UE shall not consider any exclude-listed cells as candidate for cell
reselection.

The UE shall inherit the priorities provided by dedicated signalling and
the remaining validity time (i.e. T320 in NR and E-UTRA), if configured,
at inter-RAT cell (re)selection.

NOTE 3: The network may assign dedicated cell reselection priorities for
frequencies not configured by system information.

\[TS 38.304, clause 5.2.4.1\]

Absolute priorities of different NR frequencies or inter-RAT frequencies
may be provided to the UE in the system information, in the *RRCRelease*
message, or by inheriting from another RAT at inter-RAT cell
(re)selection. In the case of system information, an NR frequency or
inter-RAT frequency may be listed without providing a priority (i.e. the
field *cellReselectionPriority* is absent for that frequency). If
priorities are provided in dedicated signalling, the UE shall ignore all
the priorities provided in system information. If UE is in *camped on
any cell* state, UE shall only apply the priorities provided by system
information from current cell, and the UE preserves priorities provided
by dedicated signalling and *deprioritisationReq* received in
*RRCRelease* unless specified otherwise. When the UE in camped normally
state, has only dedicated priorities other than for the current
frequency, the UE shall consider the current frequency to be the lowest
priority frequency (i.e. lower than any of the network configured
values).

The UE shall only perform cell reselection evaluation for NR frequencies
and inter-RAT frequencies that are given in system information and for
which the UE has a priority provided.

In case UE receives *RRCRelease* with *deprioritisationReq*, UE shall
consider current frequency and stored frequencies due to the previously
received *RRCRelease* with *deprioritisationReq* or all the frequencies
of NR to be the lowest priority frequency (i.e. lower than any of the
network configured values) while T325 is running irrespective of camped
RAT. The UE shall delete the stored deprioritisation request(s) when a
PLMN selection is performed on request by NAS (TS 23.122 \[9\]).

NOTE: UE should search for a higher priority layer for cell reselection
as soon as possible after the change of priority. The minimum related
performance requirements specified in TS 38.133 \[8\] are still
applicable.

The UE shall delete priorities provided by dedicated signalling when:

\- the UE enters a different RRC state; or

\- the optional validity time of dedicated priorities (T320) expires; or

\- a PLMN selection is performed on request by NAS (TS 23.122 \[9\]).

NOTE 2: Equal priorities between RATs are not supported.

The UE shall not consider any exclude-listed cells as candidate for cell
reselection.

The UE shall inherit the priorities provided by dedicated signalling and
the remaining validity time (i.e. T320 in NR and E-UTRA), if configured,
at inter-RAT cell (re)selection.

NOTE 3: The network may assign dedicated cell reselection priorities for
frequencies not configured by system information.

\[TS 38.304, clause 5.2.4.2\]

Following rules are used by the UE to limit needed measurements:

\- If the serving cell fulfils Srxlev \> S~IntraSearchP~ and Squal \>
S~IntraSearchQ~, the UE may choose not to perform intra-frequency
measurements.

\- Otherwise, the UE shall perform intra-frequency measurements.

\- The UE shall apply the following rules for NR inter-frequencies and
inter-RAT frequencies which are indicated in system information and for
which the UE has priority provided as defined in 5.2.4.1:

\- For a NR inter-frequency or inter-RAT frequency with a reselection
priority higher than the reselection priority of the current NR
frequency, the UE shall perform measurements of higher priority NR
inter-frequency or inter-RAT frequencies according to TS 38.133 \[8\].

\- For a NR inter-frequency with an equal or lower reselection priority
than the reselection priority of the current NR frequency and for
inter-RAT frequency with lower reselection priority than the reselection
priority of the current NR frequency:

\- If the serving cell fulfils Srxlev \> S~nonIntraSearchP~ and Squal \>
S~nonIntraSearchQ~, the UE may choose not to perform measurements of NR
inter-frequencies or inter-RAT frequency cells of equal or lower
priority;

\- Otherwise, the UE shall perform measurements of NR inter-frequencies
or inter-RAT frequency cells of equal or lower priority according to TS
38.133 \[8\].

\[TS 38.304, clause 5.2.4.5\]

If ***threshServingLowQ*** is broadcast in system information and more
than 1 second has elapsed since the UE camped on the current serving
cell, cell reselection to a cell on a higher priority NR frequency or
inter-RAT frequency than the serving frequency shall be performed if:

\- A cell of a higher priority NR or EUTRAN RAT/frequency fulfils Squal
\> Thresh~X,\ HighQ~ during a time interval Treselection~RAT~

Otherwise, cell reselection to a cell on a higher priority NR frequency
or inter-RAT frequency than the serving frequency shall be performed if:

\- A cell of a higher priority RAT/ frequency fulfils Srxlev \>
Thresh~X,\ HighP~ during a time interval Treselection~RAT~; and

\- More than 1 second has elapsed since the UE camped on the current
serving cell.

Cell reselection to a cell on an equal priority NR frequency shall be
based on ranking for intra-frequency cell reselection as defined in
sub-clause 5.2.4.6.

If ***threshServingLowQ*** is broadcast in system information and more
than 1 second has elapsed since the UE camped on the current serving
cell, cell reselection to a cell on a lower priority NR frequency or
inter-RAT frequency than the serving frequency shall be performed if:

\- The serving cell fulfils Squal \< Thresh~Serving,\ LowQ~ and a cell
of a lower priority NR or E-UTRAN RAT/ frequency fulfils Squal \>
Thresh~X,\ LowQ~ during a time interval Treselection~RAT~.

Otherwise, cell reselection to a cell on a lower priority NR frequency
or inter-RAT frequency than the serving frequency shall be performed if:

\- The serving cell fulfils Srxlev \< Thresh~Serving,\ LowP~ and a cell
of a lower priority RAT/ frequency fulfils Srxlev \> Thresh~X,\ LowP~
during a time interval Treselection~RAT~; and

> \- More than 1 second has elapsed since the UE camped on the current
> serving cell.

Cell reselection to a higher priority RAT/frequency shall take
precedence over a lower priority RAT/frequency if multiple cells of
different priorities fulfil the cell reselection criteria.

If more than one cell meets the above criteria, the UE shall reselect a
cell as follows:

\- If the highest-priority frequency is an NR frequency, the highest
ranked cell among the cells on the highest priority frequency(ies)
meeting the criteria according to clause 5.2.4.6;

\- If the highest-priority frequency is from another RAT, the highest
ranked cell among the cells on the highest priority frequency(ies)
meeting the criteria of that RAT.

\[TS 38.304, clause 5.2.4.6\]

The cell-ranking criterion R~s~ for serving cell and R~n~ for
neighbouring cells is defined by:

+-------------------------------------------+
| R~s~ = Q~meas,s~ +Q~hyst~ - Qoffset~temp~ |
|                                           |
| R~n~ = Q~meas,n~ -Qoffset - Qoffset~temp~ |
+-------------------------------------------+

where:

+---------------+-----------------------------------------------------+
| Q~meas~       | RSRP measurement quantity used in cell              |
|               | reselections.                                       |
+---------------+-----------------------------------------------------+
| Qoffset       | For intra-frequency: Equals to Qoffset~s,n~, if     |
|               | Qoffset~s,n~ is valid, otherwise this equals to     |
|               | zero.                                               |
|               |                                                     |
|               | For inter-frequency: Equals to Qoffset~s,n~ plus    |
|               | Qoffset~frequency~, if Qoffset~s,n~ is valid,       |
|               | otherwise this equals to Qoffset~frequency~.        |
+---------------+-----------------------------------------------------+
| Qoffset~temp~ | Offset temporarily applied to a cell as specified   |
|               | in TS 38.331 \[3\].                                 |
+---------------+-----------------------------------------------------+

The UE shall perform ranking of all cells that fulfil the cell selection
criterion S, which is defined in 5.2.3.2.

The cells shall be ranked according to the R criteria specified above by
deriving Q~meas,n~ and Q~meas,s~ and calculating the R values using
averaged RSRP results.

If *rangeToBestCell* is not configured, the UE shall perform cell
reselection to the highest ranked cell. If this cell is found to be
not-suitable, the UE shall behave according to clause 5.2.4.4.

If *rangeToBestCell* is configured*,* then the UE shall perform cell
reselection to the cell with the highest number of beams above the
threshold (i.e. *absThreshSS-BlocksConsolidation*) among the cells whose
R value is within *rangeToBestCell* of the R value of the highest ranked
cell. If there are multiple such cells, the UE shall perform cell
reselection to the highest ranked cell among them. If this cell is found
to be not-suitable, the UE shall behave according to clause 5.2.4.4.

In all cases, the UE shall reselect the new cell, only if the following
conditions are met:

\- the new cell is better than the serving cell according to the cell
reselection criteria specified above during a time interval
Treselection~RAT~;

\- more than 1 second has elapsed since the UE camped on the current
serving cell.

NOTE: If *rangeToBestCell* is configured but
*absThreshSS-BlocksConsolidation* is not configured on an NR frequency,
the UE considers that there is one beam above the threshold for each
cell on that frequency.

##### 8.1.1.3.3.3 Test description {#test-description-8 .H6}

##### 8.1.1.3.3.3.1 Pre-test conditions {#pre-test-conditions-8 .H6}

##### System Simulator: {#system-simulator-11 .H6}

\- NR Cell 1, NR Cell 3 and NR Cell 6.

\- NR Cell 1 (TAI-1) serving cell.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2-1 is used in NR cells.

NOTE: For Cell 3 and 6 TAI is set to TAI-2

##### UE: {#ue-11 .H6}

\- None.

##### Preamble: {#preamble-10 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (On) with UE
test loop mode B on NR Cell 1 according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.1.3.3.3.2 Test procedure sequence {#test-procedure-sequence-9 .H6}

Table 8.1.1.3.3.3.2-1/2 illustrates the downlink power levels and other
changing parameters to be applied for the cells at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions
after preamble, while columns marked \"T1\" and \"T2\" are to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.1.3.3.3.2-1: Time instances of cell power level and parameter
changes for FR1

+---------+---------+---------+---------+---------+---------+---------+
|         | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|         | rameter |         | 1       | 3       | 6       |         |
+=========+=========+=========+=========+=========+=========+=========+
| **T0**  | SS/PBCH | dBm/SCS | -88     | Off     | Off     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | S       |
|         |         |         |         |         |         | rxlev~C |
|         |         |         |         |         |         | ell\ 1~ |
|         |         |         |         |         |         | \>      |
|         |         |         |         |         |         | S       |
|         |         |         |         |         |         | ~intras |
|         |         |         |         |         |         | earch~. |
|         |         |         |         |         |         | (NOTE   |
|         |         |         |         |         |         | 1)      |
+---------+---------+---------+---------+---------+---------+---------+
| **T1**  | SS/PBCH | dBm/SCS | -88     | -94     | -88     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | both    |
|         |         |         |         |         |         | Th      |
|         |         |         |         |         |         | resh~x, |
|         |         |         |         |         |         | \ high~ |
|         |         |         |         |         |         | \<      |
|         |         |         |         |         |         | S       |
|         |         |         |         |         |         | rxlev~C |
|         |         |         |         |         |         | ell\ 3~ |
|         |         |         |         |         |         | and     |
|         |         |         |         |         |         | T       |
|         |         |         |         |         |         | hresh~x |
|         |         |         |         |         |         | ,\ low~ |
|         |         |         |         |         |         | \<Sr    |
|         |         |         |         |         |         | xlev~Ce |
|         |         |         |         |         |         | ll\ 6~. |
+---------+---------+---------+---------+---------+---------+---------+
| **T2**  | SS/PBCH | dBm/SCS | -88     | Off     | -88     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | Th      |
|         |         |         |         |         |         | resh~x, |
|         |         |         |         |         |         | \ high~ |
|         |         |         |         |         |         | \<      |
|         |         |         |         |         |         | Sr      |
|         |         |         |         |         |         | xlev~Ce |
|         |         |         |         |         |         | ll\ 6~. |
+---------+---------+---------+---------+---------+---------+---------+
| NOTE 1: |         |         |         |         |         |         |
| Power   |         |         |         |         |         |         |
| level   |         |         |         |         |         |         |
| "Off"   |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| defined |         |         |         |         |         |         |
| in TS   |         |         |         |         |         |         |
| 3       |         |         |         |         |         |         |
| 8.508-1 |         |         |         |         |         |         |
| Table   |         |         |         |         |         |         |
| 6.2     |         |         |         |         |         |         |
| .2.1-3. |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.1.3.3.3.2-2 Time instances of cell power level and parameter
changes for FR2

+---------+---------+---------+---------+---------+---------+---------+
|         | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|         | rameter |         | 1       | 3       | 6       |         |
+=========+=========+=========+=========+=========+=========+=========+
| **T0**  | SS/PBCH | dBm/SCS | -82     | Off     | Off     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | S       |
|         |         |         |         |         |         | rxlev~C |
|         |         |         |         |         |         | ell\ 1~ |
|         |         |         |         |         |         | \>      |
|         |         |         |         |         |         | S       |
|         |         |         |         |         |         | ~intras |
|         |         |         |         |         |         | earch~. |
|         |         |         |         |         |         | (NOTE   |
|         |         |         |         |         |         | 1)      |
+---------+---------+---------+---------+---------+---------+---------+
| **T1**  | SS/PBCH | dBm/SCS | -82     | -91     | -82     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | both    |
|         |         |         |         |         |         | Th      |
|         |         |         |         |         |         | resh~x, |
|         |         |         |         |         |         | \ high~ |
|         |         |         |         |         |         | \<      |
|         |         |         |         |         |         | S       |
|         |         |         |         |         |         | rxlev~C |
|         |         |         |         |         |         | ell\ 3~ |
|         |         |         |         |         |         | and     |
|         |         |         |         |         |         | T       |
|         |         |         |         |         |         | hresh~x |
|         |         |         |         |         |         | ,\ low~ |
|         |         |         |         |         |         | \<Sr    |
|         |         |         |         |         |         | xlev~Ce |
|         |         |         |         |         |         | ll\ 6~. |
+---------+---------+---------+---------+---------+---------+---------+
| **T2**  | SS/PBCH | dBm/SCS | -82     | Off     | -82     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | Th      |
|         |         |         |         |         |         | resh~x, |
|         |         |         |         |         |         | \ high~ |
|         |         |         |         |         |         | \<      |
|         |         |         |         |         |         | Sr      |
|         |         |         |         |         |         | xlev~Ce |
|         |         |         |         |         |         | ll\ 6~. |
+---------+---------+---------+---------+---------+---------+---------+
| NOTE 1: |         |         |         |         |         |         |
| Power   |         |         |         |         |         |         |
| level   |         |         |         |         |         |         |
| "Off"   |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| defined |         |         |         |         |         |         |
| in TS   |         |         |         |         |         |         |
| 3       |         |         |         |         |         |         |
| 8.508-1 |         |         |         |         |         |         |
| Table   |         |         |         |         |         |         |
| 6.2.2   |         |         |         |         |         |         |
| .2.2-2. |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.1.3.3.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The SS      | \-          | *-*         | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1, NR  |             |             |         |    |
|       | Cell 3 and  |             |             |         |    |
|       | NR Cell 6   |             |             |         |    |
|       | power level |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.1.3     |             |             |         |    |
|       | .3.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRelease* |         |    |
|       | an          |             |             |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | the         |             |             |         |    |
|       | *freqPrio   |             |             |         |    |
|       | rityListNR* |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 1.          |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2A    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *RRCSe      |         |    |
|       | transmit an |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 3?  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2B    | SS transmit | \<\--       | NR RRC:     | \-      | \- |
|       | an          |             | *RRCSetup*  |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 3.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2C    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | RRCSe       |         |    |
|       | transmit an |             | tupComplete |         |    |
|       | RRCSe       |             |             |         |    |
|       | tupComplete |             | 5GMM:       |         |    |
|       | message to  |             | R           |         |    |
|       | confirm the |             | EGISTRATION |         |    |
|       | successful  |             | REQUEST     |         |    |
|       | completion  |             |             |         |    |
|       | of the      |             |             |         |    |
|       | connection  |             |             |         |    |
|       | es          |             |             |         |    |
|       | tablishment |             |             |         |    |
|       | and a       |             |             |         |    |
|       | R           |             |             |         |    |
|       | EGISTRATION |             |             |         |    |
|       | REQUEST     |             |             |         |    |
|       | message     |             |             |         |    |
|       | indicating  |             |             |         |    |
|       | \"mobility  |             |             |         |    |
|       | r           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | updating\"  |             |             |         |    |
|       | is sent to  |             |             |         |    |
|       | update the  |             |             |         |    |
|       | r           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | of the      |             |             |         |    |
|       | actual      |             |             |         |    |
|       | tracking    |             |             |         |    |
|       | area?       |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | Void        | \-          | \-          | \-      | \- |
+-------+-------------+-------------+-------------+---------+----+
| 3A    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *SecurityM  |         |    |
|       | *SecurityM  |             | odeCommand* |         |    |
|       | odeCommand* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3B    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             | *SecurityMo |         |    |
|       | *SecurityMo |             | deComplete* |         |    |
|       | deComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3C-3D | Steps 4-5   | \-          | \-          | \-      | \- |
|       | of TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | of the      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3E    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRecon   |         |    |
|       | an          |             | figuration* |         |    |
|       | *RRCRecon   |             |             |         |    |
|       | figuration* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | establish   |             |             |         |    |
|       | SRB2 and    |             |             |         |    |
|       | DRB.        |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3F    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRe      |         |    |
|       | an          |             | configurati |         |    |
|       | *RRCRe      |             | onComplete* |         |    |
|       | configurati |             |             |         |    |
|       | onComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3G    | Check: Does | \-          | \-          | 1       | \- |
|       | the test    |             |             |         |    |
|       | result of   |             |             |         |    |
|       | generic     |             |             |         |    |
|       | test        |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.1       |             |             |         |    |
|       | indicate    |             |             |         |    |
|       | that the UE |             |             |         |    |
|       | is capable  |             |             |         |    |
|       | of          |             |             |         |    |
|       | exchanging  |             |             |         |    |
|       | IP data on  |             |             |         |    |
|       | DRB \#n     |             |             |         |    |
|       | associated  |             |             |         |    |
|       | with the    |             |             |         |    |
|       | first PDU   |             |             |         |    |
|       | session on  |             |             |         |    |
|       | NR Cell 3?  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3H    | The SS      | \-          | \-          | \-      | \- |
|       | releases    |             |             |         |    |
|       | RRC         |             |             |         |    |
|       | connection. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The SS      | \-          | \-          | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1, NR  |             |             |         |    |
|       | Cell 3 and  |             |             |         |    |
|       | NR Cell 6   |             |             |         |    |
|       | power level |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T0\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.1.3     |             |             |         |    |
|       | .3.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5-5B  | Steps 1-3   | \-          | \-          | \-      | \- |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | are         |             |             |         |    |
|       | peformed on |             |             |         |    |
|       | NR Cell 1.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5C    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *SecurityM  |         |    |
|       | *SecurityM  |             | odeCommand* |         |    |
|       | odeCommand* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5D    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             | *SecurityMo |         |    |
|       | *SecurityMo |             | deComplete* |         |    |
|       | deComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5E-5F | Steps 4-5   | \-          | \-          | \-      | \- |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | are         |             |             |         |    |
|       | peformed.   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message     |             |             |         |    |
|       | containing  |             |             |         |    |
|       | IE          |             |             |         |    |
|       | *freqPrio   |             |             |         |    |
|       | rityListNR* |             |             |         |    |
|       | to update   |             |             |         |    |
|       | the cell    |             |             |         |    |
|       | reselection |             |             |         |    |
|       | priority of |             |             |         |    |
|       | NR Cell 6   |             |             |         |    |
|       | and the     |             |             |         |    |
|       | timer T320. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | The SS      | \-          | \-          | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1, NR  |             |             |         |    |
|       | Cell 3 and  |             |             |         |    |
|       | NR Cell 6   |             |             |         |    |
|       | power level |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T2\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.1.3     |             |             |         |    |
|       | .3.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 8     | Check: Does | \--\>       | NR RRC:     | 2       | F  |
|       | the UE      |             | *RRCSe      |         |    |
|       | transmit an |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message     |             |             |         |    |
|       | within T320 |             |             |         |    |
|       | running?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 9     | Check:      | \-          | \-          | 2       | \- |
|       | After timer |             |             |         |    |
|       | T320        |             |             |         |    |
|       | expiry,     |             |             |         |    |
|       | does the UE |             |             |         |    |
|       | perform the |             |             |         |    |
|       | R           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | for         |             |             |         |    |
|       | mobility    |             |             |         |    |
|       | r           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | update as   |             |             |         |    |
|       | described   |             |             |         |    |
|       | in steps    |             |             |         |    |
|       | 1-3 of TS   |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 6?          |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 10    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *SecurityM  |         |    |
|       | *SecurityM  |             | odeCommand* |         |    |
|       | odeCommand* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             | *SecurityMo |         |    |
|       | *SecurityMo |             | deComplete* |         |    |
|       | deComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12-13 | Steps 4-5   | \-          | \-          | \-      | \- |
|       | of TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | of the      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRecon   |         |    |
|       | an          |             | figuration* |         |    |
|       | *RRCRecon   |             |             |         |    |
|       | figuration* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | establish   |             |             |         |    |
|       | SRB2 and    |             |             |         |    |
|       | DRB.        |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRe      |         |    |
|       | an          |             | configurati |         |    |
|       | *RRCRe      |             | onComplete* |         |    |
|       | configurati |             |             |         |    |
|       | onComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | Check: Does | \-          | \-          | 2       | \- |
|       | the test    |             |             |         |    |
|       | result of   |             |             |         |    |
|       | generic     |             |             |         |    |
|       | test        |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.1       |             |             |         |    |
|       | indicate    |             |             |         |    |
|       | that the UE |             |             |         |    |
|       | is capable  |             |             |         |    |
|       | of          |             |             |         |    |
|       | exchanging  |             |             |         |    |
|       | IP data on  |             |             |         |    |
|       | DRB \#n     |             |             |         |    |
|       | associated  |             |             |         |    |
|       | with the    |             |             |         |    |
|       | first PDU   |             |             |         |    |
|       | session on  |             |             |         |    |
|       | NR Cell 6?  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.1.3.3.3.3 Specific message contents {#specific-message-contents-8 .H6}

Table 8.1.1.3.3.3.3-1: *RRCRelease* (step 2, Table 8.1.1.3.3.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                                                           
  --------------------------------------------------------------------- ------------------------------------------- --------- -----------
  Information Element                                                   Value/remark                                Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                                                   
  criticalExtensions CHOICE {                                                                                                 
  rrcRelease SEQUENCE {                                                                                                       
  cellReselectionPriorities SEQUENCE {                                                                                        
  freqPriorityListEUTRA                                                 Not present                                           
  freqPriorityListNR SEQUENCE (SIZE (1..maxFreq)) OF FreqPriorityNR {   3 entries                                             
  FreqPriorityNR\[1\] SEQUENCE {                                                                                    entry 1   
  carrierFreq                                                           Same downlink ARFCN as used for NR Cell 1             
  cellReselectionPriority                                               4                                                     
  cellReselectionSubPriority                                            Not present                                           
  }                                                                                                                           
  FreqPriorityNR\[2\] SEQUENCE {                                                                                    entry 2   
  carrierFreq                                                           Same downlink ARFCN as used for NR Cell 3             
  cellReselectionPriority                                               5                                                     
  cellReselectionSubPriority                                            Not present                                           
  }                                                                                                                           
  FreqPriorityNR\[3\] SEQUENCE {                                                                                    entry 3   
  carrierFreq                                                           Same downlink ARFCN as used for NR Cell 6             
  cellReselectionPriority                                               1                                                     
  cellReselectionSubPriority                                            Not present                                           
  }                                                                                                                           
  }                                                                                                                           
  }                                                                                                                           
  }                                                                                                                           
  }                                                                                                                           
  }                                                                                                                           

Table 8.1.1.3.3.3.3-2: *SIB4* for Cell 1 (preamble and all steps, Table
8.1.1.3.3.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-3                                                                                              
  ------------------------------------------------------------------------------------- ---------------------------------------------- --------- -----------
  Information Element                                                                   Value/Remark                                   Comment   Condition
  SIB4 ::= SEQUENCE {                                                                                                                            
  interFreqCarrierFreqList SEQUENCE (SIZE (1..maxFreq)) OF InterFreqCarrierFreqInfo {   2 entries                                                
  InterFreqCarrierFreqInfo\[1\] SEQUENCE {                                                                                             entry 1   
  dl-CarrierFreq                                                                        Same downlink NR ARFCN as used for NR Cell 3             
  cellReselectionPriority                                                               1                                                        
  }                                                                                                                                              
  InterFreqCarrierFreqInfo\[2\] SEQUENCE {                                                                                             entry 2   
  dl-CarrierFreq                                                                        Same downlink NR ARFCN as used for NR Cell 6             
  cellReselectionPriority                                                               5                                                        
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

Table 8.1.1.3.3.3.3-3: *SIB4* for Cell 6 (all steps, Table
8.1.1.3.3.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-3                                                                                              
  ------------------------------------------------------------------------------------- ---------------------------------------------- --------- -----------
  Information Element                                                                   Value/Remark                                   Comment   Condition
  SIB4 ::= SEQUENCE {                                                                                                                            
  interFreqCarrierFreqList SEQUENCE (SIZE (1..maxFreq)) OF InterFreqCarrierFreqInfo {   2 entries                                                
  InterFreqCarrierFreqInfo\[1\] SEQUENCE {                                                                                             entry 1   
  dl-CarrierFreq                                                                        Same downlink NR ARFCN as used for NR Cell 1             
  cellReselectionPriority                                                               4                                                        
  }                                                                                                                                              
  InterFreqCarrierFreqInfo\[2\] SEQUENCE {                                                                                             entry 2   
  dl-CarrierFreq                                                                        Same downlink NR ARFCN as used for NR Cell 3             
  cellReselectionPriority                                                               1                                                        
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

Table 8.1.1.3.3.3.3-4: *RRCRelease* (step 6, Table 8.1.1.3.5.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16                                                           
  --------------------------------------------------------------------- ---------------------------- --------- -----------
  Information Element                                                   Value/remark                 Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                                    
  criticalExtensions CHOICE {                                                                                  
  rrcRelease SEQUENCE {                                                                                        
  cellReselectionPriorities SEQUENCE {                                                                         
  freqPriorityListEUTRA                                                 Not present                            
  freqPriorityListNR SEQUENCE (SIZE (1..maxFreq)) OF FreqPriorityNR {   2 entries                              
  FreqPriorityNR\[1\] SEQUENCE {                                                                     entry 1   
  carrierFreq                                                           ARFCN-ValueNR of NR Cell 1             
  cellReselectionPriority                                               4                                      
  cellReselectionSubPriority                                            Not present                            
  }                                                                                                            
  FreqPriorityNR\[2\] SEQUENCE {                                                                     entry 2   
  carrierFreq                                                           ARFCN-ValueNR of NR Cell 6             
  cellReselectionPriority                                               3                                      
  cellReselectionSubPriority                                            Not present                            
  }                                                                                                            
  }                                                                                                            
  t320                                                                  min5                                   
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            

Table 8.1.1.3.3.3.3-5: *RRCReconfiguration* message (step 3E and step
14, Table 8.1.1.3.1.3.2-1)

  --------------------------------------------------- ----------------------------------- ------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                                                                       
  Information Element                                 Value/remark                        Comment                         Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                       
  criticalExtensions CHOICE {                                                                                             
  rrcReconfiguration SEQUENCE {                                                                                           
  radioBearerConfig                                   RadioBearerConfig-SRB2-DRB (n, m)   38.508-1 \[4\] Table 4.8.1-4    
  nonCriticalExtension SEQUENCE {                                                                                         
  masterCellGroup                                     CellGroupConfig-SRB2-DRB(n, m)      38.508-1 \[4\] Table 4.8.1-2B   
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  --------------------------------------------------- ----------------------------------- ------------------------------- -----------

Table 8.1.1.3.3.3.3-6: *SIB4* for Cell 3 (all steps, Table
8.1.1.3.3.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-3                                                                                              
  ------------------------------------------------------------------------------------- ---------------------------------------------- --------- -----------
  Information Element                                                                   Value/Remark                                   Comment   Condition
  SIB4 ::= SEQUENCE {                                                                                                                            
  interFreqCarrierFreqList SEQUENCE (SIZE (1..maxFreq)) OF InterFreqCarrierFreqInfo {   2 entries                                                
  InterFreqCarrierFreqInfo\[1\] SEQUENCE {                                                                                             entry 1   
  dl-CarrierFreq                                                                        Same downlink NR ARFCN as used for NR Cell 1             
  t-ReselectionNR                                                                       1                                                        
  }                                                                                                                                              
  InterFreqCarrierFreqInfo\[2\] SEQUENCE {                                                                                             entry 2   
  dl-CarrierFreq                                                                        Same downlink NR ARFCN as used for NR Cell 3             
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

##### 8.1.1.3.4 RRC connection release / Success / With priority information / T320 expiry / E-UTRA

##### 8.1.1.3.4.1 Test Purpose (TP) {#test-purpose-tp-9 .H6}

##### (1) {#section-26 .H6}

**with** { UE in NR RRC\_IDLE state having received an RRCRelease
message with the freqPriorityListEUTRA with higher priority frequency }

**ensure that** {

**when** { UE detects the cell re-selection criteria are met for the
cell which belongs to the higher priority EUTRA frequency }

**then** { UE reselects the cell which belongs to the higher priority
EUTRA frequency }

}

##### (2) {#section-27 .H6}

**with** { UE in NR RRC\_IDLE state having received an RRCRelease
message with the freqPriorityListEUTRA with higher priority frequency
and timer T320 }

**ensure that** {

**when** { T320 timer expires }

**then** { UE discards the cell reselection priority information
provided by the cellReselectionPriorities and apply the cell reselection
priority information broadcast in the system information to perform
reselection to an E-UTRA cell }

}

##### 8.1.1.3.4.2 Conformance requirements {#conformance-requirements-9 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.8.3 and T 38.304, clause 5.2.4.1.
Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> delay the following actions defined in this sub-clause 60 ms from
the moment the *RRCRelease* message was received or optionally when
lower layers indicate that the receipt of the *RRCRelease* message has
been successfully acknowledged, whichever is earlier;

1\> stop timer T380, if running;

1\> stop timer T320, if running;

1\> stop timer T390, if running;

1\> if the security is not activated, perform the actions upon going to
RRC\_IDLE as specified in 5.3.11 with the release cause \'other\' upon
which the procedure ends;

...

1\> if the *RRCRelease* message includes the
*cellReselectionPriorities*:

2\> store the cell reselection priority information provided by the
*cellReselectionPriorities*;

2\> if the *t320* is included:

3\> start timer T320, with the timer value set according to the value of
*t320*;

1\> else:

2\> apply the cell reselection priority information broadcast in the
system information;

\[TS 38.304, clause 5.2.4.1\]

Absolute priorities of different NR frequencies or inter-RAT frequencies
may be provided to the UE in the system information, in the *RRCRelease*
message, or by inheriting from another RAT at inter-RAT cell
(re)selection. In the case of system information, an NR frequency or
inter-RAT frequency may be listed without providing a priority (i.e. the
field *cellReselectionPriority* is absent for that frequency). If
priorities are provided in dedicated signalling, the UE shall ignore all
the priorities provided in system information. If UE is in *camped on
any cell* state, UE shall only apply the priorities provided by system
information from current cell, and the UE preserves priorities provided
by dedicated signalling and *deprioritisationReq* received in
*RRCRelease* unless specified otherwise. When the UE in camped normally
state, has only dedicated priorities other than for the current
frequency, the UE shall consider the current frequency to be the lowest
priority frequency (i.e. lower than any of the network configured
values).

The UE shall only perform cell reselection evaluation for NR frequencies
and inter-RAT frequencies that are given in system information and for
which the UE has a priority provided.

In case UE receives *RRCRelease* with *deprioritisationReq*, UE shall
consider current frequency and stored frequencies due to the previously
received *RRCRelease* with *deprioritisationReq* or all the frequencies
of NR to be the lowest priority frequency (i.e. lower than any of the
network configured values) while T325 is running irrespective of camped
RAT. The UE shall delete the stored deprioritisation request(s) when a
PLMN selection is performed on request by NAS (TS 23.122 \[9\]).

NOTE: UE should search for a higher priority layer for cell reselection
as soon as possible after the change of priority. The minimum related
performance requirements specified in TS 38.133 \[8\] are still
applicable.

The UE shall delete priorities provided by dedicated signalling when:

\- the UE enters a different RRC state; or

\- the optional validity time of dedicated priorities (T320) expires; or

\- a PLMN selection is performed on request by NAS (TS 23.122 \[9\]).

NOTE 2: Equal priorities between RATs are not supported.

The UE shall not consider any exclude-listed cells as candidate for cell
reselection.

The UE shall inherit the priorities provided by dedicated signalling and
the remaining validity time (i.e. T320 in NR and E-UTRA), if configured,
at inter-RAT cell (re)selection.

NOTE 3: The network may assign dedicated cell reselection priorities for
frequencies not configured by system information.

\[TS 38.331, clause 5.3.8.4\]

The UE shall:

1\> if T320 expires:

2\> if stored, discard the cell reselection priority information
provided by the *cellReselectionPriorities* or inherited from another
RAT;

2\> apply the cell reselection priority information broadcast in the
system information.

\[TS 38.304, clause 5.2.4.2\]

Following rules are used by the UE to limit needed measurements:

\- If the serving cell fulfils Srxlev \> S~IntraSearchP~ and Squal \>
S~IntraSearchQ~, the UE may choose not to perform intra-frequency
measurements.

\- Otherwise, the UE shall perform intra-frequency measurements.

\- The UE shall apply the following rules for NR inter-frequencies and
inter-RAT frequencies which are indicated in system information and for
which the UE has priority provided as defined in 5.2.4.1:

\- For a NR inter-frequency or inter-RAT frequency with a reselection
priority higher than the reselection priority of the current NR
frequency, the UE shall perform measurements of higher priority NR
inter-frequency or inter-RAT frequencies according to TS 38.133 \[8\].

\- For a NR inter-frequency with an equal or lower reselection priority
than the reselection priority of the current NR frequency and for
inter-RAT frequency with lower reselection priority than the reselection
priority of the current NR frequency:

\- If the serving cell fulfils Srxlev \> S~nonIntraSearchP~ and Squal \>
S~nonIntraSearchQ~, the UE may choose not to perform measurements of NR
inter-frequencies or inter-RAT frequency cells of equal or lower
priority;

> \- Otherwise, the UE shall perform measurements of NR
> inter-frequencies or inter-RAT frequency cells of equal or lower
> priority according to TS 38.133 \[8\].

\[TS 38.304, clause 5.2.4.5\]

If ***threshServingLowQ*** is broadcast in system information and more
than 1 second has elapsed since the UE camped on the current serving
cell, cell reselection to a cell on a higher priority NR frequency or
inter-RAT frequency than the serving frequency shall be performed if:

\- A cell of a higher priority NR or EUTRAN RAT/frequency fulfils Squal
\> Thresh~X,\ HighQ~ during a time interval Treselection~RAT~

Otherwise, cell reselection to a cell on a higher priority NR frequency
or inter-RAT frequency than the serving frequency shall be performed if:

\- A cell of a higher priority RAT/ frequency fulfils Srxlev \>
Thresh~X,\ HighP~ during a time interval Treselection~RAT~; and

\- More than 1 second has elapsed since the UE camped on the current
serving cell.

Cell reselection to a cell on an equal priority NR frequency shall be
based on ranking for intra-frequency cell reselection as defined in
sub-clause 5.2.4.6.

If ***threshServingLowQ*** is broadcast in system information and more
than 1 second has elapsed since the UE camped on the current serving
cell, cell reselection to a cell on a lower priority NR frequency or
inter-RAT frequency than the serving frequency shall be performed if:

\- The serving cell fulfils Squal \< Thresh~Serving,\ LowQ~ and a cell
of a lower priority NR or E-UTRAN RAT/ frequency fulfils Squal \>
Thresh~X,\ LowQ~ during a time interval Treselection~RAT~.

Otherwise, cell reselection to a cell on a lower priority NR frequency
or inter-RAT frequency than the serving frequency shall be performed if:

\- The serving cell fulfils Srxlev \< Thresh~Serving,\ LowP~ and a cell
of a lower priority RAT/ frequency fulfils Srxlev \> Thresh~X,\ LowP~
during a time interval Treselection~RAT~; and

> \- More than 1 second has elapsed since the UE camped on the current
> serving cell.

Cell reselection to a higher priority RAT/frequency shall take
precedence over a lower priority RAT/frequency if multiple cells of
different priorities fulfil the cell reselection criteria.

If more than one cell meets the above criteria, the UE shall reselect a
cell as follows:

\- If the highest-priority frequency is an NR frequency, the highest
ranked cell among the cells on the highest priority frequency(ies)
meeting the criteria according to clause 5.2.4.6;

\- If the highest-priority frequency is from another RAT, the highest
ranked cell among the cells on the highest priority frequency(ies)
meeting the criteria of that RAT.

\[TS 38.304, clause 5.2.4.6\]

The cell-ranking criterion R~s~ for serving cell and R~n~ for
neighbouring cells is defined by:

+-------------------------------------------+
| R~s~ = Q~meas,s~ +Q~hyst~ - Qoffset~temp~ |
|                                           |
| R~n~ = Q~meas,n~ -Qoffset - Qoffset~temp~ |
+-------------------------------------------+

where:

+---------------+-----------------------------------------------------+
| Q~meas~       | RSRP measurement quantity used in cell              |
|               | reselections.                                       |
+===============+=====================================================+
| Qoffset       | For intra-frequency: Equals to Qoffset~s,n~, if     |
|               | Qoffset~s,n~ is valid, otherwise this equals to     |
|               | zero.                                               |
|               |                                                     |
|               | For inter-frequency: Equals to Qoffset~s,n~ plus    |
|               | Qoffset~frequency~, if Qoffset~s,n~ is valid,       |
|               | otherwise this equals to Qoffset~frequency~.        |
+---------------+-----------------------------------------------------+
| Qoffset~temp~ | Offset temporarily applied to a cell as specified   |
|               | in TS 38.331 \[3\].                                 |
+---------------+-----------------------------------------------------+

The UE shall perform ranking of all cells that fulfil the cell selection
criterion S, which is defined in 5.2.3.2.

The cells shall be ranked according to the R criteria specified above by
deriving Q~meas,n~ and Q~meas,s~ and calculating the R values using
averaged RSRP results.

If *rangeToBestCell* is not configured, the UE shall perform cell
reselection to the highest ranked cell. If this cell is found to be
not-suitable, the UE shall behave according to subclause 5.2.4.4.

If *rangeToBestCell* is configured*,* then the UE shall perform cell
reselection to the cell with the highest number of beams above the
threshold (i.e. *absThreshSS-BlocksConsolidation*) among the cells whose
R value is within *rangeToBestCell* of the R value of the highest ranked
cell. If there are multiple such cells, the UE shall perform cell
reselection to the highest ranked cell among them. If this cell is found
to be not-suitable, the UE shall behave according to subclause 5.2.4.4.

In all cases, the UE shall reselect the new cell, only if the following
conditions are met:

\- the new cell is better than the serving cell according to the cell
reselection criteria specified above during a time interval
Treselection~RAT~;

\- more than 1 second has elapsed since the UE camped on the current
serving cell.

##### 8.1.1.3.4.3 Test description {#test-description-9 .H6}

##### 8.1.1.3.4.3.1 Pre-test conditions {#pre-test-conditions-9 .H6}

##### System Simulator: {#system-simulator-12 .H6}

\- NR Cell 1, E-UTRA Cell 1 and E-UTRA Cell 3.

\- NR Cell 1 is configured to operate in FR1 bands as defined in TS
38.508-1 \[4\] clause 6.2.3.

\- System information combination NR-6 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cell.

\- System information combination 1 as defined in TS 36.508 \[7\] clause
4.4.3.1 is used in E-UTRA cells.

##### UE: {#ue-12 .H6}

None.

##### Preamble: {#preamble-11 .H6}

\- With E-UTRA Cell 1 \"Serving cell\",E-UTRA Cell 3 \"Non-suitable
\"Off\" cell\" and NR Cell 1 \"Non-suitable \"Off\" cell\" in accordance
with TS 38.508-1 \[4\], Table 6.2.2.1-3, the UE is brought to state
RRC\_IDLE using generic procedure parameters Connectivity (*E-UTRA/EPC*)
and Unrestricted nr PDN (*On*), in accordance with the procedure
described in TS 38.508-1 \[4\], clause 4.5.2. 4G GUTI and eKSI are
assigned and security context established.

\- the UE is switched-off.

\- With E-UTRA Cell 1 \"Non-suitable \"Off\" cell\" and NR Cell 1
\"Serving cell\" in accordance with TS 38.508-1 \[4\], Table 6.2.2.1-3,
the UE is brought to state 3N-A, NR RRC\_ CONNECTED, in accordance with
the procedure described in TS 38.508-1 \[4\], Table 4.5.2.2-2. 5G-GUTI
and ngKSI are assigned and security context established.

\- The UE is in 5GS state 3N-A and Test Loop Function (*On*) with UE
test loop mode B on NR Cell 1 according to 38.508-1\[4\], clause 4.4A.2
Table 4.4A.2-3.

##### 8.1.1.3.4.3.2 Test procedure sequence {#test-procedure-sequence-10 .H6}

Table 8.1.1.3.4.3.2-1 illustrates the downlink power levels and other
changing parameters to be applied for the cells at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions
after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.1.3.4.3.2-1: Time instances of cell power level and parameter
changes in FR1

+---------+---------+---------+--------+--------+--------+---------+
|         | Pa      | Unit    | NR     | E-UTRA | E-UTRA | Remark  |
|         | rameter |         |        |        |        |         |
|         |         |         | Cell 1 | Cell 1 | Cell 3 |         |
+=========+=========+=========+========+========+========+=========+
| **T0**  | Cell-s  | dB      | \-     | \"off" | \"off" |         |
|         | pecific | m/15kHz |        |        |        |         |
|         | RS EPRE |         |        |        |        |         |
+---------+---------+---------+--------+--------+--------+---------+
|         | SS/PBCH | dBm/SCS | -88    | \-     | \-     |         |
|         |         |         |        |        |        |         |
|         | SSS     |         |        |        |        |         |
|         | EPRE    |         |        |        |        |         |
+---------+---------+---------+--------+--------+--------+---------+
| **T1**  | Cell-s  | dB      | \-     | -73    | -73    | The     |
|         | pecific | m/15kHz |        |        |        | power   |
|         | RS EPRE |         |        |        |        | level   |
|         |         |         |        |        |        | values  |
|         |         |         |        |        |        | are     |
|         |         |         |        |        |        | a       |
|         |         |         |        |        |        | ssigned |
|         |         |         |        |        |        | to      |
|         |         |         |        |        |        | satisfy |
|         |         |         |        |        |        | both    |
|         |         |         |        |        |        | T       |
|         |         |         |        |        |        | hresh~x |
|         |         |         |        |        |        | ,\ low~ |
|         |         |         |        |        |        | \<      |
|         |         |         |        |        |        | Srxlev~ |
|         |         |         |        |        |        | E-UTRAC |
|         |         |         |        |        |        | ell\ 1~ |
|         |         |         |        |        |        | and     |
|         |         |         |        |        |        | Th      |
|         |         |         |        |        |        | resh~x, |
|         |         |         |        |        |        | \ high~ |
|         |         |         |        |        |        | \<      |
|         |         |         |        |        |        | Srxlev~ |
|         |         |         |        |        |        | E-UTRAC |
|         |         |         |        |        |        | ell\ 3~ |
|         |         |         |        |        |        | but not |
|         |         |         |        |        |        | to      |
|         |         |         |        |        |        | satisfy |
|         |         |         |        |        |        | Srxle   |
|         |         |         |        |        |        | v~NR\ C |
|         |         |         |        |        |        | ell\ 1~ |
|         |         |         |        |        |        | \<      |
|         |         |         |        |        |        | Thresh~ |
|         |         |         |        |        |        | serving |
|         |         |         |        |        |        | ,\ low~ |
+---------+---------+---------+--------+--------+--------+---------+
|         | SS/PBCH | dBm/SCS | -88    | \-     | \-     |         |
|         |         |         |        |        |        |         |
|         | SSS     |         |        |        |        |         |
|         | EPRE    |         |        |        |        |         |
+---------+---------+---------+--------+--------+--------+---------+
| **T2**  | Cell-s  | dB      | \-     | \"off" | \"off" | The     |
|         | pecific | m/15kHz |        |        |        | power   |
|         | RS EPRE |         |        |        |        | level   |
|         |         |         |        |        |        | values  |
|         |         |         |        |        |        | are     |
|         |         |         |        |        |        | a       |
|         |         |         |        |        |        | ssigned |
|         |         |         |        |        |        | to      |
|         |         |         |        |        |        | satisfy |
|         |         |         |        |        |        | Srxle   |
|         |         |         |        |        |        | v~NR\ C |
|         |         |         |        |        |        | ell\ 1~ |
|         |         |         |        |        |        | \>      |
|         |         |         |        |        |        | S~no    |
|         |         |         |        |        |        | nintras |
|         |         |         |        |        |        | earch~. |
|         |         |         |        |        |        | (NOTE   |
|         |         |         |        |        |        | 1)      |
+---------+---------+---------+--------+--------+--------+---------+
|         | SS/PBCH | dBm/SCS | -88    | \-     | \-     |         |
|         |         |         |        |        |        |         |
|         | SSS     |         |        |        |        |         |
|         | EPRE    |         |        |        |        |         |
+---------+---------+---------+--------+--------+--------+---------+
| **T3**  | Cell-s  | dB      | \-     | -73    | \"off" | The     |
|         | pecific | m/15kHz |        |        |        | power   |
|         | RS EPRE |         |        |        |        | level   |
|         |         |         |        |        |        | values  |
|         |         |         |        |        |        | are     |
|         |         |         |        |        |        | a       |
|         |         |         |        |        |        | ssigned |
|         |         |         |        |        |        | to      |
|         |         |         |        |        |        | satisfy |
|         |         |         |        |        |        | Th      |
|         |         |         |        |        |        | resh~x, |
|         |         |         |        |        |        | \ high~ |
|         |         |         |        |        |        | \<      |
|         |         |         |        |        |        | Srx     |
|         |         |         |        |        |        | lev~E-U |
|         |         |         |        |        |        | TRA\ Ce |
|         |         |         |        |        |        | ll\ 1~. |
+---------+---------+---------+--------+--------+--------+---------+
|         | SS/PBCH | dBm/SCS | -88    | \-     | \-     |         |
|         |         |         |        |        |        |         |
|         | SSS     |         |        |        |        |         |
|         | EPRE    |         |        |        |        |         |
+---------+---------+---------+--------+--------+--------+---------+
| NOTE 1: |         |         |        |        |        |         |
| Power   |         |         |        |        |        |         |
| level   |         |         |        |        |        |         |
| "Off"   |         |         |        |        |        |         |
| is      |         |         |        |        |        |         |
| defined |         |         |        |        |        |         |
| in      |         |         |        |        |        |         |
| T       |         |         |        |        |        |         |
| S36.508 |         |         |        |        |        |         |
| \[7\]   |         |         |        |        |        |         |
| Table   |         |         |        |        |        |         |
| 6.2     |         |         |        |        |        |         |
| .2.1-3. |         |         |        |        |        |         |
+---------+---------+---------+--------+--------+--------+---------+

Table 8.1.1.3.4.3.2-2: Void

Table 8.1.1.3.4.3.2-3: Main behaviour

  St      Procedure                                                                                                                                                                                                                                             Message Sequence   TP                                                                           Verdict   
  ------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ---------------------------------------------------------------------------- --------- ----
                                                                                                                                                                                                                                                                U - S              Message                                                                                
  1       The SS changes NR Cell 1, E-UTRA Cell 1 and E-UTRA Cell 3 level according to the row \"T1\" in Table 8.1.1.3.4.3.2-1                                                                                                                                  \-                 \-                                                                           \-        \-
  2       The SS transmits an *RRCRelease* message including the *freqPriorityListEUTRA* on NR Cell 1.                                                                                                                                                          \<\--              *NR RRC: RRCRelease*                                                         \-        \-
  2A      Check: Does the UE transmit an *RRCConnectionRequest* message on E-UTRA cell 3?                                                                                                                                                                       \--\>              E-UTRA RRC: *RRCConnectionRequest*                                           1         P
  2B      SS transmits an *RRCConnectionSetup* message on E-UTRA cell 3.                                                                                                                                                                                        \<\--              E-UTRA RRC: *RRCConnectionSetup*                                             \-        \-
  2C      Check: Does the UE transmit an *RRCConnectionSetupComplete* message to confirm the successful completion of the connection establishment and a TRACKING AREA UPDATE REQUEST message is sent to update the registration of the actual tracking area?   \--\>              E-UTRA RRC: *RRCConnectionSetupComplete* NAS: TRACKING AREA UPDATE REQUEST   1         P
  3       Void                                                                                                                                                                                                                                                                                                                                                            
  3A      The SS transmits a SecurityModeCommand message.                                                                                                                                                                                                       \<\--              E-UTRA RRC: *SecurityModeCommand*                                            \-        \-
  3B      The UE transmits a SecurityModeComplete message.                                                                                                                                                                                                      \--\>              E-UTRA RRC: *SecurityModeComplete*                                           \-        \-
  3C-3D   Steps 5-6 of TS 38.508-1 \[4\] Table 4.9.7.2.2-1 of the generic procedure are performed.                                                                                                                                                              \-                 \-                                                                           \-        \-
  3E      The SS transmits an *RRCConnectionReconfiguration* message to establish DRB \#n                                                                                                                                                                       \<\--              E-UTRA RRC: *RRCConnectionReconfiguration*                                   \-        \-
  3F      The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                                                                             \--\>              E-UTRA RRC: *RRCConnectionReconfigurationComplete*                           \-        \-
  3G      Void                                                                                                                                                                                                                                                  \-                 \-                                                                           1         \-
  3GA     The SS sends one IP Packet to the UE on the default DRB associated with the first PDU session.                                                                                                                                                        \-                 \-                                                                           \-        \-
  3GB     The UE loop backs the IP packet received in step 3GA.                                                                                                                                                                                                 \-                 \-                                                                           1         P
  3H      The SS transmits an *RRConnectionRelease*                                                                                                                                                                                                             \<\--              E-UTRA RRC: *RRCConnectionRelease*                                           \-        \-
  4       The SS changes NR Cell 1, E-UTRA Cell 1 and E-UTRA Cell 3 level according to the row \"T2\" in Table 8.1.1.3.4.3.2-1                                                                                                                                  \-                 \-                                                                           \-        \-
  5       UE perform on the NR Cell 1 the mobility and periodic registration update procedure in TS 38.508-1\[4\] subclause 4.9.9.2.2                                                                                                                           \-                 \-                                                                           \-        \-
  5AA     The SS transmits an RRCReconfiguration message to establish SRB2 and DRB.                                                                                                                                                                             \<\--              NR RRC: *RRCReconfiguration*                                                 \-        \-
  5AB     The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                                                                             \--\>              NR RRC: *RRCReconfigurationComplete*                                         \-        \-
  5A      Void                                                                                                                                                                                                                                                  \-                 \-                                                                           1         \-
  5B      The SS sends one IP Packet to the UE on the default DRB associated with the first PDU session.                                                                                                                                                        \-                 \-                                                                           \-        \-
  5C      The UE loop backs the IP packet received in step 5B.                                                                                                                                                                                                  \-                 \-                                                                           1         P
  6       The SS transmits an *RRCRelease* message containing IE *freqPriorityListEUTRA* to update the cell reselection priority of E-UTRA Cell 1 and the timer T320.                                                                                           \<\--              NR RRC: *RRCRelease*                                                         \-        \-
  7       The SS changes power levels of NR Cell 1, E-UTRA Cell 1 and E-UTRA Cell 3 according to row "T3" in Table 8.1.1.3.4.3.2-1.                                                                                                                             \-                 \-                                                                           \-        \-
  8       Check: While timer T320 is running, does the UE transmit an RRCSetupRequest message?                                                                                                                                                                  \-                 \-                                                                           2         F
  9       Void                                                                                                                                                                                                                                                  \-                 \-                                                                           2         \-
  9A      Check: Does the UE transmit an *RRCConnectionRequest* message on E-UTRA cell 1?                                                                                                                                                                       \--\>              RRC: *RRCConnectionRequest*                                                  2         P
  9B      SS transmits an *RRCConnectionSetup* message on E-UTRA cell 1.                                                                                                                                                                                        \<\--              RRC: *RRCConnectionSetup*                                                    \-        \-
  9C      Check: Does the UE transmit an *RRCConnectionSetupComplete* message to confirm the successful completion of the connection establishment and a TRACKING AREA UPDATE REQUEST message is sent to update the registration of the actual tracking area?   \--\>              RRC: *RRCConnectionSetupComplete* NAS: TRACKING AREA UPDATE REQUEST          2         P
  10      The SS transmits a SecurityModeCommand message.                                                                                                                                                                                                       \<\--              E-UTRA RRC: *SecurityModeCommand*                                            \-        \-
  11      The UE transmits a SecurityModeComplete message.                                                                                                                                                                                                      \--\>              E-UTRA RRC: *SecurityModeComplete*                                           \-        \-
  12-13   Steps 5-6 of TS 38.508-1 \[4\] Table 4.9.7.2.2-1 of the generic procedure are performed.                                                                                                                                                              \-                 \-                                                                           \-        \-
  14      The SS transmits an *RRCConnectionReconfiguration* message to establish DRB \#n                                                                                                                                                                       \<\--              E-UTRA RRC: *RRCConnectionReconfiguration*                                   \-        \-
  15      The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                                                                             \--\>              E-UTRA RRC: *RRCConnectionReconfigurationComplete*                           \-        \-
  16      Void                                                                                                                                                                                                                                                  \-                 \-                                                                           2         \-
  16A     The SS sends one IP Packet to the UE on the default DRB associated with the first PDU session.                                                                                                                                                        \-                 \-                                                                           \-        \-
  16B     The UE loop backs the IP packet received in step 16A.                                                                                                                                                                                                 \-                 \-                                                                           2         P

##### 8.1.1.3.4.3.3 Specific message contents {#specific-message-contents-9 .H6}

Table 8.1.1.3.4.3.3-1: *RRCRelease* (step 1, Table 8.1.1.3.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                                                                   
  --------------------------------------------------------------------------- --------------------------------------------- --------- -----------
  Information Element                                                         Value/remark                                  Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                                                           
  criticalExtensions CHOICE {                                                                                                         
  rrcRelease SEQUENCE {                                                                                                               
  cellReselectionPriorities SEQUENCE {                                                                                                
  freqPriorityListEUTRA SEQUENCE (SIZE (1..maxFreq)) OF FreqPriorityEUTRA {   2 entries                                               
  freqPriorityListEUTRA\[1\] SEQUENCE {                                                                                     entry 1   
  carrierFreq                                                                 ARFCN-ValueEUTRA for EUTRA Cell 1 frequency             
  cellReselectionPriority                                                     3                                                       
  cellReselectionSubPriority                                                  Not present                                             
  }                                                                                                                                   
  freqPriorityListEUTRA\[1\] SEQUENCE {                                                                                     entry 2   
  carrierFreq                                                                 ARFCN-ValueEUTRA for EUTRA Cell 3 frequency             
  cellReselectionPriority                                                     5                                                       
  cellReselectionSubPriority                                                  Not present                                             
  }                                                                                                                                   
  }                                                                                                                                   
  freqPriorityListNR SEQUENCE (SIZE (1..maxFreq)) OF FreqPriorityNR {         1 entry                                                 
  FreqPriorityNR\[1\] SEQUENCE {                                                                                            entry 1   
  carrierFreq                                                                 ARFCN-ValueNR for NR Cell 1 frequency                   
  cellReselectionPriority                                                     4                                                       
  cellReselectionSubPriority                                                  Not present                                             
  }                                                                                                                                   
  }                                                                                                                                   
  t320                                                                        Not Present                                             
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   

Table 8.1.1.3.4.3.3-2: *SIB5* for NR cell 1 (preamble and all steps,
Table 8.1.1.3.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.2-4                                                                                           
  ---------------------------------------------------------------------------------- --------------------------------------------- --------- -----------
  Information Element                                                                Value/remark                                  Comment   Condition
  SIB5 ::= SEQUENCE {                                                                                                                        
  carrierFreqListEUTRA SEQUENCE (SIZE (1..maxEUTRA-Carrier)) OF CarrierFreqEUTRA {   2 entries                                               
  CarrierFreqEUTRA\[1\] SEQUENCE {                                                                                                 entry 1   
  carrierFreq                                                                        ARFCN-ValueEUTRA for EUTRA Cell 1 frequency             
  cellReselectionPriority                                                            5                                                       
  }                                                                                                                                          
  CarrierFreqEUTRA\[2\] SEQUENCE {                                                                                                 entry 2   
  carrierFreq                                                                        ARFCN-ValueEUTRA for EUTRA Cell 3 frequency             
  cellReselectionPriority                                                            3                                                       
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          

Table 8.1.1.3.4.3.3-3: RRCRelease (step 6, Table 8.1.1.3.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16                                                                            
  --------------------------------------------------------------------------- --------------------------------------- --------- -----------
  Information Element                                                         Value/remark                            Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                                                     
  criticalExtensions CHOICE {                                                                                                   
  rrcRelease SEQUENCE {                                                                                                         
  cellReselectionPriorities SEQUENCE {                                                                                          
  freqPriorityListEUTRA SEQUENCE (SIZE (1..maxFreq)) OF FreqPriorityEUTRA {   1 entry                                           
  freqPriorityListEUTRA\[1\] SEQUENCE {                                                                               entry 1   
  carrierFreq                                                                 ARFCN-ValueEUTRA of E-UTRA Cell 1                 
  cellReselectionPriority                                                     3                                                 
  cellReselectionSubPriority                                                  Not present                                       
  }                                                                                                                             
  }                                                                                                                             
  freqPriorityListNR SEQUENCE (SIZE (1..maxFreq)) OF FreqPriorityNR {         1 entry                                           
  FreqPriorityNR\[1\] SEQUENCE {                                                                                      entry 1   
  carrierFreq                                                                 ARFCN-ValueNR for NR Cell 1 frequency             
  cellReselectionPriority                                                     4                                                 
  cellReselectionSubPriority                                                  Not present                                       
  }                                                                                                                             
  }                                                                                                                             
  t320                                                                        min5                                              
  }                                                                                                                             
  }                                                                                                                             
  }                                                                                                                             
  }                                                                                                                             

Table 8.1.1.3.4.3.3-4: *RRCConnectionReconfiguration* (steps 3E and 14
Table 8.1.1.3.4.3.2-3)

  ----------------------------------------------- ---------------------------------------- --------- -----------
  Derivation Path: TS 36.508\[7\] Table 4.6.1-8                                                      
  Information Element                             Value/remark                             Comment   Condition
  RRCConnectionReconfiguration ::= SEQUENCE {                                                        
  criticalExtensions CHOICE {                                                                        
  c1 CHOICE {                                                                                        
  rrcConnectionReconfiguration-r8 SEQUENCE {                                                         
  radioResourceConfigDedicated                    RadioResourceConfigDedicated-DRB(n, m)             
  }                                                                                                  
  }                                                                                                  
  }                                                                                                  
  }                                                                                                  
  ----------------------------------------------- ---------------------------------------- --------- -----------

Table 8.1.1.3.4.3.3-5: *RRCReconfiguration-SRB2-DRB (n, m)* (step 5AA,
Table 8.1.1.3.4.3.2-3)

  ---------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1B
  ---------------------------------------------------

Table 8.1.1.3.4.3.3-6: REGISTRATION REQUEST (Step 5, Table
8.1.1.3.4.3.2-3)

  ---------------------------------------------------- -------------------------------------- ----------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.7.1-6.                                                                        
  Information Element                                  Value/remark                           Comment                       Condition
  EPS NAS message container                            TRACKING AREA UPDATE REQUEST message   *See* Table 8.1.1.3.4.3.3-7   
  ---------------------------------------------------- -------------------------------------- ----------------------------- -----------

Table 8.1.1.3.4.3.3-7: TRACKING AREA UPDATE REQUEST (Table
8.1.1.3.4.3.3-6)

  --------------------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.9.9.2.3-2 with condition Mapped EPS security context
  --------------------------------------------------------------------------------------------------

##### 8.1.1.3.5 Void

##### 8.1.1.3.6 Void

##### 8.1.1.3.7 RRC connection release / Success / Deprioritisation / Frequency / T325 expiry

##### 8.1.1.3.7.1 Test Purpose (TP) {#test-purpose-tp-10 .H6}

##### (1) {#section-28 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCRelease message including IE
deprioritisationReq with deprioritisationType indicating 'frequency' and
a deprioritisationTimer }

**then** { UE considers the current frequency to be the lowest priority
frequency (i.e. lower than any of the network configured values) while
T325 is running }

}

##### 8.1.1.3.7.2 Conformance requirements {#conformance-requirements-10 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.8.3 and TS 38.304 clause 5.2.4.1.

\[TS 38.331, clause 5.3.8.3\]

...

The UE shall:

1\> if *deprioritisationReq* is included and the UE supports RRC
connection release with deprioritisation:

2\> start or restart timer T325 with the timer value set to the
*deprioritisationTimer* signalled;

2\> store the *deprioritisationReq* until T325 expiry;

\[TS 38.304, clause 5.2.4.1\]

...

In case UE receives *RRCRelease* with *deprioritisationReq*, UE shall
consider current frequency and stored frequencies due to the previously
received *RRCRelease* with *deprioritisationReq* or all the frequencies
of NR to be the lowest priority frequency (i.e. lower than any of the
network configured values) while T325 is running irrespective of camped
RAT. The UE shall delete the stored deprioritisation request(s) when a
PLMN selection or SNPN selection is performed on request by NAS (TS
23.122 \[9\]).

NOTE: UE should search for a higher priority layer for cell reselection
as soon as possible after the change of priority. The minimum related
performance requirements specified in TS 38.133 \[8\] are still
applicable.

##### 8.1.1.3.7.3 Test Description {#test-description-10 .H6}

##### 8.1.1.3.7.3.1 Pre-test conditions {#pre-test-conditions-10 .H6}

##### System Simulator: {#system-simulator-13 .H6}

\- NR Cell 1 and NR Cell 3 have different tracking areas and equal
priority.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-13 .H6}

\- None.

##### Preamble: {#preamble-12 .H6}

\- The UE is in 5GS state 3N-A on NR Cell 1 according to TS 38.508-1
\[4\], clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.1.3.7.3.2 Test procedure sequence {#test-procedure-sequence-11 .H6}

Table 8.1.1.3.7.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1, Cell 2 and Cell 3 at various time instants of the
test execution. Row marked \"T0\" denotes the conditions after the
preamble, while rows marked \"T1\" and \"T2\" are to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.1.3.7.3.2-1: Time instances of cell power level and parameter
changes for FR1

       Parameter          Unit      NR Cell 1   NR Cell 3   Remark
  ---- ------------------ --------- ----------- ----------- -----------------------------------------------------------------------
  T0   SS/PBCH SSS EPRE   dBm/SCS   -88         Off         
  T1   SS/PBCH SSS EPRE   dBm/SCS   -85         -91         The power level values are set so that R~NRCell\ 1~ \> R ~NRCell\ 3~.

Table 8.1.1.3.7.3.2-2: Time instances of cell power level and parameter
changes for FR2

       Parameter          Unit      NR Cell 1   NR Cell 3   Remark
  ---- ------------------ --------- ----------- ----------- -----------------------------------------------------------------------
  T0   SS/PBCH SSS EPRE   dBm/SCS   -82         Off         
  T1   SS/PBCH SSS EPRE   dBm/SCS   -82         -91         The power level values are set so that R~NRCell\ 1~ \> R ~NRCell\ 3~.

Table 8.1.1.3.7.3.2-3: Main behaviour

  St   Procedure                                                                                                                                   Message Sequence   TP                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ---------------------- --------- ----
                                                                                                                                                   U - S              Message                          
  1    The SS transmits an *RRCRelease* message on NR *Cell 1 including IE deprioritisationReq*.                                                   \<\--              NR RRC: *RRCRelease*   \-        \-
  2    SS starts timer T325.                                                                                                                       \-                 \-                     \-        \-
  2A   The SS adjusts the SS/PBCH EPRE levels according to row \"T1\" in table 8.1.1.3.7.2-1/2                                                     \-                 \-                     \-        \-
  3    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.5.2.2-1 indicate that the UE is camped on NR Cell 3?   \-                 \-                     1         P
  4    SS waits for T325 expiry.                                                                                                                   \-                 *-*                    \-        \-
  5    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.5.2.2-1 indicate that the UE is camped on NR Cell 1?   \-                 \-                     1         P

##### 8.1.1.3.7.3.3 Specific message contents {#specific-message-contents-10 .H6}

Table 8.1.1.3.7.3.3-1: *RRCRelease* (step 1, Table 8.1.1.3.7.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                         
  --------------------------------------------------- --------------------------- --------- -----------
  Information Element                                 Value/remark                Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                 
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier             
  criticalExtensions CHOICE {                                                               
  rrcRelease SEQUENCE {                                                                     
  deprioritisationReq SEQUENCE {                                                            
  deprioritisationType                                frequency                             
  deprioritisationTimer                               min5                                  
  }                                                                                         
  }                                                                                         
  }                                                                                         
  }                                                                                         

##### 8.1.1.3.7a RRC connection release / Success / Deprioritisation / NR / T325 expiry

##### 8.1.1.3.7a.1 Test Purpose (TP) {#a.1-test-purpose-tp .H6}

##### (1) {#section-29 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCRelease message including IE
deprioritisationReq with deprioritisationType indicating 'nr' and a
deprioritisationTimer }

**then** { UE considers all frequencies of NR to be the lowest priority
frequency (i.e. lower than any of the network configured values) while
T325 is running }

}

##### 8.1.1.3.7a.2 Conformance requirements {#a.2-conformance-requirements .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.8.3 and TS 38.304 clause 5.2.4.1.

\[TS 38.331, clause 5.3.8.3\]

...

The UE shall:

1\> if *deprioritisationReq* is included and the UE supports RRC
connection release with deprioritisation:

2\> start or restart timer T325 with the timer value set to the
*deprioritisationTimer* signalled;

2\> store the *deprioritisationReq* until T325 expiry;

\[TS 38.304, clause 5.2.4.1\]

...

In case UE receives *RRCRelease* with *deprioritisationReq*, UE shall
consider current frequency and stored frequencies due to the previously
received *RRCRelease* with *deprioritisationReq* or all the frequencies
of NR to be the lowest priority frequency (i.e. lower than any of the
network configured values) while T325 is running irrespective of camped
RAT. The UE shall delete the stored deprioritisation request(s) when a
PLMN selection or SNPN selection is performed on request by NAS (TS
23.122 \[9\]).

NOTE: UE should search for a higher priority layer for cell reselection
as soon as possible after the change of priority. The minimum related
performance requirements specified in TS 38.133 \[8\] are still
applicable.

##### 8.1.1.3.7a.3 Test Description {#a.3-test-description .H6}

##### 8.1.1.3.7a.3.1 Pre-test conditions {#a.3.1-pre-test-conditions .H6}

##### System Simulator: {#system-simulator-14 .H6}

\- NR Cell 1 and NR Cell 3 have different tracking areas and equal
priority.

\- E-UTRA Cell 1 is a lower priority cell.

\- System information combination NR-7 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

\- System information combination 31 as defined in TS 36.508 \[7\]
clause 4.4.3.1 is used in E-UTRA Cell.

##### UE: {#ue-14 .H6}

\- None.

##### Preamble: {#preamble-13 .H6}

\- The UE is in 5GS state 3N-A on NR Cell 1 according to TS 38.508-1
\[4\], clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.1.3.7a.3.2 Test procedure sequence {#a.3.2-test-procedure-sequence .H6}

Table 8.1.1.3.7a.3.2-1/2 illustrates the downlink power levels to be
applied for NR Cell 1, NR Cell 3 and E-UTRA Cell 1 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble, while rows marked \"T1\" and \"T2\" are to be
applied subsequently. The exact instants on which these values shall be
applied are described in the texts in this clause.

Table 8.1.1.3.7a.3.2-1: Time instances of cell power level and parameter
changes for conducted test environment

       Parameter               Unit        NR Cell 1   NR Cell 3   E-UTRA Cell 1   Remark
  ---- ----------------------- ----------- ----------- ----------- --------------- -------------------------------------------------------------------------------------------
  T0   SS/PBCH SSS EPRE        dBm/SCS     -88         Off         \-              
       Cell-specific RS EPRE   dBm/15kHz   \-          \-          Off             
  T1   SS/PBCH SSS EPRE        dBm/SCS     -85         -79         \-              The power level values are assigned to satisfy Srxlev~E-UTRA\ Cell\ 1~\> Thresh~x,\ high~
       Cell-specific RS EPRE   dBm/15kHz   \-          \-          -75             

Table 8.1.1.3.7a.3.2-2: Time instances of cell power level and parameter
changes for OTA test envoirnment

       Parameter               Unit        NR Cell 1   NR Cell 3   E-UTRA Cell 1   Remark
  ---- ----------------------- ----------- ----------- ----------- --------------- -------------------------------------------------------------------------------------------
  T0   SS/PBCH SSS EPRE        dBm/SCS     -82         Off         \-              
       Cell-specific RS EPRE   dBm/15kHz   \-          \-          Off             
  T1   SS/PBCH SSS EPRE        dBm/SCS     -82         -91         \-              The power level values are assigned to satisfy Srxlev~E-UTRA\ Cell\ 1~\> Thresh~x,\ high~
       Cell-specific RS EPRE   dBm/15kHz   \-          \-          -96             

Table 8.1.1.3.7a.3.2-3: Main behaviour

  St    Procedure                                                                                                                                           Message Sequence   TP                          Verdict   
  ----- --------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------- --------- ----
                                                                                                                                                            U - S              Message                               
  *1*   *The SS adjusts the SS/PBCH EPRE levels according to row \"T1\" in table 8.1.1.3.7a.3.2-1/2.*                                                       \-                 \-                          \-        \-
  2     The SS transmits an *RRCRelease* message on NR *Cell 1 including IE deprioritisationReq*.                                                           \<\--              NR RRC: *RRCRelease*        \-        \-
  3     SS starts timer T325.                                                                                                                               \-                 \-                          \-        \-
  4     Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.7.2.2-1 is performed and the UE is camped on E-UTRAN Cell 1?   \-                 \-                          1         P
  5     SS waits for T325 expiry.                                                                                                                           \-                 *-*                         \-        \-
  6     Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.9.2.2-1 indicate that the UE is camped on NR Cell 3?           \--\>              NR RRC: *RRCSetupRequest*   1         P

##### 8.1.1.3.7a.3.3 Specific message contents {#a.3.3-specific-message-contents .H6}

Table 8.1.1.3.7a.3.3-1: *RRCRelease* (step 2, Table 8.1.1.3.7a.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                         
  --------------------------------------------------- --------------------------- --------- -----------
  Information Element                                 Value/remark                Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                 
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier             
  criticalExtensions CHOICE {                                                               
  rrcRelease SEQUENCE {                                                                     
  deprioritisationReq SEQUENCE {                                                            
  deprioritisationType                                nr                                    
  deprioritisationTimer                               min5                                  
  }                                                                                         
  }                                                                                         
  }                                                                                         
  }                                                                                         

Table 8.1.1.3.7a.3.3-2: *SystemInformationBlockType24* of E-UTRA Cell 1
(preamble and all steps, Table 8.1.1.3.7a.3.2-3)

  Derivation path: TS 36.508 \[7\], Table 4.4.3.3-20                                                                                        
  --------------------------------------------------------------------------- ----------------------------------------------- ------------- ---------------
  **Information Element**                                                     **Value/Remark**                                **Comment**   **Condition**
  SystemInformationBlockType24-r15 ::= SEQUENCE {                                                                                           
  carrierFreqListNR-r15 SEQUENCE (SIZE (1..maxFreq)) OF CarrierFreqNR-r15 {   2 entries                                                     
  CarrierFreqNR-r15\[1\] SEQUENCE {                                                                                           entry 1       
  carrierFreq-r15                                                             Same downlink SSB ARFCN as used for NR Cell 1                 
  measTimingConfig-r15 SEQUENCE {                                                                                                           
  periodicityAndOffset-r15 CHOICE {                                                                                                         
  sf20                                                                        0                                                             FR1
  sf160                                                                       0                                                             FR2
  }                                                                                                                                         
  ssb-Duration-r15                                                            sf2                                                           FR1
                                                                              sf3                                                           FR2
  }                                                                                                                                         
  }                                                                                                                                         
  CarrierFreqNR-r15\[2\] SEQUENCE {                                                                                           entry 2       
  carrierFreq-r15                                                             Same downlink SSB ARFCN as used for NR Cell 3                 
  measTimingConfig-r15 SEQUENCE {                                                                                                           
  periodicityAndOffset-r15 CHOICE {                                                                                                         
  sf20                                                                        10                                                            FR1
  sf160                                                                       10                                                            FR2
  }                                                                                                                                         
  ssb-Duration-r15                                                            sf2                                                           FR1
                                                                              sf3                                                           FR2
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         

Table 8.1.1.3.7a.3.3-3: *SIB5* of NR Cell 1 in FR2(preamble and all
steps, Table 8.1.1.3.7a.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-4                                                                                      
  ---------------------------------------------------------------------------------- --------------------------------------- ----------- -----------
  Information Element                                                                Value/remark                            Comment     Condition
  SIB5 ::= SEQUENCE {                                                                                                                    
  carrierFreqListEUTRA SEQUENCE (SIZE (1..maxEUTRA-Carrier)) OF CarrierFreqEUTRA {   1 entry                                             
  CarrierFreqEUTRA\[1\] SEQUENCE {                                                                                           entry 1     
  carrierFreq                                                                        Downlink EARFCN as E-UTRA Cell 1 used               
  cellReselectionPriority                                                            1                                                   
  threshX-High                                                                       0                                       0 dB        
  threshX-Low                                                                        0                                       0 dB        
  }                                                                                                                                      
  }                                                                                                                                      
  t-ReselectionEUTRA                                                                 7                                       7 Seconds   
  }                                                                                                                                      

##### 8.1.1.3.7b RRC connection release / Success / Deprioritisation / Deletion of Stored deprioritisation request

##### 8.1.1.3.7b.1 Test Purpose (TP) {#b.1-test-purpose-tp .H6}

\(1\)

with { UE in NR RRC\_CONNECTED state and T325 is running}

ensure that {

when { UE is requested to perform manual PLMN selection }

then { UE deletes the stored deprioritisation request(s) and proceeds
with the PLMN selection }

}

##### 8.1.1.3.7b.2 Conformance requirements {#b.2-conformance-requirements .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.8.3 and TS 38.304 clause 5.2.4.1.

\[TS 38.331, clause 5.3.8.3\]

...

The UE shall:

1\> if *deprioritisationReq* is included and the UE supports RRC
connection release with deprioritisation:

2\> start or restart timer T325 with the timer value set to the
*deprioritisationTimer* signalled;

2\> store the *deprioritisationReq* until T325 expiry;

\[TS 38.304, clause 5.2.4.1\]

...

In case UE receives *RRCRelease* with *deprioritisationReq*, UE shall
consider current frequency and stored frequencies due to the previously
received *RRCRelease* with *deprioritisationReq* or all the frequencies
of NR to be the lowest priority frequency (i.e. lower than any of the
network configured values) while T325 is running irrespective of camped
RAT. The UE shall delete the stored deprioritisation request(s) when a
PLMN selection or SNPN selection is performed on request by NAS (TS
23.122 \[9\]).

NOTE: UE should search for a higher priority layer for cell reselection
as soon as possible after the change of priority. The minimum related
performance requirements specified in TS 38.133 \[8\] are still
applicable.

##### 8.1.1.3.7b.3 Test Description {#b.3-test-description .H6}

##### 8.1.1.3.7b.3.1 Pre-test conditions {#b.3.1-pre-test-conditions .H6}

##### System Simulator: {#system-simulator-15 .H6}

\- 2 NR cells: NR Cells 1 and 3 as specified in TS 38.508-1 \[4\] table
6.3.2.2-1 are configured as shown in Table 8.1.1.3.7b.3.1--1. PLMN
settings are defined in TS 36.523-1 \[13\] table 6.0.1-1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

Table 8.1.1.3.7b.3.1-1: PLMN identifiers

  NR Cell     PLMN identifiers
  ----------- ------------------
              
  NR Cell 1   PLMN1
  NR Cell 3   PLMN2

##### UE: {#ue-15 .H6}

\- None.

##### Preamble: {#preamble-14 .H6}

\- The UE is in 5GS state 3N-A on NR Cell 1 according to TS 38.508-1
\[4\], clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.1.3.7b.3.2 Test procedure sequence {#b.3.2-test-procedure-sequence .H6}

Table 8.1.1.3.7b.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1, Cell 2 and Cell 3 at various time instants of the
test execution. Row marked \"T0\" denotes the conditions after the
preamble, while rows marked \"T1\" and \"T2\" are to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.1.3.7b.3.2-1: Time instances of cell power level and parameter
changes for FR1

       Parameter          Unit      NR Cell 1   NR Cell 3   Remark
  ---- ------------------ --------- ----------- ----------- -----------------------------------------------------------------------
  T0   SS/PBCH SSS EPRE   dBm/SCS   -88         Off         
  T1   SS/PBCH SSS EPRE   dBm/SCS   -85         -91         The power level values are set so that R~NRCell\ 1~ \> R ~NRCell\ 3~.

Table 8.1.1.3.7b.3.2-2: Time instances of cell power level and parameter
changes for FR2

       Parameter          Unit      NR Cell 1   NR Cell 3   Remark
  ---- ------------------ --------- ----------- ----------- -----------------------------------------------------------------------
  T0   SS/PBCH SSS EPRE   dBm/SCS   -82         Off         
  T1   SS/PBCH SSS EPRE   dBm/SCS   -82         -91         The power level values are set so that R~NRCell\ 1~ \> R ~NRCell\ 3~.

Table 8.1.1.3.7b.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                      Message Sequence   TP                          Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------- --------- ----
                                                                                                                                                                      U - S              Message                               
  1    The SS adjusts the SS/PBCH EPRE levels according to row \"T1\" in table 8.1.1.3.7b.2-1/2.                                                                      \-                 \-                          \-        \-
  2    The SS transmits an *RRCRelease* message on NR *Cell 1 including IE deprioritisationReq*.                                                                      \<\--              NR RRC: *RRCRelease*        \-        \-
  3    SS starts timer T325.                                                                                                                                          \-                 \-                          \-        \-
  4    PLMN2 is manually selected.                                                                                                                                                                                             
  5    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.5.2.2-1 indicate that the UE is camped on NR Cell 3?                      \--\>              NR RRC: *RRCSetupRequest*   \-        \-
  6    PLMN1 is manually selected before T325 expiry.                                                                                                                 \-                 *-*                         \-        \-
  7    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.5.2.2-1 indicate that the UE is camped on NR Cell 1 before T325 expiry?   \--\>              NR RRC: *RRCSetupRequest*   1         P

##### 8.1.1.3.7b.3.3 Specific message contents {#b.3.3-specific-message-contents .H6}

Table 8.1.1.3.7b.3.3-1: *RRCRelease* (step 2, Table 8.1.1.3.7b.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                         
  --------------------------------------------------- --------------------------- --------- -----------
  Information Element                                 Value/remark                Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                 
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier             
  criticalExtensions CHOICE {                                                               
  rrcRelease SEQUENCE {                                                                     
  deprioritisationReq SEQUENCE {                                                            
  deprioritisationType                                frequency                             
  deprioritisationTimer                               min5                                  
  }                                                                                         
  }                                                                                         
  }                                                                                         
  }                                                                                         

##### 8.1.1.3.8 RRC connection release / Redirection to another NR frequency / MPS Priority Indication

##### 8.1.1.3.8.1 Test Purpose (TP) {#test-purpose-tp-11 .H6}

##### (1) {#section-30 .H6}

**with** { UE in 5GMM-REGISTERED.NORMAL-SERVICE state and 5GMM-IDLE mode
and User initiates an MMTEL call }

**ensure that** {

**when** { UE receives an RRCRelease message including
mpsPriorityIndication-r16 and the IE redirectedCarrierInfo with nr and
carrierFreq different from the frequency UE was on in RRC\_CONNECTED
state }

**then** { UE establishes an RRC connection with establishmentCause set
to mps-PriorityAccess on the new frequency included in IE
redirectedCarrierInfo }

}

##### 8.1.1.3.8.2 Conformance requirements {#conformance-requirements-11 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.3.3. Unless otherwise stated these
are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.3\]

The UE shall set the contents of *RRCSetupRequest* message as follows:

1\> set the *ue-Identity* as follows:

2\> if upper layers provide a 5G-S-TMSI:

3\> set the *ue-Identity* to *ng-5G-S-TMSI-Part1*;

2\> else:

3\> draw a 39-bit random value in the range 0..2^39^-1 and set the
*ue-Identity* to this value;

NOTE 1: Upper layers provide the *5G-S-TMSI* if the UE is registered in
the TA of the current cell.

1\> if the establishment of the RRC connection is the result of release
with redirect with *mpsPriorityIndication* (either in NR or E-UTRAN):

2\> set the *establishmentCause* to *mps-PriorityAccess*;

1\> else:

2\> set the *establishmentCause* in accordance with the information
received from upper layers;

...

##### 8.1.1.3.8.3 Test description {#test-description-11 .H6}

##### 8.1.1.3.8.3.1 Pre-test conditions {#pre-test-conditions-11 .H6}

##### System Simulator: {#system-simulator-16 .H6}

\- 2 cells on different NR frequencies and different tracking areas:

\- NR Cell 1 (TAI-1) serving cell

\- NR Cell 23 (TAI-2) suitable neighbour inter-frequency cell

\- Cell power levels are selected according to 38.508-1 \[4\] Table
6.2.2.1-3 for FR1 or Table 6.2.2.2-2 for FR2. NR Cell 23 is switched on
after UE has registered on NR Cell 1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-16 .H6}

\- None.

##### Preamble: {#preamble-15 .H6}

\- The UE is in test state 1N-A with IMS registered as defined in TS
38.508-1 \[4\], subclause 4.4A.2 on NR Cell 1.

##### 8.1.1.3.8.3.2 Test procedure sequence {#test-procedure-sequence-12 .H6}

Table 8.1.1.3.8.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | *Make the | \-        | \-        | \-      | \- |
|           | UE        |           |           |         |    |
|           | attempt a |           |           |         |    |
|           | MMTel     |           |           |         |    |
|           | voice     |           |           |         |    |
|           | call.*    |           |           |         |    |
|           |           |           |           |         |    |
|           | *(NOTE    |           |           |         |    |
|           | 1)*       |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2-9b4     | *Steps 2  | \-        | \-        | \-      | \- |
|           | to 9b4    |           |           |         |    |
|           | from test |           |           |         |    |
|           | procedure |           |           |         |    |
|           | for IMS   |           |           |         |    |
|           | MO speech |           |           |         |    |
|           | call      |           |           |         |    |
|           | esta      |           |           |         |    |
|           | blishment |           |           |         |    |
|           | as        |           |           |         |    |
|           | described |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.9       |           |           |         |    |
|           | .15.2.2-1 |           |           |         |    |
|           | take      |           |           |         |    |
|           | place.*   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | *The SS   | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | RR        |         |    |
|           | an        |           | CRelease* |         |    |
|           | R         |           |           |         |    |
|           | RCRelease |           |           |         |    |
|           | message   |           |           |         |    |
|           | (IE       |           |           |         |    |
|           | redi      |           |           |         |    |
|           | rectedCar |           |           |         |    |
|           | riexrInfo |           |           |         |    |
|           | including |           |           |         |    |
|           | NR Cell   |           |           |         |    |
|           | 23 and IE |           |           |         |    |
|           | mpsPri    |           |           |         |    |
|           | orityIndi |           |           |         |    |
|           | cation).* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11        | *Check:   | \--\>     | NR RRC:   | 1       | P  |
|           | Does the  |           | *RRCSetu  |         |    |
|           | UE        |           | pRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | RRCSet    |           |           |         |    |
|           | upRequest |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | the       |           |           |         |    |
|           | establish |           |           |         |    |
|           | mentCause |           |           |         |    |
|           | as        |           |           |         |    |
|           | mps-Prior |           |           |         |    |
|           | ityAccess |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | cell 23?* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12-13     | *Steps 2  | \-        | \-        | \-      | \- |
|           | to 3 of   |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.5      |           |           |         |    |
|           | 08-1\[4\] |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.        |           |           |         |    |
|           | 9.5.2.2-1 |           |           |         |    |
|           | are       |           |           |         |    |
|           | performed |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 23.* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14        | *The SS   | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Se       |         |    |
|           | a         |           | curityMod |         |    |
|           | S         |           | eCommand* |         |    |
|           | ecurityMo |           |           |         |    |
|           | deCommand |           |           |         |    |
|           | message.* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15        | *The UE   | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *Sec      |         |    |
|           | a         |           | urityMode |         |    |
|           | Se        |           | Complete* |         |    |
|           | curityMod |           |           |         |    |
|           | eComplete |           |           |         |    |
|           | message.* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 16-17     | *Steps 4  | \-        | \-        | \-      | \- |
|           | to 5 of   |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.5      |           |           |         |    |
|           | 08-1\[4\] |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.        |           |           |         |    |
|           | 9.5.2.2-1 |           |           |         |    |
|           | are       |           |           |         |    |
|           | performed |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 23.* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 18        | *The SS   | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCReconfi |         |    |
|           | RRCReconf |           | guration* |         |    |
|           | iguration |           |           |         |    |
|           | message   |           |           |         |    |
|           | to        |           |           |         |    |
|           | establish |           |           |         |    |
|           | SRB2 and  |           |           |         |    |
|           | DRB.*     |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 19        | *The UE   | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCReconf |         |    |
|           | RRCRecon  |           | iguration |         |    |
|           | figuratio |           | Complete* |         |    |
|           | nComplete |           |           |         |    |
|           | message.* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 20        | Void      | \-        | \-        | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 21-24b3   | Step 10   | \-        | \-        | \-      | \- |
|           | to 13b3   |           |           |         |    |
|           | of IMS MO |           |           |         |    |
|           | speech    |           |           |         |    |
|           | call      |           |           |         |    |
|           | esta      |           |           |         |    |
|           | blishment |           |           |         |    |
|           | in 5GC as |           |           |         |    |
|           | defined   |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.9       |           |           |         |    |
|           | .15.2.2-1 |           |           |         |    |
|           | are       |           |           |         |    |
|           | p         |           |           |         |    |
|           | erformed. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 25        | The       | \-        | \-        | \-      | \- |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | for IMS   |           |           |         |    |
|           | MT call   |           |           |         |    |
|           |           |           |           |         |    |
|           | release   |           |           |         |    |
|           | in 5GC as |           |           |         |    |
|           | specified |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.9       |           |           |         |    |
|           | .18.2.2-1 |           |           |         |    |
|           | takes     |           |           |         |    |
|           | place.    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 26        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | R         |           |           |         |    |
|           | RCRelease |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| NOTE 1:   |           |           |           |         |    |
| This      |           |           |           |         |    |
| could be  |           |           |           |         |    |
| done by   |           |           |           |         |    |
| e.g. MMI  |           |           |           |         |    |
| or AT     |           |           |           |         |    |
| command.  |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.1.3.8.3.3 Specific message contents {#specific-message-contents-11 .H6}

Table 8.1.1.3.8.3.3-1: SIB4 for NR cells 1 and 23 (preamble and all
steps, Table 8.1.1.3.8.3.2-1)

  ------------------------------------------------------------------------------------- ----------------------------------------------- --------- ------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.2-3                                                                                                
  Information Element                                                                   Value/remark                                    Comment   Condition
  SIB4 ::= SEQUENCE {                                                                                                                             
  interFreqCarrierFreqList SEQUENCE (SIZE (1..maxFreq)) OF InterFreqCarrierFreqInfo {   1 entry                                                   
  InterFreqCarrierFreqInfo\[1\] SEQUENCE {                                                                                              entry 1   
  dl-CarrierFreq                                                                        Same downlink NR ARFCN as used for NR Cell 23             NR Cell 1
                                                                                        Same downlink NR ARFCN as used for NR Cell 1              NR Cell 23
  cellReselectionPriority                                                               Not present                                               
  }                                                                                                                                               
  }                                                                                                                                               
  }                                                                                                                                               
  ------------------------------------------------------------------------------------- ----------------------------------------------- --------- ------------

Table 8.1.1.3.8.3.3-2: *RRCRelease* message (step 10, Table
8.1.1.3.8.3.2-1)

  --------------------------------------------------- ------------------------------------------ -------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                                                               
  Information Element                                 Value/remark                               Comment                          Condition
  RRCRelease ::= SEQUENCE {                                                                                                       
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier                                                   
  criticalExtensions CHOICE {                                                                                                     
  rrcRelease SEQUENCE {                                                                                                           
  redirectedCarrierInfo CHOICE {                                                                                                  
  nr SEQUENCE {                                                                                                                   
  carrierFreq                                         ARFCN-ValueNR for NR Cell 23 frequency                                      
  ssbSubcarrierSpacing                                Subcarrier spacing of SSB for NR Cell 23                                    
  smtc                                                SSB-MTC                                    38.508-1 \[4\] Table 4.6.3-185   
  }                                                                                                                               
  }                                                                                                                               
  nonCriticalExtension SEQUENCE {                                                                                                 
  nonCriticalExtension SEQUENCE {                                                                                                 
  nonCriticalExtension SEQUENCE {                                                                                                 
  mpsPriorityIndication-r16                           true                                                                        
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  --------------------------------------------------- ------------------------------------------ -------------------------------- -----------

Table 8.1.1.3.8.3.3-3: *RRCSetupRequest* (step 11, Table
8.1.1.3.8.3.2-1)

  ---------------------------------------------------- -------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-23                                  
  Information Element                                  Value/remark         Comment   Condition
  RRCSetupRequest ::= SEQUENCE {                                                      
  rrcSetupRequest SEQUENCE {                                                          
  establishmentCause                                   mps-PriorityAccess             
  }                                                                                   
  }                                                                                   
  ---------------------------------------------------- -------------------- --------- -----------

##### 8.1.1.3.9 RRC connection release / Success / With slice specific cell reselection information

##### 8.1.1.3.9.1 Test Purpose (TP) {#test-purpose-tp-12 .H6}

##### (1) {#section-31 .H6}

**with** { UE in RRC\_IDLE state having received an RRCRelease message
with slice specific cell reselection information }

**ensure that** {

**when** { UE detects the cell reselection criteria is met for two cells
on different frequencies supporting different NAS-provided NSAG
priorities }

**then** { UE reselects to the cell on the frequency which supports
higher priority NSAG }

}

##### (2) {#section-32 .H6}

**with** { UE in RRC\_IDLE state having received an RRCRelease message
with slice specific cell reselection information }

**ensure that** {

**when** { UE detects the cell reselection criteria is met for two cells
on different frequencies supporting same NAS-provided NSAG priority }

**then** { UE reselects to the cell on the frequency which supports the
NSAG having higher nsag-CellReselectionPriority }

}

##### (3) {#section-33 .H6}

**with** { UE in RRC\_CONNECTED state having received slice specific
cell reselection information in SIB16 }

**ensure that** {

**when** { UE receives RRCRelease including nsag-CellReselectionPriority
}

**then** { UE shall ignore any fields with nsag-CellReselectionPriority
provided in system information and stores new
nsag-CellReselectionPriority in RRCRelease }

}

##### 8.1.1.3.9.2 Conformance requirements {#conformance-requirements-12 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.304, clause 5.2.4.11, and TS 38.331 clause
5.3.8.3. Unless otherwise stated these are Rel-17 requirements.

\[TS 38.304, clause 5.2.4.11\]

The UE derives reselection priorities for slice-based cell reselection
by using:

\- NAS provided NSAG information, only for NSAG(s) associated with the
network slice(s) provided by NAS for cell reselection (see TS 23.501
\[10\], TS 24.501 \[14\]),

\- *sliceInfoList* and/or *sliceInfoListDedicated* per frequency with
*nsag-CellReselectionPriority* per NSAG, if provided in system
information and/or dedicated signalling (see TS 38.331 \[3\]),

\- *cellReselectionPriority* per frequency provided in system
information and/or dedicated signalling (see TS 38.331 \[3\]).

The UE considers an NR frequency to support all slices of an NSAG if

\- the nsag-ID and TA of the NSAG as provided by NAS are indicated for
the NR frequency (see TS 38.331\[3\]). If
*FreqPriorityListDedicatedSlicing* is configured, UE only considers the
NSAG-frequency pairs indicated in *FreqPriorityListDedicatedSlicing* for
slice-based cell reselection.

The UE considers a cell on an NR frequency to support all slices of an
NSAG if

*-* the nsag-ID and TA of the NSAG as provided by NAS are indicated for
the NR frequency in dedicated signalling but not in *SIB16* (see TS
38.331 \[3\]); or

*-* the nsag-ID and TA of the NSAG as provided by NAS are indicated for
the NR frequency in *SIB16* (see TS 38.331 \[3\]); and

\- the cell is either listed in the *sliceAllowedCellListNR* (if
provided in the *sliceInfoList*) or the cell is not listed in the
*sliceExcludedCellListNR* (if provided in the *sliceInfoList*); or

\- Neither *sliceAllowedCellListNR* nor *sliceExcludedCellListNR* is
configured in the *sliceInfoList*.

The UE shall derive reselection priorities for slice-based cell
reselection according to the following rules:

\- Frequencies that support at least one prioritized NSAG received from
NAS have higher reselection priority than frequencies that support none
of the NSAG(s) received from NAS.

\- Frequencies that support at least one NSAG provided by NAS are
prioritised in the order of the NAS-provided priority for the NSAG with
highest priority supported on the frequency.

\- Among the frequencies (one or multiple) that support the highest
prioritised NSAG(s) with the same NAS-provided priorities, the
frequencies are prioritized in the order of their highest
*nsag-CellReselectionPriority* given for these NSAG(s). If no
*nsag-CellReselectionPriority* is given for a NSAG at a frequency, the
lowest priority value is used (i.e., lower than any of the network
configured values for these frequencies).

\- Frequencies that support none of the NSAG(s) provided by NAS are
prioritized in the order of their *cellReselectionPriority*.

For a UE performing slice-based cell reselection, if the highest ranked
cell or best cell in a frequency fulfils the inter-frequency cell
reselection criteria (see clause 5.2.4.5) based on reselection priority
for the frequency and NSAG derived according to this clause or fulfils
intra-frequency and equal priority inter-frequency cell reselection
criteria (see clause 5.2.4.6), but this cell does not support the NSAG
according to this clause:

\- if this cell supports any other NSAG(s) according to this clause, the
UE shall re-derive a reselection priority for the frequency by
considering the NSAG(s) supported by this cell (rather than those of the
corresponding NR frequency);

\- Otherwise, the UE shall re-derive a reselection priority for the
frequency as if none of the NSAG(s) provided by NAS is supported.

This re-derived reselection priority is used for a maximum of 300
seconds, or until new network slice(s) and/or NSAG information are
received from NAS. UE shall ensure the cell reselection criteria above
are fulfilled based on the newly derived priorities.

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> delay the following actions defined in this clause 60 ms from the
moment the *RRCRelease* message was received or optionally when lower
layers indicate that the receipt of the *RRCRelease* message has been
successfully acknowledged, whichever is earlier;

1\> stop timer T380, if running;

1\> stop timer T320, if running;

1\> if timer T316 is running;

2\> stop timer T316;

2\> clear the information included in *VarRLF-Report,* if any;

1\> stop timer T350, if running;

1\> stop timer T346g, if running;

1\> if the AS security is not activated:

2\> ignore any field included in *RRCRelease* message except *waitTime*;

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11
with the release cause \'other\' upon which the procedure ends;

1\> if the *RRCRelease* message includes *redirectedCarrierInfo*
indicating redirection to *eutra*:

2\> if *cnType* is included:

3\> after the cell selection, indicate the available CN Type(s) and the
received *cnType* to upper layers;

NOTE 1: Handling the case if the E-UTRA cell selected after the
redirection does not support the core network type specified by the
*cnType,* is up to UE implementation.

2\> if *voiceFallbackIndication* is included:

3\> consider the RRC connection release was for EPS fallback for IMS
voice (see TS 23.502 \[43\]);

1\> if the *RRCRelease* message includes the
*cellReselectionPriorities*:

2\> store the cell reselection priority information provided by the
*cellReselectionPriorities*;

2\> if the *t320* is included:

3\> start timer T320, with the timer value set according to the value of
*t320*;

1\> else:

2\> apply the cell reselection priority information broadcast in the
system information;

1\> if *deprioritisationReq* is included and the UE supports RRC
connection release with deprioritisation:

2\> start or restart timer T325 with the timer value set to the
*deprioritisationTimer* signalled;

2\> store the *deprioritisationReq* until T325 expiry;

NOTE 1a: The UE stores the deprioritisation request irrespective of any
cell reselection absolute priority assignments (by dedicated or common
signalling) and regardless of RRC connections in NR or other RATs unless
specified otherwise.

1\> if the *RRCRelease* includes the *measIdleConfig*:

2\> if T331 is running:

3\> stop timer T331;

3\> perform the actions as specified in 5.7.8.3;

2\> if the *measIdleConfig* is set to *setup*:

3\> store the received *measIdleDuration* in *VarMeasIdleConfig*;

3\> start timer T331 with the value set to *measIdleDuration*;

3\> if the *measIdleConfig* contains *measIdleCarrierListNR*:

4\> store the received *measIdleCarrierListNR* in *VarMeasIdleConfig*;

3\> if the *measIdleConfig* contains *measIdleCarrierListEUTRA*:

4\> store the received *measIdleCarrierListEUTRA* in
*VarMeasIdleConfig*;

3\> if the *measIdleConfig* contains *validityAreaList*:

4\> store the received *validityAreaList* in *VarMeasIdleConfig*;

1\> if the *RRCRelease* includes *suspendConfig*:

2\> reset MAC and release the default MAC Cell Group configuration, if
any;

2\> apply the received *suspendConfig except the received
nextHopChainingCount*;

2\> if the *sdt-Config* is configured:

3\> for each of the DRB in the *sdt-DRB-List*:

4\> consider the DRB to be configured for SDT;

3\> if *sdt-SRB2-Indication* is configured:

4\> consider the SRB2 to be configured for SDT;

3\> for each RLC bearer (except those associated with broadcast MRBs)
that is not suspended:

4\> re-establish the RLC entity as specified in TS 38.322 \[4\];

3\> for SRB2 (if it is resumed) and for SRB1:

4\> trigger the PDCP entity to perform SDU discard as specified in TS
38.323 \[5\];

3\> if *sdt-MAC-PHY-CG-Config* is configured:

4\> configure the PCell with the configured grant resources for SDT and
instruct the MAC entity to start the *cg-SDT-TimeAlignmentTimer*;

2\> if *srs-PosRRC-Inactive* is configured:

3\> *apply* the configuration and instruct MAC to start the
*inactivePosSRS-TimeAlignmentTimer*;

NOTE 1b: The Network should provide full configuration to UE for SRS for
Positioning in RRC\_INACTIVE.

2\> remove all the entries within the MCG and the SCG
*VarConditionalReconfig*, if any;

2\> for each *measId* of the MCG *measConfig* and for each *measId* of
the SCG *measConfig*, if configured, if the associated *reportConfig*
has a *reportType* set to *condTriggerConfig*:

3\> for the associated *reportConfigId*:

4\> remove the entry with the matching *reportConfigId* from the
*reportConfigList* within the *VarMeasConfig*;

3\> if the associated *measObjectId* is only associated to a
*reportConfig* with *reportType* set to *condTriggerConfig*:

4\> remove the entry with the matching *measObjectId* from the
*measObjectList* within the *VarMeasConfig*;

3\> remove the entry with the matching *measId* from the *measIdList*
within the *VarMeasConfig*;

2\> if the UE is acting as L2 U2N Remote UE:

3\> if the PC5-RRC connection with the U2N Relay UE is determined to be
released:

4\> indicate upper layers to trigger PC5 unicast link release;

3\> else (i.e., maintain the PC5 RRC connection):

4\> establish or re-establish (e.g. via release and add) SL RLC entity
for SRB1;

> 2\> else:

3\> re-establish RLC entities for SRB1;

2\> if the *RRCRelease* message with *suspendConfig* was received in
response to an *RRCResumeRequest* or an *RRCResumeRequest1*:

3\> stop the timer T319 if running;

3\> in the stored UE Inactive AS context:

4\> replace the K~gNB~ and K~RRCint~ keys with the current K~gNB~ and
K~RRCint~ keys;

4\> replace the *nextHopChainingCount* with the value of
*nextHopChainingCount* received in the *RRCRelease message;*

4\> replace the *cellIdentity* with the *cellIdentity* of the cell the
UE has received the *RRCRelease* message;

4\> if the *suspendConfig* contains the *sl-UEIdentityRemote* (i.e. the
UE is a L2 U2N Remote UE):

5\> replace the C-RNTI with the value of the *sl-UEIdentityRemote*;

5\> replace the physical cell identity with the value of the
*sl-PhysCellId* in *sl-ServingCellInfo* contained in the discovery
message received from the connected L2 U2N Relay UE;

4\> else:

5\> replace the C-RNTI with the C-RNTI used in the cell (see TS 38.321
\[3\]) the UE has received the *RRCRelease* message;

5\> replace the physical cell identity with the physical cell identity
of the cell the UE has received the *RRCRelease* message;

3\> replace the *nextHopChainingCount* with the value associated with
the current K~gNB~;

3\> stop the timer T319a if running and consider SDT procedure is not
ongoing;

2\> else:

3\> store in the UE Inactive AS Context the *nextHopChainingCount*
received in the *RRCRelease message,* the current K~gNB~ and K~RRCint~
keys, the ROHC state, the EHC context(s), the UDC state, the stored QoS
flow to DRB mapping rules, the application layer measurement
configuration, the C-RNTI used in the source PCell, the *cellIdentity*
and the physical cell identity of the source PCell, the
*spCellConfigCommon* within *ReconfigurationWithSync* of the NR PSCell
(if configured) and all other parameters configured except for:

\- parameters within *ReconfigurationWithSync* of the PCell;

\- parameters within *ReconfigurationWithSync* of the NR PSCell, if
configured;

\- parameters within *MobilityControlInfoSCG* of the E-UTRA PSCell, if
configured;

\- *servingCellConfigCommonSIB*;

\- *sl-L2RelayUE-Config*, if configured*;*

\- *sl-L2RemoteUE-Config*, if configured;

NOTE 1c: *suspendConfig* is not stored as part of UE Inactive AS
Context, except for the fields explicitly specified.

3\> store any previously or subsequently received application layer
measurement report containers for which no segment, or full message, has
been submitted to lower layers for transmission;

NOTE 2: NR sidelink communication/discovery related configurations and
logged measurement configuration are not stored as UE Inactive AS
Context, when UE enters RRC\_INACTIVE.

2\> suspend all SRB(s) and DRB(s) and multicast MRB(s), except SRB0 and
broadcast MRBs;

2\> indicate PDCP suspend to lower layers of all DRBs and multicast
MRBs;

2\> release Uu Relay RLC channel(s), if configured;

2\> release PC5 Relay RLC channel(s), if configured;

2\> release the SRAP entity, if configured;

2\> if the *t380* is included:

3\> start timer T380, with the timer value set to *t380*;

2\> if the *RRCRelease* message is including the *waitTime*:

3\> start timer T302 with the value set to the *waitTime*;

3\> inform upper layers that access barring is applicable for all access
categories except categories \'0\' and \'2\';

2\> if T390 is running:

3\> stop timer T390 for all access categories;

3\> perform the actions as specified in 5.3.14.4;

2\> indicate the suspension of the RRC connection to upper layers;

2\> if the UE is capable of L2 U2N Remote UE:

3\> enter RRC\_INACTIVE, and perform either cell selection as specified
in TS 38.304 \[20\], or relay selection as specified in clause 5.8.15.3,
or both;

2\> else:

3\> enter RRC\_INACTIVE and perform cell selection as specified in TS
38.304 \[20\];

1\> else:

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with the release cause \'other\'.

NOTE 3: Whether to release the PC5 unicast link is left to L2 U2N Remote
UE\'s implementation.

NOTE 4: It is left to UE implementation whether to stop T430, if
running, when going to RRC\_INACTIVE.

##### 8.1.1.3.9.3 Test description {#test-description-12 .H6}

##### 8.1.1.3.9.3.1 Pre-test conditions {#pre-test-conditions-12 .H6}

##### System Simulator: {#system-simulator-17 .H6}

\- NR Cell 1, NR Cell 3 and NR Cell 6.

\- System information combination NR-30 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-17 .H6}

> \- None

##### Preamble: {#preamble-16 .H6}

> \- The UE is in state Switched OFF (state 0N-B) according to TS
> 38.508-1 \[4\].

##### 8.1.1.3.9.3.2 Test procedure sequence {#test-procedure-sequence-13 .H6}

Table 8.1.1.3.9.3.2-1 for FR1 and Table 8.1.1.3.9.3.2-2 for FR2
illustrate the downlink power levels and other changing parameters to be
applied for the cells at various time instants of the test execution.
The exact instants on which these values shall be applied are described
in the texts in this clause. The configuration \"T0\" indicates the
initial conditions. Subsequent configurations marked \"T1\", \"T2\" and
\"T3\" are applied at the points indicated in the Main behaviour
description in Table 8.1.1.3.9.3.2-3.

Table 8.1.1.3.9.3.2-1: Time instances of cell power level and parameter
changes for FR1

+---------+---------+---------+---------+---------+---------+---------+
|         | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|         | rameter |         | 1       | 3       | 6       |         |
+=========+=========+=========+=========+=========+=========+=========+
| T0      | SS/PBCH | dBm/SCS | -88     | Off     | Off     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | ensure  |
|         |         |         |         |         |         | the UE  |
|         |         |         |         |         |         | reg     |
|         |         |         |         |         |         | istered |
|         |         |         |         |         |         | on NR   |
|         |         |         |         |         |         | Cell 1. |
+---------+---------+---------+---------+---------+---------+---------+
| T1      | SS/PBCH | dBm/SCS | -88     | -78     | Off     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | R~NR\ C |
|         |         |         |         |         |         | ell\ 1~ |
|         |         |         |         |         |         | \<      |
|         |         |         |         |         |         | R       |
|         |         |         |         |         |         | ~NR\ Ce |
|         |         |         |         |         |         | ll\ 3~. |
+---------+---------+---------+---------+---------+---------+---------+
| T2      | SS/PBCH | dBm/SCS | Off     | -88     | -78     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | R~NR\ C |
|         |         |         |         |         |         | ell\ 3~ |
|         |         |         |         |         |         | \<      |
|         |         |         |         |         |         | R       |
|         |         |         |         |         |         | ~NR\ Ce |
|         |         |         |         |         |         | ll\ 6~. |
+---------+---------+---------+---------+---------+---------+---------+
| Note:   |         |         |         |         |         |         |
| Power   |         |         |         |         |         |         |
| level   |         |         |         |         |         |         |
| "Off"   |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| defined |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| TS3     |         |         |         |         |         |         |
| 8.508-1 |         |         |         |         |         |         |
| \[4\]   |         |         |         |         |         |         |
| Table   |         |         |         |         |         |         |
| 6.2     |         |         |         |         |         |         |
| .2.1-3. |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.1.3.9.3.2-2: Time instances of cell power level and parameter
changes for FR2

+---------+---------+---------+---------+---------+---------+---------+
|         | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|         | rameter |         | 1       | 3       | 6       |         |
+=========+=========+=========+=========+=========+=========+=========+
| T0      | SS/PBCH | dBm/SCS | -91     | Off     | Off     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | ensure  |
|         |         |         |         |         |         | the UE  |
|         |         |         |         |         |         | reg     |
|         |         |         |         |         |         | istered |
|         |         |         |         |         |         | on NR   |
|         |         |         |         |         |         | Cell 1. |
+---------+---------+---------+---------+---------+---------+---------+
| T1      | SS/PBCH | dBm/SCS | -91     | -82     | Off     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | R~NR\ C |
|         |         |         |         |         |         | ell\ 1~ |
|         |         |         |         |         |         | \<      |
|         |         |         |         |         |         | R       |
|         |         |         |         |         |         | ~NR\ Ce |
|         |         |         |         |         |         | ll\ 3~. |
+---------+---------+---------+---------+---------+---------+---------+
| T2      | SS/PBCH | dBm/SCS | Off     | -91     | -82     | The     |
|         |         |         |         |         |         | power   |
|         | SSS     |         |         |         |         | level   |
|         | EPRE    |         |         |         |         | values  |
|         |         |         |         |         |         | are     |
|         |         |         |         |         |         | a       |
|         |         |         |         |         |         | ssigned |
|         |         |         |         |         |         | to      |
|         |         |         |         |         |         | satisfy |
|         |         |         |         |         |         | R~NR\ C |
|         |         |         |         |         |         | ell\ 3~ |
|         |         |         |         |         |         | \<      |
|         |         |         |         |         |         | R       |
|         |         |         |         |         |         | ~NR\ Ce |
|         |         |         |         |         |         | ll\ 6~. |
+---------+---------+---------+---------+---------+---------+---------+
| Note:   |         |         |         |         |         |         |
| Power   |         |         |         |         |         |         |
| level   |         |         |         |         |         |         |
| "Off"   |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| defined |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| TS3     |         |         |         |         |         |         |
| 8.508-1 |         |         |         |         |         |         |
| \[4\]   |         |         |         |         |         |         |
| Table   |         |         |         |         |         |         |
| 6.2     |         |         |         |         |         |         |
| .2.1-3. |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.1.3.9.3.2-3: Main behaviour

  St                                                                                                                                                                           Procedure                                                                                                                                   Message Sequence   TP                          Verdict   
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------- --------- ----
                                                                                                                                                                                                                                                                                                                           U - S              Message                               
  1                                                                                                                                                                            The UE is switched on.                                                                                                                      \-                 \-                          \-        \-
  2-13                                                                                                                                                                         Steps 2 to 13 of the generic procedure for NR RRC\_IDLE specified in TS 38.508-1 subclause 4.5.2 are performed.                             \-                 \-                          \-        \-
  14                                                                                                                                                                           The SS transmits a REGISTRATION ACCEPT message.                                                                                             \<\--              5GMM: REGISTRATION ACCEPT   \-        \-
  15-19Aa2                                                                                                                                                                     Steps 15 to 19Aa2 of the generic procedure for NR RRC\_IDLE specified in TS 38.508-1 subclause 4.5.2 are performed.                         \-                 \-                          \-        \-
  20                                                                                                                                                                           The SS transmits an RRCRelease message including the nsag-CellReselectionPriority on NR Cell 1.                                             \<\--              NR RRC: *RRCRelease*        \-        \-
  21                                                                                                                                                                           The SS changes NR Cell 3 and NR Cell 6 SSS levels according to the row \"T1\" in table 8.1.1.3.9.3.2-1/2.                                   \-                 \-                          \-        \-
  22                                                                                                                                                                           Wait for 66\[FR1\]/258\[FR2\] seconds to allow UE to recognise the change.                                                                  \-                 \-                          \-        \-
  23                                                                                                                                                                           Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.4.2.2-1 indicate that the UE is camped on NR Cell 3?   \--\>              NR RRC: *RRCSetupRequest*   1         P
  24-29                                                                                                                                                                        Steps 3 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.9.4.2.2-1 are performed.                                                 \-                 \-                          \-        \-
  30                                                                                                                                                                           The SS transmits an RRCRelease message including the nsag-CellReselectionPriority on NR Cell 3.                                             \<\--              NR RRC: *RRCRelease*        \-        \-
  31                                                                                                                                                                           The SS changes NR Cell 1 and NR Cell 6 SSS levels according to the row \"T2\" in table 8.1.1.3.9.3.2-1/2.                                   \-                 \-                          \-        \-
  32                                                                                                                                                                           Wait for 34\[FR1\]/130\[FR2\] seconds to allow UE to recognise the change.                                                                  \-                 \-                          \-        \-
  33                                                                                                                                                                           Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.4.2.2-1 indicate that the UE is camped on NR Cell 6?   \-                 \-                          2, 3      P
  Note: The wait time at steps 22 and 32 is K~carrier~\*T~detect,NR\_Inter~ (as per TS 38.133 \[30\], clause 4.2.2.4) plus the time to read the system information T~SI-NR.~                                                                                                                                                                                                        

##### 8.1.1.3.9.3.3 Specific message contents {#specific-message-contents-12 .H6}

Table 8.1.1.3.9.3.3-1: REGISTRATION ACCEPT (step 14, Table
8.1.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 Table 4.7.1-7                                
  -------------------------------------------- -------------- ------------- -----------
  Information Element                          Value/remark   Comment       Condition
  NSAG information                                                          
  NSAG information IEI                                                      
  Length of NSAG information contents          2 entities                   
  NSAG 1                                                                    
  Length of NSAG                               1 entity                     
  NSAG identifier                              '00000001'B                  
  S-NSSAI list of NSAG                                                      
  Length of S-NSSAI list of NSAG                                            
  S-NSSAI value 1                                                           
  S-NSSAI IEI                                                               
  Length of S-NSSAI contents                   '00000001'B    SST           
  SST                                          '00000001'B    SST value 1   
  SD                                           Not Present                  
  Mapped HPLMN SST                             Not Present                  
  Mapped HPLMN SD                              Not Present                  
  S-NSSAI value 2                                                           
  S-NSSAI IEI                                                               
  Length of S-NSSAI contents                   '00000001'B    SST           
  SST                                          '00000010'B    SST value 2   
  SD                                           Not Present                  
  Mapped HPLMN SST                             Not Present                  
  Mapped HPLMN SD                              Not Present                  
  NSAG priority                                '00000011'B                  
  NSAG 2                                                                    
  Length of NSAG                               1 entity                     
  NSAG identifier                              '00000010'B                  
  S-NSSAI list of NSAG                                                      
  Length of S-NSSAI list of NSAG                                            
  S-NSSAI value 1                                                           
  S-NSSAI IEI                                                               
  Length of S-NSSAI contents                   '00000001'B    SST           
  SST                                          '00000011'B    SST value 3   
  SD                                           Not Present                  
  Mapped HPLMN SST                             Not Present                  
  Mapped HPLMN SD                              Not Present                  
  S-NSSAI value 2                                                           
  S-NSSAI IEI                                                               
  Length of S-NSSAI contents                   '00000001'B    SST           
  SST                                          '00000100'B    SST value 4   
  SD                                           Not Present                  
  Mapped HPLMN SST                             Not Present                  
  Mapped HPLMN SD                              Not Present                  
  NSAG priority                                '00000010'B                  

Table 8.1.1.3.9.3.3-2: *SIB16* for NR Cell 3 (Table 8.1.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-18                                                                                                          
  -------------------------------------------------------------------------------------------- -------------- ----------------------------------------------- -----------
  Information Element                                                                          Value/remark   Comment                                         Condition
  SIB16-r17 ::= SEQUENCE {                                                                                                                                    
  freqPriorityListSlicing-r17 SEQUENCE (SIZE (1..maxFreqPlus1)) OF FreqPrioritySlicing-r17 {   2 entries                                                      
  FreqPrioritySlicing-r17 SEQUENCE{                                                                           entry 1                                         
  dl-ImplicitCarrierFreq-r17                                                                   0              Downlink carrier frequency used for NR cell 3   
  sliceInfoList-r17 SEQUENCE (SIZE (1..maxSliceInfo-r17)) OF SliceInfo-r17 {                   1 entry                                                        
  SliceInfo-r17 SEQUENCE {                                                                                    entry 1                                         
  nsag-IdentityInfo-r17 SEQUENCE {                                                                                                                            
  nsag-ID-r17                                                                                  '00000010'B                                                    
  trackingAreaCode-r17                                                                         Not present                                                    
  }                                                                                                                                                           
  nsag-CellReselectionPriority-r17                                                             5                                                              
  nsag-CellReselectionSubPriority-r17                                                          Not present                                                    
  sliceCellListNR-r17                                                                          Not present                                                    
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  FreqPrioritySlicing-r17 SEQUENCE{                                                                           entry 2                                         
  dl-ImplicitCarrierFreq-r17                                                                   2              Downlink carrier frequency used for NR cell 6   
  sliceInfoList-r17 SEQUENCE (SIZE (1..maxSliceInfo-r17)) OF SliceInfo-r17 {                   1 entry                                                        
  SliceInfo-r17 SEQUENCE {                                                                                    entry 1                                         
  nsag-IdentityInfo-r17 SEQUENCE {                                                                                                                            
  nsag-ID-r17                                                                                  '00000010'B                                                    
  trackingAreaCode-r17                                                                         Not present                                                    
  }                                                                                                                                                           
  nsag-CellReselectionPriority-r17                                                             4                                                              
  nsag-CellReselectionSubPriority-r17                                                          Not present                                                    
  sliceCellListNR-r17                                                                          Not present                                                    
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           

Table 8.1.1.3.9.3.3-2A: *SIB16* for NR Cell 6 (Table 8.1.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-18                                                                                                          
  -------------------------------------------------------------------------------------------- -------------- ----------------------------------------------- -----------
  Information Element                                                                          Value/remark   Comment                                         Condition
  SIB16-r17 ::= SEQUENCE {                                                                                                                                    
  freqPriorityListSlicing-r17 SEQUENCE (SIZE (1..maxFreqPlus1)) OF FreqPrioritySlicing-r17 {   1 entry                                                        
  FreqPrioritySlicing-r17 SEQUENCE{                                                                           entry 1                                         
  dl-ImplicitCarrierFreq-r17                                                                   0              Downlink carrier frequency used for NR cell 6   
  sliceInfoList-r17 SEQUENCE (SIZE (1..maxSliceInfo-r17)) OF SliceInfo-r17 {                   1 entry                                                        
  SliceInfo-r17 SEQUENCE {                                                                                                                                    
  nsag-IdentityInfo-r17 SEQUENCE {                                                                                                                            
  nsag-ID-r17                                                                                  '00000010'B                                                    
  trackingAreaCode-r17                                                                         Not present                                                    
  }                                                                                                                                                           
  nsag-CellReselectionPriority-r17                                                             5                                                              
  nsag-CellReselectionSubPriority-r17                                                          Not present                                                    
  sliceCellListNR-r17                                                                          Not present                                                    
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           

Table 8.1.1.3.9.3.3-3: RRCRelease (step 20, Table 8.1.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], clause 4.6.1 table 4.6.1-16                                                                                                  
  ---------------------------------------------------------------------------------------------------------- ------------------------------------------- --------- -----------
  Information Element                                                                                        Value/remark                                Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                      
  rrcRelease SEQUENCE {                                                                                                                                            
  cellReselectionPriorities SEQUENCE {                                                                                                                             
  freqPriorityListDedicatedSlicing-r17 SEQUENCE (SIZE (1.. maxFreq)) OF FreqPriorityDedicatedSlicing-r17 {   2 entries                                             
  FreqPriorityDedicatedSlicing-r17 SEQUENCE {                                                                                                            entry 1   
  dl-ExplicitCarrierFreq-r17                                                                                 Same downlink ARFCN as used for NR Cell 1             
  sliceInfoListDedicated-r17 SEQUENCE (SIZE (1..maxSliceInfo-r17)) OF SliceInfoDedicated-r17 {               1 entry                                               
  SliceInfoDedicated-r17 SEQUENCE {                                                                                                                      entry 1   
  nsag-IdentityInfo-r17 SEQUENCE {                                                                                                                                 
  nsag-ID-r17                                                                                                '00000001'B                                           
  }                                                                                                                                                                
  nsag-CellReselectionPriority-r17                                                                           6                                                     
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  FreqPriorityDedicatedSlicing-r17 SEQUENCE {                                                                                                            entry 2   
  dl-ExplicitCarrierFreq-r17                                                                                 Same downlink ARFCN as used for NR Cell 3             
  sliceInfoListDedicated-r17 SEQUENCE (SIZE (1..maxSliceInfo-r17)) OF SliceInfoDedicated-r17 {               1 entry                                               
  SliceInfoDedicated-r17 SEQUENCE {                                                                                                                      entry 1   
  nsag-IdentityInfo-r17 SEQUENCE {                                                                                                                                 
  nsag-ID-r17                                                                                                '00000010'B                                           
  }                                                                                                                                                                
  nsag-CellReselectionPriority-r17                                                                           5                                                     
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                

Table 8.1.1.3.9.3.3-4: RRCRelease (step 30, Table 8.1.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], clause 4.6.1 table 4.6.1-16                                                                                                  
  ---------------------------------------------------------------------------------------------------------- ------------------------------------------- --------- -----------
  Information Element                                                                                        Value/remark                                Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                      
  rrcRelease SEQUENCE {                                                                                                                                            
  cellReselectionPriorities SEQUENCE {                                                                                                                             
  freqPriorityListDedicatedSlicing-r17 SEQUENCE (SIZE (1.. maxFreq)) OF FreqPriorityDedicatedSlicing-r17 {   2 entries                                             
  FreqPriorityDedicatedSlicing-r17 SEQUENCE {                                                                                                            entry 1   
  dl-ExplicitCarrierFreq-r17                                                                                 Same downlink ARFCN as used for NR Cell 3             
  sliceInfoListDedicated-r17 SEQUENCE (SIZE (1..maxSliceInfo-r17)) OF SliceInfoDedicated-r17 {               1 entry                                               
  SliceInfoDedicated-r17 SEQUENCE {                                                                                                                      entry 1   
  nsag-IdentityInfo-r17 SEQUENCE {                                                                                                                                 
  nsag-ID-r17                                                                                                '00000010'B                                           
  }                                                                                                                                                                
  nsag-CellReselectionPriority-r17                                                                           4                                                     
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  FreqPriorityDedicatedSlicing-r17 SEQUENCE {                                                                                                            entry 2   
  dl-ExplicitCarrierFreq-r17                                                                                 Same downlink ARFCN as used for NR Cell 6             
  sliceInfoListDedicated-r17 SEQUENCE (SIZE (1..maxSliceInfo-r17)) OF SliceInfoDedicated-r17 {               1 entry                                               
  SliceInfoDedicated-r17 SEQUENCE {                                                                                                                      entry 1   
  nsag-IdentityInfo-r17 SEQUENCE {                                                                                                                                 
  nsag-ID-r17                                                                                                '00000010'B                                           
  }                                                                                                                                                                
  nsag-CellReselectionPriority-r17                                                                           5                                                     
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                

##### 8.1.1.3.10 RRC connection release / Redirection from NR to E-UTRA / MPS Priority Indication

##### 8.1.1.3.10.1 Test Purpose (TP) {#test-purpose-tp-13 .H6}

##### (1) {#section-34 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCRelease message including
mpsPriorityIndication-r16 and the IE redirectionInformation with E-UTRA
frequency }

**then** { UE establishes an RRC connection with establishmentCause set
to highPriorityAccess on the new frequency included in IE )

}

##### 8.1.1.3.10.2 Conformance requirements {#conformance-requirements-13 .H6}

References: The conformance requirements covered in the current TC are
specified in TS 36.331 clause 5.3.3.3, TS 38.331 clause 5.3.8.3, and TS
38.304 clause 5.2.6. Unless otherwise stated these are Rel-16
requirements.

\[TS 36.331, clause 5.3.3.3\]

The UE shall set the contents of *RRCConnectionRequest* message as
follows:

1\> if the UE is connected to EPC:

2\> set the *ue-Identity* as follows:

3\> if upper layers provide an S-TMSI:

4\> set the *ue-Identity* to the value received from upper layers;

3\> else:

4\> draw a random value in the range 0 .. 2^40^-1 and set the
*ue-Identity* to this value;

NOTE 1: Upper layers provide the S-TMSI if the UE is registered in the
TA of the current cell.

2\> if the establishment of the RRC connection is the result of release
with redirect with *mpsPriorityIndication* (either in NR or E-UTRAN):

3\> set the establishmentCause to *highPriorityAccess*;

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> delay the following actions defined in this clause 60ms from the
moment the *RRCRelease* message was received or optionally when lower
layers indicate that the receipt of the *RRCRelease* message has been
successfully acknowledged, whichever is earlier;

1\> stop timer T320, if running;

1\> if the *RRCRelease* message includes *redirectedCarrierInfo*
indicating redirection to *eutra*:

2\> if *cnType* is included:

3\> after the cell selection, indicate the available CN Type(s) and the
received *cnType* to upper layers;

NOTE: Handling the case if the E-UTRA cell selected after the
redirection does not support the core network type specified by the
*cnType,* is up to UE implementation.

\[TS 38.304, clause 5.2.6\]

At reception of *RRCRelease* message to transition the UE to RRC\_IDLE
or RRC\_INACTIVE, UE shall attempt to camp on a suitable cell according
to *redirectedCarrierInfo* if included in the *RRCRelease* message used
for this transition. If the UE cannot find a suitable cell, the UE is
allowed to camp on any suitable cell of the indicated RAT. If the
*RRCRelease* message does not contain the *redirectedCarrierInfo,* UE
shall attempt to select a suitable cell on an NR carrier. If no suitable
cell is found according to the above, the UE shall perform cell
selection using stored information in order to find a suitable cell to
camp on.

When returning to RRC\_IDLE state after UE moved to RRC\_CONNECTED state
from *camped on any cell* state, UE shall attempt to camp on an
acceptable cell according to *redirectedCarrierInfo*, if included in the
*RRCRelease* message. If the UE cannot find an acceptable cell, the UE
is allowed to camp on any acceptable cell of the indicated RAT. If the
*RRCRelease* message does not contain *redirectedCarrierInfo* UE shall
attempt to select an acceptable cell on an NR frequency. If no
acceptable cell is found according to the above, the UE shall continue
to search for an acceptable cell of any PLMN in state *any cell
selection*.

##### 8.1.1.3.10.3 Test description {#test-description-13 .H6}

##### 8.1.1.3.10.3.1 Pre-test conditions {#pre-test-conditions-13 .H6}

##### System Simulator: {#system-simulator-18 .H6}

\- NR Cell 1 is the serving cell. System information combination NR-6 as
defined in TS 38.508 -1 \[4\] clause 4.4.3.1.2 is used.

\- E-UTRA Cell 1 is a suitable neighbour cell. System information
combination 31 as defined in TS 38.508 \[7\], clause 4.4.3.1.1

##### UE: {#ue-18 .H6}

\- None

##### Preamble: {#preamble-17 .H6}

\- With E-UTRA Cell 1 and NR Cell 1 power levels set according to T0,
the UE is brought to state 3N-A as defined in TS 38.508-1 \[4\], clause
4.4A.2.

##### 8.1.1.3.10.3.2 Test procedure sequence {#test-procedure-sequence-14 .H6}

Tables 8.1.1.3.10.3.2-1/ 8.1.1.3.10.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1, E-UTRA Cell 1 for the test
execution.

Table 8.1.1.3.10.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-----------+-----------+-----------+-----------+-----------+
|    | Parameter | Unit      | NR Cell 1 | E-UTRA    | *         |
|    |           |           |           | Cell 1    | *Remark** |
+====+===========+===========+===========+===========+===========+
| T0 | Cell      | dBm/15kHz |           | \"Off\"   |           |
|    | -specific |           |           |           |           |
|    | RS EPRE   |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -85       | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T1 | Cell      | dBm/15kHz |           | -91       | The power |
|    | -specific |           |           |           | levels    |
|    | RS EPRE   |           |           |           | are such  |
|    |           |           |           |           | that      |
|    |           |           |           |           | camping   |
|    |           |           |           |           | on NR     |
|    |           |           |           |           | Cell 1 is |
|    |           |           |           |           | gu        |
|    |           |           |           |           | aranteed. |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -85       | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T2 | Cell      | dBm/15kHz |           | -91       | The power |
|    | -specific |           |           |           | levels    |
|    | RS EPRE   |           |           |           | are such  |
|    |           |           |           |           | that UE   |
|    |           |           |           |           | performs  |
|    |           |           |           |           | dereg     |
|    |           |           |           |           | istration |
|    |           |           |           |           | on E-UTRA |
|    |           |           |           |           | cell and  |
|    |           |           |           |           | does not  |
|    |           |           |           |           | reselect  |
|    |           |           |           |           | NR Cell   |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -Off      | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+

Table 8.1.1.3.10.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+-----------+-----------+-----------+-----------+-----------+
|    | Parameter | Unit      | NR Cell 1 | E-UTRA    | Remark    |
|    |           |           |           | Cell 1    |           |
+====+===========+===========+===========+===========+===========+
| T0 | Cell      | dBm/15kHz |           | "Off"     |           |
|    | -specific |           |           |           |           |
|    | RS EPRE   |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -82       | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T1 | Cell      | dBm/15kHz |           | -96       | The power |
|    | -specific |           |           |           | levels    |
|    | RS EPRE   |           |           |           | are such  |
|    |           |           |           |           | that      |
|    |           |           |           |           | camping   |
|    |           |           |           |           | on NR     |
|    |           |           |           |           | Cell 1 is |
|    |           |           |           |           | gu        |
|    |           |           |           |           | aranteed. |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -82       | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T2 | Cell      | dBm/15kHz |           | -96       | The power |
|    | -specific |           |           |           | levels    |
|    | RS EPRE   |           |           |           | are such  |
|    |           |           |           |           | that UE   |
|    |           |           |           |           | performs  |
|    |           |           |           |           | dereg     |
|    |           |           |           |           | istration |
|    |           |           |           |           | on E-UTRA |
|    |           |           |           |           | cell and  |
|    |           |           |           |           | does not  |
|    |           |           |           |           | reselect  |
|    |           |           |           |           | NR Cell   |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS/PBCH   | dBm/SCS   | -Off      | \-        |           |
|    |           |           |           |           |           |
|    | SSS EPRE  |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+

Table 8.1.1.3.10.3.2-3: Main behaviour

  St     Procedure                                                                                                                                                 Message Sequence   TP                          Verdict   
  ------ --------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------- --------- ----
                                                                                                                                                                   U - S              Message                               
  1      The SS changes NR Cell 1 and E-UTRA Cell 1 power level according to the row \"T1\" in Table 8.1.1.3.10.3.2-1 for FR1 and Table 8.1.1.3.10.3.2-2 for FR2   \-                 \-                          \-        \-
  2      SS transmits an *RRCRelease* message (IE mpsPriorityIndication-r16 and *redirectionInformation* including ARFCN-ValueEUTRA *of E-UTRA Cell 1*).           \<\--              *NR RRC: RRCRelease*        \-        \-
  3      Check: Does the UE transmit an *RRCConnectionRequest* message with \'establishmentCause\' set to \'*highPriorityAccess*\' on E-UTRA cell 1?               \--\>              RRC: RRCConnectionRequest   1         P
  4      SS changes NR Cell 1 power levels according to the row \"T2\" in Table 8.1.1.3.10.3.2-1 for FR1 and Table 8.1.1.3.10.3.2-2 for FR2.                       \-                 \-                          \-        \-
  5-11   Steps 2 - 8 of TS 38.508-1 \[4\] Table 4.9.7.2.2-1 are performend on E-UTRAN Cell 1.                                                                      \-                 \-                          \-        \-

##### 8.1.1.3.10.3.3 Specific message contents {#specific-message-contents-13 .H6}

Table 8.1.1.3.10.3.3-1 RRCRelease (step 2, Table 8.1.1.3.10.3.2-3)

  ---------------------------------------------- ------------------------- --------- -----------
  Derivation Path: TS 38.508-1, table 4.6.1-16                                       
  Information Element                            Value/remark              Comment   Condition
  RRCRelease ::= SEQUENCE {                                                          
  criticalExtensions CHOICE {                                                        
  rrcRelease SEQUENCE {                                                              
  redirectedCarrierInfo CHOICE {                                                     
  eutra SEQUENCE {                                                                   
  eutraFrequency                                 EARFCN of E-UTRA Cell 1             
  cnType                                         epc                                 
  }                                                                                  
  }                                                                                  
  nonCriticalExtension SEQUENCE {                                                    
  nonCriticalExtension SEQUENCE {                                                    
  nonCriticalExtension SEQUENCE {                                                    
  mpsPriorityIndication-r16                      true                                
  }                                                                                  
  }                                                                                  
  }                                                                                  
  }                                                                                  
  }                                                                                  
  }                                                                                  
  ---------------------------------------------- ------------------------- --------- -----------

Table 8.1.1.3.10.3.3-2: RRCConnectionRequest (step 3, Table
8.1.1.3.10.3.2-3)

  Derivation Path: TS 36.508 \[7\], Table 4.6.1-16                                  
  -------------------------------------------------- -------------------- --------- -----------
  Information Element                                Value/remark         Comment   Condition
  RRCConnectionRequest ::= SEQUENCE {                                               
  criticalExtensions CHOICE {                                                       
  rrcConnectionRequest-r8 SEQUENCE {                                                
  establishmentCause                                 highPriorityAccess             
  }                                                                                 
  }                                                                                 
  }                                                                                 

#### 8.1.1.4 RRC resume

##### 8.1.1.4.1 RRC resume / Suspend-Resume / RNA update / Success / Short message for SI update

##### 8.1.1.4.1.1 Test Purpose (TP) {#test-purpose-tp-14 .H6}

##### (1) {#section-35 .H6}

**with** { UE in NR RRC\_INACTIVE state, with stored shortI-RNTI and
useFullResumeID is not signalled in SIB1 }

**ensure that** {

**when** { UE receives a Paging message to resume RRC connection }

**then** { UE sends RRCResumeRequest message by setting resumeIdentity
to the stored shortI-RNTI value }

}

##### (2) {#section-36 .H6}

**with** { UE in NR RRC\_INACTIVE state, with stored fullI-RNTI and
useFullResumeID is signalled in SIB1 }

**ensure that** {

**when** { UE receives a Paging message to resume RRC connection }

**then** { UE sends RRCResumeRequest1 message by setting resumeIdentity
to the stored fullI-RNTI value }

}

##### (3) {#section-37 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { UE performs cell reselection and enters an RNA not belonging
to the configured ran-NotificationAreaInfo }

**then** { UE shall initiate RRC connection resume procedure with cause
value set to rna-Update }

}

##### (4) {#section-38 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { UE receives a short message transmitted on PDCCH using P-RNTI
indicating a systemInfoModification }

**then** { UE re-acquires and applies the new system information about
the correct prach-ConfigurationIndex in random access to resume RRC
connection }

}

##### 8.1.1.4.1.2 Conformance requirements {#conformance-requirements-14 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.2.2.2.2, 5.2.2.3.1, 5.2.2.4.2, 5.3.8.3,
5.3.13.2, 5.3.13.3, 5.3.13.8 and 6.5. Unless otherwise stated these are
Rel-15 requirements.

\[TS 38.331, clause 5.2.2.2.2\]

A modification period is used, i.e. updated SI message (other than SI
message for ETWS, CMAS and positioning assistance data) is broadcasted
in the modification period following the one where SI change indication
is transmitted. The modification period boundaries are defined by SFN
values for which SFN mod m = 0, where m is the number of radio frames
comprising the modification period. The modification period is
configured by system information. The UE receives indications about SI
modifications and/or PWS notifications using Short Message transmitted
with P-RNTI over DCI (see clause 6.5). Repetitions of SI change
indication may occur within preceding modification period. SI change
indication is not applicable for SI messages containing posSIBs.

UEs in RRC\_IDLE or in RRC\_INACTIVE shall monitor for SI change
indication in its own paging occasion every DRX cycle. UEs in
RRC\_CONNECTED shall monitor for SI change indication in any paging
occasion at least once per modification period if the UE is provided
with common search space, including *pagingSearchSpace*,
*searchSpaceSIB1* and *searchSpaceOtherSystemInformation*, on the active
BWP to monitor paging, as specified in TS 38.213 \[13\], clause 13.

...

If the UE receives a Short Message, the UE shall:

...

1\> if the *systemInfoModification* bit of Short Message is set:

2\> apply the SI acquisition procedure as defined in sub-clause 5.2.2.3
from the start of the next modification period.

\[TS 38.331, clause 5.2.2.3.1\]

The UE shall:

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> if the UE is in RRC\_IDLE or in RRC\_INACTIVE; or

1\> if the UE is in RRC\_CONNECTED while T311 is running:

2\> acquire the *MIB,* which is scheduled as specified in TS 38.213
\[13\];

2\> if the UE is unable to acquire the *MIB*;

3\> perform the actions as specified in clause 5.2.2.5;

2\> else:

3\> perform the actions specified in clause 5.2.2.4.1.

...

1\> if the UE is in RRC\_IDLE or in RRC\_INACTIVE; or

1\> if the UE is in RRC\_CONNECTED while T311 is running:

2\> if *ssb-SubcarrierOffset* indicates *SIB1* is transmitted in the
cell (TS 38.213 \[13\]) and if *SIB1* acquisition is required for the
UE:

3\> acquire the *SIB1,* which is scheduled as specified in TS 38.213
\[13\];

3\> if the UE is unable to acquire the *SIB1*:

4\> perform the actions as specified in clause 5.2.2.5;

3\> else:

4\> upon acquiring *SIB1*, perform the actions specified in clause
5.2.2.4.2.

2\> else if *SIB1* acquisition is required for the UE and
*ssb-SubcarrierOffset* indicates that *SIB1* is not scheduled in the
cell:

3\> perform the actions as specified in clause 5.2.2.5.

...

\[TS 38.331, clause 5.2.2.4.2\]

Upon receiving the *SIB1* the UE shall:

1\> store the acquired *SIB1*;

1\> if the *cellAccessRelatedInfo* contains an entry with the
*PLMN-Identity* of the selected PLMN:

2\> in the remainder of the procedures use *plmn-IdentityList*,
*trackingAreaCode*, and *cellIdentity* for the cell as received in the
corresponding *PLMN-IdentityInfo* containing the selected PLMN;

...

1\> else:

...

2\> if the UE supports the bandwidth of the initial uplink BWP and of
the initial downlink BWPs indicated in the *locationAndBandwidth* fields
in *uplinkConfigCommon*:

3\> select the first frequency band in the *frequencyBandList* which the
UE supports and for which the UE supports at least one of the
*additionalSpectrumEmission* values in *nr-NS-PmaxList*, if present;

3\> forward the *cellIdentity* to upper layers;

3\> if *trackingAreaCode* is not provided for the selected PLMN nor the
registered PLMN nor PLMN of the equivalent PLMN list:

4\> consider the cell as barred in accordance with TS 38.304 \[20\];

4\> if *intraFreqReselection* is set to notAllowed:

5\> consider cell re-selection to other cells on the same frequency as
the barred cell as not allowed, as specified in TS 38.304 \[20\];

4\> else:

5\> consider cell re-selection to other cells on the same frequency as
the barred cell as allowed, as specified in TS 38.304 \[20\];

3\> else:

4\> forward the *trackingAreaCode* to upper layers;

3\> forward the PLMN identity to upper layers;

3\> if in RRC\_INACTIVE and the forwarded information does not trigger
message transmission by upper layers:

4\> if the serving cell does not belong to the configured
*ran-NotificationAreaInfo*:

5\> initiate an RNA update as specified in 5.3.13.8;

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

...

1\> if the *RRCRelease* includes *suspendConfig*:

2\> apply the received *suspendConfig*;

2\> reset MAC and release the default MAC Cell Group configuration, if
any;

2\> re-establish RLC entities for SRB1;

2\> if the *RRCRelease* message with *suspendConfig* was received in
response to an *RRCResumeRequest* or an *RRCResumeRequest1*:

3\> stop the timer T319 if running;

3\> in the stored UE Inactive AS context:

4\> replace the K~gNB~ and K~RRCint~ keys with the current K~gNB~ and
K~RRCint~ keys;

4\> replace the C-RNTI with the temporary C-RNTI in the cell the UE has
received the *RRCRelease* message;

4\> replace the *cellIdentity* with the *cellIdentity* of the cell the
UE has received the *RRCRelease* message;

4\> replace the physical cell identity with the physical cell identity
of the cell the UE has received the *RRCRelease* message;

4\> replace the *suspendConfig* with the current *suspendConfig*;

2\> else:

3\> store in the UE Inactive AS Context the configured *suspendConfig*,
the current K~gNB~ and K~RRCint~ keys, the ROHC state, the C-RNTI used
in the source PCell, the *cellIdentity* and the physical cell identity
of the source PCell, and all other parameters configured except with
*ReconfigurationWithSync*;

...

\[TS 38.331, clause 5.3.13.2\]

The UE initiates the procedure when upper layers or AS (when responding
to RAN paging or upon triggering RNA updates while the UE is in
RRC\_INACTIVE) requests the resume of a suspended RRC connection.

The UE shall ensure having valid and up to date essential system
information as specified in clause 5.2.2.2 before initiating this
procedure.

Upon initiation of the procedure, the UE shall:

1\> if the resumption of the RRC connection is triggered by response to
NG-RAN paging:

2\> select \'0\' as the Access Category;

2\> perform the unified access control procedure as specified in 5.3.14
using the selected Access Category and one or more Access Identities
provided by upper layers;

3\> if the access attempt is barred, the procedure ends;

1\> else if the resumption of the RRC connection is triggered by upper
layers:

2\> if the upper layers provide an Access Category and one or more
Access Identities:

3\> perform the unified access control procedure as specified in 5.3.14
using the Access Category and Access Identities provided by upper
layers;

4\> if the access attempt is barred, the procedure ends;

2\> set the *resumeCause* in accordance with the information received
from upper layers;

1\> else if the resumption of the RRC connection is triggered due to an
RNA update as specified in 5.3.13.8:

2\> if an emergency service is ongoing:

NOTE: How the RRC layer in the UE is aware of an ongoing emergency
service is up to UE implementation.

3\> select \'2\' as the Access Category;

3\> set the *resumeCause* to *emergency*;

2\> else:

3\> select \'8\' as the Access Category;

2\> perform the unified access control procedure as specified in 5.3.14
using the selected Access Category and one or more Access Identities to
be applied as specified in TS 24.501 \[23\];

3\> if the access attempt is barred:

4\> set the variable *pendingRnaUpdate* to *true*;

4\> the procedure ends;

...

1\> release the MCG SCell(s) from the UE Inactive AS context, if stored;

1\> apply the default L1 parameter values as specified in corresponding
physical layer specifications, except for the parameters for which
values are provided in *SIB1*;

1\> apply the default SRB1 configuration as specified in 9.2.1;

1\> apply the default MAC Cell Group configuration as specified in
9.2.2;

1\> release *delayBudgetReportingConfig* from the UE Inactive AS
context, if stored;

1\> stop timer T342, if running;

1\> release *overheatingAssistanceConfig* from the UE Inactive AS
context, if stored;

1\> stop timer T345, if running;

1\> apply the CCCH configuration as specified in 9.1.1.2;

1\> apply the *timeAlignmentTimerCommon* included in *SIB1*;

1\> start timer T319;

1\> set the variable *pendingRnaUpdate* to *false*;

1\> initiate transmission of the *RRCResumeRequest* message or
*RRCResumeRequest1* in accordance with 5.3.13.3.

\[TS 38.331, clause 5.3.13.3\]

The UE shall set the contents of *RRCResumeRequest* or
*RRCResumeRequest1* message as follows:

1\> if field *useFullResumeID* is signalled in *SIB1*:

2\> select *RRCResumeRequest1* as the message to use;

2\> set the *resumeIdentity* to the stored *fullI-RNTI* value;

1\> else:

2\> select *RRCResumeRequest* as the message to use;

2\> set the *resumeIdentity* to the stored *shortI-RNTI* value;

...

1\> submit the selected message *RRCResumeRequest* or
*RRCResumeRequest1* for transmission to lower layers.

NOTE 2: Only DRBs with previously configured UP ciphering shall resume
ciphering.

...

\[TS 38.331, clause 5.3.13.8\]

In RRC\_INACTIVE state, the UE shall:

1\> if T380 expires; or

1\> if RNA Update is triggered at reception of SIB1, as specified in
5.2.2.4.2:

2\> initiate RRC connection resume procedure in 5.3.13.2 with
*resumeCause* set to *rna-Update*;

1\> if barring is alleviated for Access Category \'8\', as specified in
5.3.14.4:

2\> if upper layers do not request RRC the resumption of an RRC
connection, and

2\> if the variable *pendingRnaUpdate* is set to *true*:

3\> initiate RRC connection resume procedure in 5.3.13.2 with
*resumeCause* value set to *rna-Update*.

If the UE in RRC\_INACTIVE state fails to find a suitable cell and camps
on the acceptable cell to obtain limited service as defined in TS 38.304
\[20\], the UE shall:

1\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11
with release cause \'other\'.

NOTE: It is left to UE implementation how to behave when T380 expires
while the UE is camped neither on a suitable nor on an acceptable cell.

\[TS 38.331, clause 6.5\]

Short Messages can be transmitted on PDCCH using P-RNTI with or without
associated *Paging* message using Short Message field in DCI format 1\_0
(see TS 38.212 \[17\], clause 7.3.1.2.1).

Table 6.5-1 defines Short Messages. Bit 1 is the most significant bit.

Table 6.5-1: Short Messages

+--------+------------------------------------------------------------+
| Bit    | Short Message                                              |
+========+============================================================+
| 1      | ***systemInfoModification***                               |
|        |                                                            |
|        | If set to 1: indication of a BCCH modification other than  |
|        | SIB6, SIB7 and SIB8.                                       |
+--------+------------------------------------------------------------+
| 2      | ***etwsAndCmasIndication***                                |
|        |                                                            |
|        | If set to 1: indication of an ETWS primary notification    |
|        | and/or an ETWS secondary notification and/or a CMAS        |
|        | notification.                                              |
+--------+------------------------------------------------------------+
| 3      | ***stopPagingMonitoring***                                 |
|        |                                                            |
|        | This bit can be used for only operation with shared        |
|        | spectrum channel access and if                             |
|        | *nrofPDCCH-MonitoringOccasionPerSSB-InPO* is present.      |
|        |                                                            |
|        | If set to 1: indication that the UE may stop monitoring    |
|        | PDCCH occasion(s) for paging in this Paging Occasion as    |
|        | specified in TS 38.304 \[20\], clause 7.1.                 |
+--------+------------------------------------------------------------+
| 4 -- 8 | Not used in this release of the specification, and shall   |
|        | be ignored by UE if received.                              |
+--------+------------------------------------------------------------+

##### 8.1.1.4.1.3 Test Description {#test-description-14 .H6}

##### 8.1.1.4.1.3.1 Pre-test conditions {#pre-test-conditions-14 .H6}

##### System Simulator: {#system-simulator-19 .H6}

\- NR Cell 1 is the serving cell and NR Cell 2 is a suitable neighbour
intra-frequency cell.

\- Cell power levels are selected according to 38.508-1 \[4\] Table
6.2.2.1-3 and NR Cell 2 is switched on after UE has registered on NR
Cell 1.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-19 .H6}

\- None.

##### Preamble: {#preamble-18 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 2N-A
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 2N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.1.4.1.3.2 Test procedure sequence {#test-procedure-sequence-15 .H6}

Table 8.1.1.4.1.3.2-1 for FR1 and table 8.1.1.4.1.3.2-2 for FR2
illustrate the downlink power levels to be applied for the cells at
various time instants of the test execution. Row marked \"T0\" denotes
the initial conditions after preamble, while columns marked \"T1\" is to
be applied subsequently in the Main behaviour. The exact instants on
which these values shall be applied are described in the texts in this
clause.

Table 8.1.1.4.1.3.2-1: Cell configuration changes over time for FR1

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remarks   |
+----+-----------+---------+-----------+-----------+-----------+
| T0 | SS/PBCH   | dBm/SCS | -88       | -94       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | \"Off\"   | -94       | Power     |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | "Off" is  |
|    |           |         |           |           | defined   |
|    |           |         |           |           | in TS     |
|    |           |         |           |           | 38.508-1  |
|    |           |         |           |           | \[4\]     |
|    |           |         |           |           | Table     |
|    |           |         |           |           | 6.2.2.1-3 |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.1.4.1.3.2-2: Cell configuration changes over time for FR2

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remarks   |
+----+-----------+---------+-----------+-----------+-----------+
| T0 | SS/PBCH   | dBm/SCS | -82       | -91       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+
|    | Qrxlevmin | dBm     | -110+De   | -110+De   |           |
|    |           |         | lta(NRf1) | lta(NRf1) |           |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | \"Off\"   | -91       | Power     |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | "Off" is  |
|    |           |         |           |           | defined   |
|    |           |         |           |           | in TS     |
|    |           |         |           |           | 38.508-1  |
|    |           |         |           |           | \[4\]     |
|    |           |         |           |           | Table     |
|    |           |         |           |           | 6.2.2.2-2 |
+----+-----------+---------+-----------+-----------+-----------+
|    | Qrxlevmin | dBm     | \-        | -110+De   |           |
|    |           |         |           | lta(NRf1) |           |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.1.4.1.3.2-3: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | The       | \-        | \-        | \-      | \- |
|           | following |           |           |         |    |
|           | messages  |           |           |         |    |
|           | are to be |           |           |         |    |
|           | observed  |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1    |           |           |         |    |
|           | unless    |           |           |         |    |
|           | e         |           |           |         |    |
|           | xplicitly |           |           |         |    |
|           | stated    |           |           |         |    |
|           | otherwise |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | a matched |           |           |         |    |
|           | identity  |           |           |         |    |
|           | (correct  |           |           |         |    |
|           | *full     |           |           |         |    |
|           | I-RNTI*). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | Ch        | \--\>     | NR RRC:   | 1       | P  |
|           | eck: Does |           | *RRCResum |         |    |
|           | the UE    |           | eRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | by        |           |           |         |    |
|           | setting   |           |           |         |    |
|           | *resume   |           |           |         |    |
|           | Identity* |           |           |         |    |
|           | to the    |           |           |         |    |
|           | stored    |           |           |         |    |
|           | *sho      |           |           |         |    |
|           | rtI-RNTI* |           |           |         |    |
|           | value?    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCResume* |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | Check:    | \-        | *-*       | 1       | \- |
|           | Does the  |           |           |         |    |
|           | test      |           |           |         |    |
|           | result of |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | subclause |           |           |         |    |
|           | 4.9.1     |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | UE is     |           |           |         |    |
|           | capable   |           |           |         |    |
|           | of        |           |           |         |    |
|           | e         |           |           |         |    |
|           | xchanging |           |           |         |    |
|           | IP data   |           |           |         |    |
|           | on DRB\#n |           |           |         |    |
|           | a         |           |           |         |    |
|           | ssociated |           |           |         |    |
|           | with the  |           |           |         |    |
|           | first PDU |           |           |         |    |
|           | session?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | both      |           |           |         |    |
|           | *fu       |           |           |         |    |
|           | llI-RNTI* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *sho      |           |           |         |    |
|           | rtI-RNTI* |           |           |         |    |
|           | in        |           |           |         |    |
|           | s*uspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | The SS    | \-        | *-*       | \-      | \- |
|           | changes   |           |           |         |    |
|           | the SIB1  |           |           |         |    |
|           | of NR     |           |           |         |    |
|           | Cell 1 to |           |           |         |    |
|           | set the   |           |           |         |    |
|           | *useFull  |           |           |         |    |
|           | ResumeID* |           |           |         |    |
|           | to True.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | The SS    | \<\--     | PDCCH     | \-      | \- |
|           | transmits |           | (DCI      |         |    |
|           | a Short   |           | 1\_0):    |         |    |
|           | message   |           | Short     |         |    |
|           | on PDCCH  |           | Message   |         |    |
|           | using     |           |           |         |    |
|           | P-RNTI    |           |           |         |    |
|           | i         |           |           |         |    |
|           | ndicating |           |           |         |    |
|           | a         |           |           |         |    |
|           | *system   |           |           |         |    |
|           | InfoModif |           |           |         |    |
|           | ication*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | Wait for  | \-        | \-        | \-      | \- |
|           | 2.1\*     |           |           |         |    |
|           | mod       |           |           |         |    |
|           | ification |           |           |         |    |
|           | period    |           |           |         |    |
|           | second    |           |           |         |    |
|           | for the   |           |           |         |    |
|           | UE to     |           |           |         |    |
|           | receive   |           |           |         |    |
|           | new       |           |           |         |    |
|           | system    |           |           |         |    |
|           | inf       |           |           |         |    |
|           | ormation. |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | a matched |           |           |         |    |
|           | identity  |           |           |         |    |
|           | (correct  |           |           |         |    |
|           | *full     |           |           |         |    |
|           | I-RNTI*). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11        | Ch        | \--\>     | NR RRC:   | 2       | P  |
|           | eck: Does |           | *         |         |    |
|           | the UE    |           | RRCResume |         |    |
|           | transmit  |           | Request1* |         |    |
|           | an        |           |           |         |    |
|           | *         |           |           |         |    |
|           | RRCResume |           |           |         |    |
|           | Request1* |           |           |         |    |
|           | message   |           |           |         |    |
|           | by        |           |           |         |    |
|           | setting   |           |           |         |    |
|           | *resume   |           |           |         |    |
|           | Identity* |           |           |         |    |
|           | to the    |           |           |         |    |
|           | stored    |           |           |         |    |
|           | *fu       |           |           |         |    |
|           | llI-RNTI* |           |           |         |    |
|           | value?    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCResume* |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 13        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | both      |           |           |         |    |
|           | *fu       |           |           |         |    |
|           | llI-RNTI* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *sho      |           |           |         |    |
|           | rtI-RNTI* |           |           |         |    |
|           | in        |           |           |         |    |
|           | s*uspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15        | The SS    | \-        | \-        | \-      | \- |
|           | adjusts   |           |           |         |    |
|           | cell      |           |           |         |    |
|           | levels    |           |           |         |    |
|           | according |           |           |         |    |
|           | to row T1 |           |           |         |    |
|           | of table  |           |           |         |    |
|           | 8.1.1.    |           |           |         |    |
|           | 4.1.3.2-1 |           |           |         |    |
|           | for FR1   |           |           |         |    |
|           | and table |           |           |         |    |
|           | 8.1.1.    |           |           |         |    |
|           | 4.1.3.2-2 |           |           |         |    |
|           | for FR2.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | The       | \-        | \-        | \-      | \- |
|           | following |           |           |         |    |
|           | messages  |           |           |         |    |
|           | are to be |           |           |         |    |
|           | observed  |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 2    |           |           |         |    |
|           | unless    |           |           |         |    |
|           | e         |           |           |         |    |
|           | xplicitly |           |           |         |    |
|           | stated    |           |           |         |    |
|           | o         |           |           |         |    |
|           | therwise. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 16        | Check:    | \--\>     | NR RRC:   | 3       | P  |
|           | Does the  |           | *RRCResum |         |    |
|           | UE        |           | eRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with      |           |           |         |    |
|           | *res      |           |           |         |    |
|           | umeCause* |           |           |         |    |
|           | set to    |           |           |         |    |
|           | *rn       |           |           |         |    |
|           | a-Update* |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 2    |           |           |         |    |
|           | within    |           |           |         |    |
|           | 60s?      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 17        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCResume* |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 18        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmit  |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 19        | Check:    | \-        | *-*       | 3       | \- |
|           | Does the  |           |           |         |    |
|           | test      |           |           |         |    |
|           | result of |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | subclause |           |           |         |    |
|           | 4.9.1     |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | UE is     |           |           |         |    |
|           | capable   |           |           |         |    |
|           | of        |           |           |         |    |
|           | e         |           |           |         |    |
|           | xchanging |           |           |         |    |
|           | IP data   |           |           |         |    |
|           | on DRB\#n |           |           |         |    |
|           | a         |           |           |         |    |
|           | ssociated |           |           |         |    |
|           | with the  |           |           |         |    |
|           | first PDU |           |           |         |    |
|           | session?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 20        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | both      |           |           |         |    |
|           | *fu       |           |           |         |    |
|           | llI-RNTI* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *sho      |           |           |         |    |
|           | rtI-RNTI* |           |           |         |    |
|           | in        |           |           |         |    |
|           | s*uspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 21-22     | Void      | \-        | \-        | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 22A       | The SS    | \-        | \-        | \-      | \- |
|           | changes   |           |           |         |    |
|           | the       |           |           |         |    |
|           | *prach-   |           |           |         |    |
|           | Configura |           |           |         |    |
|           | tionIndex |           |           |         |    |
|           | and       |           |           |         |    |
|           | ra-respon |           |           |         |    |
|           | seWindow* |           |           |         |    |
|           | in the    |           |           |         |    |
|           | system    |           |           |         |    |
|           | inf       |           |           |         |    |
|           | ormation. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 22B       | The SS    | \-        | PDCCH     | \-      | \- |
|           | transmits |           | (DCI      |         |    |
|           | a Short   |           | 1\_0):    |         |    |
|           | message   |           | Short     |         |    |
|           | on PDCCH  |           | Message   |         |    |
|           | using     |           |           |         |    |
|           | P-RNTI    |           |           |         |    |
|           | i         |           |           |         |    |
|           | ndicating |           |           |         |    |
|           | a         |           |           |         |    |
|           | *system   |           |           |         |    |
|           | InfoModif |           |           |         |    |
|           | ication*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 23        | Wait for  | \-        | \-        | \-      | \- |
|           | 2.1\*     |           |           |         |    |
|           | mod       |           |           |         |    |
|           | ification |           |           |         |    |
|           | period    |           |           |         |    |
|           | second    |           |           |         |    |
|           | for the   |           |           |         |    |
|           | UE to     |           |           |         |    |
|           | receive   |           |           |         |    |
|           | new       |           |           |         |    |
|           | system    |           |           |         |    |
|           | inf       |           |           |         |    |
|           | ormation. |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 24        | The SS    | \-        | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | a matched |           |           |         |    |
|           | identity  |           |           |         |    |
|           | (correct  |           |           |         |    |
|           | *full     |           |           |         |    |
|           | I-RNTI*). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 25        | Check:    | \-        | \-        | 4       | P  |
|           | Does the  |           |           |         |    |
|           | UE        |           |           |         |    |
|           | transmit  |           |           |         |    |
|           | a random  |           |           |         |    |
|           | access    |           |           |         |    |
|           | using     |           |           |         |    |
|           | *prach-C  |           |           |         |    |
|           | onfigurat |           |           |         |    |
|           | ionIndex* |           |           |         |    |
|           | given in  |           |           |         |    |
|           | step 22?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 26        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *RRCResum |         |    |
|           | an        |           | eRequest* |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 27        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCResume* |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 28        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| The       |           |           |           |         |    |
| mod       |           |           |           |         |    |
| ification |           |           |           |         |    |
| period,   |           |           |           |         |    |
| expressed |           |           |           |         |    |
| in number |           |           |           |         |    |
| of radio  |           |           |           |         |    |
| frames =  |           |           |           |         |    |
| modif     |           |           |           |         |    |
| icationPe |           |           |           |         |    |
| riodCoeff |           |           |           |         |    |
| \*        |           |           |           |         |    |
| d         |           |           |           |         |    |
| efaultPag |           |           |           |         |    |
| ingCycle. |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.1.4.1.3.3 Specific message contents {#specific-message-contents-14 .H6}

Table 8.1.1.4.1.3.3-1: Paging (step 1, Table 8.1.1.4.1.3.2-3)

  ----------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9 with condition NR\_RRC\_RESUME
  ----------------------------------------------------------------------------------

Table 8.1.1.4.1.3.3-2: RRCRelease (step 6, 13, Table 8.1.1.4.1.3.2-3)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE
  -------------------------------------------------------------------------------------

Table 8.1.1.4.1.3.3-3: SIB1 (step 7, Table 8.1.1.4.1.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                           
  useFullResumeID                                      true                     
  }                                                                             

Table 8.1.1.4.1.3.3-4: Paging (step 10 and 24, Table 8.1.1.4.1.3.2-3)

  ----------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9 with condition NR\_RRC\_RESUME
  ----------------------------------------------------------------------------------

Table 8.1.1.4.1.3.3-5: *RRCResumeRequest* (step 16, Table
8.1.1.4.1.3.2-3)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19                            
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeRequest ::= SEQUENCE {                                               
  rrcResumeRequest SEQUENCE {                                                   
  resumeCause                                          rna-Update               
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.1.4.1.3.3-6: RRCResume (step 3, 12, Table 8.1.1.4.1.3.2-3)

  ----------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-17
  ----------------------------------------------------

Table 8.1.1.4.1.3.3-7: **Void**

Table 8.1.1.4.1.3.3-8: RRCResume (step 17, Table 8.1.1.4.1.3.2-3)

  ---------------------------------------------------- ----------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-17                                              
  Information Element                                  Value/remark      Comment                  Condition
  RRCResume ::= SEQUENCE {                                                                        
  criticalExtensions CHOICE {                                                                     
  rrcResume SEQUENCE {                                                                            
  masterCellGroup := SEQUENCE {                        CellGroupConfig   Table 8.1.1.4.1.3.3-10   
  }                                                                                               
  }                                                                                               
  }                                                                                               
  ---------------------------------------------------- ----------------- ------------------------ -----------

Table 8.1.1.4.1.3.3-9: **Void**

Table 8.1.1.4.1.3.3-10: *CellGroupConfig* (Table 8.1.1.4.1.3.3-8)

  -------------------------------------------------------------------------- ------------------- ------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition RESUME                                     
  **Information Element**                                                    **Value/remark**    **Comment**   **Condition**
  CellGroupConfig ::= SEQUENCE {                                                                               
  spCellConfigDedicated                                                      ServingCellConfig                 
  }                                                                                                            
  -------------------------------------------------------------------------- ------------------- ------------- ---------------

Table 8.1.1.4.1.3.3-11: *ServingCellConfig* (Table 8.1.1.4.1.3.3-10:
*CellGroupConfig*)

  --------------------------------------------------------------------------- ----------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-167 with condition RESUME                                     
  Information Element                                                         Value/remark            Comment   Condition
  ServingCellConfig ::= SEQUENCE {                                                                              
  initialDownlinkBWP                                                          BWP-DownlinkDedicated             
  }                                                                                                             
  --------------------------------------------------------------------------- ----------------------- --------- -----------

Table 8.1.1.4.1.3.3-12: *BWP-DownlinkDedicated* (Table 8.1.1.4.1.3.3-11:
*ServingCellConfig*)

  ---------------------------------------------------- ------------------------------------------------------------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-11                                                                                                      
  Information Element                                  Value/remark                                                              Comment                  Condition
  BWP-DownlinkDedicated ::= SEQUENCE {                                                                                                                    
  pdcch-Config                                         Not present                                                                                        
  pdsch-Config CHOICE {                                                                                                                                   
  setup                                                PDSCH-Config                                                                                       
  }                                                                                                                                                       
  radioLinkMonitoringConfig CHOICE {                                                                                                                      
  setup                                                RadioLinkMonitoringConfig specified in TS 38.508-1\[4\] Table 4.6.3-133   SSB index of NR Cell 2   
  }                                                                                                                                                       
  }                                                                                                                                                       
  ---------------------------------------------------- ------------------------------------------------------------------------- ------------------------ -----------

Table 8.1.1.4.1.3.3-13: *PDSCH-Config* (Table 8.1.1.4.1.3.3-12:
*BWP-DownlinkDedicated*)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-100                                                                     
  ------------------------------------------------------------------------------ --------------- ------------------------ -----------
  Information Element                                                            Value/remark    Comment                  Condition
  PDSCH-Config ::= SEQUENCE {                                                                                             
  dmrs-DownlinkForPDSCH-MappingTypeA                                             Not present                              
  tci-StatesToAddModList SEQUENCE(SIZE (1.. maxNrofTCI-States)) OF TCI-State {   1 entry                                  
  TCI-State\[1\] SEQUENCE {                                                                      entry 1                  
  tci-StateId                                                                    0                                        
  qcl-type1 SEQUENCE {                                                                                                    
  referenceSignal CHOICE {                                                                                                
  ssb                                                                            SSB index \#n   SSB index of NR Cell 2   
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       

Table 8.1.1.4.1.3.3-14: *SIB1* (step 22A, Table 8.1.1.4.1.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/Remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                          
  servingCellConfigCommon SEQUENCE {                                           
  uplinkConfigCommon SEQUENCE {                                                
  initialUplinkBWP SEQUENCE {                                                  
  rach-ConfigCommon SEQUENCE {                                                 
  rach-ConfigGeneric SEQUENCE {                                                
  prach-ConfigurationIndex                            91                       FR1
                                                      156                      FR2
  ra-ResponseWindow                                   sl20                     
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

  ----------- ------------------------
  Condition   Explanation
  FR1         410 MHz -- 7125 MHz
  FR2         24250 MHz -- 52600 MHz
  ----------- ------------------------

##### 8.1.1.4.2 RRC resume / Suspend-Resume / RRC setup / T319 expiry

##### 8.1.1.4.2.1 Test Purpose (TP) {#test-purpose-tp-15 .H6}

##### (1) {#section-39 .H6}

**with** { UE in NR RRC\_INACTIVE state and sends RRCResumeRequest
message to resume RRC Connection }

**ensure that** {

**when** { UE receives a RRCSetup message }

**then** { UE shall discards any stored UE Inactive AS context,
suspendConfig and send RRCSetupComplete message with ng-5G-S-TMSI-Value
set to ng-5G-S-TMSI }

}

##### (2) {#section-40 .H6}

**with** { UE in NR RRC\_INACTIVE state and sends RRCResumeRequest
message to resume RRC Connection }

**ensure that** {

**when** { T319 expires }

**then** { UE shall release RRC connection with release cause RRC Resume
failure and go to NR RRC\_IDLE state }

}

##### 8.1.1.4.2.2 Conformance requirements {#conformance-requirements-15 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.3.4, 5.3.11, 5.3.13.5 and 5.3.13.7
and TS 24.501 clause 5.3.1.4. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1\> if the *RRCSetup* is received in response to an *RRCResumeRequest*
or *RRCResumeRequest1*:

2\> discard any stored UE Inactive AS context and *suspendConfig*;

2\> discard any current AS security context including the K~RRCenc~ key,
the K~RRCint~ key, the K~UPint~ key and the K~UPenc~ key;

2\> release radio resources for all established RBs except SRB0,
including release of the RLC entities, of the associated PDCP entities
and of SDAP;

2\> release the RRC configuration except for the default MAC Cell Group
configuration and CCCH configuration;

2\> indicate to upper layers fallback of the RRC connection;

2\> stop timer T380, if running;

1\> perform the cell group configuration procedure in accordance with
the received *masterCellGroup* and as specified in 5.3.5.5;

1\> perform the radio bearer configuration procedure in accordance with
the received *radioBearerConfig* and as specified in 5.3.5.6;

1\> if stored, discard the cell reselection priority information
provided by the *cellReselectionPriorities* or inherited from another
RAT;

1\> stop timer T300, T301 or T319 if running;

1\> if T390 is running:

2\> stop timer T390 for all access categories;

2\> perform the actions as specified in 5.3.14.4.

> 1\> stop timer T302, if running;

1\> stop timer T320, if running;

1\> if the *RRCSetup* is received in response to an *RRCResumeRequest*,
*RRCResumeRequest1* or *RRCSetupRequest*:

2\> enter RRC\_CONNECTED;

2\> stop the cell re-selection procedure;

1\> consider the current cell to be the PCell;

1\> set the content of *RRCSetupComplete* message as follows:

2\> if upper layers provide an *5G-S-TMSI*:

3\> if the *RRCSetup* is received in response to an *RRCSetupRequest*:

4\> set the *ng-5G-S-TMSI-Value* to *ng-5G-S-TMSI-Part2*;

3\> else:

4\> set the *ng-5G-S-TMSI-Value* to *ng-5G-S-TMSI*;

2\> set the *selectedPLMN-Identity* to the PLMN selected by upper layers
(TS 24.501 \[23\]) from the PLMN(s) included in the *plmn-IdentityList*
in *SIB1*;

2\> if upper layers provide the \'Registered AMF\':

3\> include and set the *registeredAMF* as follows:

4\> if the PLMN identity of the \'Registered AMF\' is different from the
PLMN selected by the upper layers:

5\> include the *plmnIdentity* in the *registeredAMF* and set it to the
value of the PLMN identity in the \'Registered AMF\' received from upper
layers;

4\> set the *amf-Identifier* to the value received from upper layers;

3\> include and set the *guami-Type* to the value provided by the upper
layers;

2\> if upper layers provide one or more S-NSSAI (see TS 23.003 \[21\]):

3\> include the *s-nssai-List* and set the content to the values
provided by the upper layers;

2\> set the *dedicatedNAS-Message* to include the information received
from upper layers;

1\> submit the *RRCSetupComplete* message to lower layers for
transmission, upon which the procedure ends

\[TS 38.331, clause 5.3.11\]

UE shall:

1\> reset MAC;

1\> if T302 is running:

2\> stop timer T302;

2\> perform the actions as specified in 5.3.14.4;

1\> stop all timers that are running except T320 and T325;

1\> discard the UE Inactive AS context;

1\> set the variable *pendingRnaUpdate* to *false*, if that is set to
*true*;

1\> discard the K~gNB~, the K~RRCenc~ key, the K~RRCint~, the K~UPint~
key and the K~UPenc~ key, if any;

1\> release all radio resources, including release of the RLC entity,
the MAC configuration and the associated PDCP entity and SDAP for all
established RBs;

1\> indicate the release of the RRC connection to upper layers together
with the release cause;

1\> enter RRC\_IDLE and perform cell selection as specified in TS 38.304
\[20\], except if going to RRC\_IDLE was triggered by selecting an
inter-RAT cell while T311 was running;

\[TS 38.331, clause 5.3.13.5\]

The UE shall:

1\> if timer T319 expires or upon receiving Integrity check failure
indication from lower layers while T319 is running:

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11
with release cause \'RRC Resume failure\'.

\[TS 38.331, clause 5.3.13.7\]

The UE shall:

1\> perform the RRC connection setup procedure as specified in 5.3.3.4.

\[TS 24.501, clause 5.3.1.4\]

...

If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives
an indication from the lower layers that the resumption of the RRC
connection has failed, and:

a\) if the lower layers indicate that access barring is applicable for
all access categories except categories 0 and 2, the UE shall:

1\) stay in 5GMM-CONNECTED mode with RRC inactive indication;

b\) else, the UE shall:

1\) enter 5GMM-IDLE mode; and

2\) initiate the registration procedure for mobility and periodic
registration update used for mobility (i.e. the 5GS registration type IE
set to \"mobility registration updating\" in the REGISTRATION REQUEST
message) for N1 NAS signalling connection recovery as specified in
subclause 5.5.1.3.2.

NOTE 2: An indication from the lower layer that the RRC connection has
been released with cause \"RRC resume failure\" can be considered as an
indication that the resumption of the RRC connection has failed.

##### 8.1.1.4.2.3 Test description {#test-description-15 .H6}

##### 8.1.1.4.2.3.1 Pre-test conditions {#pre-test-conditions-15 .H6}

##### System Simulator: {#system-simulator-20 .H6}

\- NR Cell 1 is the serving cell.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cell.

##### UE: {#ue-20 .H6}

\- None.

##### Preamble: {#preamble-19 .H6}

\- The UE is in state 2N-A as defined in TS 38.508-1 \[4\], Table
4.4A.2-2 on NR Cell 1.

##### 8.1.1.4.2.3.2 Test procedure sequence {#test-procedure-sequence-16 .H6}

Table 8.1.1.4.2.3.2-1: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including a |             |             |         |    |
|       | matched     |             |             |         |    |
|       | identity    |             |             |         |    |
|       | (correct    |             |             |         |    |
|       | *fu         |             |             |         |    |
|       | llI-RNTI*). |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmit an |             | *RRCRes     |         |    |
|       | *RRCRes     |             | umeRequest* |         |    |
|       | umeRequest* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | resume RRC  |             |             |         |    |
|       | Connection  |             |             |         |    |
|       | by setting  |             |             |         |    |
|       | *resu       |             |             |         |    |
|       | meIdentity* |             |             |         |    |
|       | to the      |             |             |         |    |
|       | stored      |             |             |         |    |
|       | *s          |             |             |         |    |
|       | hortI-RNTI* |             |             |         |    |
|       | value?      |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSetup*  |         |    |
|       | an          |             |             |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message in  |             |             |         |    |
|       | response to |             |             |         |    |
|       | *RRCRes     |             |             |         |    |
|       | umeRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *RRCSet     |         |    |
|       | transmit an |             | upComplete* |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             | 5GMM:       |         |    |
|       | message and |             | R           |         |    |
|       | a           |             | EGISTRATION |         |    |
|       | R           |             | REQUEST     |         |    |
|       | EGISTRATION |             |             |         |    |
|       | REQUEST     |             |             |         |    |
|       | message by  |             |             |         |    |
|       | discarding  |             |             |         |    |
|       | any stored  |             |             |         |    |
|       | UE Inactive |             |             |         |    |
|       | AS context  |             |             |         |    |
|       | and         |             |             |         |    |
|       | sus         |             |             |         |    |
|       | pendConfig, |             |             |         |    |
|       | setting the |             |             |         |    |
|       | *ng-5G-S-   |             |             |         |    |
|       | TMSI-Value* |             |             |         |    |
|       | to          |             |             |         |    |
|       | *ng-        |             |             |         |    |
|       | 5G-S-TMSI*? |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4A-4B | Steps 4-5   | \-          | \-          | \-      | \- |
|       | as defined  |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4           |             |             |         |    |
|       | .9.5.2.2-1. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4C-4F | Steps 5-8   | \-          | \-          | \-      | \- |
|       | as defined  |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 4.5.4.2-3.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | both        |             |             |         |    |
|       | *           |             |             |         |    |
|       | fullI-RNTI* |             |             |         |    |
|       | and         |             |             |         |    |
|       | *s          |             |             |         |    |
|       | hortI-RNTI* |             |             |         |    |
|       | in          |             |             |         |    |
|       | s*usp       |             |             |         |    |
|       | endConfig*. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | including a |             |             |         |    |
|       | matched     |             |             |         |    |
|       | identities  |             |             |         |    |
|       | (correct    |             |             |         |    |
|       | *fu         |             |             |         |    |
|       | llI-RNTI*). |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRes     |         |    |
|       | an          |             | umeRequest* |         |    |
|       | *RRCRes     |             |             |         |    |
|       | umeRequest* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | resume RRC  |             |             |         |    |
|       | Connection  |             |             |         |    |
|       | by setting  |             |             |         |    |
|       | *resu       |             |             |         |    |
|       | meIdentity* |             |             |         |    |
|       | to the      |             |             |         |    |
|       | stored      |             |             |         |    |
|       | *s          |             |             |         |    |
|       | hortI-RNTI* |             |             |         |    |
|       | value?      |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 8     | The SS      | \-          | \-          | \-      | \- |
|       | waits for   |             |             |         |    |
|       | T319        |             |             |         |    |
|       | expiry.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 9     | Check: Does | \-          | *-*         | 2       | \- |
|       | the test    |             |             |         |    |
|       | result of   |             |             |         |    |
|       | test        |             |             |         |    |
|       | p           |             |             |         |    |
|       | rocedure in |             |             |         |    |
|       | TS 38.508-1 |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.5       |             |             |         |    |
|       | indicate    |             |             |         |    |
|       | that the UE |             |             |         |    |
|       | has         |             |             |         |    |
|       | performed   |             |             |         |    |
|       | mobility    |             |             |         |    |
|       | r           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | on NR cell  |             |             |         |    |
|       | 1 started   |             |             |         |    |
|       | in NR       |             |             |         |    |
|       | RRC\_IDLE?  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.1.4.2.3.3 Specific message contents {#specific-message-contents-15 .H6}

Table 8.1.1.4.2.3.3-1: *RRCRelease* (preamble and step 5 in Table
8.1.1.4.2.3.2-1)

  ---------------------------------------------------- ------------------- --------- -------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16                                 
  Information Element                                  Value/remark        Comment   Condition
  RRCRelease ::= SEQUENCE {                                                          
  criticalExtensions CHOICE {                                                        
  rrcRelease SEQUENCE {                                                              
  suspendConfig SEQUENCE {                                                           NR\_RRC\_INACTIVE
  fullI-RNTI                                           I-RNTI-Value                  
  shortI-RNTI                                          ShortI-RNTI-Value             
  }                                                                                  
  }                                                                                  
  }                                                                                  
  }                                                                                  
  ---------------------------------------------------- ------------------- --------- -------------------

Table 8.1.1.4.2.3.3-1a: *Void*

Table 8.1.1.4.2.3.3-2: *RRCResumeRequest* (step 2 and 7 Table
8.1.1.4.2.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19                            
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeRequest ::= SEQUENCE {                                               
  rrcResumeRequest SEQUENCE {                                                   
  resumeCause                                          mt-Access                
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.1.4.2.3.3-3: *RRCSetupComplete* (step 4 in Table
8.1.1.4.2.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                            
  Information Element                                  Value/remark   Comment   Condition
  RRCSetupComplete::= SEQUENCE {                                                
  criticalExtensions CHOICE {                                                   
  rrcSetupComplete SEQUENCE {                                                   
  ng-5G-S-TMSI-Value                                   ng-5G-S-TMSI             
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.1.4.2.3.3-4: *REGISTRATION REQUEST* (step 4 in Table
8.1.1.4.2.3.2-1)

  --------------------------------------------------- ---------------------------------- -------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.7.1-6                                                                       
  Information Element                                 Value/remark                       Comment                          Condition
  5GS registration type                                                                                                   
  5GS registration type value                         \'010\'B                           Mobility registration updating   
  Uplink data status                                  Present but contents not checked                                    
  --------------------------------------------------- ---------------------------------- -------------------------------- -----------

Table 8.1.1.4.2.3.3-5: *RRCReconfiguration* (step 4E in Table
8.1.1.4.2.3.2-1)

  -------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 condition NR and SRB2                            
  Information Element                                                        Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                   
  dedicatedNAS-MessageList                                                   Not present              
  }                                                                                                   
  -------------------------------------------------------------------------- -------------- --------- -----------

##### 8.1.1.4.3 Void

##### 8.1.1.4.4 RRC resume / Suspend-Resume / RRC reconfiguration / Active MCG SCell addition / Intra-band Contiguous CA

##### 8.1.1.4.4.1 Test Purpose (TP) {#test-purpose-tp-16 .H6}

##### (1) {#section-41 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { UE receives an *RRCResume* message containing
*sCellToAddModList* and *sCellState* for SCell addition }

**then** { UE adds the new SCell and sends an *RRCResumeComplete*
message }

}

##### 8.1.1.4.4.2 Conformance requirements {#conformance-requirements-16 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.5.5.9 and 5.3.13.4.

\[TS 38.331 clause 5.3.5.5.9\]

The UE shall:

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is not part of the current UE configuration (SCell addition):

2\> add the SCell, corresponding to the *sCellIndex*, in accordance with
the *sCellConfigCommon* and *sCellConfigDedicated*;

2\> if the *sCellState* is included:

3\> configure lower layers to consider the SCell to be in activated
state;

...

\[TS 38.331 clause 5.3.13.4\]

The UE shall:

...

1\> if the *RRCResume* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> enter RRC\_CONNECTED;

...

1\> submit the *RRCResumeComplete* message to lower layers for
transmission;

1\> the procedure ends.

##### 8.1.1.4.4.3 Test description {#test-description-16 .H6}

##### 8.1.1.4.4.3.1 Pre-test conditions {#pre-test-conditions-16 .H6}

##### System Simulator: {#system-simulator-21 .H6}

\- NR Cell 1 is the PCell, NR Cell 3 is the SCell.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cell.

##### UE: {#ue-21 .H6}

\- None.

##### Preamble: {#preamble-20 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 2N-A
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 2N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.1.4.4.3.2 Test procedure sequence {#test-procedure-sequence-17 .H6}

Table 8.1.1.4.4.3.2-1: Main behaviour

  St   Procedure                                                                                                                                                        Message Sequence   TP                                      Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                        U - S              Message                                           
  1    The SS transmits a *Paging* message including a matched identity (correct *fullI-RNTI*).                                                                         \<\--              NR RRC: *Paging*                        \-        \-
  2    The UE transmits an *RRCResumeRequest* message.                                                                                                                  \--\>              NR RRC: *RRCResumeRequest*              \-        \-
  3    The SS transmits an *RRCResume* message.                                                                                                                         \<\--              NR RRC: *RRCResume*                     \-        \-
  4    Check: Does the UE transmit an *RRCResumeComplete* message?                                                                                                      \--\>              NR RRC: *RRCResumeComplete*             1         P
  5    Check: Does the test result of generic test procedure in TS 38.508-1 subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB1 and Cell 3?   \-                 \-                                      1         \-
  6    The SS transmits an *RRCReconfiguration*message containing an sCellToReleaseList with SCell NR Cell 3.                                                           \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  7    The UE transmit an *RRCReconfigurationComplete* message?                                                                                                         \--\>              *NR RRC: RRCReconfigurationtComplete*   \-        \-

##### 8.1.1.4.4.3.3 Specific message contents {#specific-message-contents-16 .H6}

Table 8.1.1.4.4.3.3-1: Paging (step 1, Table 8.1.1.4.4.3.2-1)

  ----------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9 with condition NR\_RRC\_RESUME
  ----------------------------------------------------------------------------------

Table 8.1.1.4.4.3.3-2: *RRCResume* (step 3, Table 8.1.1.4.4.3.2-1)

  --------------------------------------------------- ------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-17                                                                    
  Information Element                                 Value/remark                                           Comment   Condition
  RRCResume ::= SEQUENCE {                                                                                             
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier                                        
  criticalExtensions CHOICE {                                                                                          
  rrcResume SEQUENCE {                                                                                                 
  masterCellGroup                                     CellGroupConfig with condition RESUME and SCell\_add             
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    
  --------------------------------------------------- ------------------------------------------------------ --------- -----------

Table 8.1.1.4.4.3.3-3: *CellGroupConfig* (Table 8.1.1.4.4.3.3-2)

  ----------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19                                                
  Information Element                                                     Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                   
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {   1 entry                  
  SCellConfig\[1\] SEQUENCE {                                                            entry 1   
  sCellState-r16                                                          activated                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  ----------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.1.4.4.3.3-4: *RRCReconfiguration* (step 6, Table
8.1.1.4.4.3.2-1)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE{                                                                            
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.1.4.4.3.3-5: *CellGroupConfig* (Table 8.1.1.4.4.3.3-4)

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                            
  Information Element                                                           Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                         
  sCellToAddModList                                                             Not present              
  sCellToReleaseList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellIndex {         1 entry                  
  SCellIndex\[1\]                                                               1              entry 1   
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

##### 8.1.1.4.5 RRC resume / Suspend-Resume / RRC reconfiguration / Active MCG SCell addition / Intra-band non-Contiguous CA

##### 8.1.1.4.5.1 Test Purpose (TP) {#test-purpose-tp-17 .H6}

Same as TC 8.1.1.4.4 but applied to Intra-band non-Contiguous CA.

##### 8.1.1.4.5.2 Conformance requirements {#conformance-requirements-17 .H6}

Same as TC 8.1.1.4.4 but applied to Intra-band non-Contiguous CA.

##### 8.1.1.4.5.3 Test description {#test-description-17 .H6}

##### 8.1.1.4.5.3.1 Pre-test conditions {#pre-test-conditions-17 .H6}

Same as TC 8.1.1.4.4 with the following differences:

\- CA configuration: Intra-band non-contiguous replaces Intra-band
Contiguous CA

##### 8.1.1.4.5.3.2 Test procedure sequence {#test-procedure-sequence-18 .H6}

Same as TC 8.1.1.4.4 with the following differences:

\- CA configuration: Intra-band non-contiguous replaces Intra-band
Contiguous CA

##### 8.1.1.4.6 RRC resume / Suspend-Resume / RRC reconfiguration / Active MCG SCell addition / Inter-band CA

##### 8.1.1.4.6.1 Test Purpose (TP) {#test-purpose-tp-18 .H6}

Same as TC 8.1.1.4.4 but applied to Inter-band CA case.

##### 8.1.1.4.6.2 Conformance requirements {#conformance-requirements-18 .H6}

Same as TC 8.1.1.4.4 but applied to Inter-band CA case.

##### 8.1.1.4.6.3 Test description {#test-description-18 .H6}

##### 8.1.1.4.6.3.1 Pre-test conditions {#pre-test-conditions-18 .H6}

Same as TC 8.1.1.4.4 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3

##### 8.1.1.4.6.3.2 Test procedure sequence {#test-procedure-sequence-19 .H6}

Same as TC 8.1.1.4.4 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3

##### 8.1.1.4.7 RRC resume / Suspend-Resume / RRC reconfiguration / Active SCG SCell addition / Intra-band Contiguous CA

##### 8.1.1.4.7.1 Test Purpose (TP) {#test-purpose-tp-19 .H6}

##### (1) {#section-42 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { UE receives an *RRCResume* message containing
*sCellToAddModList* and *sCellState* for an SCG SCell addition }

**then** { UE adds the new SCell and sends an *RRCResumeComplete*
message }

}

##### 8.1.1.4.7.2 Conformance requirements {#conformance-requirements-19 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.5.5.9 and 5.3.13.14.

\[TS 38.331 clause 5.3.5.5.9\]

The UE shall:

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is not part of the current UE configuration (SCell addition):

2\> add the SCell, corresponding to the *sCellIndex*, in accordance with
the *sCellConfigCommon* and *sCellConfigDedicated*;

2\> if the *sCellState* is included:

3\> configure lower layers to consider the SCell to be in activated
state;

...

\[TS 38.331 clause 5.3.13.4\]

The UE shall:

The UE shall:

> ...
>
> 1\> if the *RRCResume* includes the *mrdc-SecondaryCellGroup:*
>
> 2\> if the received *mrdc-SecondaryCellGroup* is set to *nr-SCG*:
>
> 3\> perform the RRC reconfiguration according to 5.3.5.3 for the
> *RRCReconfiguration* message included in *nr-SCG*;
>
> ...
>
> 1\> enter RRC\_CONNECTED;
>
> ...
>
> 1\> submit the *RRCResumeComplete* message to lower layers for
> transmission;
>
> 1\> the procedure ends.

##### 8.1.1.4.7.3 Test description {#test-description-19 .H6}

##### 8.1.1.4.7.3.1 Pre-test conditions {#pre-test-conditions-19 .H6}

##### System Simulator: {#system-simulator-22 .H6}

\- NR Cell 1 is the PCell, NR Cell 10 is the PSCell, NR Cell 28 is the
SCG SCell

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-22 .H6}

\- None.

##### Preamble: {#preamble-21 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in state
RRC\_CONNECTED using generic procedure parameter Connectivity (*NR-DC*)
with Bearers (*MCG(s) and SCG*) according to TS 38.508-1 \[4\], Table
4.5.1-1.

\- Else, the UE is in state RRC\_CONNECTED using generic procedure
parameters Connectivity (*NR-DC*) with Bearers (*MCG(s) and SCG*), Test
Mode (*On*) and Test Loop Function (*On*) with UE test loop mode B
according to TS 38.508-1 \[4\], Table 4.5.1-1.

##### 8.1.1.4.7.3.2 Test procedure sequence {#test-procedure-sequence-20 .H6}

Table 8.1.1.4.7.3.2-1: Main behaviour

  St   Procedure                                                                                                                                                           Message Sequence   TP                            Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ----------------------------- --------- ----
                                                                                                                                                                           U - S              Message                                 
  0    The SS transmits an *RRCRelease* message with suspend.                                                                                                              \<\--              NR RRC: *RRCRelease*          \-        \-
  1    The SS transmits a *Paging* message including a matched identity (correct *fullI-RNTI*).                                                                            \<\--              NR RRC: *Paging*              \-        \-
  2    The UE transmit an *RRCResumeRequest* message.                                                                                                                      \--\>              NR RRC: *RRCResumeRequest*    \-        \-
  3    The SS transmits an *RRCResume* message.                                                                                                                            \<\--              NR RRC: *RRCResume*           \-        \-
  4    Check: Does the UE transmit an *RRCResumeComplete* message?                                                                                                         \--\>              NR RRC: *RRCResumeComplete*   1         P
  5    . Check: Does the test result of generic test procedure in TS 38.508-1 subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB1 and Cell 28?   \-                 \-                            1         \-

##### 8.1.1.4.7.3.3 Specific message contents {#specific-message-contents-17 .H6}

Table 8.1.1.4.7.3.3-0: *RRCRelease* (step 0, Table 8.1.1.4.7.3.2-1)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE
  -------------------------------------------------------------------------------------

Table 8.1.1.4.7.3.3-1: Paging (step 1, Table 8.1.1.4.7.3.2-1)

  ----------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9 with condition NR\_RRC\_RESUME
  ----------------------------------------------------------------------------------

Table 8.1.1.4.7.3.3-2: *RRCResume* (step 3, Table 8.1.1.4.7.3.2-1)

  --------------------------------------------------- --------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-17                                         
  Information Element                                 Value/remark                Comment   Condition
  RRCResume ::= SEQUENCE {                                                                  
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier             
  criticalExtensions CHOICE {                                                               
  rrcResume SEQUENCE {                                                                      
  nonCriticalExtension SEQUENCE {                                                           
  nonCriticalExtension SEQUENCE {                                                           
  mrdc-SecondaryCellGroup-r16 CHOICE {                                                      
  nr-SCG-r16                                          RRCReconfiguration                    
  }                                                                                         
  }                                                                                         
  }                                                                                         
  }                                                                                         
  }                                                                                         
  }                                                                                         
  --------------------------------------------------- --------------------------- --------- -----------

Table 8.1.1.4.7.3.3-3: *RRCReconfiguration* (Table 8.1.1.4.7.3.3-2)

  --------------------------------------------------- ------------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                                                                    
  Information Element                                 Value/remark                                           Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                    
  criticalExtensions CHOICE {                                                                                          
  rrcReconfiguration SEQUENCE {                                                                                        
  secondaryCellGroup                                  CellGroupConfig with condition RESUME and SCell\_add             
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    
  --------------------------------------------------- ------------------------------------------------------ --------- -----------

Table 8.1.1.4.7.3.3-4: *CellGroupConfig* (Table 8.1.1.4.7.3.3-3)

  ----------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19                                                
  Information Element                                                     Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                   
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {   1 entry                  
  SCellConfig\[1\] SEQUENCE {                                                            entry 1   
  sCellState-r16                                                          activated                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  ----------------------------------------------------------------------- -------------- --------- -----------

##### 8.1.1.4.8 RRC resume / Suspend-Resume / RRC reconfiguration / Active SCG SCell addition / Intra-band non-Contiguous CA

##### 8.1.1.4.8.1 Test Purpose (TP) {#test-purpose-tp-20 .H6}

Same as TC 8.1.1.4.7 but applied to Intra-band non-Contiguous CA.

##### 8.1.1.4.8.2 Conformance requirements {#conformance-requirements-20 .H6}

Same as TC 8.1.1.4.7 but applied to Intra-band non-Contiguous CA.

##### 8.1.1.4.8.3 Test description {#test-description-20 .H6}

##### 8.1.1.4.8.3.1 Pre-test conditions {#pre-test-conditions-20 .H6}

Same as TC 8.1.1.4.7 with the following differences:

\- CA configuration: Intra-band non-contiguous replaces Intra-band
Contiguous CA

##### 8.1.1.4.8.3.2 Test procedure sequence {#test-procedure-sequence-21 .H6}

Same as TC 8.1.1.4.7 with the following differences:

\- CA configuration: Intra-band non-contiguous replaces Intra-band
Contiguous CA

##### 8.1.1.4.9 RRC resume / Suspend-Resume / RRC reconfiguration / Active SCG SCell addition / Inter-band CA

##### 8.1.1.4.9.1 Test Purpose (TP) {#test-purpose-tp-21 .H6}

Same as TC 8.1.1.4.7 but applied to Inter-band CA case.

##### 8.1.1.4.9.2 Conformance requirements {#conformance-requirements-21 .H6}

Same as TC 8.1.1.4.7 but applied to Inter-band CA case.

##### 8.1.1.4.9.3 Test description {#test-description-21 .H6}

##### 8.1.1.4.9.3.1 Pre-test conditions {#pre-test-conditions-21 .H6}

Same as TC 8.1.1.4.7 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

##### 8.1.1.4.9.3.2 Test procedure sequence {#test-procedure-sequence-22 .H6}

Same as TC 8.1.1.4.7 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

##### 8.1.1.4.10 RRC resume / MUSIM / early indication

##### 8.1.1.4.10.1 Test Purpose (TP) {#test-purpose-tp-22 .H6}

##### (1) {#section-43 .H6}

**with { UE received SIB1 containing musim-CapRestrictionAllowed and UE
is in RRC\_CONNECTED state in network A and received RRCRelease message
containing suspendConfig IE from network B and enters into RRC\_INACTIVE
state in network B }**

**ensure that {**

**when { UE capability is restricted for MUSIM operation and it is going
on RRC Resume procedure on network B }**

**then { UE includes the *musim-CapRestrictionInd* in the
*RRCResumeComplete* message }**

}

##### 8.1.1.4.10.2 Conformance requirements {#conformance-requirements-22 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.13.4, and TS 38.300, clause 20.4.
Unless otherwise stated these are Rel-18 requirements.

\[TS 38.331, clause 5.3.13.4\]

The UE shall:

...

2.  set the content of *RRCResumeComplete* message as follows:

> ...
>
> 2\> if *SIB1* contains *musim-CapRestrictionAllowed*:
>
> 3\> if supported, include the *musim-CapRestrictionInd* in the
> *RRCResumeComplete* message upon determining it has temporary
> capability restriction;

\[TS 38.300, clause 20.4\]

For MUSIM operation, a MUSIM device in RRC\_CONNECTED state in Network A
may indicate its preference on temporary UE capability restriction or
removal of restriction with Network A when the MUSIM device needs
transmission or reception in Network B (e.g., including start/stop
connection to Network B). Network A is NR and Network B can either be
E-UTRA or NR. The MUSIM device may request a temporary capability
restriction only after the Network signals via RRC that this is allowed.

When configured to do so, a MUSIM device can indicate one or more of the
following temporary capability restriction or removal of restriction to
the Network A:

\- A MUSIM device can explicitly request SCell(s) or SCG to be released;

\- A MUSIM device can indicate its preference on temporary maximum MIMO
layers and/or supported channel bandwidth for specific serving cells for
both UL/DL;

\- A MUSIM device can indicate its preference on the temporary maximum
number of CCs per UL/DL;

\- A MUSIM device can indicate its preference on the concerned band(s)
or band combination(s) (e.g. forbidden and/or affected band(s) or band
combination(s)) based on a band-filter list configured by network. For
affected band(s) and band combination(s), this preference can include
temporary maximum MIMO layers and/or supported channel bandwidth for
both UL/DL;

\- A MUSIM device can indicate the measurement gap requirement changes.

When it is allowed by Network A in SIB1, a MUSIM device can indicate to
the Network A that its capabilities are temporarily restricted in
*RRCSetupComplete/RRCResumeComplete/RRCReestablishmentComplete* message
while the MUSIM device is already in RRC\_CONNECTED state in Network B.

When a MUSIM device is in RRC\_CONNECTED state in both Network A and
Network B, if Network B is NR, it is up to UE implementation to select
which network to request temporary UE capability restriction; if Network
B is E-UTRA, the request for temporary UE capability restriction can
only be performed on Network A.

##### 8.1.1.4.10.3 Test description {#test-description-22 .H6}

##### 8.1.1.4.10.3.1 Pre-test conditions {#pre-test-conditions-22 .H6}

##### System Simulator: {#system-simulator-23 .H6}

\- NR Cell 1(home PLMN1) and NR Cell 12 (home PLMN2) are configured
according to table 4.4.2-3 in TS 38.508-1 \[4\] and belong to the
different frequency.

\- NR Cell 1 (belongs to TAI-1, home PLMN1, MCC=001,MNC=01) is set to
\'\'Serving cell\'\'.

\- NR Cell 12 (belongs to TAI-3, home PLMN2, MCC=001,MNC=02) is set to
\'\' Serving cell \'\'.

##### UE: {#ue-23 .H6}

\- The UE is a Rel-18 MUSIM UE;

\- The UE is equipped with two USIMs with configuration as defined in TS
38.508-1 \[4\] Tables 6.4.1-27 and 6.4.1-28.

##### Preamble: {#preamble-22 .H6}

\- The UE performs a successful registration for MUSIM with the
condition 'connected without release' for steps 19 and 37 according to
Table 4.9.36.2.2-1 of TS 38.508-1 \[4\].

\- The SIB1 of NR Cell 12 and NR Cell 1 are defined in TS 38.508-1
\[4\], clause 4.6.1-28 with condition MUSIM\_r18 for all steps.

##### 8.1.1.4.10.3.2 Test procedure sequence {#test-procedure-sequence-23 .H6}

Table 8.1.1.4.10.3.2-1: Main behaviour

  St       Procedure                                                                                                               Message Sequence   TP                                Verdict   
  -------- ----------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- --------- -------
                                                                                                                                   U - S              Message                                     
  \-       The following messages are to be observed on NR Cell 12 unless explicitly stated otherwise.                             **-**              **-**                                       
  1        The SS transmits an *RRCRelease* message with suspend.                                                                  **\<\--**          **NR RRC: *RRCRelease***          **-**     **-**
  2        The SS transmits a *Paging* message.                                                                                    **\<\--**          **NR RRC: *Paging***              **-**     **-**
  3        The UE transmits an *RRCResumeRequest* message.                                                                         **\--\>**          **NR RRC: *RRCResumeRequest***    **-**     **-**
  4        The SS transmits an *RRCResume* message.                                                                                **\<\--**          **NR RRC: *RRCResume***           **-**     **-**
  5        Check: Does UE transmit an *RRCResumeComplete* message that includes musim-CapRestrictionInd set to true*?*             **\--\>**          **NR RRC: *RRCResumeComplete***   **1**     **P**
  6-21a1   Steps 5 to 20a1 of the generic procedure for NR RRC\_IDLE specified in TS 38.508-1 subclause 4.5.2.2-2 are performed.   **-**              **-**                             **-**     **-**

##### 8.1.1.4.10.3.3 Specific message contents {#specific-message-contents-18 .H6}

Table 8.1.1.4.10.3.3-1: RRC Release (step 1, Table 8.1.1.4.10.3.2-1)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE
  -------------------------------------------------------------------------------------

Table 8.1.1.4.10.3.3-2: Paging (step 2, Table 8.1.1.4.10.3.2-1)

  ----------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9 with condition NR\_RRC\_RESUME
  ----------------------------------------------------------------------------------

Table 8.1.1.4.10.3.3-3: RRCResumeComplete (step 5, 8.1.1.4.10.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-18                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeComplete ::= SEQUENCE {                                              
  criticalExtensions CHOICE {                                                   
  rrcResumeComplete SEQUENCE {                                                  
  nonCriticalExtension SEQUENCE {                                               
  idleMeasAvailable-r16                                Not checked              
  measResultIdleEUTRA-r16                              Not checked              
  measResultIdleNR-r16                                 Not checked              
  scg-Response-r16                                     Not checked              
  ue-MeasurementsAvailable-r16                         Not checked              
  mobilityHistoryAvail-r16                             Not checked              
  mobilityState-r16                                    Not checked              
  needForGapsInfoNR-r16                                Not checked              
  nonCriticalExtension SEQUENCE {                                               
  uplinkTxDirectCurrentTwoCarrierList-r16              Not checked              
  nonCriticalExtension SEQUENCE {                                               
  needForGapNCSG-InfoNR-r17                            Not checked              
  needForGapNCSG-InfoEUTRA-r17                         Not checked              
  nonCriticalExtension SEQUENCE {                                               
  uplinkTxDirectCurrentMoreCarrierList-r17             Not checked              
  nonCriticalExtension SEQUENCE {                                               
  needForInterruptionInfoNR-r18                        Not checked              
  musim-CapRestrictionInd-r18                          true                     
  flightPathInfoAvailable-r18                          Not checked              
  measConfigReportAppLayerAvailable-r18                Not checked              
  measResultReselectionNR-r18                          Not checked              
  reselectionMeasAvailable-r18                         Not checked              
  nonCriticalExtension                                                          
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             

### *8.1.2* RRC reconfiguration

#### 8.1.2.1 Radio bearer establishment / reconfiguration / release

##### 8.1.2.1.1 RRC reconfiguration / DRB / SRB / Establishment / Modification / Release / Success

##### 8.1.2.1.1.1 Test Purpose (TP) {#test-purpose-tp-23 .H6}

##### (1) {#section-44 .H6}

**with** { UE having completed the RRC connection establishment
procedure}

**ensure that** {

**when** { SS sends in sequence a *SecurityModeCommand* and an
*RRCReconfiguration* message to establish a DRB and SRB2}

**then** { UE establishes the initial security configuration in
accordance with the received *securityConfigSMC* included in
*SecurityModeCommand* and successfully establish the data and signalling
radio bearers }

}

##### (2) {#section-45 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message to reconfigure
the current UE configuration of SRB and DRB }

**then** { UE reconfigures the data and signalling radio bearers and
sends an *RRCReconfigurationComplete* message }

}

##### (3) {#section-46 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including a
*drb-ToReleaseList* }

**then** { for each *drb-Identity* release the PDCP entity and RLC
entity and logical channel and indicate release of the DRB(s) to upper
layers }

}

##### 8.1.2.1.1.2 Conformance requirements {#conformance-requirements-23 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.4.3, 5.3.5.6.3, 5.3.5.6.4, and
5.3.5.6.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.4.3\]

The UE shall:

1\> derive the K~gNB~ key, as specified in TS 33.501 \[11\];

1\> derive the K~RRCint~ key associated with the
*integrityProtAlgorithm* indicated in the *SecurityModeCommand* message,
as specified in TS 33.501 \[11\];

1\> request lower layers to verify the integrity protection of the
*SecurityModeCommand* message, using the algorithm indicated by the
*integrityProtAlgorithm* as included in the *SecurityModeCommand*
message and the K~RRCint~ key;

1\> if the *SecurityModeCommand* message passes the integrity protection
check:

2\> derive the K~RRCenc~ key and the K~UPenc~ key associated with the
*cipheringAlgorithm* indicated in the *SecurityModeCommand* message, as
specified in TS 33.501 \[11\];

2\> derive the K~UPint~ key associated with the *integrityProtAlgorithm*
indicated in the *SecurityModeCommand* message, as specified in TS
33.501 \[11\];

2\> configure lower layers to apply SRB integrity protection using the
indicated algorithm and the K~RRCint~ key immediately, i.e. integrity
protection shall be applied to all subsequent messages received and sent
by the UE, including the *SecurityModeComplete* message;

\[TS 38.331, clause 5.3.5.6.3\]

The UE shall:

1\> for each *srb-Identity* value included in the *srb-ToAddModList*
that is not part of the current UE configuration (SRB establishment or
reconfiguration from E-UTRA PDCP to NR PDCP):

2\> establish a PDCP entity;

2\> if AS security has been activated:

3\> if target RAT of handover is E-UTRA/5GC, or;

3\> if the UE is only connected to E-UTRA/5GC:

4\> configure the PDCP entity with the security algorithms and keys
(K~RRCenc~ and K~RRCint~) configured/derived as specified in TS 36.331
\[10\];

3\> else:

4\> configure the PDCP entity with the security algorithms according to
*securityConfig* and apply the keys (K~RRCenc~ and K~RRCint~) associated
with the master key (K~eNB~/ K~gNB~) or secondary key (S-K~gNB~) as
indicated in *keyToUse*, if applicable;

2\> if the current UE configuration as configured by E-UTRA in TS 36.331
\[10\] includes an SRB identified with the same *srb-Identity* value:

3\> associate the E-UTRA RLC entity and DCCH of this SRB with the NR
PDCP entity;

3\> release the E-UTRA PDCP entity of this SRB;

2\> if the *pdcp-Config* is included:

3\> configure the PDCP entity in accordance with the received
*pdcp-Config*;

2\> else:

3\> configure the PDCP entity in accordance with the default
configuration defined in 9.2.1 for the corresponding SRB;

1\> for each *srb-Identity* value included in the *srb-ToAddModList*
that is part of the current UE configuration:

2\> if the *reestablishPDCP* is set:

3\> if target RAT of handover is E-UTRA/5GC, or;

3\> if the UE is only connected to E-UTRA/5GC:

4\> configure the PDCP entity to apply the integrity protection
algorithm and K~RRCint~ key configured/derived as specified in TS 36.331
\[10\], i.e. the integrity protection configuration shall be applied to
all subsequent messages received and sent by the UE, including the
message used to indicate the successful completion of the procedure;

4\> configure the PDCP entity to apply the ciphering algorithm and
K~RRCenc~ key configured/derived as specified in TS 36.331 \[10\], i.e.
the ciphering configuration shall be applied to all subsequent messages
received and sent by the UE, including the message used to indicate the
successful completion of the procedure;

3\> else:

4\> configure the PDCP entity to apply the integrity protection
algorithm and K~RRCint~ key associated with the master key
(K~eNB~/K~gNB~) or secondary key (S-K~gNB~), as indicated in *keyToUse*
, i.e. the integrity protection configuration shall be applied to all
subsequent messages received and sent by the UE, including the message
used to indicate the successful completion of the procedure;

4\> configure the PDCP entity to apply the ciphering algorithm and
K~RRCenc~ key associated with the master key (K~eNB~/K~gNB~) or
secondary key (S-K~gNB~) as indicated in *keyToUse*, i.e. the ciphering
configuration shall be applied to all subsequent messages received and
sent by the UE, including the message used to indicate the successful
completion of the procedure;

4\> re-establish the PDCP entity of this SRB as specified in TS 38.323
\[5\];

2\> else, if the *discardOnPDCP* is set:

3\> trigger the PDCP entity to perform SDU discard as specified in TS
38.323 \[5\];

2\> if the *pdcp-Config* is included:

3\> reconfigure the PDCP entity in accordance with the received
*pdcp-Config*.

\[TS 38.331, clause 5.3.5.6.4\]

The UE shall:

1\> for each *drb-Identity* value included in the *drb-ToReleaseList*
that is part of the current UE configuration; or

1\> for each *drb-Identity* value that is to be released as the result
of full configuration according to 5.3.5.11:

2\> release the PDCP entity and the *drb-Identity*;

2\> if SDAP entity associated with this DRB is configured:

3\> indicate the release of the DRB to SDAP entity associated with this
DRB (TS 37.324 \[24\], clause 5.3.3);

2\> if the UE is operating in EN-DC:

3\> if a new bearer is not added either with NR or E-UTRA with same
*eps-BearerIdentity*:

4\> indicate the release of the DRB and the *eps-BearerIdentity* of the
released DRB to upper layers.

NOTE 1: The UE does not consider the message as erroneous if the
*drb-ToReleaseList* includes any *drb-Identity* value that is not part
of the current UE configuration.

NOTE 2: Whether or not the RLC and MAC entities associated with this
PDCP entity are reset or released is determined by the
*CellGroupConfig*.

\[TS 38.331, clause 5.3.5.6.5\]

The UE shall:

1\> for each *drb-Identity* value included in the *drb-ToAddModList*
that is not part of the current UE configuration (DRB establishment
including the case when full configuration option is used):

2\> establish a PDCP entity and configure it in accordance with the
received *pdcp-Config*;

2\> if the PDCP entity of this DRB is not configured with
*cipheringDisabled:*

3\> if target RAT of handover is E-UTRA/5GC, or;

3\> if the UE is only connected to E-UTRA/5GC:

4\> configure the PDCP entity with the ciphering algorithm and K~UPenc~
key configured/derived as specified in TS 36.331 \[10\];

3\> else:

4\> configure the PDCP entity with the ciphering algorithms according to
*securityConfig* and apply the K~UPenc~ key associated with the master
key (K~eNB~/K~gNB~) or the secondary key (S-K~gNB~) as indicated in
keyToUse;

2\> if the PDCP entity of this DRB is configured with
*integrityProtection*:

3\> configure the PDCP entity with the integrity algorithms according to
*securityConfig* and apply the K~UPint~ key associated with the master
(K~eNB~/K~gNB~) or the secondary key (S-K~gNB~) as indicated in
*keyToUse*;

2\> if an *sdap-Config* is included:

3\> if an SDAP entity with the received *pdu-Session* does not exist:

4\> establish an SDAP entity as specified in TS 37.324 \[24\] clause
5.1.1;

4\> If an SDAP entity with the received *pdu-Session* did not exist
prior to receiving this reconfiguration:

5\> indicate the establishment of the user plane resources for the
*pdu-Session* to upper layers;

3\> configure the SDAP entity in accordance with the received
*sdap-Config* as specified in TS 37.324 \[24\] and associate the DRB
with the SDAP entity;

2\> if the UE is operating in EN-DC:

3\> if the DRB was configured with the same *eps-BearerIdentity* either
by NR or E-UTRA prior to receiving this reconfiguration:

4\> associate the established DRB with the corresponding
*eps-BearerIdentity;*

3\> else:

4\> indicate the establishment of the DRB(s) and the
*eps-BearerIdentity* of the established DRB(s) to upper layers;

##### 8.1.2.1.1.3 Test description {#test-description-23 .H6}

##### 8.1.2.1.1.3.1 Pre-test conditions {#pre-test-conditions-23 .H6}

##### System Simulator: {#system-simulator-24 .H6}

\- NR Cell 1

##### UE: {#ue-24 .H6}

\- None

##### Preamble: {#preamble-23 .H6}

\- If pc\_IP\_Ping is set to TRUE then the UE is in 5GS state 1N-A, PDU
SESSION ACTIVE according to TS 38.508-1 \[4\], clause 4.4A.2 Table
4.4A.2-1

\- Else, the UE is in 5GS state 1N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.2.1.1.3.2 Test procedure sequence {#test-procedure-sequence-24 .H6}

Table 8.1.2.1.1.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | SS        | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | to the UE |           |           |         |    |
|           | on the    |           |           |         |    |
|           | ap        |           |           |         |    |
|           | propriate |           |           |         |    |
|           | paging    |           |           |         |    |
|           | block,    |           |           |         |    |
|           | and       |           |           |         |    |
|           | including |           |           |         |    |
|           | the UE    |           |           |         |    |
|           | identity  |           |           |         |    |
|           | in one    |           |           |         |    |
|           | entry of  |           |           |         |    |
|           | the IE    |           |           |         |    |
|           | *         |           |           |         |    |
|           | pagingRec |           |           |         |    |
|           | ordList*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | UE        | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *RRCSetu  |         |    |
|           | an        |           | pRequest* |         |    |
|           | *RRCSetu  |           |           |         |    |
|           | pRequest* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | SS        | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCSetup* |         |    |
|           | *         |           |           |         |    |
|           | RRCSetup* |           |           |         |    |
|           | message   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *RRCSetup |         |    |
|           | an        |           | Complete* |         |    |
|           | *RRCSetup |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | to        |           |           |         |    |
|           | confirm   |           |           |         |    |
|           | the       |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of the    |           |           |         |    |
|           | c         |           |           |         |    |
|           | onnection |           |           |         |    |
|           | estab     |           |           |         |    |
|           | lishment. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | SS        | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Se       |         |    |
|           | a         |           | curityMod |         |    |
|           | *Se       |           | eCommand* |         |    |
|           | curityMod |           |           |         |    |
|           | eCommand* |           |           |         |    |
|           | message   |           |           |         |    |
|           | to        |           |           |         |    |
|           | activate  |           |           |         |    |
|           | AS        |           |           |         |    |
|           | security. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | Using the | \<\--     | NR RRC:   | \-      | \- |
|           | same slot |           | *R        |         |    |
|           | as the    |           | RCReconfi |         |    |
|           | *Se       |           | guration* |         |    |
|           | curityMod |           |           |         |    |
|           | eCommand* |           |           |         |    |
|           | message   |           |           |         |    |
|           | in step   |           |           |         |    |
|           | 5, the SS |           |           |         |    |
|           | transmits |           |           |         |    |
|           | an        |           |           |         |    |
|           | *R        |           |           |         |    |
|           | RCReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | message   |           |           |         |    |
|           | to        |           |           |         |    |
|           | establish |           |           |         |    |
|           | a data    |           |           |         |    |
|           | radio     |           |           |         |    |
|           | bearer,   |           |           |         |    |
|           | DRB1 and  |           |           |         |    |
|           | s         |           |           |         |    |
|           | ignalling |           |           |         |    |
|           | radio     |           |           |         |    |
|           | bearer,   |           |           |         |    |
|           | SRB2.     |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | Check:    | \--\>     | NR RRC:   | 1       | P  |
|           | Does the  |           | *Sec      |         |    |
|           | UE        |           | urityMode |         |    |
|           | transmit  |           | Complete* |         |    |
|           | a         |           |           |         |    |
|           | *Sec      |           |           |         |    |
|           | urityMode |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | Check:    | \--\>     | NR RRC:   | 1       | P  |
|           | Does the  |           | *         |         |    |
|           | UE        |           | RRCReconf |         |    |
|           | transmit  |           | iguration |         |    |
|           | an        |           | Complete* |         |    |
|           | *         |           |           |         |    |
|           | RRCReconf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | to        |           |           |         |    |
|           | confirm   |           |           |         |    |
|           | the       |           |           |         |    |
|           | esta      |           |           |         |    |
|           | blishment |           |           |         |    |
|           | of data   |           |           |         |    |
|           | radio     |           |           |         |    |
|           | bearer,   |           |           |         |    |
|           | DRB1 and  |           |           |         |    |
|           | s         |           |           |         |    |
|           | ignalling |           |           |         |    |
|           | radio     |           |           |         |    |
|           | bearer,   |           |           |         |    |
|           | SRB2?     |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | Void      |           |           | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | Void      |           |           | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 11        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCReconfi |         |    |
|           | *R        |           | guration* |         |    |
|           | RCReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | message   |           |           |         |    |
|           | *to       |           |           |         |    |
|           | modify*   |           |           |         |    |
|           | SRB and   |           |           |         |    |
|           | DRB       |           |           |         |    |
|           | confi     |           |           |         |    |
|           | guration. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12        | Check:    | \--\>     | NR RRC:   | 2       | P  |
|           | Does the  |           | *         |         |    |
|           | UE        |           | RRCReconf |         |    |
|           | transmit  |           | iguration |         |    |
|           | an        |           | Complete* |         |    |
|           | *         |           |           |         |    |
|           | RRCReconf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12A       | Check:    | \-        | *-*       | 2       | \- |
|           | Does the  |           |           |         |    |
|           | test      |           |           |         |    |
|           | result of |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | subclause |           |           |         |    |
|           | 4.9.1     |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | UE is     |           |           |         |    |
|           | capable   |           |           |         |    |
|           | of        |           |           |         |    |
|           | e         |           |           |         |    |
|           | xchanging |           |           |         |    |
|           | IP data   |           |           |         |    |
|           | on DRB\#1 |           |           |         |    |
|           | es        |           |           |         |    |
|           | tablished |           |           |         |    |
|           | in Step   |           |           |         |    |
|           | 11?       |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12A1      | The SS    | \<\--     | OPEN UE   | \-      | \- |
|           | transmits |           | TEST LOOP |         |    |
|           | an OPEN   |           |           |         |    |
|           | UE TEST   |           |           |         |    |
|           | LOOP      |           |           |         |    |
|           | Message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12A2      | The UE    | \--\>     | OPEN UE   | \-      | \- |
|           | transmits |           | TEST LOOP |         |    |
|           | an OPEN   |           | COMPLETE  |         |    |
|           | UE TEST   |           |           |         |    |
|           | LOOP      |           |           |         |    |
|           | COMPLETE  |           |           |         |    |
|           | Message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12A3      | The SS    | \<\--     | D         | \-      | \- |
|           | transmits |           | EACTIVATE |         |    |
|           | D         |           | TEST MODE |         |    |
|           | EACTIVATE |           |           |         |    |
|           | TEST MODE |           |           |         |    |
|           |           |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12A4      | The UE    | \--\>     | D         | \-      | \- |
|           | transmits |           | EACTIVATE |         |    |
|           | D         |           | TEST MODE |         |    |
|           | EACTIVATE |           | COMPLETE  |         |    |
|           | TEST MODE |           |           |         |    |
|           |           |           |           |         |    |
|           | COMPLETE  |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12B       | Cause the | \-        | *-*       | \-      | \- |
|           | UE to     |           |           |         |    |
|           | request   |           |           |         |    |
|           | esta      |           |           |         |    |
|           | blishment |           |           |         |    |
|           | of PDU    |           |           |         |    |
|           | sess      |           |           |         |    |
|           | ion.(Note |           |           |         |    |
|           | 1)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12C       | The PDU   | \-        | \-        | \-      | \- |
|           | session   |           |           |         |    |
|           | esta      |           |           |         |    |
|           | blishment |           |           |         |    |
|           | procedure |           |           |         |    |
|           | as        |           |           |         |    |
|           | specified |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | subclause |           |           |         |    |
|           | 4.5A.2    |           |           |         |    |
|           | takes     |           |           |         |    |
|           | place.    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 13        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCReconfi |         |    |
|           | RRCReconf |           | guration* |         |    |
|           | iguration |           |           |         |    |
|           | message   |           | 5GMM: DL  |         |    |
|           | with a    |           | NAS       |         |    |
|           | *         |           | TRANSPORT |         |    |
|           | drb-ToRel |           |           |         |    |
|           | easeList* |           | 5GSM: PDU |         |    |
|           | and PDU   |           | SESSION   |         |    |
|           | SESSION   |           | RELEASE   |         |    |
|           | RELEASE   |           | COMMAND   |         |    |
|           | COMMAND   |           |           |         |    |
|           | to        |           |           |         |    |
|           | release   |           |           |         |    |
|           | the PDU   |           |           |         |    |
|           | session   |           |           |         |    |
|           | to which  |           |           |         |    |
|           | the       |           |           |         |    |
|           | released  |           |           |         |    |
|           | DRB is    |           |           |         |    |
|           | a         |           |           |         |    |
|           | ssociated |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14        | Check:    | \--\>     | NR RRC:   | 3       | P  |
|           | Does the  |           | *         |         |    |
|           | UE        |           | RRCReconf |         |    |
|           | transmit  |           | iguration |         |    |
|           | an        |           | Complete* |         |    |
|           | *         |           |           |         |    |
|           | RRCReconf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 16        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *ULIn     |         |    |
|           | an        |           | formation |         |    |
|           | *ULIn     |           | Transfer* |         |    |
|           | formation |           |           |         |    |
|           | Transfer* |           | 5GMM: UL  |         |    |
|           | message   |           | NAS       |         |    |
|           | and a UL  |           | TRANSPORT |         |    |
|           | NAS       |           |           |         |    |
|           | TRASPORT  |           | 5GSM: PDU |         |    |
|           | c         |           | SESSION   |         |    |
|           | ontaining |           | RELEASE   |         |    |
|           | PDU       |           | COMPLETE  |         |    |
|           | SESSION   |           |           |         |    |
|           | RELEASE   |           |           |         |    |
|           | COMPLETE. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| NOTE 1:   |           |           |           |         |    |
| The       |           |           |           |         |    |
| request   |           |           |           |         |    |
| to        |           |           |           |         |    |
| establish |           |           |           |         |    |
| a PDU     |           |           |           |         |    |
| session   |           |           |           |         |    |
| may be    |           |           |           |         |    |
| performed |           |           |           |         |    |
| by MMI or |           |           |           |         |    |
| AT        |           |           |           |         |    |
| Command.  |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.2.1.1.3.3 Specific message contents {#specific-message-contents-19 .H6}

Table 8.1.2.1.1.3.3-1: RRCReconfiguration (Step 6, Table
8.1.2.1.1.3.2-1)

  Derivation Path: TS 38.508-1, table 4.6.1-13                                                                                                 
  ---------------------------------------------- ------------------------------------------------- ------------------------------------------- -----------
  Information Element                            Value/remark                                      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                            
  criticalExtensions CHOICE {                                                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                                                
  radioBearerConfig                              RadioBearerConfig with conditions SRB2 and DRB1                                               
  nonCriticalExtension SEQUENCE {                                                                                                              
  masterCellGroup                                CellGroupConfig                                   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            

Table 8.1.2.1.1.3.3-1A: CellGroupConfig (Table 8.1.2.1.1.3.3-1)

  --------------------------------------------------------------------------- --------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1, table 4.6.3-19                                                                                                                      
  Information Element                                                         Value/remark                                                                Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                                    
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLC-ID)) OF RLC-BearerConfig {   2 entries                                                                             
  RLC-Bearer-Config\[1\] SEQUENCE {                                                                                                                       entry 1   
  logicalChannelIdentity                                                      LogicalChannelIdentity                                                                
  servedRadioBearer CHOICE {                                                                                                                                        
  drb-Identity                                                                DRB-Identity with condition DRB1                                                      
  }                                                                                                                                                                 
  reestablishRLC                                                              Not present                                                                           
  RLC-Config                                                                  RLC-Config with condition AM according to 38.508-1 \[4\], table 4.6.3-149             
  mac-LogicalChannelConfig                                                    LogicalChannelConfig according to 38.508-1 \[4\], table 4.6.3-66                      
  }                                                                                                                                                                 
  RLC-Bearer-Config\[2\] SEQUENCE {                                                                                                                       entry 2   
  logicalChannelIdentity                                                      LogicalChannelIdentity                                                                
  servedRadioBearer CHOICE {                                                                                                                                        
  srb-Identity                                                                SRB-Identity with condition SRB2                                                      
  }                                                                                                                                                                 
  reestablishRLC                                                              Not present                                                                           
  RLC-Config                                                                  Not present                                                                           
  mac-LogicalChannelConfig                                                    LogicalChannelConfig according to 38.508-1 \[4\], table 4.6.3-66                      
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  mac-CellGroupConfig                                                         Not present                                                                           
  physicalCellGroupConfig                                                     Not present                                                                           
  spCellConfig SEQUENCE                                                       Not present                                                                           
  }                                                                                                                                                                 
  --------------------------------------------------------------------------- --------------------------------------------------------------------------- --------- -----------

Table 8.1.2.1.1.3.3-2: Void

Table 8.1.2.1.1.3.3-2A: Void

Table 8.1.2.1.1.3.3-3: RRCReconfiguration (Step 11, Table
8.1.2.1.1.3.2-1)

  Derivation Path: TS 38.508-1, table 4.6.1-13                                                                 
  ---------------------------------------------- ----------------- ------------------------------------------- -----------
  Information Element                            Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                            
  criticalExtensions CHOICE {                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                
  nonCriticalExtension SEQUENCE {                                                                              
  masterCellGroup                                CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            
                                                                                                               

Table 8.1.2.1.1.3.3-4: CellGroupConfig (Table 8.1.2.1.1.3.3-3)

  Derivation Path: TS 38.508-1, table 4.6.3-19                                                                                                                      
  --------------------------------------------------------------------------- --------------------------------------------------------------------------- --------- -----------
  Information Element                                                         Value/remark                                                                Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                                    
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLC-ID)) OF RLC-BearerConfig {   2 entries                                                                             
  RLC-Bearer-Config\[1\] SEQUENCE {                                                                                                                       entry 1   
  logicalChannelIdentity                                                      LogicalChannelIdentity                                                                
  servedRadioBearer CHOICE {                                                                                                                                        
  srb-Identity                                                                SRB-Identity with condition SRB2                                                      
  }                                                                                                                                                                 
  reestablishRLC                                                              true                                                                                  
  RLC-Config                                                                  RLC-Config with condition AM according to 38.508-1 \[4\], table 4.6.3-149             
  mac-LogicalChannelConfig                                                    LogicalChannelConfig according to 38.508-1 \[4\], table 4.6.3-66                      
  }                                                                                                                                                                 
  RLC-Bearer-Config\[2\] SEQUENCE {                                                                                                                       entry 2   
  logicalChannelIdentity                                                      LogicalChannelIdentity                                                                
  servedRadioBearer CHOICE {                                                                                                                                        
  drb-Identity                                                                DRB-Identity with condition DRB1                                                      
  }                                                                                                                                                                 
  reestablishRLC                                                              true                                                                                  
  RLC-Config                                                                  Not present                                                                           
  mac-LogicalChannelConfig                                                    LogicalChannelConfig according to 38.508-1 \[4\], table 4.6.3-66                      
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  mac-CellGroupConfig                                                         Not present                                                                           
  physicalCellGroupConfig                                                     Not present                                                                           
  spCellConfig SEQUENCE                                                       Not present                                                                           
  }                                                                                                                                                                 

Table 8.1.2.1.1.3.3-5: RRCReconfiguration (Step 13, Table
8.1.2.1.1.3.2-1)

  --------------------------------------------- ------------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1, table 4.6.1-3                                                                   
  Information Element                           Value/remark        Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                             
  criticalExtensions CHOICE {                                                                                   
  rrcReconfiguration SEQUENCE {                                                                                 
  radioBearerConfig                             RadioBearerConfig                                               
  nonCriticalExtension SEQUENCE {                                                                               
  masterCellGroup                               CellGroupConfig     OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                             
  }                                                                                                             
  }                                                                                                             
  --------------------------------------------- ------------------- ------------------------------------------- -----------

Table 8.1.2.1.1.3.3-6: *RadioBearerConfig* (Table 8.1.2.1.1.3.3-5)

  ----------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-132                            
  Information Element                                   Value/remark   Comment   Condition
  RadioBearerConfig ::= SEQUENCE {                                               
  drb-ToReleaseList                                     1              DRB1      
  }                                                                              
  ----------------------------------------------------- -------------- --------- -----------

Table 8.1.2.1.1.3.3-7: *CellGroupConfig* (Table 8.1.2.1.1.3.3-5)

  ---------------------------------------------------------------------------------- ------------------------ ------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19                                                                        
  **Information Element**                                                            **Value/remark**         **Comment**   **Condition**
  CellGroupConfig ::= SEQUENCE {                                                                                            
  cellGroupId                                                                        1                                      
  rlc-BearerToAddModList                                                             Not Present                            
  rlc-BearerToReleaseList SEQUENCE (SIZE(1..maxLC-ID)) OF LogicalChannelIdentity {   1 entry                                
  logicalChannelIdentity\[1\]                                                        LogicalChannelIdentity   entry 1       
  }                                                                                                                         
  mac-CellGroupConfig                                                                Not Present                            
  tag-Config                                                                         Not Present                            
  phr-Config                                                                         Not Present                            
  physicalCellGroupConfig                                                            Not Present                            
  rlf-TimersAndConstants                                                             Not Present                            
  }                                                                                                                         
  ---------------------------------------------------------------------------------- ------------------------ ------------- ---------------

##### 8.1.2.1.2 RRC reconfiguration / RRC bearer establishment / uplinkTxDirectCurrentList

##### 8.1.2.1.2.1 Test Purpose (TP) {#test-purpose-tp-24 .H6}

##### (1) {#section-47 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives a RRCReconfiguration message containing
reportUplinkTxDirectCurrent }

**then** { UE will include the uplinkTxDirectCurrentList in
RRCReconfigurationComplete message. }

}

##### 8.1.2.1.2.2 Conformance requirements {#conformance-requirements-24 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.5.3. Unless otherwise stated these
are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> set the content of *RRCReconfigurationComplete* message as follows:

2\> if the *RRCReconfiguration* includes the *masterCellGroup*
containing the *reportUplinkTxDirectCurrent*, or;

2\> if the *RRCReconfiguration* includes the *secondaryCellGroup*
containing the *reportUplinkTxDirectCurrent*:

3\> include the *uplinkTxDirectCurrentList*;

##### 8.1.2.1.2.3 Test description {#test-description-24 .H6}

##### 8.1.2.1.2.3.1 Pre-test conditions {#pre-test-conditions-24 .H6}

##### System Simulator: {#system-simulator-25 .H6}

\- NR Cell 1.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1 is used in NR cell.

##### UE: {#ue-25 .H6}

\- None.

##### Preamble: {#preamble-24 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3.

##### 8.1.2.1.2.3.2 Test procedure sequence {#test-procedure-sequence-25 .H6}

Table 8.1.2.1.2.3.2-1: Main behaviour

  St   Procedure                                                                                                                                          Message Sequence   TP                                   Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ------------------------------------ --------- ----
                                                                                                                                                          U - S              Message                                        
  1    The SS transmits a *RRCReconfiguration* message containing uplinkBWP-ToAddModList IE to add BWP\#1 and including reportUplinkTxDirectCurrent IE.   \<\--              NR RRC: RRCReconfiguration           \-        \-
  2    Check: Does the UE transmit the *RRCReconfigurationComplete* message including the uplinkTxDirectCurrentList?                                      \--\>              NR RRC: RRCReconfigurationComplete   1         P

##### 8.1.2.1.2.3.3 Specific message contents {#specific-message-contents-20 .H6}

Table 8.1.2.1.2.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.2.1.2.3.2-1)

  ---------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13                               
  Information Element                                  Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                
  criticalExtensions CHOICE {                                                      
  rrcReconfiguration SEQUENCE {                                                    
  nonCriticalExtension SEQUENCE {                                                  
  masterCellGroup                                      CellGroupConfig             
  }                                                                                
  }                                                                                
  }                                                                                
  }                                                                                
  ---------------------------------------------------- ----------------- --------- -----------

Table 8.1.2.1.2.3.3-2: *CellGroupConfig* (Table 8.1.2.1.2.3.3-1)

  ---------------------------------------------------- ------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19                                 
  Information Element                                  Value/remark        Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                     
  spCellConfig SEQUENCE {                                                            
  spCellConfigDedicated                                ServingCellConfig             
  }                                                                                  
  reportUplinkTxDirectCurrent-v1530                    true                          
  }                                                                                  
  ---------------------------------------------------- ------------------- --------- -----------

Table 8.1.2.1.2.3.3-3: ServingCellConfig (Table 8.1.2.1.2.3.3-2)

+-------------------+--------------+-------------------+-----------+
| Derivation Path:  |              |                   |           |
| TS 38.508-1 \[4\] |              |                   |           |
| Table 4.6.3-167   |              |                   |           |
+===================+==============+===================+===========+
| Information       | Value/remark | Comment           | Condition |
| Element           |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| Servin            |              |                   |           |
| gCellConfigCommon |              |                   |           |
| ::= SEQUENCE {    |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| uplinkConfig      |              |                   |           |
| SEQUENCE {        |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| uplin             | 1 entry      |                   |           |
| kBWP-ToAddModList |              |                   |           |
| SEQUENCE (SIZE    |              |                   |           |
| (1..maxNrofBWPs)) |              |                   |           |
| OF BWP-Uplink {   |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| BWP-Uplink\[1\]   | BWP-Uplink   | entry 1           |           |
|                   |              |                   |           |
|                   |              | TS 38.508-1       |           |
|                   |              | \[4\], Table      |           |
|                   |              | 4.6.3-13 to add   |           |
|                   |              | BWP\#1            |           |
+-------------------+--------------+-------------------+-----------+
| }                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| }                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| }                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+

Table 8.1.2.1.2.3.3-4: *RRCReconfigurationComplete* (step 2, Table
8.1.2.1.2.3.2-1)

  --------------------------------------------------------------------------------------------------- ------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-14                                                                                           
  Information Element                                                                                 Value/remark                   Comment   Condition
  RRCReconfigurationComplete ::= SEQUENCE {                                                                                                    
  rrc-TransactionIdentifier                                                                           Not checked                              
  criticalExtensions CHOICE {                                                                                                                  
  rrcReconfigurationComplete SEQUENCE {                                                                                                        
  lateNonCriticalExtension                                                                            Not checked                              
  nonCriticalExtension SEQUENCE {                                                                                                              
  UplinkTxDirectCurrentList SEQUENCE (SIZE (1..maxNrofServingCells)) OF UplinkTxDirectCurrentCell {   1 entry                                  
  UplinkTxDirectCurrentCell\[1\] SEQUENCE {                                                                                          entry 1   
  servCellIndex                                                                                       0                                        
  UplinkTxDirectCurrentBWP SEQUENCE (SIZE (1..maxNrofBWPs)) OF UplinkTxDirectCurrentBWP {             2 entries                                
  UplinkTxDirectCurrentBWP\[1\] SEQUENCE {                                                                                           entry 1   
  bwp-Id                                                                                              0                                        
  shift7dot5kHz                                                                                       Not checked                              
  txDirectCurrentLocation                                                                             Any value between 0 and 3299             
  }                                                                                                                                            
  UplinkTxDirectCurrentBWP\[2\] SEQUENCE {                                                                                           entry 2   
  bwp-Id                                                                                              1                                        
  shift7dot5kHz                                                                                       Not checked                              
  txDirectCurrentLocation                                                                             Any value between 0 and 3299             
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  nonCriticalExtension                                                                                Not checked                              
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  --------------------------------------------------------------------------------------------------- ------------------------------ --------- -----------

##### 8.1.2.1.3 Void

##### 8.1.2.1.4 RRC reconfiguration / Dedicated RLF timer

##### 8.1.2.1.4.1 Test Purpose (TP) {#test-purpose-tp-25 .H6}

##### (1) {#section-48 .H6}

**with** { UE in NR RRC\_CONNECTED state configured with timers
according *rlf-TimersAndConstants* }

**ensure that** {

**when** { UE detecting radio link failure on expiring of timer T310 }

**then** { UE sends an *RRCReestablishmentRequest* message according
*rlf-TimersAndConstants* }

}

##### (2) {#section-49 .H6}

**with** { UE in NR RRC\_CONNECTED state with *rlf-TimersAndConstants*
released}

**ensure that** {

**when** { UE detecting radio link failure on expiring of timer T310 }

**then** { UE sends an *RRCReestablishmentRequest* message according
*ue-TimersAndConstants* }

}

##### 8.1.2.1.4.2 Conformance requirements {#conformance-requirements-25 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.5.3, 5.3.5.5, 5.3.5.5.6 and
5.3.5.5.7.

\[TS 38.331 clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\[TS 38.331 clause 5.3.5.5\]

The UE performs the following actions based on a received
*CellGroupConfig* IE:

...

1\> if the *CellGroupConfig* contains the *spCellConfig*:

2\> configure the SpCell as specified in 5.3.5.5.7;

\[TS 38.331 clause 5.3.5.5.7\]

The UE shall:

1\> if the *SpCellConfig* contains the *rlf-TimersAndConstants*:

2\> configure the RLF timers and constants for this cell group as
specified in 5.3.5.5.6;

\[TS 38.331 clause 5.3.5.5.6\]

The UE shall:

1\> if the received *rlf-TimersAndConstants* is set to *release*:

2\> use values for timers T301, T310, T311 and constants N310, N311, as
included in *ue-TimersAndConstants* received in *SIB1*;

1\> else:

2\> (re-)configure the value of timers and constants in accordance with
received *rlf-TimersAndConstants*;

##### 8.1.2.1.4.3 Test description {#test-description-25 .H6}

##### 8.1.2.1.4.3.1 Pre-test conditions {#pre-test-conditions-25 .H6}

##### System Simulator: {#system-simulator-26 .H6}

> \- NR Cell 1 and NR Cell 2.
>
> \- System information combination NR-2 as defined in TS 38.508-1 \[4\]
> clause 4.4.3.1.2 is used in NR cells.

None.

##### Preamble: {#preamble-25 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.2.1.4.3.2 Test procedure sequence {#test-procedure-sequence-26 .H6}

Table 8.1.2.1.4.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-----------+---------+--------+--------+
|    | Parameter | Unit    | NR     | NR     |
|    |           |         |        |        |
|    |           |         | Cell 1 | Cell 2 |
+====+===========+=========+========+========+
| T1 | SS/PBCH   | dBm/SCS | "Off"  | -88    |
|    |           |         |        |        |
|    | SSS EPRE  |         |        |        |
+----+-----------+---------+--------+--------+
| T2 | SS/PBCH   | dBm/SCS | "-88"  | "Off"  |
|    |           |         |        |        |
|    | SSS EPRE  |         |        |        |
+----+-----------+---------+--------+--------+

Table 8.1.2.1.4.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+-----------+---------+--------+--------+
|    | Parameter | Unit    | NR     | NR     |
|    |           |         |        |        |
|    |           |         | Cell 1 | Cell 2 |
+====+===========+=========+========+========+
| T1 | SS/PBCH   | dBm/SCS | "Off"  | -82    |
|    |           |         |        |        |
|    | SSS EPRE  |         |        |        |
+----+-----------+---------+--------+--------+
| T2 | SS/PBCH   | dBm/SCS | "-82"  | "Off"  |
|    |           |         |        |        |
|    | SSS EPRE  |         |        |        |
+----+-----------+---------+--------+--------+

Table 8.1.2.1.4.3.2-3: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \-           | *-*          | \-      | \- |
|    | changes NR   |              |              |         |    |
|    | Cell 1 and   |              |              |         |    |
|    | NR Cell 2    |              |              |         |    |
|    | parameters   |              |              |         |    |
|    | according to |              |              |         |    |
|    | the row      |              |              |         |    |
|    | \"T1\" in    |              |              |         |    |
|    | table        |              |              |         |    |
|    | 8.1          |              |              |         |    |
|    | .2.1.4.3.2-1 |              |              |         |    |
|    | or           |              |              |         |    |
|    | 8.1          |              |              |         |    |
|    | .2.1.4.3.2-2 |              |              |         |    |
|    | in order     |              |              |         |    |
|    | that the     |              |              |         |    |
|    | radio link   |              |              |         |    |
|    | quality of   |              |              |         |    |
|    | NR Cell 1 is |              |              |         |    |
|    | degraded,    |              |              |         |    |
|    | and NR Cell  |              |              |         |    |
|    | 2 is         |              |              |         |    |
|    | suitable for |              |              |         |    |
|    | camping.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | Check: Does  | \--\>        | *NR RRC:     | 1       | P  |
|    | the UE send  |              | RR           |         |    |
|    | *RR          |              | CReestablish |         |    |
|    | CReestablish |              | mentRequest* |         |    |
|    | mentRequest* |              |              |         |    |
|    | message on   |              |              |         |    |
|    | NR Cell 2    |              |              |         |    |
|    | after T310   |              |              |         |    |
|    | expired      |              |              |         |    |
|    | (ms6000)?    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCRees      |         |    |
|    | *RRCRees     |              | tablishment* |         |    |
|    | tablishment* |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | The UE       | \--\>        | *NR RRC:*    | \-      | \- |
|    | transmits an |              |              |         |    |
|    | *RRC         |              | *RRC         |         |    |
|    | Reestablishm |              | Reestablishm |         |    |
|    | entComplete* |              | entComplete* |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCReco      |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    | containing   |              |              |         |    |
|    | *RLF-TimersA |              |              |         |    |
|    | ndConstants* |              |              |         |    |
|    | set to       |              |              |         |    |
|    | release.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCR         |         |    |
|    | *RRC         |              | econfigurati |         |    |
|    | Reconfigurat |              | ontComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | The SS       | \-           | *-*          | \-      | \- |
|    | changes NR   |              |              |         |    |
|    | Cell 1 and   |              |              |         |    |
|    | NR Cell 2    |              |              |         |    |
|    | parameters   |              |              |         |    |
|    | according to |              |              |         |    |
|    | the row      |              |              |         |    |
|    | \"T2\" in    |              |              |         |    |
|    | table        |              |              |         |    |
|    | 8.1          |              |              |         |    |
|    | .2.1.4.3.2-1 |              |              |         |    |
|    | or           |              |              |         |    |
|    | 8.1          |              |              |         |    |
|    | .2.1.4.3.2-2 |              |              |         |    |
|    | in order     |              |              |         |    |
|    | that the     |              |              |         |    |
|    | radio link   |              |              |         |    |
|    | quality of   |              |              |         |    |
|    | NR Cell 2 is |              |              |         |    |
|    | degraded,    |              |              |         |    |
|    | and NR Cell  |              |              |         |    |
|    | 1 is         |              |              |         |    |
|    | suitable for |              |              |         |    |
|    | camping.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8  | Check: Does  | \--\>        | *NR RRC:     | 2       | P  |
|    | the UE send  |              | RR           |         |    |
|    | *RR          |              | CReestablish |         |    |
|    | CReestablish |              | mentRequest* |         |    |
|    | mentRequest* |              |              |         |    |
|    | message on   |              |              |         |    |
|    | NR Cell 1    |              |              |         |    |
|    | after T310   |              |              |         |    |
|    | expired      |              |              |         |    |
|    | (ms1000)?    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits    |              | RRCRees      |         |    |
|    | *RRCRees     |              | tablishment* |         |    |
|    | tablishment* |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 10 | The UE       | \--\>        | *NR RRC:*    | \-      | \- |
|    | transmits an |              |              |         |    |
|    | *RRC         |              | *RRC         |         |    |
|    | Reestablishm |              | Reestablishm |         |    |
|    | entComplete* |              | entComplete* |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 11 | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCReco      |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message to   |              |              |         |    |
|    | establish    |              |              |         |    |
|    | SRB2 and     |              |              |         |    |
|    | DRB.         |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 12 | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCR         |         |    |
|    | *RRCR        |              | econfigurati |         |    |
|    | econfigurati |              | ontComplete* |         |    |
|    | ontComplete* |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.2.1.4.3.3 Specific message contents {#specific-message-contents-21 .H6}

Table 8.1.2.1.4.3.3-1: *RLF-TimersAndConstants* (preamble)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-150                            
  Information Element                                  Value/remark   Comment   Condition
  RLF-TimersAndConstants ::= SEQUENCE {                                         
  t310                                                 ms6000                   
  n310                                                 n20                      
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.2.1.4.3.3-2: *RRCReconfiguration* (step 5, Table
8.1.2.1.4.3.2-3)

  ------------------------------------------------------------------------ ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition REEST                               
  Information Element                                                      Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                    
  criticalExtensions CHOICE {                                                                          
  rrcReconfiguration SEQUENCE {                                                                        
  nonCriticalExtension SEQUENCE {                                                                      
  masterCellGroup                                                          CellGroupConfig             
  }                                                                                                    
  }                                                                                                    
  }                                                                                                    
  }                                                                                                    
  ------------------------------------------------------------------------ ----------------- --------- -----------

Table 8.1.2.1.4.3.3-3: *CellGroupConfig* (Table 8.1.2.1.4.3.3-2)

  ------------------------------------------------------------------------ -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition REEST                            
  Information Element                                                      Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                    
  spCellConfig SEQUENCE {                                                                           
  rlf-TimersAndConstants CHOICE {                                                                   
  release                                                                  NULL                     
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  ------------------------------------------------------------------------ -------------- --------- -----------

Table 8.1.2.1.4.3.3-4: *RRCReconfiguration* (step 11 Table
8.1.2.1.4.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition REEST
  ------------------------------------------------------------------------

##### 8.1.2.1.5 NR CA / RRC reconfiguration / SCell addition / modification / release / Success

###### 8.1.2.1.5.1 NR CA / RRC reconfiguration / SCell addition / modification / release / Success / Intra-band Contiguous CA

##### 8.1.2.1.5.1.1 Test Purpose (TP) {#test-purpose-tp-26 .H6}

##### (1) {#section-50 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message containing
*sCellToAddModList* for SCell addition }

**then** { UE adds the new SCell and sends an
*RRCReconfigurationComplete* message }

}

##### (2) {#section-51 .H6}

**with** { UE in NR RRC\_CONNECTED state with SCell configured}

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message containing
*sCellToAddModList* for SCell modification }

**then** { UE modifies the SCell configuration and sends an
*RRCReconfigurationComplete* message }

}

##### (3) {#section-52 .H6}

**with** { UE in NR RRC\_CONNECTED state with SCell configured}

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message containing
*sCellToReleaseList* }

**then** { UE sends an *RRCReconfigurationComplete* message }

}

##### 8.1.2.1.5.1.2 Conformance requirements {#conformance-requirements-26 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.5.3, 5.3.5.5.1 and 5.3.5.5.9.

\[TS 38.331 clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\[TS 38.331 clause 5.3.5.5.1\]

The UE performs the following actions based on a received
*CellGroupConfig* IE:

...

1\> if the *CellGroupConfig* contains the *sCellToReleaseList*:

2\> perform SCell release as specified in 5.3.5.5.8;

...

1\> if the *CellGroupConfig* contains the *sCellToAddModList*:

2\> perform SCell addition/modification as specified in 5.3.5.5.9.

\[TS 38.331 clause 5.3.5.5.9\]

The UE shall:

> 1\> for each *sCellIndex* value included in the *sCellToAddModList*
> that is not part of the current UE configuration (SCell addition):
>
> 2\> add the SCell, corresponding to the *sCellIndex*, in accordance
> with the *sCellConfigCommon* and *sCellConfigDedicated*;
>
> 2\> configure lower layers to consider the SCell to be in deactivated
> state;

...

> 1\> for each *sCellIndex* value included in the *sCellToAddModList*
> that is part of the current UE configuration (SCell modification):
>
> 2\> modify the SCell configuration in accordance with the
> *sCellConfigDedicated*.

##### 8.1.2.1.5.1.3 Test description {#test-description-26 .H6}

##### 8.1.2.1.5.1.3.1 Pre-test conditions {#pre-test-conditions-26 .H6}

##### System Simulator: {#system-simulator-27 .H6}

> \- NR Cell 1 is the PCell, NR Cell 3 is the SCell.

None.

##### Preamble: {#preamble-26 .H6}

\- The UE is in state 3N-A, and with UE test loop mode B active if
pc\_IP\_Ping is set to FALSE, as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.2.1.5.1.3.2 Test procedure sequence {#test-procedure-sequence-27 .H6}

Table 8.1.2.1.5.1.3.2-1: Main behaviour

  St   Procedure                                                                                                                                                        Message Sequence   TP                                      Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                        U - S              Message                                           
  1    The SS transmits an *RRCReconfiguration*message containing an sCellToAddModList with SCell NR Cell 3 addition,                                                   \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  2    Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                                                             \--\>              *NR RRC: RRCReconfigurationtComplete*   1         P
  3    Check: Does the test result of generic test procedure in TS 38.508-1 subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB1 and Cell 3?   \-                 *-*                                     1         \-
  4    The SS transmits an *RRCReconfiguration*message containing an sCellToAddModList with SCell NR Cell 3 modification.                                               \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  5    Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                                                             \--\>              *NR RRC: RRCReconfigurationtComplete*   2         P
  6    Check: Does the test result of generic test procedure in TS 38.508-1 subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB1 and Cell 3?   \-                 *-*                                     2         \-
  7    The SS transmits an *RRCReconfiguration*message containing an sCellToReleaseList with SCell NR Cell 3.                                                           \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  8    Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                                                             \--\>              *NR RRC: RRCReconfigurationtComplete*   3         P

##### 8.1.2.1.5.1.3.3 Specific message contents {#specific-message-contents-22 .H6}

Table 8.1.2.1.5.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.2.1.5.1.3.2-1)

  -----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add
  -----------------------------------------------------------------------------

Table 8.1.2.1.5.1.3.3-2: *RRCReconfiguration* (step 4, Table
8.1.2.1.5.1.3.2-1)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE {                                                                           
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.2.1.5.1.3.3-3: *CellGroupConfig* (Table 8.1.2.1.5.1.3.3-2)

  ----------------------------------------------------------------------------- ------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                                 
  Information Element                                                           Value/remark        Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                              
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {         1 entry                       
  SCellConfig\[1\] SEQUENCE {                                                                       entry 1   
  sCellConfigCommon                                                             Not present                   
  sCellConfigDedicated                                                          ServingCellConfig             
  }                                                                                                           
  }                                                                                                           
  }                                                                                                           
  ----------------------------------------------------------------------------- ------------------- --------- -----------

Table 8.1.2.1.5.1.3.3-4: *ServingCellConfig* (Table 8.1.2.1.5.1.3.3-3)

  ---------------------------------------------------- ------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-167                                       
  Information Element                                  Value/remark              Comment   Condition
  ServingCellConfig ::= SEQUENCE {                                                         
  firstActiveDownlinkBWP-Id                            Not present                         
  uplinkConfig SEQUENCE {                                                                  
  firstActiveUplinkBWP-Id                              Not present                         
  }                                                                                        
  pdsch-ServingCellConfig CHOICE {                                                         
  setup                                                PDSCH-ServingCellConfig             
  }                                                                                        
  }                                                                                        
  ---------------------------------------------------- ------------------------- --------- -----------

Table 8.1.2.1.5.1.3.3-5: *PDSCH-ServingCellConfig* (Table
8.1.2.1.5.1.3.3-4)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-102                            
  Information Element                                  Value/remark   Comment   Condition
  PDSCH-ServingCellConfig ::= SEQUENCE {                                        
  nrofHARQ-ProcessesForPDSCH                           n16                      
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.2.1.5.1.3.3-6: *RRCReconfiguration* (step 7, Table
8.1.2.1.5.1.3.2-1)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE{                                                                            
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.2.1.5.1.3.3-7: *CellGroupConfig* (Table 8.1.2.1.5.1.3.3-6)

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                            
  Information Element                                                           Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                         
  sCellToAddModList                                                             Not present              
  sCellToReleaseList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellIndex {         1 entry                  
  SCellIndex\[1\]                                                               1              entry 1   
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

###### 8.1.2.1.5.2 NR CA / RRC reconfiguration / SCell addition / modification / release / Success / Inter-band CA

##### 8.1.2.1.5.2.1 Test Purpose (TP) {#test-purpose-tp-27 .H6}

Same as TC 8.1.2.1.5.1 but applied to Inter-band CA.

##### 8.1.2.1.5.2.2 Conformance requirements {#conformance-requirements-27 .H6}

Same as TC 8.1.2.1.5.1 but applied to Inter-band CA.

##### 8.1.2.1.5.2.3 Test description {#test-description-27 .H6}

##### 8.1.2.1.5.2.3.1 Pre-test conditions {#pre-test-conditions-27 .H6}

Same as TC 8.1.2.1.5.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3

##### 8.1.2.1.5.2.3.2 Test procedure sequence {#test-procedure-sequence-28 .H6}

Same as TC 8.1.2.1.5.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3

###### 8.1.2.1.5.3 NR CA / RRC reconfiguration / SCell addition / modification / release / Success / Intra-band non-contiguous CA

##### 8.1.2.1.5.3.1 Test Purpose (TP) {#test-purpose-tp-28 .H6}

Same as TC 8.1.2.1.5.1 but applied to Intra-band non-contiguous CA.

##### 8.1.2.1.5.3.2 Conformance requirements {#conformance-requirements-28 .H6}

Same as TC 8.1.2.1.5.1 but applied to Intra-band non-contiguous CA.

##### 8.1.2.1.5.3.3 Test description {#test-description-28 .H6}

##### 8.1.2.1.5.3.3.1 Pre-test conditions {#pre-test-conditions-28 .H6}

Same as TC 8.1.2.1.5.1 with the following differences:

\- CA configuration: Intra-band non-contiguous replaces Intra-band
Contiguous CA

##### 8.1.2.1.5.3.3.2 Test procedure sequence {#test-procedure-sequence-29 .H6}

Same as TC 8.1.2.1.5.1 with the following differences:

\- CA configuration: Intra-band non-contiguous replaces Intra-band
Contiguous CA

###### 8.1.2.1.5.4 NR CA / RRC reconfiguration / SCell addition / modification / release / Success / Active MCG SCell addition / Intra-band Contiguous CA

##### 8.1.2.1.5.4.1 Test Purpose (TP) {#test-purpose-tp-29 .H6}

##### (1) {#section-53 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message containing
*sCellToAddModList* and *sCellState* for SCell addition }

**then** { UE adds the new SCell and sends an
*RRCReconfigurationComplete* message }

}

##### (2) {#section-54 .H6}

**with** { UE in NR RRC\_CONNECTED state with SCell configured }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message containing
*sCellToAddModList* and *sCellState* for SCell modification }

**then** { UE modifies the SCell configuration and sends an
*RRCReconfigurationComplete* message }

}

##### (3) {#section-55 .H6}

**with** { UE in NR RRC\_CONNECTED state with SCell configured }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message containing
*sCellToReleaseList* }

**then** { UE sends an *RRCReconfigurationComplete* message }

}

##### 8.1.2.1.5.4.2 Conformance requirements {#conformance-requirements-29 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.5.3, 5.3.5.5.1 and 5.3.5.5.9. Unless
otherwise stated these are Rel-16 requirements.

\[TS 38.331 clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\[TS 38.331 clause 5.3.5.5.1\]

The UE performs the following actions based on a received
*CellGroupConfig* IE:

...

1\> if the *CellGroupConfig* contains the *sCellToReleaseList*:

2\> perform SCell release as specified in 5.3.5.5.8;

...

1\> if the *CellGroupConfig* contains the *sCellToAddModList*:

2\> perform SCell addition/modification as specified in 5.3.5.5.9.

\[TS 38.331 clause 5.3.5.5.9\]

The UE shall:

> 1\> for each *sCellIndex* value included in the *sCellToAddModList*
> that is not part of the current UE configuration (SCell addition):
>
> 2\> add the SCell, corresponding to the *sCellIndex*, in accordance
> with the *sCellConfigCommon* and *sCellConfigDedicated*;

2\> if the *sCellState* is included:

3\> configure lower layers to consider the SCell to be in activated
state;

2\> else:

3\> configure lower layers to consider the SCell to be in deactivated
state;

...

> 1\> for each *sCellIndex* value included in the *sCellToAddModList*
> that is part of the current UE configuration (SCell modification):
>
> 2\> modify the SCell configuration in accordance with the
> *sCellConfigDedicated*.

2\> if the *sCellToAddModList* was received in an *RRCReconfiguration*
message including *reconfigurationWithSync,* or received in an
*RRCResume* message, or received in an *RRCReconfiguration* message
including *reconfigurationWithSync* embedded in an *RRCResume* message
or embedded in an *RRCReconfiguration* message or embedded in an E-UTRA
*RRCConnectionReconfiguration* message or embedded in an E-UTRA
*RRCConnectionResume* message:

3\> if the *sCellState* is included:

4\> configure lower layers to consider the SCell to be in activated
state;

3\> else:

4\> configure lower layers to consider the SCell to be in deactivated
state.

##### 8.1.2.1.5.4.3 Test description {#test-description-29 .H6}

##### 8.1.2.1.5.4.3.1 Pre-test conditions {#pre-test-conditions-29 .H6}

##### System Simulator: {#system-simulator-28 .H6}

> \- NR Cell 1 is the PCell, NR Cell 3 is the SCell.

None.

##### Preamble: {#preamble-27 .H6}

\- The UE is in state 3N-A, and with UE test loop mode B active if
pc\_IP\_Ping is set to FALSE, as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.2.1.5.4.3.2 Test procedure sequence {#test-procedure-sequence-30 .H6}

Table 8.1.2.1.5.4.3.2-1: Main behaviour

  St   Procedure                                                                                                                                                        Message Sequence   TP                                      Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                        U - S              Message                                           
  1    The SS transmits an *RRCReconfiguration*message containing an sCellToAddModList with SCell NR Cell 3 addition.                                                   \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  2    Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                                                             \--\>              *NR RRC: RRCReconfigurationtComplete*   1         P
  3    Check: Does the test result of generic test procedure in TS 38.508-1 subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB1 and Cell 3?   \-                 *-*                                     1         \-
  4    The SS transmits an *RRCReconfiguration*message containing an sCellToAddModList with SCell NR Cell 3 modification.                                               \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  5    Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                                                             \--\>              *NR RRC: RRCReconfigurationtComplete*   2         P
  6    Check: Does the test result of generic test procedure in TS 38.508-1 subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB1 and Cell 3?   \-                 *-*                                     2         \-
  7    The SS transmits an *RRCReconfiguration*message containing an sCellToReleaseList with SCell NR Cell 3.                                                           \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  8    Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                                                             \--\>              *NR RRC: RRCReconfigurationtComplete*   3         P

##### 8.1.2.1.5.4.3.3 Specific message contents {#specific-message-contents-23 .H6}

Table 8.1.2.1.5.4.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.2.1.5.4.3.2-1)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE {                                                                           
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.2.1.5.4.3.3-2: *CellGroupConfig* (Table 8.1.2.1.5.4.3.3-1)

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                            
  Information Element                                                           Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                         
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {         1 entry                  
  SCellConfig\[1\] SEQUENCE {                                                                  entry 1   
  sCellState-r16                                                                activated                
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.2.1.5.4.3.3-3: *RRCReconfiguration* (step 4, Table
8.1.2.1.5.4.3.2-1)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE {                                                                           
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.2.1.5.4.3.3-4: *CellGroupConfig* (Table 8.1.2.1.5.4.3.3-3)

  ----------------------------------------------------------------------------- -------------------------------------------------- ----------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                                                                                                      
  Information Element                                                           Value/remark                                       Comment                                         Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                                                   
  spCellConfig SEQUENCE {                                                                                                                                                          
  reconfigurationWithSync SEQUENCE {                                                                                                                                               
  spCellConfigCommon                                                            ServingCellConfigCommon                                                                            
  newUE-Identity                                                                UE identity different from NR cell 1 UE identity                                                   
  }                                                                                                                                                                                
  spCellConfigDedicated                                                         ServingCellConfig                                  According to TS 38.508-1\[4\] Table 4.6.3-167   
  }                                                                                                                                                                                
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {         1 entry                                                                                            
  SCellConfig\[1\] SEQUENCE {                                                                                                      entry 1                                         
  sCellConfigCommon                                                             Not present                                                                                        
  sCellConfigDedicated                                                          ServingCellConfig                                  Table 8.1.2.1.5.4.3.3-5                         
  sCellState-r16                                                                activated                                                                                          
  }                                                                                                                                                                                
  }                                                                                                                                                                                
  }                                                                                                                                                                                
  ----------------------------------------------------------------------------- -------------------------------------------------- ----------------------------------------------- -----------

Table 8.1.2.1.5.4.3.3-5: *ServingCellConfig* (Table 8.1.2.1.5.4.3.3-4)

  ---------------------------------------------------- ------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-167                                       
  Information Element                                  Value/remark              Comment   Condition
  ServingCellConfig ::= SEQUENCE {                                                         
  firstActiveDownlinkBWP-Id                            Not present                         
  uplinkConfig SEQUENCE {                                                                  
  firstActiveUplinkBWP-Id                              Not present                         
  }                                                                                        
  pdsch-ServingCellConfig CHOICE {                                                         
  setup                                                PDSCH-ServingCellConfig             
  }                                                                                        
  }                                                                                        
  ---------------------------------------------------- ------------------------- --------- -----------

Table 8.1.2.1.5.4.3.3-6: *PDSCH-ServingCellConfig* (Table
8.1.2.1.5.4.3.3-5)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-102                            
  Information Element                                  Value/remark   Comment   Condition
  PDSCH-ServingCellConfig ::= SEQUENCE {                                        
  nrofHARQ-ProcessesForPDSCH                           n16                      
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.2.1.5.4.3.3-7: *RRCReconfiguration* (step 7, Table
8.1.2.1.5.4.3.2-1)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE{                                                                            
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.2.1.5.4.3.3-8: *CellGroupConfig* (Table 8.1.2.1.5.4.3.3-7)

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                            
  Information Element                                                           Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                         
  sCellToAddModList                                                             Not present              
  sCellToReleaseList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellIndex {         1 entry                  
  SCellIndex\[1\]                                                               1              entry 1   
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

###### 8.1.2.1.5.5 NR CA / RRC reconfiguration / SCell addition / modification / release / Success / Active MCG SCell addition / Intra-band non-contiguous CA

##### 8.1.2.1.5.5.1 Test Purpose (TP) {#test-purpose-tp-30 .H6}

Same as TC 8.1.2.1.5.4 but applied to Intra-band non-contiguous CA.

##### 8.1.2.1.5.5.2 Conformance requirements {#conformance-requirements-30 .H6}

Same as TC 8.1.2.1.5.4 but applied to Intra-band non-contiguous CA.

##### 8.1.2.1.5.5.3 Test description {#test-description-30 .H6}

##### 8.1.2.1.5.5.3.1 Pre-test conditions {#pre-test-conditions-30 .H6}

Same as TC 8.1.2.1.5.4 with the following differences:

\- CA configuration: Intra-band non-contiguous replaces Intra-band
Contiguous CA

##### 8.1.2.1.5.5.3.2 Test procedure sequence {#test-procedure-sequence-31 .H6}

Same as TC 8.1.2.1.5.4 with the following differences:

\- CA configuration: Intra-band non-contiguous replaces Intra-band
Contiguous CA

###### 8.1.2.1.5.6 NR CA / RRC reconfiguration / SCell addition / modification / release / Success / Active MCG SCell addition / Inter-band CA

##### 8.1.2.1.5.6.1 Test Purpose (TP) {#test-purpose-tp-31 .H6}

Same as TC 8.1.2.1.5.4 but applied to Inter-band CA.

##### 8.1.2.1.5.6.2 Conformance requirements {#conformance-requirements-31 .H6}

Same as TC 8.1.2.1.5.4 but applied to Inter-band CA.

##### 8.1.2.1.5.6.3 Test description {#test-description-31 .H6}

##### 8.1.2.1.5.6.3.1 Pre-test conditions {#pre-test-conditions-31 .H6}

Same as TC 8.1.2.1.5.4 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3

##### 8.1.2.1.5.6.3.2 Test procedure sequence {#test-procedure-sequence-32 .H6}

Same as TC 8.1.2.1.5.4 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3

##### 8.1.2.1.6 RRC reconfiguration/ MUSIM / MUSIM- gap / Addition / Modification / Release

##### 8.1.2.1.6.1 Test Purpose (TP) {#test-purpose-tp-32 .H6}

##### (1) {#section-56 .H6}

**Void**

##### (2) {#section-57 .H6}

**Void**

##### (3) {#section-58 .H6}

**with** { UE in NR RRC\_CONNECTED state}

**ensure that** {

**when** { UE receives the RRCReconfiguration message includes the
musim-GapConfig with periodic musim-GapID involved in
musim-GapToReleaseList in NR Cell 1}

**then** { UE performs normal interworking with NR Cell 1 during the
released gaps periodically }

}

##### (4) {#section-59 .H6}

**void**

##### (5) {#section-60 .H6}

**with** { UE in NR RRC\_CONNECTED state in NR Cell 1 and UE in NR
RRC\_IDLE state in NR Cell 12}

**ensure that**

**when** { UE receives the RRCReconfiguration message includes the
musim-GapConfig with periodic musim-GapID involved in
musim-GapToAddModList and the gap configuration is active in NR Cell 1}

**then** { UE correctly uses MUSIM Gap configured in musim-GapConfig to
monitor CN paging in NR Cell 12 }

}

##### 8.1.2.1.6.2 Conformance requirements {#conformance-requirements-32 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331 clauses 5.3.5.3, 5.3.5.9a and TS 38.133 clause
9.1.10. Unless otherwise stated these are Rel-17 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
RRCReconfiguration, or upon execution of the conditional reconfiguration
(CHO, CPA or CPC):

...

1\> if the *RRCReconfiguration* message includes the *musim-GapConfig*:

2\> perform the MUSIM gap configuration procedure as specified in
5.3.5.9a;

\[TS 38.331, clause 5.3.5.9a\]

The UE shall:

1\> if *musim-GapConfig* is set to *setup*:

2\> for each *musim-GapId* included in the received
*musim-GapToReleaseList*:

3\> release the periodic MUSIM gap configuration associated with the
*musim-GapId*;

2\> for each *MUSIM-Gap* included in the received
*musim-GapToAddModList*:

3\> setup periodic MUSIM gap configuration indicated by the *MUSIM-Gap*
in accordance with the received *musim-GapRepetitionAndOffset*
(providing *musim-GapRepetition* and *Offset* value for the following
condition) i.e. the first subframe of each periodic MUSIM gap occurs at
an SFN and subframe of the NR PCell meeting the following condition:

SFN mod *T* = FLOOR(*Offset*/10);

subframe = *Offset* mod 10;

with *T* = *musim-GapRepetition*/10;

2\> if *musim-AperiodicGap* is included:

3\> setup aperiodic MUSIM gap configuration indicated by the
*musim-AperiodicGap* in accordance with the received
*musim-Starting-SFN-AndSubframe*, i.e. the first subframe of aperiodic
MUSIM gap occurs at an SFN and subframe of the NR PCell meeting the
following condition:

SFN = *starting-SFN*;

subframe = *startingSubframe*;

1\> else if *musim-GapConfig* is set to *release*:

\[TS 38.133, clause 9.1.10\]

If the UE requires gap patterns for MUSIM purpose, such as cell
identification and measurement, paging monitoring, SIB acquisition,
and/or on-demand SI request of the target cell in the target network,
then the network may provide one or more per-UE MUSIM gap pattern(s) for
concurrent monitoring of all frequency layers for MUSIM via
*MUSIM-GapConfig* \[2\]. The UE can be configured with no more than
three periodic MUSIM gap patterns and/or one aperiodic MUSIM gap pattern
for MUSIM via *MUSIM-GapConfig* \[2\]. The MUSIM gap patterns specified
in Table 9.1.10-1 are applicable only for MUSIM operation.

The UE is not required to perform cell identification and measurement,
paging monitoring, SIB acquisition, and/or on-demand SI request of the
target cell in the target network that is outside the MUSIM gaps.

UE supporting MUSIM capability shall support the MUSIM gap patterns
listed in Table 9.1.10-1 based on UE's capability specified in
TS38.306\[14\] and the applicability specified in Table 9.1.10-2

UE determines MUSIM gap timing based on gap offset configuration from
serving cell provided by higher layer signalling as specified in
TS 38.331 \[2\].

Table 9.1.10-1: MUSIM Gap Pattern Configurations

  MUSIM Gap Pattern Id                                                                     MUSIM Gap Length (MGL, ms)   MUSIM Gap Repetition Period (MGRP, ms)
  ---------------------------------------------------------------------------------------- ---------------------------- ----------------------------------------
  0                                                                                        6                            40
  1                                                                                        6                            80
  2                                                                                        3                            40
  3                                                                                        3                            80
  4                                                                                        6                            20
  5                                                                                        6                            160
  6                                                                                        4                            20
  7                                                                                        4                            40
  8                                                                                        4                            80
  9                                                                                        4                            160
  10                                                                                       3                            20
  11                                                                                       3                            160
  12                                                                                       10                           80
  13                                                                                       20                           160
  14                                                                                       6                            320
  15                                                                                       6                            640
  16                                                                                       6                            1280
  17                                                                                       6                            2560
  18                                                                                       10                           320
  19                                                                                       10                           640
  20                                                                                       10                           1280
  21                                                                                       10                           2560
  22                                                                                       20                           320
  23                                                                                       20                           640
  24                                                                                       20                           1280
  25                                                                                       20                           2560
  26                                                                                       20                           5120
  27                                                                                       10                           NA
  28                                                                                       20                           NA
  Note 1: Measurement gap pattern \#27, \#28 are the aperiodic gap pattern without MGRP.                                

Table 9.1.10-2: Applicability for MUSIM Gap Pattern Configurations
supported by the UE with NR standalone operation (with single carrier,
NR CA configuration)

  MUSIM gap pattern configuration                                                                                                                                                                                                                                                  Serving cell   Gap Purpose     Applicable MUSIM Gap Pattern Id
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------- --------------- ---------------------------------
  Per-UE                                                                                                                                                                                                                                                                           FR1, FR2, or   MUSIM ^Note1^   0-13, 14-26, 27, 28
  MUSIM gap                                                                                                                                                                                                                                                                        FR1 + FR2                      
                                                                                                                                                                                                                                                                                                                  
  NOTE 1: Inclusion of MUSIM procedures for per-UE MUSIM gaps only in NR single carrier, NR CA mode: MUSIM purpose which includes cell identification and measurement, paging monitoring, SIB acquisition, and/or on-demand SI request of the target cell in the target network.                                  

##### 8.1.2.1.6.3 Test description {#test-description-32 .H6}

##### 8.1.2.1.6.3.1 Pre-test conditions {#pre-test-conditions-32 .H6}

##### System Simulator: {#system-simulator-29 .H6}

\- NR Cell 1(home PLMN1) and NR Cell 12 (home PLMN2) are configured
according to table 4.4.2-3 in TS 38.508-1 \[18\] and belong to the
different frequency.

\- NR Cell 1 (belongs to TAI-1, home PLMN1, MCC=001,MNC=01) is set to
\'\'Serving cell\'\'.

\- NR Cell 12 (belongs to TAI-3, home PLMN2, MCC=001,MNC=02) is set to
\'\' Serving cell\'\'.

##### UE: {#ue-26 .H6}

\- the UE is a MUSIM UE;

\- the UE is equipped with two USIMs with configuration as defined in TS
38.508-1 \[4\] Tables 6.4.1-27 and 6.4.1-28.

##### Preamble: {#preamble-28 .H6}

\- The UE performs a successful registration for MUSIM according to
Table 4.9.36.2.2-1 of TS 38.508-1 \[4\] with following exceptions.

> \- NGC Cell A is replaced by NR Cell 1
>
> \- NGC Cell G is replaced by NR Cell 12

##### 8.1.2.1.6.3.2 Test procedure sequence {#test-procedure-sequence-33 .H6}

Table 8.1.2.1.6.3.2-1 illustrates a message to be sent for NR Cell 1 at
various time instants of the test execution. Table 8.1.2.1.6.3.2-1A
illustrates the MUSIM Gap parameter used in SET MUSIM UAI REQUEST

Table 8.1.2.1.6.3.2-1: Time instances of sending a message in conducted
test environment

+----+-------------------------------+-------------------------------+
|    | Remark                        | Comment                       |
+====+===============================+===============================+
| T1 | SFN mod *T* =                 | T1 is always outside the gap  |
|    | FLOOR(*Offset*/10);           | configured in Step 10T.       |
|    |                               |                               |
|    | subframe = *Offset* mod 10;   |                               |
|    |                               |                               |
|    | with *T* =                    |                               |
|    | *musim-GapRepetition*/10;     |                               |
|    |                               |                               |
|    | T1 = at the next transmit     |                               |
|    | occasion from SFN + subframe  |                               |
|    | + musim-GapLength + 2ms       |                               |
+----+-------------------------------+-------------------------------+
| T2 | SFN mod *T* =                 | If the gap is not released    |
|    | FLOOR(*Offset*/10);           | successfully, T2 is in the    |
|    |                               | gap in step 10T.              |
|    | subframe = *Offset* mod 10;   |                               |
|    |                               |                               |
|    | with *T* =                    |                               |
|    | *musim-GapRepetition*/10;     |                               |
|    |                               |                               |
|    | T2 = at the next transmit     |                               |
|    | occasion from SFN + subframe  |                               |
|    | + 2ms                         |                               |
+----+-------------------------------+-------------------------------+

Table 8.1.2.1.6.3.2-1A: MUSIM Gap parameter used in SET MUSIM UAI
REQUEST

+---------+---------+---------+---------+---------+---------+---------+
| MUSIM   | MUSIM   | C2..C0  | MUSIM   | D3..D0  | MUSIM   | MUSIM   |
| Gap     | Gap     | in      | Gap     | in      | Gap     | Gap     |
| Pattern | Length  | Table   | Rep     | Table   | offset  | offset  |
| Id(px   | (MGL,   | 8.      | etition | 8.      | for     | for TDD |
| \_MUSIM | ms)     | 1.2.1.6 | Period  | 1.2.1.6 | FDD(ms) | (ms)    |
| \_Perio |         | .3.3-0D | (MGRP,  | .3.3-0D |         |         |
| dicGapP |         |         | ms)     |         | (Note   | (Note1, |
| attern) |         |         |         |         | 1,Note  | Note 2) |
|         |         |         |         |         | 2)      |         |
+=========+=========+=========+=========+=========+=========+=========+
| 0       | 6       | 2       | 40      | 1       | 10      | 30      |
+---------+---------+---------+---------+---------+---------+---------+
| 1       | 6       | 2       | 80      | 2       | 10      | 70      |
+---------+---------+---------+---------+---------+---------+---------+
| 2       | 3       | 0       | 40      | 1       | 10      | 30      |
+---------+---------+---------+---------+---------+---------+---------+
| 3       | 3       | 0       | 80      | 2       | 10      | 70      |
+---------+---------+---------+---------+---------+---------+---------+
| 4       | 6       | 2       | 20      | 0       | 10      | 10      |
+---------+---------+---------+---------+---------+---------+---------+
| 5       | 6       | 2       | 160     | 3       | 90      | 150     |
+---------+---------+---------+---------+---------+---------+---------+
| 6       | 4       | 1       | 20      | 0       | 10      | 10      |
+---------+---------+---------+---------+---------+---------+---------+
| 7       | 4       | 1       | 40      | 1       | 10      | 30      |
+---------+---------+---------+---------+---------+---------+---------+
| 8       | 4       | 1       | 80      | 2       | 10      | 70      |
+---------+---------+---------+---------+---------+---------+---------+
| 9       | 4       | 1       | 160     | 3       | 90      | 150     |
+---------+---------+---------+---------+---------+---------+---------+
| 10      | 3       | 0       | 20      | 0       | 10      | 10      |
+---------+---------+---------+---------+---------+---------+---------+
| 11      | 3       | 0       | 160     | 3       | 10      | 150     |
+---------+---------+---------+---------+---------+---------+---------+
| 12      | 10      | 3       | 80      | 2       | 10      | 70      |
+---------+---------+---------+---------+---------+---------+---------+
| 13      | 20      | 4       | 160     | 3       | 90      | 1       |
|         |         |         |         |         |         | 40(Note |
|         |         |         |         |         |         | 3)      |
+---------+---------+---------+---------+---------+---------+---------+
| 14      | 6       | 2       | 320     | 4       | 250     | 150     |
+---------+---------+---------+---------+---------+---------+---------+
| 15      | 6       | 2       | 640     | 5       | 570     | 470     |
+---------+---------+---------+---------+---------+---------+---------+
| 16      | 6       | 2       | 1280    | 6       | 1210    | 1110    |
+---------+---------+---------+---------+---------+---------+---------+
| 17      | 6       | 2       | 2560    | 7       | 2490    | 2390    |
+---------+---------+---------+---------+---------+---------+---------+
| 18      | 10      | 3       | 320     | 4       | 250     | 150     |
+---------+---------+---------+---------+---------+---------+---------+
| 19      | 10      | 3       | 640     | 5       | 570     | 470     |
+---------+---------+---------+---------+---------+---------+---------+
| 20      | 10      | 3       | 1280    | 6       | 1210    | 1110    |
+---------+---------+---------+---------+---------+---------+---------+
| 21      | 10      | 3       | 2560    | 7       | 2490    | 2390    |
+---------+---------+---------+---------+---------+---------+---------+
| 22      | 20      | 4       | 320     | 4       | 250     | 1       |
|         |         |         |         |         |         | 40(Note |
|         |         |         |         |         |         | 3)      |
+---------+---------+---------+---------+---------+---------+---------+
| 23      | 20      | 4       | 640     | 5       | 570     | 4       |
|         |         |         |         |         |         | 60(Note |
|         |         |         |         |         |         | 3)      |
+---------+---------+---------+---------+---------+---------+---------+
| 24      | 20      | 4       | 1280    | 6       | 1210    | 11      |
|         |         |         |         |         |         | 00(Note |
|         |         |         |         |         |         | 3)      |
+---------+---------+---------+---------+---------+---------+---------+
| 25      | 20      | 4       | 2560    | 7       | 2490    | 23      |
|         |         |         |         |         |         | 80(Note |
|         |         |         |         |         |         | 3)      |
+---------+---------+---------+---------+---------+---------+---------+
| Note 1: |         |         |         |         |         |         |
| E13..E0 |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| Table   |         |         |         |         |         |         |
| 8.      |         |         |         |         |         |         |
| 1.2.1.6 |         |         |         |         |         |         |
| .3.3-0D |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| Note 2: |         |         |         |         |         |         |
| **MUSIM |         |         |         |         |         |         |
| Gap     |         |         |         |         |         |         |
| offset  |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| d       |         |         |         |         |         |         |
| esigned |         |         |         |         |         |         |
| to make |         |         |         |         |         |         |
| sure    |         |         |         |         |         |         |
| that    |         |         |         |         |         |         |
| paging  |         |         |         |         |         |         |
| o       |         |         |         |         |         |         |
| ccasion |         |         |         |         |         |         |
| for NR  |         |         |         |         |         |         |
| Cell 12 |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| i       |         |         |         |         |         |         |
| ncluded |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| MUSIM   |         |         |         |         |         |         |
| Gap.    |         |         |         |         |         |         |
| MUSIM   |         |         |         |         |         |         |
| Gap     |         |         |         |         |         |         |
| offset  |         |         |         |         |         |         |
| = (((PF |         |         |         |         |         |         |
| of NR   |         |         |         |         |         |         |
| Cell 12 |         |         |         |         |         |         |
| -**     |         |         |         |         |         |         |
| SFN     |         |         |         |         |         |         |
| -offset |         |         |         |         |         |         |
| of NR   |         |         |         |         |         |         |
| Cell    |         |         |         |         |         |         |
| 12**)   |         |         |         |         |         |         |
| mod     |         |         |         |         |         |         |
| 10      |         |         |         |         |         |         |
| 24)\*10 |         |         |         |         |         |         |
| ) mod   |         |         |         |         |         |         |
| MGRP.   |         |         |         |         |         |         |
| Where** |         |         |         |         |         |         |
| SFN     |         |         |         |         |         |         |
| -offset |         |         |         |         |         |         |
| of NR   |         |         |         |         |         |         |
| Cell 12 |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| defined |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| 3       |         |         |         |         |         |         |
| 8.523-3 |         |         |         |         |         |         |
| Table   |         |         |         |         |         |         |
| 7.1     |         |         |         |         |         |         |
| .5.2-1, |         |         |         |         |         |         |
| PF: SFN |         |         |         |         |         |         |
| mod     |         |         |         |         |         |         |
| defa    |         |         |         |         |         |         |
| ultPagi |         |         |         |         |         |         |
| ngCycle |         |         |         |         |         |         |
| =       |         |         |         |         |         |         |
| 2\*     |         |         |         |         |         |         |
| (UE\_ID |         |         |         |         |         |         |
| mod     |         |         |         |         |         |         |
| (de     |         |         |         |         |         |         |
| faultPa |         |         |         |         |         |         |
| gingCyc |         |         |         |         |         |         |
| le/2)), |         |         |         |         |         |         |
| UE\_ID  |         |         |         |         |         |         |
| is 632  |         |         |         |         |         |         |
| based   |         |         |         |         |         |         |
| on      |         |         |         |         |         |         |
| 5G-TMS  |         |         |         |         |         |         |
| I='C234 |         |         |         |         |         |         |
| 5678'O. |         |         |         |         |         |         |
| defa    |         |         |         |         |         |         |
| ultPagi |         |         |         |         |         |         |
| ngCycle |         |         |         |         |         |         |
| of NR   |         |         |         |         |         |         |
| Cell 12 |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| 2560ms. |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| Note 3: |         |         |         |         |         |         |
| MUSIM   |         |         |         |         |         |         |
| Gap     |         |         |         |         |         |         |
| offset  |         |         |         |         |         |         |
| minus   |         |         |         |         |         |         |
| extra   |         |         |         |         |         |         |
| 10 ms   |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| order   |         |         |         |         |         |         |
| to      |         |         |         |         |         |         |
| avoid   |         |         |         |         |         |         |
| that    |         |         |         |         |         |         |
| paging  |         |         |         |         |         |         |
| o       |         |         |         |         |         |         |
| ccasion |         |         |         |         |         |         |
| for NR  |         |         |         |         |         |         |
| Cell 1  |         |         |         |         |         |         |
| is also |         |         |         |         |         |         |
| i       |         |         |         |         |         |         |
| ncluded |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| MUSIM   |         |         |         |         |         |         |
| Gap.    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.2.1.6.3.2-2: Main behaviour

+-----------+-----------+-----------+-----------+---------+-------+
| St        | Procedure | Message   | TP        | Verdict |       |
|           |           | Sequence  |           |         |       |
+===========+===========+===========+===========+=========+=======+
|           |           | U - S     | Message   |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 1-8       | The UE    | **-**     | **-**     | **-**   | **-** |
|           | performs  |           |           |         |       |
|           | the       |           |           |         |       |
|           | generic   |           |           |         |       |
|           | procedure |           |           |         |       |
|           | by        |           |           |         |       |
|           | executing |           |           |         |       |
|           | steps 1   |           |           |         |       |
|           | to 8 to   |           |           |         |       |
|           | enter the |           |           |         |       |
|           | NR        |           |           |         |       |
|           | RRC\_     |           |           |         |       |
|           | CONNECTED |           |           |         |       |
|           | state as  |           |           |         |       |
|           | described |           |           |         |       |
|           | in TS     |           |           |         |       |
|           | 38.508-1  |           |           |         |       |
|           | \[4\]     |           |           |         |       |
|           | table     |           |           |         |       |
|           | 4.5.4.2-3 |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1    |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 8A        | The SS    | \<\--     | NR RRC:   | \-      | \-    |
|           | transmits |           | *R        |         |       |
|           | an        |           | RCReconfi |         |       |
|           | RRCReconf |           | guration* |         |       |
|           | iguration |           |           |         |       |
|           | message   |           |           |         |       |
|           | to        |           |           |         |       |
|           | configure |           |           |         |       |
|           | mu        |           |           |         |       |
|           | sim-GapAs |           |           |         |       |
|           | sistanceC |           |           |         |       |
|           | onfig-r17 |           |           |         |       |
|           | IE and    |           |           |         |       |
|           | configure |           |           |         |       |
|           | musi      |           |           |         |       |
|           | m-LeaveAs |           |           |         |       |
|           | sistanceC |           |           |         |       |
|           | onfig-r17 |           |           |         |       |
|           | if UE     |           |           |         |       |
|           | supported |           |           |         |       |
|           | it.       |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 8B        | The UE    | \--\>     | NR RRC:   | \-      | \-    |
|           | transmits |           | *         |         |       |
|           | an        |           | RRCReconf |         |       |
|           | RRCRecon  |           | iguration |         |       |
|           | figuratio |           | Complete* |         |       |
|           | nComplete |           |           |         |       |
|           | message.  |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| \-        | E         | **-**     | **-**     | **-**   | **-** |
|           | XCEPTION: |           |           |         |       |
|           | Steps     |           |           |         |       |
|           | 8Ca1 and  |           |           |         |       |
|           | 8Ca2 are  |           |           |         |       |
|           | executed  |           |           |         |       |
|           | if UE     |           |           |         |       |
|           | supports  |           |           |         |       |
|           | test      |           |           |         |       |
|           | function  |           |           |         |       |
|           | specified |           |           |         |       |
|           | in TS     |           |           |         |       |
|           | 38.509    |           |           |         |       |
|           | \[9\]     |           |           |         |       |
|           | (pc       |           |           |         |       |
|           | \_Set\_MU |           |           |         |       |
|           | SIM\_UAI\ |           |           |         |       |
|           | _Info\_NR |           |           |         |       |
|           | specified |           |           |         |       |
|           | in TS     |           |           |         |       |
|           | 38.50     |           |           |         |       |
|           | 8-2\[5\]) |           |           |         |       |
|           | ELSE Step |           |           |         |       |
|           | 8Cb1 is   |           |           |         |       |
|           | executed  |           |           |         |       |
|           | (Note 1). |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 8Ca1      | The SS    | \<\--     | SET MUSIM | \-      | \-    |
|           | transmits |           | UAI       |         |       |
|           | a SET     |           | REQUEST   |         |       |
|           | MUSIM UAI |           |           |         |       |
|           | REQUEST   |           |           |         |       |
|           | message.  |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 8Ca2      | The UE    | \--\>     | SET MUSIM | \-      | \-    |
|           | transmits |           | UAI       |         |       |
|           | a SET     |           | RESPONSE  |         |       |
|           | MUSIM UAI |           |           |         |       |
|           | RESPONSE  |           |           |         |       |
|           | message.  |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 8Cb1      | Make the  | **-**     | **-**     | **-**   | **-** |
|           | UE send   |           |           |         |       |
|           | UE        |           |           |         |       |
|           | A         |           |           |         |       |
|           | ssistance |           |           |         |       |
|           | inf       |           |           |         |       |
|           | ormation. |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 8D        | The UE    | \--\>     | NR RRC:   | **-**   | **-** |
|           | transmit  |           | *UEAssi   |         |       |
|           | UEAss     |           | stanceInf |         |       |
|           | istanceIn |           | ormation* |         |       |
|           | formation |           |           |         |       |
|           | message   |           |           |         |       |
|           | to        |           |           |         |       |
|           | indicate  |           |           |         |       |
|           | m         |           |           |         |       |
|           | usim-GapL |           |           |         |       |
|           | ength-r17 |           |           |         |       |
|           | and       |           |           |         |       |
|           | musim     |           |           |         |       |
|           | -GapRepet |           |           |         |       |
|           | itionAndO |           |           |         |       |
|           | ffset-r17 |           |           |         |       |
|           | within    |           |           |         |       |
|           | MUSIM-Gap |           |           |         |       |
|           | Preferenc |           |           |         |       |
|           | eList-r17 |           |           |         |       |
|           | IE.       |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 9         | The SS    | \<\--     | NR RRC:   | \-      | \-    |
|           | transmits |           | RRCReconf |         |       |
|           | an        |           | iguration |         |       |
|           | RRCReconf |           |           |         |       |
|           | iguration |           |           |         |       |
|           | message   |           |           |         |       |
|           | to        |           |           |         |       |
|           | configure |           |           |         |       |
|           | m         |           |           |         |       |
|           | usim-GapL |           |           |         |       |
|           | ength-r17 |           |           |         |       |
|           | and       |           |           |         |       |
|           | musim     |           |           |         |       |
|           | -GapRepet |           |           |         |       |
|           | itionAndO |           |           |         |       |
|           | ffset-r17 |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1    |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10        | UE        | \--\>     | NR RRC:   | \-      | \-    |
|           | transmits |           | RRCRecon  |         |       |
|           | an        |           | figuratio |         |       |
|           | RRCRecon  |           | nComplete |         |       |
|           | figuratio |           |           |         |       |
|           | nComplete |           |           |         |       |
|           | message   |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1.   |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10A       | The SS    | \<\--     | NR RRC:   | \-      | \-    |
|           | transmits |           | *Paging*  |         |       |
|           | a         |           |           |         |       |
|           | *Paging*  |           |           |         |       |
|           | message   |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 12.  |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| \-        | E         | **-**     | **-**     | **-**   | **-** |
|           | XCEPTION: |           |           |         |       |
|           | Steps     |           |           |         |       |
|           | 10        |           |           |         |       |
|           | Ba1-10Bb3 |           |           |         |       |
|           | describe  |           |           |         |       |
|           | behaviour |           |           |         |       |
|           | that      |           |           |         |       |
|           | depends   |           |           |         |       |
|           | on UE     |           |           |         |       |
|           | ca        |           |           |         |       |
|           | pability. |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10Ba1     | UE        | \--\>     | NR RRC:   | **-**   | **-** |
|           | transmits |           | *UEAssi   |         |       |
|           | an        |           | stanceInf |         |       |
|           | UEAss     |           | ormation* |         |       |
|           | istanceIn |           |           |         |       |
|           | formation |           |           |         |       |
|           | message   |           |           |         |       |
|           | to        |           |           |         |       |
|           | indicate  |           |           |         |       |
|           | IE        |           |           |         |       |
|           | m         |           |           |         |       |
|           | usim-Pref |           |           |         |       |
|           | erredRRC- |           |           |         |       |
|           | State-r17 |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1    |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10Ba2     | The SS    | **-**     | **-**     | **-**   | **-** |
|           | locally   |           |           |         |       |
|           | releases  |           |           |         |       |
|           | the RRC   |           |           |         |       |
|           | c         |           |           |         |       |
|           | onnection |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1.   |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10Bb1     | The UE    | \--\>     | 5GMM:     | \-      | \-    |
|           | transmits |           | SERVICE   |         |       |
|           | a SERVICE |           | REQUEST   |         |       |
|           | REQUEST   |           |           |         |       |
|           | message   |           |           |         |       |
|           | to        |           |           |         |       |
|           | indicate  |           |           |         |       |
|           | NAS       |           |           |         |       |
|           | s         |           |           |         |       |
|           | ignalling |           |           |         |       |
|           | c         |           |           |         |       |
|           | onnection |           |           |         |       |
|           | release.  |           |           |         |       |
|           | This      |           |           |         |       |
|           | message   |           |           |         |       |
|           | is        |           |           |         |       |
|           | included  |           |           |         |       |
|           | in an     |           |           |         |       |
|           | ULI       |           |           |         |       |
|           | nformatio |           |           |         |       |
|           | nTransfer |           |           |         |       |
|           | message   |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1    |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10Bb2     | The SS    | \<\--     | 5GMM:     | \-      | \-    |
|           | transmits |           | SERVICE   |         |       |
|           | a SERVICE |           | ACCEPT    |         |       |
|           | ACCEPT    |           |           |         |       |
|           | message.  |           |           |         |       |
|           | This      |           |           |         |       |
|           | message   |           |           |         |       |
|           | is        |           |           |         |       |
|           | included  |           |           |         |       |
|           | in a      |           |           |         |       |
|           | DLI       |           |           |         |       |
|           | nformatio |           |           |         |       |
|           | nTransfer |           |           |         |       |
|           | message   |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1.   |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10Bb3     | The SS    | \<\--     | NR RRC:   | \-      | \-    |
|           | releases  |           | *RR       |         |       |
|           | the RRC   |           | CRelease* |         |       |
|           | c         |           |           |         |       |
|           | onnection |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1.   |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10C       | Check:    | **-**     | NR RRC:   | 5       | **P** |
|           | Does the  |           | *RRCSetu  |         |       |
|           | UE        |           | pRequest* |         |       |
|           | transmit  |           |           |         |       |
|           | an        |           |           |         |       |
|           | *RRCSetu  |           |           |         |       |
|           | pRequest* |           |           |         |       |
|           | message   |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 12   |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10D-10I   | Steps 3   | \-        | \-        | \-      | \-    |
|           | to 8 of   |           |           |         |       |
|           | the NR    |           |           |         |       |
|           | RRC\_     |           |           |         |       |
|           | CONNECTED |           |           |         |       |
|           | procedure |           |           |         |       |
|           | in TS     |           |           |         |       |
|           | 38.508-1  |           |           |         |       |
|           | \[4\]     |           |           |         |       |
|           | Table     |           |           |         |       |
|           | 4.5.4.2-3 |           |           |         |       |
|           | are       |           |           |         |       |
|           | executed  |           |           |         |       |
|           | to        |           |           |         |       |
|           | suc       |           |           |         |       |
|           | cessfully |           |           |         |       |
|           | complete  |           |           |         |       |
|           | the       |           |           |         |       |
|           | service   |           |           |         |       |
|           | request   |           |           |         |       |
|           | procedure |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 12.  |           |           |         |       |
|           | (Note 2)  |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10J       | The SS    | \<\--     | NR RRC:   | \-      | \-    |
|           | releases  |           | *RR       |         |       |
|           | the RRC   |           | CRelease* |         |       |
|           | c         |           |           |         |       |
|           | onnection |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 12.  |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10K-10S   | The UE    | **-**     | **-**     | **-**   | **-** |
|           | performs  |           |           |         |       |
|           | the       |           |           |         |       |
|           | generic   |           |           |         |       |
|           | procedure |           |           |         |       |
|           | by        |           |           |         |       |
|           | executing |           |           |         |       |
|           | steps 1   |           |           |         |       |
|           | to 8 to   |           |           |         |       |
|           | enter the |           |           |         |       |
|           | NR        |           |           |         |       |
|           | RRC\_     |           |           |         |       |
|           | CONNECTED |           |           |         |       |
|           | state as  |           |           |         |       |
|           | described |           |           |         |       |
|           | in TS     |           |           |         |       |
|           | 38.508-1  |           |           |         |       |
|           | \[4\]     |           |           |         |       |
|           | table     |           |           |         |       |
|           | 4.5.4.2-3 |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1    |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10T       | The SS    | \<\--     | NR RRC:   | \-      | \-    |
|           | transmits |           | *R        |         |       |
|           | an        |           | RCReconfi |         |       |
|           | RRCReconf |           | guration* |         |       |
|           | iguration |           |           |         |       |
|           | message   |           |           |         |       |
|           | to        |           |           |         |       |
|           | configure |           |           |         |       |
|           | m         |           |           |         |       |
|           | usim-GapL |           |           |         |       |
|           | ength-r17 |           |           |         |       |
|           | and       |           |           |         |       |
|           | musim     |           |           |         |       |
|           | -GapRepet |           |           |         |       |
|           | itionAndO |           |           |         |       |
|           | ffset-r17 |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1    |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 10U       | UE        | \--\>     | NR RRC:   | \-      | \-    |
|           | transmits |           | *         |         |       |
|           | an        |           | RRCReconf |         |       |
|           | RRCRecon  |           | iguration |         |       |
|           | figuratio |           | Complete* |         |       |
|           | nComplete |           |           |         |       |
|           | message   |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1.   |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 11-16     | Void      |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 17        | The SS    | \<\--     | NR RRC:   | \-      | \-    |
|           | transmits |           | RRCReconf |         |       |
|           | an        |           | iguration |         |       |
|           | RRCReconf |           |           |         |       |
|           | iguration |           |           |         |       |
|           | message   |           |           |         |       |
|           | to        |           |           |         |       |
|           | configure |           |           |         |       |
|           | musim-    |           |           |         |       |
|           | GapId-r17 |           |           |         |       |
|           | = '0'     |           |           |         |       |
|           | with      |           |           |         |       |
|           | musim-Ga  |           |           |         |       |
|           | pToReleas |           |           |         |       |
|           | eList-r17 |           |           |         |       |
|           | IE to UE  |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1 at |           |           |         |       |
|           | T1.       |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 18        | The UE    | \--\>     | NR RRC:   | \-      | \-    |
|           | transmits |           | RRCRecon  |         |       |
|           | an        |           | figuratio |         |       |
|           | RRCRecon  |           | nComplete |         |       |
|           | figuratio |           |           |         |       |
|           | nComplete |           |           |         |       |
|           | message   |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1.   |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 19        | The SS    | \<\--     | NR RRC:   | \-      | \-    |
|           | sends     |           | *UE       |         |       |
|           | *UE       |           | Capabilit |         |       |
|           | Capabilit |           | yEnquiry* |         |       |
|           | yEnquiry* |           |           |         |       |
|           | message   |           |           |         |       |
|           | to the UE |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1 at |           |           |         |       |
|           | T2.       |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| 20        | Check:    | \--\>     | NR RRC:   | 3       | P     |
|           | Does the  |           | *UECapa   |         |       |
|           | UE send a |           | bilityInf |         |       |
|           | *UECapa   |           | ormation* |         |       |
|           | bilityInf |           |           |         |       |
|           | ormation* |           |           |         |       |
|           | message   |           |           |         |       |
|           | on NR     |           |           |         |       |
|           | Cell 1?   |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+
| Note 1:   |           |           |           |         |       |
| The test  |           |           |           |         |       |
| function  |           |           |           |         |       |
| is        |           |           |           |         |       |
| optional, |           |           |           |         |       |
| it can be |           |           |           |         |       |
| replaced  |           |           |           |         |       |
| by        |           |           |           |         |       |
| al        |           |           |           |         |       |
| ternative |           |           |           |         |       |
| solutions |           |           |           |         |       |
| (e.g AT   |           |           |           |         |       |
| command   |           |           |           |         |       |
| or MMI)   |           |           |           |         |       |
| due to UE |           |           |           |         |       |
| imple     |           |           |           |         |       |
| mentation |           |           |           |         |       |
| specific  |           |           |           |         |       |
| behavior. |           |           |           |         |       |
|           |           |           |           |         |       |
| Note 2:   |           |           |           |         |       |
| UE        |           |           |           |         |       |
| responds  |           |           |           |         |       |
| to the    |           |           |           |         |       |
| Paging    |           |           |           |         |       |
| message   |           |           |           |         |       |
| tr        |           |           |           |         |       |
| ansmitted |           |           |           |         |       |
| on NR     |           |           |           |         |       |
| Cell 12   |           |           |           |         |       |
| at step   |           |           |           |         |       |
| 10A.      |           |           |           |         |       |
+-----------+-----------+-----------+-----------+---------+-------+

##### 8.1.2.1.6.3.3 Specific message contents {#specific-message-contents-24 .H6}

Table 8.1.2.1.6.3.3-0: *SIB1 for NR Cell 12* (preamble and all steps,
Table 8.1.2.1.6.3.2-2)

  --------------------------------------------------- ---------------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-28                                                         
  Information Element                                 Value/remark                 Comment                  Condition
  SIB1 ::= SEQUENCE {                                                                                       
  servingCellConfigCommon                             ServingCellConfigCommonSIB   Table 8.1.2.1.6.3.3-0A   
  }                                                                                                         
  --------------------------------------------------- ---------------------------- ------------------------ -----------

Table 8.1.2.1.6.3.3-0A: *ServingCellConfigCommonSIB (*Table
8.1.2.1.6.3.3-0*)*

  ---------------------------------------------------- ------------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-169                                                      
  Information Element                                  Value/remark              Comment                  Condition
  ServingCellConfigCommonSIB ::= SEQUENCE {                                                               
  downlinkConfigCommon                                 DownlinkConfigCommonSIB   Table 8.1.2.1.6.3.3-0B   
  }                                                                                                       
  ---------------------------------------------------- ------------------------- ------------------------ -----------

Table 8.1.2.1.6.3.3-0B: *DownlinkConfigCommonSIB (*Table
8.1.2.1.6.3.3-0*)*

  --------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-53                            
  Information Element                                 Value/remark   Comment   Condition
  DownlinkConfigCommonSIB ::= SEQUENCE {                                       
  pcch-Config SEQUENCE {                                                       
  defaultPagingCycle                                  rf256                    
  nAndPagingFrameOffset CHOICE {                                               
  halfT                                               0                        
  }                                                                            
  ns                                                  one                      
  firstPDCCH-MonitoringOccasionOfPO                   Not present              
  nrofPDCCH-MonitoringOccasionPerSSB-InPO-r16         Not present              
  }                                                                            
  }                                                                            
  --------------------------------------------------- -------------- --------- -----------

Table 8.1.2.1.6.3.3-0C: *RRCReconfiguration* (step 8A, Table
8.1.2.1.6.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                            
  --------------------------------------------------- -------------- --------- ------------------------------
  Information Element                                 Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                  
  rrcReconfiguration SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  otherConfig-v1700 SEQUENCE {                                                 
  musim-GapAssistanceConfig-r17 CHOICE {                                       
  setup SEQUENCE {                                                             
  musim-GapProhibitTimer-r17                          s10                      
  }                                                                            
  musim-LeaveAssistanceConfig-r17 CHOICE {                                     pc\_musimLeaveConnected\_r17
  setup SEQUENCE {                                                             
  musim-LeaveWithoutResponseTimer-r17                 ms100                    
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.2.1.6.3.3-0D: SET MUSIM UAI REQUEST (step 8Ca1, Table
8.1.2.1.6.3.2-2)

  ----------------------------------------------------------- ---------------------------------------------------------------------------- ---------- -----------
  Derivation Path: 38.509 clause 6.13.1                                                                                                               
  Information Element                                         Value/remark                                                                 Comment    Condition
  Protocol discriminator                                      1 1 1 1'B                                                                               
  Skip indicator                                              0 0 0 0'B                                                                               
  Message type                                                1 0 1 1 0 0 1 0'B                                                                       
  musim-PreferredRRC-State                                    0 0 0 0 0 0 1 1'B                                                            Reserved   
  musim-GapPreferenceList                                                                                                                             
  musim-GapPreferenceList Value type                          0 0 0 0 0 0 0 1'B                                                                       
  Length of musim-GapPreferenceList Value contents in bytes   0 0 0 0 0 1 0 1'B                                                            5 bytes    
  musim-GapPreferenceList IE \#0                                                                                                                      
  C2..C0                                                      Set according to MUSIM Gap Length in the Table 8.1.2.1.6.3.2-1A                         
  D3..D0                                                      Set according to MUSIM Gap Repetition Period in the Table 8.1.2.1.6.3.2-1A              
  E13..E0                                                     Set according to MUSIM Gap offset in the Table 8.1.2.1.6.3.2-1A                         
  ----------------------------------------------------------- ---------------------------------------------------------------------------- ---------- -----------

Table 8.1.2.1.6.3.3-0E: *UEAssistanceInformation* (Step 8D, Table
8.1.2.1.6.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                                                        
  -------------------------------------------------------------------------- ------------------- --------- -----------
  Information Element                                                        Value/remark        Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                                   
  criticalExtensions CHOICE {                                                                              
  ueAssistanceInformation SEQUENCE {                                                                       
  nonCriticalExtension SEQUENCE {                                                                          
  nonCriticalExtension SEQUENCE {                                                                          
  nonCriticalExtension SEQUENCE {                                                                          
  musim-Assistance-r17 SEQUENCE {                                                                          
  musim-PreferredRRC-State-r17                                               Not present                   
  musim-GapPreferenceList-r17 SEQUENCE (SIZE (1..4)) OF MUSIM-GapInfo-r17{                                 
  MUSIM-GapInfo-r17 \[1\] SEQUENCE {                                         entry 1                       
  musim-Starting-SFN-AndSubframe-r17                                         Not present                   
  musim-GapLength-r17                                                        Any allowed value             
  musim-GapRepetitionAndOffset-r17                                           Any allowed value             
  }                                                                                                        
  }                                                                                                        
  }                                                                                                        
  }                                                                                                        
  }                                                                                                        
  }                                                                                                        
  }                                                                                                        
  }                                                                                                        
  }                                                                                                        

Table 8.1.2.1.6.3.3-1: *RRCReconfiguration* (step 9, step 10T, step 17,
Table 8.1.2.1.6.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                                       
  --------------------------------------------------- ------------------------- --------- ------------------
  Information Element                                 Value/remark              Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                       
  criticalExtensions CHOICE {                                                             
  rrcReconfiguration SEQUENCE {                                                           
  nonCriticalExtension SEQUENCE {                                                         
  nonCriticalExtension SEQUENCE {                                                         
  nonCriticalExtension SEQUENCE {                                                         
  nonCriticalExtension SEQUENCE {                                                         
  nonCriticalExtension SEQUENCE {                                                         
  musim-GapConfig-r17 CHOICE {                                                            
  setup                                               MUSIM-GapConfig-r17                 step 9, step 10T
                                                      MUSIM-GapConfig-Rel-r17             step 17
  }                                                                                       
  }                                                                                       
  }                                                                                       
  }                                                                                       
  }                                                                                       
  }                                                                                       
  }                                                                                       
  }                                                                                       
  }                                                                                       

Table 8.1.2.1.6.3.3-2:MUSIM-GapConfig-r17(Table 8.1.2.1.6.3.3-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-82BA                                                                                                                             
  -------------------------------------------------------------------- ------------------------------------------------------------------------------------------------- --------- -----------
  Information Element                                                  Value/remark                                                                                      Comment   Condition
  MUSIM-GapConfig-r17 ::= SEQUENCE {                                                                                                                                               
  musim-GapToReleaseList-r17                                           Not Present                                                                                                 
  musim-GapToAddModList-r17 SEQUENCE (SIZE (1..3)) OF MUSIM-Gap-r17{                                                                                                               
  MUSIM-Gap-r17\[1\] SEQUENCE {                                                                                                                                                    
  musim-GapId-r17                                                      0                                                                                                           
  musim-GapInfo-r17 SEQUENCE {                                                                                                                                                     
  musim-Starting-SFN-AndSubframe-r17                                   Not Present                                                                                                 
  musim-GapLength-r17                                                  Same as MUSIM-GapInfo-r17 \[1\].musim-GapLength-r1 in the Table 8.1.2.1.6.3.3-0E                            
  musim-GapRepetitionAndOffset-r17                                     Same as MUSIM-GapInfo-r17 \[1\]. musim-GapRepetitionAndOffset-r17 in the Table 8.1.2.1.6.3.3-0E             
  }                                                                                                                                                                                
  }                                                                                                                                                                                
  }                                                                                                                                                                                
  musim-AperiodicGap-r17                                               Not Present                                                                                                 
  }                                                                                                                                                                                

Table 8.1.2.1.6.3.3-3: MUSIM-GapConfig-Rel-r17(Table 8.1.2.1.6.3.3-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-82BA                                              
  ------------------------------------------------------------------------ -------------- --------- -----------
  Information Element                                                      Value/remark   Comment   Condition
  MUSIM-GapConfig-r17 ::= SEQUENCE {                                                                
  musim-GapToReleaseList-r17 SEQUENCE (SIZE (1..3)) OF MUSIM-GapId-r17 {                            
  MUSIM-GapId-r17\[1\]                                                     0                        
  }                                                                                                 
  musim-GapToAddModList-r17                                                Not Present              
  musim-AperiodicGap-r17                                                   Not Present              
  }                                                                                                 

Table 8.1.2.1.6.3.3-4: Void

Table 8.1.2.1.6.3.3-5: *UEAssistanceInformation* (Step 10Ba1, Table
8.1.2.1.6.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                  
  ueAssistanceInformation SEQUENCE {                                           
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  musim-Assistance-r17 SEQUENCE {                                              
  musim-PreferredRRC-State-r17                        idle                     
  musim-GapPreferenceList-r17                         Not Present              
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.2.1.6.3.3-6: *SERVICE REQUEST* (Step 10Bb1, Table
8.1.2.1.6.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.7.1-16                                                      
  --------------------------------------------------- -------------- ----------------------------------- -----------
  Information Element                                 Value/remark   Comment                             Condition
  UE request type                                                                                        
  Request type                                        '0001'B        NAS signalling connection release   

### 8.1.3 Measurement configuration control and reporting

#### 8.1.3.1 Intra NR measurements

##### 8.1.3.1.1 Measurement configuration control and reporting / Intra NR measurements / Event A1 / Event A2

##### 8.1.3.1.1.1 Test Purpose (TP) {#test-purpose-tp-33 .H6}

##### (1) {#section-61 .H6}

**with** { UE in NR RRC\_CONNECTED and measurement configured for event
A1 and event A2 with event based periodical reporting }

**ensure that** {

**when** { Serving cell becomes better than absolute threshold plus
hysteresis and entering condition for event A1 is met }

**then** { UE sends MeasurementReport message at regular intervals while
entering condition for event A1 is satisfied }

}

##### (2) {#section-62 .H6}

**with** { UE in NR RRC\_CONNECTED and periodical measurement reporting
triggered by event A1 ongoing }

**ensure that** {

**when** { Serving cell becomes worse than absolute threshold minus
hysteresis }

**then** { UE stops sending MeasurementReport message }

}

##### (3) {#section-63 .H6}

**with** { UE in NR RRC\_CONNECTED and measurement configured for event
A1 and event A2 with event based periodical reporting }

**ensure that** {

**when** { Serving cell becomes worse than absolute threshold minus
hysteresis and entering condition for event A2 is met }

**then** { UE sends MeasurementReport message at regular intervals while
entering condition for event A2 is satisfied }

}

##### (4) {#section-64 .H6}

**with** { UE in NR RRC\_CONNECTED state and periodical measurement
reporting triggered by event A2 ongoing }

**ensure that** {

**when** { Serving cell becomes better than absolute threshold plus
hysteresis }

**then** { UE stops sending *MeasurementReport* message }

}

##### (5) {#section-65 .H6}

**with** { UE in NR RRC\_CONNECTED and measurements are re-configured
for event A1 with event based periodical reporting to report on leaving
condition }

**ensure that** {

**when** { Serving cell becomes worse than absolute threshold minus
hysteresis }

**then** { UE sends MeasurementReport message while leaving condition
for event A1 is satisfied }

}

##### 8.1.3.1.1.2 Conformance requirements {#conformance-requirements-33 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.5.3, 5.5.2, 5.5.4.1, 5.5.4.2,
5.5.4.3 and 5.5.5. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(MCG is E-UTRA):

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

> ...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

1\> if the received *measConfig* includes the *quantityConfig*:

2\> perform the quantity configuration procedure as specified in
5.5.2.8;

1\> if the received *measConfig* includes the *measIdToRemoveList*:

2\> perform the measurement identity removal procedure as specified in
5.5.2.2;

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

\[TS 38.331, clause 5.5.4.1\]

If security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

5\> consider only the serving cell to be applicable;

> ...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

...

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *TRUE* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

> ...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

> ...

\[TS 38.331, clause 5.5.4.2\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A1-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A1-2, as specified below, is fulfilled;

1\> for this measurement, consider the NR serving cell corresponding to
the associated *measObjectNR* associated with this event.

Inequality A1-1 (Entering condition)

*Ms -- Hys \> Thresh*

Inequality A1-2 (Leaving condition)

*Ms + Hys \< Thresh*

The variables in the formula are defined as follows:

***Ms*** is the measurement result of the serving cell, not taking into
account any offsets.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Thresh*** is the threshold parameter for this event (i.e.
*a1-Threshold* as defined within *reportConfigNR* for this event).

***Ms*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and RS-SINR.

***Hys*** is expressed in dB.

***Thresh*** is expressed in the same unit as ***Ms***.

\[TS 38.331, clause 5.5.4.3\]

The UE shall:

> 1\> consider the entering condition for this event to be satisfied
> when condition A2-1, as specified below, is fulfilled;
>
> 1\> consider the leaving condition for this event to be satisfied when
> condition A2-2, as specified below, is fulfilled;
>
> 1\> for this measurement, consider the serving cell indicated by the
> *measObjectNR* associated to this event.

Inequality A2-1 (Entering condition)

*Ms + Hys \< Thresh*

Inequality A2-2 (Leaving condition)

*Ms -- Hys \> Thresh*

The variables in the formula are defined as follows:

> ***Ms*** is the measurement result of the serving cell, not taking
> into account any offsets.
>
> ***Hys*** is the hysteresis parameter for this event (i.e.
> *hysteresis* as defined within *reportConfigNR* for this event).
>
> ***Thresh*** is the threshold parameter for this event (i.e.
> *a2-Threshold* as defined within *reportConfigNR* for this event).
>
> ***Ms*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
> and RS-SINR.
>
> ***Hys*** is expressed in dB.

***Thresh*** is expressed in the same unit as ***Ms***.

\[TS 38.331, clause 5.5.5\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include , for each NR serving cell that is configured with
*servingCellMO*, RSRP, RSRQ and the available SINR derived based on the
*rsType* if indicated in the associated *reportConfig ,* otherwise based
on SSB if available, otherwise based on CSI-RS;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include for each NR serving cell that is configured with
*servingCellMO*, if any, the *servCellId*;

> ...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

1\> else:

2\> if the *reportType* is set to *periodical*:

3\> remove the entry within the *VarMeasReportList* for this *measId*;

3\> remove this *measId* from the *measIdList* within *VarMeasConfig*;

1\> if the UE is configured with EN-DC:

> ...

1\> else:

> 2\> submit the *MeasurementReport* message to lower layers for
> transmission, upon which the procedure ends.

##### 8.1.3.1.1.3 Test description {#test-description-33 .H6}

##### 8.1.3.1.1.3.1 Pre-test conditions {#pre-test-conditions-33 .H6}

##### System Simulator: {#system-simulator-30 .H6}

\- NR Cell 1

##### UE: {#ue-27 .H6}

\- None.

##### Preamble: {#preamble-29 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.3.1.1.3.2 Test procedure sequence {#test-procedure-sequence-34 .H6}

Table 8.1.3.1.1.3.2-1/2 illustrates the downlink power levels and other
changing parameters to be applied for the cells at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions
after preamble, while columns marked \"T1\" and \"T2\", are to be
applied subsequently. The exact instants on which these values shall be
applied are described in the texts in this clause.

Table 8.1.3.1.1.3.2-1: Time instances of cell power level and parameter
changes in FR1

+----+-----------+---------+-----------+------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                       |
+====+===========+=========+===========+==============================+
| T0 | SS/PBCH   | dBm/SCS | -98       | Power level is such that     |
|    |           |         |           | entry condition for event A2 |
|    | SSS EPRE  |         |           | is satisfied *Ms + Hys \<    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -78       | Power level is such that     |
|    |           |         |           | entry condition for event A1 |
|    | SSS EPRE  |         |           | is satisfied *Ms -- Hys \>   |
|    |           |         |           | Thresh* and exit condition   |
|    |           |         |           | for event A2 is satisfied    |
|    |           |         |           | too.                         |
+----+-----------+---------+-----------+------------------------------+
| T2 | SS/PBCH   | dBm/SCS | -98       | Power level is such that     |
|    |           |         |           | exit condition for event A1  |
|    | SSS EPRE  |         |           | is satisfied *Ms + Hys \<    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+

Table 8.1.3.1.1.3.2-2: Time instances of cell power level and parameter
changes in FR2

+----+-----------+---------+-----------+------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                       |
+====+===========+=========+===========+==============================+
| T0 | SS/PBCH   | dBm/SCS | -100      | Power level is such that     |
|    |           |         |           | entry condition for event A2 |
|    | SSS EPRE  |         |           | is satisfied *Ms + Hys \<    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -82       | Power level is such that     |
|    |           |         |           | entry condition for event A1 |
|    | SSS EPRE  |         |           | is satisfied *Ms -- Hys \>   |
|    |           |         |           | Thresh* and exit condition   |
|    |           |         |           | for event A2 is satisfied    |
|    |           |         |           | too.                         |
+----+-----------+---------+-----------+------------------------------+
| T2 | SS/PBCH   | dBm/SCS | -100      | Power level is such that     |
|    |           |         |           | exit condition for event A1  |
|    | SSS EPRE  |         |           | is satisfied *Ms + Hys \<    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+

Table 8.1.3.1.1.3.2-3: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | SS transmits | \<\--        | *NR RRC:     | \-      | \- |
|    | an           |              | RRCReco      |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    | including    |              |              |         |    |
|    | *measConfig* |              |              |         |    |
|    | to setup     |              |              |         |    |
|    | intra NR     |              |              |         |    |
|    | measurement  |              |              |         |    |
|    | and          |              |              |         |    |
|    | reporting    |              |              |         |    |
|    | for event A1 |              |              |         |    |
|    | and event    |              |              |         |    |
|    | A2.          |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRC          |         |    |
|    | *RR          |              | Reconfigurat |         |    |
|    | CReconfigrat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | Check: Does  | \--\>        | *NR RRC:     | 3       | P  |
|    | the UE       |              | Measur       |         |    |
|    | transmit a   |              | ementReport* |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message to   |              |              |         |    |
|    | report event |              |              |         |    |
|    | A2 with the  |              |              |         |    |
|    | measured     |              |              |         |    |
|    | RSRP, RSRQ   |              |              |         |    |
|    | and SINR     |              |              |         |    |
|    | value for NR |              |              |         |    |
|    | Cell 1?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| \- | EXCEPTION:   | \-           | \-           | \-      | \- |
|    | Step 4 below |              |              |         |    |
|    | is repeated  |              |              |         |    |
|    | until 3      |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | messages are |              |              |         |    |
|    | received     |              |              |         |    |
|    | from the UE  |              |              |         |    |
|    | and Interval |              |              |         |    |
|    | between two  |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | is same as   |              |              |         |    |
|    | the IE       |              |              |         |    |
|    | *rep         |              |              |         |    |
|    | ortInterval* |              |              |         |    |
|    | configured   |              |              |         |    |
|    | in           |              |              |         |    |
|    | *            |              |              |         |    |
|    | measConfig.* |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | Check: Does  | \--\>        | *NR RRC:     | 3       | P  |
|    | the UE       |              | Measur       |         |    |
|    | transmit a   |              | ementReport* |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message at   |              |              |         |    |
|    | regular      |              |              |         |    |
|    | intervals,   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | measured     |              |              |         |    |
|    | RSRP, RSRQ   |              |              |         |    |
|    | and SINR     |              |              |         |    |
|    | value for NR |              |              |         |    |
|    | Cell 1?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | SS           | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the SS/PBCH  |              |              |         |    |
|    | EPRE level   |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T1\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.3.       |              |              |         |    |
|    | 1.1.3.2-1/2. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | Wait and     | \-           | \-           | \-      | \- |
|    | ignore       |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | messages for |              |              |         |    |
|    | 15 s to      |              |              |         |    |
|    | allow change |              |              |         |    |
|    | of power     |              |              |         |    |
|    | levels for   |              |              |         |    |
|    | NR Cell 1    |              |              |         |    |
|    | and UE       |              |              |         |    |
|    | measurement. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| \- | EXCEPTION:   | \-           | \-           | \-      | \- |
|    | In parallel  |              |              |         |    |
|    | with step 7, |              |              |         |    |
|    | parallel     |              |              |         |    |
|    | behaviour    |              |              |         |    |
|    | defined in   |              |              |         |    |
|    | table        |              |              |         |    |
|    | 8.1          |              |              |         |    |
|    | .3.1.1.3.2-4 |              |              |         |    |
|    | is executed  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | Check: Does  | \--\>        | *NR RRC:     | 1       | P  |
|    | the UE       |              | Measur       |         |    |
|    | transmit a   |              | ementReport* |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message to   |              |              |         |    |
|    | report event |              |              |         |    |
|    | A1 with the  |              |              |         |    |
|    | measured     |              |              |         |    |
|    | RSRP, RSRQ   |              |              |         |    |
|    | and SINR     |              |              |         |    |
|    | value for NR |              |              |         |    |
|    | Cell 1?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| \- | EXCEPTION:   | \-           | \-           | \-      | \- |
|    | Step 8 below |              |              |         |    |
|    | is repeated  |              |              |         |    |
|    | until 3      |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | messages are |              |              |         |    |
|    | received     |              |              |         |    |
|    | from the UE  |              |              |         |    |
|    | and Interval |              |              |         |    |
|    | between two  |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | is same as   |              |              |         |    |
|    | the IE       |              |              |         |    |
|    | *rep         |              |              |         |    |
|    | ortInterval* |              |              |         |    |
|    | configured   |              |              |         |    |
|    | in           |              |              |         |    |
|    | *            |              |              |         |    |
|    | measConfig.* |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8  | Check: Does  | \--\>        | *NR RRC:     | 1       | P  |
|    | the UE       |              | Measur       |         |    |
|    | transmit a   |              | ementReport* |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message at   |              |              |         |    |
|    | regular      |              |              |         |    |
|    | intervals,   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | measured     |              |              |         |    |
|    | RSRP, RSRQ   |              |              |         |    |
|    | and SINR     |              |              |         |    |
|    | value for NR |              |              |         |    |
|    | Cell 1?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | SS           | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the SS/PBCH  |              |              |         |    |
|    | EPRE level   |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T2\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.3.       |              |              |         |    |
|    | 1.1.3.2-1/2. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 10 | Wait and     | \-           | \-           | \-      | \- |
|    | ignore       |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | messages for |              |              |         |    |
|    | 15 s to      |              |              |         |    |
|    | allow change |              |              |         |    |
|    | of power     |              |              |         |    |
|    | levels for   |              |              |         |    |
|    | NR Cell 1    |              |              |         |    |
|    | and UE       |              |              |         |    |
|    | measurement. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 11 | Check: Does  | \-           | \-           | 2       | F  |
|    | the UE       |              |              |         |    |
|    | transmit a   |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message to   |              |              |         |    |
|    | report event |              |              |         |    |
|    | A1 with the  |              |              |         |    |
|    | measured     |              |              |         |    |
|    | RSRP, RSRQ   |              |              |         |    |
|    | and SINR     |              |              |         |    |
|    | value for NR |              |              |         |    |
|    | Cell 1       |              |              |         |    |
|    | within the   |              |              |         |    |
|    | next 10s?    |              |              |         |    |
|    |              |              |              |         |    |
|    | NOTE: SS     |              |              |         |    |
|    | ignore       |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message for  |              |              |         |    |
|    | event A2.    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 12 | SS transmits | \<\--        | *NR RRC:     | \-      | \- |
|    | an           |              | RRCReco      |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message to   |              |              |         |    |
|    | re-configure |              |              |         |    |
|    | for event A1 |              |              |         |    |
|    | with event   |              |              |         |    |
|    | based        |              |              |         |    |
|    | periodical   |              |              |         |    |
|    | reporting to |              |              |         |    |
|    | report on    |              |              |         |    |
|    | leaving      |              |              |         |    |
|    | condition    |              |              |         |    |
|    | and release  |              |              |         |    |
|    | event A2.    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 13 | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRC          |         |    |
|    | *RR          |              | Reconfigurat |         |    |
|    | CReconfigrat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 14 | SS           | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the SS/PBCH  |              |              |         |    |
|    | EPRE level   |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T1\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.3.       |              |              |         |    |
|    | 1.1.3.2-1/2. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 15 | SS receive   | \-           | \-           | \-      | \- |
|    | four         |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | messages for |              |              |         |    |
|    | A1 and then  |              |              |         |    |
|    | wait 5s.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 16 | SS           | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the SS/PBCH  |              |              |         |    |
|    | EPRE level   |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T2\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.3.       |              |              |         |    |
|    | 1.1.3.2-1/2. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 17 | Check: Does  | \--\>        | *NR RRC:     | 5       | P  |
|    | the UE       |              | Measur       |         |    |
|    | transmit a   |              | ementReport* |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message to   |              |              |         |    |
|    | report event |              |              |         |    |
|    | A1 with the  |              |              |         |    |
|    | measured     |              |              |         |    |
|    | RSRP, RSRQ   |              |              |         |    |
|    | and SINR     |              |              |         |    |
|    | value for NR |              |              |         |    |
|    | Cell 1?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 18 | Check: Does  | \-           | \-           | 5       | F  |
|    | the UE       |              |              |         |    |
|    | attempt to   |              |              |         |    |
|    | transmit     |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message      |              |              |         |    |
|    | within the   |              |              |         |    |
|    | next 10s?    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

Table 8.1.3.1.1.3.2-4: Parallel behaviour

  St   Procedure                                                                                                                                 Message Sequence   TP        Verdict   
  ---- ----------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------- --------- ---
                                                                                                                                                 U - S              Message             
  1    Check: Does the UE transmit a *MeasurementReport* message to report event A2 with the measured RSRP, RSRQ and SINR value for NR Cell 1?   \-                 \-        4         F

##### 8.1.3.1.1.3.3 Specific message contents {#specific-message-contents-25 .H6}

Table 8.1.3.1.1.3.3-1: ***RRCReconfiguration*** (step 1 Table
8.1.3.1.1.3.2-3)

  ----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS
  ----------------------------------------------------------------------------

Table 8.1.3.1.1.3.3-2: MeasConfig (Table 8.1.3.1.1.3.3-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| Table 4.6.3-69  |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/Remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measConfig ::=  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObj         | 1 entry         |                 |           |
| ectToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| ma              |                 |                 |           |
| xNrofObjectId)) |                 |                 |           |
| OF              |                 |                 |           |
| Mea             |                 |                 |           |
| sObjectToAddMod |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| MeasObje        |                 | entry 1         |           |
| ctToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectId    | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObject      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectNR    | M               | T               |           |
|                 | easObjectNR(57) | hres=57(-100dBm |           |
|                 |                 |                 |           |
|                 |                 | ≤               |           |
|                 |                 | S               |           |
|                 |                 | S-RSRP\<-99dBm) |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportCon       | 2 entries       |                 |           |
| figToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..maxR        |                 |                 |           |
| eportConfigId)) |                 |                 |           |
| OF              |                 |                 |           |
| Repor           |                 |                 |           |
| tConfigToAddMod |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConf      |                 | entry 1         |           |
| igToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfig    | ReportC         |                 |           |
|                 | onfigNR-EventA1 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConf      |                 | entry 2         |           |
| igToAddMod\[2\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | 2               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfig    | ReportC         |                 |           |
|                 | onfigNR-EventA2 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| mea             | 2 entries       |                 |           |
| sIdToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofMeasId)) |                 |                 |           |
| OF              |                 |                 |           |
| MeasIdToAddMod  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Meas            |                 | entry 1         |           |
| IdToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measId          | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectId    | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Meas            |                 | entry 2         |           |
| IdToAddMod\[2\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measId          | 2               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectId    | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | 2               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| quantityConfig  | QuantityConfig  |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.3.1.1.3.3-3: MeasObjectNR (Table 8.1.3.1.1.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                               
  ---------------------------------------------------- --------------------------------- --------- -----------
  Information Element                                  Value/remark                      Comment   Condition
  MeasObjectNR ::= SEQUENCE {                                                                      
  ssbFrequency                                         Downlink ARFCN of NR cell 1 SSB             
  }                                                                                                

Table 8.1.3.1.1.3.3-4: ReportConfigNR-EventA1 (Table 8.1.3.1.1.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-142 with condition EVENT\_A1                                                 
  ------------------------------------------------------------------------------ ------------------- ------------------------- -----------
  Information Element                                                            Value/remark        Comment                   Condition
  ReportConfigNR::= SEQUENCE {                                                                                                 
  reportType CHOICE {                                                                                                          
  eventTriggered SEQUENCE {                                                                                                    
  eventId CHOICE {                                                                                                             
  eventA1 SEQUENCE {                                                                                                           EVENT\_A1
  a1-Threshold CHOICE {                                                                                                        
  rsrp                                                                           69                  Threshold set to -88dBM   FR1
  rsrp                                                                           66 + Delta(NRfs))   Threshold set to -91dBM   FR2
  }                                                                                                                            
  }                                                                                                                            
  }                                                                                                                            
  reportAmount                                                                   Infinity                                      
  }                                                                                                                            
  }                                                                                                                            
  }                                                                                                                            

Table 8.1.3.1.1.3.3-5: ReportConfigNR-EventA2 (Table 8.1.3.1.1.3.3-2)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.3-142 |                 |                 |           |
| with condition  |                 |                 |           |
| EVENT\_A2       |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Re              |                 |                 |           |
| portConfigNR::= |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportType      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventTriggered  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventId CHOICE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventA2         |                 |                 | EVENT\_A2 |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| a2-Threshold    |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | 69              | -88dBm          | FR1       |
|                 |                 |                 |           |
|                 |                 | ≤               |           |
|                 |                 | SS-RSRP\<-87dBm |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | 66 +            | Threshold set   | FR2       |
|                 | Delta(NRfs))    | to -91dBM       |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportAmount    | Infinity        |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.3.1.1.3.3-6: QuantityConfig (Table 8.1.3.1.1.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-127                                                               
  ---------------------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                                      Value/remark   Comment   Condition
  QuantityConfig ::= SEQUENCE {                                                                                     
  quantityConfigNR-List SEQUENCE (SIZE (1..maxNrofQuantityConfig)) OF QuantityConfigNR {   1 entry                  
  QuantityConfigNR\[1\] SEQUENCE {                                                                        entry 1   
  quantityConfigCell SEQUENCE {                                                                                     
  ssb-FilterConfig SEQUENCE {                                                                                       
  filterCoefficientRSRP                                                                    fc4                      
  filterCoefficientRSRQ                                                                    fc4                      
  filterCoefficientRS-SINR                                                                 fc4                      
  }                                                                                                                 
  }                                                                                                                 
  }                                                                                                                 
  }                                                                                                                 
  }                                                                                                                 

Table 8.1.3.1.1.3.3-7: MeasurementReport (steps 3, 4, 7, 8, 17, Table
8.1.3.1.1.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-5A                                                
  ---------------------------------------------------- ---------------------------------- --------- --------------------
  Information Element                                  Value/remark                       Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                  
  criticalExtensions CHOICE {                                                                       
  measurementReport SEQUENCE {                                                                      
  measResults SEQUENCE {                                                                            
  measId                                               2                                            Step 3, 4
  measId                                               1                                            Step 7,8,17
  measResultServingMOList SEQUENCE {                   1 entry                                      
  servCellId                                           ServCellIndex of NR Cell 1                   
  measResultServingCell SEQUENCE {                                                                  
  physCellId                                           Physical CellID of the NR Cell 1             
  measResult SEQUENCE {                                                                             
  cellResults SEQUENCE {                                                                            
  resultsSSB-Cell SEQUENCE {                                                                        
  rsrp                                                 (0..127)                                     
  rsrq                                                 (0..127)                                     
  sinr                                                 Not present                                  
                                                       (0..127)                                     pc\_ss\_SINR\_Meas
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 

Table 8.1.3.1.1.3.3-8: ***RRCReconfiguration*** (step 12, Table
8.1.3.1.1.3.2-3)

  ----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS
  ----------------------------------------------------------------------------

Table 8.1.3.1.1.3.3-9: MeasConfig (Table 8.1.3.1.1.3.3-8)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| Table 4.6.3-69  |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/Remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measConfig ::=  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObj         | Not Present     |                 |           |
| ectToAddModList |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportCon       | 1 entry         |                 |           |
| figToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..maxR        |                 |                 |           |
| eportConfigId)) |                 |                 |           |
| OF              |                 |                 |           |
| Repor           |                 |                 |           |
| tConfigToAddMod |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConf      |                 | entry 1         |           |
| igToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | ReportConfigId  |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfig    | ReportC         |                 |           |
|                 | onfigNR-EventA1 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| mea             | Not Present     |                 |           |
| sIdToAddModList |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| mea             | 1 entry         |                 |           |
| sIdToRemoveList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofMeasId)) |                 |                 |           |
| OF MeasId {     |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| MeasId\[1\]     | 2               | ebtry 1         |           |
|                 |                 |                 |           |
|                 |                 | Release event   |           |
|                 |                 | A2              |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| quantityConfig  | Not Present     |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.3.1.1.3.3-10: ReportConfigNR-EventA1 (Table 8.1.3.1.1.3.3-9)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.3-142 |                 |                 |           |
| with condition  |                 |                 |           |
| EVENT\_A1       |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Re              |                 |                 |           |
| portConfigNR::= |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportType      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventTriggered  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventId CHOICE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventA1         |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| a1-Threshold    |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | 69              | -88dBm          | FR1       |
|                 |                 |                 |           |
|                 |                 | ≤               |           |
|                 |                 | SS-RSRP\<-87dBm |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | 66 +            | Threshold set   | FR2       |
|                 | Delta(NRfs))    | to -91dBM       |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportOnLeave   | true            |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportAmount    | r4              |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

##### 8.1.3.1.2 Measurement configuration control and reporting / Event A3 / Measurement of Neighbour NR cell / Intra-frequency measurements

##### 8.1.3.1.2.1 Test Purpose (TP) {#test-purpose-tp-34 .H6}

##### (1) {#section-66 .H6}

**with** { UE in NR RRC\_CONNECTED state and intra-frequency
measurements configured for event A3 }

**ensure** that {

**when** { Entry condition for event A3 is not met for neighbor cell }

**then** { UE does not send *MeasurementReport* }

}

##### (2) {#section-67 .H6}

**with** { UE in NR RRC\_CONNECTED state and intra-frequency
measurements configured for event A3 }

**ensure** that {

**when** { Neighbor cell becomes offset better than serving cell }

**then** { UE sends *MeasurementReport* with correct measId for event A3
}

}

##### 8.1.3.1.2.2 Conformance requirements {#conformance-requirements-34 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.5.3, 5.5.2, 5.5.4.1, 5.5.4.4 and
5.5.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(MCG is E-UTRA):

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

> ...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

1\> if the received *measConfig* includes the *quantityConfig*:

2\> perform the quantity configuration procedure as specified in
5.5.2.8;

\[TS 38.331, clause 5.5.4.1\]

If security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig*includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

4\> if the *eventA3* or *eventA5* is configured in the corresponding
*reportConfig*:

5\> if a serving cell is associated with a *measObjectNR* and neighbors
are associated with another *measObjectNR*, consider any serving cell
associated with the other *measObjectNR* to be a neighboring cell as
well;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

\[TS 38.331, clause 5.5.4.4\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A3-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A3-2, as specified below, is fulfilled;

1\> use the SpCell for *Mp*, *Ofp and Ocp*.

NOTE The cell(s) that triggers the event has reference signals indicated
in the *measObjectNR* associated to this event which may be different
from the NR SpCell *measObjectNR*.

Inequality A3-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Mp + Ofp + Ocp + Off*

Inequality A3-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Mp + Ofp + Ocp + Off*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighboring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the reference
signal of the neighbor cell (i.e. *offsetMO* as defined within
*measObjectNR* corresponding to the neighbor cell).

***Ocn*** is the cell specific offset of the neighbor cell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the frequency of the neighbor cell), and set to zero if not configured
for the neighbor cell.

***Mp*** is the measurement result of the SpCell, not taking into
account any offsets.

***Ofp*** is the measurement object specific offset of the SpCell (i.e.
*offsetMO* as defined within *measObjectNR* corresponding to the
SpCell).

***Ocp*** is the cell specific offset of the SpCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the SpCell), and is set to zero if not configured for the SpCell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Off*** is the offset parameter for this event (i.e. *a3-Offset* as
defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn***, ***Ocn***, ***Ofp***, ***Ocp***, ***Hys***, ***Off*** are
expressed in dB.

\[TS 38.331, clause 5.5.5\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with
*servingCellMO*, RSRP, RSRQ and the available SINR, derived based on the
*rsType* if indicated in the associated *reportConfig,* otherwise based
on SSB if available, otherwise based on CSI-RS;

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

> ...

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

1\> if there is at least one applicable neighboring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighboring cells
up to *maxReportCells* in accordance with the following:

4\> if the reportType is set to eventTriggered:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first:

##### 8.1.3.1.2.3 Test description {#test-description-34 .H6}

##### 8.1.3.1.2.3.1 Pre-test conditions {#pre-test-conditions-34 .H6}

System Simulator:

\- NR Cell 1 is the serving cell.

\- NR Cell 2 is the intra-frequency neighbor cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.1.2.3.2 Test procedure sequence {#test-procedure-sequence-35 .H6}

Table 8.1.3.1.2.3.2-1 and 8.1.3.1.2.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1 and NR Cell 2 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble, while the configuration marked \"T1\" and \"T2\",
are applied at the point indicated in the Main behaviour description in
Table 8.1.3.1.2.3.2-3.

Table 8.1.3.1.2.3.2-1: Time instances of cell power level and parameter
changes for NR Cell 1 and NR Cell 2 in conducted test environment

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 2 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -85       | -91    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied    |
|    |              |      |           |        | for the      |
|    |              |      |           |        | neighbour NR |
|    |              |      |           |        | cell: Mn +   |
|    |              |      |           |        | Ofn + Ocn -- |
|    |              |      |           |        | Hys \> Mp +  |
|    |              |      |           |        | Ofp + Ocp +  |
|    |              |      |           |        | Off          |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -85       | -79    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | for          |
|    |              |      |           |        | int          |
|    |              |      |           |        | ra-frequency |
|    |              |      |           |        | neighbour NR |
|    |              |      |           |        | cell (measId |
|    |              |      |           |        | 1): Mn + Ofn |
|    |              |      |           |        | + Ocn -- Hys |
|    |              |      |           |        | \> Mp + Ofp  |
|    |              |      |           |        | + Ocp + Off  |
+----+--------------+------+-----------+--------+--------------+
| T2 | SS/PBCH SSS  | dBm/ | -85       | -91    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that leaving |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | (measId 1):  |
|    |              |      |           |        |              |
|    |              |      |           |        | Mn + Ofn +   |
|    |              |      |           |        | Ocn + Hys \< |
|    |              |      |           |        | Mp + Ofp +   |
|    |              |      |           |        | Ocp + Off    |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.3.1.2.3.2-2: Time instances of cell power level and parameter
changes for NR Cell 1 and NR Cell 2 in OTA test environment

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 2 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -91       | -100   | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied    |
|    |              |      |           |        | for the      |
|    |              |      |           |        | neighbour NR |
|    |              |      |           |        | cell: Mn +   |
|    |              |      |           |        | Ofn + Ocn -- |
|    |              |      |           |        | Hys \> Mp +  |
|    |              |      |           |        | Ofp + Ocp +  |
|    |              |      |           |        | Off          |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -91       | -82    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | for          |
|    |              |      |           |        | int          |
|    |              |      |           |        | ra-frequency |
|    |              |      |           |        | neighbour NR |
|    |              |      |           |        | cell (measId |
|    |              |      |           |        | 1): Mn + Ofn |
|    |              |      |           |        | + Ocn -- Hys |
|    |              |      |           |        | \> Mp + Ofp  |
|    |              |      |           |        | + Ocp + Off  |
+----+--------------+------+-----------+--------+--------------+
| T2 | SS/PBCH SSS  | dBm/ | -91       | -100   | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that leaving |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | (measId 1):  |
|    |              |      |           |        |              |
|    |              |      |           |        | Mn + Ofn +   |
|    |              |      |           |        | Ocn + Hys \< |
|    |              |      |           |        | Mp + Ofp +   |
|    |              |      |           |        | Ocp + Off    |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.3.1.2.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                  Message Sequence   TP                                     Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                  U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup NR measurement and reporting for intra-frequency event A3 (*measId* 1).   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                  \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.1.2.3.2-1/2.                                                 \-                 *-*                                    \-        \-
  4    Check: Does the UE transmit a *MeasurementReport* message to report event A3 (*measId* 1) with the measured RSRP value for NR Cell 2?                      \--\>              *NR RRC: MeasurementReport*            2         P
  5A   Wait and ignore MeasurementReport messages for 10s to allow change of power levels for NR Cell 2 and UE measurement                                                                                                            
  5    SS re-adjusts the cell-specific reference signal level according to row \"T2\" in table 8.1.3.1.2.2-1/2.                                                   \-                 *-*                                    \-        \-
  6    Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                                             *-*                *-*                                    1         F

##### 8.1.3.1.2.3.3 Specific message contents {#specific-message-contents-26 .H6}

Table 8.1.3.1.2.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.2.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.2.3.3-2: *MeasConfig* (Table 8.1.3.1.2.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                           
  Information Element                                                                        Value/remark             Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                   
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                          
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                 
  measObjectId                                                                               1                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR             Table 8.1.3.1.2.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                          
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                 
  reportConfigId                                                                             1                                                
  reportConfig CHOICE {                                                                                                                       
  reportConfigNR                                                                             ReportConfigNR-EventA3   Table 8.1.3.1.2.3.3-4   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                          
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  measId                                                                                     1                                                
  measObjectId                                                                               1                                                
  reportConfigId                                                                             1                                                
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------

Table 8.1.3.1.2.3.3-3: *MeasObjectNR* (Table 8.1.3.1.2.3.3-2)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.2.3.3-4: *ReportConfigNR-EventA3* (Table 8.1.3.1.2.3.3-2)

  ----------------------------------------------------------------------------- -------------- ----------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition EVENT\_A3                                    
  Information Element                                                           Value/remark   Comment           Condition
  ReportConfigNR ::= SEQUENCE {                                                                                  
  reportType CHOICE {                                                                                            
  eventTriggered SEQUENCE {                                                                                      
  eventId CHOICE {                                                                                               
  eventA3 SEQUENCE {                                                                                             
  a3-Offset CHOICE {                                                                                             
  rsrp                                                                          2              1 dB(2\*0.5 dB)   
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  reportAmount                                                                  infinity                         
  reportQuantityCell SEQUENCE {                                                                                  
  rsrp                                                                          true                             
  rsrq                                                                          false                            
  sinr                                                                          false                            
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  ----------------------------------------------------------------------------- -------------- ----------------- -----------

Table 8.1.3.1.2.3.3-5: *MeasurementReport* (step 4, Table
8.1.3.1.2.3.2-3)

  ---------------------------------------------------------------------------------------- ------------------------------------------- ---------------------------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                                       
  Information Element                                                                      Value/remark                                Comment                            Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                             
  measurementReport SEQUENCE {                                                                                                                                            
  measResults SEQUENCE {                                                                                                                                                  
  measId                                                                                   1                                                                              
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                     Measurement report for NR Cell 1   
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1                            
  servCellId                                                                               ServCellIndex of NR Cell 1                                                     
  measResultServingCell SEQUENCE {                                                                                                                                        
  physCellId                                                                               PCI of NR Cell 1                                                               
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                     (0..127)                                                                       
  rsrq                                                                                     (0..127)                                                                       
  sinr                                                                                     Not present                                                                    
                                                                                           Not checked                                                                    pc\_ss\_SINR\_Meas
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  measResultNeighCells CHOICE {                                                                                                                                           
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                     Measurement report for NR Cell 2   
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1                            
  physCellId                                                                               Physical layer cell identity of NR Cell 2                                      
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                     (0..127)                                                                       
  rsrq                                                                                     Not present                                                                    
  sinr                                                                                     Not present                                                                    
  }                                                                                                                                                                       
  resultsCSI-RS-Cell                                                                       Not present                                                                    
  }                                                                                                                                                                       
  rsIndexResults                                                                           Not present                                                                    
  }                                                                                                                                                                       
  cgi-Info                                                                                 Not present                                                                    
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  ---------------------------------------------------------------------------------------- ------------------------------------------- ---------------------------------- --------------------

##### 8.1.3.1.3 Measurement configuration control and reporting / Event A3 / Measurement of Neighbour NR cell / Inter-frequency measurements

##### 8.1.3.1.3.1 Test Purpose (TP) {#test-purpose-tp-35 .H6}

##### (1) {#section-68 .H6}

**with** { UE in NR RRC\_CONNECTED state and inter-frequency
measurements configured for event A3 using measurement gaps configured
as *gapUE* }

**ensure** that {

**when** { Entry condition for event A3 is not met for neighbour cell }

**then** { UE does not send *MeasurementReport* }

}

##### (2) {#section-69 .H6}

**with** { UE in NR RRC\_CONNECTED state and inter-frequency
measurements configured for event A3 using measurement gaps configured
as *gapUE* }

**ensure** that {

**when** { Neighbour cell becomes offset better than serving cell }

**then** { UE sends *MeasurementReport* with correct measId for event A3
}

}

##### 8.1.3.1.3.2 Conformance requirements {#conformance-requirements-35 .H6}

Same as test case 8.1.3.1.2 with the following difference:

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

##### 8.1.3.1.3.3 Test description {#test-description-35 .H6}

##### 8.1.3.1.3.3.1 Pre-test conditions {#pre-test-conditions-35 .H6}

Same as test case 8.1.3.1.2 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

\- System information combination: NR-4 replaces NR-2.

##### 8.1.3.1.3.3.2 Test procedure sequence {#test-procedure-sequence-36 .H6}

Same as test case 8.1.3.1.2 with the following differences:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.3.1.3.3.3 Specific message contents {#specific-message-contents-27 .H6}

Same as test case 8.1.3.1.2 with the following difference:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

Table 8.1.3.1.3.3.3-1: *MeasConfig* (Table 8.1.3.1.2.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                           
  Information Element                                                                        Value/remark             Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                   
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                        
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                 
  measObjectId                                                                               1                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f1          Table 8.1.3.1.3.3.3-2   
  }                                                                                                                                           
  }                                                                                                                                           
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                  entry 2                 
  measObjectId                                                                               2                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f2          Table 8.1.3.1.3.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                          
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                 
  reportConfigId                                                                             1                                                
  reportConfig CHOICE {                                                                                                                       
  reportConfigNR                                                                             ReportConfigNR-EventA3   Table 8.1.3.1.2.3.3-4   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                          
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  measId                                                                                     1                                                
  measObjectId                                                                               2                                                
  reportConfigId                                                                             1                                                
  }                                                                                                                                           
  }                                                                                                                                           
  measGapConfig                                                                              MeasGapConfig                                    
  }                                                                                                                                           
  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------

Table 8.1.3.1.3.3.3-2: *MeasObjectNR-f1* (Table 8.1.3.1.3.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.3.3.3-3: *MeasObjectNR-f2* (Table 8.1.3.1.3.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 3             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

##### 8.1.3.1.4 Measurement configuration control and reporting / Event A3 / Measurement of Neighbour NR cell / Inter-band measurements

##### 8.1.3.1.4.1 Test Purpose (TP) {#test-purpose-tp-36 .H6}

##### (1) {#section-70 .H6}

**with** { UE in NR RRC\_CONNECTED state and inter-band measurements
configured for event A3 using measurement gaps configured as *gapUE*}

**ensure** that {

**when** { Entry condition for event A3 is not met for neighbour cell }

**then** { UE does not send *MeasurementReport* }

}

##### (2) {#section-71 .H6}

**with** { UE in NR RRC\_CONNECTED state and inter-band measurements
configured for event A3 using measurement gaps configured as *gapUE* }

**ensure** that {

**when** { Neighbour cell becomes offset better than serving cell }

**then** { UE sends *MeasurementReport* with correct measId for event A3
}

}

##### 8.1.3.1.4.2 Conformance requirements {#conformance-requirements-36 .H6}

Same as test case 8.1.3.1.2 with the following difference:

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

##### 8.1.3.1.4.3 Test description {#test-description-36 .H6}

##### 8.1.3.1.4.3.1 Pre-test conditions {#pre-test-conditions-36 .H6}

Same as test case 8.1.3.1.2 with the following differences:

\- Cells configuration: NR Cell 10 replaces NR Cell 2.

\- System information combination: NR-4 replaces NR-2.

##### 8.1.3.1.4.3.2 Test procedure sequence {#test-procedure-sequence-37 .H6}

Same as test case 8.1.3.1.2 with the following differences:

> \- Cells configuration: NR Cell 10 replaces NR Cell 2.

##### Specific message contents {#specific-message-contents-28 .H6}

Same as test case 8.1.3.1.222 with the following difference:

\- Cells configuration: NR Cell 10 replaces NR Cell 2.

Table 8.1.3.1.4.3.3-1: *MeasConfig* (Table 8.1.3.1.2.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                           
  Information Element                                                                        Value/remark             Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                   
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                        
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                 
  measObjectId                                                                               1                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f1          Table 8.1.3.1.4.3.3-2   
  }                                                                                                                                           
  }                                                                                                                                           
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                  entry 2                 
  measObjectId                                                                               2                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f2          Table 8.1.3.1.4.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                          
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                 
  reportConfigId                                                                             1                                                
  reportConfig CHOICE {                                                                                                                       
  reportConfigNR                                                                             ReportConfigNR-EventA3   Table 8.1.3.1.2.3.3-4   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                          
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  measId                                                                                     1                                                
  measObjectId                                                                               2                                                
  reportConfigId                                                                             1                                                
  }                                                                                                                                           
  }                                                                                                                                           
  measGapConfig                                                                              MeasGapConfig                                    
  }                                                                                                                                           
  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------

Table 8.1.3.1.4.3.3-2: MeasObjectNR-f1 (Table 8.1.3.1.4.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.4.3.3-3: MeasObjectNR-f2 (Table 8.1.3.1.4.3.3-1)

  ---------------------------------------------------- ------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                   
  Information Element                                  Value/remark                          Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                           
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 10             
  absThreshSS-BlocksConsolidation                      Not present                                     
  nrofSS-BlocksToAverage                               Not present                                     
  }                                                                                                    
  ---------------------------------------------------- ------------------------------------- --------- -----------

##### 8.1.3.1.5 Measurement configuration control and reporting / Event A4 / Measurement of Neighbour NR cell / Intra-frequency measurements

##### 8.1.3.1.5.1 Test Purpose (TP) {#test-purpose-tp-37 .H6}

##### (1) {#section-72 .H6}

**with { UE in NR RRC\_CONNECTED state and intra-frequency measurements
configured for event A4 with event based periodical reporting }**

**ensure that {**

**when { Neighbour cell becomes better than absolute threshold }**

**then { UE sends MeasurementReport message at regular intervals while
entering condition for event A4 is satisfied }**

**}**

##### (2) {#section-73 .H6}

**with { UE in NR RRC\_CONNECTED state and periodical measurement
reporting triggered by event A4 ongoing }**

**ensure that {**

**when { Neighbour cell becomes worse than absolute threshold }**

**then { UE stops sending MeasurementReport message }**

**}**

##### 8.1.3.1.5.2 Conformance requirements {#conformance-requirements-37 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.4.1, 5.5.4.5 and
5.5.5.1. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(MCG is E-UTRA):

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

...

4\> for measurement events other than *eventA1* or *eventA2*:

...

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
not included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

...

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

> ...

4\> else:

5\> for events involving a serving cell associated with a *measObjectNR*
and neighbours associated with another *measObjectNR*, consider any
serving cell associated with the other *measObjectNR* to be a
neighbouring cell as well;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

...

3\> if *reportOnLeave* is set to *TRUE* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

> ...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

> ...

\[TS 38.331, clause 5.5.4.5\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A4-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A4-2, as specified below, is fulfilled.

Inequality A4-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Thresh*

Inequality A4-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Thresh*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the neighbour
cell (i.e. *offsetMO* as defined within *measObjectNR* corresponding to
the neighbour cell).

***Ocn*** is the measurement object specific offset of the neighbour
cell (i.e. *cellIndividualOffset* as defined within *measObjectNR*
corresponding to the neighbour cell), and set to zero if not configured
for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Thresh*** is the threshold parameter for this event (i.e.
*a4-Threshold* as defined within *reportConfigNR* for this event).

***Mn*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and RS-SINR.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR for each configured serving
cell derived based on the *rsType* indicated in the associated
*reportConfig*;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include for each NR serving cell that is configured with
*servingCellMO*, if any, the *servCellId*;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

...

2\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

3\> if the *reportType* is set to *eventTriggered*:

4\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

> ...

3\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

3\> if the *reportType* is set to *eventTriggered*:

4\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

5\> if the *measObject* associated with this *measId* concerns NR:

6\> if *rsType* in the associated *reportConfig* is set to *ssb*:

7\> set *results SSB-Cell* within the *measResult* to include the
SS/PBCH block based quantity(ies) indicated in the *reportQuantityCell*
within the concerned *reportConfig*, in order of decreasing trigger
quantity, i.e. the best cell is included first:

> ...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

...

...

1\> if the UE is configured with EN-DC:

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.5.3 Test description {#test-description-37 .H6}

##### 8.1.3.1.5.3.1 Pre-test conditions {#pre-test-conditions-37 .H6}

System Simulator:

\- NR Cell 1 is the serving cell, NR Cell 2 is the intra-frequency
neighbour cell of NR Cell 1.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.1.5.3.2 Test procedure sequence {#test-procedure-sequence-38 .H6}

Table 8.1.3.1.5.3.2-1 and 8.1.3.1.5.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1 and NR Cell 2 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble, while the configuration marked \"T1\" and \"T2\",
are applied at the point indicated in the Main behaviour description in
Table 8.1.3.1.5.3.2-3.

Table 8.1.3.1.5.3.2-1: Time instances of cell power level and parameter
changes in conducted test environment

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 2 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -85       | -91    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A4 |
|    |              |      |           |        | (measId 1)   |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied:   |
|    |              |      |           |        |              |
|    |              |      |           |        | *Mn + Ofn +  |
|    |              |      |           |        | Ocn - Hys ≦  |
|    |              |      |           |        | Thresh*      |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -85       | -79    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A4 |
|    |              |      |           |        | (measId 1)   |
|    |              |      |           |        | is           |
|    |              |      |           |        | satisfied:   |
|    |              |      |           |        |              |
|    |              |      |           |        | *Mn + Ofn +  |
|    |              |      |           |        | Ocn -- Hys   |
|    |              |      |           |        | \> Thresh*   |
+----+--------------+------+-----------+--------+--------------+
| T2 | SS/PBCH SSS  | dBm/ | -85       | -93    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that leaving |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A4 |
|    |              |      |           |        | (measId 1)   |
|    |              |      |           |        | is           |
|    |              |      |           |        | satisfied:   |
|    |              |      |           |        |              |
|    |              |      |           |        | *Mn + Ofn +  |
|    |              |      |           |        | Ocn + Hys \< |
|    |              |      |           |        | Thresh*      |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.3.1.5.3.2-2: Time instances of cell power level and parameter
changes in OTA test environment

+----+-------------+----------+--------+--------+-------------+
|    | Parameter   | Unit     | NR     | NR     | Remark      |
|    |             |          |        |        |             |
|    |             |          | Cell 1 | Cell 2 |             |
+====+=============+==========+========+========+=============+
| T0 | SS/PBCH SSS | dBm/ SCS | -91    | -100   | Power       |
|    | EPRE        |          |        |        | levels are  |
|    |             |          |        |        | such that   |
|    |             |          |        |        | entry       |
|    |             |          |        |        | condition   |
|    |             |          |        |        | for event   |
|    |             |          |        |        | A4 (measId  |
|    |             |          |        |        | 1) is not   |
|    |             |          |        |        | satisfied:  |
|    |             |          |        |        |             |
|    |             |          |        |        | *Mn + Ofn + |
|    |             |          |        |        | Ocn - Hys ≦ |
|    |             |          |        |        | Thresh*     |
+----+-------------+----------+--------+--------+-------------+
| T1 | SS/PBCH SSS | dBm/ SCS | -91    | -82    | Power       |
|    | EPRE        |          |        |        | levels are  |
|    |             |          |        |        | such that   |
|    |             |          |        |        | entry       |
|    |             |          |        |        | condition   |
|    |             |          |        |        | for event   |
|    |             |          |        |        | A4 (measId  |
|    |             |          |        |        | 1) is       |
|    |             |          |        |        | satisfied:  |
|    |             |          |        |        |             |
|    |             |          |        |        | *Mn + Ofn + |
|    |             |          |        |        | Ocn -- Hys  |
|    |             |          |        |        | \> Thresh*  |
+----+-------------+----------+--------+--------+-------------+
| T2 | SS/PBCH SSS | dBm/ SCS | -91    | -100   | Power       |
|    | EPRE        |          |        |        | levels are  |
|    |             |          |        |        | such that   |
|    |             |          |        |        | leaving     |
|    |             |          |        |        | condition   |
|    |             |          |        |        | for event   |
|    |             |          |        |        | A4 (measId  |
|    |             |          |        |        | 1) is       |
|    |             |          |        |        | satisfied:  |
|    |             |          |        |        |             |
|    |             |          |        |        | *Mn + Ofn + |
|    |             |          |        |        | Ocn + Hys   |
|    |             |          |        |        | \< Thresh*  |
+----+-------------+----------+--------+--------+-------------+

Table 8.1.3.1.5.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                  Message Sequence   TP                                     Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                  U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup NR measurement and reporting for intra-frequency event A4 (*measId* 1).   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                  \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.1.5.3.2-1/2.                                                 \-                 *-*                                    \-        \-
  \-   EXCEPTION: In parallel to events described in step 4 the steps specified in table 8.1.3.1.5.3.2-4 shall take place                                         \-                 *-*                                    \-        \-
  4    Wait for 30 seconds to ensure that the UE performs a periodical intra-frequency reporting for NR Cell 2                                                    \-                 *-*                                    1         \-
  5    SS re-adjusts the cell-specific reference signal level according to row \"T2\" in table 8.1.3.1.5.3.2-1/2.                                                 \-                 *-*                                    \-        \-
  6    Wait and ignore MeasurementReport messages for 10s to allow change of power levels for NR Cell 2 and UE measurement                                        \-                 *-*                                    \-        \-
  7    Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                                             \--\>              NR RRC: *MeasurementReport*            2         F

Table 8.1.3.1.5.3.2-4: Parallel behaviour

  St   Procedure                                                                                                                                               Message Sequence   TP                            Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ----------------------------- --------- ----
                                                                                                                                                               U - S              Message                                 
  \-   EXCEPTION: After the 1st message is received, step 1 below shall be repeated every time the duration indicated in the IE *reportInterval* has elapsed   \-                 \-                            \-        \-
  1    Check: Does the UE transmit a *MeasurementReport* message to report event A4 (*measId* 1) with the measured RSRP value for NR Cell 2?                   \--\>              *NR RRC: MeasurementReport*   1         P

##### 8.1.3.1.5.3.3 Specific message contents {#specific-message-contents-29 .H6}

Table 8.1.3.1.5.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.5.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.5.3.3-2: *MeasConfig* (Table 8.1.3.1.5.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                   
  ------------------------------------------------------------------------------------------ ------------------------------------------------ ----------------------- -----------
  Information Element                                                                        Value/remark                                     Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                           
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                                  
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                 
  measObjectId                                                                               1                                                MeasObjectIdNR-f1       
  measObject CHOICE {                                                                                                                                                 
  measObjectNR SEQUENCE {                                                                                                                                             
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 2                           
  absThreshSS-BlocksConsolidation                                                            Not present                                                              
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                  
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                 
  reportConfigId                                                                             1                                                                        
  reportConfig CHOICE {                                                                                                                                               
  reportConfigNR                                                                             ReportConfigNR-EventA4                           Table 8.1.3.1.5.3.3-3   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                  
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                 
  measId                                                                                     1                                                                        
  measObjectId                                                                               1                                                                        
  reportConfigId                                                                             1                                                                        
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   

Table 8.1.3.1.5.3.3-3: *ReportConfigNR-EventA4* (Table 8.1.3.1.5.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition EVENT\_A4                                                
  ----------------------------------------------------------------------------- ------------------ ------------------------- -----------
  Information Element                                                           Value/remark       Comment                   Condition
  ReportConfigNR ::= SEQUENCE {                                                                                              
  reportType CHOICE {                                                                                                        
  eventTriggered SEQUENCE {                                                                                                  
  eventId CHOICE {                                                                                                           
  eventA4 SEQUENCE {                                                                                                         
  a4-Threshold CHOICE {                                                                                                      
  rsrp                                                                          70                 -86dBm                    FR1
                                                                                66 + delta(NRfs)   Threshold set to -91dBm   FR2
  }                                                                                                                          
  hysteresis                                                                    2                  1 dB                      
  }                                                                                                                          
  }                                                                                                                          
  reportAmount                                                                  infinity                                     
  reportQuantityCell SEQUENCE {                                                                                              
  rsrp                                                                          true                                         
  rsrq                                                                          false                                        
  sinr                                                                          false                                        
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          

Table 8.1.3.1.5.3.3-4: *MeasurementReport* (step 1, Table
8.1.3.1.5.3.2-4)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                               
  ---------------------------------------------------------------------------------------- ------------------------------------------- -------------------------- --------------------
  Information Element                                                                      Value/remark                                Comment                    Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                
  criticalExtensions CHOICE {                                                                                                                                     
  measurementReport SEQUENCE {                                                                                                                                    
  measResults SEQUENCE {                                                                                                                                          
  measId                                                                                   1                                                                      
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                     Report NR Cell 1           
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1                    
  servCellId                                                                               ServCellIndex of NR Cell 1                                             
  measResultServingCell SEQUENCE {                                                                                                                                
  physCellId                                                                               Physical layer cell identity of NR Cell 1                              
  measResult SEQUENCE {                                                                                                                                           
  cellResults SEQUENCE {                                                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                                                      
  rsrp                                                                                     (0..127)                                                               
  rsrq                                                                                     (0..127)                                                               
  sinr                                                                                     Not present                                                            
                                                                                           Not checked                                                            pc\_ss\_SINR\_Meas
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  measResultNeighCells CHOICE {                                                                                                                                   
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF OF MeasResultNR {                1 entry                                     Report NR neighbour cell   
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1                    
  physCellId                                                                               Physical layer cell identity of NR Cell 2                              
  measResult SEQUENCE {                                                                                                                                           
  cellResults SEQUENCE {                                                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                                                      
  rsrp                                                                                     (0..127)                                                               
  rsrq                                                                                     Not present                                                            
  sinr                                                                                     Not present                                                            
  }                                                                                                                                                               
  resultsCSI-RS-Cell                                                                       Not present                                                            
  }                                                                                                                                                               
  rsIndexResults                                                                           Not present                                                            
  }                                                                                                                                                               
  cgi-Info                                                                                 Not present                                                            
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               

##### 8.1.3.1.6 Measurement configuration control and reporting / Event A4 / Measurement of Neighbour NR cell / Inter-frequency measurements

##### 8.1.3.1.6.1 Test Purpose (TP) {#test-purpose-tp-38 .H6}

Same as test case 8.1.3.1.5 but applied to inter-frequency case.

##### 8.1.3.1.6.2 Conformance requirements {#conformance-requirements-38 .H6}

Same as test case 8.1.3.1.5 with the following difference:

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

##### 8.1.3.1.6.3 Test description {#test-description-38 .H6}

##### 8.1.3.1.6.3.1 Pre-test conditions {#pre-test-conditions-38 .H6}

Same as test case 8.1.3.1.5 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

\- System information combination: NR-4 repleaces NR-2.

##### 8.1.3.1.6.3.2 Test procedure sequence {#test-procedure-sequence-39 .H6}

Same as test case 8.1.3.1.5 with the following differences:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.3.1.6.3.3 Specific message contents {#specific-message-contents-30 .H6}

Same as test case 8.1.3.1.5 with the following difference:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

Table 8.1.3.1.6.3.3-1: *MeasConfig* (Table 8.1.3.1.5.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                           
  Information Element                                                                        Value/remark             Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                   
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                        
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                 
  measObjectId                                                                               1                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f1          Table 8.1.3.1.6.3.3-2   
  }                                                                                                                                           
  }                                                                                                                                           
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                  entry 2                 
  measObjectId                                                                               2                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f2          Table 8.1.3.1.6.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                          
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                 
  reportConfigId                                                                             1                                                
  reportConfig CHOICE {                                                                                                                       
  reportConfigNR                                                                             ReportConfigNR-EventA4   Table 8.1.3.1.5.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                          
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  measId                                                                                     1                                                
  measObjectId                                                                               2                                                
  reportConfigId                                                                             1                                                
  }                                                                                                                                           
  }                                                                                                                                           
  measGapConfig                                                                              MeasGapConfig                                    
  }                                                                                                                                           
  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------

Table 8.1.3.1.6.3.3-2: *MeasObjectNR-f1* (Table 8.1.3.1.6.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.6.3.3-3: *MeasObjectNR-f2* (Table 8.1.3.1.6.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 3             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

##### 8.1.3.1.7 Measurement configuration control and reporting / Event A4 / Measurement of Neighbour NR cell / Inter-band measurements

##### 8.1.3.1.7.1 Test Purpose (TP) {#test-purpose-tp-39 .H6}

Same as test case 8.1.3.1.5 but applied to inter-band case.

##### 8.1.3.1.7.2 Conformance requirements {#conformance-requirements-39 .H6}

Same as test case 8.1.3.1.5 with the following differences:

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

##### 8.1.3.1.7.3 Test description {#test-description-39 .H6}

##### 8.1.3.1.7.3.1 Pre-test conditions {#pre-test-conditions-39 .H6}

Same as test case 8.1.3.1.5 with the following differences:

> \- Cells configuration: NR Cell 10 replaces NR Cell 2.
>
> \- System information combination: NR-4 repleaces NR-2.

##### 8.1.3.1.7.3.2 Test procedure sequence {#test-procedure-sequence-40 .H6}

Same as test case 8.1.3.1.5 with the following differences:

> \- Cells configuration: NR Cell 10 replaces NR Cell 2.

##### 8.1.3.1.7.3.3 Specific message contents {#specific-message-contents-31 .H6}

Same as test case 8.1.3.1.5 with the following difference:

> \- Cells configuration: NR Cell 10 replaces NR Cell 2.

Table 8.1.3.1.7.3.3-1: *MeasConfig* (Table 8.1.3.1.5.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                           
  Information Element                                                                        Value/remark             Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                   
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                        
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                 
  measObjectId                                                                               1                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f1          Table 8.1.3.1.7.3.3-2   
  }                                                                                                                                           
  }                                                                                                                                           
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                  entry 2                 
  measObjectId                                                                               2                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f2          Table 8.1.3.1.7.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                          
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                 
  reportConfigId                                                                             1                                                
  reportConfig CHOICE {                                                                                                                       
  reportConfigNR                                                                             ReportConfigNR-EventA4   Table 8.1.3.1.5.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                          
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  measId                                                                                     1                                                
  measObjectId                                                                               2                                                
  reportConfigId                                                                             1                                                
  }                                                                                                                                           
  }                                                                                                                                           
  measGapConfig                                                                              MeasGapConfig                                    
  }                                                                                                                                           
  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------

Table 8.1.3.1.7.3.3-2: *MeasObjectNR-f1* (Table 8.1.3.1.7.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.7.3.3-3: *MeasObjectNR-f2* (Table 8.1.3.1.7.3.3-1)

  ---------------------------------------------------- ------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                   
  Information Element                                  Value/remark                          Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                           
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 10             
  absThreshSS-BlocksConsolidation                      Not present                                     
  nrofSS-BlocksToAverage                               Not present                                     
  }                                                                                                    
  ---------------------------------------------------- ------------------------------------- --------- -----------

##### 8.1.3.1.8 Measurement configuration control and reporting / Event A5 / Measurement of Neighbour NR cell / Intra-frequency measurements

##### 8.1.3.1.8.1 Test Purpose (TP) {#test-purpose-tp-40 .H6}

##### (1) {#section-74 .H6}

**with { UE in NR RRC\_CONNECTED state and intra-frequency measurements
configured for event A5 with event based periodical reporting }**

**ensure that {**

**when { Serving cell becomes worse than absolute threshold1 and
neighbour cell becomes better than absolute threshold2 }**

**then { UE sends MeasurementReport message at regular intervals while
entering conditions for event A5 are satisfied }**

**}**

##### (2) {#section-75 .H6}

**with { UE in NR RRC\_CONNECTED state and periodical measurement
reporting triggered by event A5 ongoing }**

**ensure that {**

**when { Serving cell becomes better than absolute threshold1 or
neighbour cell becomes worse than absolute threshold2 }**

**then { UE stops sending MeasurementReport message }**

**}**

##### 8.1.3.1.8.2 Conformance requirements {#conformance-requirements-40 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.4.1, 5.5.4.6 and
5.5.5.1. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(MCG is E-UTRA):

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

...

4\> if the *eventA3* or *eventA5* is configured in the corresponding
*reportConfig*:

5\> if a serving cell is associated with a *measObjectNR* and neighbours
are associated with another *measObjectNR*, consider any serving cell
associated with the other *measObjectNR* to be a neighbouring cell as
well;

...

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

> ...

4\> else:

5\> for events involving a serving cell associated with a *measObjectNR*
and neighbours associated with another *measObjectNR*, consider any
serving cell associated with the other *measObjectNR* to be a
neighbouring cell as well;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

> ...

3\> if *reportOnLeave* is set to *TRUE* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

> ...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

> ...

\[TS 38.331, clause 5.5.4.6\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition A5-1 and condition A5-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A5-3 or condition A5-4, i.e. at least one of the two, as
specified below, is fulfilled;

1\> use the SpCell for *Mp*.

NOTE: The parameters of the reference signal(s) of the cell(s) that
triggers the event are indicated in the *measObjectNR* associated to the
event which may be different from the *measObjectNR* of the NR SpCell.

Inequality A5-1 (Entering condition 1)

*Mp + Hys \< Thresh1*

Inequality A5-2 (Entering condition 2)

*Mn + Ofn + Ocn -- Hys \> Thresh2*

Inequality A5-3 (Leaving condition 1)

*Mp -- Hys \> Thresh1*

Inequality A5-4 (Leaving condition 2)

*Mn + Ofn + Ocn + Hys \< Thresh2*

The variables in the formula are defined as follows:

***Mp*** is the measurement result of the NR SpCell, not taking into
account any offsets.

***Mn*** is the measurement result of the neighbouring cell/SCell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the
neighbour/SCell cell (i.e. *offsetMO* as defined within *measObjectNR*
corresponding to the neighbour cell/SCell).

***Ocn*** is the cell specific offset of the neighbour cell/SCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the neighbour cell/SCell), and set to zero if not configured for the
neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Thresh1*** is the threshold parameter for this event (i.e.
*a5-Threshold1* as defined within *reportConfigNR* for this event).

***Thresh2*** is the threshold parameter for this event (i.e.
*a5-Threshold2* as defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh1***is expressed in the same unit as ***Mp***.

***Thresh2*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with
*servingCellMO*, RSRP, RSRQ and the available SINR derived based on the
*rsType* if indicated in the associated *reportConfig,* otherwise based
on SSB if available, otherwise based on CSI-RS; for each configured
serving cell derived based on the *rsType* indicated in the associated
*reportConfig*;

set the *servCellId* within *measResultServingMOList* to include each NR
serving cell that is configured with *servingCellMO*, if any;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include for each NR serving cell that is configured with
*servingCellMO*, if any, the *servCellId*;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

> ...

2\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

3\> if the *reportType* is set to *eventTriggered*:

4\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

> ...

3\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

3\> if the *reportType* is set to *eventTriggered*:

4\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

5\> if the *measObject* associated with this *measId* concerns NR:

6\> if *rsType* in the associated *reportConfig* is set to *ssb*:

7\> set *results SSB-Cell* within the *measResult* to include the
SS/PBCH block based quantity(ies) indicated in the *reportQuantityCell*
within the concerned *reportConfig*, in order of decreasing trigger
quantity, i.e. the best cell is included first:

> ...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

> ...

...

1\> if the UE is configured with EN-DC:

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.8.3 Test description {#test-description-40 .H6}

##### 8.1.3.1.8.3.1 Pre-test conditions {#pre-test-conditions-40 .H6}

System Simulator:

\- NR Cell 1 is the PCell, NR Cell 2 is the intra-frequency neighbour
cell of NR Cell 1.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.1.8.3.2 Test procedure sequence {#test-procedure-sequence-41 .H6}

Table 8.1.3.1.8.3.2-1 and 8.1.3.1.8.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1 and NR Cell 2at various time instants
of the test execution. Row marked \"T0\" denotes the conditions after
the preamble, while the configuration marked \"T1\" and \"T2\"are
applied at the point indicated in the Main behaviour description in
Table 8.1.3.1.8.3.2-3.

Table 8.1.3.1.8.3.2-1: Time instances of cell power level and parameter
changes in conducted test environment

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 2 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -85       | -91    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A5 |
|    |              |      |           |        | (measId 1)   |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied:   |
|    |              |      |           |        |              |
|    |              |      |           |        | *Mp + Hys ≥  |
|    |              |      |           |        | Thresh1 or   |
|    |              |      |           |        | Mn + Ofn +   |
|    |              |      |           |        | Ocn + Hys ≤  |
|    |              |      |           |        | Thresh2*     |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -85       | -79    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A5 |
|    |              |      |           |        | (measId 1)   |
|    |              |      |           |        | is           |
|    |              |      |           |        | satisfied:   |
|    |              |      |           |        |              |
|    |              |      |           |        | *Mp + Hys \< |
|    |              |      |           |        | Thresh1* and |
|    |              |      |           |        | *Mn + Ofn +  |
|    |              |      |           |        | Ocn - Hys \> |
|    |              |      |           |        | Thresh2*     |
+----+--------------+------+-----------+--------+--------------+
| T2 | SS/PBCH SSS  | dBm/ | -85       | -93    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that leaving |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A5 |
|    |              |      |           |        | (measId 1)   |
|    |              |      |           |        | is           |
|    |              |      |           |        | satisfied:   |
|    |              |      |           |        |              |
|    |              |      |           |        | *Mp - Hys \> |
|    |              |      |           |        | Thresh1* or  |
|    |              |      |           |        | *Mn + Ofn +  |
|    |              |      |           |        | Ocn + Hys \< |
|    |              |      |           |        | Thresh2*     |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.3.1.8.3.2-2: Time instances of cell power level and parameter
changes in OTA test environment

+----+-----------------+------+--------+--------+-----------------+
|    | Parameter       | Unit | NR     | NR     | Remark          |
|    |                 |      |        |        |                 |
|    |                 |      | Cell 1 | Cell 2 |                 |
+====+=================+======+========+========+=================+
| T0 | SS/PBCH         | dBm/ | -82    | -100   | Power levels    |
|    |                 |      |        |        | are such that   |
|    | SSS EPRE        | SCS  |        |        | entry condition |
|    |                 |      |        |        | for event A5    |
|    |                 |      |        |        | (measId 1) is   |
|    |                 |      |        |        | not satisfied:  |
|    |                 |      |        |        |                 |
|    |                 |      |        |        | *Mp + Hys ≥     |
|    |                 |      |        |        | Thresh1 or Mn + |
|    |                 |      |        |        | Ofn + Ocn + Hys |
|    |                 |      |        |        | ≤ Thresh2*      |
+----+-----------------+------+--------+--------+-----------------+
| T1 | SS/PBCH         | dBm/ | -100   | -82    | Power levels    |
|    |                 |      |        |        | are such that   |
|    | SSS EPRE        | SCS  |        |        | entry condition |
|    |                 |      |        |        | for event A5    |
|    |                 |      |        |        | (measId 1) is   |
|    |                 |      |        |        | satisfied:      |
|    |                 |      |        |        |                 |
|    |                 |      |        |        | *Mp + Hys \<    |
|    |                 |      |        |        | Thresh1* and    |
|    |                 |      |        |        | *Mn + Ofn + Ocn |
|    |                 |      |        |        | -- Hys \>       |
|    |                 |      |        |        | Thresh2*        |
+----+-----------------+------+--------+--------+-----------------+
| T2 | SS/PBCH SSS     | dBm/ | -82    | -100   | Power levels    |
|    | EPRE            |      |        |        | are such that   |
|    |                 | SCS  |        |        | leaving         |
|    |                 |      |        |        | condition for   |
|    |                 |      |        |        | event A5        |
|    |                 |      |        |        | (measId 1) is   |
|    |                 |      |        |        | satisfied:      |
|    |                 |      |        |        |                 |
|    |                 |      |        |        | *Mp -- Hys \>   |
|    |                 |      |        |        | Thresh1* or *Mn |
|    |                 |      |        |        | + Ofn + Ocn +   |
|    |                 |      |        |        | Hys \< Thresh2* |
+----+-----------------+------+--------+--------+-----------------+

Table 8.1.3.1.8.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                 Message Sequence   TP                                     Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                 U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup NR measurement and reporting for intra-frequency event A5 (*measId* 1)   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                 \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.1.8.3.2-1/2.                                                \-                 *-*                                    \-        \-
  \-   EXCEPTION: In parallel to events described in step 4 the steps specified in table 8.1.3.1.8.3.2-4 shall take place                                        \-                 *-*                                    \-        \-
  4    Wait for 30 seconds to ensure that the UE performs a periodical intra-frequency reporting for NR Cell 2                                                   \-                 *-*                                    1         \-
  5    SS re-adjusts the cell-specific reference signal level according to row \"T2\" in table 8.1.3.1.8.3.2-1/2.                                                \-                 *-*                                    \-        \-
  6    Wait and ignore MeasurementReport messages for 10s to allow change of power levels for NR Cell 2 and UE measurement                                       \-                 *-*                                    \-        \-
  7    Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                                            \--\>              NR RRC: *MeasurementReport*            2         F

Table 8.1.3.1.8.3.2-4: Parallel behaviour

  St   Procedure                                                                                                                                               Message Sequence   TP                    Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------- --------- ----
                                                                                                                                                               U - S              Message                         
  \-   EXCEPTION: After the 1st message is received, step 1 below shall be repeated every time the duration indicated in the IE *reportInterval* has elapsed   \-                 *-*                   \-        \-
  1    Check: Does the UE transmit a *MeasurementReport* message to report event A5 (*measId* 1) with the measured RSRP value for NR Cell 2?                   \--\>              *MeasurementReport*   1         P

##### 8.1.3.1.8.3.3 Specific message contents {#specific-message-contents-32 .H6}

Table 8.1.3.1.8.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.8.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.8.3.3-2: *MeasConfig* (Table 8.1.3.1.8.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                   
  Information Element                                                                        Value/remark                                     Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                           
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                                  
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                 
  measObjectId                                                                               1                                                MeasObjectIdNR-f1       
  measObject CHOICE {                                                                                                                                                 
  measObjectNR SEQUENCE {                                                                                                                                             
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 2                           
  absThreshSS-BlocksConsolidation                                                            Not present                                                              
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                  
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                 
  reportConfigId                                                                             1                                                                        
  reportConfig CHOICE {                                                                                                                                               
  reportConfigNR                                                                             ReportConfigNR-EventA5                           Table 8.1.3.1.8.3.3-3   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                  
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                 
  measId                                                                                     1                                                                        
  measObjectId                                                                               1                                                                        
  reportConfigId                                                                             1                                                                        
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  ------------------------------------------------------------------------------------------ ------------------------------------------------ ----------------------- -----------

Table 8.1.3.1.8.3.3-3: *ReportConfigNR-EventA5* (Table 8.1.3.1.8.3.3-2)

  ----------------------------------------------------------------------------- ------------------ ------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition EVENT\_A5                                                
  Information Element                                                           Value/remark       Comment                   Condition
  ReportConfigNR ::= SEQUENCE {                                                                                              
  reportType CHOICE {                                                                                                        
  eventTriggered SEQUENCE {                                                                                                  
  eventId CHOICE {                                                                                                           
  eventA5 SEQUENCE {                                                                                                         
  a5-Threshold1 CHOICE {                                                                                                     
  rsrp                                                                          76                 -80dBm                    FR1
                                                                                66 + Delta(NRfs)   Threshold set to -91dBm   FR2
  }                                                                                                                          
  a5-Threshold2 CHOICE {                                                                                                     
  rsrp                                                                          70                 -86dBm                    FR1
                                                                                66 + Delta(NRfs)   Threshold set to -91dBm   FR2
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  reportAmount                                                                  infinity                                     
  reportQuantityCell SEQUENCE {                                                                                              
  rsrp                                                                          true                                         
  rsrq                                                                          false                                        
  sinr                                                                          false                                        
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  ----------------------------------------------------------------------------- ------------------ ------------------------- -----------

Table 8.1.3.1.8.3.3-4: *MeasurementReport* (step 1, Table
8.1.3.1.8.3.2-4)

  ---------------------------------------------------------------------------------------- ------------------------------------------- -------------------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                               
  Information Element                                                                      Value/remark                                Comment                    Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                
  criticalExtensions CHOICE {                                                                                                                                     
  measurementReport SEQUENCE {                                                                                                                                    
  measResults SEQUENCE {                                                                                                                                          
  measId                                                                                   1                                                                      
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                     Report NR Cell 1           
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1                    
  servCellId                                                                               ServCellIndex of NR Cell 1                                             
  measResultServingCell SEQUENCE {                                                                                                                                
  physCellId                                                                               Physical layer cell identity of NR Cell 1                              
  measResult SEQUENCE {                                                                                                                                           
  cellResults SEQUENCE {                                                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                                                      
  rsrp                                                                                     (0..127)                                                               
  rsrq                                                                                     (0..127)                                                               
  sinr                                                                                     Not present                                                            
                                                                                           Not checked                                                            pc\_ss\_SINR\_Meas
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  measResultNeighCells CHOICE {                                                                                                                                   
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                     Report NR neighbour cell   
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1                    
  physCellId                                                                               Physical layer cell identity of NR Cell 2                              
  measResult SEQUENCE {                                                                                                                                           
  cellResults SEQUENCE {                                                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                                                      
  rsrp                                                                                     (0..127)                                                               
  rsrq                                                                                     Not present                                                            
  sinr                                                                                     Not present                                                            
  }                                                                                                                                                               
  resultsCSI-RS-Cell                                                                       Not present                                                            
  }                                                                                                                                                               
  rsIndexResults                                                                           Not present                                                            
  }                                                                                                                                                               
  cgi-Info                                                                                 Not present                                                            
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  ---------------------------------------------------------------------------------------- ------------------------------------------- -------------------------- --------------------

##### 8.1.3.1.9 Measurement configuration control and reporting / Event A5 / Measurement of Neighbour NR cell / Inter-frequency measurements

##### 8.1.3.1.9.1 Test Purpose (TP) {#test-purpose-tp-41 .H6}

Same as test case 8.1.3.1.8 but applied to inter-frequency case.

##### 8.1.3.1.9.2 Conformance requirements {#conformance-requirements-41 .H6}

Same as test case 8.1.3.1.8 with the following difference:

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

##### 8.1.3.1.9.3 Test description {#test-description-41 .H6}

##### 8.1.3.1.9.3.1 Pre-test conditions {#pre-test-conditions-41 .H6}

Same as test case 8.1.3.1.8 with the following difference:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.
>
> \- System information combination: NR-4 repleaces NR-2.

##### 8.1.3.1.9.3.2 Test procedure sequence {#test-procedure-sequence-42 .H6}

Same as test case 8.1.3.1.8 with the following difference:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.3.1.9.3.3 Specific message contents {#specific-message-contents-33 .H6}

Same as test case 8.1.3.1.5 with the following difference:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

Table 8.1.3.1.9.3.3-1: *MeasConfig* (Table 8.1.3.1.8.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                           
  Information Element                                                                        Value/remark             Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                   
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                        
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                 
  measObjectId                                                                               1                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f1          Table 8.1.3.1.9.3.3-2   
  }                                                                                                                                           
  }                                                                                                                                           
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                  entry 2                 
  measObjectId                                                                               2                                                
  measObject CHOICE {                                                                                                                         
  measObjectNR                                                                               MeasObjectNR-f2          Table 8.1.3.1.9.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                          
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                 
  reportConfigId                                                                             1                                                
  reportConfig CHOICE {                                                                                                                       
  reportConfigNR                                                                             ReportConfigNR-EventA5   Table 8.1.3.1.8.3.3-3   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                          
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  measId                                                                                     1                                                
  measObjectId                                                                               2                                                
  reportConfigId                                                                             1                                                
  }                                                                                                                                           
  }                                                                                                                                           
  measGapConfig                                                                              MeasGapConfig                                    
  }                                                                                                                                           
  ------------------------------------------------------------------------------------------ ------------------------ ----------------------- -----------

Table 8.1.3.1.9.3.3-2: *MeasObjectNR-f1* (Table 8.1.3.1.9.3.3-1)

  ----------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[14\], Table 4.6.3-76                                                  
  Information Element                                   Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                           
  ssbFrequency                                          ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                       Not present                                    
  nrofSS-BlocksToAverage                                Not present                                    
  }                                                                                                    
  ----------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.9.3.3-3: *MeasObjectNR-f2* (Table 8.1.3.1.9.3.3-1)

  ----------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[14\], Table 4.6.3-76                                                  
  Information Element                                   Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                           
  ssbFrequency                                          ARFCN-ValueNR for SSB of NR Cell 3             
  absThreshSS-BlocksConsolidation                       Not present                                    
  nrofSS-BlocksToAverage                                Not present                                    
  }                                                                                                    
  ----------------------------------------------------- ------------------------------------ --------- -----------

##### 8.1.3.1.10 Measurement configuration control and reporting / Event A5 / Measurement of Neighbour NR cell / Inter-band measurements

##### 8.1.3.1.10.1 Test Purpose (TP) {#test-purpose-tp-42 .H6}

Same as test case 8.1.3.1.8 but applied to inter-band case.

##### 8.1.3.1.10.2 Conformance requirements {#conformance-requirements-42 .H6}

Same as test case 8.1.3.1.8 with the following difference:

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

##### 8.1.3.1.10.3 Test description {#test-description-42 .H6}

##### 8.1.3.1.10.3.1 Pre-test conditions {#pre-test-conditions-42 .H6}

Same as test case 8.1.3.1.8 with the following difference:

> \- Cells configuration: NR Cell 10 replaces NR Cell 2.
>
> \- System information combination: NR-4 repleaces NR-2.

##### 8.1.3.1.10.3.2 Test procedure sequence {#test-procedure-sequence-43 .H6}

Same as test case 8.1.3.1.8 with the following difference:

> \- Cells configuration: NR Cell 10 replaces NR Cell 2.

##### 8.1.3.1.10.3.3 Specific message contents {#specific-message-contents-34 .H6}

Same as test case 8.1.3.1.8 with the following difference:

> \- Cells configuration: NR Cell 10 replaces NR Cell 2.

Table 8.1.3.1.10.3.3-1: *MeasConfig* (Table 8.1.3.1.8.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------ ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                            
  Information Element                                                                        Value/remark             Comment                  Condition
  MeasConfig ::= SEQUENCE {                                                                                                                    
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                         
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                  
  measObjectId                                                                               1                                                 
  measObject CHOICE {                                                                                                                          
  measObjectNR                                                                               MeasObjectNR-f1          Table 8.1.3.1.10.3.3-2   
  }                                                                                                                                            
  }                                                                                                                                            
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                  entry 2                  
  measObjectId                                                                               2                                                 
  measObject CHOICE {                                                                                                                          
  measObjectNR                                                                               MeasObjectNR-f2          Table 8.1.3.1.10.3.3-3   
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                           
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                  
  reportConfigId                                                                             1                                                 
  reportConfig CHOICE {                                                                                                                        
  reportConfigNR                                                                             ReportConfigNR-EventA5   Table 8.1.3.1.8.3.3-3    
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                           
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                  
  measId                                                                                     1                                                 
  measObjectId                                                                               2                                                 
  reportConfigId                                                                             1                                                 
  }                                                                                                                                            
  }                                                                                                                                            
  measGapConfig                                                                              MeasGapConfig                                     
  }                                                                                                                                            
  ------------------------------------------------------------------------------------------ ------------------------ ------------------------ -----------

Table 8.1.3.1.10.3.3-2: *MeasObjectNR-f1* (Table 8.1.3.1.10.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.10.3.3-3: *MeasObjectNR-f2* (Table 8.1.3.1.10.3.3-1)

  ---------------------------------------------------- ------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                   
  Information Element                                  Value/remark                          Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                           
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 10             
  absThreshSS-BlocksConsolidation                      Not present                                     
  nrofSS-BlocksToAverage                               Not present                                     
  }                                                                                                    
  ---------------------------------------------------- ------------------------------------- --------- -----------

##### 8.1.3.1.11 Measurement configuration control and reporting / Intra NR measurements / Two simultaneous events A3 (intra and inter-frequency measurements) / RSRQ based measurements

##### 8.1.3.1.11.1 Test Purpose (TP) {#test-purpose-tp-43 .H6}

##### (1) {#section-76 .H6}

**with** { UE in NR RRC\_CONNECTED state, measurements configured for
two event A3 at the same time **and** *triggerQuantity* set to *rsrq* }

**ensure that** {

**when** { Entry condition for event A3 is not met }

**then** { UE does not send *MeasurementReport* }

}

##### (2) {#section-77 .H6}

**with** { UE in NR RRC\_CONNECTED state, measurements configured for
two event A3 at the same time **and** *triggerQuantity* set to *rsrq* }

**ensure that** {

**when** { Neighbour becomes offset better than serving }

**then** { UE sends *MeasurementReport* with correct *measId* for event
A3 }

}

##### 8.1.3.1.11.2 Conformance requirements {#conformance-requirements-43 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clause 5.3.5.3, 5.5.2.1, 5.5.2.9, 5.5.4.1,
5.5.4.4 and 5.5.5.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

\[TS 38.331, clause 5.5.2.1\]

The UE shall:

> ...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

> 2\> perform the measurement object addition/modification procedure as
> specified in 5.5.2.5;
>
> ...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

> 2\> perform the reporting configuration addition/modification
> procedure as specified in 5.5.2.7;

1\> if the received *measConfig* includes the *quantityConfig*:

> 2\> perform the quantity configuration procedure as specified in
> 5.5.2.8;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

...

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to setup:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

> \- SFN mod *T* = FLOOR(*gapOffset*/10);
>
> \- subframe = *gapOffset* mod 10;
>
> \- with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

\[TS 38.331, clause 5.5.4.1\]

If security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig*includes a *reportType* set to
*eventTriggered* or *periodical*;

> 3\> if the corresponding *measObject* concerns NR;

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

...

4\> else:

5\> for events involving a serving cell associated with a *measObjectNR*
and neighbours associated with another *measObjectNR*, consider any
serving cell associated with the other *measObjectNR* to be a
neighbouring cell as well;

5\> if *useAllowedCellList* is set to TRUE:

...

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR*to be applicable when the concerned cell is not
included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this measId;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

> 3\> include a measurement reporting entry within the
> *VarMeasReportList* for this *measId*;
>
> 3\> set the *numberOfReportsSent* defined within the
> *VarMeasReportList* for this *measId* to 0;
>
> 3\> include the concerned cell(s) in the *cellsTriggeredList* defined
> within the *VarMeasReportList* for this *measId*;
>
> 3\> initiate the measurement reporting procedure, as specified in
> 5.5.5;

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

> 3\> set the *numberOfReportsSent* defined within the
> *VarMeasReportList* for this *measId* to 0;
>
> 3\> include the concerned cell(s) in the *cellsTriggeredList* defined
> within the *VarMeasReportList* for this *measId*;
>
> 3\> initiate the measurement reporting procedure, as specified in
> 5.5.5;

2\> if the *reportType* is set to *eventTriggered* and if the leaving
condition applicable for this event is fulfilled for one or more of the
cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

> 3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
> within the *VarMeasReportList* for this *measId*;
>
> ...3\> if the *cellsTriggeredList* defined within the
> *VarMeasReportList* for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

...

\[TS 38.331, clause 5.5.4.4\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A3-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A3-2, as specified below, is fulfilled;

1\> use the SpCell for *Mp*, *Ofp and Ocp*.

NOTE The cell(s) that triggers the event has reference signals indicated
in the *measObjectNR* associated to this event which may be different
from the NR SpCell *measObjectNR*.

Inequality A3-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Mp + Ofp + Ocp + Off*

Inequality A3-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Mp + Ofp + Ocp + Off*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the reference
signal of the neighbour cell (i.e. *offsetMO* as defined within
*measObjectNR* corresponding to the neighbour cell).

***Ocn*** is the cell specific offset of the neighbour cell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the frequency of the neighbour cell), and set to zero if not configured
for the neighbour cell.

***Mp*** is the measurement result of the SpCell, not taking into
account any offsets.

***Ofp*** is the measurement object specific offset of the SpCell (i.e.
*offsetMO* as defined within *measObjectNR* corresponding to the
SpCell).

***Ocp*** is the cell specific offset of the SpCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the SpCell), and is set to zero if not configured for the SpCell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Off*** is the offset parameter for this event (i.e. *a3-Offset* as
defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn***, ***Ocn***, ***Ofp***, ***Ocp***, ***Hys***, ***Off*** are
expressed in dB.

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR for each configured serving
cell derived based on the *rsType* indicated in the associated
*reportConfig*;

> 1\> set the *measResultServingCell* within *measResultServingMOList*
> to include for each NR serving cell that is configured with
> *servingCellMO*, if any, the *servCellId*;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

> ...
>
> 1\> if the UE is configured with EN-DC:
>
> ...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.11.3 Test description {#test-description-43 .H6}

##### 8.1.3.1.11.3.1 Pre-test conditions {#pre-test-conditions-43 .H6}

##### System Simulator: {#system-simulator-31 .H6}

\- NR Cell 1 is the serving cell, NR Cell 2 is the intra-frequency
neighbour cell, and NR Cell 3 is the inter-frequency neighbour cell.

\- NR Cell 1 NR Cell 2 and NR Cell3 are configured to operate in FR1
bands as defined in TS 38.508-1 \[4\] clause 6.2.3.

\- System information combination NR-5 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-28 .H6}

\- None.

##### Preamble: {#preamble-30 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.3.1.11.3.2 Test procedure sequence {#test-procedure-sequence-44 .H6}

Table 8.1.3.1.11.3.2-1 illustrate the downlink power levels to be
applied for NR Cell 1, NR Cell 2 and NR Cell 3 at various time instants
of the test execution for FR1. Row marked \"T0\" denotes the conditions
after the preamble, while rows marked \"T1\"and \"T2\" are to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.3.1.11.3.2-1: Time instances of cell power level and parameter
changes in FR1

+---------+---------+---------+---------+---------+---------+---------+
|         | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|         | rameter |         | 1       | 2       | 3       |         |
+=========+=========+=========+=========+=========+=========+=========+
| T0      | SS/PBCH | dBm/SCS | -88     | -100    | \"Off\" | Power   |
|         |         |         |         |         |         | levels  |
|         | SSS     |         |         |         |         | are     |
|         | EPRE    |         |         |         |         | such    |
|         |         |         |         |         |         | that    |
|         |         |         |         |         |         | entry   |
|         |         |         |         |         |         | co      |
|         |         |         |         |         |         | ndition |
|         |         |         |         |         |         | for     |
|         |         |         |         |         |         | event   |
|         |         |         |         |         |         | A3      |
|         |         |         |         |         |         | (*      |
|         |         |         |         |         |         | measId* |
|         |         |         |         |         |         | 1 & 2)  |
|         |         |         |         |         |         | is not  |
|         |         |         |         |         |         | satisf  |
|         |         |         |         |         |         | ied:*Mn |
|         |         |         |         |         |         | + Ofn + |
|         |         |         |         |         |         | Ocn --  |
|         |         |         |         |         |         | Hys \<  |
|         |         |         |         |         |         | Mp +    |
|         |         |         |         |         |         | Ofp +   |
|         |         |         |         |         |         | Ocp +   |
|         |         |         |         |         |         | Off*    |
+---------+---------+---------+---------+---------+---------+---------+
|         | SS-RSRQ | dB      | -11.74  | -17.74  | \-      |         |
+---------+---------+---------+---------+---------+---------+---------+
|         | Noc     | dBm/SCS | -94     | \-      |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| T1      | SS/PBCH | dBm/SCS | -88     | -88     | \"Off\" | Power   |
|         |         |         |         |         |         | levels  |
|         | SSS     |         |         |         |         | are     |
|         | EPRE    |         |         |         |         | such    |
|         |         |         |         |         |         | that    |
|         |         |         |         |         |         | entry   |
|         |         |         |         |         |         | co      |
|         |         |         |         |         |         | ndition |
|         |         |         |         |         |         | for     |
|         |         |         |         |         |         | event   |
|         |         |         |         |         |         | A3      |
|         |         |         |         |         |         | (*      |
|         |         |         |         |         |         | measId* |
|         |         |         |         |         |         | 1) is   |
|         |         |         |         |         |         | sat     |
|         |         |         |         |         |         | isfied: |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         | *Mn +   |
|         |         |         |         |         |         | Ofn +   |
|         |         |         |         |         |         | Ocn --  |
|         |         |         |         |         |         | Hys \>  |
|         |         |         |         |         |         | Mp +    |
|         |         |         |         |         |         | Ofp +   |
|         |         |         |         |         |         | Ocp +   |
|         |         |         |         |         |         | Off*    |
+---------+---------+---------+---------+---------+---------+---------+
|         | SS-RSRQ | dB      | -11.74  | -11.74  | \-      |         |
+---------+---------+---------+---------+---------+---------+---------+
|         | Noc     | dBm/SCS | -94     | \-      |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| T2      | SS/PBCH | dBm/SCS | -88     | \"Off\" | -88     | Power   |
|         |         |         |         |         |         | levels  |
|         | SSS     |         |         |         |         | are     |
|         | EPRE    |         |         |         |         | such    |
|         |         |         |         |         |         | that    |
|         |         |         |         |         |         | entry   |
|         |         |         |         |         |         | co      |
|         |         |         |         |         |         | ndition |
|         |         |         |         |         |         | for     |
|         |         |         |         |         |         | event   |
|         |         |         |         |         |         | A3      |
|         |         |         |         |         |         | (*      |
|         |         |         |         |         |         | measId* |
|         |         |         |         |         |         | 2) is   |
|         |         |         |         |         |         | sat     |
|         |         |         |         |         |         | isfied: |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         | *Mn +   |
|         |         |         |         |         |         | Ofn +   |
|         |         |         |         |         |         | Ocn --  |
|         |         |         |         |         |         | Hys \>  |
|         |         |         |         |         |         | Mp +    |
|         |         |         |         |         |         | Ofp +   |
|         |         |         |         |         |         | Ocp +   |
|         |         |         |         |         |         | Off*    |
+---------+---------+---------+---------+---------+---------+---------+
|         | SS-RSRQ | dB      | -11.74  | \-      | -11.74  |         |
+---------+---------+---------+---------+---------+---------+---------+
|         | Noc     | dBm/SCS | -94     | -94     |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| NOTE 1: |         |         |         |         |         |         |
| The     |         |         |         |         |         |         |
| total   |         |         |         |         |         |         |
| to      |         |         |         |         |         |         |
| lerance |         |         |         |         |         |         |
| used is |         |         |         |         |         |         |
| the sum |         |         |         |         |         |         |
| of      |         |         |         |         |         |         |
| d       |         |         |         |         |         |         |
| ownlink |         |         |         |         |         |         |
| signal  |         |         |         |         |         |         |
| level   |         |         |         |         |         |         |
| unce    |         |         |         |         |         |         |
| rtainty |         |         |         |         |         |         |
| (TS     |         |         |         |         |         |         |
| 3       |         |         |         |         |         |         |
| 8.508-1 |         |         |         |         |         |         |
| Table   |         |         |         |         |         |         |
| 6.2     |         |         |         |         |         |         |
| .2.1-4) |         |         |         |         |         |         |
| and     |         |         |         |         |         |         |
| a       |         |         |         |         |         |         |
| bsolute |         |         |         |         |         |         |
| UE      |         |         |         |         |         |         |
| meas    |         |         |         |         |         |         |
| urement |         |         |         |         |         |         |
| a       |         |         |         |         |         |         |
| ccuracy |         |         |         |         |         |         |
| (TS     |         |         |         |         |         |         |
| 38.133  |         |         |         |         |         |         |
| clause  |         |         |         |         |         |         |
| 10).    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.3.1.11.3.2-2: Void

Table 8.1.3.1.11.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                                                          Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                          U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message on NR Cell 1 including *MeasConfig* to setup NR measurement and reporting for two event A3 (*measId* 1 and *measId* 2) (intra and inter frequency measurement).   \<\--              NR RRC*: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1.                                                                                                                                             \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 within the next 10s?                                                                                                                        \--\>              NR RRC: *MeasurementReport*            1         F
  4    The SS re-adjusts the cell-specific reference signal level according to row \"T1\" in Table 8.1.3.1.11.3.2-1.                                                                                                      \-                 \-                                     \-        \-
  5    Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 to report event A3 (*measId* 1) with the measured RSRP and RSRQ values for NR Cell 2?                                                       \--\>              NR RRC: *MeasurementReport*            2         P
  6    The SS re-adjusts the cell-specific reference signal level according to row \"T2\" in Table 8.1.3.1.11.3.2-1.                                                                                                      \-                 \-                                     \-        \-
  7    Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 to report event A3 (*measId* 2) with the measured RSRP and RSRQ values for NR Cell 3?                                                       \--\>              NR RRC: *MeasurementReport*            2         P

##### 8.1.3.1.11.3.3 Specific message contents {#specific-message-contents-35 .H6}

Table 8.1.3.1.11.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.11.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.11.3.3-2: *MeasConfig* (step 1, Table 8.1.3.1.11.3.2-3)

  Derivation Path: TS 38.508-1\[4\] table 4.6.3-69                                                                                        
  ------------------------------------------------------------------------------------------ ------------------- ------------------------ -----------
  Information Element                                                                        Value/Remark        Comment                  Condition
  MeasConfig ::= SEQUENCE {                                                                                                               
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                    
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                             entry 1                  
  measObjectId                                                                               1                                            
  measObject CHOICE {                                                                                                                     
  measObjectNR                                                                               MeasObjectNR-f1     Table 8.1.3.1.11.3.3-3   
  }                                                                                                                                       
  }                                                                                                                                       
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                             entry 2                  
  measObjectId                                                                               2                                            
  measObject CHOICE {                                                                                                                     
  measObjectNR                                                                               MeasObjectNR-f2     Table 8.1.3.1.11.3.3-4   
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                      
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                           entry 1                  
  reportConfigId                                                                             ReportConfigId                               
  reportConfig CHOICE {                                                                                                                   
  reportConfigNR                                                                             ReportConfigNR-A3   Table 8.1.3.1.11.3.3-5   
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  2 entries                                    
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                 entry 1                  
  measId                                                                                     1                                            
  measObjectId                                                                               1                                            
  reportConfigId                                                                             ReportConfigId                               
  }                                                                                                                                       
  MeasIdToAddMod\[2\] SEQUENCE {                                                                                 entry 2                  
  measId                                                                                     2                                            
  measObjectId                                                                               2                                            
  reportConfigId                                                                             ReportConfigId                               
  }                                                                                                                                       
  }                                                                                                                                       
  measGapConfig                                                                              MeasGapConfig                                
  }                                                                                                                                       

Table 8.1.3.1.11.3.3-3: *MeasObjectNR*-f1 (Table 8.1.3.1.11.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                               
  ---------------------------------------------------- --------------------------------- --------- -----------
  Information Element                                  Value/remark                      Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                       
  ssbFrequency                                         Downlink ARFCN of NR Cell 1 SSB             
  absThreshSS-BlocksConsolidation                      Not present                                 
  }                                                                                                

Table 8.1.3.1.11.3.3-4: *MeasObjectNR*-f2 (Table 8.1.3.1.11.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                               
  ---------------------------------------------------- --------------------------------- --------- -----------
  Information Element                                  Value/remark                      Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                       
  ssbFrequency                                         Downlink ARFCN of NR Cell 3 SSB             
  absThreshSS-BlocksConsolidation                      Not present                                 
  }                                                                                                

Table 8.1.3.1.11.3.3-5: *ReportConfigNR-A3* (Table 8.1.3.1.11.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.3-142 with condition EVENT\_A3                                        
  ----------------------------------------------------------------------------- -------------- --------------------- -----------
  Information Element                                                           Value/remark   Comment               Condition
  ReportConfigNR::= SEQUENCE {                                                                                       
  reportType CHOICE {                                                                                                
  eventTriggered SEQUENCE {                                                                                          
  eventId CHOICE {                                                                                                   
  eventA3 SEQUENCE {                                                                                                 
  a3-Offset CHOICE {                                                                                                 
  rsrq                                                                          -6             Actual value = -3dB   
  }                                                                                                                  
  hysteresis                                                                    0              Actual value = 0dB    
  }                                                                                                                  
  }                                                                                                                  
  reportAmount                                                                  r1                                   
  }                                                                                                                  
  }                                                                                                                  
  }                                                                                                                  

Table 8.1.3.1.11.3.3-6: Void

Table 8.1.3.1.11.3.3-7: *MeasurementReport* (steps 5 and 7, Table
8.1.3.1.11.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] , table 4.6.1-5A                                                                             
  ---------------------------------------------------------------------------------------- ---------------------------- --------- --------------------
  Information Element                                                                      Value/remark                 Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                
  criticalExtensions CHOICE {                                                                                                     
  measurementReport SEQUENCE {                                                                                                    
  measResults SEQUENCE {                                                                                                          
  measId                                                                                   1                                      Step 5
                                                                                           2                                      Step 7
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                Step 5
  MeasResultServMO\[1\] SEQUENCE {                                                                                      entry 1   
  servCellId                                                                               ServCellIndex of NR Cell 1             
  measResultServingCell SEQUENCE {                                                                                                
  physCellId                                                                               PhysCellId of NR Cell 1                
  measResult SEQUENCE {                                                                                                           
  cellResults SEQUENCE {                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                      
  rsrp                                                                                     (0..127)                               
  rsrq                                                                                     (0..127)                               
  sinr                                                                                     (0..127)                               pc\_ss\_SINR\_Meas
                                                                                           Not present                            
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  measResultNeighCells CHOICE {                                                                                                   
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                    1 entry                                
  MeasResultNR\[1\] SEQUENCE {                                                                                          entry 1   
  physCellId                                                                               PhysCellId of NR Cell 2                Step 5
                                                                                           PhysCellId of NR Cell 3                Step 7
  measResult SEQUENCE {                                                                                                           
  cellResults SEQUENCE {                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                      
  rsrp                                                                                     (0..127)                               
  rsrq                                                                                     (0..127)                               
  sinr                                                                                     (0..127)                               pc\_ss\_SINR\_Meas
                                                                                           Not present                            
  }                                                                                                                               
  resultsCSI-RS-Cell                                                                       Not present                            
  }                                                                                                                               
  rsIndexResults                                                                           Not present                            
  }                                                                                                                               
  cgi-Info                                                                                 Not present                            
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               

##### 8.1.3.1.12 Measurement configuration control and reporting / Intra NR measurements / Two simultaneous events A5 (intra and inter-frequency measurements) / SINR based measurements

##### 8.1.3.1.12.1 Test Purpose (TP) {#test-purpose-tp-44 .H6}

##### (1) {#section-78 .H6}

**with** { UE in NR RRC\_CONNECTED state, measurements configured for
two event A5 at the same time **and** *triggerQuantity* set to *sinr* }

**ensure that** {

**when** { Entry condition for event A5 is not met }

**then** { UE does not send *MeasurementReport* }

}

##### (2) {#section-79 .H6}

**with** { UE in NR RRC\_CONNECTED state, measurements configured for
two event A5 at the same time **and** *triggerQuantity* set to *sinr* }

**ensure that** {

**when** { SpCell becomes worse than threshold1 and neighbour becomes
better than threshold2 }

**then** { UE sends *MeasurementReport* with correct *measId* for event
A5 }

}

##### 8.1.3.1.12.2 Conformance requirements {#conformance-requirements-44 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clause 5.3.5.3, 5.5.2.1, 5.5.2.9, 5.5.4.1,
5.5.4.4 and 5.5.5.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

\[TS 38.331, clause 5.5.2.1\]

The UE shall:

> ...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

> 2\> perform the measurement object addition/modification procedure as
> specified in 5.5.2.5;
>
> ...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

> 2\> perform the reporting configuration addition/modification
> procedure as specified in 5.5.2.7;

1\> if the received *measConfig* includes the *quantityConfig*:

> 2\> perform the quantity configuration procedure as specified in
> 5.5.2.8;
>
> ...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

...

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to setup:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

\[TS 38.331, clause 5.5.4.1\]

If security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig*includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

...

4\> else:

5\> for events involving a serving cell associated with a *measObjectNR*
and neighbours associated with another *measObjectNR*, consider any
serving cell associated with the other *measObjectNR* to be a
neighbouring cell as well;

5\> if *useAllowedCellList* is set to TRUE:

...

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR*to be applicable when the concerned cell is not
included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this measId;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> if the *reportType* is set to *eventTriggered* and if the leaving
condition applicable for this event is fulfilled for one or more of the
cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

> ...

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

...

\[TS 38.331, clause 5.5.4.4\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition A5-1 and condition A5-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A5-3 or condition A5-4, i.e. at least one of the two, as
specified below, is fulfilled;

1\> use the SpCell for *Mp*.

NOTE: The parameters of the reference signal(s) of the cell(s) that
triggers the event are indicated in the *measObjectNR* associated to the
event which may be different from the *measObjectNR* of the NR SpCell.

Inequality A5-1 (Entering condition 1)

*Mp + Hys \< Thresh1*

Inequality A5-2 (Entering condition 2)

*Mn + Ofn + Ocn -- Hys \> Thresh2*

Inequality A5-3 (Leaving condition 1)

*Mp -- Hys \> Thresh1*

Inequality A5-4 (Leaving condition 2)

*Mn + Ofn + Ocn + Hys \< Thresh2*

The variables in the formula are defined as follows:

***Mp*** is the measurement result of the NR SpCell, not taking into
account any offsets.

***Mn*** is the measurement result of the neighbouring cell/SCell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the
neighbour/SCell cell (i.e. *offsetMO* as defined within *measObjectNR*
corresponding to the neighbour cell/SCell).

***Ocn*** is the cell specific offset of the neighbour cell/SCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the neighbour cell/SCell), and set to zero if not configured for the
neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Thresh1*** is the threshold parameter for this event (i.e.
*a5-Threshold1* as defined within *reportConfigNR* for this event).

***Thresh2*** is the threshold parameter for this event (i.e.
*a5-Threshold2* as defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh1***is expressed in the same unit as ***Mp***.

***Thresh2*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR for each configured serving
cell derived based on the *rsType* indicated in the associated
*reportConfig*;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include for each NR serving cell that is configured with
*servingCellMO*, if any, the *servCellId*;

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

\...

2\> if the UE is configured with EN-DC:

\...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.12.3 Test description {#test-description-44 .H6}

##### 8.1.3.1.12.3.1 Pre-test conditions {#pre-test-conditions-44 .H6}

##### System Simulator: {#system-simulator-32 .H6}

\- NR Cell 1 is the serving cell, NR Cell 2 is the intra-frequency
neighbour cell, and NR Cell 3 is the inter-frequency neighbour cell.

\- NR Cell 1 NR Cell 2 and NR Cell3 are configured to operate in FR1
bands as defined in TS 38.508-1 \[4\] clause 6.2.3.

\- System information combination NR-5 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-29 .H6}

\- None.

##### Preamble: {#preamble-31 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.3.1.12.3.2 Test procedure sequence {#test-procedure-sequence-45 .H6}

Table 8.1.3.1.12.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1, NR Cell 2 and NR Cell 3 at various time instants
of the test execution for FR1. Row marked \"T0\" denotes the conditions
after the preamble, while rows marked \"T1\"and \"T2\" are to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.3.1.12.3.2-1: Time instances of cell power level and parameter
changes in FR1

+---------+---------+---------+---------+---------+---------+---------+
|         | **Para  | *       | **NR    | **NR    | **NR    | **R     |
|         | meter** | *Unit** | Cell    | Cell    | Cell    | emark** |
|         |         |         | 1**     | 2**     | 3**     |         |
+=========+=========+=========+=========+=========+=========+=========+
| T0      | SS/PBCH | dBm/SCS | -82     | -99     | \"Off\" | Power   |
|         |         |         |         |         |         | levels  |
|         | SSS     |         |         |         |         | are     |
|         | EPRE    |         |         |         |         | such    |
|         |         |         |         |         |         | that    |
|         |         |         |         |         |         | either  |
|         |         |         |         |         |         | one     |
|         |         |         |         |         |         | entry   |
|         |         |         |         |         |         | co      |
|         |         |         |         |         |         | ndition |
|         |         |         |         |         |         | for     |
|         |         |         |         |         |         | event   |
|         |         |         |         |         |         | A5      |
|         |         |         |         |         |         | (*      |
|         |         |         |         |         |         | measId* |
|         |         |         |         |         |         | 1 & 2)  |
|         |         |         |         |         |         | is not  |
|         |         |         |         |         |         | sat     |
|         |         |         |         |         |         | isfied: |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         | *Mp     |
|         |         |         |         |         |         | +Hys \> |
|         |         |         |         |         |         | T       |
|         |         |         |         |         |         | hresh1* |
|         |         |         |         |         |         | or *Mn  |
|         |         |         |         |         |         | + Ofn + |
|         |         |         |         |         |         | Ocn --  |
|         |         |         |         |         |         | Hys \<  |
|         |         |         |         |         |         | T       |
|         |         |         |         |         |         | hresh2* |
+---------+---------+---------+---------+---------+---------+---------+
|         | SINR    | dB      | 17      | 0       | \-      |         |
+---------+---------+---------+---------+---------+---------+---------+
|         | Noc     | dBm/SCS | -99     | -94     |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| T1      | SS/PBCH | dBm/SCS | -88     | -94     | \"Off\" | Power   |
|         |         |         |         |         |         | levels  |
|         | SSS     |         |         |         |         | are     |
|         | EPRE    |         |         |         |         | such    |
|         |         |         |         |         |         | that    |
|         |         |         |         |         |         | both    |
|         |         |         |         |         |         | entry   |
|         |         |         |         |         |         | con     |
|         |         |         |         |         |         | ditions |
|         |         |         |         |         |         | for     |
|         |         |         |         |         |         | event   |
|         |         |         |         |         |         | A5      |
|         |         |         |         |         |         | (*      |
|         |         |         |         |         |         | measId* |
|         |         |         |         |         |         | 1) is   |
|         |         |         |         |         |         | sat     |
|         |         |         |         |         |         | isfied: |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         | *Mp +   |
|         |         |         |         |         |         | Hys \<  |
|         |         |         |         |         |         | T       |
|         |         |         |         |         |         | hresh1* |
|         |         |         |         |         |         | and *Mn |
|         |         |         |         |         |         | + Ofn + |
|         |         |         |         |         |         | Ocn --  |
|         |         |         |         |         |         | Hys \>  |
|         |         |         |         |         |         | T       |
|         |         |         |         |         |         | hresh2* |
+---------+---------+---------+---------+---------+---------+---------+
|         | SINR    | dB      | 11      | 5       | \-      |         |
+---------+---------+---------+---------+---------+---------+---------+
|         | Noc     | dBm/SCS | -99     | -94     |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| T2      | SS/PBCH | dBm/SCS | -88     | \"Off\" | -94     | Power   |
|         |         |         |         |         |         | levels  |
|         | SSS     |         |         |         |         | are     |
|         | EPRE    |         |         |         |         | such    |
|         |         |         |         |         |         | that    |
|         |         |         |         |         |         | both    |
|         |         |         |         |         |         | entry   |
|         |         |         |         |         |         | con     |
|         |         |         |         |         |         | ditions |
|         |         |         |         |         |         | for     |
|         |         |         |         |         |         | event   |
|         |         |         |         |         |         | A5      |
|         |         |         |         |         |         | (*      |
|         |         |         |         |         |         | measId* |
|         |         |         |         |         |         | 2) is   |
|         |         |         |         |         |         | sat     |
|         |         |         |         |         |         | isfied: |
|         |         |         |         |         |         |         |
|         |         |         |         |         |         | *Mp +   |
|         |         |         |         |         |         | Hys \<  |
|         |         |         |         |         |         | T       |
|         |         |         |         |         |         | hresh1* |
|         |         |         |         |         |         | and *Mn |
|         |         |         |         |         |         | + Ofn + |
|         |         |         |         |         |         | Ocn --  |
|         |         |         |         |         |         | Hys \>  |
|         |         |         |         |         |         | T       |
|         |         |         |         |         |         | hresh2* |
+---------+---------+---------+---------+---------+---------+---------+
|         | SINR    | dB      | 11      | \-      | 11      |         |
+---------+---------+---------+---------+---------+---------+---------+
|         | Noc     | dBm/SCS | -99     | -99     |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| NOTE 1: |         |         |         |         |         |         |
| The     |         |         |         |         |         |         |
| total   |         |         |         |         |         |         |
| to      |         |         |         |         |         |         |
| lerance |         |         |         |         |         |         |
| used is |         |         |         |         |         |         |
| the sum |         |         |         |         |         |         |
| of      |         |         |         |         |         |         |
| d       |         |         |         |         |         |         |
| ownlink |         |         |         |         |         |         |
| signal  |         |         |         |         |         |         |
| level   |         |         |         |         |         |         |
| unce    |         |         |         |         |         |         |
| rtainty |         |         |         |         |         |         |
| (TS     |         |         |         |         |         |         |
| 3       |         |         |         |         |         |         |
| 8.508-1 |         |         |         |         |         |         |
| Table   |         |         |         |         |         |         |
| 6.2     |         |         |         |         |         |         |
| .2.1-4) |         |         |         |         |         |         |
| and     |         |         |         |         |         |         |
| a       |         |         |         |         |         |         |
| bsolute |         |         |         |         |         |         |
| UE      |         |         |         |         |         |         |
| meas    |         |         |         |         |         |         |
| urement |         |         |         |         |         |         |
| a       |         |         |         |         |         |         |
| ccuracy |         |         |         |         |         |         |
| (TS     |         |         |         |         |         |         |
| 38.133  |         |         |         |         |         |         |
| clause  |         |         |         |         |         |         |
| 10).    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.3.1.12.3.2-2: Void

Table 8.1.3.1.12.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                                                          Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                          U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message on NR Cell 1 including *MeasConfig* to setup NR measurement and reporting for two event A5 (*measId* 1 and *measId* 2) (intra and inter frequency measurement).   \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1.                                                                                                                                             \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 within the next 10s?                                                                                                                        \--\>              NR RRC: *MeasurementReport*            1         F
  4    The SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.1.12.3.2-1.                                                                                                      \-                 \-                                     \-        \-
  5    Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 to report event A3 (*measId* 1) with the measured SINR values for NR Cell 2?                                                                \--\>              NR RRC: *MeasurementReport*            2         P
  6    The SS re-adjusts the cell-specific reference signal level according to row \"T2\" in table 8.1.3.1.12.3.2-1.                                                                                                      \-                 \-                                     \-        \-
  7    Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 to report event A5 (*measId* 2) with the measured SINR values for NR Cell 3?                                                                \--\>              NR RRC: *MeasurementReport*            2         P

##### 8.1.3.1.12.3.3 Specific message contents {#specific-message-contents-36 .H6}

Table 8.1.3.1.12.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.12.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.12.3.3-2: *MeasConfig* (step 1, Table 8.1.3.1.12.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.3-69                                                                                        
  ------------------------------------------------------------------------------------------ ------------------- ------------------------- -----------
  Information Element                                                                        Value/Remark        Comment                   Condition
  MeasConfig ::= SEQUENCE {                                                                                                                
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                     
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                             entry 1                   
  measObjectId                                                                               1                                             
  measObject CHOICE {                                                                                                                      
  measObjectNR                                                                               MeasObjectNR-f1     Table 8.1.3.1.12.3.3-3    
  }                                                                                                                                        
  }                                                                                                                                        
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                             entry 2                   
  measObjectId                                                                               2                                             
  measObject CHOICE {                                                                                                                      
  measObjectNR                                                                               MeasObjectNR-f2     Table 8.1.3.1.12.3.3-3A   
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                       
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                           entry 1                   
  reportConfigId                                                                             ReportConfigId                                
  reportConfig CHOICE {                                                                                                                    
  reportConfigNR                                                                             ReportConfigNR-A5   Table 8.1.3.1.12.3.3-5    
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  2 entries                                     
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                 entry 1                   
  measId                                                                                     1                                             
  measObjectId                                                                               1                                             
  reportConfigId                                                                             ReportConfigId                                
  }                                                                                                                                        
  MeasIdToAddMod\[2\] SEQUENCE {                                                                                 entry 2                   
  measId                                                                                     2                                             
  measObjectId                                                                               2                                             
  reportConfigId                                                                             ReportConfigId                                
  }                                                                                                                                        
  }                                                                                                                                        
  measGapConfig                                                                              MeasGapConfig                                 
  }                                                                                                                                        

Table 8.1.3.1.12.3.3-3: *MeasObjectNR*-f1 (Table 8.1.3.1.12.3.3-2)

  ---------------------------------------------------- --------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                               
  Information Element                                  Value/remark                      Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                       
  ssbFrequency                                         Downlink ARFCN of NR Cell 1 SSB             
  absThreshSS-BlocksConsolidation                      Not present                                 
  }                                                                                                
  ---------------------------------------------------- --------------------------------- --------- -----------

Table 8.1.3.1.12.3.3-3A: *MeasObjectNR*-f2 (Table 8.1.3.1.12.3.3-2)

  ----------------------------------------------------- --------------------------------- --------- -----------
  Derivation Path: TS 38. 508-1 \[4\], Table 4.6.3-76                                               
  Information Element                                   Value/remark                      Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                        
  ssbFrequency                                          Downlink ARFCN of NR Cell 3 SSB             
  absThreshSS-BlocksConsolidation                       Not present                                 
  }                                                                                                 
  ----------------------------------------------------- --------------------------------- --------- -----------

Table 8.1.3.1.12.3.3-4: Void

Table 8.1.3.1.12.3.3-5: *ReportConfigNR-A5* (Table 8.1.3.1.12.3.3-2)

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] table 4.6.3-142 with condition EVENT\_A5                            
  Information Element                                                           Value/remark   Comment   Condition
  ReportConfigNR::= SEQUENCE {                                                                           
  reportType CHOICE {                                                                                    
  eventTriggered SEQUENCE {                                                                              
  eventId CHOICE {                                                                                       
  eventA5 SEQUENCE {                                                                                     
  a5-Threshold1 CHOICE {                                                                                 
  sinr                                                                          74             14 dB     
  }                                                                                                      
  a5-Threshold2 CHOICE {                                                                                 
  sinr                                                                          47             0.5 dB    
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  reportQuantityCell SEQUENCE {                                                                          
  rsrp                                                                          false                    
  rsrq                                                                          false                    
  sinr                                                                          true                     
  }                                                                                                      
  reportAmount                                                                  r1                       
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.3.1.12.3.3-6: *MeasurementReport* (steps 5 and 7, Table
8.1.3.1.12.3.2-3)

  ---------------------------------------------------------------------------------------- ---------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-5A                                                                              
  Information Element                                                                      Value/remark                 Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                
  criticalExtensions CHOICE {                                                                                                     
  measurementReport SEQUENCE {                                                                                                    
  measResults SEQUENCE {                                                                                                          
  measId                                                                                   1                                      Step 5
                                                                                           2                                      Step 7
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                Step 5
  MeasResultServMO\[1\] SEQUENCE {                                                                                      entry 1   
  servCellId                                                                               ServCellIndex of NR Cell 1             
  measResultServingCell SEQUENCE {                                                                                                
  physCellId                                                                               PhysCellId of NR Cell 1                
  measResult SEQUENCE {                                                                                                           
  cellResults SEQUENCE {                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                      
  rsrp                                                                                     (0..127)                               
  rsrq                                                                                     (0..127)                               
  sinr                                                                                     (0..127)                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  measResultNeighCells CHOICE {                                                                                                   
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                    1 entry                                
  MeasResultNR\[1\] SEQUENCE {                                                                                          entry 1   
  physCellId                                                                               PhysCellId of NR Cell 2                Step 5
                                                                                           PhysCellId of NR Cell 3                Step 7
  measResult SEQUENCE {                                                                                                           
  cellResults SEQUENCE {                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                      
  rsrp                                                                                     Not Present                            
  rsrq                                                                                     Not Present                            
  sinr                                                                                     (0..127)                               
  }                                                                                                                               
  resultsCSI-RS-Cell                                                                       Not present                            
  }                                                                                                                               
  rsIndexResults                                                                           Not present                            
  }                                                                                                                               
  cgi-Info                                                                                 Not present                            
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  ---------------------------------------------------------------------------------------- ---------------------------- --------- -----------

##### 8.1.3.1.13 Measurement configuration control and reporting / SS/PBCH block based / CSI-RS based intra-frequency measurements / Measurement of Neighbour NR cell

##### 8.1.3.1.13.1 Test Purpose (TP) {#test-purpose-tp-45 .H6}

##### (1) {#section-80 .H6}

**with** { UE in NR RRC\_CONNECTED state and measurement configured for
SS/PBCH measurement reporting of intra-frequency on specified frequency}

**ensure that** {

**when** { SS/PBCH block sorting quantity is above
absThreshSS-BlocksConsolidation for each beam of Neighbour Cell}

**then** { UE sends MeasurementReport message containing rsIndexResults
with resultsSSB-Indexes}

}

##### (2) {#section-81 .H6}

**with** { UE in NR RRC\_CONNECTED state and measurement configured for
SS/PBCH measurement reporting of intra-frequency on specified frequency
}

**ensure that** {

**when** { SS/PBCH block sorting quantity is below
absThreshSS-BlocksConsolidation for one beam of Neighbour Cell and
another beam(s) is above absThreshSS-BlocksConsolidation}

**then** { UE sends MeasurementReport message containing rsIndexResults
with resultsSSB-Indexes includes RsIndex above
absThreshSS-BlocksConsolidation and excludes RsIndex below
absThreshSS-BlocksConsolidation }

}

##### (3) {#section-82 .H6}

**with** { UE in NR RRC\_CONNECTED state and measurement configured for
CSI-RS measurement reporting of intra frequency on specified frequency }

**ensure that** {

**when** { CSI-RS sorting quantity is above
absThreshCSI-RS-Consolidation for each beam of Neighbour Cell}

**then** { UE sends MeasurementReport message containing rsIndexResults
with results CSI-RS-Indexes}

}

##### (4) {#section-83 .H6}

**with** { UE in NR RRC\_CONNECTED state and measurement configured for
CSI-RS measurement reporting of intra frequency on specified frequency }

**ensure that** {

**when** { CSI-RS sorting quantity is below
absThreshCSI-RS-Consolidation for one beam of Neighbour Cell and another
beam(s) is above absThreshCSI-RS-Consolidation }

**then** { UE sends MeasurementReport message containing rsIndexResults
with results CSI-RS-Indexes includes RsIndex above
absThreshCSI-RS-Consolidation and excludes RsIndex below
absThreshCSI-RS-Consolidation }

}

##### 8.1.3.1.13.2 Conformance requirements {#conformance-requirements-45 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.5.5.1 and 5.5.5.2\]. Unless otherwise
stated these are Rel-15 requirements.

\[TS 38.331, clause 5.5.5.1\]

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> for each serving cell configured with *servingCellMO:*

2\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *rsType:*

3\> if the serving cell measurements based on the *rsType included in
the reportConfig* *that triggered the measurement report are available:*

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on the *rsType* included in the *reportConfig that triggered the
measurement report;*

2\> else*:*

3\> if SSB based serving cell measurements are available:

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on SSB;

3\> else if CSI-RS based serving cell measurements are available:

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on CSI-RS;

1\> set the *ServingCellId* within *measResultServingMOList* to include
for each NR serving cell that is configured with servingCellMO, if any;

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

8\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

7\> else if *rsType* in the associated *reportConfig* is set to
*csi-rs*:

8\> set *resultsCSI-RS-Cell* within the *measResult* to include the
CSI-RS based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

8\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

\[TS 38.331, clause 5.5.5.1\]

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this measId by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

1\> else:

2\> if the *reportType* is set to *periodical*:

3\> remove the entry within the *VarMeasReportList* for this *measId*;

3\> remove this *measId* from the *measIdList* within *VarMeasConfig*;

1\> if the UE is configured with EN-DC:

2\> if SRB3 is configured:

3\> submit the *MeasurementReport* message via SRB3 to lower layers for
transmission, upon which the procedure ends;

2\>else:

3\> submit the *MeasurementReport* message via the EUTRA MCG embedded in
E-UTRA RRC message *ULInformationTransferMRDC* as specified in TS 36.331
\[10\].

1\> else:

2\>submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

\[TS 38.331, clause 5.5.5.2\]

For beam measurement information to be included in a measurement report
the UE shall:

1\> if reportType is set to eventTriggered:

2\> consider the trigger quantity as the sorting quantity if available ,
otherwise RSRP as sorting quantity if available, otherwise RSRQ as
sorting quantity if available, otherwise SINR as sorting quantity;

1\> if reportType is set to periodical:

2\> if a single reporting quantity is set to TRUE in
*reportQuantityRs-Indexes*;

3\> consider the configured single quantity as the sorting quantity;

2\> else:

3\> if *rsrp* is set to TRUE;

4\> consider RSRP as the sorting quantity;

3\> else:

4\> consider RSRQ as the sorting quantity;

1\> set *rsIndexResults* to include up to *maxNrofRs-IndexesToReport*
SS/PBCH block indexes or CSI-RS indexes in order of decreasing sorting
quantity as follows:

2\> if the measurement information to be included is based on SS/PBCH
block:

3\> include within *resultsSSB-Indexes* the index associated to the best
beam for that SS/PBCH block sorting quantity and the remaining beams
whose sorting quantity is above *absThreshSS-BlocksConsolidation*
defined in the *VarMeasConfig* for the corresponding *measObject*;

3\> if *includeBeamMeasurements* is configured, include the SS/PBCH
based measurement results for the quantities in
*reportQuantity-RsIndexes* set to TRUE for each SS/PBCH blockindex;

2\> else if the beam measurement information to be included is based on
CSI-RS:

3\> include within *resultsCSI-RS-Indexes* the index associated to the
best beam for that CSI-RS sorting quantity and the remaining beams whose
sorting quantity is above *absThreshCSI-RS-Consolidation* defined in the
*VarMeasConfig* for the corresponding *measObject*;

3\> if *includeBeamMeasurements*is configured, include the CSI-RS based
measurement results for the quantities in *reportQuantity-RsIndexes* set
to TRUE for each CSI-RS index.

##### 8.1.3.1.13.3 Test description {#test-description-45 .H6}

##### 8.1.3.1.13.3.1 Pre-test conditions {#pre-test-conditions-45 .H6}

##### System Simulator: {#system-simulator-33 .H6}

\- NR Cell 1 is the Serving Cell.

\- NR Cell 2 is the intra-frequency neighbour cell of NR Cell 1. NR
Cell2 has two beams: SSB/CSI-RS index\#0 and SSB/CSI-RS index\#1.

##### UE: {#ue-30 .H6}

\- None

##### Preamble: {#preamble-32 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.3.1.13.3.2 Test procedure sequence {#test-procedure-sequence-46 .H6}

Table 8.1.3.1.13.3.2-1 and Table 8.1.3.1.13.3.2-1A illustrates the
downlink power levels to be applied for NR Cell 1 and NR Cell 2 at
various time instants of the test execution. Row marked \"T0\" denotes
the conditions after the preamble, while rows marked \"T1\" and \"T2\"
are to be applied subsequently. The exact instants on which these values
shall be applied are described in the texts in this clause.

Table 8.1.3.1.13.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-------+-------+-------+-------+-------+-------+-------+
|    | Para  | Unit  | NR    | NR    | NR    | NR    | R     |
|    | meter |       | Cell  | Cell  | Cell  | Cell  | emark |
|    |       |       | 1     | 2     | 2     | 2     |       |
|    |       |       |       |       | Beam  |       |       |
|    |       |       |       |       | 0     | Beam  |       |
|    |       |       |       |       | (     | 1     |       |
|    |       |       |       |       | NOTE) | (     |       |
|    |       |       |       |       |       | NOTE) |       |
+====+=======+=======+=======+=======+=======+=======+=======+
| T0 | SS    | dB    | -94   | \-    | \-    | \-    |       |
|    | /PBCH | m/SCS |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Refe  | dB    | \-    | -90   | \-    | \-    |       |
|    | rence | m/SCS |       |       |       |       |       |
|    | Power |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | SS    | dB    | \-    | \-    | -4    | -4    |       |
|    | /PBCH |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE, |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | C     |       |       |       |       |       |       |
|    | SI-RS |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
|    | o     |       |       |       |       |       |       |
|    | ffset |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T1 | SS    | dB    | -106  | \-    | \-    | \-    | Power |
|    | /PBCH | m/SCS |       |       |       |       | level |
|    |       |       |       |       |       |       | is    |
|    | SSS   |       |       |       |       |       | such  |
|    | EPRE  |       |       |       |       |       | that  |
|    |       |       |       |       |       |       | SS    |
|    |       |       |       |       |       |       | /PBCH |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | and   |
|    |       |       |       |       |       |       | C     |
|    |       |       |       |       |       |       | SI-RS |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | both  |
|    |       |       |       |       |       |       | beams |
|    |       |       |       |       |       |       | of NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 2 are |
|    |       |       |       |       |       |       | above |
|    |       |       |       |       |       |       | *abs  |
|    |       |       |       |       |       |       | Thres |
|    |       |       |       |       |       |       | hSS-B |
|    |       |       |       |       |       |       | locks |
|    |       |       |       |       |       |       | Conso |
|    |       |       |       |       |       |       | lidat |
|    |       |       |       |       |       |       | ion*. |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Refe  | dB    | \-    | -90   | \-    | \-    |       |
|    | rence | m/SCS |       |       |       |       |       |
|    | Power |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | SS    | dB    | \-    | \-    | -4    | -4    |       |
|    | /PBCH |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE, |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | C     |       |       |       |       |       |       |
|    | SI-RS |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
|    | o     |       |       |       |       |       |       |
|    | ffset |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T2 | SS    | dB    | -94   | \-    | \-    | \-    | *Mn + |
|    | /PBCH | m/SCS |       |       |       |       | Ofn + |
|    |       |       |       |       |       |       | Ocn + |
|    | SSS   |       |       |       |       |       | Hys   |
|    | EPRE  |       |       |       |       |       | \< Mp |
|    |       |       |       |       |       |       | + Ofp |
|    |       |       |       |       |       |       | + Ocp |
|    |       |       |       |       |       |       | +     |
|    |       |       |       |       |       |       | Off*  |
|    |       |       |       |       |       |       |       |
|    |       |       |       |       |       |       | Power |
|    |       |       |       |       |       |       | level |
|    |       |       |       |       |       |       | is    |
|    |       |       |       |       |       |       | such  |
|    |       |       |       |       |       |       | that  |
|    |       |       |       |       |       |       | SS    |
|    |       |       |       |       |       |       | /PBCH |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | and   |
|    |       |       |       |       |       |       | C     |
|    |       |       |       |       |       |       | SI-RS |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | both  |
|    |       |       |       |       |       |       | beams |
|    |       |       |       |       |       |       | of NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 2 are |
|    |       |       |       |       |       |       | below |
|    |       |       |       |       |       |       | *ab   |
|    |       |       |       |       |       |       | sThre |
|    |       |       |       |       |       |       | shSS- |
|    |       |       |       |       |       |       | Block |
|    |       |       |       |       |       |       | sCons |
|    |       |       |       |       |       |       | olida |
|    |       |       |       |       |       |       | tion* |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Refe  | dB    | \-    | -90   | \-    | \-    |       |
|    | rence | m/SCS |       |       |       |       |       |
|    | Power |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | SS    | dB    | \-    | \-    | -12   | -12   |       |
|    | /PBCH |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE, |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | C     |       |       |       |       |       |       |
|    | SI-RS |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
|    | o     |       |       |       |       |       |       |
|    | ffset |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T3 | SS    | dB    | -106  | \-    | \-    | \-    | Power |
|    | /PBCH | m/SCS |       |       |       |       | level |
|    |       |       |       |       |       |       | is    |
|    | SSS   |       |       |       |       |       | such  |
|    | EPRE  |       |       |       |       |       | that  |
|    |       |       |       |       |       |       | SS    |
|    |       |       |       |       |       |       | /PBCH |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | and   |
|    |       |       |       |       |       |       | C     |
|    |       |       |       |       |       |       | SI-RS |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | beam  |
|    |       |       |       |       |       |       | 0 of  |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 2 is  |
|    |       |       |       |       |       |       | above |
|    |       |       |       |       |       |       | *a    |
|    |       |       |       |       |       |       | bsThr |
|    |       |       |       |       |       |       | eshSS |
|    |       |       |       |       |       |       | -Bloc |
|    |       |       |       |       |       |       | ksCon |
|    |       |       |       |       |       |       | solid |
|    |       |       |       |       |       |       | ation |
|    |       |       |       |       |       |       | and*  |
|    |       |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | beam  |
|    |       |       |       |       |       |       | 1 of  |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 2 is  |
|    |       |       |       |       |       |       | below |
|    |       |       |       |       |       |       | *abs  |
|    |       |       |       |       |       |       | Thres |
|    |       |       |       |       |       |       | hSS-B |
|    |       |       |       |       |       |       | locks |
|    |       |       |       |       |       |       | Conso |
|    |       |       |       |       |       |       | lidat |
|    |       |       |       |       |       |       | ion*. |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Refe  | dB    | \-    | -90   | \-    | \-    |       |
|    | rence | m/SCS |       |       |       |       |       |
|    | Power |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | SS    | dB    | \-    | \-    | -4    | -12   |       |
|    | /PBCH |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE, |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | C     |       |       |       |       |       |       |
|    | SI-RS |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
|    | o     |       |       |       |       |       |       |
|    | ffset |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+

Table 8.1.3.1.13.3.2-1A: Time instances of cell power level and
parameter changes for FR2

+----+-------+-------+-------+-------+-------+-------+-------+
|    | Para  | Unit  | NR    | NR    | NR    | NR    | R     |
|    | meter |       | Cell  | Cell  | Cell  | Cell  | emark |
|    |       |       | 1     | 2     | 2     | 2     |       |
|    |       |       |       |       | Beam  |       |       |
|    |       |       |       |       | 0     | Beam  |       |
|    |       |       |       |       | (     | 1     |       |
|    |       |       |       |       | NOTE) | (     |       |
|    |       |       |       |       |       | NOTE) |       |
+====+=======+=======+=======+=======+=======+=======+=======+
| T0 | SS    | dB    | -82   | \-    | \-    | \-    |       |
|    | /PBCH | m/SCS |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Refe  | dB    | \-    | -90   | \-    | \-    |       |
|    | rence | m/SCS |       |       |       |       |       |
|    | Power |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | SS    | dB    | \-    | \-    | -1    | -1    |       |
|    | /PBCH |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE, |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | C     |       |       |       |       |       |       |
|    | SI-RS |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
|    | o     |       |       |       |       |       |       |
|    | ffset |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T1 | SS    | dB    | -100  | \-    | \-    | \-    | Power |
|    | /PBCH | m/SCS |       |       |       |       | level |
|    |       |       |       |       |       |       | is    |
|    | SSS   |       |       |       |       |       | such  |
|    | EPRE  |       |       |       |       |       | that  |
|    |       |       |       |       |       |       | SS    |
|    |       |       |       |       |       |       | /PBCH |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | and   |
|    |       |       |       |       |       |       | C     |
|    |       |       |       |       |       |       | SI-RS |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | both  |
|    |       |       |       |       |       |       | beams |
|    |       |       |       |       |       |       | of NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 2 are |
|    |       |       |       |       |       |       | above |
|    |       |       |       |       |       |       | *abs  |
|    |       |       |       |       |       |       | Thres |
|    |       |       |       |       |       |       | hSS-B |
|    |       |       |       |       |       |       | locks |
|    |       |       |       |       |       |       | Conso |
|    |       |       |       |       |       |       | lidat |
|    |       |       |       |       |       |       | ion*. |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Refe  | dB    | \-    | -90   | \-    | \-    |       |
|    | rence | m/SCS |       |       |       |       |       |
|    | Power |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | SS    | dB    | \-    | \-    | -1    | -1    |       |
|    | /PBCH |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE, |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | C     |       |       |       |       |       |       |
|    | SI-RS |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
|    | o     |       |       |       |       |       |       |
|    | ffset |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T2 | SS    | dB    | -100  | \-    | \-    | \-    | *Mn + |
|    | /PBCH | m/SCS |       |       |       |       | Ofn + |
|    |       |       |       |       |       |       | Ocn + |
|    | SSS   |       |       |       |       |       | Hys   |
|    | EPRE  |       |       |       |       |       | \< Mp |
|    |       |       |       |       |       |       | + Ofp |
|    |       |       |       |       |       |       | + Ocp |
|    |       |       |       |       |       |       | +     |
|    |       |       |       |       |       |       | Off*  |
|    |       |       |       |       |       |       |       |
|    |       |       |       |       |       |       | Power |
|    |       |       |       |       |       |       | level |
|    |       |       |       |       |       |       | is    |
|    |       |       |       |       |       |       | such  |
|    |       |       |       |       |       |       | that  |
|    |       |       |       |       |       |       | SS    |
|    |       |       |       |       |       |       | /PBCH |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | and   |
|    |       |       |       |       |       |       | C     |
|    |       |       |       |       |       |       | SI-RS |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | both  |
|    |       |       |       |       |       |       | beams |
|    |       |       |       |       |       |       | of NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 2 are |
|    |       |       |       |       |       |       | below |
|    |       |       |       |       |       |       | *ab   |
|    |       |       |       |       |       |       | sThre |
|    |       |       |       |       |       |       | shSS- |
|    |       |       |       |       |       |       | Block |
|    |       |       |       |       |       |       | sCons |
|    |       |       |       |       |       |       | olida |
|    |       |       |       |       |       |       | tion* |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Refe  | dB    | \-    | -90   | \-    | \-    |       |
|    | rence | m/SCS |       |       |       |       |       |
|    | Power |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | SS    | dB    | \-    | \-    | -10   | -10   |       |
|    | /PBCH |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE, |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | C     |       |       |       |       |       |       |
|    | SI-RS |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
|    | o     |       |       |       |       |       |       |
|    | ffset |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T3 | SS    | dB    | -100  | \-    | \-    | \-    | Power |
|    | /PBCH | m/SCS |       |       |       |       | level |
|    |       |       |       |       |       |       | is    |
|    | SSS   |       |       |       |       |       | such  |
|    | EPRE  |       |       |       |       |       | that  |
|    |       |       |       |       |       |       | SS    |
|    |       |       |       |       |       |       | /PBCH |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | and   |
|    |       |       |       |       |       |       | C     |
|    |       |       |       |       |       |       | SI-RS |
|    |       |       |       |       |       |       | qu    |
|    |       |       |       |       |       |       | ality |
|    |       |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | beam  |
|    |       |       |       |       |       |       | 0 of  |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 2 is  |
|    |       |       |       |       |       |       | above |
|    |       |       |       |       |       |       | *a    |
|    |       |       |       |       |       |       | bsThr |
|    |       |       |       |       |       |       | eshSS |
|    |       |       |       |       |       |       | -Bloc |
|    |       |       |       |       |       |       | ksCon |
|    |       |       |       |       |       |       | solid |
|    |       |       |       |       |       |       | ation |
|    |       |       |       |       |       |       | and*  |
|    |       |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | beam  |
|    |       |       |       |       |       |       | 1 of  |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 2 is  |
|    |       |       |       |       |       |       | below |
|    |       |       |       |       |       |       | *abs  |
|    |       |       |       |       |       |       | Thres |
|    |       |       |       |       |       |       | hSS-B |
|    |       |       |       |       |       |       | locks |
|    |       |       |       |       |       |       | Conso |
|    |       |       |       |       |       |       | lidat |
|    |       |       |       |       |       |       | ion*. |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Refe  | dB    | \-    | -90   | \-    | \-    |       |
|    | rence | m/SCS |       |       |       |       |       |
|    | Power |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | SS    | dB    | \-    | \-    | -1    | -10   |       |
|    | /PBCH |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | SSS   |       |       |       |       |       |       |
|    | EPRE, |       |       |       |       |       |       |
|    |       |       |       |       |       |       |       |
|    | C     |       |       |       |       |       |       |
|    | SI-RS |       |       |       |       |       |       |
|    | EPRE  |       |       |       |       |       |       |
|    | o     |       |       |       |       |       |       |
|    | ffset |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+

Table 8.1.3.1.13.3.2-2: Main behaviour

  St     Procedure                                                                                                                                                                                       Message Sequence   TP                                     Verdict   
  ------ ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                         U - S              Message                                          
  1      The SS transmits an NR *RRCReconfiguration* message including *measConfig* to setup SS/PBCH block based intra- frequency NR measurement for NR Cell 1 and reporting for event A3.               \<\--              NR RRC*: RRCReconfiguration*           \-        \-
  2      The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                       \--\>              NR RRC*: RRCReconfigurationComplete*   \-        \-
  3      The SS re-adjusts the cell-specific reference signal level according to row \"T1\".                                                                                                             \-                 \-                                     \-        \-
  4      Check: Does the UE transmit a *MeasurementReport* message to report event A3 with the measured results for NR Cell 2 with beam information containing RsIndex\[0\] and RsIndex\[1\]?            \--\>              NR RRC*: MeasurementReport*            1         P
  4A     The SS re-adjusts the cell-specific reference signal level according to the row \"T2\".                                                                                                         \-                 \-                                     \-        \-
  4AA    Wait and ignore MeasurementReport messages for 10s to allow change of power levels for NR Cell 2 and UE measurement.                                                                            \-                 \-                                     \-        \-
  4B     Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 to report the event A3 during the next 1s?                                                                               \-                 \-                                     1         F
  5      The SS re-adjusts the cell-specific reference signal level according to row \"T3\".                                                                                                             \-                 \-                                     \-        \-
  6      Check: Does the UE transmit a *MeasurementReport* message to report event A3 with the measured results for NR Cell 2 with beam information containing RsIndex\[0\] and excludes RsIndex\[1\]?   \--\>              NR RRC*: MeasurementReport*            2         P
  7-8    Void                                                                                                                                                                                            \-                 \-                                     \-        \-
  9      The SS transmits an NR *RRCReconfiguration* including *measConfig* to setup CSI-RS based intra-frequency NR measurement for NR Cell 1 and reporting for event A3.                               \<\--              NR RRC*: RRCReconfiguration*           \-        \-
  10     The UE transmits an *RRCConfigurationComplete*.                                                                                                                                                 \--\>              NR RRC*: RRCReconfigurationComplete*   \-        \-
  11     The SS re-adjusts the cell-specific reference signal level according to row \"T1\".                                                                                                             \-                 \-                                     \-        \-
  12     Check: Does the UE transmit a *MeasurementReport* message to report event A3 with the measured results for NR Cell 2 with beam information containing RsIndex\[0\] and RsIndex\[1\]?            \--\>              NR RRC*: MeasurementReport*            3         P
  12A    The SS re-adjusts the cell-specific reference signal level according to the row \"T2\".                                                                                                         \-                 \-                                     \-        \-
  12AA   Wait and ignore MeasurementReport messages for 10s to allow change of power levels for NR Cell 2 and UE measurement.                                                                            \-                 \-                                     \-        \-
  12B    Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 to report the event A3 during the next 1s?                                                                               \-                 \-                                     1         F
  13     The SS re-adjusts the cell-specific reference signal level according to row \"T3\".                                                                                                             \-                 \-                                     \-        \-
  14     Check: Does the UE transmit a *MeasurementReport* message to report event A3 with the measured results for NR Cell 2 with beam information containing RsIndex\[0\] and excludes RsIndex\[1\]?   \--\>              NR RRC*: MeasurementReport*            4         P
  15     The SS transmits an NR *RRCReconfiguration* including *measConfig* to release CSI-RS based intra-frequency NR measurement.                                                                      \<\--              NR RRC*: RRCReconfiguration*           \-        \-
  16     The UE transmits an *RRCConfigurationComplete*.                                                                                                                                                 \--\>              NR RRC*: RRCReconfigurationComplete*   \-        \-

##### 8.1.3.1.13.3.3 Specific message contents {#specific-message-contents-37 .H6}

Table 8.1.3.1.13.3.3-1: RRCReconfiguration (steps 1, 9 and 15, Table
8.1.3.1.13.3.2-2)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.13.3.3-2: *MeasConfig* (Table 8.1.3.1.13.3.3-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-69                                                          
  --------------------------------------------------------------------------- --------------------- --------- -----------------
  Information Element                                                         Value/remark          Comment   Condition
  MeasConfig::= SEQUENCE {                                                                                    
  measObjectToAddModList                                                      IdMeasObjectToAdd               Step 1
                                                                              Not present                     Step 9, Step 15
  reportConfigToAddModList                                                    IdReportConfigToAdd             Step 1
                                                                              Not present                     Step 9, Step 15
  measIdToRemoveList SEQUENCE (SIZE (1..maxNrofObjectId)) OF MeasObjectId {   1 entry                         Step 15
  MeasObjectId\[1\]                                                           1                               
  }                                                                                                           
  measIdToAddModList                                                          IdMeasIdToAdd                   Step 1, Step 9
                                                                              Not present                     Step 15
  }                                                                                                           

Table 8.1.3.1.13.3.3-3: IdMeasObjectToAdd (Table 8.1.3.1.13.3.3-2)

  Derivation Path: TS 38.331 \[6\], clause 6.3.2                                                                     
  -------------------------------------------------------------------------------------- ----------------- --------- -----------
  Information Element                                                                    Value/remark      Comment   Condition
  MeasObjectToAddModList::= SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {   1 entry                     
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                       entry 1   
  measObjectId                                                                           1                           
  measObject CHOICE {                                                                                                
  measObjectNR                                                                           Id-MeasObjectNR             
  }                                                                                                                  
  }                                                                                                                  
  }                                                                                                                  

Table 8.1.3.1.13.3.3-4: Id-MeasObjectNR (Table 8.1.3.1.13.3.3-3)

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                                                                                                                                        
  ---------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------ --------------------------------------------- -----------------------------------------------------------------------------
  Information Element                                                                                                          Value/remark                                                                   Comment                                       Condition

  MeasObjectNR::= SEQUENCE {                                                                                                                                                                                                                                

  ssbFrequency                                                                                                                 Downlink ARFCN of NR Cell1                                                                                                   

  refFreqCSI-RS                                                                                                                Same as "Point A" defined for the downlink of NR Cell1                                                                       

  referenceSignalConfig SEQUENCE {                                                                                                                                                                                                                          

  ssb-ConfigMobility SEQUENCE {                                                                                                                                                                                                                             

  ssb-ToMeasure CHOICE {                                                                                                                                                                                                                                    

  setup CHOICE {                                                                                                                                                                                                                                            

  shortBitmap                                                                                                                  1100                                                                                                                         (FREQ\<=3GHz AND (FR1\_FDD OR NOT CASE\_C)) OR (FREQ\<=2.4GHz AND FR1\_TDD)

  mediumBitmap                                                                                                                 11000000                                                                                                                     (FREQ\>3GHz AND FR1) OR (FREQ\>2.4GHz AND FR1\_TDD AND CASE\_C)

  longBitmap                                                                                                                   11000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000                                                      FR2

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  csi-rs-ResourceConfigMobility CHOICE {                                                                                                                                                                                                                    

  setup SEQUENCE {                                                                                                                                                                                                                                          

  subcarrierSpacing                                                                                                            SubcarrierSpacing                                                                                                            

  csi-RS-CellList-Mobility SEQUENCE (SIZE (1..maxNrofCSI-RS-CellsRRM)) OF CSI-RS-CellMobility {                                2 entries                                                                                                                    

  CSI-RS-CellMobility\[1\] SEQUENCE {                                                                                                                                                                         entry 1                                       

  cellId                                                                                                                       Physical CellID of the NR Cell 1                                                                                             

  csi-rs-MeasurementBW SEQUENCE {                                                                                                                                                                                                                           

  nrofPRBs                                                                                                                     size24                                                                                                                       

  startPRB                                                                                                                     same value as 'offsetToCarrier' as defined for the DL frequency of NR Cell 1                                                 

  }                                                                                                                                                                                                                                                         

  density                                                                                                                      d3                                                                                                                           

  csi-rs-ResourceList-Mobility SEQUENCE (SIZE (1..maxNrofCSI-RS-ResourcesRRM)) OF CSI-RS-Resource-Mobility {                   1 entry                                                                                                                      

  RS-Resource-Mobility\[1\] SEQUENCE {                                                                                                                                                                        entry 1                                       

  csi-RS-Index                                                                                                                 0                                                                                                                            

  slotConfig CHOICE {                                                                                                                                                                                                                                       

  ms20                                                                                                                         0                                                                              To avoid collision with CSI-RS of NR Cell 2   

  }                                                                                                                                                                                                                                                         

  associatedSSB                                                                                                                Not present                                                                                                                  

  associatedSSB SEQUENCE {                                                                                                                                                                                                                                  pc\_***csi\_RSRP\_AndRSRQ\_MeasWithSSB***

  ssb-Index                                                                                                                    0                                                                                                                            

  isQuasiColocated                                                                                                             false                                                                                                                        

  }                                                                                                                                                                                                                                                         

  frequencyDomainAllocation CHOICE {                                                                                                                                                                                                                        

  row1                                                                                                                         1000                                                                                                                         

  }                                                                                                                                                                                                                                                         

  firstOFDMSymbolInTimeDomain                                                                                                  4                                                                                                                            

  sequenceGenerationConfig                                                                                                     24                                                                                                                           

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  CSI-RS-CellMobility\[2\] SEQUENCE {                                                                                                                                                                         entry 2                                       

  cellId                                                                                                                       Physical CellID of the NR Cell 2                                                                                             

  csi-rs-MeasurementBW SEQUENCE {                                                                                                                                                                                                                           

  nrofPRBs                                                                                                                     size24                                                                                                                       

  startPRB                                                                                                                     same value as 'offsetToCarrier' as defined for the DL frequency of the cell                                                  

  }                                                                                                                                                                                                                                                         

  density                                                                                                                      d3                                                                                                                           

  csi-rs-ResourceList-Mobility SEQUENCE (SIZE (1..maxNrofCSI-RS-ResourcesRRM)) OF CSI-RS-Resource-Mobility {                   2 entries                                                                                                                    

  RS-Resource-Mobility\[1\] SEQUENCE {                                                                                                                                                                        entry 1                                       

  csi-RS-Index                                                                                                                 0                                                                              CSI-RS with Index 0                           

  slotConfig CHOICE {                                                                                                                                                                                                                                       

  ms20                                                                                                                         10 \* 2^µ^                                                                     µ is numerology index\                        
                                                                                                                                                                                                              (SCS=15kHz: 0,\                               
                                                                                                                                                                                                              SCS=30kHz: 1,\                                
                                                                                                                                                                                                              etc.)                                         

  }                                                                                                                                                                                                                                                         

  associatedSSB                                                                                                                Not present                                                                                                                  

  associatedSSB SEQUENCE {                                                                                                                                                                                                                                  pc\_***csi\_RSRP\_AndRSRQ\_MeasWithSSB***

  ssb-Index                                                                                                                    0                                                                                                                            

  isQuasiColocated                                                                                                             false                                                                                                                        

  }                                                                                                                                                                                                                                                         

  frequencyDomainAllocation CHOICE {                                                                                                                                                                                                                        

  row1                                                                                                                         1000                                                                                                                         

  }                                                                                                                                                                                                                                                         

  firstOFDMSymbolInTimeDomain                                                                                                  4                                                                                                                            

  sequenceGenerationConfig                                                                                                     24                                                                                                                           

  }                                                                                                                                                                                                                                                         

  RS-Resource-Mobility\[2\] SEQUENCE {                                                                                                                                                                        entry 2                                       

  csi-RS-Index                                                                                                                 1                                                                              CSI-RS with Index 1                           

  slotConfig CHOICE {                                                                                                                                                                                                                                       

  ms20                                                                                                                         10 \* 2^µ^                                                                     µ: numerology index\                          
                                                                                                                                                                                                              (SCS=15kHz: 0,\                               
                                                                                                                                                                                                              SCS=30kHz: 1,\                                
                                                                                                                                                                                                              etc.)                                         

  }                                                                                                                                                                                                                                                         

  associatedSSB                                                                                                                Not present                                                                                                                  

  associatedSSB SEQUENCE {                                                                                                                                                                                                                                  pc\_***csi\_RSRP\_AndRSRQ\_MeasWithSSB***

  ssb-Index                                                                                                                    1                                                                                                                            

  isQuasiColocated                                                                                                             false                                                                                                                        

  }                                                                                                                                                                                                                                                         

  frequencyDomainAllocation CHOICE {                                                                                                                                                                                                                        

  row1                                                                                                                         0001                                                                                                                         

  }                                                                                                                                                                                                                                                         

  firstOFDMSymbolInTimeDomain                                                                                                  0                                                                                                                            

  sequenceGenerationConfig                                                                                                     24                                                                                                                           

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  absThreshSS-BlocksConsolidation SEQUENCE {                                                                                                                                                                                                                

  thresholdRSRP                                                                                                                57                                                                             corresponding to -100dBm                      FR1

                                                                                                                               66 +Delta(NRf1)                                                                corresponding to -91dBm                       FR2

  }                                                                                                                                                                                                                                                         

  }                                                                                                                                                                                                                                                         

  NOTE 1: delta(NRf1) is derived based on calibration procedure defined in the TS 38.508-1 \[4\], clause 6.1.3.3 on NR Cell1                                                                                                                                
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table 8.1.3.1.13.3.3-5: IdReportConfigToAdd (Table 8.1.3.1.13.3.3-2)

  Derivation Path: TS 38.331 \[6\], clause 6.3.2                                                                                     
  --------------------------------------------------------------------------------------------- -------------------------- --------- -----------
  Information Element                                                                           Value/remark               Comment   Condition
  ReportConfigToAddModList::= SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   2 entries                            
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                     entry 1   
  reportConfigId                                                                                1                                    
  reportConfig CHOICE {                                                                                                              
  reportConfigNR                                                                                IdReportConfig-A3-SSB                
  }                                                                                                                                  
  }                                                                                                                                  
  ReportConfigToAddMod\[2\] SEQUENCE {                                                                                     entry 2   
  reportConfigId                                                                                2                                    
  reportConfig CHOICE {                                                                                                              
  reportConfigNR                                                                                IdReportConfig-A3-CSI-RS             
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  

Table 8.1.3.1.13.3.3-6: IdReportConfig-A3-SSB (Table 8.1.3.1.13.3.3-5)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-142 with condition EVENT\_A3                            
  ------------------------------------------------------------------------------ -------------- --------- -----------
  Information Element                                                            Value/remark   Comment   Condition
  ReportConfigNR::= SEQUENCE {                                                                            
  reportType CHOICE {                                                                                     
  eventTriggered SEQUENCE {                                                                               
  eventId CHOICE {                                                                                        
  eventA3 SEQUENCE {                                                                                      
  a3-Offset CHOICE {                                                                                      
  rsrp                                                                           2                        
  }                                                                                                       
  }                                                                                                       
  }                                                                                                       
  reportAmount                                                                   infinity                 
  reportQuantityRS-Indexes SEQUENCE {                                                                     
  rsrp                                                                           true                     
  rsrq                                                                           false                    
  sinr                                                                           false                    
  }                                                                                                       
  maxNrofRS-IndexesToReport                                                      2                        
  includeBeamMeasurements                                                        true                     
  }                                                                                                       
  }                                                                                                       
  }                                                                                                       

Table 8.1.3.1.13.3.3-6A: IdReportConfig-A3-CSI-RS (Table
8.1.3.1.13.3.3-5)

  ------------------------------------------------------------------------------ -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-142 with condition EVENT\_A3                            
  Information Element                                                            Value/remark   Comment   Condition
  ReportConfigNR::= SEQUENCE {                                                                            
  reportType CHOICE {                                                                                     
  eventTriggered SEQUENCE {                                                                               
  eventId CHOICE {                                                                                        
  eventA3 SEQUENCE {                                                                                      
  a3-Offset CHOICE {                                                                                      
  rsrp                                                                           2                        
  }                                                                                                       
  }                                                                                                       
  }                                                                                                       
  rsType                                                                         csi-rs                   
  reportAmount                                                                   infinity                 
  reportQuantityCell SEQUENCE {                                                                           
  sinr                                                                           false                    
  }                                                                                                       
  reportQuantityRS-Indexes SEQUENCE {                                                                     
  rsrp                                                                           true                     
  rsrq                                                                           false                    
  sinr                                                                           false                    
  }                                                                                                       
  maxNrofRS-IndexesToReport                                                      2                        
  includeBeamMeasurements                                                        true                     
  }                                                                                                       
  }                                                                                                       
  }                                                                                                       
  ------------------------------------------------------------------------------ -------------- --------- -----------

Table 8.1.3.1.13.3.3-7: IdMeasIdToAdd (Table 8.1.3.1.13.3.3-2)

  Derivation Path: TS 38.331 \[6\], clause 6.3.2                                                          
  ------------------------------------------------------------------------------ -------------- --------- -----------
  Information Element                                                            Value/remark   Comment   Condition
  MeasIdToAddModList::= SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {   1 entry                  
  MeasIdToAddMod                                                                                          
  measId                                                                         1                        
  measObjectId                                                                   1                        
  reportConfigId                                                                 1                        Step 1
                                                                                 2                        Step 9
  }                                                                                                       
  }                                                                                                       

Table 8.1.3.1.13.3.3-8: MeasurementReport (step 4, Table
8.1.3.1.13.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-7                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  MeasurementReport ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                  
  measurementReport SEQUENCE {                                                 
  measResults                                         MeasResults              
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.3.1.13.3.3-9: MeasResults (Table 8.1.3.1.13.3.3-8)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-79                                                                                                     
  ------------------------------------------------------------------------------------------ ------------------------------------------------- --------- --------------------
  Information Element                                                                        Value/remark                                      Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                                             
  measId                                                                                     1                                                           
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {     1 entry                                                     
  MeasResultServMO\[1\] SEQUENCE {                                                                                                             entry 1   
  servCellId                                                                                 ServCellIndex of NR Cell 1                                  
  measResultServingCell SEQUENCE {                                                                                                                       
  physCellId                                                                                 Physical CellID of the NR Cell 1                            
  measResult SEQUENCE {                                                                                                                                  
  cellResults SEQUENCE{                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                             
  rsrp                                                                                       (0..127)                                                    
  rsrq                                                                                       (0..127)                                                    
  sinr                                                                                       (0..127)                                                    pc\_ss\_SINR\_Meas
                                                                                             Not present                                                 
  }                                                                                                                                                      
  rsIndexResults SEQUENCE {                                                                                                                              
  resultsSSB-Indexes SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index {   1 entry                                                     
  ResultsPerSSB-Index\[1\] EQUENCE {                                                                                                           entry 1   
  ssb-Index                                                                                  Not checked                                                 
  ssb-Results SEQUENCE {                                                                                                                                 
  rsrp                                                                                       (0..127)                                                    
  rsrq                                                                                       Not present                                                 
  sinr                                                                                       Not present                                                 
  }                                                                                                                                                      
  }                                                                                                                                                      
  resultsCSI-RS-Indexes                                                                      Not present                                                 
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  measResultNeighCells CHOICE {                                                                                                                          
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                      1 entry                                                     
  MeasResultNR\[1\] SEQUENCE {                                                                                                                 entry 1   
  physCellId                                                                                 Physical CellID of the NR Cell 2                            
  measResult SEQUENCE {                                                                                                                                  
  cellResults SEQUENCE {                                                                                                                                 
  resultsSSB-Cell SEQUENCE {                                                                                                                             
  rsrp                                                                                       (0..127)                                                    
  rsrq                                                                                       (0..127)                                                    
  sinr                                                                                       (0..127)                                                    pc\_ss\_SINR\_Meas
                                                                                             Not present                                                 
  }                                                                                                                                                      
  resultsCSI-RS-Cell                                                                         Not present                                                 
  }                                                                                                                                                      
  rsIndexResults SEQUENCE {                                                                                                                              
  resultsSSB-Indexes SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index {   2 entries that may appear in an arbitrary order             
  ResultsPerSSB-Index \[1\] SEQUENCE {                                                                                                         entry 1   
  ssb-Index                                                                                  SSB index 0                                                 
  ssb-Results SEQUENCE {                                                                                                                                 
  rsrp                                                                                       (0..127)                                                    
  rsrq                                                                                       Not present                                                 
  sinr                                                                                       Not present                                                 
  }                                                                                                                                                      
  }                                                                                                                                                      
  ResultsPerSSB-Index \[2\] SEQUENCE {                                                                                                         entry 2   
  ssb-Index                                                                                  SSB index 1                                                 
  ssb-Results SEQUENCE {                                                                                                                                 
  rsrp                                                                                       (0..127)                                                    
  rsrq                                                                                       Not present                                                 
  sinr                                                                                       Not present                                                 
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  resultsCSI-RS-Indexes                                                                      Not present                                                 
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  cgi-Info                                                                                   Not present                                                 
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      

Table 8.1.3.1.13.3.3-10: MeasurementReport (step 6, Table
8.1.3.1.13.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-7                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  MeasurementReport ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                  
  measurementReport SEQUENCE {                                                 
  measResults                                         MeasResults              
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.3.1.13.3.3-11: MeasResults (Table 8.1.3.1.13.3.3-10)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-79                                                                                      
  ------------------------------------------------------------------------------------------ ---------------------------------- --------- --------------------
  Information Element                                                                        Value/remark                       Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                              
  measId                                                                                     1                                            
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {     1 entry                                      
  MeasResultServMO\[1\] SEQUENCE {                                                                                              entry 1   
  servCellId                                                                                 ServCellIndex of NR Cell 1                   
  measResultServingCell SEQUENCE {                                                                                                        
  physCellId                                                                                 Physical CellID of the NR Cell 1             
  measResult SEQUENCE {                                                                                                                   
  cellResults SEQUENCE{                                                                                                                   
  resultsSSB-Cell SEQUENCE {                                                                                                              
  rsrp                                                                                       (0..127)                                     
  rsrq                                                                                       (0..127)                                     
  sinr                                                                                       (0..127)                                     pc\_ss\_SINR\_Meas
                                                                                             Not present                                  
  }                                                                                                                                       
  }                                                                                                                                       
  rsIndexResults SEQUENCE {                                                                                                               
  resultsSSB-Indexes SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index {   1 entry                                      
  ResultsPerSSB-Index\[1\] SEQUENCE {                                                                                           entry 1   
  ssb-Index                                                                                  Not checked                                  
  ssb-Results SEQUENCE {                                                                                                                  
  rsrp                                                                                       (0..127)                                     
  rsrq                                                                                       Not present                                  
  sinr                                                                                       Not present                                  
  }                                                                                                                                       
  resultsCSI-RS-Indexes                                                                      Not present                                  
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       
  measResultNeighCells CHOICE {                                                                                                           
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                      1 entry                                      
  MeasResultNR\[1\] SEQUENCE {                                                                                                  entry 1   
  physCellId                                                                                 Physical CellID of the NR Cell2              
  measResult SEQUENCE {                                                                                                                   
  cellResults SEQUENCE {                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                              
  rsrp                                                                                       (0..127)                                     
  rsrq                                                                                       (0..127)                                     
  sinr                                                                                       (0..127)                                     pc\_ss\_SINR\_Meas
                                                                                             Not present                                  
  }                                                                                                                                       
  resultsCSI-RS-Cell                                                                         Not present                                  
  }                                                                                                                                       
  rsIndexResults SEQUENCE {                                                                                                               
  resultsSSB-Indexes SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index {   1 entry                                      
  ResultsPerSSB-Index\[1\] SEQUENCE {                                                                                           entry 1   
  ssb-Index\[1\]                                                                             SSB index 0                                  
  ssb-Results\[1\] SEQUENCE {                                                                                                             
  rsrp                                                                                       (0..127)                                     
  rsrq                                                                                       Not present                                  
  sinr                                                                                       Not present                                  
  }                                                                                                                                       
  }                                                                                                                                       
  resultsCSI-RS-Indexes                                                                      Not present                                  
  }                                                                                                                                       
  }                                                                                                                                       
  cgi-Info                                                                                   Not present                                  
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       
  }                                                                                                                                       

Table 8.1.3.1.13.3.3-12: Void

Table 8.1.3.1.13.3.3-13: Void

Table 8.1.3.1.13.3.3-14: Void

Table 8.1.3.1.13.3.3-15: Void

Table 8.1.3.1.13.3.3-16: Void

Table 8.1.3.1.13.3.3-17: Void

Table 8.1.3.1.13.3.3-18: MeasurementReport (step 12, Table
8.1.3.1.13.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-7                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  MeasurementReport ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                  
  measurementReport SEQUENCE {                                                 
  measResults                                         MeasResults              
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.3.1.13.3.3-19: MeasResults (Table 8.1.3.1.13.3.3-18)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-79                                                                                                           
  ------------------------------------------------------------------------------------------------ ------------------------------------------------- --------- --------------------
  Information Element                                                                              Value/remark                                      Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                                                   
  measId                                                                                           1                                                           
  measResultServingMOList SEQUENCE {(SIZE (1..maxNrofServingCells)) OF MeasResultServMO {          1 entry                                                     
  MeasResultServMO\[1\] SEQUENCE {                                                                                                                   entry 1   
  servCellId                                                                                       ServCellIndex of NR Cell 1                                  
  measResultServingCell SEQUENCE {                                                                                                                             
  physCellId                                                                                       Physical CellID of the NR Cell 1                            
  measResult SEQUENCE {                                                                                                                                        
  cellResults SEQUENCE {                                                                                                                                       
  resultsSSB-Cell                                                                                  Not present                                                 
  resultsCSI-RS-Cell SEQUENCE {                                                                                                                                
  rsrp                                                                                             (0..127)                                                    
  rsrq                                                                                             (0..127)                                                    
  sinr                                                                                             Not present                                                 
                                                                                                   Not checked                                                 pc\_ss\_SINR\_Meas
  }                                                                                                                                                            
  }                                                                                                                                                            
  rsIndexResults SEQUENCE {                                                                                                                                    
  resultsSSB-Indexes                                                                               Not present                                                 
  resultsCSI-RS-Indexes SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index {      1 entry                                                     
  ResultsPerSSB-Index\[1\] SEQUENCE {                                                                                                                entry 1   
  csi-RS-Index                                                                                     Not checked                                                 
  csi-RS-Results SEQUENCE {                                                                                                                                    
  rsrp                                                                                             (0..127)                                                    
  rsrq                                                                                             (0..127)                                                    
  sinr                                                                                             Not present                                                 
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  measResultNeighCells CHOICE {                                                                                                                                
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                            1 entry                                                     
  MeasResultNR\[1\] SEQUENCE {                                                                                                                       entry 1   
  physCellId                                                                                       Physical CellID of the NR Cell 2                            
  measResult SEQUENCE {                                                                                                                                        
  cellResults SEQUENCE {                                                                                                                                       
  resultsSSB-Cell                                                                                  Not present                                                 
  resultsCSI-RS-Cell SEQUENCE {                                                                                                                                
  rsrp                                                                                             (0..127)                                                    
  rsrq                                                                                             (0..127)                                                    
  sinr                                                                                             Not present                                                 
  }                                                                                                                                                            
  }                                                                                                                                                            
  rsIndexResults SEQUENCE {                                                                                                                                    
  resultsSSB-Indexes                                                                               Not Present                                                 
  resultsCSI-RS-Indexes SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerCSI-RS-Index {   2 entries that may appear in an arbitrary order             
  ResultsPerCSI-RS-Index\[1\] SEQUENCE {                                                                                                             entry 1   
  csi-RS-Index                                                                                     CSI-RS-index 0                                              
  csi-RS-Results SEQUENCE {                                                                                                                                    
  rsrp                                                                                             Not checked                                                 
  rsrq                                                                                             Not present                                                 
  sinr                                                                                             Not present                                                 
  }                                                                                                                                                            
  }                                                                                                                                                            
  ResultsPerCSI-RS-Index\[2\] SEQUENCE {                                                                                                             entry 2   
  csi-RS-Index                                                                                     CSI-RS-index 1                                              
  csi-RS-Results SEQUENCE {                                                                                                                                    
  rsrp                                                                                             Not checked                                                 
  rsrq                                                                                             Not present                                                 
  sinr                                                                                             Not present                                                 
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  cgi-Info                                                                                         Not present                                                 
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            

Table 8.1.3.1.13.3.3-20: MeasurementReport (step 14, Table
8.1.3.1.13.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-7                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  MeasurementReport ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                  
  measurementReport SEQUENCE {                                                 
  measResults                                         MeasResults              
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.3.1.13.3.3-21: MeasResults (Table 8.1.3.1.13.3.3-20)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-79                                                                                         
  --------------------------------------------------------------------------------------------- ---------------------------------- --------- --------------------
  Information Element                                                                           Value/remark                       Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                                 
  measId                                                                                        1                                            
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {        1 entry                                      
  MeasResultServMO\[1\] SEQUENCE {                                                                                                 entry 1   
  servCellId                                                                                    ServCellIndex of NR Cell 1                   
  measResultServingCell SEQUENCE {                                                                                                           
  physCellId                                                                                    Physical CellID of the NR Cell 1             
  measResult SEQUENCE {                                                                                                                      
  cellResults SEQUENCE{                                                                                                                      
  resultsSSB-Cell                                                                               Not present                                  
  resultsCSI-RS-Cell SEQUENCE {                                                                                                              
  rsrp                                                                                          (0..127)                                     
  rsrq                                                                                          (0..127)                                     
  sinr                                                                                          Not present                                  
                                                                                                Not checked                                  pc\_ss\_SINR\_Meas
  }                                                                                                                                          
  }                                                                                                                                          
  rsIndexResults SEQUENCE {                                                                                                                  
  resultsSSB-Indexes                                                                            Not present                                  
  resultsCSI-RS-Indexes SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index {   1 entry                                      
  ResultsPerSSB-Index\[1\] SEQUENCE {                                                                                              entry 1   
  csi-RS-Index                                                                                  Not checked                                  
  csi-RS-Results SEQUENCE {                                                                                                                  
  rsrp                                                                                          (0..127)                                     
  rsrq                                                                                          Not present                                  
  sinr                                                                                          Not present                                  
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  measResultNeighCells CHOICE {                                                                                                              
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                         1 entry                                      
  MeasResultNR\[1\] SEQUENCE {                                                                                                     entry 1   
  physCellId                                                                                    Physical CellID of the NR Cell 2             
  measResult SEQUENCE {                                                                                                                      
  cellResults SEQUENCE {                                                                                                                     
  resultsSSB-Cell                                                                               Not present                                  
  resultsCSI-RS-Cell SEQUENCE {                                                                                                              
  rsrp                                                                                          (0..127)                                     
  rsrq                                                                                          (0..127)                                     
  sinr                                                                                          Not present                                  
  }                                                                                                                                          
  }                                                                                                                                          
  rsIndexResults SEQUENCE {                                                                                                                  
  resultsSSB-Indexes                                                                            Not Present                                  
  resultsCSI-RS-Indexes SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index {   1 entry                                      
  ResultsPerSSB-Index\[1\] SEQUENCE {                                                                                              entry 1   
  csi-RS-Index                                                                                  CSI-RS-Index 0                               
  csi-RS-Results SEQUENCE {                                                                                                                  
  rsrp                                                                                          (0..127)                                     
  rsrq                                                                                          Not present                                  
  sinr                                                                                          Not present                                  
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  cgi-Info                                                                                      Not present                                  
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          

##### 8.1.3.1.14 Void

##### 8.1.3.1.14A Measurement configuration control and reporting / SS/PBCH block based / CSI-RS based inter-frequency measurements / Measurement of Neighbour NR cell

##### 8.1.3.1.14A.1 Test Purpose (TP) {#a.1-test-purpose-tp-1 .H6}

##### (1) {#section-84 .H6}

**with** { UE in NR RRC\_CONNECTED state and measurement configured for
SS/PBCH measurement reporting of inter-frequency on specified frequency}

**ensure that** {

**when** { SS/PBCH block sorting quantity is above
absThreshSS-BlocksConsolidation for each beam of Neighbour Cell}

**then** { UE sends MeasurementReport message containing rsIndexResults
with resultsSSB-Indexes}

}

##### (2) {#section-85 .H6}

**with** { UE in NR RRC\_CONNECTED state and measurement configured for
SS/PBCH measurement reporting of inter-frequency on specified frequency
}

**ensure that** {

**when** { SS/PBCH block sorting quantity is below
absThreshSS-BlocksConsolidation for one beam of Neighbour Cell and
another beam(s) is above absThreshSS-BlocksConsolidation}

**then** { UE sends MeasurementReport message containing rsIndexResults
with resultsSSB-Indexes includes RsIndex above
absThreshSS-BlocksConsolidation and excludes RsIndex below
absThreshSS-BlocksConsolidation }

}

##### (3) {#section-86 .H6}

**with** { UE in NR RRC\_CONNECTED state and measurement configured for
CSI-RS measurement reporting of inter frequency on specified frequency }

**ensure that** {

**when** { CSI-RS sorting quantity is above
absThreshCSI-RS-Consolidation for each beam of Neighbour Cell}

**then** { UE sends MeasurementReport message containing rsIndexResults
with resultsCSI-RS-Indexes}

}

##### (4) {#section-87 .H6}

**with** { UE in NR RRC\_CONNECTED state and measurement configured for
CSI-RS measurement reporting of inter frequency on specified frequency }

**ensure that** {

**when** { CSI-RS sorting quantity is below
absThreshCSI-RS-Consolidation for one beam of Neighbour Cell and another
beam(s) is above absThreshCSI-RS-Consolidation }

**then** { UE sends MeasurementReport message containing rsIndexResults
with resultsCSI-RS-Indexes includes RsIndex above
absThreshCSI-RS-Consolidation and excludes RsIndex below
absThreshCSI-RS-Consolidation }

}

##### 8.1.3.1.14A.2 Conformance requirements {#a.2-conformance-requirements-1 .H6}

Same as TC 8.1.3.1.13

##### 8.1.3.1.14A.3 Test description {#a.3-test-description-1 .H6}

##### 8.1.3.1.14A.3.1 Pre-test conditions {#a.3.1-pre-test-conditions-1 .H6}

Same as TC 8.1.3.1.13 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

\- System information combination NR-4 as defined in TS 38.508-1\[4\]
clause 4.4.3.1.2 is used in NR cells.

##### 8.1.3.1.14A.3.2 Test procedure sequence {#a.3.2-test-procedure-sequence-1 .H6}

Same as TC 8.1.3.1.13 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2

##### 8.1.3.1.14A.3.3 Specific message contents {#a.3.3-specific-message-contents-1 .H6}

Same as TC 8.1.3.1.13 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2

Table 8.1.3.1.14A.3.3-1: IdMeasObjectToAdd (Table 8.1.3.1.13.3.3-2)

  Derivation Path: TS 38.331 \[6\], clause 6.3.2                                                                         
  --------------------------------------------------------------------------------------- -------------------- --------- -----------
  Information Element                                                                     Value/remark         Comment   Condition
  MeasObjectToAddModList ::= SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {   2 entries                      
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                           entry 1   
  measObjectId                                                                            1                              
  measObject CHOICE {                                                                                                    
  measObjectNR                                                                            Id-MeasObjectNR-f1             
  }                                                                                                                      
  }                                                                                                                      
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                           entry 2   
  measObjectId                                                                            2                              
  measObject CHOICE {                                                                                                    
  measObjectNR                                                                            Id-MeasObjectNR-f2             
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      

Table 8.1.3.1.14A.3.3-1A: Id-MeasObjectNR-f1 (Table 8.1.3.1.14A.3.3-1)

  ------------------------------------------------------------------------------------------------------------ ------------------------------------------------------------------------------ ------------------------- -------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                                                                                                    
  Information Element                                                                                          Value/remark                                                                   Comment                   Condition
  MeasObjectNR::= SEQUENCE {                                                                                                                                                                                            
  ssbFrequency                                                                                                 Downlink ARFCN of NR Cell 1                                                                              
  refFreqCSI-RS                                                                                                Same as "Point A" defined for the downlink of NR Cell1                                                   
  referenceSignalConfig SEQUENCE {                                                                                                                                                                                      
  csi-rs-ResourceConfigMobility CHOICE {                                                                                                                                                                                
  setup SEQUENCE {                                                                                                                                                                                                      
  subcarrierSpacing                                                                                            SubcarrierSpacing                                                                                        
  csi-RS-CellList-Mobility SEQUENCE (SIZE (1..maxNrofCSI-RS-CellsRRM)) OF CSI-RS-CellMobility {                1 entry                                                                                                  
  CSI-RS-CellMobility\[1\] SEQUENCE {                                                                                                                                                         entry 1                   
  cellId                                                                                                       Physical CellID of the NR Cell 1                                                                         
  csi-rs-MeasurementBW SEQUENCE {                                                                                                                                                                                       
  nrofPRBs                                                                                                     size24                                                                                                   
  startPRB                                                                                                     same value as 'offsetToCarrier' as defined for the DL frequency of NR Cell 1                             
  }                                                                                                                                                                                                                     
  density                                                                                                      d3                                                                                                       
  csi-rs-ResourceList-Mobility SEQUENCE (SIZE (1..maxNrofCSI-RS-ResourcesRRM)) OF CSI-RS-Resource-Mobility {   1 entry                                                                                                  
  CSI-RS-Resource-Mobility\[1\] SEQUENCE {                                                                                                                                                    entry 1                   
  csi-RS-Index                                                                                                 0                                                                                                        
  slotConfig CHOICE {                                                                                                                                                                                                   
  ms20                                                                                                         0                                                                                                        
  }                                                                                                                                                                                                                     
  associatedSSB                                                                                                Not present                                                                                              
  associatedSSB SEQUENCE {                                                                                                                                                                                              pc\_***csi\_RSRP\_AndRSRQ\_MeasWithSSB***
  ssb-Index                                                                                                    0                                                                                                        
  isQuasiColocated                                                                                             false                                                                                                    
  }                                                                                                                                                                                                                     
  frequencyDomainAllocation CHOICE {                                                                                                                                                                                    
  row1                                                                                                         1000                                                                                                     
  }                                                                                                                                                                                                                     
  firstOFDMSymbolInTimeDomain                                                                                  4                                                                                                        
  sequenceGenerationConfig                                                                                     24                                                                                                       
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  absThreshSS-BlocksConsolidation SEQUENCE {                                                                                                                                                                            
  thresholdRSRP                                                                                                57                                                                             corresponding to -99dBm   FR1
                                                                                                               66                                                                             corresponding to -90dBm   FR2
  }                                                                                                                                                                                                                     
  absThreshCSI-RS-Consolidation SEQUENCE {                                                                                                                                                                              
  thresholdRSRP                                                                                                57                                                                             corresponding to -99dBm   FR1
                                                                                                               66                                                                             corresponding to -90dBm   FR2
  thresholdRSRQ                                                                                                Not Present                                                                                              
  thresholdSINR                                                                                                Not Present                                                                                              
  }                                                                                                                                                                                                                     
  nrofCSI-RS-ResourcesToAverage                                                                                2                                                                                                        
  }                                                                                                                                                                                                                     
  ------------------------------------------------------------------------------------------------------------ ------------------------------------------------------------------------------ ------------------------- -------------------------------------------

Table 8.1.3.1.14A.3.3-2: Id-MeasObjectNR-f2 (Table 8.1.3.1.14A.3.3-1)

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                                                                                                                    
  ---------------------------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- -------------------------- -----------------------------------------------------------------------------
  Information Element                                                                                                          Value/remark                                                                  Comment                    Condition

  MeasObjectNR::= SEQUENCE {                                                                                                                                                                                                            

  ssbFrequency                                                                                                                 Downlink ARFCN of NR Cell3                                                                               

  refFreqCSI-RS                                                                                                                Same as "Point A" defined for the downlink of NR Cell3                                                   

  referenceSignalConfig SEQUENCE {                                                                                                                                                                                                      

  ssb-ConfigMobility SEQUENCE {                                                                                                                                                                                                         

  ssb-ToMeasure CHOICE {                                                                                                                                                                                                                

  setup CHOICE {                                                                                                                                                                                                                        

  shortBitmap                                                                                                                  1100                                                                                                     (FREQ\<=3GHz AND (FR1\_FDD OR NOT CASE\_C)) OR (FREQ\<=2.4GHz AND FR1\_TDD)

  mediumBitmap                                                                                                                 11000000                                                                                                 (FREQ\>3GHz AND FR1) OR (FREQ\>2.4GHz AND FR1\_TDD AND CASE\_C)

  longBitmap                                                                                                                   11000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000                                  FR2

  }                                                                                                                                                                                                                                     

  }                                                                                                                                                                                                                                     

  }                                                                                                                                                                                                                                     

  csi-rs-ResourceConfigMobility CHOICE {                                                                                                                                                                                                

  setup SEQUENCE {                                                                                                                                                                                                                      

  subcarrierSpacing                                                                                                            SubcarrierSpacing                                                                                        

  csi-RS-CellList-Mobility SEQUENCE (SIZE (1..maxNrofCSI-RS-CellsRRM)) OF CSI-RS-CellMobility {                                1 entry                                                                                                  

  CSI-RS-CellMobility\[1\] SEQUENCE {                                                                                                                                                                        entry 1                    

  cellId                                                                                                                       Physical CellID of the NR Cell 3                                                                         

  csi-rs-MeasurementBW SEQUENCE {                                                                                                                                                                                                       

  nrofPRBs                                                                                                                     size24                                                                                                   

  startPRB                                                                                                                     same value as 'offsetToCarrier' as defined for the DL frequency of the cell                              

  }                                                                                                                                                                                                                                     

  density                                                                                                                      d3                                                                                                       

  csi-rs-ResourceList-Mobility SEQUENCE (SIZE (1.. maxNrofCSI-RS-ResourcesRRM)) OF CSI-RS-Resource-Mobility {                  2 entries                                                                                                

  CSI-RS-Resource-Mobility\[1\] SEQUENCE {                                                                                                                                                                   entry 1                    

  csi-RS-Index                                                                                                                 0                                                                             CSI-RS with Index 0        

  slotConfig CHOICE {                                                                                                                                                                                                                   

  ms20                                                                                                                         10 \* 2^µ^                                                                    µ is numerology index\     
                                                                                                                                                                                                             (SCS=15kHz: 0,\            
                                                                                                                                                                                                             SCS=30kHz: 1,\             
                                                                                                                                                                                                             etc.)                      

  }                                                                                                                                                                                                                                     

  associatedSSB                                                                                                                Not present                                                                                              

  associatedSSB SEQUENCE {                                                                                                                                                                                                              pc\_***csi\_RSRP\_AndRSRQ\_MeasWithSSB***

  ssb-Index                                                                                                                    0                                                                                                        

  isQuasiColocated                                                                                                             false                                                                                                    

  }                                                                                                                                                                                                                                     

  frequencyDomainAllocation CHOICE {                                                                                                                                                                                                    

  row1                                                                                                                         1000                                                                                                     

  }                                                                                                                                                                                                                                     

  firstOFDMSymbolInTimeDomain                                                                                                  4                                                                                                        

  sequenceGenerationConfig                                                                                                     24                                                                                                       

  }                                                                                                                                                                                                                                     

  CSI-RS-Resource-Mobility\[2\] SEQUENCE {                                                                                                                                                                   entry 2                    

  csi-RS-Index                                                                                                                 1                                                                             CSI-RS with Index 1        

  slotConfig CHOICE {                                                                                                                                                                                                                   

  ms20                                                                                                                         10 \* 2^µ^                                                                    µ: numerology index\       
                                                                                                                                                                                                             (SCS=15kHz: 0,\            
                                                                                                                                                                                                             SCS=30kHz: 1,\             
                                                                                                                                                                                                             etc.)                      

  }                                                                                                                                                                                                                                     

  associatedSSB                                                                                                                Not present                                                                                              

  associatedSSB SEQUENCE {                                                                                                                                                                                                              pc\_***csi\_RSRP\_AndRSRQ\_MeasWithSSB***

  ssb-Index                                                                                                                    1                                                                                                        

  isQuasiColocated                                                                                                             false                                                                                                    

  }                                                                                                                                                                                                                                     

  frequencyDomainAllocation CHOICE {                                                                                                                                                                                                    

  row1                                                                                                                         0001                                                                                                     

  }                                                                                                                                                                                                                                     

  firstOFDMSymbolInTimeDomain                                                                                                  0                                                                                                        

  sequenceGenerationConfig                                                                                                     24                                                                                                       

  }                                                                                                                                                                                                                                     

  }                                                                                                                                                                                                                                     

  }                                                                                                                                                                                                                                     

  }                                                                                                                                                                                                                                     

  }                                                                                                                                                                                                                                     

  }                                                                                                                                                                                                                                     

  }                                                                                                                                                                                                                                     

  absThreshSS-BlocksConsolidation SEQUENCE {                                                                                                                                                                                            

  thresholdRSRP                                                                                                                57                                                                            corresponding to -909dBm   FR1

                                                                                                                               66 +Delta(NRf2)                                                               corresponding to -90dBm    FR2

  }                                                                                                                                                                                                                                     

  absThreshCSI-RS-Consolidation SEQUENCE {                                                                                                                                                                                              

  thresholdRSRP                                                                                                                57                                                                            corresponding to -99dBm    FR1

                                                                                                                               66                                                                            corresponding to -90dBm    FR2

  thresholdRSRQ                                                                                                                Not Present                                                                                              

  thresholdSINR                                                                                                                Not Present                                                                                              

  }                                                                                                                                                                                                                                     

  nrofCSI-RS-ResourcesToAverage                                                                                                2                                                                                                        

  }                                                                                                                                                                                                                                     

  NOTE 1: Delta(NRf2) is derived based on calibration procedure defined in the TS 38.508-1 \[4\], clause 6.1.3.3 on NR Cell3                                                                                                            
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table 8.1.3.1.14A.3.3-3: Void

Table 8.1.3.1.14A.3.3-4: IdMeasIdToAdd (Table 8.1.3.1.13.3.3-2)

  Derivation Path: TS 38.331 \[6\], clause 6.3.2                                                          
  ------------------------------------------------------------------------------ -------------- --------- -----------
  Information Element                                                            Value/remark   Comment   Condition
  MeasIdToAddModList::= SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {   1 entry                  
  MeasIdToAddMod\[1\] SEQUENCE {                                                                entry 1   
  measId                                                                         1                        
  measObjectId                                                                   2                        
  reportConfigId                                                                 1                        Step 1
                                                                                 2                        Step 9
  }                                                                                                       
  }                                                                                                       

Table 8.1.3.1.14A.3.3-5: Void

Table 8.1.3.1.14A.3.3-6: Void

##### 8.1.3.1.15 Void

##### 8.1.3.1.15A Measurement configuration control and reporting / Intra NR measurements / Exclude-listing

##### 8.1.3.1.15A.1 Test Purpose (TP) {#a.1-test-purpose-tp-2 .H6}

##### (1) {#section-88 .H6}

**with** { UE in NR RRC\_CONNECTED state **and** measurement configured
for event A3 reporting }

**ensure that** {

**when** { Exclude-listed neighbour cell satisfies entry condition for
event A3 }

**then** { It is not considered in event evaluation and UE does not send
*MeasurementReport* message }

}

##### (2) {#section-89 .H6}

**with** { UE in NR RRC\_CONNECTED state **and** measurement reporting
triggered by event A3 is ongoing and no neighbour cells are
exclude-listed }

**ensure that** {

**when** { Neighbour cells satisfies entry condition for event A3 }

**then** { Neighbour cells are considered in measurement reporting }

}

##### 8.1.3.1.15A.2 Conformance requirements {#a.2-conformance-requirements-2 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.5.1, 5.5.4.1, and 5.5.5. Unless
otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.5.1\]

The network may configure an RRC\_CONNECTED UE to perform measurements
and report them in accordance with the measurement configuration. The
measurement configuration is provided by means of dedicated signalling
i.e. using the *RRCReconfiguration*

\...

\- For intra-frequency and inter-frequency measurements a measurement
object indicates the frequency/time location and subcarrier spacing of
reference signals to be measured. Associated with this measurement
object, the network may configure a list of cell specific offsets, a
list of \'exclude-listed\' cells and a list of \'allow-listed\' cells.
Exclude-listed cells are not applicable in event evaluation or
measurement reporting. Allow-listed cells are the only ones applicable
in event evaluation or measurement reporting.

\...

\[TS 38.331, clause 5.5.4.1\]

The UE shall:

1\> for each measId included in the measIdList within VarMeasConfig:

...

2\> if the corresponding reportConfig includes a reportType set to
eventTriggered or periodical;

3\> if the corresponding measObject concerns NR;

3\> if the corresponding measObject concerns EUTRA:

> 4\> consider any neighbouring cell detected based on parameters in the
> associated measObjectNR to be applicable when the concerned cell is
> not included in the excludedCellsToAddModList defined within the
> VarMeasConfig for this measId;

...

2\> if the reportType is set to eventTriggered and if the entry
condition applicable for this event, i.e. the event corresponding with
the eventId of the corresponding reportConfig within VarMeasConfig, is
fulfilled for one or more applicable cells for all measurements after
layer 3 filtering taken during timeToTrigger defined for this event
within the VarMeasConfig, while the VarMeasReportList does not include a
measurement reporting entry for this measId (a first cell triggers the
event):

3\> include a measurement reporting entry within the VarMeasReportList
for this measId;

3\> set the numberOfReportsSent defined within the VarMeasReportList for
this measId to 0;

3\> include the concerned cell(s) in the cellsTriggeredList defined
within the VarMeasReportList for this measId;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the reportType is set to eventTriggered and if the entry
condition applicable for this event, i.e. the event corresponding with
the eventId of the corresponding reportConfig within VarMeasConfig, is
fulfilled for one or more applicable cells not included in the
cellsTriggeredList for all measurements after layer 3 filtering taken
during timeToTrigger defined for this event within the VarMeasConfig (a
subsequent cell triggers the event):

3\> set the numberOfReportsSent defined within the VarMeasReportList for
this measId to 0;

3\> include the concerned cell(s) in the cellsTriggeredList defined
within the VarMeasReportList for this measId;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the reportType is set to eventTriggered and if the leaving
condition applicable for this event is fulfilled for one or more of the
cells included in the cellsTriggeredList defined within the
VarMeasReportList for this measId for all measurements after layer 3
filtering taken during timeToTrigger defined within the VarMeasConfig
for this event:

3\> remove the concerned cell(s) in the cellsTriggeredList defined
within the VarMeasReportList for this measId;

3\> if reportOnLeave is set to TRUE for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the cellsTriggeredList defined within the VarMeasReportList for
this measId is empty:

4\> remove the measurement reporting entry within the VarMeasReportList
for this measId;

4\> stop the periodical reporting timer for this measId, if running;

...

\[TS 38.331, clause 5.5.5.1\]

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> for each serving cell configured with *servingCellMO:*

2\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *rsType:*

3\> if the serving cell measurements based on the *rsType included in
the reportConfig* *that triggered the measurement report are available:*

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on the *rsType* included in the *reportConfig that triggered the
measurement report;*

...

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

3\> if the reportType is set to eventTriggered:

4\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

3\> else:

...

3\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

3\> if the reportType is set to eventTriggered:

4\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

5\> if the *measObject* associated with this *measId* concerns NR:

6\> if *rsType* in the associated *reportConfig* is set to *ssb*:

7\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in order of decreasing trigger quantity,
i.e. the best cell is included first:

8\> if *reportQuantityRsIndexes* and *maxNrofRSIndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this measId by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

...

1\> if the UE is configured with EN-DC:

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

\[TS 38.331, clause 5.5.2.5\]

The UE shall:

1\> for each *measObjectId* included in the received
*measObjectToAddModList*:

2\> if an entry with the matching *measObjectId* exists in the
*measObjectList* within the *VarMeasConfig*, for this entry:

3\> reconfigure the entry with the value received for this *measObject*,
except for the fields *cellsToAddModList*, *excludedCellsToAddModList*,
*allowedCellsToAddModList*, *cellsToRemoveList*,
*excludedCellsToRemoveList* and *allowedCellsToRemoveList*;

3\> if the received *measObject* includes the *cellsToRemoveList*:

4\> for each *physCellId* included in the *cellsToRemoveList*:

5\> remove the entry with the matching *physCellId* from the
*cellsToAddModList*;

3\> if the received *measObject* includes the *cellsToAddModList*:

4\> for each *physCellId* value included in the *cellsToAddModList*:

5\> if an entry with the matching *physCellId* exists in the
*cellsToAddModList*:

6\> replace the entry with the value received for this *physCellId*;

5\> else:

6\> add a new entry for the received *physCellId* to the
*cellsToAddModList*;

3\> if the received *measObject* includes the
*excludedCellsToRemoveList*:

4\> for each *pci-RangeIndex* included in the
*excludedCellsToRemoveList*:

5\> remove the entry with the matching *pci-RangeIndex* from the
*excludedCellsToAddModList*;

NOTE: For each *pci-RangeIndex* included in the
*excludedCellsToRemoveList* that concerns overlapping ranges of cells, a
cell is removed from the excluded list of cells only if all cell indexes
containing it are removed.

3\> if the received *measObject* includes the
*excludedCellsToAddModList*:

4\> for each pci-RangeIndex included in the excludedCellsToAddModList:

5\> if an entry with the matching *pci-RangeIndex* is included in the
*excludedCellsToAddModList*:

6\> replace the entry with the value received for this *pci-RangeIndex*;

5\> else:

6\> add a new entry for the received *pci-RangeIndex* to the
*excludedCellsToAddModList*;

3\> for each *measId* associated with this *measObjectId* in the
*measIdList* within the *VarMeasConfig*, if any:

4\> remove the measurement reporting entry for this *measId* from the
*VarMeasReportList*, if included;

4\> stop the periodical reporting timer or timer T321, whichever one is
running, and reset the associated information (e.g. *timeToTrigger*) for
this *measId*;

2\> else:

3\> add a new entry for the received *measObject* to the
*measObjectList* within *VarMeasConfig*.

\[TS 38.331, clause 5.5.4.4\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A3-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A3-2, as specified below, is fulfilled;

1\> use the SpCell for *Mp*, *Ofp and Ocp*.

NOTE The cell(s) that triggers the event has reference signals indicated
in the *measObjectNR* associated to this event which may be different
from the NR SpCell *measObjectNR*.

Inequality A3-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Mp + Ofp + Ocp + Off*

Inequality A3-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Mp + Ofp + Ocp + Off*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the reference
signal of the neighbour cell (i.e. *offsetMO* as defined within
*measObjectNR* corresponding to the neighbour cell).

***Ocn*** is the cell specific offset of the neighbour cell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the frequency of the neighbour cell), and set to zero if not configured
for the neighbour cell.

***Mp*** is the measurement result of the SpCell, not taking into
account any offsets.

***Ofp*** is the measurement object specific offset of the SpCell (i.e.
*offsetMO* as defined within *measObjectNR* corresponding to the
SpCell).

***Ocp*** is the cell specific offset of the SpCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the SpCell), and is set to zero if not configured for the SpCell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Off*** is the offset parameter for this event (i.e. *a3-Offset* as
defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn***, ***Ocn***, ***Ofp***, ***Ocp***, ***Hys***, ***Off*** are
expressed in dB.

##### 8.1.3.1.15.3A Test description {#a-test-description .H6}

##### 8.1.3.1.15.3A.1 Pre-test conditions {#a.1-pre-test-conditions .H6}

##### System Simulator: {#system-simulator-34 .H6}

\- NR Cell 1, Cell 3 and Cell 12:

\- NR Cell 1 is the serving cell

\- NR Cell 3 and Cell 12 are inter-frequency neighbour cells

\- System information combination NR-4 as defined in TS 38.508-1\[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-31 .H6}

\- None

##### Preamble: {#preamble-33 .H6}

\- The UE is in state NR RRC\_CONNECTED in Established (state 3)
according to \[18\].

##### 8.1.3.1.15A.3.2 Test procedure sequence {#a.3.2-test-procedure-sequence-2 .H6}

Table 8.1.3.1.15A.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1, Cell 3 and Cell 12 at various time instants of
the test execution. Row marked \"T0\" denotes the conditions after the
preamble, while rows marked \"T1\" and \"T2\" are to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.3.1.15A.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+---------+---------+---------+---------+---------+---------+
|    | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|    | rameter |         | 1       | 3       | 12      |         |
+====+=========+=========+=========+=========+=========+=========+
| T0 | SS/PBCH | dBm/SCS | -85     | -97     | -97     | Power   |
|    | SSS     |         |         |         |         | levels  |
|    | EPRE    |         |         |         |         | are     |
|    |         |         |         |         |         | such    |
|    |         |         |         |         |         | that    |
|    |         |         |         |         |         | leaving |
|    |         |         |         |         |         | co      |
|    |         |         |         |         |         | ndition |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | event   |
|    |         |         |         |         |         | A3 is   |
|    |         |         |         |         |         | sa      |
|    |         |         |         |         |         | tisfied |
|    |         |         |         |         |         | for all |
|    |         |         |         |         |         | ne      |
|    |         |         |         |         |         | ighbour |
|    |         |         |         |         |         | NR      |
|    |         |         |         |         |         | cells:\ |
|    |         |         |         |         |         | ![](./  |
|    |         |         |         |         |         | media/i |
|    |         |         |         |         |         | mage3.w |
|    |         |         |         |         |         | mf){wid |
|    |         |         |         |         |         | th="2.4 |
|    |         |         |         |         |         | 6875in" |
|    |         |         |         |         |         | heigh   |
|    |         |         |         |         |         | t="0.15 |
|    |         |         |         |         |         | 625in"} |
+----+---------+---------+---------+---------+---------+---------+
| T1 | SS/PBCH | dBm/SCS | -85     | -79     | -97     | Power   |
|    | SSS     |         |         |         |         | levels  |
|    | EPRE    |         |         |         |         | are     |
|    |         |         |         |         |         | such    |
|    |         |         |         |         |         | that    |
|    |         |         |         |         |         | entry   |
|    |         |         |         |         |         | co      |
|    |         |         |         |         |         | ndition |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | event   |
|    |         |         |         |         |         | A3 is   |
|    |         |         |         |         |         | sa      |
|    |         |         |         |         |         | tisfied |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | i       |
|    |         |         |         |         |         | nter-fr |
|    |         |         |         |         |         | equency |
|    |         |         |         |         |         | ne      |
|    |         |         |         |         |         | ighbour |
|    |         |         |         |         |         | NR cell |
|    |         |         |         |         |         | 3       |
|    |         |         |         |         |         | \[      |
|    |         |         |         |         |         | *measId |
|    |         |         |         |         |         | 1*\]    |
|    |         |         |         |         |         |         |
|    |         |         |         |         |         | ![]     |
|    |         |         |         |         |         | (./medi |
|    |         |         |         |         |         | a/image |
|    |         |         |         |         |         | 4.wmf){ |
|    |         |         |         |         |         | width=" |
|    |         |         |         |         |         | 2.36458 |
|    |         |         |         |         |         | 3333333 |
|    |         |         |         |         |         | 3335in" |
|    |         |         |         |         |         | hei     |
|    |         |         |         |         |         | ght="0. |
|    |         |         |         |         |         | 1770833 |
|    |         |         |         |         |         | 3333333 |
|    |         |         |         |         |         | 334in"} |
+----+---------+---------+---------+---------+---------+---------+
| T2 | SS/PBCH | dBm/SCS | -85     | -79     | -79     | Power   |
|    | SSS     |         |         |         |         | levels  |
|    | EPRE    |         |         |         |         | are     |
|    |         |         |         |         |         | such    |
|    |         |         |         |         |         | that    |
|    |         |         |         |         |         | entry   |
|    |         |         |         |         |         | co      |
|    |         |         |         |         |         | ndition |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | event   |
|    |         |         |         |         |         | A3 is   |
|    |         |         |         |         |         | sa      |
|    |         |         |         |         |         | tisfied |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | i       |
|    |         |         |         |         |         | nter-fr |
|    |         |         |         |         |         | equency |
|    |         |         |         |         |         | ne      |
|    |         |         |         |         |         | ighbour |
|    |         |         |         |         |         | NR cell |
|    |         |         |         |         |         | 3 and   |
|    |         |         |         |         |         | NR Cell |
|    |         |         |         |         |         | 12      |
|    |         |         |         |         |         | \[      |
|    |         |         |         |         |         | *measId |
|    |         |         |         |         |         | 2*\]    |
|    |         |         |         |         |         |         |
|    |         |         |         |         |         | ![]     |
|    |         |         |         |         |         | (./medi |
|    |         |         |         |         |         | a/image |
|    |         |         |         |         |         | 4.wmf){ |
|    |         |         |         |         |         | width=" |
|    |         |         |         |         |         | 2.36458 |
|    |         |         |         |         |         | 3333333 |
|    |         |         |         |         |         | 3335in" |
|    |         |         |         |         |         | hei     |
|    |         |         |         |         |         | ght="0. |
|    |         |         |         |         |         | 1770833 |
|    |         |         |         |         |         | 3333333 |
|    |         |         |         |         |         | 334in"} |
+----+---------+---------+---------+---------+---------+---------+

Table 8.1.3.1.15A.3.2-1A: Time instances of cell power level and
parameter changes for FR2

+----+---------+---------+---------+---------+---------+---------+
|    | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|    | rameter |         | 1       | 3       | 12      |         |
+====+=========+=========+=========+=========+=========+=========+
| T0 | SS/PBCH | dBm/SCS | -91     | -100    | -100    | Power   |
|    | SSS     |         |         |         |         | levels  |
|    | EPRE    |         |         |         |         | are     |
|    |         |         |         |         |         | such    |
|    |         |         |         |         |         | that    |
|    |         |         |         |         |         | leaving |
|    |         |         |         |         |         | co      |
|    |         |         |         |         |         | ndition |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | event   |
|    |         |         |         |         |         | A3 is   |
|    |         |         |         |         |         | sa      |
|    |         |         |         |         |         | tisfied |
|    |         |         |         |         |         | for all |
|    |         |         |         |         |         | ne      |
|    |         |         |         |         |         | ighbour |
|    |         |         |         |         |         | NR      |
|    |         |         |         |         |         | cells:\ |
|    |         |         |         |         |         | ![](./  |
|    |         |         |         |         |         | media/i |
|    |         |         |         |         |         | mage3.w |
|    |         |         |         |         |         | mf){wid |
|    |         |         |         |         |         | th="2.4 |
|    |         |         |         |         |         | 6875in" |
|    |         |         |         |         |         | heigh   |
|    |         |         |         |         |         | t="0.15 |
|    |         |         |         |         |         | 625in"} |
+----+---------+---------+---------+---------+---------+---------+
| T1 | SS/PBCH | dBm/SCS | -91     | -82     | -100    | Power   |
|    | SSS     |         |         |         |         | levels  |
|    | EPRE    |         |         |         |         | are     |
|    |         |         |         |         |         | such    |
|    |         |         |         |         |         | that    |
|    |         |         |         |         |         | entry   |
|    |         |         |         |         |         | co      |
|    |         |         |         |         |         | ndition |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | event   |
|    |         |         |         |         |         | A3 is   |
|    |         |         |         |         |         | sa      |
|    |         |         |         |         |         | tisfied |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | i       |
|    |         |         |         |         |         | nter-fr |
|    |         |         |         |         |         | equency |
|    |         |         |         |         |         | ne      |
|    |         |         |         |         |         | ighbour |
|    |         |         |         |         |         | NR cell |
|    |         |         |         |         |         | 3       |
|    |         |         |         |         |         | \[      |
|    |         |         |         |         |         | *measId |
|    |         |         |         |         |         | 1*\]    |
|    |         |         |         |         |         |         |
|    |         |         |         |         |         | ![]     |
|    |         |         |         |         |         | (./medi |
|    |         |         |         |         |         | a/image |
|    |         |         |         |         |         | 4.wmf){ |
|    |         |         |         |         |         | width=" |
|    |         |         |         |         |         | 2.36458 |
|    |         |         |         |         |         | 3333333 |
|    |         |         |         |         |         | 3335in" |
|    |         |         |         |         |         | hei     |
|    |         |         |         |         |         | ght="0. |
|    |         |         |         |         |         | 1770833 |
|    |         |         |         |         |         | 3333333 |
|    |         |         |         |         |         | 334in"} |
+----+---------+---------+---------+---------+---------+---------+
| T2 | SS/PBCH | dBm/SCS | -91     | -82     | -82     | Power   |
|    | SSS     |         |         |         |         | levels  |
|    | EPRE    |         |         |         |         | are     |
|    |         |         |         |         |         | such    |
|    |         |         |         |         |         | that    |
|    |         |         |         |         |         | entry   |
|    |         |         |         |         |         | co      |
|    |         |         |         |         |         | ndition |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | event   |
|    |         |         |         |         |         | A3 is   |
|    |         |         |         |         |         | sat     |
|    |         |         |         |         |         | isfeied |
|    |         |         |         |         |         | for     |
|    |         |         |         |         |         | intr-fr |
|    |         |         |         |         |         | equency |
|    |         |         |         |         |         | ne      |
|    |         |         |         |         |         | ighbour |
|    |         |         |         |         |         | NR cell |
|    |         |         |         |         |         | 3 and   |
|    |         |         |         |         |         | NR Cell |
|    |         |         |         |         |         | 12      |
|    |         |         |         |         |         | \[      |
|    |         |         |         |         |         | *measId |
|    |         |         |         |         |         | 2*\]    |
|    |         |         |         |         |         |         |
|    |         |         |         |         |         | ![]     |
|    |         |         |         |         |         | (./medi |
|    |         |         |         |         |         | a/image |
|    |         |         |         |         |         | 4.wmf){ |
|    |         |         |         |         |         | width=" |
|    |         |         |         |         |         | 2.36458 |
|    |         |         |         |         |         | 3333333 |
|    |         |         |         |         |         | 3335in" |
|    |         |         |         |         |         | hei     |
|    |         |         |         |         |         | ght="0. |
|    |         |         |         |         |         | 1770833 |
|    |         |         |         |         |         | 3333333 |
|    |         |         |         |         |         | 334in"} |
+----+---------+---------+---------+---------+---------+---------+

Table 8.1.3.1.15A.3.2-2: Main behaviour

  St     Procedure                                                                                                                                                                                         Message Sequence   TP                                     Verdict   
  ------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                           U - S              Message                                          
  1      SS transmits an *RRCReconfiguration* message including *measConfig* to setup intra NR measurement and reporting for event A3.                                                                     \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  2      The UE transmits an *RRCReconfigrationComplete* message.                                                                                                                                          \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  3      SS re-adjusts the cell-specific reference signal levels according to row \"T1\" in table 8.1.31.15A.3.2.-1/1A.                                                                                    \-                 \-                                     \-        \-
  4      Check: does the UE transmit a *MeasurementReport* messages within the next 10s?                                                                                                                   \-                 NR RRC: *MeasurementReport*            1         F
  5      SS re-adjusts the cell-specific reference signal levels according to row \"T2\" in table 8.1.3.1.15A.3.2.-1/1A.                                                                                   \-                 \-                                     \-        \-
  6      Check: does the UE transmit a *MeasurementReport* message to report event A3 with the measured RSRP values for Cell 1 and Cell 12 without Cell 3 results?                                         \--\>              NR RRC: *MeasurementReport*            1         P
  7      SS transmits an *RRCReconfiguration* message including *measConfig* to remove Cell 3 from the exclude-listed cell list.                                                                           \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  8      The UE transmits an *RRCReconfigrationComplete* message                                                                                                                                           \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  \-     EXCEPTION: Steps 8Aa1 to 8Ab1 describe a transaction that depends on the UE behaviour; the \"lower case letter\" identifies a step sequence that takes place if a specific behaviour happens.     \-                 *-*                                    \-        \-
  8Aa1   IF the UE detects event A3 for Cell 12 before event A3 for Cell 3 THEN the UE may transmit *MeasurementReport* message to report event A3 with the measured RSRP values for Cell 1 and Cell 12.   \--\>              NR RRC: *MeasurementReport*            \-        \-
  8Ab1   IF the UE detects event A3 for Cell 3 before event A3 for Cell 12 THEN the UE may transmit *MeasurementReport* message to report event A3 with the measured RSRP values for Cell 1 and Cell 3.    \--\>              NR RRC: *MeasurementReport*            \-        \-
  9      Check: does the UE transmit a *MeasurementReport* message to report event A3 with the measured RSRP values for Cell 1, Cell 3 and Cell 12?                                                        \--\>              NR RRC: *MeasurementReport*            2         P
  10     SS transmits an *RRCReconfiguration* message including *measConfig* to release intra NR measurement and reporting for event A3.                                                                   \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  11     The UE transmits an *RRCReconfigrationComplete* message                                                                                                                                           \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-

##### 8.1.3.1.15A.3.3 Specific message contents {#a.3.3-specific-message-contents-2 .H6}

Table 8.1.3.1.15A.3.3-1: *RRCReconfiguration* (step 1 and Step 7 Table
8.1.3.1.15A.3.2-2)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.15A.3.3-2: *MeasConfig* (Table 8.1.3.1.15A.3.3-1)

+----------------+----------------+----------------+----------------+
| Derivation     |                |                |                |
| Path: TS       |                |                |                |
| 38.508 clause  |                |                |                |
| 4.6.3 table    |                |                |                |
| 4.6.3-69 with  |                |                |                |
| condition      |                |                |                |
| EVENT\_A3      |                |                |                |
+----------------+----------------+----------------+----------------+
| Information    | Value/remark   | Comment        | Condition      |
| Element        |                |                |                |
+----------------+----------------+----------------+----------------+
| MeasConfig ::= |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| measObje       | 2 entries      |                | Step 1 of      |
| ctToAddModList |                |                | Table          |
| SEQUENCE (SIZE |                |                | 8.1            |
| (1..m          |                |                | .3.1.15A.3.3-1 |
| axNrofMeasId)) |                |                |                |
| OF             |                |                |                |
| Meas           |                |                |                |
| ObjectToAddMod |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| MeasObjec      |                | entry 1        |                |
| tToAddMod\[1\] |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| measObjectId   | 1              |                |                |
+----------------+----------------+----------------+----------------+
| measObject     |                |                |                |
| CHOICE {       |                |                |                |
+----------------+----------------+----------------+----------------+
| measObjectNR   | M              | Table          |                |
|                | easObjectNR-f1 | 8.1.           |                |
|                |                | 3.1.15A.3.3-2A |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| MeasObjec      |                | entry 2        |                |
| tToAddMod\[2\] |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| measObjectId   | 2              |                |                |
+----------------+----------------+----------------+----------------+
| measObject     |                |                |                |
| CHOICE {       |                |                |                |
+----------------+----------------+----------------+----------------+
| measObjectNR   | M              | Table          |                |
|                | easObjectNR-f2 | 8.1            |                |
|                |                | .3.1.15A.3.3-3 |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measObje       | 1 entry        |                | Step 7 of      |
| ctToAddModList |                |                | Table          |
| SEQUENCE (SIZE |                |                | 8.1            |
| (1..m          |                |                | .3.1.15A.3.3-1 |
| axNrofMeasId)) |                |                |                |
| OF             |                |                |                |
| Meas           |                |                |                |
| ObjectToAddMod |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| MeasObjec      |                | entry 1        |                |
| tToAddMod\[1\] |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| measObjectId   | 2              |                |                |
+----------------+----------------+----------------+----------------+
| measObject     |                |                |                |
| CHOICE {       |                |                |                |
+----------------+----------------+----------------+----------------+
| measObjectNR   | M              | Table          |                |
|                | easObjectNR-f2 | 8.1            |                |
|                |                | .3.1.15A.3.3-5 |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measObje       | Not present    |                | Step 10 of     |
| ctToAddModList |                |                | Table          |
|                |                |                | 8.1            |
|                |                |                | .3.1.15A.3.3-1 |
+----------------+----------------+----------------+----------------+
| reportConf     | 1 entry        |                | Step 1 of      |
| igToAddModList |                |                | Table          |
| SEQUENCE(SIZE  |                |                | 8.1            |
| (1..maxRe      |                |                | .3.1.15A.3.3-1 |
| portConfigId)) |                |                |                |
| OF             |                |                |                |
| Report         |                |                |                |
| ConfigToAddMod |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| ReportConfi    |                | entry 1        |                |
| gToAddMod\[1\] |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| reportConfigId | ReportConfigId |                |                |
+----------------+----------------+----------------+----------------+
| reportConfig   |                |                |                |
| CHOICE {       |                |                |                |
+----------------+----------------+----------------+----------------+
| reportConfigNR | Rep            | a3-Offset      |                |
|                | ortConfigNR(2) | value set to 1 |                |
|                |                | dB (2\*0.5 dB) |                |
|                | Same as TS     |                |                |
|                | 38.508-1 Table |                |                |
|                | 4.6.3-142      |                |                |
|                | except for     |                |                |
|                | reportAmount   |                |                |
|                | set to 'r1'    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| reportConf     | Not present    |                | Step 7 or 10   |
| igToAddModList |                |                | of Table       |
|                |                |                | 8.1            |
|                |                |                | .3.1.15A.3.3-1 |
+----------------+----------------+----------------+----------------+
| meas           | 1 entry        |                | Step 10 of     |
| IdToRemoveList |                |                | Table          |
| SEQUENCE (SIZE |                |                | 8.1            |
| (1..m          |                |                | .3.1.15A.3.3-1 |
| axNrofMeasId)) |                |                |                |
| OF MeasId {    |                |                |                |
+----------------+----------------+----------------+----------------+
| MeasId\[1\]    | 1              | entry 1        |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| meas           | 1 entry        |                | Step 1 of      |
| IdToAddModList |                |                | Table          |
| SEQUENCE (SIZE |                |                | 8.1            |
| (1..m          |                |                | .3.1.15A.3.3-1 |
| axNrofMeasId)) |                |                |                |
| OF             |                |                |                |
| MeasIdToAddMod |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| MeasI          |                |                |                |
| dToAddMod\[1\] |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| measId         | 1              |                |                |
+----------------+----------------+----------------+----------------+
| measObjectId   | 2              |                |                |
+----------------+----------------+----------------+----------------+
| reportConfigId | ReportConfigId |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| meas           | Not present    |                | Step 7 or 10   |
| IdToAddModList |                |                | of Table       |
|                |                |                | 8.1            |
|                |                |                | .3.1.15A.3.3-1 |
+----------------+----------------+----------------+----------------+
| measGapConfig  | MeasGapConfig  |                |                |
|                | with condition |                |                |
|                | I              |                |                |
|                | NTER-FREQ\_ODD |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+

Table 8.1.3.1.15A.3.3-2A: MeasObjectNR-f1 (Table 8.1.3.1.15A.3.3-2)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.15A.3.3-3: MeasObjectNR-f2 (Table 8.1.3.1.15A.3.3-2)

  ----------------------------------------------------------------------------------------- ---------------------------------------- ------------ -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                              
  Information Element                                                                       Value/remark                             Comment      Condition
  MeasObjectNR::= SEQUENCE {                                                                                                                      
  ssbFrequency                                                                              ARFCN-ValueNR for SSB of NR Cell 3                    
  smtc1                                                                                     SSB-MTC with condition INTER-FREQ\_ODD                
  absThreshSS-BlocksConsolidation                                                           Not present                                           
  nrofSS-BlocksToAverage                                                                    Not present                                           
  excludedCellsToAddModList SEQUENCE (SIZE (1.. maxNrofPCI-Ranges)) OF PCI-RangeElement {   1 entry                                  Add Cell 3   
  PCI-RangeElement\[1\] SEQUENCE {                                                                                                   entry 1      
  PCI-RangeIndex                                                                            1                                                     
  pci-Range SEQUENCE {                                                                                                                            
  start                                                                                     physicalCellIdentity-Cell3                            
  range                                                                                     Not present                                           
  }                                                                                                                                               
  }                                                                                                                                               
  }                                                                                                                                               
  }                                                                                                                                               
  ----------------------------------------------------------------------------------------- ---------------------------------------- ------------ -----------

Table 8.1.3.1.15A.3.3-4: *MeasurementReport* (step 6, Table
8.1.3.1.15A.3.2-2)

  ---------------------------------------------------------------------------------------- ------------------------------ ---------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] clause 4.6.1 table 4.6.1-5A                                                                           
  Information Element                                                                      Value/remark                   Comment          Condition
  MeasurementReport ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                              
  c1 CHOICE {                                                                                                                              
  measurementReport SEQUENCE {                                                                                                             
  measResults SEQUENCE {                                                                                                                   
  measId                                                                                   1                                               
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                         
  MeasResultServMO\[1\] SEQUENCE {                                                                                        entry 1          
  servCellId                                                                               ServCellIndex - Cell1                           
  measResultServingCell SEQUENCE {                                                                                        Report Cell 1    
  physCellId                                                                               physicalCellIdentity-Cell1                      
  measResult SEQUENCE {                                                                                                                    
  cellResults SEQUENCE {                                                                                                                   
  resultsSSB-Cell SEQUENCE {                                                                                                               
  rsrp                                                                                     (0..127)                                        
  rsrq                                                                                     (0..127)                                        
                                                                                           (0..127)                                        pc\_ss\_SINR\_Meas
  sinr                                                                                     Not present                                     
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  measResultNeighCells CHOICE {                                                                                                            
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                    1 entry                        Report Cell 12   
  MeasResultNR\[1\] SEQUENCE {                                                                                            entry 1          
  physCellId                                                                               physicalCellIdentity-Cell 12                    
  measResult SEQUENCE {                                                                                                                    
  cellResults SEQUENCE {                                                                                                                   
  resultsSSB-Cell SEQUENCE {                                                                                                               
  rsrp                                                                                     (0..127)                                        
  rsrq                                                                                     (0..127)                                        
  sinr                                                                                     (0..127)                                        pc\_ss\_SINR\_Meas
                                                                                           Not present                                     
  }                                                                                                                                        
  resultsCSI-RS-Cell                                                                       Not present                                     
  }                                                                                                                                        
  rsIndexResults                                                                           Not present                                     
  }                                                                                                                                        
  cgi-Info                                                                                 Not present                                     
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  ---------------------------------------------------------------------------------------- ------------------------------ ---------------- --------------------

Table 8.1.3.1.15A.3.3-5: MeasObjectNR-f2 (Step 7 Table
8.1.3.1.15A.3.3-2)

  ----------------------------------------------------------------------------------------- ---------------------------------------- --------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                                 
  Information Element                                                                       Value/remark                             Comment         Condition
  MeasObjectNR::= SEQUENCE {                                                                                                                         
  ssbFrequency                                                                              ARFCN-ValueNR for SSB of NR Cell 3                       
  smtc1                                                                                     SSB-MTC with condition INTER-FREQ\_ODD                   
  absThreshSS-BlocksConsolidation                                                           Not present                                              
  nrofSS-BlocksToAverage                                                                    Not present                                              
  excludedCellsToRemoveList SEQUENCE (SIZE (1.. maxNrofPCI-Ranges)) OF PCI-RangeElement {   1 entry                                  Remove Cell 3   
  PCI-RangeIndex \[1\]                                                                      physicalCellIdentity-Cell3               entry 1         
  }                                                                                                                                                  
  }                                                                                                                                                  
  ----------------------------------------------------------------------------------------- ---------------------------------------- --------------- -----------

Table 8.1.3.1.15A.3.3-6: *MeasurementReport* (step 8Aa1, Table
8.1.3.1.15A.3.2-2)

  ----------------------------------------------------------------------------------------- ------------------------------ ---------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] clause 4.6.1 table 4.6.1-5A                                                                            
  Information Element                                                                       Value/remark                   Comment          Condition
  MeasurementReport ::= SEQUENCE {                                                                                                          
  criticalExtensions CHOICE {                                                                                                               
  c1 CHOICE {                                                                                                                               
  measurementReport SEQUENCE {                                                                                                              
  measResults SEQUENCE {                                                                                                                    
  measId                                                                                    1                                               
  measResultServingMOList SEQUENCE (SIZE (1.. maxNrofServingCells)) OF MeasResultServMO {   1 entry                                         
  MeasResultServMO\[1\] SEQUENCE {                                                                                         entry 1          
  servCellId                                                                                ServCellIndex -- Cell1                          
  measResultServingCell SEQUENCE {                                                                                         Report Cell 1    
  physCellId                                                                                physicalCellIdentity-Cell1                      
  measResult SEQUENCE {                                                                                                                     
  cellResults SEQUENCE {                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                
  rsrp                                                                                      (0..127)                                        
  rsrq                                                                                      (0..127)                                        
  sinr                                                                                      (0..127)                                        pc\_ss\_SINR\_Meas
                                                                                            Not present                                     
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  measResultNeighCells CHOICE {                                                                                                             
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                     1 entry                        Report Cell 12   
  MeasResultNR\[1\] SEQUENCE {                                                                                             entry 1          
  physCellId                                                                                physicalCellIdentity-Cell 12                    
  measResult SEQUENCE {                                                                                                                     
  cellResults SEQUENCE {                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                
  rsrp                                                                                      (0..127)                                        
  rsrq                                                                                      (0..127)                                        
  sinr                                                                                      (0..127)                                        pc\_ss\_SINR\_Meas
                                                                                            Not present                                     
  }                                                                                                                                         
  resultsCSI-RS-Cell                                                                        Not present                                     
  }                                                                                                                                         
  rsIndexResults                                                                            Not present                                     
  }                                                                                                                                         
  cgi-Info                                                                                  Not present                                     
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ----------------------------------------------------------------------------------------- ------------------------------ ---------------- --------------------

Table 8.1.3.1.15A.3.3-7: *MeasurementReport* (step 8Ab1, Table
8.1.3.1.15A.3.2-2)

  ----------------------------------------------------------------------------------------- ---------------------------- --------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] clause 4.6.1 table 4.6.1-5A                                                                         
  Information Element                                                                       Value/remark                 Comment         Condition
  MeasurementReport ::= SEQUENCE {                                                                                                       
  criticalExtensions CHOICE {                                                                                                            
  c1 CHOICE {                                                                                                                            
  measurementReport SEQUENCE {                                                                                                           
  measResults SEQUENCE {                                                                                                                 
  measId                                                                                    1                                            
  measResultServingMOList SEQUENCE (SIZE (1.. maxNrofServingCells)) OF MeasResultServMO {   1 entry                                      
  MeasResultServMO\[1\] SEQUENCE {                                                                                       entry 1         
  servCellId                                                                                ServCellIndex -- Cell1                       
  measResultServingCell SEQUENCE {                                                                                       Report Cell 1   
  physCellId                                                                                physicalCellIdentity-Cell1                   
  measResult SEQUENCE {                                                                                                                  
  cellResults SEQUENCE {                                                                                                                 
  resultsSSB-Cell SEQUENCE {                                                                                                             
  rsrp                                                                                      (0..127)                                     
  rsrq                                                                                      (0..127)                                     
  sinr                                                                                      (0..127)                                     pc\_ss\_SINR\_Meas
                                                                                            Not Present                                  
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  measResultNeighCells CHOICE {                                                                                                          
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                     1 entry                      Report Cell 3   
  MeasResultNR\[1\] SEQUENCE {                                                                                           entry 1         
  physCellId\[1\]                                                                           physicalCellIdentity-Cell3                   
  measResult \[1\] SEQUENCE {                                                                                                            
  cellResults SEQUENCE {                                                                                                                 
  resultsSSB-Cell SEQUENCE {                                                                                                             
  rsrp                                                                                      (0..127)                                     
  rsrq                                                                                      (0..127)                                     
  sinr                                                                                      (0..127)                                     pc\_ss\_SINR\_Meas
                                                                                            Not Present                                  
  }                                                                                                                                      
  resultsCSI-RS-Cell                                                                        Not present                                  
  }                                                                                                                                      
  rsIndexResults                                                                            Not present                                  
  }                                                                                                                                      
  cgi-Info                                                                                  Not present                                  
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  ----------------------------------------------------------------------------------------- ---------------------------- --------------- --------------------

Table 8.1.3.1.15A.3.3-8: *MeasurementReport* (step 9, Table
8.1.3.1.15A.3.2-2)

  ----------------------------------------------------------------------------------------- ------------------------------------------------- --------------------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] clause 4.6.1 table 4.6.1-5A                                                                                                          
  Information Element                                                                       Value/remark                                      Comment                     Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                             
  c1 CHOICE {                                                                                                                                                             
  measurementReport SEQUENCE {                                                                                                                                            
  measResults SEQUENCE {                                                                                                                                                  
  measId                                                                                    1                                                                             
  measResultServingMOList SEQUENCE (SIZE (1.. maxNrofServingCells)) OF MeasResultServMO {   1 entry                                                                       
  MeasResultServMO\[1\] SEQUENCE {                                                                                                            entry 1                     
  servCellId                                                                                ServCellIndex -- Cell1                                                        
  measResultServingCell SEQUENCE {                                                                                                            Report Cell 1               
  physCellId                                                                                physicalCellIdentity-Cell1                                                    
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                      (0..127)                                                                      
  rsrq                                                                                      (0..127)                                                                      
  sinr                                                                                      (0..127)                                                                      pc\_ss\_SINR\_Meas
                                                                                            Not Present                                                                   
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  measResultNeighCells CHOICE {                                                                                                                                           
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                     2 entries that may appear in an arbitrary order   Report Cell 3 and Cell 12   
  MeasResultNR\[1\] SEQUENCE {                                                                                                                entry 1                     
  physCellId                                                                                physicalCellIdentity-Cell3                                                    
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                      (0..127)                                                                      
  rsrq                                                                                      (0..127)                                                                      
  sinr                                                                                      (0..127)                                                                      pc\_ss\_SINR\_Meas
                                                                                            Not Present                                                                   
  }                                                                                                                                                                       
  resultsCSI-RS-Cell                                                                        Not present                                                                   
  }                                                                                                                                                                       
  rsIndexResults                                                                            Not present                                                                   
  }                                                                                                                                                                       
  cgi-Info                                                                                  Not present                                                                   
  }                                                                                                                                                                       
  MeasResultNR\[2\] SEQUENCE {                                                                                                                entry 2                     
  physCellId                                                                                physicalCellIdentity-Cell 12                                                  
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                      (0..127)                                                                      
  rsrq                                                                                      (0..127)                                                                      
  sinr                                                                                      (0..127)                                                                      pc\_ss\_SINR\_Meas
                                                                                            Not Present                                                                   
  }                                                                                                                                                                       
  resultsCSI-RS-Cell                                                                        Not present                                                                   
  }                                                                                                                                                                       
  rsIndexResults                                                                            Not present                                                                   
  }                                                                                                                                                                       
  cgi-Info                                                                                  Not present                                                                   
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  ----------------------------------------------------------------------------------------- ------------------------------------------------- --------------------------- --------------------

##### 8.1.3.1.16 Measurement configuration control and reporting / Intra NR measurements / Allow-listing

##### 8.1.3.1.16.1 Test Purpose (TP) {#test-purpose-tp-46 .H6}

##### (1) {#section-90 .H6}

**with { UE in NR RRC\_CONNECTED state and measurement configured for
event A3 reporting }**

**ensure that {**

**when { Neighbour cell not listed as an allowed cell satisfies entry
condition for event A3 }**

**then { It is not considered in event evaluation and UE does not send
MeasurementReport message }**

**}**

##### (2) {#section-91 .H6}

**with { UE in NR RRC\_CONNECTED state and measurement reporting
triggered by event A3 is ongoing and all of the neighbour cells are
allowed-listed }**

**ensure that {**

**when { Neighbour cells satisfies entry condition for event A3 }**

**then { Neighbour cells are considered in measurement reporting }**

**}**

##### 8.1.3.1.16.2 Conformance requirements {#conformance-requirements-46 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.2.9, 5.5.4.1,
5.5.4.6 and 5.5.5. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(MCG is E-UTRA):

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

3\> if the corresponding *measObject* concerns NR:

...

4\> if the *eventA3* or *eventA5* is configured in the corresponding
*reportConfig*:

5\> if a serving cell is associated with a *measObjectNR* and neighbours
are associated with another *measObjectNR*, consider any serving cell
associated with the other *measObjectNR* to be a neighbouring cell as
well;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

> ...

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

...

\[TS 38.331, clause 5.5.4.4\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A3-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A3-2, as specified below, is fulfilled;

1\> use the SpCell for *Mp*, *Ofp and Ocp*.

NOTE The cell(s) that triggers the event has reference signals indicated
in the *measObjectNR* associated to this event which may be different
from the NR SpCell *measObjectNR*.

Inequality A3-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Mp + Ofp + Ocp + Off*

Inequality A3-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Mp + Ofp + Ocp + Off*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the reference
signal of the neighbour cell (i.e. *offsetMO* as defined within
*measObjectNR* corresponding to the neighbour cell).

***Ocn*** is the cell specific offset of the neighbour cell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the frequency of the neighbour cell), and set to zero if not configured
for the neighbour cell.

***Mp*** is the measurement result of the SpCell, not taking into
account any offsets.

***Ofp*** is the measurement object specific offset of the SpCell (i.e.
*offsetMO* as defined within *measObjectNR* corresponding to the
SpCell).

***Ocp*** is the cell specific offset of the SpCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the SpCell), and is set to zero if not configured for the SpCell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Off*** is the offset parameter for this event (i.e. *a3-Offset* as
defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn***, ***Ocn***, ***Ofp***, ***Ocp***, ***Hys***, ***Off*** are
expressed in dB.

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with
*servingCellMO*, RSRP, RSRQ and the available SINR, derived based on the
*rsType* if indicated in the associated *reportConfig,* otherwise based
on SSB if available, otherwise based on CSI-RS;

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

> ...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

> ...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.16.3 Test description {#test-description-46 .H6}

##### 8.1.3.1.16.3.1 Pre-test conditions {#pre-test-conditions-46 .H6}

System Simulator:

\- NR Cell 1 is the PCell, NR Cell 2 and NR Cell 4 are the
intra-frequency neighbour cells of NR Cell 1.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.1.16.3.2 Test procedure sequence {#test-procedure-sequence-47 .H6}

Table 8.1.3.1.16.3.2-1 and 8.1.3.1.16.3.2-2 illustrates the downlink
power levels to be applied for NR Cell 1, NR Cell 2 and NR Cell 4 at
various time instants of the test execution. Row marked \"T0\" denotes
the conditions after the preamble, while the configuration marked \"T1\"
is applied at the point indicated in the Main behaviour description in
Table 8.1.3.1.16.3.2-3.

Table 8.1.3.1.16.3.2-1: Time instances of cell power level and parameter
changes for NR Cell 1, 2, 4 in FR1

+----+--------------+------+--------+--------+--------+--------------+
|    | Parameter    | Unit | NR     | NR     | NR     | Remark       |
|    |              |      |        |        |        |              |
|    |              |      | Cell 1 | Cell 2 | Cell 4 |              |
+====+==============+======+========+========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -85    | -91    | -91    | Power levels |
|    | EPRE         |      |        |        |        | are such     |
|    |              | SCS  |        |        |        | that entry   |
|    |              |      |        |        |        | condition    |
|    |              |      |        |        |        | for event A3 |
|    |              |      |        |        |        | (measId 1)   |
|    |              |      |        |        |        | is not       |
|    |              |      |        |        |        | satisfied:   |
|    |              |      |        |        |        |              |
|    |              |      |        |        |        | *Mn + Ofn +  |
|    |              |      |        |        |        | Ocn -- Hys*  |
|    |              |      |        |        |        | ≦ *Mp + Ofp  |
|    |              |      |        |        |        | + Ocp + Off* |
+----+--------------+------+--------+--------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -85    | -78    | -91    | Power levels |
|    | EPRE         |      |        |        |        | are such     |
|    |              | SCS  |        |        |        | that entry   |
|    |              |      |        |        |        | condition    |
|    |              |      |        |        |        | for event A3 |
|    |              |      |        |        |        | (measId 1)   |
|    |              |      |        |        |        | is           |
|    |              |      |        |        |        | satisfied:   |
|    |              |      |        |        |        |              |
|    |              |      |        |        |        | *Mn + Ofn +  |
|    |              |      |        |        |        | Ocn -- Hys   |
|    |              |      |        |        |        | \> Mp + Ofp  |
|    |              |      |        |        |        | + Ocp + Off* |
+----+--------------+------+--------+--------+--------+--------------+
| T2 | SS/PBCH SSS  | dBm/ | -85    | -91    | -91    | Power levels |
|    | EPRE         |      |        |        |        | are such     |
|    |              | SCS  |        |        |        | that entry   |
|    |              |      |        |        |        | condition    |
|    |              |      |        |        |        | for event A3 |
|    |              |      |        |        |        | (measId 1)   |
|    |              |      |        |        |        | is not       |
|    |              |      |        |        |        | satisfied:   |
|    |              |      |        |        |        |              |
|    |              |      |        |        |        | *Mn + Ofn +  |
|    |              |      |        |        |        | Ocn -- Hys*  |
|    |              |      |        |        |        | ≦ *Mp + Ofp  |
|    |              |      |        |        |        | + Ocp + Off* |
+----+--------------+------+--------+--------+--------+--------------+

Table 8.1.3.1.16.3.2-2: Time instances of cell power level and parameter
changes for NR Cell 1, 2, 4 in FR2

+----+-----------+------+--------+--------+--------+--------------+
|    | Parameter | Unit | NR     | NR     | NR     | Remark       |
|    |           |      |        |        |        |              |
|    |           |      | Cell 1 | Cell 2 | Cell 4 |              |
+====+===========+======+========+========+========+==============+
| T0 | SS/PBCH   | dBm/ | -91    | -100   | -100   | Power levels |
|    |           |      |        |        |        | are such     |
|    | SSS EPRE  | SCS  |        |        |        | that entry   |
|    |           |      |        |        |        | condition    |
|    |           |      |        |        |        | for event A3 |
|    |           |      |        |        |        | (measId 1)   |
|    |           |      |        |        |        | is not       |
|    |           |      |        |        |        | satisfied:   |
|    |           |      |        |        |        |              |
|    |           |      |        |        |        | *Mn + Ofn +  |
|    |           |      |        |        |        | Ocn -- Hys*  |
|    |           |      |        |        |        | ≦ *Mp + Ofp  |
|    |           |      |        |        |        | + Ocp + Off* |
+----+-----------+------+--------+--------+--------+--------------+
| T1 | SS/PBCH   | dBm/ | -91    | -82    | -100   | Power levels |
|    |           |      |        |        |        | are such     |
|    | SSS EPRE  | SCS  |        |        |        | that entry   |
|    |           |      |        |        |        | condition    |
|    |           |      |        |        |        | for event A3 |
|    |           |      |        |        |        | (measId 1)   |
|    |           |      |        |        |        | is           |
|    |           |      |        |        |        | satisfied:   |
|    |           |      |        |        |        |              |
|    |           |      |        |        |        | *Mn + Ofn +  |
|    |           |      |        |        |        | Ocn -- Hys   |
|    |           |      |        |        |        | \> Mp + Ofp  |
|    |           |      |        |        |        | + Ocp + Off* |
+----+-----------+------+--------+--------+--------+--------------+
| T2 | SS/PBCH   | dBm/ | -91    | -100   | -100   | Power levels |
|    |           |      |        |        |        | are such     |
|    | SSS EPRE  | SCS  |        |        |        | that entry   |
|    |           |      |        |        |        | condition    |
|    |           |      |        |        |        | for event A3 |
|    |           |      |        |        |        | (measId 1)   |
|    |           |      |        |        |        | is not       |
|    |           |      |        |        |        | satisfied:   |
|    |           |      |        |        |        |              |
|    |           |      |        |        |        | *Mn + Ofn +  |
|    |           |      |        |        |        | Ocn -- Hys*  |
|    |           |      |        |        |        | ≦ *Mp + Ofp  |
|    |           |      |        |        |        | + Ocp + Off* |
+----+-----------+------+--------+--------+--------+--------------+

Table 8.1.3.1.16.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                 Message Sequence   TP                                     Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                 U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup NR measurement and reporting for intra-frequency event A3 (*measId* 1)   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                 \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.1.16.3.2-1/2.                                               \-                 *-*                                    \-        \-
  4    Check: Does the UE transmit a *MeasurementReport* message within the next 30s?                                                                            \--\>              *NR RRC: MeasurementReport*            1         F
  5    The SS transmits an *RRCReconfiguration* message *including* both NR Cell 2 and NR Cell 4 in *allowedCellsToAddModList*                                   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  6    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                 \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  7    Wait and ignore *MeasurementReport* messages for 10s to allow UE measurement                                                                              \-                 *-*                                    \-        \-
  8    Check: Does the UE transmit a *MeasurementReport* message to report event A3 (*measId* 1) with the measured RSRP value for NR Cell 2?                     \--\>              *NR RRC: MeasurementReport*            2         P
  9    SS re-adjusts the cell-specific reference signal level according to row \"T2\" in table 8.1.3.1.16.3.2-1/2.                                               \-                 *-*                                    \-        \-
  10   Wait and ignore MeasurementReport messages for 10s to allow change of power levels for NR Cell 2 and UE measurement                                       \-                 *-*                                    \-        \-
  11   Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                                            *-*                *-*                                    2         F

##### 8.1.3.1.16.3.3 Specific message contents {#specific-message-contents-38 .H6}

Table 8.1.3.1.16.3.3-1: *RRCReconfiguration* (step 1 and 5, Table
8.1.3.1.16.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.16.3.3-2: *MeasConfig* (Table 8.1.3.1.16.3.3-1)

  ------------------------------------------------------------------------------------------ -------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                               
  Information Element                                                                        Value/remark               Comment   Condition
  MeasConfig ::= SEQUENCE {                                                                                                       
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                              
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                    entry 1   
  measObjectId                                                                               1                                    
  measObject CHOICE {                                                                                                             
  measObjectNR                                                                               MeasObjectNR-f1                      Step 1
                                                                                             MeasObjectNR-allowedlist             Step 5
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  reportConfigToAddModList                                                                   Not present                          Step 5
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                              Step 1
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                  entry 1   
  reportConfigId                                                                             1                                    
  reportConfig CHOICE {                                                                                                           
  reportConfigNR                                                                             ReportConfigNR-EventA3               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  measIdToAddModList                                                                         Not present                          Step 5
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                              Step 1
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                        entry 1   
  measId                                                                                     1                                    
  measObjectId                                                                               1                                    
  reportConfigId                                                                             1                                    
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  ------------------------------------------------------------------------------------------ -------------------------- --------- -----------

Table 8.1.3.1.16.3.3-3: *MeasObjectNR-f1* (Table 8.1.3.1.16.3.3-2)

  --------------------------------------------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                     
  Information Element                                                                     Value/remark                         Comment   Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                            
  ssbFrequency                                                                            ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                                                         Not present                                    
  nrofSS-BlocksToAverage                                                                  Not present                                    
  allowedCellsToAddModList SEQUENCE(SIZE (1.. maxNrofPCI-Ranges)) OF PCI-RangeElement {   1 entry                                        
  PCI-RangeElement\[1\] SEQUENCE {                                                                                             entry 1   
  pci-RangeIndex                                                                          1                                              
  pci-Range SEQUENCE {                                                                                                                   
  start                                                                                   900                                            
  range                                                                                   Not present                                    
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  --------------------------------------------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.16.3.3-4: *MeasObjectNR-allowedlist* (Table
8.1.3.1.16.3.3-2)

  --------------------------------------------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                     
  Information Element                                                                     Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                                                             
  ssbFrequency                                                                            ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                                                         Not present                                    
  nrofSS-BlocksToAverage                                                                  Not present                                    
  allowedCellsToAddModList SEQUENCE (SIZE (1..maxNrofPCI-Ranges)) OF PCI-RangeElement {   2 entries                                      
  PCI-RangeElement\[1\] SEQUENCE {                                                                                             entry 1   
  pci-RangeIndex                                                                          1                                              
  pci-Range SEQUENCE {                                                                                                                   
  start                                                                                   PhyCellId of NR Cell 2                         
  range                                                                                   n4                                             
  }                                                                                                                                      
  }                                                                                                                                      
  PCI-RangeElement\[2\] SEQUENCE {                                                                                             entry 2   
  pci-RangeIndex                                                                          2                                              
  pci-Range SEQUENCE {                                                                                                                   
  start                                                                                   PhyCellId of NR Cell 4                         
  range                                                                                   n4                                             
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  }                                                                                                                                      
  --------------------------------------------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.16.3.3-5: *ReportConfigNR-EventA3* (Table
8.1.3.1.16.3.3-2)

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition EVENT\_A3                            
  Information Element                                                           Value/remark   Comment   Condition
  ReportConfigNR ::= SEQUENCE {                                                                          
  reportType CHOICE {                                                                                    
  eventTriggered SEQUENCE {                                                                              
  eventId CHOICE {                                                                                       
  eventA3 SEQUENCE {                                                                                     
  a3-Offset CHOICE {                                                                                     
  rsrp                                                                          0              0dB       
  }                                                                                                      
  useAllowedCellList                                                            TRUE                     
  }                                                                                                      
  }                                                                                                      
  reportInterval                                                                ms10240                  
  reportAmount                                                                  infinity                 
  reportQuantityCell SEQUENCE {                                                                          
  rsrp                                                                          true                     
  rsrq                                                                          false                    
  sinr                                                                          false                    
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.3.1.16.3.3-6: *MeasurementReport* (step 8, Table
8.1.3.1.16.3.2-3)

  ---------------------------------------------------------------------------------------- ---------------------------- ---------------------------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                        
  Information Element                                                                      Value/remark                 Comment                            Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                         
  criticalExtensions CHOICE {                                                                                                                              
  measurementReport SEQUENCE {                                                                                                                             
  measResults SEQUENCE {                                                                                                                                   
  measId                                                                                   1                                                               
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                      Measurement report for NR Cell 1   
  MeasResultServMO\[1\] SEQUENCE {                                                                                      entry 1                            
  servCellId                                                                               ServCellIndex of NR Cell 1                                      
  measResultServingCell SEQUENCE {                                                                                                                         
  physCellId                                                                               PhysCellId of NR Cell 1                                         
  measResult SEQUENCE {                                                                                                                                    
  cellResults SEQUENCE {                                                                                                                                   
  resultsSSB-Cell SEQUENCE {                                                                                                                               
  rsrp                                                                                     (0..127)                                                        
  rsrq                                                                                     (0..127)                                                        
  sinr                                                                                     Not present                                                     
                                                                                           Not checked                                                     pc\_ss\_SINR\_Meas
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  measResultNeighCells CHOICE {                                                                                                                            
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                      Measurement report for NR Cell 2   
  MeasResultNR\[1\] SEQUENCE {                                                                                          entry 1                            
  physCellId                                                                               PhysCellId of NR Cell 2                                         
  measResult SEQUENCE {                                                                                                                                    
  cellResults SEQUENCE {                                                                                                                                   
  resultsSSB-Cell SEQUENCE {                                                                                                                               
  rsrp                                                                                     (0..127)                                                        
  rsrq                                                                                     Not present                                                     
  sinr                                                                                     Not present                                                     
  }                                                                                                                                                        
  resultsCSI-RS-Cell                                                                       Not present                                                     
  }                                                                                                                                                        
  rsIndexResults                                                                           Not present                                                     
  }                                                                                                                                                        
  cgi-Info                                                                                 Not present                                                     
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  ---------------------------------------------------------------------------------------- ---------------------------- ---------------------------------- --------------------

##### 8.1.3.1.17 NR CA / Measurement configuration control and reporting / Intra NR measurements / Event A6

###### 8.1.3.1.17.1 NR CA / Measurement configuration control and reporting / Intra NR measurements / Event A6 / Intra-band Contiguous CA

##### 8.1.3.1.17.1.1 Test Purpose (TP) {#test-purpose-tp-47 .H6}

##### (1) {#section-92 .H6}

**with { UE in NR RRC\_CONNECTED state and measurements configured for
event A6 }**

**ensure that {**

**when { Entry condition for event A6 is not met }**

**then { UE does not send *MeasurementReport* }**

**}**

##### (2) {#section-93 .H6}

**with { UE in NR RRC\_CONNECTED state and measurements configured for
event A6 }**

**ensure that {**

**when { Intra-frequency neighbour becomes offset better than SCell }**

**then { UE sends *MeasurementReport* with correct measId for event A6
}**

**}**

##### (3) {#section-94 .H6}

**with { UE in NR RRC\_CONNECTED state and measurements configured for
event A6 }**

**ensure that {**

**when { UE receives a *RRCReconfiguration* message containing
*sCellToReleaseList* with a sCellIndex equal to one of the current UE
SCell configuration }**

**then { UE stops sending *MeasurementReport* message }**

**}**

##### 8.1.3.1.17.1.2 Conformance requirements {#conformance-requirements-47 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.3.5.5.9, 5.5.2.1, 5.5.4.1,
5.5.4.7 and 5.5.5. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(UE in (NG)EN-DC):

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

2\> if this is the first *RRCReconfiguration* message after successful
completion of the RRC re-establishment procedure:

3\> resume SRB2 and DRBs that are suspended;

...

\[TS 38.331, clause 5.3.5.5.9\]

The UE shall:

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is not part of the current UE configuration (SCell addition):

2\> add the SCell, corresponding to the *sCellIndex*, in accordance with
the *sCellConfigCommon* and *sCellConfigDedicated*;

2\> configure lower layers to consider the SCell to be in deactivated
state;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

3\> if SCells are not applicable for the associated measurement; and

3\> if the concerned SCell is included in *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*:

4\> remove the concerned SCell from *cellsTriggeredList* defined within
the *VarMeasReportList* for this *measId*;

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is part of the current UE configuration (SCell modification):

2\> modify the SCell configuration in accordance with the
*sCellConfigDedicated*.

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

> 1\> if the received *measConfig* includes the *measIdToRemoveList*:
>
> 2\> perform the measurement identity removal procedure as specified in
> 5.5.2.2;

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig*includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

...

4\> for measurement events other than *eventA1* or *eventA2*:

5\> if *useWhiteCellList* is set to *true*:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
included in the *whiteCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
not included in the *blackCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

> ...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> if the *reportType* is set to *eventTriggered* and if the leaving
condition applicable for this event is fulfilled for one or more of the
cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *TRUE* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

> ...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

> ...

\[TS 38.331, clause 5.5.4.7\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A6-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A6-2, as specified below, is fulfilled;

1\> for this measurement, consider the (secondary) cell corresponding to
the *measObjectNR* associated to this event to be the serving cell.

NOTE: The reference signal(s) of the neighbour(s) and the reference
signal(s) of the SCell are both indicated in the associated
*measObjectNR*.

Inequality A6-1 (Entering condition)

*Mn + Ocn -- Hys \> Ms + Ocs + Off*

Inequality A6-2 (Leaving condition)

*Mn + Ocn + Hys \< Ms + Ocs + Off*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ocn*** is the cell specific offset of the neighbour cell (i.e.
*cellIndividualOffset* as defined within the associated *measObjectNR*),
and set to zero if not configured for the neighbour cell.

***Ms*** is the measurement result of the serving cell, not taking into
account any offsets.

***Ocs*** is the cell specific offset of the serving cell (i.e.
*cellIndividualOffset* as defined within the associated *measObjectNR*),
and is set to zero if not configured for the serving cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Off*** is the offset parameter for this event (i.e. *a6-Offset* as
defined within *reportConfigNR* for this event).

***Mn, Ms*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ocn, Ocs, Hys, Off*** are expressed in dB.

\[TS 38.331, clause 5.5.5\]

Figure 5.5.5-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> for each serving cell configured with *servingCellMO:*

2\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *rsType:*

3\> if the serving cell measurements based on the *rsType included in
the reportConfig* *that triggered the measurement report are available:*

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on the *rsType* included in the *reportConfig that triggered the
measurement report;*

1\> set the *servCellId* within *measResultServingMOList* to include for
each NR serving cell that is configured with *servingCellMO*, if any;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

4\> else:

5\> include the applicable cells for which the new measurement results
became available since the last periodical reporting or since the
measurement was initiated or reset;

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

8\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

7\> else ...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

...

1\> if the UE is in (NG)EN-DC:

> ...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.17.1.3 Test description {#test-description-47 .H6}

##### 8.1.3.1.17.1.3.1 Pre-test conditions {#pre-test-conditions-47 .H6}

System Simulator:

\- NR Cell 1 is the PCell, NR Cell 3 is the SCell to be added, and NR
Cell 12 is the intra-frequency neighbour cell of NR Cell 3.

\- NR Cell 3 is an Inactive SCell according to TS 38.508-1 \[4\] clause
6.3.1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.1.17.1.3.2 Test procedure sequence {#test-procedure-sequence-48 .H6}

Table 8.1.3.1.17.1.3.2-1 and 8.1.3.1.17.1.3.2-2 illustrates the downlink
power levels to be applied for NR Cell 1, NR Cell 3 and NR Cell 12 at
various time instants of the test execution. Row marked \"T0\" denotes
the conditions after the preamble, while the configuration marked \"T1\"
is applied at the point indicated in the Main behaviour description in
Table 8.1.3.1.17.1.3.2-3.

Table 8.1.3.1.17.1.3.2-1: Time instances of cell power level and
parameter changes in conducted test environment

+----+----------+---------+--------+--------+---------+----------+
|    | P        | Unit    | NR     | NR     | NR      | Remark   |
|    | arameter |         |        |        |         |          |
|    |          |         | Cell 1 | Cell 3 | Cell 12 |          |
+====+==========+=========+========+========+=========+==========+
| T0 | SS/PBCH  | dBm/SCS | -82    | -88    | -94     | Power    |
|    |          |         |        |        |         | levels   |
|    | SSS EPRE |         |        |        |         | are such |
|    |          |         |        |        |         | that     |
|    |          |         |        |        |         | entry    |
|    |          |         |        |        |         | c        |
|    |          |         |        |        |         | ondition |
|    |          |         |        |        |         | for      |
|    |          |         |        |        |         | event A6 |
|    |          |         |        |        |         | (measId  |
|    |          |         |        |        |         | 1) is    |
|    |          |         |        |        |         | not      |
|    |          |         |        |        |         | sa       |
|    |          |         |        |        |         | tisfied: |
|    |          |         |        |        |         |          |
|    |          |         |        |        |         | *Mn +    |
|    |          |         |        |        |         | Ocn +    |
|    |          |         |        |        |         | Hys \<   |
|    |          |         |        |        |         | Ms + Ocs |
|    |          |         |        |        |         | + Off*   |
+----+----------+---------+--------+--------+---------+----------+
| T1 | SS/PBCH  | dBm/SCS | -82    | -88    | -78     | Power    |
|    |          |         |        |        |         | levels   |
|    | SSS EPRE |         |        |        |         | are such |
|    |          |         |        |        |         | that     |
|    |          |         |        |        |         | entry    |
|    |          |         |        |        |         | c        |
|    |          |         |        |        |         | ondition |
|    |          |         |        |        |         | for      |
|    |          |         |        |        |         | event A6 |
|    |          |         |        |        |         | (measId  |
|    |          |         |        |        |         | 1) is    |
|    |          |         |        |        |         | sa       |
|    |          |         |        |        |         | tisfied: |
|    |          |         |        |        |         |          |
|    |          |         |        |        |         | *Mn +    |
|    |          |         |        |        |         | Ocn -    |
|    |          |         |        |        |         | Hys \>   |
|    |          |         |        |        |         | Ms + Ocs |
|    |          |         |        |        |         | + Off*   |
+----+----------+---------+--------+--------+---------+----------+

Table 8.1.3.1.17.1.3.2-2: Time instances of cell power level and
parameter changes in OTA test environment

+----+----------+---------+--------+--------+---------+----------+
|    | P        | Unit    | NR     | NR     | NR      | Remark   |
|    | arameter |         |        |        |         |          |
|    |          |         | Cell 1 | Cell 3 | Cell 12 |          |
+====+==========+=========+========+========+=========+==========+
| T0 | SS/PBCH  | dBm/SCS | -91    | -91    | -100    | Power    |
|    |          |         |        |        |         | levels   |
|    | SSS EPRE |         |        |        |         | are such |
|    |          |         |        |        |         | that     |
|    |          |         |        |        |         | entry    |
|    |          |         |        |        |         | c        |
|    |          |         |        |        |         | ondition |
|    |          |         |        |        |         | for      |
|    |          |         |        |        |         | event A6 |
|    |          |         |        |        |         | (measId  |
|    |          |         |        |        |         | 1) is    |
|    |          |         |        |        |         | not      |
|    |          |         |        |        |         | sa       |
|    |          |         |        |        |         | tisfied: |
|    |          |         |        |        |         |          |
|    |          |         |        |        |         | *Mn +    |
|    |          |         |        |        |         | Ocn +    |
|    |          |         |        |        |         | Hys \<   |
|    |          |         |        |        |         | Ms + Ocs |
|    |          |         |        |        |         | + Off*   |
+----+----------+---------+--------+--------+---------+----------+
| T1 | SS/PBCH  | dBm/SCS | -91    | -91    | -82     | Power    |
|    |          |         |        |        |         | levels   |
|    | SSS EPRE |         |        |        |         | are such |
|    |          |         |        |        |         | that     |
|    |          |         |        |        |         | entry    |
|    |          |         |        |        |         | c        |
|    |          |         |        |        |         | ondition |
|    |          |         |        |        |         | for      |
|    |          |         |        |        |         | event A6 |
|    |          |         |        |        |         | (measId  |
|    |          |         |        |        |         | 1) is    |
|    |          |         |        |        |         | sa       |
|    |          |         |        |        |         | tisfied: |
|    |          |         |        |        |         |          |
|    |          |         |        |        |         | *Mn +    |
|    |          |         |        |        |         | Ocn --   |
|    |          |         |        |        |         | Hys \>   |
|    |          |         |        |        |         | Ms + Ocs |
|    |          |         |        |        |         | + Off*   |
+----+----------+---------+--------+--------+---------+----------+

Table 8.1.3.1.17.1.3.2-3: Main behaviour

  St   Procedure                                                                                                                           Message Sequence   TP                                     Verdict   
  ---- ----------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                           U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including sCellToAddModList* with NR Cell 3 as SCell addition.                    \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                           \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    The SS transmits an *RRCReconfiguration* message including *measConfig* to setup intra NR measurement and reporting for event A6.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  4    The UE transmits an *RRCReconfigrationComplete* message.                                                                            \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  5    Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                      \--\>              *NR RRC: MeasurementReport*            1         F
  6    The SS re-adjusts the SS/PBCH EPRE level according to row \"T1\" in table 8.1.3.1.17.1.3.2-1/2.                                     \-                 \-                                     \-        \-
  7    Check: Does the UE transmit a *MeasurementReport* message to report event A6 with the measured RSRP value for NR Cell 12?           \--\>              *NR RRC: MeasurementReport*            2         P
  8    The SS transmits an *RRCReconfiguration* message *including sCellToReleaseList* with NR Cell 3 as SCell release.                    \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  9    The UE transmits an *RRCReconfigurationComplete* message.                                                                           \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  10   Check: Does the UE attempt to transmit an uplink message for the next 15s?                                                          \-                 *-*                                    3         F

##### 8.1.3.1.17.1.3.3 Specific message contents {#specific-message-contents-39 .H6}

Table 8.1.3.1.17.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.17.1.3.2-3)

  -----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add
  -----------------------------------------------------------------------------

Table 8.1.3.1.17.1.3.3-2: Void

Table 8.1.3.1.17.1.3.3-3: Void

Table 8.1.3.1.17.1.3.3-4: *RRCReconfiguration* (step 3, Table
8.1.3.1.17.1.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.17.1.3.3-5: *MeasConfig* (Table 8.1.3.1.17.1.3.3-4)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                      
  ------------------------------------------------------------------------------------------ ------------------------------------------------ -------------------------- -----------
  Information Element                                                                        Value/remark                                     Comment                    Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                              
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                                   
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                    
  measObjectId                                                                               1                                                MeasObjectIdNR-f1          
  measObject CHOICE {                                                                                                                                                    
  measObjectNR SEQUENCE {                                                                                                                                                
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                              
  absThreshSS-BlocksConsolidation                                                            Not present                                                                 
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2                    
  measObjectId                                                                               2                                                MeasObjectIdNR-f2          
  measObject CHOICE {                                                                                                                                                    
  measObjectNR SEQUENCE {                                                                                                                                                
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 3                              
  absThreshSS-BlocksConsolidation                                                            Not present                                                                 
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                     
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                    
  reportConfigId\[1\]                                                                        1                                                                           
  reportConfig\[1\] CHOICE {                                                                                                                                             
  reportConfigNR                                                                             ReportConfigNR-EventA6                           Table 8.1.3.1.17.1.3.3-6   
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                     
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                    
  measId\[1\]                                                                                1                                                                           
  measObjectId\[1\]                                                                          2                                                                           
  reportConfigId\[1\]                                                                        1                                                                           
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      

Table 8.1.3.1.17.1.3.3-6: *ReportConfigNR-EventA6* (Table
8.1.3.1.17.1.3.3-5)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition EVENT\_A6                            
  ----------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                           Value/remark   Comment   Condition
  ReportConfigNR ::= SEQUENCE {                                                                          
  reportType CHOICE {                                                                                    
  eventTriggered SEQUENCE {                                                                              
  eventId CHOICE {                                                                                       
  eventA6 SEQUENCE {                                                                                     
  a6-Offset CHOICE {                                                                                     
  rsrp                                                                          0                        
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  reportInterval                                                                ms10240                  
  reportQuantityCell SEQUENCE {                                                                          
  rsrp                                                                          true                     
  rsrq                                                                          false                    
  sinr                                                                          false                    
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      

Table 8.1.3.1.17.1.3.3-7: *MeasurementReport* (step 7, Table
8.1.3.1.17.1.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  MeasurementReport ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                  
  measurementReport SEQUENCE {                                                 
  measResults                                         MeasResults              
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.3.1.17.1.3.3-8: *MeasResults* (Table 8.1.3.1.17.1.3.3-7)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-79                                                                                                         
  ---------------------------------------------------------------------------------------- -------------------------------------------- ------------------- --------------------
  Information Element                                                                      Value/remark                                 Comment             Condition
  MeasResults ::= SEQUENCE {                                                                                                                                
  measId                                                                                   1                                                                
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   2 entries                                                        
  MeasResultServMO\[1\] SEQUENCE {                                                                                                      entry 1             
  servCellId                                                                               ServCellIndex of NR Cell 1                                       
  measResultServingCell SEQUENCE {                                                                                                                          
  physCellId                                                                               Physical layer cell identity of NR Cell 1                        
  measResult SEQUENCE {                                                                                                                                     
  cellResults SEQUENCE {                                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                                
  rsrp                                                                                     (0..127)                                                         
  rsrq                                                                                     (0..127)                                                         
  sinr                                                                                     Not present                                                      
                                                                                           Not checked                                                      pc\_ss\_SINR\_Meas
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  MeasResultServMO\[2\] SEQUENCE {                                                                                                      entry 2             
  servCellId                                                                               ServCellIndex of NR Cell 3                                       
  measResultServingCell SEQUENCE {                                                                                                                          
  physCellId                                                                               Physical layer cell identity of NR Cell 3                        
  measResult SEQUENCE {                                                                                                                                     
  cellResults SEQUENCE {                                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                                
  rsrp                                                                                     (0..127)                                                         
  rsrq                                                                                     (0..127)                                                         
  sinr                                                                                     Not present                                                      
                                                                                           Not checked                                                      pc\_ss\_SINR\_Meas
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  measResultNeighCells CHOICE {                                                                                                                             
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                    1 entry                                      Report NR Cell 12   
  MeasResultNR\[1\] SEQUENCE {                                                                                                          entry 1             
  physCellId                                                                               Physical layer cell identity of NR Cell 12                       
  measResult SEQUENCE {                                                                                                                                     
  cellResults SEQUENCE {                                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                                
  rsrp                                                                                     (0..127)                                                         
  rsrq                                                                                     Not present                                                      
  sinr                                                                                     Not present                                                      
  }                                                                                                                                                         
  resultsCSI-RS-Cell                                                                       Not present                                                      
  }                                                                                                                                                         
  rsIndexResults                                                                           Not present                                                      
  }                                                                                                                                                         
  cgi-Info                                                                                 Not present                                                      
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         

Table 8.1.3.1.17.1.3.3-9: *RRCReconfiguration* (step 8, Table
8.1.3.1.17.1.3.2-3)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| Table 4.6.1-13  |                 |                 |           |
| with condition  |                 |                 |           |
| SCell\_add      |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| RRC             |                 |                 |           |
| Reconfiguration |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rrc             |                 |                 |           |
| Reconfiguration |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| nonCr           |                 |                 |           |
| iticalExtension |                 |                 |           |
| SEQUENCE{       |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| masterCellGroup | CellGroupConfig | Table           |           |
|                 |                 | 8.1.            |           |
|                 |                 | 3.1.17.1.3.3-10 |           |
|                 |                 |                 |           |
|                 |                 | SCell release   |           |
|                 |                 | for NR Cell 3   |           |
+-----------------+-----------------+-----------------+-----------+
| dedicat         | Not present     | SCell release   |           |
| edSIB1-Delivery |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.3.1.17.1.3.3-10: *CellGroupConfig* (Table 8.1.3.1.17.1.3.3-9)

+-------------------+--------------+-------------------+-----------+
| Derivation Path:  |              |                   |           |
| TS 38.508-1 \[4\] |              |                   |           |
| Table 4.6.3-19    |              |                   |           |
| with condition    |              |                   |           |
| SCell\_add        |              |                   |           |
+===================+==============+===================+===========+
| Information       | Value/remark | Comment           | Condition |
| Element           |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| CellGroupConfig   |              |                   |           |
| ::= SEQUENCE {    |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| sCellToAddModList | Not present  |                   |           |
+-------------------+--------------+-------------------+-----------+
| s                 | 1 entry      |                   |           |
| CellToReleaseList |              |                   |           |
| SEQUENCE (SIZE    |              |                   |           |
| (1                |              |                   |           |
| ..maxNrofSCells)) |              |                   |           |
| OF SCellIndex {   |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| SCellIndex\[1\]   | 1            | entry 1           |           |
|                   |              |                   |           |
|                   |              | SCell release for |           |
|                   |              | NR Cell 3         |           |
+-------------------+--------------+-------------------+-----------+
| }                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+
| }                 |              |                   |           |
+-------------------+--------------+-------------------+-----------+

###### 8.1.3.1.17.2 NR CA / Measurement configuration control and reporting / Intra NR measurements / Event A6 / Inter-band CA

##### 8.1.3.1.17.2.1 Test Purpose (TP) {#test-purpose-tp-48 .H6}

Same as TC 8.1.3.1.17.1 but applied to Inter-band CA case.

##### 8.1.3.1.17.2.2 Conformance requirements {#conformance-requirements-48 .H6}

Same as TC 8.1.3.1.17.1 but applied to Inter-band CA case.

##### 8.1.3.1.17.2.3 Test description {#test-description-48 .H6}

##### 8.1.3.1.17.2.3.1 Pre-test conditions {#pre-test-conditions-48 .H6}

Same as test case 8.1.3.1.17.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3, NR Cell 30
replaces NR Cell 12.

\- NR Cell 10 is an Inactive SCell according to TS 38.508-1 \[4\] clause
6.3.1.

##### 8.1.3.1.17.2.3.2 Test procedure sequence {#test-procedure-sequence-49 .H6}

Same as test case 8.1.3.1.17.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3, NR Cell 30
replaces NR Cell 12.

##### 8.1.3.1.17.2.3.3 Specific message contents {#specific-message-contents-40 .H6}

Same as test case 8.1.3.1.17.1 with the following differences.

NOTE: For simplicity the steps referred below are steps in test case
8.1.3.1.17.1.

Table 8.1.3.1.17.2.3.3-1: *MeasConfig* (Table 8.1.3.1.17.1.3.3-5)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                
  ------------------------------------------------------------------------------------------ ------------------------------------------------- ------------------- -----------
  Information Element                                                                        Value/remark                                      Comment             Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                        
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                             
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                           entry 1             
  measObjectId                                                                               1                                                 MeasObjectIdNR-f1   
  measObject CHOICE {                                                                                                                                              
  measObjectNR SEQUENCE {                                                                                                                                          
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                        
  absThreshSS-BlocksConsolidation                                                            Not present                                                           
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                           entry 2             
  measObjectId                                                                               2                                                 MeasObjectIdNR-f5   
  measObject CHOICE {                                                                                                                                              
  measObjectNR SEQUENCE {                                                                                                                                          
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 10                       
  absThreshSS-BlocksConsolidation                                                            Not present                                                           
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                               
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                         entry 1             
  reportConfigId                                                                             1                                                                     
  reportConfig CHOICE {                                                                                                                                            
  reportConfigNR                                                                             ReportConfigNR-EventA6                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                               
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                               entry 1             
  measId                                                                                     1                                                                     
  measObjectId                                                                               2                                                                     
  reportConfigId                                                                             1                                                                     
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                

###### 8.1.3.1.17.3 NR CA / Measurement configuration control and reporting / Intra NR measurements / Event A6 / Intra-band non Contiguous CA

##### 8.1.3.1.17.3.1 Test Purpose (TP) {#test-purpose-tp-49 .H6}

Same as TC 8.1.3.1.17.1 but applied to Intra-band non Contiguous CA
case.

##### 8.1.3.1.17.3.2 Conformance requirements {#conformance-requirements-49 .H6}

Same as TC 8.1.3.1.17.1 but applied to Intra-band non Contiguous CA
case.

##### 8.1.3.1.17.3.3 Test description {#test-description-49 .H6}

##### 8.1.3.1.17.3.3.1 Pre-test conditions {#pre-test-conditions-49 .H6}

Same as test case 8.1.3.1.17.1 with the following differences:

\- CA configuration: Intra-band non Contiguous CA replaces Intra-band
Contiguous CA.

##### 8.1.3.1.17.3.3.2 Test procedure sequence {#test-procedure-sequence-50 .H6}

Same as test case 8.1.3.1.17.1 with the following differences:

\- CA configuration: Intra-band non Contiguous CA replaces Intra-band
Contiguous CA.

##### 8.1.3.1.17.3.3.3 Specific message contents {#specific-message-contents-41 .H6}

Same as test case 8.1.3.1.17.1 but applied to Intra-band non Contiguous
CA case..

NOTE: For simplicity the steps referred below are steps in test case
8.1.3.1.17.1.

##### 8.1.3.1.18 NR CA / Measurement configuration control and reporting / Intra NR measurements / Additional measurement reporting

###### 8.1.3.1.18.1 NR CA / Measurement configuration control and reporting / Intra NR measurements / Additional measurement reporting / Intra-band Contiguous CA

##### 8.1.3.1.18.1.1 Test Purpose (TP) {#test-purpose-tp-50 .H6}

##### (1) {#section-95 .H6}

**with { UE in NR RRC\_CONNECTED state and measurements configured for
event A2 reporting include *reportAddNeighMeas* }**

**ensure that {**

**when { Entry condition for event A2 of the concerned frequency that
triggered measurement reporting is met }**

**then { UE sends *MeasurementReport* that does not include the best
non-serving cell of the concerned frequency in the
*measResultBestNeighCell* }**

**}**

##### (2) {#section-96 .H6}

**with { UE in NR RRC\_CONNECTED state and measurements configured for
event A2 reporting include *reportAddNeighMeas* }**

**ensure that {**

**when { Entry condition for event A2 of other than the concerned
frequency that triggered measurement reporting is met }**

**then { UE sends *MeasurementReport* that includes the best non-serving
cell of the concerned frequency in the *measResultBestNeighCell* }**

**}**

##### 8.1.3.1.18.1.2 Conformance requirements {#conformance-requirements-50 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.3.5.5.9, 5.5.2.1, 5.5.4.1,
5.5.4.3 and 5.5.5. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

> 1\> if the *RRCReconfiguration* includes the *masterCellGroup*:
>
> 2\> perform the cell group configuration for the received
> *masterCellGroup* according to 5.3.5.5;

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(UE in (NG)EN-DC):

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

2\> if this is the first *RRCReconfiguration* message after successful
completion of the RRC re-establishment procedure:

3\> resume SRB2 and DRBs that are suspended;

...

\[TS 38.331, clause 5.3.5.5.9\]

The UE shall:

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is not part of the current UE configuration (SCell addition):

2\> add the SCell, corresponding to the *sCellIndex*, in accordance with
the *sCellConfigCommon* and *sCellConfigDedicated*;

2\> configure lower layers to consider the SCell to be in deactivated
state;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

3\> if SCells are not applicable for the associated measurement; and

3\> if the concerned SCell is included in *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*:

4\> remove the concerned SCell from *cellsTriggeredList* defined within
the *VarMeasReportList* for this *measId*;

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is part of the current UE configuration (SCell modification):

2\> modify the SCell configuration in accordance with the
*sCellConfigDedicated*.

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

5\> consider only the serving cell to be applicable;

> ...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> if the *reportType* is set to *eventTriggered* and if the leaving
condition applicable for this event is fulfilled for one or more of the
cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *TRUE* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

> ...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

> ...

\[TS 38.331, clause 5.5.4.3\]

The UE shall:

> 1\> consider the entering condition for this event to be satisfied
> when condition A2-1, as specified below, is fulfilled;
>
> 1\> consider the leaving condition for this event to be satisfied when
> condition A2-2, as specified below, is fulfilled;
>
> 1\> for this measurement, consider the serving cell indicated by the
> *measObjectNR* associated to this event.

Inequality A2-1 (Entering condition)

*Ms + Hys \< Thresh*

Inequality A2-2 (Leaving condition)

*Ms -- Hys \> Thresh*

The variables in the formula are defined as follows:

> ***Ms*** is the measurement result of the serving cell, not taking
> into account any offsets.
>
> ***Hys*** is the hysteresis parameter for this event (i.e.
> *hysteresis* as defined within *reportConfigNR* for this event).
>
> ***Thresh*** is the threshold parameter for this event (i.e.
> *a2-Threshold* as defined within *reportConfigNR* for this event).
>
> ***Ms*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
> and RS-SINR.
>
> ***Hys*** is expressed in dB.
>
> ***Thresh*** is expressed in the same unit as ***Ms***.

\[TS 38.331, clause 5.5.5\]

Figure 5.5.5-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> for each serving cell configured with *servingCellMO:*

2\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *rsType:*

3\> if the serving cell measurements based on the *rsType included in
the reportConfig* *that triggered the measurement report are available:*

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on the *rsType* included in the *reportConfig that triggered the
measurement report;*

...

1\> set the *servCellId* within *measResultServingMOList* to include for
each NR serving cell that is configured with *servingCellMO*, if any;

...

1\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *reportAddNeighMeas*:

2\> for each serving cell *measObjectId* referenced in the *measIdList*
which is also referenced with *servingCellMO*, other than the
*measObjectId* corresponding with the *measId* that triggered the
measurement reporting:

3\> if the *measObjectNR* indicated by the *servingCellMO* includes the
RS resource configuration corresponding to the *rsType* indicated in the
*reportConfig*:

4\> set the *measResultBestNeighCell* within *measResultServingMOList*
to include the *physCellId* and the available measurement quantities
based on the *reportQuantityCell* and *rsType* indicated in
*reportConfig* of the non-serving cell corresponding to the concerned
*measObjectNR* with the highest measured RSRP if RSRP measurement
results are available for cells corresponding to this *measObjectNR*,
otherwise with the highest measured RSRQ if RSRQ measurement results are
available for cells corresponding to this *measObjectNR*, otherwise with
the highest measured SINR;

> ...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

> ...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

8\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

> ...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

...

1\> if the UE is in (NG)EN-DC:

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.18.1.3 Test description {#test-description-50 .H6}

##### 8.1.3.1.18.1.3.1 Pre-test conditions {#pre-test-conditions-50 .H6}

System Simulator:

\- NR Cell 1 is the PCell, NR Cell 3 is the SCell to be added, NR Cell
12 and NR Cell 23 is the intra-frequency neighbour cell of NR Cell 3.

\- NR Cell 3 is an Inactive SCell according to TS 38.508-1 \[4\] clause
6.3.1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.1.18.1.3.2 Test procedure sequence {#test-procedure-sequence-51 .H6}

Table 8.1.3.1.18.1.3.2-1 and 8.1.3.1.18.1.3.2-2 illustrates the downlink
power levels to be applied for NR Cell 1, NR Cell 3, NR Cell 12 and NR
Cell 23 at various time instants of the test execution. Row marked
\"T0\" denotes the conditions after the preamble, while the
configuration marked \"T1\" and \"T2\" are applied at the point
indicated in the Main behaviour description in Table 8.1.3.1.18.1.3.2-3.

Table 8.1.3.1.18.1.3.2-1: Time instances of cell power level and
parameter changes in conducted test environment

+----+-------+------+-------+-------+-------+-------+-------+
|    | Para  | Unit | NR    | NR    | NR    | NR    | R     |
|    | meter |      |       |       |       |       | emark |
|    |       |      | Cell  | Cell  | Cell  | Cell  |       |
|    |       |      | 1     | 3     | 12    | 23    |       |
+====+=======+======+=======+=======+=======+=======+=======+
| T0 | SS    | dBm/ | -82   | -82   | -91   | Off   | Power |
|    | /PBCH |      |       |       |       |       | l     |
|    |       | SCS  |       |       |       |       | evels |
|    | SSS   |      |       |       |       |       | are   |
|    | EPRE  |      |       |       |       |       | such  |
|    |       |      |       |       |       |       | that  |
|    |       |      |       |       |       |       | entry |
|    |       |      |       |       |       |       | cond  |
|    |       |      |       |       |       |       | ition |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | event |
|    |       |      |       |       |       |       | A2 is |
|    |       |      |       |       |       |       | not   |
|    |       |      |       |       |       |       | s     |
|    |       |      |       |       |       |       | atisf |
|    |       |      |       |       |       |       | ied:\ |
|    |       |      |       |       |       |       | *Ms + |
|    |       |      |       |       |       |       | Hys   |
|    |       |      |       |       |       |       | \>    |
|    |       |      |       |       |       |       | Th    |
|    |       |      |       |       |       |       | resh* |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 1 and |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 3     |
+----+-------+------+-------+-------+-------+-------+-------+
| T1 | SS    | dBm/ | -82   | -98   | -91   | -88   | Power |
|    | /PBCH |      |       |       |       |       | l     |
|    |       | SCS  |       |       |       |       | evels |
|    | SSS   |      |       |       |       |       | are   |
|    | EPRE  |      |       |       |       |       | such  |
|    |       |      |       |       |       |       | that  |
|    |       |      |       |       |       |       | entry |
|    |       |      |       |       |       |       | cond  |
|    |       |      |       |       |       |       | ition |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | event |
|    |       |      |       |       |       |       | A2 in |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 3 is  |
|    |       |      |       |       |       |       | satis |
|    |       |      |       |       |       |       | fied: |
|    |       |      |       |       |       |       |       |
|    |       |      |       |       |       |       | *Ms + |
|    |       |      |       |       |       |       | Hys   |
|    |       |      |       |       |       |       | \<    |
|    |       |      |       |       |       |       | Th    |
|    |       |      |       |       |       |       | resh* |
+----+-------+------+-------+-------+-------+-------+-------+
| T2 | SS    | dBm/ | -82   | -82   | -78   | -82   | Power |
|    | /PBCH |      |       |       |       |       | l     |
|    |       | SCS  |       |       |       |       | evels |
|    | SSS   |      |       |       |       |       | are   |
|    | EPRE  |      |       |       |       |       | such  |
|    |       |      |       |       |       |       | that  |
|    |       |      |       |       |       |       | entry |
|    |       |      |       |       |       |       | cond  |
|    |       |      |       |       |       |       | ition |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | event |
|    |       |      |       |       |       |       | A2 is |
|    |       |      |       |       |       |       | not   |
|    |       |      |       |       |       |       | s     |
|    |       |      |       |       |       |       | atisf |
|    |       |      |       |       |       |       | ied:\ |
|    |       |      |       |       |       |       | *Ms + |
|    |       |      |       |       |       |       | Hys   |
|    |       |      |       |       |       |       | \>    |
|    |       |      |       |       |       |       | Th    |
|    |       |      |       |       |       |       | resh* |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 1 and |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 3     |
+----+-------+------+-------+-------+-------+-------+-------+
| T3 | SS    | dBm/ | -98   | -82   | -78   | -85   | Power |
|    | /PBCH |      |       |       |       |       | l     |
|    |       | SCS  |       |       |       |       | evels |
|    | SSS   |      |       |       |       |       | are   |
|    | EPRE  |      |       |       |       |       | such  |
|    |       |      |       |       |       |       | that  |
|    |       |      |       |       |       |       | entry |
|    |       |      |       |       |       |       | cond  |
|    |       |      |       |       |       |       | ition |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | event |
|    |       |      |       |       |       |       | A2 in |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 1 is  |
|    |       |      |       |       |       |       | satis |
|    |       |      |       |       |       |       | fied: |
|    |       |      |       |       |       |       |       |
|    |       |      |       |       |       |       | *Ms + |
|    |       |      |       |       |       |       | Hys   |
|    |       |      |       |       |       |       | \<    |
|    |       |      |       |       |       |       | Th    |
|    |       |      |       |       |       |       | resh* |
+----+-------+------+-------+-------+-------+-------+-------+

Table 8.1.3.1.18.1.3.2-2: Time instances of cell power level and
parameter changes in OTA test environment

+----+-------+------+-------+-------+-------+-------+-------+
|    | Para  | Unit | NR    | NR    | NR    | NR    | R     |
|    | meter |      |       |       |       |       | emark |
|    |       |      | Cell  | Cell  | Cell  | Cell  |       |
|    |       |      | 1     | 3     | 12    | 23    |       |
+====+=======+======+=======+=======+=======+=======+=======+
| T0 | SS    | dBm/ | -82   | -82   | -100  | Off   | Power |
|    | /PBCH |      |       |       |       |       | l     |
|    |       | SCS  |       |       |       |       | evels |
|    | SSS   |      |       |       |       |       | are   |
|    | EPRE  |      |       |       |       |       | such  |
|    |       |      |       |       |       |       | that  |
|    |       |      |       |       |       |       | entry |
|    |       |      |       |       |       |       | cond  |
|    |       |      |       |       |       |       | ition |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | event |
|    |       |      |       |       |       |       | A2 is |
|    |       |      |       |       |       |       | not   |
|    |       |      |       |       |       |       | s     |
|    |       |      |       |       |       |       | atisf |
|    |       |      |       |       |       |       | ied:\ |
|    |       |      |       |       |       |       | *Ms + |
|    |       |      |       |       |       |       | Hys   |
|    |       |      |       |       |       |       | \>    |
|    |       |      |       |       |       |       | Th    |
|    |       |      |       |       |       |       | resh* |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 1 and |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 3     |
+----+-------+------+-------+-------+-------+-------+-------+
| T1 | SS    | dBm/ | -82   | -100  | -82   | -91   | Power |
|    | /PBCH |      |       |       |       |       | l     |
|    |       | SCS  |       |       |       |       | evels |
|    | SSS   |      |       |       |       |       | are   |
|    | EPRE  |      |       |       |       |       | such  |
|    |       |      |       |       |       |       | that  |
|    |       |      |       |       |       |       | entry |
|    |       |      |       |       |       |       | cond  |
|    |       |      |       |       |       |       | ition |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | event |
|    |       |      |       |       |       |       | A2 in |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 3 is  |
|    |       |      |       |       |       |       | satis |
|    |       |      |       |       |       |       | fied: |
|    |       |      |       |       |       |       |       |
|    |       |      |       |       |       |       | *Ms + |
|    |       |      |       |       |       |       | Hys   |
|    |       |      |       |       |       |       | \<    |
|    |       |      |       |       |       |       | Th    |
|    |       |      |       |       |       |       | resh* |
+----+-------+------+-------+-------+-------+-------+-------+
| T2 | SS    | dBm/ | -82   | -82   | -82   | -91   | Power |
|    | /PBCH |      |       |       |       |       | l     |
|    |       | SCS  |       |       |       |       | evels |
|    | SSS   |      |       |       |       |       | are   |
|    | EPRE  |      |       |       |       |       | such  |
|    |       |      |       |       |       |       | that  |
|    |       |      |       |       |       |       | entry |
|    |       |      |       |       |       |       | cond  |
|    |       |      |       |       |       |       | ition |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | event |
|    |       |      |       |       |       |       | A2 is |
|    |       |      |       |       |       |       | not   |
|    |       |      |       |       |       |       | s     |
|    |       |      |       |       |       |       | atisf |
|    |       |      |       |       |       |       | ied:\ |
|    |       |      |       |       |       |       | *Ms + |
|    |       |      |       |       |       |       | Hys   |
|    |       |      |       |       |       |       | \>    |
|    |       |      |       |       |       |       | Th    |
|    |       |      |       |       |       |       | resh* |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 1 and |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 3     |
+----+-------+------+-------+-------+-------+-------+-------+
| T3 | SS    | dBm/ | -100  | -82   | -82   | -91   | Power |
|    | /PBCH |      |       |       |       |       | l     |
|    |       | SCS  |       |       |       |       | evels |
|    | SSS   |      |       |       |       |       | are   |
|    | EPRE  |      |       |       |       |       | such  |
|    |       |      |       |       |       |       | that  |
|    |       |      |       |       |       |       | entry |
|    |       |      |       |       |       |       | cond  |
|    |       |      |       |       |       |       | ition |
|    |       |      |       |       |       |       | for   |
|    |       |      |       |       |       |       | event |
|    |       |      |       |       |       |       | A2 in |
|    |       |      |       |       |       |       | NR    |
|    |       |      |       |       |       |       | Cell  |
|    |       |      |       |       |       |       | 1 is  |
|    |       |      |       |       |       |       | satis |
|    |       |      |       |       |       |       | fied: |
|    |       |      |       |       |       |       |       |
|    |       |      |       |       |       |       | *Ms + |
|    |       |      |       |       |       |       | Hys   |
|    |       |      |       |       |       |       | \<    |
|    |       |      |       |       |       |       | Th    |
|    |       |      |       |       |       |       | resh* |
+----+-------+------+-------+-------+-------+-------+-------+

Table 8.1.3.1.18.1.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                                      Message Sequence   TP                                     Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                      U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including sCellToAddModList* with NR Cell 3 as SCell addition.                                                                               \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                      \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    The SS transmits an *RRCReconfiguration* message including *measConfig* to setup intra NR measurement and for event A2 reporting configuration and include *reportAddNeighMeas*.               \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  4    The UE transmits an *RRCReconfigrationComplete* message.                                                                                                                                       \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  5    The SS re-adjusts the SS/PBCH EPRE level according to row \"T1\" in table 8.1.3.1.18.1.3.2-1/2.                                                                                                \-                 \-                                     \-        \-
  6    Check: Does the UE transmit a *MeasurementReport* message that does not include the RSRP value of the best non-serving cell on the concerned serving frequency in *measResultBestNeighCell*?   \--\>              *NR RRC: MeasurementReport*            1         P
  7    The SS re-adjusts the cell-specific reference signal level according to row \"T2\" in table 8.1.3.1.18.1.3.2-1/2.                                                                              \-                 *-*                                    \-        \-
  7A   30 seconds after step 7, SS re-adjusts the cell-specific reference signal level according to row \"T3\" in table 8.1.3.1.18.1.3.2-1/2.                                                         \-                 *-*                                    \-        \-
  8    Check: Does the UE transmit a *MeasurementReport* message included the RSRP value of the best non-serving cell (NR Cell 12) on the concerned serving frequency in *measResultBestNeighCell*?   \--\>              *NR RRC: MeasurementReport*            2         P
  9    The SS transmits an RRCReconfiguration message containing an sCellToReleaseList with SCell NR Cell 3.                                                                                          \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  10   The UE transmits an RRCReconfigurationComplete message.                                                                                                                                        \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-

##### 8.1.3.1.18.1.3.3 Specific message contents {#specific-message-contents-42 .H6}

Table 8.1.3.1.18.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.18.1.3.2-3)

  -----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add
  -----------------------------------------------------------------------------

Table 8.1.3.1.18.1.3.3-2: Void

Table 8.1.3.1.18.1.3.3-3: Void

Table 8.1.3.1.18.1.3.3-4: *RRCReconfiguration* (step 3, Table
8.1.3.1.18.1.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.18.1.3.3-5: *MeasConfig* (Table 8.1.3.1.18.1.3.3-4)

  ------------------------------------------------------------------------------------------ ------------------------------------------------ -------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                      
  Information Element                                                                        Value/remark                                     Comment                    Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                              
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                                   
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                    
  measObjectId                                                                               1                                                MeasObjectIdNR-f1          
  measObject CHOICE {                                                                                                                                                    
  measObjectNR SEQUENCE {                                                                                                                                                
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                              
  absThreshSS-BlocksConsolidation                                                            Not present                                                                 
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2                    
  measObjectId                                                                               2                                                MeasObjectIdNR-f2          
  measObject CHOICE {                                                                                                                                                    
  measObjectNR SEQUENCE {                                                                                                                                                
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 3                              
  absThreshSS-BlocksConsolidation                                                            Not present                                                                 
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                     
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                    
  reportConfigId                                                                             1                                                                           
  reportConfig CHOICE {                                                                                                                                                  
  reportConfigNR                                                                             ReportConfigNR-EventA2                           Table 8.1.3.1.18.1.3.3-6   
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  2 entries                                                                   
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                    
  measId                                                                                     1                                                                           
  measObjectId                                                                               1                                                                           
  reportConfigId                                                                             1                                                                           
  }                                                                                                                                                                      
  MeasIdToAddMod\[2\] SEQUENCE {                                                                                                              entry 2                    
  measId                                                                                     2                                                                           
  measObjectId                                                                               2                                                                           
  reportConfigId                                                                             1                                                                           
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  ------------------------------------------------------------------------------------------ ------------------------------------------------ -------------------------- -----------

Table 8.1.3.1.18.1.3.3-6: *ReportConfigNR-EventA2* (Table
8.1.3.1.18.1.3.3-5)

  ----------------------------------------------------------------------------- ------------------ ------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition EVENT\_A2                                                
  Information Element                                                           Value/remark       Comment                   Condition
  ReportConfigNR ::= SEQUENCE {                                                                                              
  reportType CHOICE {                                                                                                        
  eventTriggered SEQUENCE {                                                                                                  
  eventId CHOICE {                                                                                                           
  eventA2 SEQUENCE {                                                                                                         
  a2-Threshold SEQUENCE {                                                                                                    
  rsrp                                                                          67                 -89dBm                    FR1
                                                                                66 + Delta(NRfs)   Threshold set to -91dBm   FR2
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  reportAmount                                                                  r1                                           
  reportQuantityCell SEQUENCE {                                                                                              
  rsrp                                                                          true                                         
  rsrq                                                                          false                                        
  sinr                                                                          false                                        
  }                                                                                                                          
  reportAddNeighMeas                                                            setup                                        
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  ----------------------------------------------------------------------------- ------------------ ------------------------- -----------

Table 8.1.3.1.18.1.3.3-7: *MeasurementReport* (step 6, step 8, Table
8.1.3.1.18.1.3.2-3)

  --------------------------------------------------- -------------- -------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                             
  Information Element                                 Value/remark   Comment                    Condition
  MeasurementReport ::= SEQUENCE {                                                              
  criticalExtensions CHOICE {                                                                   
  measurementReport SEQUENCE {                                                                  
  measResults                                         MeasResults1   Table 8.1.3.1.18.1.3.3-8   Step 6
                                                      MeasResults2   Table 8.1.3.1.18.1.3.3-9   Step 8
  }                                                                                             
  }                                                                                             
  }                                                                                             
  --------------------------------------------------- -------------- -------------------------- -----------

Table 8.1.3.1.18.1.3.3-8: *MeasResults1* (Table 8.1.3.1.18.1.3.3-7)

  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-79 with Condition A2                                                                            
  Information Element                                                                      Value/remark                                Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                           Step 6    
  measId                                                                                   2                                                     
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   2 entries                                             
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1   
  servCellId                                                                               ServCellIndex of NR Cell 1                            
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 1             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     (0..127)                                              
  sinr                                                                                     Not present                                           
                                                                                           Not checked                                           pc\_ss\_SINR\_Meas
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  MeasResultServMO\[2\] SEQUENCE {                                                                                                     entry 2   
  servCellId                                                                               ServCellIndex of NR Cell 3                            
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 3             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     (0..127)                                              
  sinr                                                                                     Not present                                           
                                                                                           Not checked                                           pc\_ss\_SINR\_Meas
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------

Table 8.1.3.1.18.1.3.3-9: *MeasResults2* (Table 8.1.3.1.18.1.3.3-7)

  ---------------------------------------------------------------------------------------- -------------------------------------------- ------------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-79 with Condition A2                                                                                       
  Information Element                                                                      Value/remark                                 Comment             Condition
  MeasResults ::= SEQUENCE {                                                                                                            Step 8              
  measId                                                                                   1                                                                
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   2 entries                                                        
  MeasResultServMO\[1\] SEQUENCE {                                                                                                      entry 1             
  servCellId                                                                               ServCellIndex of NR Cell 1                                       
  measResultServingCell SEQUENCE {                                                                                                                          
  physCellId                                                                               Physical layer cell identity of NR Cell 1                        
  measResult SEQUENCE {                                                                                                                                     
  cellResults SEQUENCE {                                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                                
  rsrp                                                                                     (0..127)                                                         
  rsrq                                                                                     (0..127)                                                         
  sinr                                                                                     Not present                                                      
                                                                                           Not checked                                                      pc\_ss\_SINR\_Meas
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  MeasResultServMO\[2\] SEQUENCE {                                                                                                      entry 2             
  servCellId                                                                               ServCellIndex of NR Cell 3                                       
  measResultServingCell SEQUENCE {                                                                                                                          
  physCellId                                                                               Physical layer cell identity of NR Cell 3                        
  measResult SEQUENCE {                                                                                                                                     
  cellResults SEQUENCE {                                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                                
  rsrp                                                                                     (0..127)                                                         
  rsrq                                                                                     (0..127)                                                         
  sinr                                                                                     Not present                                                      
                                                                                           Not checked                                                      pc\_ss\_SINR\_Meas
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  measResultBestNeighCell SEQUENCE {                                                                                                    Report NR Cell 12   
  physCellId                                                                               Physical layer cell identity of NR Cell 12                       
  measResult SEQUENCE {                                                                                                                                     
  cellResults SEQUENCE {                                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                                
  rsrp                                                                                     (0..127)                                                         
  rsrq                                                                                     Not present                                                      
  sinr                                                                                     Not present                                                      
  }                                                                                                                                                         
  resultsCSI-RS-Cell                                                                       Not present                                                      
  }                                                                                                                                                         
  rsIndexResults                                                                           Not present                                                      
  }                                                                                                                                                         
  cgi-Info                                                                                 Not present                                                      
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  }                                                                                                                                                         
  ---------------------------------------------------------------------------------------- -------------------------------------------- ------------------- --------------------

Table 8.1.3.1.18.1.3.3-10: *RRCReconfiguration* (step 9, Table
8.1.3.1.18.1.3.2-3)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE{                                                                            
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.3.1.18.1.3.3-11: *CellGroupConfig* (Table 8.1.3.1.18.1.3.3-10)

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                            
  Information Element                                                           Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                         
  sCellToAddModList                                                             Not present              
  sCellToReleaseList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellIndex {         1 entry                  
  SCellIndex\[1\]                                                               1              entry 1   
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

###### 8.1.3.1.18.2 NR CA / Measurement configuration control and reporting / Intra NR measurements / Additional measurement reporting / Inter-band CA

##### 8.1.3.1.18.2.1 Test Purpose (TP) {#test-purpose-tp-51 .H6}

Same as TC 8.1.3.1.18.1 but applied to Inter-band CA case.

##### 8.1.3.1.18.2.2 Conformance requirements {#conformance-requirements-51 .H6}

Same as TC 8.1.3.1.18.1 but applied to Inter-band CA case.

##### 8.1.3.1.18.2.3 Test description {#test-description-51 .H6}

##### 8.1.3.1.18.2.3.1 Pre-test conditions {#pre-test-conditions-51 .H6}

Same as test case 8.1.3.1.18.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3, NR Cell 30
replaces NR Cell 12 and NR Cell 31 replaces NR Cell 23.

\- NR Cell 10 is an Inactive SCell according to TS 38.508-1 \[4\] clause
6.3.1.

##### 8.1.3.1.18.2.3.2 Test procedure sequence {#test-procedure-sequence-52 .H6}

Same as test case 8.1.3.1.18.1 with the following differences:

\- CA configuration: Inter-band CA replaces Inter-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3, NR Cell 30
replaces NR Cell 12 and NR Cell 31 replaces NR Cell 23.

##### 8.1.3.1.18.2.3.3 Specific message contents {#specific-message-contents-43 .H6}

Same as test case 8.1.3.1.18.1 with the following differences.

NOTE: For simplicity the steps referred below are steps in test case
8.1.3.1.18.1.

Table 8.1.3.1.18.2.3.3-1: *MeasConfig* (Table 8.1.3.1.18.1.3.3-5)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                
  ------------------------------------------------------------------------------------------ ------------------------------------------------- ------------------- -----------
  Information Element                                                                        Value/remark                                      Comment             Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                        
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                             
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                           entry 1             
  measObjectId                                                                               1                                                 MeasObjectIdNR-f1   
  measObject CHOICE {                                                                                                                                              
  measObjectNR SEQUENCE {                                                                                                                                          
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                        
  absThreshSS-BlocksConsolidation                                                            Not present                                                           
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                           entry 2             
  measObjectId\[2\]                                                                          2                                                 MeasObjectIdNR-f5   
  measObject\[2\] CHOICE {                                                                                                                                         
  measObjectNR SEQUENCE {                                                                                                                                          
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 10                       
  absThreshSS-BlocksConsolidation                                                            Not present                                                           
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                               
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                         entry 1             
  reportConfigId                                                                             1                                                                     
  reportConfig CHOICE {                                                                                                                                            
  reportConfigNR                                                                             ReportConfigNR-EventA2                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  2 entries                                                             
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                               entry 1             
  measId                                                                                     1                                                                     
  measObjectId                                                                               1                                                                     
  reportConfigId                                                                             1                                                                     
  }                                                                                                                                                                
  MeasIdToAddMod\[2\] SEQUENCE {                                                                                                               entry 2             
  measId                                                                                     2                                                                     
  measObjectId                                                                               2                                                                     
  reportConfigId                                                                             1                                                                     
  }                                                                                                                                                                
  }                                                                                                                                                                
  }                                                                                                                                                                

###### 8.1.3.1.18.3 NR CA / Measurement configuration control and reporting / Intra NR measurements / Additional measurement reporting / Intra-band non Contiguous CA

##### 8.1.3.1.18.3.1 Test Purpose (TP) {#test-purpose-tp-52 .H6}

Same as TC 8.1.3.1.18.1 but applied to Intra-band non Contiguous CA
case.

##### 8.1.3.1.18.3.2 Conformance requirements {#conformance-requirements-52 .H6}

Same as TC 8.1.3.1.18.1 but applied to Intra-band non Contiguous CA
case.

##### 8.1.3.1.18.3.3 Test description {#test-description-52 .H6}

##### 8.1.3.1.18.3.3.1 Pre-test conditions {#pre-test-conditions-52 .H6}

Same as test case 8.1.3.1.18.1 with the following differences:

\- CA configuration: Intra-band non Contiguous CA replaces Intra-band
Contiguous CA.

##### 8.1.3.1.18.3.3.2 Test procedure sequence {#test-procedure-sequence-53 .H6}

Same as test case 8.1.3.1.18.1 with the following differences:

\- CA configuration: Intra-band non Contiguous CA replaces Inter-band
Contiguous CA.

##### 8.1.3.1.18.3.3.3 Specific message contents {#specific-message-contents-44 .H6}

Same as test case 8.1.3.1.18.1 but applied to Intra-band non Contiguous
CA case.

##### 8.1.3.1.19 Measurement configuration control and reporting / Inter-frequency measurements/ SFTD

##### 8.1.3.1.19.1 Test Purpose (TP) {#test-purpose-tp-53 .H6}

##### (1) {#section-97 .H6}

**with** { UE in NR RRC\_CONNECTED state with reportSFTD-NeighMeas
configured }

**ensure that** {

**when** { The sfn-OffsetResult and frameBoundaryOffsetResult results
become available }

**then** { UE transmits a MeasurementReport message including the
MeasResultCellListSFTD-NR IE }

}

##### 8.1.3.1.19.2 Conformance requirements {#conformance-requirements-53 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.3.1, 5.5.4.1, and
5.5.5.1. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

\...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

\...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\...

\[TS 38.331, clause 5.5.2.1\]

The network applies the procedure as follows:

\- to ensure that, whenever the UE has a *measConfig associated with a
CG*, it includes a *measObject* for the SpCell and for each NR SCell of
the CG to be measured;

,,,

\- when the UE is in NE-DC, NR-DC, or NR standalone, to configure at
most one measurement identity across all CGs using a reporting
configuration with the *reportType* set to *reportSFTD*;

\...

The UE shall:

\...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

\...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

\...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

\...

\[TS 38.331, clause 5.5.3.1\]

The UE shall:

1\> whenever the UE has a *measConfig*, perform RSRP and RSRQ
measurements for each serving cell for which *servingCellMO* is
configured as follows:

2\> if the *reportConfig* associated with at least one *measId* included
in the *measIdList* within *VarMeasConfig* contains an *rsType* set to
*ssb* and *ssb-ConfigMobility* is configured in the *measObject*
indicated by the *servingCellMO*:

\...

3\> derive serving cell measurement results based on SS/PBCH block, as
described in 5.5.3.3;

\...

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

\...

2\> if the *reportType* for the associated *reportConfig* is set to
*reportSFTD* and the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than one:

\...

3\> else if the *reportSFTD-NeighMeas* is included*:*

4\> if the *measObject* is associated to NR:

5\> if the *drx-SFTD-NeighMeas* is included:

6\> perform SFTD measurements between the PCell and the NR neighbouring
cell(s) detected based on parameters in the associated *measObject*
using available idle periods;

5\> else:

6\> perform SFTD measurements between the PCell and the NR neighbouring
cell(s) detected based on parameters in the associated *measObject*;

5\> if the *reportRSRP* is set to *true*:

6\> perform RSRP measurements based on SSB for the NR neighbouring
cell(s) detected based on parameters in the associated *measObject*;

2\> perform the evaluation of reporting criteria as specified in 5.5.4.

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

\...

2\> else if the corresponding *reportConfig* includes a *reportType* set
to *reportSFTD*:

3\> if the corresponding *measObject* concerns NR:

\...

4\> else if the *reportSFTD-NeighMeas* is included:

5\> if *cellsForWhichToReportSFTD* is configured in the corresponding
*reportConfig*:

6\> consider any NR neighbouring cell detected on the associated
*measObjectNR* which has a physical cell identity that is included in
the *cellsForWhichToReportSFTD* to be applicable;

5\> else:

6\> consider up to 3 strongest NR neighbouring cells detected based on
parameters in the associated *measObjectNR* to be applicable when the
concerned cells are not included in the *excludedCellsToAddModList*
defined within the *VarMeasConfig* for this *measId*;

\...

2\> if the corresponding *reportConfig* includes a *reportType* is set
to *reportSFTD*:

3\> if the corresponding *measObject* concerns NR:

\...

4\> else

5\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after the quantity to be reported becomes available for each
requested pair of PCell and NR cell or the maximal measurement reporting
delay as specified in TS 38.133 \[14\];

\...

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

\...

1\> if the corresponding *measObject* concerns NR:

\...

2\> else if the *reportSFTD-NeighMeas* is included within the
corresponding *reportConfigNR* for this *measId*:

3\> for each applicable cell which measurement results are available,
include an entry in the *measResultCellListSFTD-NR* and set the contents
as follows:

4\> set *physCellId* to the physical cell identity of the concerned NR
neighbour cell.

4\> set *sfn-OffsetResult* and *frameBoundaryOffsetResult* to the
measurement results provided by lower layers;

4\> if the *reportRSRP* is set to *true*:

5\> set *rsrp-Result* to the RSRP of the concerned cell derived based on
SSB;

\...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

\...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.19.3 Test description {#test-description-53 .H6}

##### 8.1.3.1.19.3.1 Pre-test conditions {#pre-test-conditions-53 .H6}

System Simulator:

\- NR Cell 1 is the PCell, NR Cell 10 is the inter-frequency neighbour
cell.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR PCell.

UE:

> \- None.

Preamble:

> \- The UE is in state RRC\_CONNECTED using generic procedure parameter
> Connectivity (*NR*) established according to TS 38.508-1 \[4\], clause
> 4.5.4.

##### 8.1.3.1.19.3.2 Test procedure sequence {#test-procedure-sequence-54 .H6}

Table 8.1.3.1.19.3.2-1: Main behaviour

  St                                                                                                                                                    Procedure                                                                                                                                             Message Sequence   TP                                     Verdict   
  ----------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                                                                                                              U - S              Message                                          
  1                                                                                                                                                     The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup inter-frequency SFTD measurement on NR neighbour cell (NR Cell 10)   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2                                                                                                                                                     The UE transmits an *RRCReconfigurationComplete* message.                                                                                             \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3                                                                                                                                                     Check: Does the UE transmit a *MeasurementReport* message including *measResultCellListSFTD-NR* within the next 5s? NOTE 1                            \--\>              *NR RRC: MeasurementReport*            1         P
  NOTE 1: Time limit is chosen based on the inter-frequency SFTD measurement reporting delay requirements specified in TS 38.133 \[30\] clause 9.3.8.                                                                                                                                                                                                                             

##### 8.1.3.1.19.3.3 Specific message contents {#specific-message-contents-45 .H6}

Table 8.1.3.1.19.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.19.3.2-1)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.19.3.3-2: *MeasConfig* (Table 8.1.3.1.19.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                               
  ------------------------------------------------------------------------------------------- ---------------------------------------------------------- ------------------------ -----------
  Information Element                                                                         Value/remark                                               Comment                  Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                                       
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {           2 entries                                                                           
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                                     entry 1                  
  measObjectId                                                                                1                                                                                   
  measObject CHOICE {                                                                                                                                                             
  measObjectNR                                                                                MeasObjectNR-1                                             for NR Cell 1            
  }                                                                                                                                                                               
  }                                                                                                                                                                               
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                                     entry 2                  
  measObjectId                                                                                2                                                                                   
  measObject CHOICE {                                                                                                                                                             
  measObjectNR                                                                                MeasObjectNR-2                                             for NR Cell 10           
  }                                                                                                                                                                               
  }                                                                                                                                                                               
  reportConfigToAddModList SEQUENCE (SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                             
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                                   entry 1                  
  reportConfigId                                                                              1                                                                                   
  reportConfig CHOICE {                                                                                                                                                           
  reportConfigNR                                                                              ReportConfigNR                                             Table 8.1.3.1.19.3.3-5   
  }                                                                                                                                                                               
  }                                                                                                                                                                               
  }                                                                                                                                                                               
  measIdToAddModList SEQUENCE (SIZE (1..maxMeasId)) OF MeasIdToAddMod {                       1 entry                                                                             
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                                         entry 1                  
  measId                                                                                      1                                                                                   
  measObjectId                                                                                2                                                                                   
  reportConfigId                                                                              1                                                                                   
  }                                                                                                                                                                               
  }                                                                                                                                                                               
  measGapConfig                                                                               MeasGapConfig specified in 38.508-1 \[4\] Table 4.6.3-70                            
  }                                                                                                                                                                               

Table 8.1.3.1.19.3.3-3: *MeasObjectNR*-1 (Table 8.1.3.1.19.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                          
  ---------------------------------------------------- ---------------------------- --------- -----------
  Information Element                                  Value/remark                 Comment   Condition
  MeasObjectNR ::= SEQUENCE {                                                                 
  ssbFrequency                                         ARFCN-ValueNR of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                            
  }                                                                                           

Table 8.1.3.1.19.3.3-4: *MeasObjectNR*-2 (Table 8.1.3.1.19.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                           
  ---------------------------------------------------- ----------------------------- --------- -----------
  Information Element                                  Value/remark                  Comment   Condition
  MeasObjectNR ::= SEQUENCE {                                                                  
  ssbFrequency                                         ARFCN-ValueNR of NR Cell 10             
  absThreshSS-BlocksConsolidation                      Not present                             
  }                                                                                            

Table 8.1.3.1.19.3.3-5: ReportConfigNR (Table 8.1.3.1.19.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-142 with condition SFTD\_NEIGHBOUR                            
  ------------------------------------------------------------------------------------ -------------- --------- -----------
  Information Element                                                                  Value/remark   Comment   Condition
  ReportConfigNR ::= SEQUENCE {                                                                                 
  reportType CHOICE {                                                                                           
  reportSFTD SEQUENCE {                                                                                         
  reportRSRP                                                                           true                     
  reportSFTD-NeighMeas                                                                 true                     
  }                                                                                                             
  }                                                                                                             
  }                                                                                                             

Table 8.1.3.1.19.3.3-6: *MeasResults* (step 3, Table 8.1.3.1.19.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-79 with condition SFTD\_NEIGHBOUR                                            
  --------------------------------------------------------------------------------------- -------------------------- --------- -----------
  Information Element                                                                     Value/remark               Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                   
  measId                                                                                  1                                    
  measResultCellListSFTD-NR SEQUENCE (SIZE (1..maxCellSFTD)) OF MeasResultCellSFTD-NR {   1 entry                              
  MeasResultCellSFTD-NR\[1\] SEQUENCE {                                                                              entry 1   
  physCellId                                                                              PhysCellId of NR Cell 10             
  sfn-OffsetResult                                                                        (0..1023)                            
  frameBoundaryOffsetResult                                                               (-30720..30719)                      
  rsrp-Result                                                                             (0..127)                             
  }                                                                                                                            
  }                                                                                                                            
  }                                                                                                                            

##### 8.1.3.1.20 Measurement configuration control and reporting / Measurement Gaps / gapFR1

##### 8.1.3.1.20.1 Test Purpose (TP) {#test-purpose-tp-54 .H6}

##### (1) {#section-98 .H6}

**with { UE in NR RRC\_CONNECTED state }**

**ensure that {**

**when { UE receives RRCReconfiguration message containing MeasConfig to
setup gapFR1 and report periodical measurements for neighbour cell on
FR1 frequency }**

**then { UE applies gapFR1 and sends periodical measurements for
neighbour cell on FR1 frequency }**

**}**

##### 8.1.3.1.20.2 Conformance requirements {#conformance-requirements-54 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.2.9, 5.5.4.1,
5.5.4.5 and 5.5.5.1. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

...

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

...

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

1\> if *gapFR1* is set to *setup*:

2\> if an FR1 measurement gap configuration is already setup, release
the FR1 measurement gap configuration;

2\> setup the FR1 measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

3\> if the corresponding *measObject* concerns NR:

...

4\> for measurement events other than *eventA1* or *eventA2*:

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
not included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

...

2\> if *reportType* is set to *periodical* and if a (first) measurement
result is available:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> if the *reportAmount* exceeds 1:

4\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after the quantity to be reported becomes available for the
NR SpCell;

3\> else (i.e. the *reportAmount* is equal to 1):

4\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after the quantity to be reported becomes available for the
NR SpCell and for the strongest cell among the applicable cells;

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

...

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with
*servingCellMO*, RSRP, RSRQ and the available SINR, derived based on the
*rsType* if indicated in the associated *reportConfig,* otherwise based
on SSB if available, otherwise based on CSI-RS;

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

...

4\> else:

5\> include the applicable cells for which the new measurement results
became available since the last periodical reporting or since the
measurement was initiated or reset;

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

1\> else:

2\> if the *reportType* is set to *periodical*:

3\> remove the entry within the *VarMeasReportList* for this *measId*;

3\> remove this *measId* from the *measIdList* within *VarMeasConfig*;

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.20.3 Test description {#test-description-54 .H6}

##### 8.1.3.1.20.3.1 Pre-test conditions {#pre-test-conditions-54 .H6}

##### System Simulator: {#system-simulator-35 .H6}

\- NR Cell 1 is the serving cell, NR Cell 3 is the inter-frequency
neighbour cell of NR Cell 1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-32 .H6}

\- None.

##### Preamble: {#preamble-34 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.3.1.20.3.2 Test procedure sequence {#test-procedure-sequence-55 .H6}

Table 8.1.3.1.20.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1 and NR Cell 3 at various time instants of the test
execution. Row marked \"T1\" are applied at the point indicated in the
Main behaviour description in Table 8.1.3.1.20.3.2-3.

Table 8.1.3.1.20.3.2-1: Time instances of cell power level and parameter
changes in FR1

+----+------------------+------+-----------+-------+--------+
|    | Parameter        | Unit | NR Cell 1 | NR    | Remark |
|    |                  |      |           |       |        |
|    |                  |      |           | Cell3 |        |
+====+==================+======+===========+=======+========+
| T1 | SS/PBCH SSS EPRE | dBm/ | -85       | -79   |        |
|    |                  |      |           |       |        |
|    |                  | SCS  |           |       |        |
+----+------------------+------+-----------+-------+--------+

Table 8.1.3.1.20.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                       Message Sequence   TP                                     Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                       U - S              Message                                          
  0    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.1.20.3.2-1.                                                       \-                 *-*                                    \-        \-
  1    The SS transmits an *RRCReconfiguration* message to setup FR1 independent gap (pattern \#0) and inter-frequency measurement on NR Cell 3*.*                     \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                       \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit at least 10 *MeasurementReport* messages to periodically report the measured RSRP value for NR Cell 3 within the next 30 seconds?   \--\>              *NR RRC: MeasurementReport*            1         P
  3A   The SS waits and ignores MeasurementReport messages for 3s to allow UE to measure NR Cell 3.                                                                    \-                 *-*                                    \-        \-
  4    The SS transmits an *RRCReconfiguration* to change gap pattern to pattern \#1.                                                                                  \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  5    The UE transmits an *RRCReconfigurationComplete* message to confirm the change of pattern.                                                                      \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  6    Check: Does the UE transmit at least 10 *MeasurementReport* messages to periodically report the measured RSRP value for NR Cell 3 within the next 30 seconds?   \--\>              *NR RRC: MeasurementReport*            1         P
  \-   EXCEPTION: Steps 7 to 9 shall be repeated for each gap pattern among \#2 - \#11 and supported by UE (indicated in *supportedGapPattern*).                                                                                           
  7    The SS transmits an *RRCReconfiguration* to change gap pattern to the next pattern supported by UE.                                                             \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  8    The UE transmits an *RRCReconfigurationComplete* message to confirm the change of gap pattern.                                                                  \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  9    Check: Does the UE transmit at least 10 *MeasurementReport* messages to periodically report the measured RSRP value for NR Cell 3 within the next 30 seconds?   \--\>              *NR RRC: MeasurementReport*            1         P

##### 8.1.3.1.20.3.3 Specific message contents {#specific-message-contents-46 .H6}

Table 8.1.3.1.20.3.3-1: *RRCReconfiguration* (steps 1, 4 and 7, Table
8.1.3.1.20.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.20.3.3-2: *MeasConfig* (Table 8.1.3.1.20.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------------------ ------------------------ ------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                              
  Information Element                                                                        Value/remark                               Comment                  Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                      
  measObjectToAddModList                                                                     Not present                                                         Step 4 OR Step 7
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                           Step 1
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                    entry 1                  
  measObjectId                                                                               1                                                                   
  measObject CHOICE {                                                                                                                                            
  measObjectNR                                                                               MeasObjectNR-f1                            Table 8.1.3.1.20.3.3-3   
  }                                                                                                                                                              
  }                                                                                                                                                              
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                    entry 2                  
  measObjectId                                                                               2                                                                   
  measObject CHOICE {                                                                                                                                            
  measObjectNR                                                                               MeasObjectNR-f2                            Table 8.1.3.1.20.3.3-4   
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  reportConfigToAddModList                                                                   Not present                                                         Step 4 OR Step 7
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                             Step 1
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                  entry 1                  
  reportConfigId                                                                             1                                                                   
  reportConfig CHOICE {                                                                                                                                          
  reportConfigNR                                                                             ReportConfigNR with condition PERIODICAL                            
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  measIdToAddModList                                                                         Not present                                                         Step 4 OR Step 7
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                             Step 1
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                  
  measId                                                                                     1                                                                   
  measObjectId                                                                               2                                                                   
  reportConfigId                                                                             1                                                                   
  }                                                                                                                                                              
  }                                                                                                                                                              
  measGapConfig                                                                              MeasGapConfig-gapFR1                       Table 8.1.3.1.20.3.3-5   
  }                                                                                                                                                              
  ------------------------------------------------------------------------------------------ ------------------------------------------ ------------------------ ------------------

Table 8.1.3.1.20.3.3-3: *MeasObjectNR-f1* (Table 8.1.3.1.20.3.3-2)

  ---------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                                                       
  Information Element                                  Value/remark                         Comment                                                                        Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                                                              
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1                                                                                  
  smtc1 SEQUENCE {                                                                                                                                                         
  periodicityAndOffset CHOICE {                                                                                                                                            
  sf20                                                 0                                    To make sure SMTC for intra-frequency measurement is non-overlapping with MG   
  }                                                                                                                                                                        
  }                                                                                                                                                                        
  absThreshSS-BlocksConsolidation                      Not present                                                                                                         
  nrofSS-BlocksToAverage                               Not present                                                                                                         
  }                                                                                                                                                                        
  ---------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------ -----------

Table 8.1.3.1.20.3.3-4: *MeasObjectNR-f2* (Table 8.1.3.1.20.3.3-2)

  --------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.08-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                 Value/remark                         Comment   Condition
  MeasObjectNR ::= SEQUENCE {                                                                        
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 3             
  smtc1 SEQUENCE {                                                                                   
  periodicityAndOffset CHOICE {                                                                      
  sf20                                                10                                             
  }                                                                                                  
  }                                                                                                  
  absThreshSS-BlocksConsolidation                     Not present                                    
  nrofSS-BlocksToAverage                              Not present                                    
  }                                                                                                  
  --------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.20.3.3-5: MeasGapConfig-gapFR1 (Table 8.1.3.1.20.3.3-2)

  ---------------------------------------------------------------------------- -------------- --------- --------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-70 with condition GAP\_FR1                            
  Information Element                                                          Value/remark   Comment   Condition
  MeasGapConfig ::= SEQUENCE {                                                                          
  gapFR1 CHOICE {                                                                                       
  setup SEQUENCE {                                                                                      
  gapOffset                                                                    9                        
  mgl                                                                          ms3                      Pattern \#2, \#3, \#10 or \#11
                                                                               ms4                      Pattern \#6, \#7, \#8 or \#9
                                                                               ms6                      Pattern \#0, \#1, \#4 or \#5
  mgrp                                                                         ms20                     Pattern \#4, \#6 or \#10
                                                                               ms40                     Pattern \#0, \#2 or \#7
                                                                               ms80                     Pattern \#1, \#3 or \#8
                                                                               ms160                    Pattern \#5, \#9 or \#11
  mgta                                                                         ms0                      
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  ---------------------------------------------------------------------------- -------------- --------- --------------------------------

Table 8.1.3.1.20.3.3-6: *MeasurementReport* (steps 3, 6 and 9, Table
8.1.3.1.20.3.2-3)

  ---------------------------------------------------------------------------------------- ------------------------------------------- ---------------------------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                                       
  Information Element                                                                      Value/remark                                Comment                            Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                             
  measurementReport SEQUENCE {                                                                                                                                            
  measResults SEQUENCE {                                                                                                                                                  
  measId                                                                                   1                                                                              
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                     Measurement report for NR Cell 1   
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1                            
  servCellId                                                                               ServCellIndex of NR Cell 1                                                     
  measResultServingCell SEQUENCE {                                                                                                                                        
  physCellId                                                                               PCI of NR Cell 1                                                               
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                     (0..127)                                                                       
  rsrq                                                                                     (0..127)                                                                       
  sinr                                                                                     (0..127)                                                                       pc\_ss\_SINR\_Meas
                                                                                           Not present                                                                    
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  measResultNeighCells CHOICE {                                                                                                                                           
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                     Measurement report for NR Cell 3   
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1                            
  physCellId                                                                               Physical layer cell identity of NR Cell 3                                      
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                     (0..127)                                                                       
  rsrq                                                                                     (0..127)                                                                       
  sinr                                                                                     (0..127)                                                                       pc\_ss\_SINR\_Meas
                                                                                           Not present                                                                    
  }                                                                                                                                                                       
  resultsCSI-RS-Cell                                                                       Not present                                                                    
  }                                                                                                                                                                       
  rsIndexResults                                                                           Not present                                                                    
  }                                                                                                                                                                       
  cgi-Info                                                                                 Not present                                                                    
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  ---------------------------------------------------------------------------------------- ------------------------------------------- ---------------------------------- --------------------

##### 8.1.3.1.21 Measurement configuration control and reporting / Measurement Gaps / gapFR2

##### 8.1.3.1.21.1 Test Purpose (TP) {#test-purpose-tp-55 .H6}

##### (1) {#section-99 .H6}

**with { UE in NR RRC\_CONNECTED state }**

**ensure that {**

**when { UE receives RRCReconfiguration message containing MeasConfig to
setup gapFR2 and report periodical measurements for neighbor cell on FR2
frequency }**

**then { UE applies gapFR2 and sends periodical measurements for
neighbor cell on FR2 frequency }**

**}**

##### 8.1.3.1.21.2 Conformance requirements {#conformance-requirements-55 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.2.9, 5.5.4.1,
5.5.4.5 and 5.5.5.1. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

...

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

...

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapFR2* is set to *setup*:

2\> if an FR2 measurement gap configuration is already setup, release
the FR2 measurement gap configuration;

2\> setup the FR2 measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

3\> if the corresponding *measObject* concerns NR:

...

4\> for measurement events other than *eventA1* or *eventA2*:

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
not included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

...

2\> if *reportType* is set to *periodical* and if a (first) measurement
result is available:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> if the *reportAmount* exceeds 1:

4\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after the quantity to be reported becomes available for the
NR SpCell;

3\> else (i.e. the *reportAmount* is equal to 1):

4\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after the quantity to be reported becomes available for the
NR SpCell and for the strongest cell among the applicable cells;

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

...

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with
*servingCellMO*, RSRP, RSRQ and the available SINR, derived based on the
*rsType* if indicated in the associated *reportConfig,* otherwise based
on SSB if available, otherwise based on CSI-RS;

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

...

4\> else:

5\> include the applicable cells for which the new measurement results
became available since the last periodical reporting or since the
measurement was initiated or reset;

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

1\> else:

2\> if the *reportType* is set to *periodical*:

3\> remove the entry within the *VarMeasReportList* for this *measId*;

3\> remove this *measId* from the *measIdList* within *VarMeasConfig*;

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.1.21.3 Test description {#test-description-55 .H6}

##### 8.1.3.1.21.3.1 Pre-test conditions {#pre-test-conditions-55 .H6}

System Simulator:

\- NR Cell 1 is the serving cell, NR Cell 3 is the inter-frequency
neighbour cell of NR Cell 1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.1.21.3.2 Test procedure sequence {#test-procedure-sequence-56 .H6}

Table 8.1.3.1.21.3.2-1: Main behaviour

  St   Procedure                                                                                                                                                      Message Sequence   TP                                     Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                      U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message to setup FR2 independent gap (pattern \#13) and inter-frequency measurement on NR Cell 3*.*                   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                      \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit at least 3 *MeasurementReport* messages to periodically report the measured RSRP value for NR Cell 3 within the next 30 seconds?   \--\>              *NR RRC: MeasurementReport*            1         P
  4    The SS transmits an *RRCReconfiguration* to change gap pattern to pattern \#14.                                                                                \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  5    The UE transmits an *RRCReconfigurationComplete* message to confirm the change of pattern.                                                                     \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  6    Check: Does the UE transmit at least 3 *MeasurementReport* messages to periodically report the measured RSRP value for NR Cell 3 within the next 30 seconds?   \--\>              *NR RRC: MeasurementReport*            1         P
  \-   EXCEPTION: Steps 7 to 9 shall be repeated for each gap pattern among \#12 and \#15 - \#23 and supported by UE (indicated in *supportedGapPattern*).                                                                                
  7    The SS transmits an *RRCReconfiguration* to change gap pattern to the next pattern supported by UE.                                                            \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  8    The UE transmits an *RRCReconfigurationComplete* message to confirm the change of gap pattern.                                                                 \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  9    Check: Does the UE transmit at least 3 *MeasurementReport* messages to periodically report the measured RSRP value for NR Cell 3 within the next 30 seconds?   \--\>              *NR RRC: MeasurementReport*            1         P

##### 8.1.3.1.21.3.3 Specific message contents {#specific-message-contents-47 .H6}

Table 8.1.3.1.21.3.3-1: *RRCReconfiguration* (step 1, 4 and 7, Table
8.1.3.1.21.3.2-2)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.21.3.3-2: *MeasConfig* (Table 8.1.3.1.21.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------------------ ------------------------ ------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                              
  Information Element                                                                        Value/remark                               Comment                  Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                      
  measObjectToAddModList                                                                     Not present                                                         Step 4 OR Step 7
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                           Step 1
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                    entry 1                  
  measObjectId                                                                               1                                                                   
  measObject CHOICE {                                                                                                                                            
  measObjectNR                                                                               MeasObjectNR-f1                            Table 8.1.3.1.21.3.3-3   
  }                                                                                                                                                              
  }                                                                                                                                                              
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                    entry 2                  
  measObjectId                                                                               2                                                                   
  measObject CHOICE {                                                                                                                                            
  measObjectNR                                                                               MeasObjectNR-f2                            Table 8.1.3.1.21.3.3-4   
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  reportConfigToAddModList                                                                   Not present                                                         Step 4 OR Step 7
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                             Step 1
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                  entry 1                  
  reportConfigId                                                                             1                                                                   
  reportConfig CHOICE {                                                                                                                                          
  reportConfigNR                                                                             ReportConfigNR with condition PERIODICAL                            
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  measIdToAddModList SEQUENCE (SIZE                                                          Not present                                                         Step 4 OR Step 7
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                             Step 1
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                  
  measId                                                                                     1                                                                   
  measObjectId                                                                               2                                                                   
  reportConfigId                                                                             1                                                                   
  }                                                                                                                                                              
  }                                                                                                                                                              
  measGapConfig                                                                              MeasGapConfig-gapFR2                       Table 8.1.3.1.21.3.3-5   
  }                                                                                                                                                              
  ------------------------------------------------------------------------------------------ ------------------------------------------ ------------------------ ------------------

Table 8.1.3.1.21.3.3-3: *MeasObjectNR-f1* (Table 8.1.3.1.21.3.3-2)

  ---------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                                                                                       
  Information Element                                  Value/remark                         Comment                                                                        Condition
  MeasObjectNR::= SEQUENCE {                                                                                                                                               
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1                                                                                  
  smtc1 SEQUENCE {                                                                                                                                                         
  periodicityAndOffset CHOICE {                                                                                                                                            
  sf20                                                 10                                   To make sure SMTC for intra-frequency measurement is non-overlapping with MG   
  }                                                                                                                                                                        
  }                                                                                                                                                                        
  absThreshSS-BlocksConsolidation                      Not present                                                                                                         
  nrofSS-BlocksToAverage                               Not present                                                                                                         
  }                                                                                                                                                                        
  ---------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------ -----------

Table 8.1.3.1.21.3.3-4: *MeasObjectNR-f2* (Table 8.1.3.1.21.3.3-2)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 3             
  smtc1 SEQUENCE {                                                                                    
  periodicityAndOffset CHOICE {                                                                       
  sf20                                                 0                                              
  }                                                                                                   
  }                                                                                                   
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.3.1.21.3.3-5: MeasGapConfig-gapFR2 (Table 8.1.3.1.21.3.3-2)

  ---------------------------------------------------------------------------- -------------- --------- ----------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-70 with Condition GAP\_FR2                            
  Information Element                                                          Value/remark   Comment   Condition
  MeasGapConfig ::= SEQUENCE {                                                                          
  gapFR2 CHOICE {                                                                                       
  setup SEQUENCE {                                                                                      
  gapOffset                                                                    0                        
  mgl                                                                          ms1dot5                  Pattern \#20, \#21, \#22 or \#23
                                                                               ms3dot5                  Pattern \#16, \#17, \#18 or \#19
                                                                               ms5dot5                  Pattern \#12, \#13, \#14 or \#15
  mgrp                                                                         ms20                     Pattern \#12, \#16 or \#20
                                                                               ms40                     Pattern \#13, \#17 or \#21
                                                                               ms80                     Pattern \#14, \#18 or \#22
                                                                               ms160                    Pattern \#15, \#19 or \#23
  mgta                                                                         ms0                      
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  ---------------------------------------------------------------------------- -------------- --------- ----------------------------------

Table 8.1.3.1.21.3.3-6: *MeasurementReport* (step 1, Table
8.1.3.1.21.3.2-4)

  ---------------------------------------------------------------------------------------- ------------------------------------------- ---------------------------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                                       
  Information Element                                                                      Value/remark                                Comment                            Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                             
  measurementReport SEQUENCE {                                                                                                                                            
  measResults SEQUENCE {                                                                                                                                                  
  measId                                                                                   1                                                                              
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                     Measurement report for NR Cell 1   
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1                            
  servCellId                                                                               ServCellIndex of NR Cell 1                                                     
  measResultServingCell SEQUENCE {                                                                                                                                        
  physCellId                                                                               PCI of NR Cell 1                                                               
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                     (0..127)                                                                       
  rsrq                                                                                     (0..127)                                                                       
  sinr                                                                                     (0..127)                                                                       pc\_ss\_SINR\_Meas
                                                                                           Not present                                                                    
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  measResultNeighCells CHOICE {                                                                                                                                           
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                     Measurement report for NR Cell 3   
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1                            
  physCellId                                                                               Physical layer cell identity of NR Cell 3                                      
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                     (0..127)                                                                       
  rsrq                                                                                     (0..127)                                                                       
  sinr                                                                                     (0..127)                                                                       pc\_ss\_SINR\_Meas
                                                                                           Not present                                                                    
  }                                                                                                                                                                       
  resultsCSI-RS-Cell                                                                       Not present                                                                    
  }                                                                                                                                                                       
  rsIndexResults                                                                           Not present                                                                    
  }                                                                                                                                                                       
  cgi-Info                                                                                 Not present                                                                    
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  ---------------------------------------------------------------------------------------- ------------------------------------------- ---------------------------------- --------------------

##### 8.1.3.1.22 Void

##### 8.1.3.1.23 Measurement configuration control and reporting / Intra NR measurements / Periodic reporting / Continuation of the measurements after RRC Resume

##### 8.1.3.1.23.1 Test Purpose (TP) {#test-purpose-tp-56 .H6}

\(1\)

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives RRCReconfiguration including measConfig to setup
periodical measurement reporting }

**then** { UE sends RRCReconfigurationComplete and starts sending
periodic measurement reports }

}

\(2\)

**with** { UE in NR RRC\_INACTIVE state and measurement configured for
periodical reporting }

**ensure that** {

**when** { UE receives RRCResume message without including measconfig }

**then** { UE resumes RRC connection and performs periodic measurements
as per the measurement configuration }

}

\(3\)

**with** { UE in NR RRC\_INACTIVE state and measurement configured for
periodical reporting }

**ensure that** {

**when** { UE receives RRCResume message including the measconfig }

**then** { UE resumes RRC connection and performs periodic measurements
as per the received measconfig in RRCResume message }

}

##### 8.1.3.1.23.2 Conformance requirements {#conformance-requirements-56 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clause 5.3.13.4, 5.5.2 and 5.5.4.1.

\[TS 38.331, clause 5.3.13.4\]

The UE shall:

> ...
>
> 1\> release the *suspendConfig* except the *ran-NotificationAreaInfo*;
>
> ...
>
> 1\> resume SRB2 and all DRBs;
>
> ...
>
> 1\> if the *RRCResume* message includes the *measConfig*:
>
> 2\> perform the measurement configuration procedure as specified in
> 5.5.2;
>
> 1\> resume measurements if suspended;
>
> ...
>
> 1\> enter RRC\_CONNECTED;
>
> 1\> indicate to upper layers that the suspended RRC connection has
> been resumed;
>
> ...
>
> 1\> consider the current cell to be the PCell;

...

> 1\> submit the *RRCResumeComplete* message to lower layers for
> transmission;

1\> the procedure ends.

\[TS 38.331, clause 5.3.13.4\]

The UE shall:

> ...
>
> 1\> if the received *measConfig* includes the
> *measObjectToAddModList*:
>
> 2\> perform the measurement object addition/modification procedure as
> specified in 5.5.2.5;
>
> ...
>
> 1\> if the received *measConfig* includes the
> *reportConfigToAddModList*:
>
> 2\> perform the reporting configuration addition/modification
> procedure as specified in 5.5.2.7;
>
> 1\> if the received *measConfig* includes the *quantityConfig*:
>
> 2\> perform the quantity configuration procedure as specified in
> 5.5.2.8;
>
> 1\> if the received *measConfig* includes the *measIdToRemoveList*:
>
> 2\> perform the measurement identity removal procedure as specified in
> 5.5.2.2;
>
> 1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

> 1\> for each *measId* included in the *measIdList* within
> *VarMeasConfig*:
>
> 2\> if the corresponding *reportConfig* includes a *reportType* set to
> *eventTriggered* or *periodical*:
>
> 3\> if the corresponding *measObject* concerns NR:
>
> ...
>
> 4\> if corresponding *reportConfig* includes *reportType* set to
> *periodical*; or
>
> 4\> for measurement events other than *eventA1* or *eventA2*:
>
> 5\> if *useAllowedCellList* is set to *true*:
>
> 6\> consider any neighbouring cell detected based on parameters in the
> associated *measObjectNR* to be applicable when the concerned cell is
> included in the *allowedCellsToAddModList* defined within the
> *VarMeasConfig* for this *measId*;
>
> 5\> else:
>
> 6\> consider any neighbouring cell detected based on parameters in the
> associated *measObjectNR* to be applicable when the concerned cell is
> not included in the *excludedCellsToAddModList* defined within the
> *VarMeasConfig* for this *measId*;
>
> ...
>
> 2\> if *reportType* is set to *periodical* and if a (first)
> measurement result is available:
>
> 3\> include a measurement reporting entry within the
> *VarMeasReportList* for this *measId*;
>
> 3\> set the *numberOfReportsSent* defined within the
> *VarMeasReportList* for this *measId* to 0;
>
> 3\> if the *reportAmount* exceeds 1:
>
> 4\> initiate the measurement reporting procedure, as specified in
> 5.5.5, immediately after the quantity to be reported becomes available
> for the NR SpCell;
>
> 3\> else (i.e. the *reportAmount* is equal to 1):
>
> 4\> initiate the measurement reporting procedure, as specified in
> 5.5.5, immediately after the quantity to be reported becomes available
> for the NR SpCell and for the strongest cell among the applicable
> cells;
>
> 2\> upon expiry of the periodical reporting timer for this *measId*:
>
> 3\> initiate the measurement reporting procedure, as specified in
> 5.5.5.

##### 8.1.3.1.23.3 Test description {#test-description-56 .H6}

##### 8.1.3.1.23.3.1 Pre-test conditions {#pre-test-conditions-56 .H6}

##### System Simulator: {#system-simulator-36 .H6}

\- NR Cell 1 is the serving cell, NR Cell 2 is the intra-frequency
neighbour cell of NR Cell 1.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-33 .H6}

\- None.

##### Preamble: {#preamble-35 .H6}

> \- The UE is in state 3N-A in NR Cell 1 as defined in TS 38.508-1
> \[4\], subclause 4.4A.

##### 8.1.3.1.23.3.2 Test procedure sequence {#test-procedure-sequence-57 .H6}

Tables 8.1.3.1.23.3.2-1 and 8.1.3.1.23.3.2-2 illustrate the downlink
power levels to be applied for NR Cell 1 and NR Cell 2 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble.

Table 8.1.3.1.23.3.2-1: Power levels in FR1

+----+------------------+------+-----------+--------+--------+
|    | Parameter        | Unit | NR Cell 1 | NR     | Remark |
|    |                  |      |           |        |        |
|    |                  |      |           | Cell 2 |        |
+====+==================+======+===========+========+========+
| T0 | SS/PBCH SSS EPRE | dBm/ | -85       | -91    |        |
|    |                  |      |           |        |        |
|    |                  | SCS  |           |        |        |
+----+------------------+------+-----------+--------+--------+

Table 8.1.3.1.23.3.2-2: Power levels in FR2

+----+------------------+----------+--------+--------+--------+
|    | Parameter        | Unit     | NR     | NR     | Remark |
|    |                  |          |        |        |        |
|    |                  |          | Cell 1 | Cell 2 |        |
+====+==================+==========+========+========+========+
| T0 | SS/PBCH SSS EPRE | dBm/ SCS | -82    | -91    |        |
+----+------------------+----------+--------+--------+--------+

Table 8.1.3.1.23.3.2-3: Main behaviour

  St     Procedure                                                                                                                                                                             Message Sequence   TP                                     Verdict   
  ------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                               U - S              Message                                          
  1      The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup intra NR periodic measurement reporting.                                                             \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2      The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                             \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  2A     The SS waits and ignores MeasurementReport messages for 3s to allow UE to measure NR Cell 2.                                                                                          \--\>              *NR RRC: MeasurementReport*            \-        \-
  3      Check: Does the UE transmit at least 10 *MeasurementReport messages within the next 30 seconds*?                                                                                      \--\>              *NR RRC: MeasurementReport*            1         P
  \-     EXCEPTION: Steps 4a1-4a14 describe behaviour that depends on UE configuration; the \"lower case letter\" identifies a step sequence that takes place if inactiveState is configured   \-                 *-*                                    \-        \-
  4a1    IF pc\_inactiveState THEN the SS transmits an RRCRelease message with *suspendConfig*.                                                                                                \<\--              NR RRC: *RRCRelease*                   \-        \-
  4a2    The SS waits for 5 sec and transmits a *Paging* message including a matched identity (correct *fullI-RNTI*).                                                                          \-                 NR RRC: *Paging*                       \-        \-
  4a3    UE transmits *RRCResumeRequest* message                                                                                                                                               \--\>              NR RRC: *RRCResumeRequest*             \-        \-
  4a4    The SS transmits an *RRCResume* message without including *MeasConfig*.                                                                                                               \<\--              NR RRC: *RRCResume*                    \-        \-
  4a5    The UE transmits an *RRCResumeComplete* message.                                                                                                                                      \--\>              NR RRC: *RRCResumeComplete*            \-        \-
  4a6    The SS waits and ignores MeasurementReport messages for 3s to allow UE to measure NR Cell 2.                                                                                          \--\>              *NR RRC: MeasurementReport*            \-        \-
  4a7    Check: Does the UE transmit at least 10 *MeasurementReport messages within the next 30 seconds*?                                                                                      \--\>              *NR RRC: MeasurementReport*            2         P
  4a8    The SS transmits an RRCRelease message with *suspendConfig*.                                                                                                                          \<\--              NR RRC: *RRCRelease*                   \-        \-
  4a9    The SS waits for 5 sec and transmits a Paging message including a matched identity (correct fullI-RNTI).                                                                              \-                 NR RRC: Paging                         \-        \-
  4a10   UE transmits RRCResumeRequest message                                                                                                                                                 \--\>              NR RRC: RRCResumeRequest               \-        \-
  4a11   The SS transmits an RRCResume message including MeasConfig.                                                                                                                           \<\--              NR RRC: RRCResume                      \-        \-
  4a12   The UE transmits an RRCResumeComplete message.                                                                                                                                        \--\>              NR RRC: RRCResumeComplete              \-        \-
  4a13   The SS waits and ignores MeasurementReport messages for 3s to allow UE to measure NR Cell 2.                                                                                          \--\>              NR RRC: MeasurementReport              \-        \-
  4a14   Check: Does the UE transmit at least 10 MeasurementReport messages within the next 30 seconds?                                                                                        \--\>              NR RRC: MeasurementReport              3         P
  5-16   Void                                                                                                                                                                                  \-                 \-                                     \-        \-
  17     The SS transmits an RRCRelease message                                                                                                                                                \<\--              NR RRC: RRCRelease                     \-        \-

##### 8.1.3.1.23.3.3 Specific message contents {#specific-message-contents-48 .H6}

Table 8.1.3.1.23.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.1.23.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.23.3.3-2: *MeasConfig* (Table 8.1.3.1.23.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------------------------ ------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                               
  Information Element                                                                        Value/remark                                     Comment             Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                       
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                              
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1             
  measObjectId                                                                               1                                                MeasObjectIdNR-f1   
  measObject CHOICE {                                                                                                                                             
  measObjectNR SEQUENCE {                                                                                                                                         
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 2                       
  absThreshSS-BlocksConsolidation                                                            Not present                                                          
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                              
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1             
  reportConfigId                                                                             1                                                                    
  reportConfig CHOICE {                                                                                                                                           
  reportConfigNR                                                                             ReportConfigNR with condition PERIODICAL                             
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                              
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1             
  measId                                                                                     1                                                                    
  measObjectId                                                                               1                                                                    
  reportConfigId                                                                             1                                                                    
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  ------------------------------------------------------------------------------------------ ------------------------------------------------ ------------------- -----------

Table 8.1.3.1.23.3.3-3: *MeasurementReport* (step 3 and step 4a7, Table
8.1.3.1.23.3.2-3)

  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                              
  Information Element                                                                      Value/remark                                Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                                    
  measurementReport SEQUENCE {                                                                                                                   
  measResults SEQUENCE {                                                                                                                         
  measId                                                                                   1                                                     
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1   
  servCellId                                                                               Cell index corresponding to NR Cell 1                 
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 1             
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  measResultNeighCells CHOICE {                                                                                                                  
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                               
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1   
  physCellId                                                                               Physical layer cell identity of NR Cell 2             
  measResult                                                                               Not Checked                                           
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- -----------

Table 8.1.3.1.23.3.3-4: *RRCRelease* (step 4a1 and step 4a8, Table
8.1.3.1.23.3.2-3)

  ------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16 with condition NR\_RRC\_INACTIVE
  ------------------------------------------------------------------------------------

Table 8.1.3.1.23.3.3-5: *Paging* (step 4a2 and step 4a9, Table
8.1.3.1.23.3.2-3)

  ---------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-9 with condition NR\_RRC\_RESUME
  ---------------------------------------------------------------------------------

Table 8.1.3.1.23.3.3-6: *RRCResumeRequest* (step 4a3 and step 4a10,
Table 8.1.3.1.23.3.2-3)

  Derivation Path: TS 38.331 \[6\], clause 6.2.2                            
  ------------------------------------------------ -------------- --------- -----------
  Information Element                              Value/remark   Comment   Condition
  RRCResumeRequest ::= SEQUENCE {                                           
  rrcResumeRequest SEQUENCE {                                               
  resumeCause                                      mt-Access                
  }                                                                         
  }                                                                         

Table 8.1.3.1.23.3.3-7: *RRCResume* (step 4a11, Table 8.1.3.1.23.3.2-3)

  ------------------------------------------------ ------------------ --------- -----------
  Derivation Path: TS 38.331 \[6\], clause 6.2.2                                
  Information Element                              Value/remark       Comment   Condition
  RRCResume ::= SEQUENCE {                                                      
  criticalExtensions CHOICE {                                                   
  rrcResume SEQUENCE {                                                          
  measConfig                                       MeasConfigResume             
  }                                                                             
  }                                                                             
  }                                                                             
  ------------------------------------------------ ------------------ --------- -----------

Table 8.1.3.1.23.3.3-8: MeasConfigResume (Table 8.1.3.1.23.3.3-7)

  ------------------------------------------------------------------------------------------ ------------------------------------------------ ------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                               
  Information Element                                                                        Value/remark                                     Comment             Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                       
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                              
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1             
  measObjectId                                                                               1                                                MeasObjectIdNR-f1   
  measObject CHOICE {                                                                                                                                             
  measObjectNR SEQUENCE {                                                                                                                                         
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 2                       
  absThreshSS-BlocksConsolidation                                                            Not present                                                          
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                              
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1             
  reportConfigId                                                                             1                                                                    
  reportConfig CHOICE {                                                                                                                                           
  reportConfigNR                                                                             ReportConfigNR with condition PERIODICAL                             
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  measIdToRemoveList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasId {                          1 entry                                                              
  measId\[1\]                                                                                1                                                                    
  }                                                                                                                                                               
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                              
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1             
  measId                                                                                     2                                                                    
  measObjectId                                                                               1                                                                    
  reportConfigId                                                                             1                                                                    
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  ------------------------------------------------------------------------------------------ ------------------------------------------------ ------------------- -----------

Table 8.1.3.1.23.3.3-9: *MeasurementReport* (step 4a14, Table
8.1.3.1.23.3.2-3)

  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                              
  Information Element                                                                      Value/remark                                Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                                    
  measurementReport SEQUENCE {                                                                                                                   
  measResults SEQUENCE {                                                                                                                         
  measId                                                                                   2                                                     
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1   
  servCellId                                                                               Cell index corresponding to NR Cell 1                 
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 1             
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  measResultNeighCells CHOICE {                                                                                                                  
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                               
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1   
  physCellId                                                                               Physical layer cell identity of NR Cell 2             
  measResult                                                                               Not Checked                                           
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- -----------

##### 8.1.3.1.24 Measurement configuration control and reporting for voice / QoE

##### 8.1.3.1.24.1 Test Purpose (TP) {#test-purpose-tp-57 .H6}

##### (1) {#section-100 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message containing
*srb-Identity-v1700* and *servedRadioBearerSRB4-r17* }

**then** { UE configure SRB4 and sends an *RRCReconfigurationComplete*
message }

}

##### (2) {#section-101 .H6}

**with** { UE in NR RRC\_CONNECTED state configured with SRB4 and not
configured with application layer measurement and reporting }

**ensure that** {

**when** { speech call is ongoing }

**then** { UE does not send a *MeasurementReportAppLayer* message }

}

##### (3) {#section-102 .H6}

**with** { UE in NR RRC\_CONNECTED state configured with SRB4 and with
application layer measurement and reporting and speech call is ongoing }

**ensure that** {

**when** { speech call is ongoing }

**then** { UE sends a *MeasurementReportAppLayer* message }

}

##### 8.1.3.1.24.2 Conformance requirements {#conformance-requirements-57 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 4.2.2, 5.7.16.2 and TS 26.114 clause
16.3.

\[TS 38.331 clause 4.2.2\]

\"Signalling Radio Bearers\" (SRBs) are defined as Radio Bearers (RBs)
that are used only for the transmission of RRC and NAS messages. More
specifically, the following SRBs are defined:

...

> \- SRB4 is for RRC messages which include application layer
> measurement report information, all using DCCH logical channel. SRB4
> has a lower priority than SRB1 and can only be configured by the
> network after AS security activation.

\[TS 38.331 clause 5.7.16.2\]

A UE capable of application layer measurement reporting in
RRC\_CONNECTED may initiate the procedure when configured with
application layer measurement and reporting, i.e. when at least one
*measConfigAppLayer* and SRB4 and/or SRB5 have been configured by the
network.

Upon initiating the procedure, the UE shall:

...

1\> for each *measConfigAppLayerId received from upper layers*:

2\> if the UE AS has received application layer measurement report
container from upper layers which has not been transmitted; and

...

2\> set the *measConfigAppLayerId* in the *MeasurementReportAppLayer*
message to the value of the *measConfigAppLayerId* received together
with application layer measurement report information;

...

1\> for each encoded *MeasurementReportAppLayer* message generated above
which contains either only encapsulated application layer measurement
reports or both encapsulated application layer measurement reports and
RAN visible application layer measurement reports:

2\> if *reportingSRB* is not configured for the *measConfigAppLayerId*:

...

3\> else:

4\> submit the *MeasurementReportAppLayer* message to lower layers for
transmission via SRB4.

\[TS 26.114 clause 16.3\]

The QoE configuration shall only be evaluated by the client at the start
of a QoE measurement and reporting session ("QoE session") associated
with a MTSI session. This includes evaluation of any filtering criteria
such as by geographical area. Client evaluation of all measurement and
reporting criterias for an ongoing QoE session shall be unaffected by
any QoE configuration changes received during that session -- i.e., any
changes to the QoE configuration shall only affect QoE sessions started
after these configuration changes have been received.

##### 8.1.3.1.24.3 Test description {#test-description-57 .H6}

##### 8.1.3.1.24.3.1 Pre-test conditions {#pre-test-conditions-57 .H6}

##### System Simulator: {#system-simulator-37 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-34 .H6}

\- None.

##### Preamble: {#preamble-36 .H6}

\- The UE is in state RRC\_IDLE using generic procedure parameter
Connectivity (*NR*) according to TS 38.508-1 \[4\], Table 4.5.1-1.

##### 8.1.3.1.24.3.2 Test procedure sequence {#test-procedure-sequence-58 .H6}

Table 8.1.3.1.24.3.2-1: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U -- S      | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | Make the UE | \-          | \-          | \-      | \- |
|       | attempt an  |             |             |         |    |
|       | IMS voice   |             |             |         |    |
|       | call.       |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2-6   | Steps 2-6   | \-          | \-          | \-      | \- |
|       | of test     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | specified   |             |             |         |    |
|       | in Table    |             |             |         |    |
|       | 4           |             |             |         |    |
|       | .9.15.2.2-1 |             |             |         |    |
|       | of TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRecon   |         |    |
|       | an          |             | figuration* |         |    |
|       | RRCReco     |             |             |         |    |
|       | nfiguration |             | 5GMM:       |         |    |
|       | message and |             | SERVICE     |         |    |
|       | a SERVICE   |             | ACCEPT      |         |    |
|       | ACCEPT      |             |             |         |    |
|       | message to  |             |             |         |    |
|       | establish   |             |             |         |    |
|       | SRB2, SRB4  |             |             |         |    |
|       | and DRB(s). |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 8     | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *RRCRe      |         |    |
|       | transmit an |             | configurati |         |    |
|       | *RRCRe      |             | onComplete* |         |    |
|       | configurati |             |             |         |    |
|       | onComplete* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 9-13  | Steps 9-13  | \-          | \-          | \-      | \- |
|       | of test     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | specified   |             |             |         |    |
|       | in Table    |             |             |         |    |
|       | 4           |             |             |         |    |
|       | .9.15.2.2-1 |             |             |         |    |
|       | of TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | Check: Does | \--\>       | NR RRC:     | 2       | F  |
|       | the UE      |             | *Meas       |         |    |
|       | transmit a  |             | urementRepo |         |    |
|       | *Meas       |             | rtAppLayer* |         |    |
|       | urementRepo |             |             |         |    |
|       | rtAppLayer* |             |             |         |    |
|       | message     |             |             |         |    |
|       | during the  |             |             |         |    |
|       | next 40     |             |             |         |    |
|       | seconds?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | Test        | \-          | \-          | \-      | \- |
|       | procedure   |             |             |         |    |
|       | for IMS MT  |             |             |         |    |
|       | call        |             |             |         |    |
|       | release in  |             |             |         |    |
|       | 5GS         |             |             |         |    |
|       | described   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.18      |             |             |         |    |
|       | takes       |             |             |         |    |
|       | place.      |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRelease* |         |    |
|       | an          |             |             |         |    |
|       | RRCRelease  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 17-22 | Steps 1-6   | \-          | \-          | \-      | \- |
|       | of test     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | specified   |             |             |         |    |
|       | in Table    |             |             |         |    |
|       | 4           |             |             |         |    |
|       | .9.16.2.2-1 |             |             |         |    |
|       | of TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 23    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRecon   |         |    |
|       | an          |             | figuration* |         |    |
|       | RRCReco     |             |             |         |    |
|       | nfiguration |             | 5GMM:       |         |    |
|       | message and |             | SERVICE     |         |    |
|       | a SERVICE   |             | ACCEPT      |         |    |
|       | ACCEPT      |             |             |         |    |
|       | message to  |             |             |         |    |
|       | establish   |             |             |         |    |
|       | SRB2, SRB4  |             |             |         |    |
|       | and DRB(s). |             |             |         |    |
|       |             |             |             |         |    |
|       | The         |             |             |         |    |
|       | RRCReco     |             |             |         |    |
|       | nfiguration |             |             |         |    |
|       | message is  |             |             |         |    |
|       | configured  |             |             |         |    |
|       | using       |             |             |         |    |
|       | RR          |             |             |         |    |
|       | CReconfigur |             |             |         |    |
|       | ation-SRB2- |             |             |         |    |
|       | SRB4-DRB(n, |             |             |         |    |
|       | m) where n  |             |             |         |    |
|       | and m are   |             |             |         |    |
|       | the number  |             |             |         |    |
|       | of DRB(s)   |             |             |         |    |
|       | configured  |             |             |         |    |
|       | during the  |             |             |         |    |
|       | preamble.   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 24    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             | *RRCRe      |         |    |
|       | *RRCRe      |             | configurati |         |    |
|       | configurati |             | onComplete* |         |    |
|       | onComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 25-29 | Steps 9-13  | \-          | \-          | \-      | \- |
|       | of test     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | specified   |             |             |         |    |
|       | in Table    |             |             |         |    |
|       | 4           |             |             |         |    |
|       | .9.16.2.2-1 |             |             |         |    |
|       | of TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 30    | Check: Does | \--\>       | NR RRC:     | 3       | P  |
|       | the UE      |             | *Meas       |         |    |
|       | transmit a  |             | urementRepo |         |    |
|       | *Meas       |             | rtAppLayer* |         |    |
|       | urementRepo |             |             |         |    |
|       | rtAppLayer* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 31    | Test        | \-          | \-          | \-      | \- |
|       | procedure   |             |             |         |    |
|       | for IMS MT  |             |             |         |    |
|       | call        |             |             |         |    |
|       | release in  |             |             |         |    |
|       | 5GS         |             |             |         |    |
|       | described   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.18      |             |             |         |    |
|       | takes       |             |             |         |    |
|       | place.      |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 32    | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRelease* |         |    |
|       | an          |             |             |         |    |
|       | RRCRelease  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.3.1.24.3.3 Specific message contents {#specific-message-contents-49 .H6}

Table 8.1.3.1.24.3.3-1: RRCReconfiguration (step 7, Table
8.1.3.1.24.3.2-1)

+----------------+----------------+----------------+---------------+
| Derivation     |                |                |               |
| Path: TS       |                |                |               |
| 38.508-1 \[4\] |                |                |               |
| Table 4.6.1-13 |                |                |               |
| with condition |                |                |               |
| NR             |                |                |               |
+----------------+----------------+----------------+---------------+
| **Information  | **             | **Comment**    | **Condition** |
| Element**      | Value/remark** |                |               |
+----------------+----------------+----------------+---------------+
| RRCR           |                |                |               |
| econfiguration |                |                |               |
| ::= SEQUENCE { |                |                |               |
+----------------+----------------+----------------+---------------+
| crit           |                |                |               |
| icalExtensions |                |                |               |
| CHOICE {       |                |                |               |
+----------------+----------------+----------------+---------------+
| rrcR           |                |                |               |
| econfiguration |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| rad            | RadioBea       | Note1          |               |
| ioBearerConfig | rerConfig-SRB2 |                |               |
|                | -SRB4-DRB(n,m) |                |               |
+----------------+----------------+----------------+---------------+
| nonCri         |                |                |               |
| ticalExtension |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| m              | Cell           | OCTET STRING   |               |
| asterCellGroup | GroupConfig-SR | (CONTAINING    |               |
|                | B2-SRB4-DRB(n, | Ce             |               |
|                | m)             | llGroupConfig) |               |
|                |                |                |               |
|                |                | Note 1         |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| Note 1: n and  |                |                |               |
| m are the      |                |                |               |
| number of      |                |                |               |
| DRB(s)         |                |                |               |
| configured in  |                |                |               |
| the preamble   |                |                |               |
+----------------+----------------+----------------+---------------+

Table 8.1.3.1.24.3.3-2: *RRCReconfiguration* (steps 10 and 26, Table
8.1.3.1.24.3.2-1)

  --------------------------------------------------- --------------------- ------------------------------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1C                                                                     
  **Information Element**                             **Value/remark**      **Comment**                                 **Condition**
  RRCReconfiguration ::= SEQUENCE {                                                                                     
  criticalExtensions CHOICE {                                                                                           
  rrcReconfiguration SEQUENCE {                                                                                         
  radioBearerConfig                                   RadioBearerConfig                                                 
  nonCriticalExtension SEQUENCE {                                                                                       
  masterCellGroup                                     CellGroupConfig-DRB   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                     
  }                                                                                                                     
  --------------------------------------------------- --------------------- ------------------------------------------- ---------------

Table 8.1.3.1.24.3.3-3: RadioBearerConfig (Table 8.1.3.1.24.3.3-2)

  ---------------------------------------------------------------- ------------------------------- --------------------------------------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-132                                                                                                   
  **Information Element**                                          **Value/remark**                **Comment**                                         **Condition**
  RadioBearerConfig ::= SEQUENCE {                                                                                                                     
  drb-ToAddModList SEQUENCE (SIZE (1..maxDRB)) OF DRB-ToAddMod {   1 entry                                                                             
  DRB-ToAddMod\[1\] SEQUENCE {                                                                     Entry 1                                             
  cnAssociation CHOICE {                                                                                                                               
  sdap-Config SEQUENCE {                                           SDAP-Config                                                                         
  defaultDRB                                                       false                                                                               
  }                                                                                                                                                    
  }                                                                                                                                                    
  drb-Identity                                                     j                               j is allocated according to internal TTCN mapping   
  reestablishPDCP                                                  Not present                                                                         
  recoverPDCP                                                      Not present                                                                         
  pdcp-Config                                                      PDCP-Config with condition UM                                                       
  }                                                                                                                                                    
  }                                                                                                                                                    
  }                                                                                                                                                    
  ---------------------------------------------------------------- ------------------------------- --------------------------------------------------- ---------------

Table 8.1.3.1.24.3.3-4: CellGroupConfig-DRB (Table 8.1.3.1.24.3.3-2)

  ------------------------------------------------------------------------- ------------------------------------------------------ ------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19.                                                                                             
  **Information Element**                                                   **Value/remark**                                       **Comment**   **Condition**
  CellGroupConfig ::= SEQUENCE {                                                                                                                 
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLCH)) OF RLC-BearerConfig {   1 entry                                                              
  RLC-BearerConfig\[1\]                                                     RLC-BearerConfigWithSRB4 with conditions UM and DRBj   entry 1       
  }                                                                                                                                              
  }                                                                                                                                              
  ------------------------------------------------------------------------- ------------------------------------------------------ ------------- ---------------

Table 8.1.3.1.24.3.3-5: *RRCReconfiguration* (step 23, Table
8.1.3.1.24.3.2-1)

  -----------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1CAA
  -----------------------------------------------------

##### 8.1.3.1.25 Measurement configuration control and reporting for video / QoE

##### 8.1.3.1.25.1 Test Purpose (TP) {#test-purpose-tp-58 .H6}

##### (1) {#section-103 .H6}

**with** { UE in NR RRC\_CONNECTED state configured with application
layer measurement and reporting and with SRB4 }

**ensure that** {

**when** { video call is ongoing }

**then** { UE sends a *MeasurementReportAppLayer* message }

}

##### 8.1.3.1.25.2 Conformance requirements {#conformance-requirements-58 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clause 5.7.16.2.

\[TS 38.331 clause 5.7.16.2\]

A UE capable of application layer measurement reporting in
RRC\_CONNECTED may initiate the procedure when configured with
application layer measurement and reporting, i.e. when at least one
*measConfigAppLayer* and SRB4 and/or SRB5 have been configured by the
network.

Upon initiating the procedure, the UE shall:

...

1\> for each *measConfigAppLayerId received from upper layers*:

2\> if the UE AS has received application layer measurement report
container from upper layers which has not been transmitted; and

...

2\> set the *measConfigAppLayerId* in the *MeasurementReportAppLayer*
message to the value of the *measConfigAppLayerId* received together
with application layer measurement report information;

...

1\> for each encoded *MeasurementReportAppLayer* message generated above
which contains either only encapsulated application layer measurement
reports or both encapsulated application layer measurement reports and
RAN visible application layer measurement reports:

2\> if *reportingSRB* is not configured for the *measConfigAppLayerId*:

...

3\> else:

4\> submit the *MeasurementReportAppLayer* message to lower layers for
transmission via SRB4.

##### 8.1.3.1.25.3 Test description {#test-description-58 .H6}

##### 8.1.3.1.25.3.1 Pre-test conditions {#pre-test-conditions-58 .H6}

##### System Simulator: {#system-simulator-38 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-35 .H6}

\- None.

##### Preamble: {#preamble-37 .H6}

\- The UE is in state RRC\_IDLE using generic procedure parameter
Connectivity (*NR*) according to TS 38.508-1 \[4\], Table 4.5.1-1.

##### 8.1.3.1.25.3.2 Test procedure sequence {#test-procedure-sequence-59 .H6}

Table 8.1.3.1.25.3.2-1: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U -- S      | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1-15  | Void        | \-          | \-          | \-      | \- |
+-------+-------------+-------------+-------------+---------+----+
| 16-21 | Steps 1-6   | \-          | \-          | \-      | \- |
|       | of test     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | specified   |             |             |         |    |
|       | in Table    |             |             |         |    |
|       | 4           |             |             |         |    |
|       | .9.26.2.2-1 |             |             |         |    |
|       | of TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 22    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRecon   |         |    |
|       | an          |             | figuration* |         |    |
|       | RRCReco     |             |             |         |    |
|       | nfiguration |             | 5GMM:       |         |    |
|       | message and |             | SERVICE     |         |    |
|       | a SERVICE   |             | ACCEPT      |         |    |
|       | ACCEPT      |             |             |         |    |
|       | message to  |             |             |         |    |
|       | establish   |             |             |         |    |
|       | SRB2, SRB4  |             |             |         |    |
|       | and DRB(s). |             |             |         |    |
|       |             |             |             |         |    |
|       | The         |             |             |         |    |
|       | RRCReco     |             |             |         |    |
|       | nfiguration |             |             |         |    |
|       | message is  |             |             |         |    |
|       | configured  |             |             |         |    |
|       | using       |             |             |         |    |
|       | RR          |             |             |         |    |
|       | CReconfigur |             |             |         |    |
|       | ation-SRB2- |             |             |         |    |
|       | SRB4-DRB(n, |             |             |         |    |
|       | m) where n  |             |             |         |    |
|       | and m are   |             |             |         |    |
|       | the number  |             |             |         |    |
|       | of DRB(s)   |             |             |         |    |
|       | configured  |             |             |         |    |
|       | during the  |             |             |         |    |
|       | preamble.   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 23    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             | *RRCRe      |         |    |
|       | *RRCRe      |             | configurati |         |    |
|       | configurati |             | onComplete* |         |    |
|       | onComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 24-28 | Steps 9-13  | \-          | \-          | \-      | \- |
|       | of test     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | specified   |             |             |         |    |
|       | in Table    |             |             |         |    |
|       | 4           |             |             |         |    |
|       | .9.26.2.2-1 |             |             |         |    |
|       | of TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 29    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *Meas       |         |    |
|       | transmit a  |             | urementRepo |         |    |
|       | *Meas       |             | rtAppLayer* |         |    |
|       | urementRepo |             |             |         |    |
|       | rtAppLayer* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 30    | Test        | \-          | \-          | \-      | \- |
|       | procedure   |             |             |         |    |
|       | for IMS MT  |             |             |         |    |
|       | call        |             |             |         |    |
|       | release in  |             |             |         |    |
|       | 5GS         |             |             |         |    |
|       | described   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.18      |             |             |         |    |
|       | takes       |             |             |         |    |
|       | place.      |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 31    | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRelease* |         |    |
|       | an          |             |             |         |    |
|       | RRCRelease  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.3.1.25.3.3 Specific message contents {#specific-message-contents-50 .H6}

Table 8.1.3.1.25.3.3-1: *RRCReconfiguration* (step 25, Table
8.1.3.1.25.3.2-1)

  ---------------------------------------------------------------------- ------------------------- ------------------------------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR.                                                                         
  **Information Element**                                                **Value/remark**          **Comment**                                 **Condition**
  RRCReconfiguration ::= SEQUENCE {                                                                                                            
  criticalExtensions CHOICE {                                                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                                                
  radioBearerConfig                                                      RadioBearerConfig-Video   TS 38.508-1\[4\] Table 4.8.1-6              
  nonCriticalExtension SEQUENCE {                                                                                                              
  masterCellGroup                                                        CellGroupConfig-DRB       OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  ---------------------------------------------------------------------- ------------------------- ------------------------------------------- ---------------

Table 8.1.3.1.25.3.3-2: CellGroupConfig-DRB (Table 8.1.3.1.25.3.3-1)

  ------------------------------------------------------------------------- --------------------------------------------------------------------- ------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19.                                                                                                            
  **Information Element**                                                   **Value/remark**                                                      **Comment**   **Condition**
  CellGroupConfig ::= SEQUENCE {                                                                                                                                
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLCH)) OF RLC-BearerConfig {   2 entries                                                                           
  RLC-BearerConfig\[1\]                                                     RLC-BearerConfigWithSRB4 with conditions UM and DRBj (with j=BID+k)   entry 1       
  RLC-BearerConfig\[2\]                                                     RLC-BearerConfigWithSRB4 with conditions UM and DRBj (with j=BID+k)   entry 2       
  }                                                                                                                                                             
  }                                                                                                                                                             
  ------------------------------------------------------------------------- --------------------------------------------------------------------- ------------- ---------------

Table 8.1.3.1.25.3.3-3: *RRCReconfiguration* (step 22, Table
8.1.3.1.25.3.2-1)

  -----------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1CAA
  -----------------------------------------------------

##### 8.1.3.1.26 NR NTN / Measurement configuration control and reporting / Event D1 / Measurement of Neighbour NR cell

##### 8.1.3.1.26.1 Test Purpose (TP) {#test-purpose-tp-59 .H6}

##### (1) {#section-104 .H6}

**with** { UE in NR RRC\_CONNECTED and measurement configured for event
D1 **with event based periodical reporting** }

**ensure that** {

**when** { Entering condition for event D1 is satisfied }

**then** { UE sends MeasurementReport message at regular intervals while
entering condition for event D1 is satisfied }

}

##### (2) {#section-105 .H6}

**with** { UE in NR RRC\_CONNECTED and measurement configured for event
D1 **with event based periodical reporting** }

**ensure** that {

**when** { Leaving condition for event D1 is satisfied }

**then** { **UE stops sending MeasurementReport message** }

}

##### 8.1.3.1.26.2 Conformance requirements {#conformance-requirements-59 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clauses 5.5.5.1, 5.5.4.15 and 5.5.4.1. Unless
otherwise stated these are Rel-17 requirements.

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> for each serving cell configured with *servingCellMO:*

2\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *rsType:*

3\> if the serving cell measurements based on the *rsType included in
the reportConfig* *that triggered the measurement report are available:*

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on the *rsType* included in the *reportConfig that triggered the
measurement report;*

2\> else*:*

3\> if SSB based serving cell measurements are available:

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on SSB;

3\> else if CSI-RS based serving cell measurements are available:

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on CSI-RS;

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

1\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *reportQuantityRS-Indexes* and
*maxNrofRS-IndexesToReport*:

2\> for each serving cell configured with *servingCellMO*, include beam
measurement information according to the associated *reportConfig* as
described in 5.5.5.2;

1\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *reportAddNeighMeas*:

2\> for each *measObjectId* referenced in the *measIdList* which is also
referenced with *servingCellMO*, other than the *measObjectId*
corresponding with the *measId* that triggered the measurement
reporting:

3\> if the *measObjectNR* indicated by the *servingCellMO* includes the
RS resource configuration corresponding to the *rsType* indicated in the
*reportConfig*:

4\> set the *measResultBestNeighCell* within *measResultServingMOList*
to include the *physCellId* and the available measurement quantities
based on the *reportQuantityCell* and *rsType* indicated in
*reportConfig* of the non-serving cell corresponding to the concerned
*measObjectNR* with the highest measured RSRP if RSRP measurement
results are available for cells corresponding to this *measObjectNR*,
otherwise with the highest measured RSRQ if RSRQ measurement results are
available for cells corresponding to this *measObjectNR*, otherwise with
the highest measured SINR;

4\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *reportQuantityRS-Indexes* and
*maxNrofRS-IndexesToReport:*

5\> for each best non-serving cell included in the measurement report:

6\> include beam measurement information according to the associated
*reportConfig* as described in 5.5.5.2;

....

1\> if there is at least one applicable neighbouring cell or candidate
L2 U2N Relay UE to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> if the measurement report concerns the candidate L2 U2N Relay UE:

4\> set the *sl-MeasResultsCandRelay* in *measResultNeighCells* to
include the best candidate L2 U2N Relay UEs up to *maxNrofRelayMeas* in
accordance with the following:

5\> if the *reportType* is set to *eventTriggered*:

6\> include the L2 U2N Relay UEs included in the *relaysTriggeredList*
as defined within the *VarMeasReportList* for this *measId*;

5\> else:

6\> include the applicable L2 U2N Relay UEs for which the new
measurement results became available since the last periodical reporting
or since the measurement was initiated or reset;

5\> for each L2 U2N Relay UE that is included in the
*sl-MeasResultsCandRelay*:

6\> set the *cellIdentity* to include the *cellAccessRelatedInfo*
contained in the discovery message received from the concerned L2 U2N
Relay UE;

6\> set the *sl-RelayUE-Identity* to include the Source L2 ID of the
concerned L2 U2N Relay UE;

6\> set the *sl-MeasResult* to include the SD-RSRP of the concerned L2
U2N Relay UE;

5\> for each included L2 U2N Relay UE, include the layer 3 filtered
measured results in accordance with the *reportConfig* for this
*measId*, ordered as follows:

6\> set the *sl-MeasResult* to include the quantity(ies) indicated in
the *reportQuantityRelay* within the concerned *reportConfigRelay* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best L2 U2N Relay UE is included first;

3\> else:

4\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

5\> if the *reportType* is set to *eventTriggered* and *eventId* is not
set to *eventD1*:

6\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

5\> else:

6\> include the applicable cells for which the new measurement results
became available since the last periodical reporting or since the
measurement was initiated or reset;

5\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

5\> if the reportType is set to eventTriggered or periodical:

6\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

7\> if the *measObject* associated with this *measId* concerns NR:

8\> if *rsType* in the associated *reportConfig* is set to *ssb*:

9\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

9\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

8\> else if *rsType* in the associated *reportConfig* is set to
*csi-rs*:

9\> set *resultsCSI-RS-Cell* within the *measResult* to include the
CSI-RS based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

9\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

7\> if the *measObject* associated with this *measId* concerns E-UTRA:

8\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantity* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

7\> if the *measObject* associated with this *measId* concerns UTRA-FDD
and if *ReportConfigInterRAT* includes the *reportQuantityUTRA-FDD*:

8\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantityUTRA-FDD* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

\[TS 38.331, clause 5.5.4.1\]

The UE shall:

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

3\> if the corresponding *measObject* concerns NR:

4\> if the corresponding *reportConfig* includes
*measRSSI-ReportConfig*:

5\> consider the resource indicated by the *rmtc-Config* on the
associated frequency to be applicable;

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

5\> consider only the serving cell to be applicable;

4\> if the *eventA3* or *eventA5* is configured in the corresponding
*reportConfig*:

5\> if a serving cell is associated with a *measObjectNR* and neighbours
are associated with another *measObjectNR*, consider any serving cell
associated with the other *measObjectNR* to be a neighbouring cell as
well;

4\> if the *eventX2* is configured in the corresponding *reportConfig*:

5\> consider only the serving L2 U2N Relay UE to be applicable;

4\> if corresponding *reportConfig* includes *reportType* set to
*periodical*; or

4\> for measurement events other than *eventA1,* *eventA2, eventD1* or
*eventX2*:

5\> if *useAllowedCellList* is set to *true*:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
included in the *allowedCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
not included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

....

2\> else if the *reportType* is set to *eventTriggered* and if the
*eventId* is set to *eventD1* and if the entering condition applicable
for this event, i.e. the event corresponding with the *eventId* of the
corresponding *reportConfig* within *VarMeasConfig*, is fulfilled during
*timeToTrigger* defined for this event within the *VarMeasConfig*, while
the *VarMeasReportList* does not include a measurement reporting entry
for this *measId*:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
*eventId* is set to *eventD1* and if the leaving condition applicable
for this event is fulfilled for the associated *VarMeasReport* within
the *VarMeasReportList* for this *measId* during *timeToTrigger* defined
within the *VarMeasConfig* for this event:

3\> if *reportOnLeave* is set to *true* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

3\> stop the periodical reporting timer for this *measId*, if running;

\[TS 38.331, Clause 5.5.4.15\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition D1-1 and condition D1-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition D1-3 or condition D1-4, i.e. at least one of the two, as
specified below, are fulfilled;

Inequality D1-1 (Entering condition 1)

$$Ml1 - Hys > Th\text{res}h1$$

Inequality D1-2 (Entering condition 2)

$$Ml2 + Hys < Th\text{res}h2$$

Inequality D1-3 (Leaving condition 1)

$$Ml1 + Hys < Th\text{res}h1$$

Inequality D1-4 (Leaving condition 2)

$$Ml2 - Hys > Th\text{res}h2$$

The variables in the formula are defined as follows:

***Ml1*** is the distance between UE and a reference location for this
event (i.e. *referenceLocation1* as defined within *reportConfigNR* for
this event), not taking into account any offsets.

***Ml2*** is the distance between UE and a reference location for this
event (i.e. *referenceLocation2* as defined within *reportConfigNR* for
this event), not taking into account any offsets.

***Hys*** is the hysteresis parameter for this event (i.e.
*hysteresisLocation* as defined within *reportConfigNR* for this event).

***Thresh1*** is the threshold for this event defined as a distance,
configured with parameter *distanceThreshFromReference1,* from a
reference location configured with parameter *referenceLocation1* within
*reportConfigNR* for this event.

***Thresh2*** is the threshold for this event defined as a distance,
configured with parameter *distanceThreshFromReference2,* from a
reference location configured with parameter *referenceLocation2* within
*reportConfigNR* for this event.

***Ml1*** is expressed in meters.

***Ml2*** is expressed in the same unit as ***Ml1***.

***Hys*** is expressed in the same unit as ***Ml1.***

***Thresh1*** is expressed in the same unit as ***Ml1***.

***Thresh2*** is expressed in the same unit as ***Ml1***.

NOTE: The definition of Event D1 also applies to CondEvent D1.

##### 8.1.3.1.26.3 Test description {#test-description-59 .H6}

##### 8.1.3.1.26.3.1 Pre-test conditions {#pre-test-conditions-59 .H6}

##### System Simulator: {#system-simulator-39 .H6}

2 NR cells: NR Cell 1 and NR Cell 2 as specified in TS 38.508-1 \[4\]
Table 4.4.2.1.

System information combination NR-29 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-36 .H6}

\- The pre-configured UE location is defined in TS 38.508-1 \[4\] Clause
4.5C.

##### Preamble: {#preamble-38 .H6}

\- The UE is in 5GS 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.3.1.26.3.2 Test procedure sequence {#test-procedure-sequence-60 .H6}

Table 8.1.3.1.26.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1 and NR Cell 2 at various time instants of the test
execution. Row marked \"T0\" denotes the conditions after the preamble
and at the point indicated in the Main behaviour description in Table
8.1.3.1.26.3.2-2.

Table 8.1.3.1.26.3.2-1: Time instances of cell power level and parameter
changes for NR Cell 1 and NR Cell 2 in conducted test environment

+----+------------------+------+-----------+--------+--------+
|    | Parameter        | Unit | NR Cell 1 | NR     | Remark |
|    |                  |      |           |        |        |
|    |                  |      |           | Cell 2 |        |
+====+==================+======+===========+========+========+
| T0 | SS/PBCH SSS EPRE | dBm/ | -79       | -85    |        |
|    |                  |      |           |        |        |
|    |                  | SCS  |           |        |        |
+----+------------------+------+-----------+--------+--------+

Table 8.1.3.1.26.3.2-2: Main behaviour

  St                                                                                       Procedure                                                                                                                                  Message Sequence   TP                                     Verdict   
  ---------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                                      U - S              Message                                          
  1                                                                                        The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup NR measurement and reporting for event D1 (*measId* 1).   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2                                                                                        The UE transmits an *RRCReconfigurationComplete* message.                                                                                  \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3                                                                                        Void                                                                                                                                       \-                 *-*                                    \-        \-
  \-                                                                                       EXCEPTION: In parallel to events described in step 4, the steps specified in table 8.1.3.1.26.3.2-3 shall take place.                      \-                 *-*                                    \-        \-
  4                                                                                        Wait for 30 seconds to ensure that the UE performs a periodical intra-frequency reporting for NR Cell 2.                                   \-                 *-*                                    \-        \-
  5                                                                                        The SS transmits Update UE location information message. (Note1)                                                                           \<-                UPDATE UE LOCATION INFORMATION         \-        \-
  6                                                                                        Wait and ignore MeasurementReport messages for 10s to allow change of UE location and UE measurement.                                      \-                 *-*                                    \-        \-
  7                                                                                        Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                             \--\>              NR RRC: *MeasurementReport*            2         F
  Note 1: UE location information is configured such that the event D1 is not satisfied.                                                                                                                                                                                                                  

Table 8.1.3.1.26.3.2-3: Parallel behaviour

  St   Procedure                                                                                                                                               Message Sequence   TP                    Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------- --------- ----
                                                                                                                                                               U - S              Message                         
  \-   EXCEPTION: After the 1st message is received, step 1 below shall be repeated every time the duration indicated in the IE *reportInterval* has elapsed   \-                 *-*                   \-        \-
  1    Check: Does the UE transmit a *MeasurementReport* message to report event D1 (*measId* 1) with the measured RSRP value for NR Cell 2?                   \--\>              *MeasurementReport*   1         P

##### 8.1.3.1.26.3.3 Specific message contents {#specific-message-contents-51 .H6}

Table 8.1.3.1.26.3.3-1: SIB19 for NR Cell 1 (All steps, Table
8.1.3.1.26.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-18C                                                                                
  ----------------------------------------------------- -------------------------------------------------------------- ------------- ---------------
  **Information Element**                               **Value/remark**                                               **Comment**   **Condition**
  SIB19-r17 ::= SEQUENCE {                                                                                                           
  ntn-Config-r17 SEQUENCE {                                                                                                          
  ephemerisInfo-r17                                     Refer to the First cell in TS 38.508-1 \[4\] Table 6.3.4.1-1                 GSO
  ephemerisInfo-r17                                     Refer to the First cell in TS 38.508-1 \[4\] Table 6.3.4.2-1                 NGSO
  }                                                                                                                                  
  }                                                                                                                                  

Table 8.1.3.1.26.3.3-2: SIB19 for NR Cell 2 (All steps, Table
8.1.3.1.26.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-18C                                                                                 
  ----------------------------------------------------- --------------------------------------------------------------- ------------- ---------------
  **Information Element**                               **Value/remark**                                                **Comment**   **Condition**
  SIB19-r17 ::= SEQUENCE {                                                                                                            
  ntn-Config-r17 SEQUENCE {                                                                                                           
  ephemerisInfo-r17                                     Refer to the Second cell in TS 38.508-1 \[4\] Table 6.3.4.1-1                 GSO
  ephemerisInfo-r17                                     Refer to the Second cell in TS 38.508-1 \[4\] Table 6.3.4.2-1                 NGSO
  }                                                                                                                                   
  }                                                                                                                                   

Table 8.1.3.1.26.3.3-3: *RRCReconfiguration* (step 1, 8.1.3.1.26.3.2-2)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.26.3.3-4: *MeasConfig* (Table 8.1.3.1.26.3.3-3)

  ------------------------------------------------------------------------------------------ ------------------------------------ ------------------------------------------------------------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                                                                                             
  Information Element                                                                        Value/remark                         Comment                                                                                                       Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                                                                                                     
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                                                                                                            
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                              entry 1                                                                                                       
  measObjectId                                                                               1                                    MeasObjectIdNR-f1                                                                                             
  measObject CHOICE {                                                                                                                                                                                                                           
  measObjectNR SEQUENCE {                                                                                                                                                                                                                       
  ssbFrequency                                                                               ARFCN-ValueNR for SSB of NR Cell 1   The SSB of NR cell 1 and NR cell 2 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                                                            Not present                                                                                                                                        
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                                                                                            
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                            entry 1                                                                                                       
  reportConfigId                                                                             1                                                                                                                                                  
  reportConfig CHOICE {                                                                                                                                                                                                                         
  reportConfigNR                                                                             ReportConfigNR- eventD1-r17          Table 8.1.3.1.26.3.3-5                                                                                        
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                                                                                            
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                  entry 1                                                                                                       
  measId                                                                                     1                                                                                                                                                  
  measObjectId                                                                               1                                                                                                                                                  
  reportConfigId                                                                             1                                                                                                                                                  
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  ------------------------------------------------------------------------------------------ ------------------------------------ ------------------------------------------------------------------------------------------------------------- -----------

Table 8.1.3.1.26.3.3-5: *ReportConfigNR-EventD1-r17* (Table
8.1.3.1.26.3.3-4)

+----------------+----------------+----------------+---------------+
| Derivation     |                |                |               |
| Path: TS       |                |                |               |
| 38.508-1 \[4\] |                |                |               |
| Table          |                |                |               |
| 4.6.3-142      |                |                |               |
+----------------+----------------+----------------+---------------+
| **Information  | **             | **Comment**    | **Condition** |
| Element**      | Value/remark** |                |               |
+----------------+----------------+----------------+---------------+
| ReportConfigNR |                |                |               |
| ::= SEQUENCE { |                |                |               |
+----------------+----------------+----------------+---------------+
| reportType     |                |                |               |
| CHOICE {       |                |                |               |
+----------------+----------------+----------------+---------------+
| eventTriggered |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| eventId CHOICE |                |                |               |
| {              |                |                |               |
+----------------+----------------+----------------+---------------+
| eventD1-r17    |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| dist           | 2000           | threshold 1:   |               |
| anceThreshFrom |                |                |               |
| Reference1-r17 |                | 100 km         |               |
+----------------+----------------+----------------+---------------+
| dist           | 2400           | threshold 2:   |               |
| anceThreshFrom |                |                |               |
| Reference2-r17 |                | 120 km         |               |
+----------------+----------------+----------------+---------------+
| referenc       | \'2240 DC56    | reference      |               |
| eLocation1-r17 | 7176\'H        | location 1:    |               |
|                |                |                |               |
|                |                | \- Latitude:   |               |
|                |                | 24.08439333    |               |
|                |                |                |               |
|                |                | \- Longitude:  |               |
|                |                | 121.56076999   |               |
+----------------+----------------+----------------+---------------+
| referenc       | \'2519 0956    | reference      |               |
| eLocation2-r17 | 7176\'H        | location 2:    |               |
|                |                |                |               |
|                |                | \- Latitude:   |               |
|                |                | 26.08439333    |               |
|                |                |                |               |
|                |                | \- Longitude:  |               |
|                |                | 121.56076999   |               |
+----------------+----------------+----------------+---------------+
| rep            | true           |                |               |
| ortOnLeave-r17 |                |                |               |
+----------------+----------------+----------------+---------------+
| hysteres       | 0              |                |               |
| isLocation-r17 |                |                |               |
+----------------+----------------+----------------+---------------+
| tim            | ms2560         |                |               |
| eToTrigger-r17 |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| reportInterval | ms2048         |                |               |
+----------------+----------------+----------------+---------------+
| reportAmount   | infinity       |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+

Table 8.1.3.1.26.3.3-6: *MeasurementReport* (step 1, Table
8.1.3.1.26.3.2-3)

  ---------------------------------------------------------------------------------------- ------------------------------------------- -------------------------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                               
  Information Element                                                                      Value/remark                                Comment                    Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                
  criticalExtensions CHOICE {                                                                                                                                     
  measurementReport SEQUENCE {                                                                                                                                    
  measResults SEQUENCE {                                                                                                                                          
  measId                                                                                   1                                                                      
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                     Report NR Cell 1           
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1                    
  servCellId                                                                               ServCellIndex of NR Cell 1                                             
  measResultServingCell SEQUENCE {                                                                                                                                
  physCellId                                                                               Physical layer cell identity of NR Cell 1                              
  measResult SEQUENCE {                                                                                                                                           
  cellResults SEQUENCE {                                                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                                                      
  rsrp                                                                                     (0..127)                                                               
  rsrq                                                                                     (0..127)                                                               
  sinr                                                                                     Not present                                                            
                                                                                           Not checked                                                            pc\_ss\_SINR\_Meas
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  measResultNeighCells CHOICE {                                                                                                                                   
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                     Report NR neighbour cell   
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1                    
  physCellId                                                                               Physical layer cell identity of NR Cell 2                              
  measResult SEQUENCE {                                                                                                                                           
  cellResults SEQUENCE {                                                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                                                      
  rsrp                                                                                     (0..127)                                                               
  rsrq                                                                                     Not present                                                            
  sinr                                                                                     Not present                                                            
  }                                                                                                                                                               
  resultsCSI-RS-Cell                                                                       Not present                                                            
  }                                                                                                                                                               
  rsIndexResults                                                                           Not present                                                            
  }                                                                                                                                                               
  cgi-Info                                                                                 Not present                                                            
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  ---------------------------------------------------------------------------------------- ------------------------------------------- -------------------------- --------------------

Table 8.1.3.1.26.3.3-7: UPDATE UE LOCATION INFORMATION (Step 5, Table
8.1.3.1.26.3.2-2)

+----------------+----------------+----------------+---------------+
| Derivation     |                |                |               |
| Path: TS       |                |                |               |
| 36.509 \[8\]   |                |                |               |
| Table 6.12     |                |                |               |
+----------------+----------------+----------------+---------------+
| **Information  | **             | **Comment**    | **Condition** |
| Element**      | Value/remark** |                |               |
+----------------+----------------+----------------+---------------+
| ellipsoidPoi   | \'2240 DC56    | UE Location:   |               |
| ntWithAltitude | 7176 0000\'H   |                |               |
|                |                | \- Latitude:   |               |
|                |                | 24.08439333    |               |
|                |                |                |               |
|                |                | \- Longitude:  |               |
|                |                | 121.56076999   |               |
|                |                |                |               |
|                |                | \- Altitude: 0 |               |
+----------------+----------------+----------------+---------------+
| hori           | \'00 0000\'H   | Speed:         |               |
| zontalVelocity |                |                |               |
|                |                | 0 km/s         |               |
+----------------+----------------+----------------+---------------+
| gnss-TOD-msec  | \'00 0000\'H   |                |               |
+----------------+----------------+----------------+---------------+

##### 8.1.3.1.27 NR NTN Enhancements / Measurement configuration control and reporting / Event D2

##### 8.1.3.1.27 Test Purpose (TP) {#test-purpose-tp-60 .H6}

##### (1) {#section-106 .H6}

**with** { UE in NR RRC\_CONNECTED and measurement configured for event
D2 **with event based periodical reporting** }

**ensure that** {

**when** { Entering condition for event D2 is satisfied }

**then** { UE sends MeasurementReport message at regular intervals while
entering condition for event D2 is satisfied }

}

##### (2) {#section-107 .H6}

**with** { UE in NR RRC\_CONNECTED and measurement configured for event
D2 **with event based periodical reporting** }

**ensure** that {

**when** { Leaving condition for event D2 is satisfied }

**then** { **UE stops sending MeasurementReport message** }

}

##### 8.1.3.1.27.2 Conformance requirements {#conformance-requirements-60 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.5.5.1, 5.5.4.15a, and clause 5.5.4.1.
Unless otherwise stated these are Rel-18 requirements.

\[TS 38.331, clause 5.5.5.1\]

**Figure 5.5.5.1-1: Measurement reporting**

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

The UE shall, for each entry in the *VarMeasReportList*:

> \...
>
> 1\> if there is at least one applicable neighbouring cell or candidate
> L2 U2N Relay UE to report:
>
> 2\> if the *reportType* is set to *eventTriggered* or *periodical*:
>
> 3\> if the measurement report concerns the candidate L2 U2N Relay UE:
>
> \...
>
> 3\> else:
>
> 4\> set the *measResultNeighCells* to include the best neighbouring
> cells up to *maxReportCells* in accordance with the following:
>
> 5\> if the *reportType* is set to *eventTriggered* and *eventId* is
> not set to *eventD1* or *eventD2* or *eventH1* or *eventH2*:
>
> 6\> include the cells included in the *cellsTriggeredList* as defined
> within the *VarMeasReportList* for this *measId*;

\...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

> 1\> for each *measId* included in the *measIdList* within
> *VarMeasConfig*:
>
> 2\> if the corresponding *reportConfig* includes a *reportType* set to
> *eventTriggered* or *periodical*:
>
> \...
>
> 2\> else if the *reportType* is set to *eventTriggered* and if the
> *eventId* is set to *eventD1* or *eventD2* or *eventH1* or *eventH2*
> and if the entering condition applicable for this event, i.e. the
> event corresponding with the *eventId* of the corresponding
> *reportConfig* within *VarMeasConfig*, is fulfilled during
> *timeToTrigger* defined for this event within the *VarMeasConfig*,
> while the *VarMeasReportList* does not include a measurement reporting
> entry for this *measId*:
>
> 3\> include a measurement reporting entry within the
> *VarMeasReportList* for this *measId*;
>
> 3\> set the *numberOfReportsSent* defined within the
> *VarMeasReportList* for this *measId* to 0;
>
> 3\> initiate the measurement reporting procedure, as specified in
> 5.5.5;
>
> 2\> else if the *reportType* is set to *eventTriggered* and if the
> *eventId* is set to *eventD1* or *eventD2* or *eventH1* or *eventH2*
> and if the leaving condition applicable for this event is fulfilled
> for the associated *VarMeasReport* within the *VarMeasReportList* for
> this *measId* during *timeToTrigger* defined within the
> *VarMeasConfig* for this event:
>
> 3\> if *reportOnLeave* is set to *true* for the corresponding
> reporting configuration:
>
> 4\> initiate the measurement reporting procedure, as specified in
> 5.5.5;
>
> 3\> remove the measurement reporting entry within the
> *VarMeasReportList* for this *measId*;
>
> 3\> stop the periodical reporting timer for this *measId*, if running;

\...

\[TS 38.331, Clause 5.5.4.15a\]

The UE shall:

> 1\> consider the entering condition for this event to be satisfied
> when both condition D2-1 and condition D2-2, as specified below, are
> fulfilled;
>
> 1\> consider the leaving condition for this event to be satisfied when
> condition D2-3 or condition D2-4, i.e. at least one of the two, as
> specified below, are fulfilled;

Inequality D2-1 (Entering condition 1)

$$Ml1\ –\ Hys\  > \ Thresh1$$

Inequality D2-2 (Entering condition 2)

$$Ml2\  + \ Hys\  < \ Thresh2$$

Inequality D2-3 (Leaving condition 1)

$$\text{Ml}1 + \text{Hys} < \text{Thresh}1$$

Inequality D2-4 (Leaving condition 2)

$$Ml2\ –\ Hys\  > \ Thresh2$$

The variables in the formula are defined as follows:

> ***Ml1*** is the distance between UE and a moving reference location
> for this event, not taking into account any offsets. The moving
> reference location is determined based on *movingReferenceLocation*
> and the corresponding epoch time and satellite ephemeris for the
> serving cell broadcast in *SIB19*.
>
> ***Ml2*** is the distance between UE and a moving reference location
> for this event, not taking into account any offsets. The moving
> reference location is determined based on the parameter
> *referenceLocation* and the corresponding epoch time and satellite
> ephemeris configured within the *MeasObjectNR* associated to this
> event.
>
> ***Hys*** is the hysteresis parameter for this event (i.e.
> *hysteresisLocation* as defined within *reportConfigNR* for this
> event).
>
> ***Thresh1*** is the threshold for this event defined as a distance,
> configured with parameter *distanceThreshFromReference1* in
> *reportConfigNR* for this event*,* from a moving reference location
> determined based on the parameter *movingReferenceLocation* and the
> corresponding epoch time and satellite ephemeris for the serving cell
> broadcast in *SIB19*.
>
> ***Thresh2*** is the threshold for this event defined as a distance,
> configured with parameter *distanceThreshFromReference2* in
> *reportConfigNR* for this event*,* from a moving reference location
> determined based on the parameter *referenceLocation* and the
> corresponding epoch time and satellite ephemeris configured within the
> *MeasObjectNR* associated to this event.
>
> ***Ml1*** is expressed in meters.
>
> ***Ml2*** is expressed in the same unit as ***Ml1***.
>
> ***Hys*** is expressed in the same unit as ***Ml1.***
>
> ***Thresh1*** is expressed in the same unit as ***Ml1***.
>
> ***Thresh2*** is expressed in the same unit as ***Ml1***.
>
> \[\]NOTE: The definition of Event D2 also applies to CondEvent D2.

\[38.331 Clause 5.4.4.1\]

If AS security has been activated successfully, the UE shall:

> 1\> for each *measId* included in the *measIdList* within
> *VarMeasConfig*:
>
> 2\> if the corresponding *reportConfig* includes a *reportType* set to
> *eventTriggered* or *periodical*:
>
> 3\> if the corresponding *measObject* concerns NR:
>
> \....
>
> 4\> if corresponding *reportConfig* includes *reportType* set to
> *periodical*; or
>
> 4\> for measurement events other than *eventA1,* *eventA2, eventD1,
> eventD2, eventX2, eventH1* or *eventH2*:
>
> 5\> if *useAllowedCellList* is set to *true*:
>
> 6\> consider any neighbouring cell detected based on parameters in the
> associated *measObjectNR* to be applicable when the concerned cell is
> included in the *allowedCellsToAddModList* defined within the
> *VarMeasConfig* for this *measId*;
>
> 5\> else:
>
> 6\> consider any neighbouring cell detected based on parameters in the
> associated *measObjectNR* to be applicable when the concerned cell is
> not included in the *excludedCellsToAddModList* defined within the
> *VarMeasConfig* for this *measId*;
>
> \...
>
> 2\> else if the *reportType* is set to *eventTriggered* and if the
> *eventId* is set to *eventD1* or *eventD2* or *eventH1* or *eventH2*
> and if the entering condition applicable for this event, i.e. the
> event corresponding with the *eventId* of the corresponding
> *reportConfig* within *VarMeasConfig*, is fulfilled during
> *timeToTrigger* defined for this event within the *VarMeasConfig*,
> while the *VarMeasReportList* does not include a measurement reporting
> entry for this *measId*:
>
> 3\> include a measurement reporting entry within the
> *VarMeasReportList* for this *measId*;
>
> 3\> set the *numberOfReportsSent* defined within the
> *VarMeasReportList* for this *measId* to 0;
>
> 3\> initiate the measurement reporting procedure, as specified in
> 5.5.5;
>
> 2\> else if the *reportType* is set to *eventTriggered* and if the
> *eventId* is set to *eventD1* or *eventD2* or *eventH1* or *eventH2*
> and if the leaving condition applicable for this event is fulfilled
> for the associated *VarMeasReport* within the *VarMeasReportList* for
> this *measId* during *timeToTrigger* defined within the
> *VarMeasConfig* for this event:
>
> 3\> if *reportOnLeave* is set to *true* for the corresponding
> reporting configuration:
>
> 4\> initiate the measurement reporting procedure, as specified in
> 5.5.5;
>
> 3\> remove the measurement reporting entry within the
> *VarMeasReportList* for this *measId*;
>
> 3\> stop the periodical reporting timer for this *measId*, if running;
>
> NOTE 1: Void.

##### 8.1.3.1.27.3 Test description {#test-description-60 .H6}

##### 8.1.3.1.27.3.1 Pre-test conditions {#pre-test-conditions-60 .H6}

System Simulator:

> NR Cell 1 is serving cell and NR Cell 2 is suitable inter-frequency
> cell \[SIB19 of NR Cell 1 and NR Cell 2 are FFS\]
>
> System information combination NR-29 as defined in TS 38.508-1 \[4\]
> clause 4.4.3.1.2 is used in NR cells.

UE:

> \- The pre-configured UE location is defined in TS 38.508-1 \[4\]
> Clause 4.5C.

Preamble:

> \- The UE is in 5GS 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
> clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.3.1.27.3.2 Test procedure sequence {#test-procedure-sequence-61 .H6}

Table 8.1.3.1.27.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1 and NR Cell 2 at various time instants of the test
execution. Row marked \"T0\" denotes the conditions after the preamble
and at the point indicated in the Main behaviour description in Table
8.1.3.1.27.3.2-2.

Table 8.1.3.1.27.3.2-1: Time instances of cell power level and parameter
changes for NR Cell 1 and NR Cell 2 in conducted test environment

+----+------------------+------+-----------+--------+--------+
|    | Parameter        | Unit | NR Cell 1 | NR     | Remark |
|    |                  |      |           |        |        |
|    |                  |      |           | Cell 2 |        |
+====+==================+======+===========+========+========+
| T0 | SS/PBCH SSS EPRE | dBm/ | -79       | -85    |        |
|    |                  |      |           |        |        |
|    |                  | SCS  |           |        |        |
+----+------------------+------+-----------+--------+--------+

Table 8.1.3.1.27.3.2-2: Main behaviour

  St                                                                                       Procedure                                                                                                                            Message Sequence   TP                                     Verdict   
  ---------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                                U - S              Message                                          
  1                                                                                        The SS transmits an RRCReconfiguration message including MeasConfig to setup NR measurement and reporting for event D2 (measId 1).   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2                                                                                        The UE transmits an RRCReconfigurationComplete message.                                                                              \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  \-                                                                                       EXCEPTION: In parallel to events described in step 3, the steps specified in table 8.1.3.1.26.3.2-3 shall take place.                \-                 *-*                                    \-        \-
  3                                                                                        Wait for 30 seconds to ensure that the UE performs a periodical intra-frequency reporting for NR Cell 2.                             \-                 *-*                                    \-        \-
  4                                                                                        The SS transmits Update UE location information message. (Note1)                                                                     \<\--              UPDATE UE LOCATION INFORMATION         \-        \-
  5                                                                                        Wait and ignore MeasurementReport messages for 10s to allow change of UE location and UE measurement.                                \-                 *-*                                    \-        \-
  6                                                                                        Check: Does the UE transmit a MeasurementReport message within the next 10s?                                                         \--\>              NR RRC: *MeasurementReport*            2         F
  Note 1: UE location information is configured such that the event D2 is not satisfied.                                                                                                                                                                                                            

Table 8.1.3.1.27.3.2-3: Parallel behaviour

  St   Procedure                                                                                                                                               Message Sequence   TP                    Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------- --------- ----
                                                                                                                                                               U - S              Message                         
  \-   EXCEPTION: After the 1st message is received, step 1 below shall be repeated every time the duration indicated in the IE *reportInterval* has elapsed   \-                 *-*                   \-        \-
  1    Check: Does the UE transmit a *MeasurementReport* message to report event D2 (*measId* 1) with the measured RSRP value for NR Cell 2?                   \--\>              *MeasurementReport*   1         P

##### 8.1.3.1.27.3.3 Specific message contents {#specific-message-contents-52 .H6}

Table 8.1.3.1.27.3.3-1: SIB19 for NR Cell 1 (All steps, Table
8.1.3.1.27.3.2-2)

  ----------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-18C                            
  Information Element                                   Value/remark   Comment   Condition
  SIB19-r17 ::= SEQUENCE {                                                       
  distanceThresh-r17                                    FFS                      
  movingReferenceLocation-r18                           FFS                      
  }                                                                              
  ----------------------------------------------------- -------------- --------- -----------

Table 8.1.3.1.27.3.3-2: SIB19 for NR Cell 2 (All steps, Table
8.1.3.1.27.3.2-2)

  ----------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-18C                            
  Information Element                                   Value/remark   Comment   Condition
  SIB19-r17 ::= SEQUENCE {                                                       
  referenceLocation-r17                                 Not present              
  distanceThresh-r17                                    FFS                      
  movingReferenceLocation-r18                           FFS                      
  }                                                                              
  ----------------------------------------------------- -------------- --------- -----------

Table 8.1.3.1.27.3.3-3: *RRCReconfiguration* (step 1, 8.1.3.1.27.3.2-2)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.1.27.3.3-4: *MeasConfig* (Table 8.1.3.1.27.3.3-3)

  ------------------------------------------------------------------------------------------ ------------------------------------ ------------------------------------------------------------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                                                                                             
  Information Element                                                                        Value/remark                         Comment                                                                                                       Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                                                                                                     
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                                                                                                            
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                              entry 1                                                                                                       
  measObjectId                                                                               1                                    MeasObjectIdNR-f1                                                                                             
  measObject CHOICE {                                                                                                                                                                                                                           
  measObjectNR SEQUENCE {                                                                                                                                                                                                                       
  ssbFrequency                                                                               ARFCN-ValueNR for SSB of NR Cell 1   The SSB of NR cell 1 and NR cell 2 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                                                            Not present                                                                                                                                        
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                                                                                            
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                            entry 1                                                                                                       
  reportConfigId                                                                             1                                                                                                                                                  
  reportConfig CHOICE {                                                                                                                                                                                                                         
  reportConfigNR                                                                             ReportConfigNR- eventD2-r18          Table 8.1.3.1.27.3.3-5                                                                                        
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                                                                                            
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                  entry 1                                                                                                       
  measId                                                                                     1                                                                                                                                                  
  measObjectId                                                                               1                                                                                                                                                  
  reportConfigId                                                                             1                                                                                                                                                  
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                                             
  ------------------------------------------------------------------------------------------ ------------------------------------ ------------------------------------------------------------------------------------------------------------- -----------

Table 8.1.3.1.27.3.3-5: *ReportConfigNR-EventD2-r18* (Table
8.1.3.1.27.3.3-4)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142                            
  Information Element                                  Value/remark   Comment   Condition
  ReportConfigNR ::= SEQUENCE {                                                 
  reportType CHOICE {                                                           
  eventTriggered SEQUENCE {                                                     
  eventId CHOICE {                                                              
  eventD2-r18 SEQUENCE {                                                        
  distanceThreshFromReference1-r18                     FFS                      
  distanceThreshFromReference2-r18                     FFS                      
  reportOnLeave-r18                                    false                    
  hysteresisLocation-r18                               0                        
  timeToTrigger-r18                                    ms2560                   
  }                                                                             
  }                                                                             
  reportInterval                                       ms2048                   
  reportAmount                                         infinity                 
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.3.1.27.3.3-6: UPDATE UE LOCATION INFORMATION (Step 5, Table
8.1.3.1.26.3.2-2)

  --------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 36.509 \[8\] Table 6.12                            
  Information Element                           Value/remark   Comment   Condition
  ellipsoidPointWithAltitude                    FFS                      
  horizontalVelocity                            FFS                      
  gnss-TOD-msec                                 FFS                      
  --------------------------------------------- -------------- --------- -----------

Table 8.1.3.1.27.3.3-7: *MeasurementReport* (step 1, Table
8.1.3.1.27.3.2-3)

  ---------------------------------------------------------------------------------------- ------------------------------------------- -------------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                               
  **Information Element**                                                                  **Value/remark**                            **Comment**                **Condition**
  MeasurementReport ::= SEQUENCE {                                                                                                                                
  criticalExtensions CHOICE {                                                                                                                                     
  measurementReport SEQUENCE {                                                                                                                                    
  measResults SEQUENCE {                                                                                                                                          
  measId                                                                                   1                                                                      
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                     Report NR Cell 1           
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1                    
  servCellId                                                                               ServCellIndex of NR Cell 1                                             
  measResultServingCell SEQUENCE {                                                                                                                                
  physCellId                                                                               Physical layer cell identity of NR Cell 1                              
  measResult SEQUENCE {                                                                                                                                           
  cellResults SEQUENCE {                                                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                                                      
  rsrp                                                                                     (0..127)                                                               
  rsrq                                                                                     (0..127)                                                               
  sinr                                                                                     Not present                                                            
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  measResultNeighCells CHOICE {                                                                                                                                   
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                     Report NR neighbour cell   
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1                    
  physCellId                                                                               Physical layer cell identity of NR Cell 2                              
  measResult SEQUENCE {                                                                                                                                           
  cellResults SEQUENCE {                                                                                                                                          
  resultsSSB-Cell SEQUENCE {                                                                                                                                      
  rsrp                                                                                     (0..127)                                                               
  rsrq                                                                                     Not present                                                            
  sinr                                                                                     Not present                                                            
  }                                                                                                                                                               
  resultsCSI-RS-Cell                                                                       Not present                                                            
  }                                                                                                                                                               
  rsIndexResults                                                                           Not present                                                            
  }                                                                                                                                                               
  cgi-Info                                                                                 Not present                                                            
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  }                                                                                                                                                               
  ---------------------------------------------------------------------------------------- ------------------------------------------- -------------------------- ---------------

#### 8.1.3.2 Inter-RAT measurements

##### 8.1.3.2.1 Measurement configuration control and reporting / Inter-RAT measurements / Event B1 / Measurement of E-UTRA cells

##### 8.1.3.2.1.1 Test Purpose (TP) {#test-purpose-tp-61 .H6}

##### (1) {#section-108 .H6}

**with { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B1 to measure neighbour E-UTRA cell is configured }**

**ensure that {**

**when { Entering condition for the event B1 is not met }**

**then { UE does not transmit any MeasurementReport }**

**}**

##### (2) {#section-109 .H6}

**with { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B1 to measure neighbour E-UTRA cell is configured }**

**ensure that {**

**when { Entering condition for the event B1 is met }**

**then { UE transmits a MeasurementReport }**

**}**

##### 8.1.3.2.1.2 Conformance requirements {#conformance-requirements-61 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2, 5.5.4.1, 5.5.4.8 and
5.5.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(MCG is E-UTRA):

2\> if *RRCReconfiguration* was received via SRB1:

3\> submit the *RRCReconfigurationComplete* via the EUTRA MCG embedded
in E-UTRA RRC message *RRCConnectionReconfigurationComplete* as
specified in TS 36.331 \[10\];

3\> if reconfigurationWithSync was included in spCellConfig of an SCG:

4\> initiate the random access procedure on the SpCell, as specified in
TS 38.321 \[3\];

3\> else:

4\> the procedure ends;

NOTE: The order the UE sends the *RRCConnectionReconfigurationComplete*
message and performs the Random Access procedure towards the SCG is left
to UE implementation.

2\> else (*RRCReconfiguration* was received via SRB3):

3\> submit the *RRCReconfigurationComplete* message via SRB3 to lower
layers for transmission using the new configuration;

NOTE: For EN-DC, in the case *RRCReconfiguration* is received via SRB1,
the random access is triggered by RRC layer itself as there is not
necessarily other UL transmission. In the case *RRCReconfiguration* is
received via SRB3, the random access is triggered by the MAC layer due
to arrival of *RRCReconfigurationComplete*.

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

2\> if this is the first *RRCReconfiguration* message after successful
completion of the RRC re-establishment procedure;

3\> resume SRB1 and DRBs that are suspended;

> ...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

...

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> else if *gapUE* is set to release:

2\> release the per UE measurement gap configuration.

NOTE 1: For gapFR2 configuration, the SFN and subframe of a serving cell
on FR2 frequency is used in the gap calculation

NOTE 2: For *gapFR1* or *gapUE* configuration, the SFN and subframe of
the PCell is used in the gap calculation.

\[TS 38.331, clause 5.5.4.1\]

If security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig*includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

> ...

4\> for measurement events other than *eventA1* or *eventA2*:

5\> if *useAllowedCellList* is set to TRUE:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR*to be applicable when the concerned cell is
included in the *allowedCellsToAddModList* defined within the
*VarMeasConfig* for this measId;

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR*to be applicable when the concerned cell is not
included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this measId;

3\> else if the corresponding *measObject* concerns E-UTRA;

4\> consider any neighbouring cell detected on the associated frequency
to be applicable when the concerned cell is not included in the
*excludedCellsToAddModListEUTRAN* defined within the *VarMeasConfig* for
this *measId*;

> ...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *TRUE* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

> ...

2\> upon the expiry of T321 for this *measId*:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

\[TS 38.331, clause 5.5.4.8\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition B1-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition B1-2, as specified below, is fulfilled;

Inequality B1-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Thresh*

Inequality B1-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Thresh*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the inter-RAT neighbour cell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the frequency of
the inter-RAT neighbour cell (i.e. *eutra-Q-OffsetRange* as defined
within the *measObjectEUTRA* corresponding to the frequency of the
neighbour inter-RAT cell).

***Ocn*** is the cell specific offset of the inter-RAT neighbour cell
(i.e. *cellIndividualOffset* as defined within the *measObjectEUTRA*
corresponding to the neighbour inter-RAT cell), and set to zero if not
configured for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigInterRAT* for this event).

***Thresh*** is the threshold parameter for this event (i.e.
*b1-ThresholdEUTRA* as defined within *reportConfigInterRAT* for this
event).

***Mn*** is expressed in dBm or in dB, depending on the measurement
quantity of the inter-RAT neighbour cell.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5\]

Figure 5.5.5-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with servingCellMO,
RSRP, RSRQ and the available SINR, derived based on the *rsType* if
indicated in the associated *reportConfig*, otherwise based on SSB if
available, otherwise based on CSI-RS;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include for each NR serving cell that is configured with
*servingCellMO*, if any, the *servCellId*;

1\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *reportQuantityRsIndexes* and
*maxNrofRSIndexesToReport*:

2\> for each serving cell configured with *servingCellMO*, include beam
measurement information according to the associated *reportConfig* as
described in 5.5.5.2;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the reportType is set to eventTriggered:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

> ...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the reportType is set to eventTriggered or periodical:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first:

9\> if *reportQuantityRsIndexes*and *maxNrofRSIndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

...

6\> if the *measObject* associated with this *measId* concerns E-UTRA:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantity* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

> ...

1\> if the UE is configured with EN-DC:

2\> if SRB3 is configured:

3\> submit the *MeasurementReport* message via SRB3 to lower layers for
transmission, upon which the procedure ends;

2\> else:

3\> submit the *MeasurementReport* message via the EUTRA MCG embedded in
E-UTRA RRC message *ULInformationTransferMRDC* as specified in TS 36.331
\[10\].

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.2.1.3 Test description {#test-description-61 .H6}

##### 8.1.3.2.1.3.1 Pre-test conditions {#pre-test-conditions-61 .H6}

##### System Simulator: {#system-simulator-40 .H6}

\- NR Cell 1 is the PCell, E-UTRA Cell 1 is the inter-RAT neighbour cell
of NR Cell 1.

\- NR Cell 1 is configured to operate in FR1 bands as defined in TS
38.508-1 \[4\] clause 6.2.3.

\- System information combination NR-6 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-37 .H6}

\- None.

##### Preamble: {#preamble-39 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.3.2.1.3.2 Test procedure sequence {#test-procedure-sequence-62 .H6}

Table 8.1.3.2.1.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1, and E-UTRA Cell 1 at various time instants of the
test execution. Row marked \"T0\" denotes the conditions after the
preamble, while the configuration marked \"T1\" is applied at the point
indicated in the Main behaviour description in Table 8.1.3.2.1.3.2-3.

Table 8.1.3.2.1.3.2-1: Time instances of cell power level and parameter
changes for conducted test environment

+----+------------+-----------+-----------+--------+------------+
|    | Parameter  | Unit      | NR Cell 1 | E-UTRA | Remark     |
|    |            |           |           |        |            |
|    |            |           |           | Cell 1 |            |
+====+============+===========+===========+========+============+
| T0 | SS/PBCH    | dBm/      | -85       | \-     | Power      |
|    |            |           |           |        | levels are |
|    | SSS EPRE   | SCS       |           |        | such that  |
|    |            |           |           |        | entry      |
|    |            |           |           |        | condition  |
|    |            |           |           |        | for event  |
|    |            |           |           |        | B1 is not  |
|    |            |           |           |        | satisfied: |
|    |            |           |           |        |            |
|    |            |           |           |        | *Mn + Ofn  |
|    |            |           |           |        | + Ocn +    |
|    |            |           |           |        | Hys \<     |
|    |            |           |           |        | Thresh*    |
+----+------------+-----------+-----------+--------+------------+
|    | Cel        | dBm/15kHz |           | -93    |            |
|    | l-specific |           |           |        |            |
|    | RS EPRE    |           |           |        |            |
+----+------------+-----------+-----------+--------+------------+
| T1 | SS/PBCH    | dBm/      | -85       | \-     | Power      |
|    |            |           |           |        | levels are |
|    | SSS EPRE   | SCS       |           |        | such that  |
|    |            |           |           |        | entry      |
|    |            |           |           |        | condition  |
|    |            |           |           |        | for event  |
|    |            |           |           |        | B1 is      |
|    |            |           |           |        | satisfied: |
|    |            |           |           |        |            |
|    |            |           |           |        | *Mn + Ofn  |
|    |            |           |           |        | + Ocn --   |
|    |            |           |           |        | Hys \>     |
|    |            |           |           |        | Thresh*    |
+----+------------+-----------+-----------+--------+------------+
|    | Cel        | dBm/15kHz |           | -73    |            |
|    | l-specific |           |           |        |            |
|    | RS EPRE    |           |           |        |            |
+----+------------+-----------+-----------+--------+------------+

Table 8.1.3.2.1.3.2-2: Void

Table 8.1.3.2.1.3.2-3: Main behaviour

  St   Procedure                                                                                                                            Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                            U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup inter-RAT measurement and reporting for event B1.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                            \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                       \--\>              *NR RRC: MeasurementReport*            2         F
  4    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.2.1.3.2-1.                             \-                 *-*                                    \-        \-
  5    Check: Does the UE transmit a *MeasurementReport* message to report event B1 with the measured RSRP value for NR Cell 1?             \--\>              *NR RRC: MeasurementReport*            1         P

##### 8.1.3.2.1.3.3 Specific message contents {#specific-message-contents-53 .H6}

Table 8.1.3.2.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.2.1.3.2-3)

  --------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13with condition NR\_MEAS
  --------------------------------------------------------------------------

Table 8.1.3.2.1.3.3-2: *MeasConfig* (Table 8.1.3.2.1.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                   
  ------------------------------------------------------------------------------------------ ------------------------------------------------ ----------------------- -----------
  Information Element                                                                        Value/remark                                     Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                           
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                 
  measObjectId                                                                               1                                                MeasObjectIdNR-f1       
  measObject CHOICE {                                                                                                                                                 
  measObjectNR SEQUENCE {                                                                                                                                             
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                           
  absThreshSS-BlocksConsolidation                                                            Not present                                                              
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2                 
  measObjectId                                                                               2                                                MeasObjectIdE-UTRA-f1   
  measObject CHOICE {                                                                                                                                                 
  measObjectEUTRA SEQUENCE {                                                                                                                                          
  carrierFreq                                                                                ARFCN-ValueEUTRA for E-UTRA Cell 1                                       
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                  
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                 
  reportConfigId                                                                             1                                                                        
  reportConfig CHOICE {                                                                                                                                               
  reportConfigInterRAT                                                                       ReportConfigInterRAT-EventB1                     Table 8.1.3.2.1.3.3-3   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                  
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                 
  measId                                                                                     1                                                                        
  measObjectId                                                                               2                                                                        
  reportConfigId                                                                             1                                                                        
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  quantityConfig                                                                             QuantityConfig with condition INTER-RAT                                  
  measGapConfig                                                                              MeasGapConfig                                                            
  }                                                                                                                                                                   

Table 8.1.3.2.1.3.3-3: *ReportConfigInterRAT-EventB1* (Table
8.1.3.2.1.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-141 with condition EVENT\_B1                            
  ----------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                           Value/remark   Comment   Condition
  ReportConfigNR ::= SEQUENCE {                                                                          
  reportType CHOICE {                                                                                    
  eventTriggered SEQUENCE {                                                                              
  eventId CHOICE {                                                                                       
  eventB1 SEQUENCE {                                                                                     
  b1-ThresholdEUTRA SEQUENCE {                                                                           
  rsrp                                                                          61             -80dBm    FR1
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  reportAmount                                                                  r1                       
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      

Table 8.1.3.2.1.3.3-4: *MeasurementReport* (step 5, Table
8.1.3.2.1.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                                       
  ---------------------------------------------------------------------------------------- ----------------------------------------------- ------------------------------ --------------------
  Information Element                                                                      Value/remark                                    Comment                        Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                             
  measurementReport SEQUENCE {                                                                                                                                            
  measResults SEQUENCE {                                                                                                                                                  
  measId                                                                                   1                                                                              Step 5
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                         Report NR Cell 1               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                         entry 1                        
  servCellId                                                                               ServCellIndex of NR Cell 1                                                     
  measResultServingCell SEQUENCE {                                                                                                                                        
  physCellId                                                                               Physical layer cell identity of NR Cell 1                                      
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                     (0..127)                                                                       
  rsrq                                                                                     (0..127)                                                                       
  sinr                                                                                     Not present                                                                    
                                                                                           Not checked                                                                    pc\_ss\_SINR\_Meas
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  measResultNeighCells CHOICE {                                                                                                                                           
  measResultListEUTRA SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultEUTRA {             1 entry                                         Report E-UTRA neighbour cell   
  MeasResultEUTRA\[1\] SEQUENCE {                                                                                                          entry 1                        
  eutra-PhysCellId                                                                         Physical layer cell identity of E-UTRA Cell 1                                  Step 5
  measResult SEQUENCE {                                                                                                                                                   
  rsrp                                                                                     (0..97)                                                                        
  rsrq                                                                                     (0..34)                                                                        
  sinr                                                                                     Not present                                                                    
  }                                                                                                                                                                       
  cgi-Info                                                                                 Not present                                                                    
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       

##### 8.1.3.2.2 Measurement configuration control and reporting / Inter-RAT measurements / Event B2 / Measurement of E-UTRA cells

##### 8.1.3.2.2.1 Test Purpose (TP) {#test-purpose-tp-62 .H6}

##### (1) {#section-110 .H6}

**with { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B2 to measure neighbor E-UTRA cell is configured }**

**ensure that {**

**when { Entering condition 1 for event B2 is not met but Entering
condition 2 is met }**

**then { UE does not transmit any MeasurementReport }**

**}**

##### (2) {#section-111 .H6}

**with { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B2 to measure neighbor E-UTRA cell is configured }**

**ensure that {**

**when { Entering condition 1 and 2 for event B2 is met }**

**then { UE transmits a MeasurementReport }**

**}**

##### 8.1.3.2.2.2 Conformance requirements {#conformance-requirements-62 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2, 5.5.4.1, 5.5.4.9 and
5.5.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(MCG is E-UTRA):

2\> if *RRCReconfiguration* was received via SRB1:

3\> submit the *RRCReconfigurationComplete* via the EUTRA MCG embedded
in E-UTRA RRC message *RRCConnectionReconfigurationComplete* as
specified in TS 36.331 \[10\];

3\> if *reconfigurationWithSync* was included in *spCellConfig* of an
SCG:

4\> initiate the random access procedure on the SpCell, as specified in
TS 38.321 \[3\];

3\> else:

4\> the procedure ends;

NOTE: The order the UE sends the *RRCConnectionReconfigurationComplete*
message and performs the Random Access procedure towards the SCG is left
to UE implementation.

2\> else (*RRCReconfiguration* was received via SRB3):

3\> submit the *RRCReconfigurationComplete* message via SRB3 to lower
layers for transmission using the new configuration;

NOTE: For EN-DC, in the case *RRCReconfiguration* is received via SRB1,
the random access is triggered by RRC layer itself as there is not
necessarily other UL transmission. In the case *RRCReconfiguration* is
received via SRB3, the random access is triggered by the MAC layer due
to arrival of *RRCReconfigurationComplete*.

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

2\> if this is the first *RRCReconfiguration* message after successful
completion of the RRC re-establishment procedure;

3\> resume SRB2 and DRBs that are suspended;

> ...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

...

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

1\> if *gapUE* is set to setup:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

1\> else if *gapUE* is set to release:

2\> release the per UE measurement gap configuration.

\[TS 38.331, clause 5.5.4.1\]

If security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig*includes a *reportType* set to
*eventTriggered* or *periodical*;

3\> if the corresponding *measObject* concerns NR;

> ...

4\> for measurement events other than *eventA1* or *eventA2*:

5\> if *useAllowedCellList* is set to TRUE:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR*to be applicable when the concerned cell is
included in the *allowedCellsToAddModList* defined within the
*VarMeasConfig* for this measId;

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR*to be applicable when the concerned cell is not
included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this measId;

3\> else if the corresponding *measObject* concerns E-UTRA;

4\> consider any neighbouring cell detected on the associated frequency
to be applicable when the concerned cell is not included in the
*excludedCellsToAddModListEUTRAN* defined within the *VarMeasConfig* for
this *measId*;

> ...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *TRUE* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

> ...

2\> upon the expiry of T321 for this *measId*:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

\[TS 38.331, clause 5.5.4.9\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition B2-1 and condition B2-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition B2-3 or condition B2-4, i.e. at least one of the two, as
specified below, is fulfilled;

Inequality B2-1 (Entering condition 1)

*Mp + Hys \< Thresh1*

Inequality B2-2 (Entering condition 2)

*Mn + Ofn + Ocn -- Hys \> Thresh2*

Inequality B2-3 (Leaving condition 1)

*Mp -- Hys \> Thresh1*

Inequality B2-4 (Leaving condition 2)

*Mn + Ofn + Ocn + Hys \< Thresh2*

The variables in the formula are defined as follows:

***Mp*** is the measurement result of the PCell, not taking into account
any offsets.

***Mn*** is the measurement result of the inter-RAT neighbour cell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the frequency of
the inter-RAT neighbour cell (i.e. *eutra-Q-OffsetRange* as defined
within the *measObjectEUTRA* corresponding to the frequency of the
inter-RAT neighbour cell).

***Ocn*** is the cell specific offset of the inter-RAT neighbour cell
(i.e. *cellIndividualOffset* as defined within the *measObjectEUTRA*
corresponding to the neighbour inter-RAT cell), and set to zero if not
configured for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigInterRAT* for this event).

***Thresh1*** is the threshold parameter for this event (i.e.
b2*-Threshold1* as defined within *reportConfigInterRAT* for this
event).

***Thresh2*** is the threshold parameter for this event (i.e.
*b2-Threshold2EUTRA* as defined within *reportConfigInterRAT* for this
event).

***Mp*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and SINR.

***Mn*** is expressed in dBm or dB, depending on the measurement
quantity of the inter-RAT neighbour cell.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh1*** is expressed in the same unit as ***Mp***.

***Thresh2*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5\]

Figure 5.5.5-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with servingCellMO,
RSRP, RSRQ and the available SINR, derived based on the *rsType* if
indicated in the associated *reportConfig*, otherwise based on SSB if
available, otherwise based on CSI-RS;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include for each NR serving cell that is configured with
*servingCellMO*, if any, the *servCellId*;

1\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *reportQuantityRsIndexes* and
*maxNrofRSIndexesToReport*:

2\> for each serving cell configured with *servingCellMO*, include beam
measurement information according to the associated *reportConfig* as
described in 5.5.5.2;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the reportType is set to eventTriggered:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the reportType is set to eventTriggered or periodical:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first:

9\> if *reportQuantityRsIndexes*and *maxNrofRSIndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

...

6\> if the *measObject* associated with this *measId* concerns E-UTRA:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantity* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

> ...

1\> if the UE is configured with EN-DC:

2\> if SRB3 is configured:

3\> submit the *MeasurementReport* message via SRB3 to lower layers for
transmission, upon which the procedure ends;

2\> else:

3\> submit the *MeasurementReport* message via the EUTRA MCG embedded in
E-UTRA RRC message *ULInformationTransferMRDC* as specified in TS 36.331
\[10\].

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.2.2.3 Test description {#test-description-62 .H6}

##### 8.1.3.2.2.3.1 Pre-test conditions {#pre-test-conditions-62 .H6}

System Simulator:

\- NR Cell 1 is the PCell, E-UTRA Cell 1 is the inter-RAT neighbour cell
of NR Cell 1.

\- NR Cell 1 is configured to operate in FR1 bands as defined in TS
38.508-1 \[4\] clause 6.2.3.

\- System information combination NR-6 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.2.2.3.2 Test procedure sequence {#test-procedure-sequence-63 .H6}

Table 8.1.3.2.2.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1, and E-UTRA Cell 1 at various time instants of the
test execution. Row marked \"T0\" denotes the conditions after the
preamble, while the configuration marked \"T1\" is applied at the point
indicated in the Main behaviour description in Table 8.1.3.2.2.3.2-3.

Table 8.1.3.2.2.3.2-1: Time instances of cell power level and parameter
changes for conducted test environment

+----+------------+-----------+-----------+--------+------------+
|    | Parameter  | Unit      | NR Cell 1 | E-UTRA | Remark     |
|    |            |           |           |        |            |
|    |            |           |           | Cell 1 |            |
+====+============+===========+===========+========+============+
| T0 | SS/PBCH    | dBm/      | -78       | \-     | Power      |
|    |            |           |           |        | levels are |
|    | SSS EPRE   | SCS       |           |        | such that  |
|    |            |           |           |        | entry      |
|    |            |           |           |        | condition  |
|    |            |           |           |        | 1 for      |
|    |            |           |           |        | event B2   |
|    |            |           |           |        | is not     |
|    |            |           |           |        | satisfied  |
|    |            |           |           |        | and entry  |
|    |            |           |           |        | condition  |
|    |            |           |           |        | 2 is       |
|    |            |           |           |        | satisfied: |
|    |            |           |           |        |            |
|    |            |           |           |        | Mp + Hys   |
|    |            |           |           |        | \> Thresh1 |
|    |            |           |           |        | and        |
|    |            |           |           |        |            |
|    |            |           |           |        | Mn + Ofn + |
|    |            |           |           |        | Ocn - Hys  |
|    |            |           |           |        | \> Thresh2 |
+----+------------+-----------+-----------+--------+------------+
|    | Cel        | dBm/15kHz |           | -73    |            |
|    | l-specific |           |           |        |            |
|    | RS EPRE    |           |           |        |            |
+----+------------+-----------+-----------+--------+------------+
| T1 | SS/PBCH    | dBm/      | -90       | \-     | Power      |
|    |            |           |           |        | levels are |
|    | SSS EPRE   | SCS       |           |        | such that  |
|    |            |           |           |        | entry      |
|    |            |           |           |        | condition  |
|    |            |           |           |        | for event  |
|    |            |           |           |        | B2 is      |
|    |            |           |           |        | satisfied: |
|    |            |           |           |        |            |
|    |            |           |           |        | *Mp + Hys  |
|    |            |           |           |        | \< Tresh1* |
|    |            |           |           |        | and        |
|    |            |           |           |        |            |
|    |            |           |           |        | *Mn + Ofn  |
|    |            |           |           |        | + Ocn -    |
|    |            |           |           |        | Hys \>     |
|    |            |           |           |        | Thresh2*   |
+----+------------+-----------+-----------+--------+------------+
|    | Cel        | dBm/15kHz |           | -73    |            |
|    | l-specific |           |           |        |            |
|    | RS EPRE    |           |           |        |            |
+----+------------+-----------+-----------+--------+------------+

Table 8.1.3.2.2.3.2-2: Void

Table 8.1.3.2.2.3.2-3: Main behaviour

  St   Procedure                                                                                                                            Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                            U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup inter-RAT measurement and reporting for event B2.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                            \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                       \--\>              *NR RRC: MeasurementReport*            1         F
  4    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.2.2.3.2-1.                             \-                 *-*                                    \-        \-
  5    Check: Does the UE transmit a *MeasurementReport* message to report event B2 with the measured RSRP value for NR Cell 1?             \--\>              *NR RRC: MeasurementReport*            2         P

##### 8.1.3.2.2.3.3 Specific message contents {#specific-message-contents-54 .H6}

Table 8.1.3.2.2.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.2.2.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.2.2.3.3-2: *MeasConfig* (Table 8.1.3.2.2.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                   
  ------------------------------------------------------------------------------------------ ------------------------------------------------ ----------------------- -----------
  Information Element                                                                        Value/remark                                     Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                           
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                 
  measObjectId                                                                               1                                                MeasObjectIdNR-f1       
  measObject CHOICE {                                                                                                                                                 
  measObjectNR SEQUENCE {                                                                                                                                             
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                           
  absThreshSS-BlocksConsolidation                                                            Not present                                                              
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2                 
  measObjectId                                                                               2                                                MeasObjectIdE-UTRA-f1   
  measObject CHOICE {                                                                                                                                                 
  measObjectEUTRA SEQUENCE {                                                                                                                                          
  carrierFreq                                                                                ARFCN-ValueEUTRA for E-UTRA Cell 1                                       
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                  
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                 
  reportConfigId                                                                             1                                                                        
  reportConfig CHOICE {                                                                                                                                               
  reportConfigInterRAT                                                                       ReportConfigInterRAT-EventB2                     Table 8.1.3.2.2.3.3-3   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                  
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                 
  measId                                                                                     1                                                                        
  measObjectId                                                                               2                                                                        
  reportConfigId                                                                             1                                                                        
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  quantityConfig                                                                             QuantityConfig with Condition INTER-RAT                                  
  measGapConfig                                                                              MeasGapConfig                                                            
  }                                                                                                                                                                   

Table 8.1.3.2.2.3.3-3: *ReportConfigInterRAT-EventB2* (Table
8.1.3.2.2.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-141 with condition EVENT\_B2                            
  ----------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                           Value/remark   Comment   Condition
  ReportConfigInterRAT ::= SEQUENCE {                                                                    
  reportType CHOICE {                                                                                    
  eventTriggered SEQUENCE {                                                                              
  eventId CHOICE {                                                                                       
  eventB2 SEQUENCE {                                                                                     
  b2-Threshold1 CHOICE {                                                                                 
  rsrp                                                                          73             -83dBm    
  }                                                                                                      
  b2-Threshold2EUTRA CHOICE {                                                                            
  rsrp                                                                          58             -83dBm    
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  reportAmount                                                                  r1                       
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      

Table 8.1.3.2.2.3.3-4: *MeasurementReport* (step 5, Table
8.1.3.2.2.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                                       
  ---------------------------------------------------------------------------------------- ----------------------------------------------- ------------------------------ --------------------
  Information Element                                                                      Value/remark                                    Comment                        Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                             
  measurementReport SEQUENCE {                                                                                                                                            
  measResults SEQUENCE {                                                                                                                                                  
  measId                                                                                   1                                                                              
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                         Report NR Cell 1               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                         entry 1                        
  servCellId                                                                               ServCellIndex of NR Cell 1                                                     
  measResultServingCell SEQUENCE {                                                                                                                                        
  physCellId                                                                               Physical layer cell identity of NR Cell 1                                      
  measResult SEQUENCE {                                                                                                                                                   
  cellResults SEQUENCE {                                                                                                                                                  
  resultsSSB-Cell SEQUENCE {                                                                                                                                              
  rsrp                                                                                     (0..127)                                                                       
  rsrq                                                                                     (0..127)                                                                       
  sinr                                                                                     Not present                                                                    
                                                                                           Not checked                                                                    pc\_ss\_SINR\_Meas
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  measResultNeighCells CHOICE {                                                                                                                                           
  measResultListEUTRA SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultEUTRA {             1 entry                                         Report E-UTRA neighbour cell   
  MeasResultEUTRA\[1\] SEQUENCE {                                                                                                          entry 1                        
  eutra-PhysCellId                                                                         Physical layer cell identity of E-UTRA Cell 1                                  
  measResult SEQUENCE {                                                                                                                                                   
  rsrp                                                                                     (0..97)                                                                        
  rsrq                                                                                     (0..34)                                                                        
  sinr                                                                                     Not present                                                                    
  }                                                                                                                                                                       
  cgi-Info                                                                                 Not present                                                                    
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       
  }                                                                                                                                                                       

##### 8.1.3.2.3 Measurement configuration control and reporting / Inter-RAT measurements / Event B2 / Measurement of E-UTRA cells / RSRQ based measurements

##### 8.1.3.2.3.1 Test Purpose (TP) {#test-purpose-tp-63 .H6}

##### (1) {#section-112 .H6}

**with** { UE is NR RRC\_CONNECTED state **and** inter-RAT measurement
event B2 to measure neighbor E-UTRA cell is configured **and**
*triggerQuantity* set to *rsrq* }

**ensure that** {

**when** { Entering condition 1 and 2 for event B2 is not met }

**then** { UE does not send *MeasurementReport* }

}

##### (2) {#section-113 .H6}

**with** { UE is NR RRC\_CONNECTED state **and** inter-RAT measurement
event B2 to measure neighbor E-UTRA cell is configured **and**
*triggerQuantity* set to *rsrq* }

**ensure that** {

**when** { Entering condition 1 and 2 for event B2 is met }

**then** { UE transmits a MeasurementReport }

}

##### 8.1.3.2.3.2 Conformance requirements {#conformance-requirements-63 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clause 5.3.5.3, 5.5.2.1, 5.5.4.1, 5.5.4.9 and
5.5.5.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

\[TS 38.331, clause 5.5.2.1\]

The UE shall:

1\> if the received *measConfig* includes the *measObjectToRemoveList*:

> 2\> perform the measurement object removal procedure as specified in
> 5.5.2.4;

1\> if the received *measConfig* includes the *measObjectToAddModList*:

> 2\> perform the measurement object addition/modification procedure as
> specified in 5.5.2.5;

1\> if the received *measConfig* includes the
*reportConfigToRemoveList*:

> 2\> perform the reporting configuration removal procedure as specified
> in 5.5.2.6;

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

> 2\> perform the reporting configuration addition/modification
> procedure as specified in 5.5.2.7;

1\> if the received *measConfig* includes the *quantityConfig*:

> 2\> perform the quantity configuration procedure as specified in
> 5.5.2.8;

1\> if the received *measConfig* includes the *measIdToRemoveList*:

> 2\> perform the measurement identity removal procedure as specified in
> 5.5.2.2;

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

1\> if the received *measConfig* includes the *measGapSharingConfig*:

2\> perform the measurement gap sharing configuration procedure as
specified in 5.5.2.11;

1\> if the received *measConfig* includes the *s-MeasureConfig*:

2\> if *s-MeasureConfig* is set to *ssb-RSRP*, set parameter *ssb-RSRP*
of *s-MeasureConfig* within *VarMeasConfig* to the lowest value of the
RSRP ranges indicated by the received value of *s-MeasureConfig;*

2\> else, set parameter *csi-RSRP* of *s-MeasureConfig* within
*VarMeasConfig* to the lowest value of the RSRP ranges indicated by the
received value of *s-MeasureConfig*.

\[TS 38.331, clause 5.5.4.1\]

If security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*;

...

3\> else if the corresponding *measObject* concerns E-UTRA;

4\> consider any neighbouring cell detected on the associated frequency
to be applicable when the concerned cell is not included in the
*excludedCellsToAddModListEUTRAN* defined within the *VarMeasConfig* for
this *measId*;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *TRUE* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

...

2\> upon the expiry of T321 for this *measId*:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

\[TS 38.331, clause 5.5.4.9\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition B2-1 and condition B2-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition B2-3 or condition B2-4, i.e. at least one of the two, as
specified below, is fulfilled;

Inequality B2-1 (Entering condition 1)

*Mp + Hys \< Thresh1*

Inequality B2-2 (Entering condition 2)

*Mn + Ofn + Ocn -- Hys \> Thresh2*

Inequality B2-3 (Leaving condition 1)

*Mp -- Hys \> Thresh1*

Inequality B2-4 (Leaving condition 2)

*Mn + Ofn + Ocn + Hys \< Thresh2*

The variables in the formula are defined as follows:

***Mp*** is the measurement result of the PCell, not taking into account
any offsets.

***Mn*** is the measurement result of the inter-RAT neighbour cell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the frequency of
the inter-RAT neighbour cell (i.e. *eutra-Q-OffsetRange* as defined
within the *measObjectEUTRA* corresponding to the frequency of the
inter-RAT neighbour cell).

***Ocn*** is the cell specific offset of the inter-RAT neighbour cell
(i.e. *cellIndividualOffset* as defined within the *measObjectEUTRA*
corresponding to the neighbour inter-RAT cell), and set to zero if not
configured for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigInterRAT* for this event).

***Thresh1*** is the threshold parameter for this event (i.e.
b2*-Threshold1* as defined within *reportConfigInterRAT* for this
event).

***Thresh2*** is the threshold parameter for this event (i.e.
*b2-Threshold2EUTRA* as defined within *reportConfigInterRAT* for this
event).

***Mp*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and SINR.

***Mn*** is expressed in dBm or dB, depending on the measurement
quantity of the inter-RAT neighbour cell.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh1*** is expressed in the same unit as ***Mp***.

***Thresh2*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with
*servingCellMO*, RSRP, RSRQ and the available SINR, derived based on the
*rsType* if indicated in the associated *reportConfig,* otherwise based
on SSB if available, otherwise based on CSI-RS;

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

1\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *reportQuantityRS-Indexes* and
*maxNrofRS-IndexesToReport*:

2\> for each serving cell configured with *servingCellMO*, include beam
measurement information according to the associated *reportConfig* as
described in 5.5.5.2;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the reportType is set to eventTriggered:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

...

6\> if the *measObject* associated with this *measId* concerns E-UTRA:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantity* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.2.3.3 Test description {#test-description-63 .H6}

##### 8.1.3.2.3.3.1 Pre-test conditions {#pre-test-conditions-63 .H6}

##### System Simulator: {#system-simulator-41 .H6}

\- Cell 1 is the NR serving cell, E-UTRA Cell 1 is the inter-RAT
neighbour cell.

\- NR Cell 1 is configured to operate in FR1 bands as defined in TS
38.508-1 \[4\] clause 6.2.3.

\- System information combination NR-6 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2, and message contents defined in clause 4.6.1 and
clause 4.6.2 with QBASED condition is used in NR cells.

##### UE: {#ue-38 .H6}

\- None.

##### Preamble: {#preamble-40 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.3.2.3.3.2 Test procedure sequence {#test-procedure-sequence-64 .H6}

Table 8.1.3.2.3.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1 and E-UTRA Cell 1 at various time instants of the
test execution for FR1. Row marked \"T0\" denotes the conditions after
the preamble, while rows marked \"T1\"and \"T2\" are to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.3.2.3.3.2-1: Time instances of cell power level and parameter
changes for conducted test environment

+----+-----------+-----------+-----------+-----------+-----------+
|    | Parameter | Unit      | NR Cell 1 | E-UTRA    | Remark    |
|    |           |           |           | Cell      |           |
+====+===========+===========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS   | -88       | \-        | Power     |
|    |           |           |           |           | levels    |
|    | SSS EPRE  |           |           |           | are such  |
|    |           |           |           |           | that      |
|    |           |           |           |           | entry     |
|    |           |           |           |           | condition |
|    |           |           |           |           | for event |
|    |           |           |           |           | B2 is not |
|    |           |           |           |           | s         |
|    |           |           |           |           | atisfied: |
|    |           |           |           |           |           |
|    |           |           |           |           | *Mp + Hys |
|    |           |           |           |           | ≥         |
|    |           |           |           |           | Thresh1*  |
|    |           |           |           |           | or *Mn +  |
|    |           |           |           |           | Ofn + Ocn |
|    |           |           |           |           | -- Hys ≤  |
|    |           |           |           |           | Thresh2*  |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS-RSRQ   | dB        | -11.74    | \-        |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | Cell      | dBm/15kHz | \-        | -94       |           |
|    | -specific |           |           |           |           |
|    | RS EPRE   |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | RSRQ      | dB        | \-        | -11.46    |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | Noc       | dBm/SCS   | -94       | \-        |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | Noc       | dBm/15kHz | \-        | -94       |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS   | -88       | \-        | Power     |
|    |           |           |           |           | levels    |
|    | SSS EPRE  |           |           |           | are such  |
|    |           |           |           |           | that      |
|    |           |           |           |           | entry     |
|    |           |           |           |           | condition |
|    |           |           |           |           | for event |
|    |           |           |           |           | B2 is     |
|    |           |           |           |           | s         |
|    |           |           |           |           | atisfied: |
|    |           |           |           |           |           |
|    |           |           |           |           | *Mp + Hys |
|    |           |           |           |           | \<        |
|    |           |           |           |           | Thresh1*  |
|    |           |           |           |           | and *Mn + |
|    |           |           |           |           | Ofn + Ocn |
|    |           |           |           |           | -- Hys \> |
|    |           |           |           |           | Thresh2*  |
+----+-----------+-----------+-----------+-----------+-----------+
|    | SS-RSRQ   | dB        | -11.74    | \-        |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | Cell      | dBm/15kHz | \-        | -80       |           |
|    | -specific |           |           |           |           |
|    | RS EPRE   |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
|    | RSRQ      | dB        | \-        | -3.94     |           |
+----+-----------+-----------+-----------+-----------+-----------+

Table 8.1.3.2.3.3.2-2: Void

Table 8.1.3.2.3.3.2-3: Main behaviour

  St   Procedure                                                                                                                                          Message Sequence   TP                                     Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                          U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message on NR Cell 1 including *MeasConfig* to setup inter-RAT measurement and reporting for event B2     \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1.                                                                             \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit a *MeasurementReport* message on NR Cell 1 within the next 10s?                                                        \--\>              NR RRC: *MeasurementReport*            1         F
  4    The SS re-adjusts the cell-specific reference signal level according to row \"T1\" in Table 8.1.3.2.3.3.2-1.                                       \-                 \-                                     \-        \-
  5    Check: Does the UE transmit a *MeasurementReport* message on Cell 1 to report event B2 with the measured RSRP and RSRQ values for E-UTRA Cell 1?   \--\>              NR RRC: *MeasurementReport*            2         P

##### 8.1.3.2.3.3.3 Specific message contents {#specific-message-contents-55 .H6}

Table 8.1.3.2.3.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.2.3.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-13 with condion NR\_MEAS
  -------------------------------------------------------------------------

Table 8.1.3.2.3.3.3-2: *MeasConfig* (step 1, Table 8.1.3.2.3.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.3-69                                                                                                            
  ------------------------------------------------------------------------------------------ ----------------------------------------- ----------------------- -----------
  Information Element                                                                        Value/Remark                              Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                    
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                         
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                   entry 1                 
  measObjectId                                                                               1                                                                 
  measObject CHOICE {                                                                                                                                          
  measObjectNR                                                                               MeasObjectNR-f1                           Table 8.1.3.2.3.3.3-3   
  }                                                                                                                                                            
  }                                                                                                                                                            
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                   entry 2                 
  measObjectId                                                                               2                                                                 
  measObject CHOICE {                                                                                                                                          
  measObjectEUTRA                                                                            MeasObjectEUTRA-f2                        Table 8.1.3.2.3.3.3-4   
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                           
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                 entry 1                 
  reportConfigId                                                                             ReportConfigId                                                    
  reportConfig CHOICE {                                                                                                                                        
  reportConfigInterRAT                                                                       ReportConfigInterRAT-B2                   Table 8.1.3.2.3.3.3-5   
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                           
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                       entry 1                 
  measId                                                                                     1                                                                 
  measObjectId                                                                               2                                                                 
  reportConfigId                                                                             ReportConfigId                                                    
  }                                                                                                                                                            
  }                                                                                                                                                            
  quantityConfig                                                                             QuantityConfig with condition INTER-RAT                           
  measGapConfig                                                                              MeasGapConfig                             Table 8.1.3.2.3.3.3-6   
  }                                                                                                                                                            

Table 8.1.3.2.3.3.3-3: *MeasObjectNR*-f1 (Table 8.1.3.2.3.3.3-2)

  ---------------------------------------------------- --------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                               
  Information Element                                  Value/remark                      Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                       
  ssbFrequency                                         Downlink ARFCN of NR cell 1 SSB             
  absThreshSS-BlocksConsolidation                      Not present                                 
  }                                                                                                
  ---------------------------------------------------- --------------------------------- --------- -----------

Table 8.1.3.2.3.3.3-4: *MeasObjectEUTRA-f2* (Table 8.1.3.2.3.3.3-2)

  ---------------------------------------------------- --------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-74                                               
  Information Element                                  Value/remark                      Comment   Condition
  MeasObjectEUTRA::= SEQUENCE {                                                                    
  carrierFreq                                          Downlink ARFCN of E-UTRA Cell 1             
  }                                                                                                
  ---------------------------------------------------- --------------------------------- --------- -----------

Table 8.1.3.2.3.3.3-5: *ReportConfigInterRAT-B2* (Table 8.1.3.2.3.3.3-2)

  ------------------------------------------------------------------------------ ---------------- --------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-141 with condition EVENT\_B2                                          
  Information Element                                                            Value/remark     Comment               Condition
  ReportConfigInterRAT::= SEQUENCE {                                                                                    
  reportType CHOICE {                                                                                                   
  eventTriggered SEQUENCE {                                                                                             
  eventId CHOICE {                                                                                                      
  eventB2 SEQUENCE {                                                                                                    
  b2-Threshold1 CHOICE {                                                                                                
  rsrq                                                                           79               Actual value = -4dB   
  }                                                                                                                     
  b2-Threshold2EUTRA CHOICE {                                                                                           
  rsrq                                                                           23               Actual value = -8dB   
  }                                                                                                                     
  hysteresis                                                                     Hysteresis                             
  timeToTrigger                                                                  ms0                                    
  }                                                                                                                     
  }                                                                                                                     
  reportInterval                                                                 ReportInterval                         
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     
  ------------------------------------------------------------------------------ ---------------- --------------------- -----------

Table 8.1.3.2.3.3.3-6: *MeasGapConfig* (Table 8.1.3.2.3.3.3-2)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-70                            
  Information Element                                  Value/remark   Comment   Condition
  MeasGapConfig ::= SEQUENCE {                                                  
  gapUE CHOICE {                                                                
  setup SEQUENCE {                                                              
  gapOffset                                            0                        
  mgl                                                  ms6                      
  mgrp                                                 ms40                     
  mgta                                                 ms0                      
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.3.2.3.3.3-7: *MeasurementReport* (steps 5, Table
8.1.3.2.3.3.3-2)

  ---------------------------------------------------------------------------------------- ---------------------------------- --------- --------------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-5A                                                                                    
  Information Element                                                                      Value/remark                       Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                      
  criticalExtensions CHOICE {                                                                                                           
  measurementReport SEQUENCE {                                                                                                          
  measResults SEQUENCE {                                                                                                                
  measId                                                                                   1                                  Step 5    
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {                                                
  MeasResultServMO\[1\] SEQUENCE {                                                         1 entry                            entry 1   
  servCellId                                                                               ServCellIndex of NR serving cell             
  measResultServingCell SEQUENCE {                                                                                                      
  physCellId                                                                               PhysCellId of NR serving cell                
  measResult SEQUENCE {                                                                                                                 
  cellResults SEQUENCE {                                                                                                                
  resultsSSB-Cell SEQUENCE {                                                                                                            
  rsrp                                                                                     (0..127)                                     
  rsrq                                                                                     (0..127)                                     
  sinr                                                                                     Not present                                  
                                                                                           Not checked                                  pc\_ss\_SINR\_Meas
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  measResultNeighCells CHOICE {                                                                                                         
  MeasResultListEUTRA SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultEUTRA {              1 entry                                      
  MeasResultEUTRA\[1\] SEQUENCE {                                                                                             entry 1   
  eutra-PhysCellId                                                                         PhysCellId of E-UTRA Cell 1        Step 5    
  measResult SEQUENCE {                                                                                                                 
  rsrp                                                                                     (0..97)                                      
  rsrq                                                                                     (0..34)                                      
  sinr                                                                                     Not present                                  
  }                                                                                                                                     
  cgi-Info                                                                                 Not present                                  
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  ---------------------------------------------------------------------------------------- ---------------------------------- --------- --------------------

##### 8.1.3.2.4 Measurement configuration control and reporting / Inter-RAT measurements / Event B2 / Measurement of E-UTRA cells / SINR based measurements

##### 8.1.3.2.4.1 Test Purpose (TP) {#test-purpose-tp-64 .H6}

##### (1) {#section-114 .H6}

**with { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B2 to measure neighbor E-UTRA cell is configured and triggerQuantity set
to sinr }**

**ensure that {**

**when { Entering condition 1 and 2 for event B2 is not met }**

**then { UE does not transmit any MeasurementReport }**

**}**

##### (2) {#section-115 .H6}

**with { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B2 to measure neighbor E-UTRA cell is configured and triggerQuantity set
to sinr }**

**ensure that {**

**when { Entering condition 1 and 2 for event B2 is met }**

**then { UE transmits a MeasurementReport }**

**}**

##### 8.1.3.2.4.2 Conformance requirements {#conformance-requirements-64 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.2.9, 5.5.4.1,
5.5.4.9 and 5.5.5.1. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

> ...

1\> if the UE is configured with E-UTRA *nr-SecondaryCellGroupConfig*
(MCG is E-UTRA):

...

1\> else:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

...

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

...

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> if *mgta* is configured, apply the specified timing advance to the
gap occurrences calculated above (i.e. the UE starts the measurement
*mgta* ms before the gap subframe occurrences);

...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

...

3\> else if the corresponding *measObject* concerns E-UTRA:

4\> consider any neighbouring cell detected on the associated frequency
to be applicable when the concerned cell is not included in the
*excludedCellsToAddModListEUTRAN* defined within the *VarMeasConfig* for
this *measId*;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *true* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

...

\[TS 38.331, clause 5.5.4.9\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition B2-1 and condition B2-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition B2-3 or condition B2-4, i.e. at least one of the two, as
specified below, is fulfilled;

Inequality B2-1 (Entering condition 1)

*Mp + Hys \< Thresh1*

Inequality B2-2 (Entering condition 2)

*Mn + Ofn + Ocn -- Hys \> Thresh2*

Inequality B2-3 (Leaving condition 1)

*Mp -- Hys \> Thresh1*

Inequality B2-4 (Leaving condition 2)

*Mn + Ofn + Ocn + Hys \< Thresh2*

The variables in the formula are defined as follows:

***Mp*** is the measurement result of the PCell, not taking into account
any offsets.

***Mn*** is the measurement result of the inter-RAT neighbour cell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the frequency of
the inter-RAT neighbour cell (i.e. *eutra-Q-OffsetRange* as defined
within the *measObjectEUTRA* corresponding to the frequency of the
inter-RAT neighbour cell).

***Ocn*** is the cell specific offset of the inter-RAT neighbour cell
(i.e. *cellIndividualOffset* as defined within the *measObjectEUTRA*
corresponding to the neighbour inter-RAT cell), and set to zero if not
configured for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigInterRAT* for this event).

***Thresh1*** is the threshold parameter for this event (i.e.
b2*-Threshold1* as defined within *reportConfigInterRAT* for this
event).

***Thresh2*** is the threshold parameter for this event (i.e.
*b2-Threshold2EUTRA* as defined within *reportConfigInterRAT* for this
event).

***Mp*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and SINR.

***Mn*** is expressed in dBm or dB, depending on the measurement
quantity of the inter-RAT neighbour cell.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh1*** is expressed in the same unit as ***Mp***.

***Thresh2*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5.1\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> set the *measResultServingCell* within *measResultServingMOList* to
include, for each NR serving cell that is configured with
*servingCellMO*, RSRP, RSRQ and the available SINR, derived based on the
*rsType* if indicated in the associated *reportConfig,* otherwise based
on SSB if available, otherwise based on CSI-RS;

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

...

6\> if the *measObject* associated with this *measId* concerns E-UTRA:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantity* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.2.4.3 Test description {#test-description-64 .H6}

##### 8.1.3.2.4.3.1 Pre-test conditions {#pre-test-conditions-64 .H6}

System Simulator:

\- NR Cell 1 is the serving cell, EUTRA Cell 1 is the inter-RAT
neighbour cell of NR Cell 1.

\- NR Cell 1 is configured to operate in FR1 bands as defined in TS
38.508-1 \[4\] clause 6.2.3.

\- System information combination NR-7 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2, and message contents defined in clause 4.6.1 and
clause 4.6.2 with QBASED condition is used in NR cells.

UE:

> \- None.

Preamble:

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A.

##### 8.1.3.2.4.3.2 Test procedure sequence {#test-procedure-sequence-65 .H6}

Table 8.1.3.2.4.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1 and EUTRA Cell 1 at various time instants of the
test execution. Row marked \"T0\" denotes the conditions after the
preamble, while the configuration marked \"T1\", is applied at the point
indicated in the Main behaviour description in Table 8.1.3.2.4.3.2-3.

Table 8.1.3.2.4.3.2-1: Time instances of cell power level and parameter
changes for NR Cell 1 and E-UTRA Cell 1 in conducted test environment

+----+------------+-----------+-----------+--------+------------+
|    | Parameter  | Unit      | NR Cell 1 | E-UTRA | Remark     |
|    |            |           |           |        |            |
|    |            |           |           | Cell 1 |            |
+====+============+===========+===========+========+============+
| T0 | SS/PBCH    | dBm/      | -79       | \-     | Power      |
|    | SSS EPRE   |           |           |        | levels are |
|    |            | SCS       |           |        | such that  |
|    |            |           |           |        | entry      |
|    |            |           |           |        | conditions |
|    |            |           |           |        | for event  |
|    |            |           |           |        | B2 are not |
|    |            |           |           |        | satisfied: |
|    |            |           |           |        |            |
|    |            |           |           |        | 1)  *Mp +  |
|    |            |           |           |        |     Hys ≥  |
|    |            |           |           |        |            |
|    |            |           |           |        |    Thresh1 |
|    |            |           |           |        |     and*   |
|    |            |           |           |        |            |
|    |            |           |           |        | 2)  *Mn +  |
|    |            |           |           |        |            |
|    |            |           |           |        |    > Ofn + |
|    |            |           |           |        |     > Ocn  |
|    |            |           |           |        |     > --   |
|    |            |           |           |        |     > Hys  |
|    |            |           |           |        |     > ≤    |
|    |            |           |           |        |            |
|    |            |           |           |        | > Thresh2* |
+----+------------+-----------+-----------+--------+------------+
|    | Cel        | dBm/15kHz | \-        | -91    |            |
|    | l-specific |           |           |        |            |
|    | RS EPRE    |           |           |        |            |
+----+------------+-----------+-----------+--------+------------+
|    | Noc        | dBm/15kHz | \-        | -82    |            |
+----+------------+-----------+-----------+--------+------------+
|    | Noc        | dBm/      | -94       | \-     |            |
|    |            |           |           |        |            |
|    |            | SCS       |           |        |            |
+----+------------+-----------+-----------+--------+------------+
|    | SINR       | \-        | 15        | -9     |            |
+----+------------+-----------+-----------+--------+------------+
| T1 | SS/PBCH    | dBm/      | -91       | \-     | Power      |
|    | SSS EPRE   |           |           |        | levels are |
|    |            | SCS       |           |        | such that  |
|    |            |           |           |        | entry      |
|    |            |           |           |        | condition  |
|    |            |           |           |        | for event  |
|    |            |           |           |        | B2 are     |
|    |            |           |           |        | satisfied: |
|    |            |           |           |        |            |
|    |            |           |           |        | 1)  *Mp +  |
|    |            |           |           |        |     Hys \< |
|    |            |           |           |        |            |
|    |            |           |           |        |    Thresh1 |
|    |            |           |           |        |     and*   |
|    |            |           |           |        |            |
|    |            |           |           |        | *Mn + Ofn  |
|    |            |           |           |        | + Ocn --   |
|    |            |           |           |        | Hys \>     |
|    |            |           |           |        | Thresh2*   |
+----+------------+-----------+-----------+--------+------------+
|    | Cel        | dBm/15kHz | \-        | -73    |            |
|    | l-specific |           |           |        |            |
|    | RS EPRE    |           |           |        |            |
+----+------------+-----------+-----------+--------+------------+
|    | Noc        | dBm/15kHz | \-        | -82    |            |
+----+------------+-----------+-----------+--------+------------+
|    | Noc        | dBm/      | -94       | \-     |            |
|    |            |           |           |        |            |
|    |            | SCS       |           |        |            |
+----+------------+-----------+-----------+--------+------------+
|    | SINR       | \-        | 3         | 9      |            |
+----+------------+-----------+-----------+--------+------------+

Table 8.1.3.2.4.3.2-2: Void

Table 8.1.3.2.4.3.2-3: Main behaviour

  St   Procedure                                                                                                                                  Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                                  U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup EUTRA measurement and reporting for inter-RAT event B2.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                  \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit a *MeasurementReport* message with event B2 for EUTRA Cell 1 within the next 10s?                              \-                 *-*                                    1         F
  4    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.2.4.3.2-1.                                   \-                 *-*                                    \-        \-
  5    Check: Does the UE transmit a *MeasurementReport* message with event B2 for EUTRA Cell 1 within the next 10s?                              \--\>              *NR RRC: MeasurementReport*            2         P

##### 8.1.3.2.4.3.3 Specific message contents {#specific-message-contents-56 .H6}

Table 8.1.3.2.4.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.2.4.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.2.4.3.3-2: *MeasConfig* (Table 8.1.3.2.4.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                            
  ------------------------------------------------------------------------------------------ ----------------------------------------- ----------------------- -----------
  Information Element                                                                        Value/remark                              Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                    
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                         
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                   entry 1                 
  measObjectId                                                                               1                                                                 
  measObject CHOICE {                                                                                                                                          
  measObjectNR                                                                               MeasObjectNR-f1                           Table 8.1.3.2.4.3.3-3   
  }                                                                                                                                                            
  }                                                                                                                                                            
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                   entry 2                 
  measObjectId                                                                               2                                                                 
  measObject CHOICE {                                                                                                                                          
  measObjectEUTRA                                                                            MeasObjectEUTRA-f2                        Table 8.1.3.2.4.3.3-4   
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                           
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                 entry 1                 
  reportConfigId                                                                             1                                                                 
  reportConfig CHOICE {                                                                                                                                        
  reportConfigInterRAT                                                                       ReportConfigInterRAT-EventB2              Table 8.1.3.2.4.3.3-5   
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                           
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                       entry 1                 
  measId                                                                                     1                                                                 
  measObjectId                                                                               2                                                                 
  reportConfigId                                                                             1                                                                 
  }                                                                                                                                                            
  }                                                                                                                                                            
  quantityConfig                                                                             QuantityConfig with condition INTER-RAT                           
  measGapConfig                                                                              MeasGapConfig                                                     
  }                                                                                                                                                            

Table 8.1.3.2.4.3.3-3: *MeasObjectNR-f1* (Table 8.1.3.2.4.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  ---------------------------------------------------- ------------------------------------ --------- -----------
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   

Table 8.1.3.2.4.3.3-4: *MeasObjectEUTRA-f2* (Table 8.1.3.2.4.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-74                                                         
  ---------------------------------------------------- ------------------------------------------- --------- -----------
  Information Element                                  Value/remark                                Comment   Condition
  MeasObjectEUTRA::= SEQUENCE {                                                                              
  carrierFreq                                          ARFCN-ValueEUTRA for CRS of E-UTRA Cell 1             
  }                                                                                                          

Table 8.1.3.2.4.3.3-5: *ReportConfigInterRAT-EventB2* (Table
8.1.3.2.4.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-141 with condition EVENT\_B2                                       
  ----------------------------------------------------------------------------- -------------- -------------------- -----------
  Information Element                                                           Value/remark   Comment              Condition
  ReportConfigInterRAT ::= SEQUENCE {                                                                               
  reportType CHOICE {                                                                                               
  eventTriggered SEQUENCE {                                                                                         
  eventId CHOICE {                                                                                                  
  eventB2 SEQUENCE {                                                                                                
  b2-Threshold1 CHOICE {                                                                                            
  sinr                                                                          64             Actual value = 9dB   
  }                                                                                                                 
  b2-Threshold2EUTRA CHOICE {                                                                                       
  sinr                                                                          46             0 dB                 
  }                                                                                                                 
  hysteresis                                                                    4              2 dB                 
  }                                                                                                                 
  }                                                                                                                 
  reportAmount                                                                  r1                                  
  reportQuantity SEQUENCE {                                                                                         
  rsrp                                                                          true                                
  rsrq                                                                          true                                
  sinr                                                                          true                                
  }                                                                                                                 
  }                                                                                                                 
  }                                                                                                                 
  }                                                                                                                 

Table 8.1.3.2.4.3.3-6: *MeasurementReport* (step 5, Table
8.1.3.2.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                           
  ---------------------------------------------------------------------------------------- ---------------------------- ------------------------------------- -----------
  Information Element                                                                      Value/remark                 Comment                               Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                 
  measurementReport SEQUENCE {                                                                                                                                
  measResults SEQUENCE {                                                                                                                                      
  measId                                                                                   1                                                                  
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                      Measurement report for NR Cell 1      
  MeasResultServMO\[1\] SEQUENCE {                                                                                      entry 1                               
  servCellId                                                                               ServCellIndex of NR Cell 1                                         
  measResultServingCell SEQUENCE {                                                                                                                            
  physCellId                                                                               PCI of NR Cell 1                                                   
  measResult SEQUENCE {                                                                                                                                       
  cellResults SEQUENCE {                                                                                                                                      
  resultsSSB-Cell SEQUENCE {                                                                                                                                  
  rsrp                                                                                     (0..127)                                                           
  rsrq                                                                                     (0..127)                                                           
  sinr                                                                                     (0..127)                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  measResultNeighCells CHOICE {                                                                                                                               
  measResultListEUTRA SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultEUTRA {             1 entry                      Measurement report for EUTRA Cell 1   
  MeasResultEUTRA\[1\] SEQUENCE {                                                                                       entry 1                               
  eutra-PhysCellId                                                                         PhysCellId of EUTRA Cell 1                                         
  measResult SEQUENCE {                                                                                                                                       
  rsrp                                                                                     (0..97)                                                            
  rsrq                                                                                     (0..34)                                                            
  sinr                                                                                     (0..127)                                                           
  }                                                                                                                                                           
  cgi-Info                                                                                 Not present                                                        
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           
  }                                                                                                                                                           

##### 8.1.3.2.5 Void

##### 8.1.3.2.6 Measurement configuration control and reporting / Inter-RAT measurements / Event B1 / NR to UTRA

##### 8.1.3.2.6.1 Test Purpose (TP) {#test-purpose-tp-65 .H6}

##### (1) {#section-116 .H6}

**with** { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B1 to measure neighbour UTRA cell is configured }

**ensure that** {

**when** { Entering condition for the event B1 is not met }

**then** { UE does not transmit any MeasurementReport }

}

##### (2) {#section-117 .H6}

**with** { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B1 to measure neighbour UTRA cell is configured }

**ensure that** {

**when** { Entering condition for the event B1 is met }

**then** { UE transmits a MeasurementReport }

}

##### 8.1.3.2.6.2 Conformance requirements {#conformance-requirements-65 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331 \[12\], clause 5.5.4.1, 5.5.4.8 and 5.5.5.1.
Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

...

3\> else if the corresponding *measObject* concerns UTRA-FDD:

4\> if *eventB1-UTRA-FDD* or *eventB2-UTRA-FDD* is configured in the
corresponding *reportConfig*; or

4\> if corresponding *reportConfig* includes *reportType* set to
*periodical*:

5\> consider a neighbouring cell on the associated frequency to be
applicable when the concerned cell is included in the
*cellsToAddModList* defined within the *VarMeasConfig* for this
*measId*;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

> 3\> if *useT312* is set to *true* in *reportConfig* for this event:

4\> if T310 for the corresponding SpCell is running; and

4\> if T312 is not running for corresponding SpCell:

5\> start timer T312 for the corresponding SpCell with the value of T312
configured in the corresponding *measObjectNR*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

\[TS 38.331, clause 5.5.4.8\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition B1-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition B1-2, as specified below, is fulfilled.

Inequality B1-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Thresh*

Inequality B1-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Thresh*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the inter-RAT neighbour cell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the frequency of
the inter-RAT neighbour cell (i.e. *eutra-Q-OffsetRange* as defined
within the *measObjectEUTRA* corresponding to the frequency of the
neighbour inter-RAT cell, *utra-FDD-Q-OffsetRange* as defined within the
*measObjectUTRA-FDD* corresponding to the frequency of the neighbour
inter-RAT cell).

***Ocn*** is the cell specific offset of the inter-RAT neighbour cell
(i.e. *cellIndividualOffset* as defined within the *measObjectEUTRA*
corresponding to the neighbour inter-RAT cell), and set to zero if not
configured for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigInterRAT* for this event).

***Thresh*** is the threshold parameter for this event (i.e.
*b1-ThresholdEUTRA* as defined within *reportConfigInterRAT* for this
event, *b1-ThresholdUTRA-FDD* as defined for UTRA-FDD within
*reportConfigInterRAT* for this event).

***Mn*** is expressed in dBm or in dB, depending on the measurement
quantity of the inter-RAT neighbour cell.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5.1\]

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

4\> else:

5\> include the applicable cells for which the new measurement results
became available since the last periodical reporting or since the
measurement was initiated or reset;

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

8\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

7\> else if *rsType* in the associated *reportConfig* is set to
*csi-rs*:

8\> set *resultsCSI-RS-Cell* within the *measResult* to include the
CSI-RS based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

8\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* are
configured, include beam measurement information as described in
5.5.5.2;

6\> if the *measObject* associated with this *measId* concerns E-UTRA:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantity* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

6\> if the *measObject* associated with this *measId* concerns UTRA-FDD
and if *ReportConfigInterRAT* includes the *reportQuantityUTRA-FDD*:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantityUTRA-FDD* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

##### 8.1.3.2.6.3 Test description {#test-description-65 .H6}

##### 8.1.3.2.6.3.1 Pre-test conditions {#pre-test-conditions-65 .H6}

##### System Simulator: {#system-simulator-42 .H6}

\- NR Cell 1 is the PCell, UTRA Cell 5 is the inter-RAT neighbour cell
of NR Cell 1.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-39 .H6}

\- None.

##### Preamble: {#preamble-41 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.3.2.6.3.2 Test procedure sequence {#test-procedure-sequence-66 .H6}

Table 8.1.3.2.6.3.2-1 and 8.1.3.2.6.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1, and UTRA Cell 5 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble, while the configuration marked \"T1\" is applied at
the point indicated in the Main behaviour description in Table
8.1.3.2.6.3.2-3.

Table 8.1.3.2.6.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+------------+------------+-----------+--------+------------+
|    | Parameter  | Unit       | NR Cell 1 | UTRA   | Remark     |
|    |            |            |           |        |            |
|    |            |            |           | Cell 5 |            |
+====+============+============+===========+========+============+
| T0 | SS/PBCH    | dBm/       | -85       | \-     | Power      |
|    |            |            |           |        | levels are |
|    | SSS EPRE   | SCS        |           |        | such that  |
|    |            |            |           |        | entry      |
|    |            |            |           |        | condition  |
|    |            |            |           |        | for event  |
|    |            |            |           |        | B1 is not  |
|    |            |            |           |        | satisfied: |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mn + Ofn  |
|    |            |            |           |        | + Ocn +    |
|    |            |            |           |        | Hys \<     |
|    |            |            |           |        | Thresh*    |
+----+------------+------------+-----------+--------+------------+
|    | Cel        | dBm/3.84   | \-        | -93    |            |
|    | l-specific | MHz        |           |        |            |
|    | CPICH\_Ec  |            |           |        |            |
+----+------------+------------+-----------+--------+------------+
| T1 | SS/PBCH    | dBm/       | -85       | \-     | Power      |
|    |            |            |           |        | levels are |
|    | SSS EPRE   | SCS        |           |        | such that  |
|    |            |            |           |        | entry      |
|    |            |            |           |        | condition  |
|    |            |            |           |        | for event  |
|    |            |            |           |        | B1 is      |
|    |            |            |           |        | satisfied: |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mn + Ofn  |
|    |            |            |           |        | + Ocn --   |
|    |            |            |           |        | Hys \>     |
|    |            |            |           |        | Thresh*    |
+----+------------+------------+-----------+--------+------------+
|    | Cel        | dBm/3.84   | \-        | -73    |            |
|    | l-specific | MHz        |           |        |            |
|    | CPICH\_Ec  |            |           |        |            |
+----+------------+------------+-----------+--------+------------+

Table 8.1.3.2.6.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+------------+------------+-----------+--------+------------+
|    | Parameter  | Unit       | NR Cell 1 | UTRA   | Remark     |
|    |            |            |           |        |            |
|    |            |            |           | Cell 5 |            |
+====+============+============+===========+========+============+
| T0 | SS/PBCH    | dBm/       | -85       | \-     | Power      |
|    |            |            |           |        | levels are |
|    | SSS EPRE   | SCS        |           |        | such that  |
|    |            |            |           |        | entry      |
|    |            |            |           |        | condition  |
|    |            |            |           |        | for event  |
|    |            |            |           |        | B1 is not  |
|    |            |            |           |        | satisfied: |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mn + Ofn  |
|    |            |            |           |        | + Ocn +    |
|    |            |            |           |        | Hys \<     |
|    |            |            |           |        | Thresh*    |
+----+------------+------------+-----------+--------+------------+
|    | Cel        | dBm/3.84   | \-        | Off    |            |
|    | l-specific | MHz        |           |        |            |
|    | CPICH\_Ec  |            |           |        |            |
+----+------------+------------+-----------+--------+------------+
| T1 | SS/PBCH    | dBm/       | -85       | \-     | Power      |
|    |            |            |           |        | levels are |
|    | SSS EPRE   | SCS        |           |        | such that  |
|    |            |            |           |        | entry      |
|    |            |            |           |        | condition  |
|    |            |            |           |        | for event  |
|    |            |            |           |        | B1 is      |
|    |            |            |           |        | satisfied: |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mn + Ofn  |
|    |            |            |           |        | + Ocn --   |
|    |            |            |           |        | Hys \>     |
|    |            |            |           |        | Thresh*    |
+----+------------+------------+-----------+--------+------------+
|    | Cel        | dBm/3.84   | \-        | -60    |            |
|    | l-specific | MHz        |           |        |            |
|    | CPICH\_Ec  |            |           |        |            |
+----+------------+------------+-----------+--------+------------+

Table 8.1.3.2.6.3.2-3: Main behaviour

  **St**   **Procedure**                                                                                                                                                      **Message Sequence**   **TP**                                 **Verdict**   
  -------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------- -------------------------------------- ------------- ----
                                                                                                                                                                              **U - S**              **Message**                                          
  1        The SS transmits an RRCReconfiguration message *including* MeasConfig to setup inter-RAT measurement and reporting for event B1.                                   \<\--                  *NR RRC: RRCReconfiguration*           \-            \-
  2        The UE transmits an RRCReconfigurationComplete message.                                                                                                            \--\>                  *NR RRC: RRCReconfigurationComplete*   \-            \-
  3        Check: Does the UE transmit a *MeasurementReport* message within the next 10s?                                                                                     \--\>                  *NR RRC: MeasurementReport*            1             F
  4        SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.2.6.3.2-1/2.                                                         \-                     *-*                                    \-            \-
  5        Check: Does the UE transmit a *MeasurementReport* message to report event B1 with the measured RSRP value for NR Cell 1 and measured RSCP value for UTRA cell 5?   \--\>                  *NR RRC: MeasurementReport*            2             P

##### 8.1.3.2.6.3.3 Specific message contents {#specific-message-contents-57 .H6}

Table 8.1.3.2.6.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.2.6.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13, condition NR\_MEAS
  ------------------------------------------------------------------------

Table 8.1.3.2.6.3.3-2: *MeasConfig* (Table 8.1.3.2.6.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                      
  ------------------------------------------------------------------------------------------ ------------------------------------------------ -------------------------- -----------
  Information Element                                                                        Value/remark                                     Comment                    Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                              
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                                   
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                    
  measObjectId                                                                               1                                                MeasObjectIdNR-f1          
  measObject CHOICE {                                                                                                                                                    
  measObjectNR SEQUENCE {                                                                                                                                                
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                              
  absThreshSS-BlocksConsolidation                                                            Not present                                                                 
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2                    
  measObjectId                                                                               2                                                MeasObjectIdUTRA-FDD-r16   
  measObject CHOICE {                                                                                                                                                    
  measObjectUTRA-FDD-r16                                                                     MeasObjectUTRA-FDD                               Table 8.1.3.2.6.3.3-2A     
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                     
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                    
  reportConfigId                                                                             1                                                                           
  reportConfig CHOICE {                                                                                                                                                  
  reportConfigInterRAT                                                                       ReportConfigInterRAT                             Table 8.1.3.2.6.3.3-3      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                     
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                    
  measId                                                                                     1                                                                           
  measObjectId                                                                               2                                                                           
  reportConfigId                                                                             1                                                                           
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  quantityConfig                                                                             QuantityConfig with condition INTER-RAT\_UTRA                               
  measGapConfig                                                                              MeasGapConfig                                                               
  }                                                                                                                                                                      

Table 8.1.3.2.6.3.3-2A: *MeasObjectUTRA-FDD (*Table 8.1.3.2.6.3.3-2*)*

  ----------------------------------------------------- ----------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-77A                                                       
  Information Element                                   Value/remark                              Comment   Condition
  MeasObjectUTRA-FDD-r16 ::= SEQUENCE {                                                                     
  carrierFreq-r16                                       ARFCN-ValueUTRA-FDD-r16 for UTRA Cell 5             
  }                                                                                                         
  ----------------------------------------------------- ----------------------------------------- --------- -----------

Table 8.1.3.2.6.3.3-3: *ReportConfigInterRAT* (Table 8.1.3.2.6.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-141 with condition EVENT\_B1\_UTRA                            
  ----------------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                                 Value/remark   Comment   Condition
  ReportConfigInterRAT ::= SEQUENCE {                                                                          
  reportType CHOICE {                                                                                          
  eventTriggered SEQUENCE {                                                                                    
  eventId CHOICE {                                                                                             
  eventB1-UTRA-FDD-r16 SEQUENCE {                                                                              
  b1-ThresholdUTRA-FDD-r16 CHOICE {                                                                            
  utra-FDD-RSCP-r16                                                                   61             -80dBm    
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            
  reportAmount                                                                        r1                       
  reportQuantityUTRA-FDD-r16 SEQUENCE {                                                                        
  cpich-RSCP                                                                          true                     
  cpich-EcN0                                                                          false                    
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            

Table 8.1.3.2.6.3.3-4: *MeasurementReport* (step 5, Table
8.1.3.2.6.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                          
  --------------------------------------------------- -------------- ----------------------- -----------
  Information Element                                 Value/remark   Comment                 Condition
  MeasurementReport ::= SEQUENCE {                                                           
  criticalExtensions CHOICE {                                                                
  measurementReport SEQUENCE {                                                               
  measResults                                         MeasResults    Table 8.1.3.2.6.3.3-5   
  }                                                                                          
  }                                                                                          
  }                                                                                          

Table 8.1.3.2.6.3.3-5: *MeasResults* (Table 8.1.3.2.6.3.3-4)

  ------------------------------------------------------------------------------------------- --------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-79 with condition B1\_UTRA                                                                    
  Information Element                                                                         Value/remark                            Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                                    
  measId                                                                                      1                                                 
  measResultNeighCells CHOICE {                                                                                                                 
  measResultListUTRA-FDD-r16 SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultUTRA-FDD-r16 {   1 entry                                           
  MeasResultUTRA-FDD-r16\[1\] SEQUENCE {                                                                                              entry 1   
  physCellId-r16                                                                              PhysCellIdUTRA-FDD-r16 of UTRA Cell 5             
  measResult-r16 SEQUENCE {                                                                                                                     
  utra-FDD-RSCP-r16                                                                           INTEGER (-5..91)                                  
  utra-FDD-EcN0-r16                                                                           Not present                                       
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  ------------------------------------------------------------------------------------------- --------------------------------------- --------- -----------

##### 8.1.3.2.7 Measurement configuration control and reporting / Inter-RAT measurements / Event B2 / NR to UTRA

##### 8.1.3.2.7.1 Test Purpose (TP) {#test-purpose-tp-66 .H6}

##### (1) {#section-118 .H6}

**with** { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B2 to measure neighbour UTRA cell is configured }

**ensure that** {

**when** { Entering condition 1 for event B2 is not met but Entering
condition 2 is met }

**then** { UE does not transmit any MeasurementReport }

}

##### (2) {#section-119 .H6}

**with** { UE is NR RRC\_CONNECTED state and inter-RAT measurement event
B2 to measure neighbour UTRA cell is configured }

**ensure that** {

**when** { Entering condition 1 and 2 for event B2 is met }

**then** { UE transmits a MeasurementReport }

}

##### 8.1.3.2.7.2 Conformance requirements {#conformance-requirements-66 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.4.1, 5.5.4.9 and
5.5.5.1. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

\[TS 38.331, clause 5.5.2.1\]

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

\[TS 38.331, clause 5.5.2.9\]

1\> if *gapFR1* is set to *setup*:

2\> if an FR1 measurement gap configuration is already setup, release
the FR1 measurement gap configuration;

2\> setup the FR1 measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> apply the specified timing advance *mgta* to the gap occurrences
calculated above (i.e. the UE starts the measurement *mgta* ms before
the gap subframe occurrences);

1\> else if *gapFR1* is set to *release*:

2\> release the FR1 measurement gap configuration;

1\> if *gapFR2* is set to *setup*:

2\> if an FR2 measurement gap configuration is already setup, release
the FR2 measurement gap configuration;

2\> setup the FR2 measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> apply the specified timing advance *mgta* to the gap occurrences
calculated above (i.e. the UE starts the measurement *mgta* ms before
the gap subframe occurrences);

1\> else if *gapFR2* is set to *release*:

2\> release the FR2 measurement gap configuration;

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> apply the specified timing advance *mgta* to the gap occurrences
calculated above (i.e. the UE starts the measurement *mgta* ms before
the gap subframe occurrences);

1\> else if *gapUE* is set to *release*:

2\> release the per UE measurement gap configuration.

\[TS 38.331, clause 5.5.4.1\]

3\> else if the corresponding *measObject* concerns UTRA-FDD:

4\> if *eventB1-UTRA-FDD* or *eventB2-UTRA-FDD* is configured in the
corresponding *reportConfig*; or

4\> if corresponding *reportConfig* includes *reportType* set to
*periodical*:

5\> consider a neighbouring cell on the associated frequency to be
applicable when the concerned cell is included in the
*cellsToAddModList* defined within the *VarMeasConfig* for this
*measId*;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

> 3\> if *useT312* is set to *true* in *reportConfig* for this event:

4\> if T310 for the corresponding SpCell is running; and

4\> if T312 is not running for corresponding SpCell:

5\> start timer T312 for the corresponding SpCell with the value of T312
configured in the corresponding *measObjectNR*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

> 3\> if *useT312* is set to *true* in *reportConfig* for this event:

4\> if T310 for the corresponding SpCell is running; and

4\> if T312 is not running for corresponding SpCell:

5\> start timer T312 for the corresponding SpCell with the value of T312
configured in the corresponding *measObjectNR*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *true* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable transmission
resource pools for all measurements taken during *timeToTrigger* defined
for this event within the *VarMeasConfig*, while the *VarMeasReportList*
does not include an measurement reporting entry for this *measId* (a
first transmission resource pool triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned transmission resource pool(s) in the
*poolsTriggeredList* defined within the *VarMeasReportList* for this
*measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable transmission
resource pools not included in the *poolsTriggeredList* for all
measurements taken during *timeToTrigger* defined for this event within
the *VarMeasConfig* (a subsequent transmission resource pool triggers
the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned transmission resource pool(s) in the
*poolsTriggeredList* defined within the *VarMeasReportList* for this
*measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
applicable transmission resource pools included in the
*poolsTriggeredList* defined within the *VarMeasReportList* for this
*measId* for all measurements taken during *timeToTrigger* defined
within the *VarMeasConfig* for this event:

3\> remove the concerned transmission resource pool(s) in the
*poolsTriggeredList* defined within the *VarMeasReportList* for this
*measId*;

3\> if the *poolsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running

\[TS 38.331, clause 5.5.4.9\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition B2-1 and condition B2-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition B2-3 or condition B2-4, i.e. at least one of the two, as
specified below, is fulfilled;

Inequality B2-1 (Entering condition 1)

*Mp + Hys \< Thresh1*

Inequality B2-2 (Entering condition 2)

*Mn + Ofn + Ocn -- Hys \> Thresh2*

Inequality B2-3 (Leaving condition 1)

*Mp -- Hys \> Thresh1*

Inequality B2-4 (Leaving condition 2)

*Mn + Ofn + Ocn + Hys \< Thresh2*

The variables in the formula are defined as follows:

***Mp*** is the measurement result of the PCell, not taking into account
any offsets.

***Mn*** is the measurement result of the inter-RAT neighbour cell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the frequency of
the inter-RAT neighbour cell (i.e. *eutra-Q-OffsetRange* as defined
within the *measObjectEUTRA* corresponding to the frequency of the
inter-RAT neighbour cell, *utra-FDD-Q-OffsetRange* as defined within the
*measObjectUTRA-FDD* corresponding to the frequency of the neighbour
inter-RAT cell).

***Ocn*** is the cell specific offset of the inter-RAT neighbour cell
(i.e. *cellIndividualOffset* as defined within the *measObjectEUTRA*
corresponding to the neighbour inter-RAT cell), and set to zero if not
configured for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigInterRAT* for this event).

***Thresh1*** is the threshold parameter for this event (i.e.
b2*-Threshold1* as defined within *reportConfigInterRAT* for this
event).

***Thresh2*** is the threshold parameter for this event (i.e.
*b2-Threshold2EUTRA* as defined within *reportConfigInterRAT* for this
event, *b2-Threshold2UTRA-FDD* as defined for UTRA-FDD within
*reportConfigInterRAT* for this event).

***Mp*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and SINR.

***Mn*** is expressed in dBm or dB, depending on the measurement
quantity of the inter-RAT neighbour cell.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh1*** is expressed in the same unit as ***Mp***.

***Thresh2*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5.1\]

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

...

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

...

6\> if the *measObject* associated with this *measId* concerns UTRA-FDD
and if *ReportConfigInterRAT* includes the *reportQuantityUTRA-FDD*:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantityUTRA-FDD* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

##### 8.1.3.2.7.3 Test description {#test-description-66 .H6}

##### 8.1.3.2.7.3.1 Pre-test conditions {#pre-test-conditions-66 .H6}

##### System Simulator: {#system-simulator-43 .H6}

\- NR Cell 1 is the PCell, UTRA Cell 5 is the inter-RAT neighbour cell
of NR Cell 1.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-40 .H6}

\- None.

##### Preamble: {#preamble-42 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.3.2.7.3.2 Test procedure sequence {#test-procedure-sequence-67 .H6}

Table 8.1.3.2.7.3.2-1 and 8.1.3.2.7.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1, and UTRA Cell 5 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble, while the configuration marked \"T1\" is applied at
the point indicated in the Main behaviour description in Table
8.1.3.2.7.3.2-3.

Table 8.1.3.2.7.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+------------+------------+-----------+--------+------------+
|    | Parameter  | Unit       | NR Cell 1 | UTRA   | Remark     |
|    |            |            |           |        |            |
|    |            |            |           | Cell 5 |            |
+====+============+============+===========+========+============+
| T0 | SS/PBCH    | dBm/       | -78       | \-     | Power      |
|    |            |            |           |        | levels are |
|    | SSS EPRE   | SCS        |           |        | such that  |
|    |            |            |           |        | entry      |
|    |            |            |           |        | condition  |
|    |            |            |           |        | 1 for      |
|    |            |            |           |        | event B2   |
|    |            |            |           |        | is not     |
|    |            |            |           |        | satisfied  |
|    |            |            |           |        | and entry  |
|    |            |            |           |        | condition  |
|    |            |            |           |        | 2 is       |
|    |            |            |           |        | satisfied: |
|    |            |            |           |        |            |
|    |            |            |           |        | Mp + Hys   |
|    |            |            |           |        | \> Thresh1 |
|    |            |            |           |        | and        |
|    |            |            |           |        |            |
|    |            |            |           |        | Mn + Ofn + |
|    |            |            |           |        | Ocn - Hys  |
|    |            |            |           |        | \> Thresh2 |
+----+------------+------------+-----------+--------+------------+
|    | Cel        | dBm/3.84   | \-        | -73    |            |
|    | l-specific | MHz        |           |        |            |
|    | CPICH\_Ec  |            |           |        |            |
+----+------------+------------+-----------+--------+------------+
| T1 | SS/PBCH    | dBm/       | -85       | \-     | Power      |
|    |            |            |           |        | levels are |
|    | SSS EPRE   | SCS        |           |        | such that  |
|    |            |            |           |        | entry      |
|    |            |            |           |        | condition  |
|    |            |            |           |        | for event  |
|    |            |            |           |        | B2 is      |
|    |            |            |           |        | satisfied: |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mp + Hys  |
|    |            |            |           |        | \< Tresh1* |
|    |            |            |           |        | and        |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mn + Ofn  |
|    |            |            |           |        | + Ocn -    |
|    |            |            |           |        | Hys \>     |
|    |            |            |           |        | Thresh2*   |
+----+------------+------------+-----------+--------+------------+
|    | Cel        | dBm/3.84   | \-        | -73    |            |
|    | l-specific | MHz        |           |        |            |
|    | CPICH\_Ec  |            |           |        |            |
+----+------------+------------+-----------+--------+------------+

Table 8.1.3.2.7.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+------------+------------+-----------+--------+------------+
|    | Parameter  | Unit       | NR Cell 1 | UTRA   | Remark     |
|    |            |            |           |        |            |
|    |            |            |           | Cell 5 |            |
+====+============+============+===========+========+============+
| T0 | SS/PBCH    | dBm/       | -82       | \-     | Power      |
|    |            |            |           |        | levels are |
|    | SSS EPRE   | SCS        |           |        | such that  |
|    |            |            |           |        | entry      |
|    |            |            |           |        | condition  |
|    |            |            |           |        | 1 for      |
|    |            |            |           |        | event B2   |
|    |            |            |           |        | is not     |
|    |            |            |           |        | satisfied  |
|    |            |            |           |        | and entry  |
|    |            |            |           |        | condition  |
|    |            |            |           |        | 2 is       |
|    |            |            |           |        | satisfied: |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mp + Hys  |
|    |            |            |           |        | \> Thresh1 |
|    |            |            |           |        | and*       |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mn + Ofn  |
|    |            |            |           |        | + Ocn -    |
|    |            |            |           |        | Hys \>     |
|    |            |            |           |        | Thresh2*   |
+----+------------+------------+-----------+--------+------------+
|    | Cel        | dBm/3.84   | \-        | -60    |            |
|    | l-specific | MHz        |           |        |            |
|    | CPICH\_Ec  |            |           |        |            |
+----+------------+------------+-----------+--------+------------+
| T1 | SS/PBCH    | dBm/       | -100      | \-     | Power      |
|    |            |            |           |        | levels are |
|    | SSS EPRE   | SCS        |           |        | such that  |
|    |            |            |           |        | entry      |
|    |            |            |           |        | condition  |
|    |            |            |           |        | for event  |
|    |            |            |           |        | B2 is      |
|    |            |            |           |        | satisfied: |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mp + Hys  |
|    |            |            |           |        | \< Tresh1* |
|    |            |            |           |        | and        |
|    |            |            |           |        |            |
|    |            |            |           |        | *Mn + Ofn  |
|    |            |            |           |        | + Ocn -    |
|    |            |            |           |        | Hys \>     |
|    |            |            |           |        | Thresh2*   |
+----+------------+------------+-----------+--------+------------+
|    | Cel        | dBm/3.84   | \-        | -60    |            |
|    | l-specific | MHz        |           |        |            |
|    | CPICH\_Ec  |            |           |        |            |
+----+------------+------------+-----------+--------+------------+

Table 8.1.3.2.7.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                        Message Sequence   TP                                     Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                        U - S              Message                                          
  1    The SS transmits an RRCReconfiguration message including MeasConfig to setup inter-RAT measurement and reporting for event B2.                                   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an RRCReconfigurationComplete message.                                                                                                          \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE transmit a MeasurementReport message within the next 10s?                                                                                     \--\>              *NR RRC: MeasurementReport*            1         F
  4    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.2.7.3.2-1/2.                                                       \-                 *-*                                    \-        \-
  5    Check: Does the UE transmit a MeasurementReport message to report event B2 with the measured RSRP value for NR Cell 1 and measured RSCP value for UTRA cell 5?   \--\>              *NR RRC: MeasurementReport*            2         P

##### 8.1.3.2.7.3.3 Specific message contents {#specific-message-contents-58 .H6}

Table 8.1.3.2.7.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.2.7.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13, condition NR\_MEAS
  ------------------------------------------------------------------------

Table 8.1.3.2.7.3.3-2: *MeasConfig* (Table 8.1.3.2.7.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                      
  ------------------------------------------------------------------------------------------ ------------------------------------------------ -------------------------- -----------
  Information Element                                                                        Value/remark                                     Comment                    Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                              
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                                   
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                    
  measObjectId                                                                               1                                                MeasObjectIdNR-f1          
  measObject CHOICE {                                                                                                                                                    
  measObjectNR SEQUENCE {                                                                                                                                                
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                              
  absThreshSS-BlocksConsolidation                                                            Not present                                                                 
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2                    
  measObjectId                                                                               2                                                MeasObjectIdUTRA-FDD-r16   
  measObject CHOICE {                                                                                                                                                    
  measObjectUTRA-FDD-r16                                                                     MeasObjectUTRA-FDD                               Table 8.1.3.2.7.3.3-2A     
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                     
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                    
  reportConfigId                                                                             1                                                                           
  reportConfig CHOICE {                                                                                                                                                  
  reportConfigInterRAT                                                                       ReportConfigInterRAT                             Table 8.1.3.2.7.3.3-3      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                     
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                    
  measId                                                                                     1                                                                           
  measObjectId                                                                               2                                                                           
  reportConfigId                                                                             1                                                                           
  }                                                                                                                                                                      
  }                                                                                                                                                                      
  quantityConfig                                                                             QuantityConfig with condition INTER-RAT\_UTRA                               
  measGapConfig                                                                              MeasGapConfig                                                               
  }                                                                                                                                                                      

Table 8.1.3.2.7.3.3-2A: *MeasObjectUTRA-FDD (*Table 8.1.3.2.7.3.3-2*)*

  ----------------------------------------------------- ----------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-77A                                                       
  Information Element                                   Value/remark                              Comment   Condition
  MeasObjectUTRA-FDD-r16 ::= SEQUENCE {                                                                     
  carrierFreq-r16                                       ARFCN-ValueUTRA-FDD-r16 for UTRA Cell 5             
  }                                                                                                         
  ----------------------------------------------------- ----------------------------------------- --------- -----------

Table 8.1.3.2.7.3.3-3: *ReportConfigInterRAT* (Table 8.1.3.2.7.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-141 with condition EVENT\_B2\_UTRA                                                        
  ------------------------------------------------------------------------------------------------------------ -------------- ------------ -----------
  Information Element                                                                                          Value/remark   Comment      Condition
  ReportConfigInterRAT ::= SEQUENCE {                                                                                                      
  reportType CHOICE {                                                                                                                      
  eventTriggered SEQUENCE {                                                                                                                
  eventId CHOICE {                                                                                                                         
  eventB2-UTRA-FDD-r16 SEQUENCE {                                                                                                          
  b2-Threshold1-r16 SEQUENCE {                                                                                                             
  rsrp                                                                                                         73             -83dBm       FR1
                                                                                                               66 + ∆(NRf1)   -91dBm/SCS   FR2
  }                                                                                                                                        
  b2-Threshold2UTRA-FDD-r16 SEQUENCE {                                                                                                     
  utra-FDD-RSCP-r16                                                                                            58             -83dBm       
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  reportAmount                                                                                                 r1                          
  reportQuantityUTRA-FDD-r16 SEQUENCE {                                                                                                    
  cpich-RSCP                                                                                                   true                        
  cpich-EcN0                                                                                                   false                       
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  NOTE 1: ∆(NRf1) is derived based on calibration procedure defined in the TS 38.508-1 \[4\], clause 6.1.3.3                               

Table 8.1.3.2.7.3.3-4: *MeasurementReport* (step 5, Table
8.1.3.2.7.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                          
  --------------------------------------------------- -------------- ----------------------- -----------
  Information Element                                 Value/remark   Comment                 Condition
  MeasurementReport ::= SEQUENCE {                                                           
  criticalExtensions CHOICE {                                                                
  measurementReport SEQUENCE {                                                               
  measResults                                         MeasResults    Table 8.1.3.2.7.3.3-5   
  }                                                                                          
  }                                                                                          
  }                                                                                          

Table 8.1.3.2.7.3.3-5: *MeasResults* (Table 8.1.3.2.7.3.3-4)

  ------------------------------------------------------------------------------------------- --------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-79 with condition B2\_UTRA                                                                    
  Information Element                                                                         Value/remark                            Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                                    
  measId                                                                                      1                                                 
  measResultNeighCells CHOICE {                                                                                                                 
  measResultListUTRA-FDD-r16 SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultUTRA-FDD-r16 {   1 entry                                           
  MeasResultUTRA-FDD-r16\[1\] SEQUENCE {                                                                                              entry 1   
  physCellId-r16                                                                              PhysCellIdUTRA-FDD-r16 of UTRA Cell 5             
  measResult-r16 SEQUENCE {                                                                                                                     
  utra-FDD-RSCP-r16                                                                           INTEGER (-5..91)                                  
  utra-FDD-EcN0-r16                                                                           Not present                                       
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  ------------------------------------------------------------------------------------------- --------------------------------------- --------- -----------

##### 8.1.3.2.8 Measurement configuration control and reporting / Inter-RAT measurements / Periodic reporting / NR to UTRA

##### 8.1.3.2.8.1 Test Purpose (TP) {#test-purpose-tp-67 .H6}

##### (1) {#section-120 .H6}

**with** { UE is NR RRC\_CONNECTED state and periodic inter-RAT
measurement reporting of neighbour UTRA cells is configured }

**ensure that** {

**when** { The UE receives reference signal power of UTRA cell where
measurements are configured }

**then** { UE sends MeasurementReport message at regular intervals }

}

##### (2) {#section-121 .H6}

**with** { UE is NR RRC\_CONNECTED state with periodic measurement
reporting of UTRA cells ongoing }

**ensure that** {

**when** { The UE receives a RRCReconfiguration message removing the
measId of periodic reporting of NR cells }

**then** { UE stops sending MeasurementReport message for UTRA cells }

}

##### 8.1.3.2.8.2 Conformance requirements {#conformance-requirements-67 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.1, 5.5.4.1 and 5.5.5.1.
Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

\[TS 38.331, clause 5.5.2.1\]

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

\[TS 38.331, clause 5.5.2.9\]

1\> if *gapFR1* is set to *setup*:

2\> if an FR1 measurement gap configuration is already setup, release
the FR1 measurement gap configuration;

2\> setup the FR1 measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> apply the specified timing advance *mgta* to the gap occurrences
calculated above (i.e. the UE starts the measurement *mgta* ms before
the gap subframe occurrences);

1\> else if *gapFR1* is set to *release*:

2\> release the FR1 measurement gap configuration;

1\> if *gapFR2* is set to *setup*:

2\> if an FR2 measurement gap configuration is already setup, release
the FR2 measurement gap configuration;

2\> setup the FR2 measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> apply the specified timing advance *mgta* to the gap occurrences
calculated above (i.e. the UE starts the measurement *mgta* ms before
the gap subframe occurrences);

1\> else if *gapFR2* is set to *release*:

2\> release the FR2 measurement gap configuration;

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> apply the specified timing advance *mgta* to the gap occurrences
calculated above (i.e. the UE starts the measurement *mgta* ms before
the gap subframe occurrences);

1\> else if *gapUE* is set to *release*:

2\> release the per UE measurement gap configuration.

\[TS 38.331, clause 5.5.4.1\]

3\> else if the corresponding *measObject* concerns UTRA-FDD:

4\> if *eventB1-UTRA-FDD* or *eventB2-UTRA-FDD* is configured in the
corresponding *reportConfig*; or

4\> if corresponding *reportConfig* includes *reportType* set to
*periodical*:

5\> consider a neighbouring cell on the associated frequency to be
applicable when the concerned cell is included in the
*cellsToAddModList* defined within the *VarMeasConfig* for this
*measId*;

...

2\> else if the *purpose* is included and set to *reportStrongestCells,*
*reportStrongestCellsForSON*, *reportLocation or sidelink* and if a
(first) measurement result is available:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> if the *purpose* is set to *reportStrongestCells* and
*reportStrongestCSI-RSs* is not included:

4\> if the *triggerType* is set to *periodical* and the corresponding
*reportConfig* includes the *ul-DelayConfig*:

5\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after a first measurement result is provided by lower
layers;

...

4\> else if the *reportAmount* exceeds 1:

5\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after the quantity to be reported becomes available for the
PCell;

4\> else (i.e. the *reportAmount* is equal to 1):

5\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after the quantity to be reported becomes available for the
PCell and for the strongest cell among the applicable cells, or becomes
available for the pair of PCell and the PSCell in case of SSTD
measurements, or becomes available for each requested pair of PCell and
NR cell or the maximal measurement reporting delay as specified in TS
38.133 \[X, 8.17.2.3\] in case of SFTD measurements;

...

3\> else:

4\> initiate the measurement reporting procedure, as specified in 5.5.5,
when it has determined the strongest cells on the associated frequency;

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

...

2\> upon expiry of the T321 for this *measId*:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

NOTE 2: The UE does not stop the periodical reporting with *triggerType*
set to *event* or to *periodical* while the corresponding measurement is
not performed due to the PCell RSRP being equal to or better than
*s-Measure* or due to the measurement gap not being setup.

NOTE 3: If the UE is configured with DRX, the UE may delay the
measurement reporting for event triggered and periodical triggered
measurements until the Active Time, which is defined in TS 36.321 \[6\].

\[TS 38.331, clause 5.5.5.1\]

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

...

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

...

6\> if the *measObject* associated with this *measId* concerns UTRA-FDD
and if *ReportConfigInterRAT* includes the *reportQuantityUTRA-FDD*:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantityUTRA-FDD* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

##### 8.1.3.2.8.3 Test description {#test-description-67 .H6}

##### 8.1.3.2.8.3.1 Pre-test conditions {#pre-test-conditions-67 .H6}

##### System Simulator: {#system-simulator-44 .H6}

\- NR Cell 1 is the PCell, UTRA Cell 5 is the inter-RAT neighbour cell
of NR Cell 1.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-41 .H6}

\- None.

##### Preamble: {#preamble-43 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.3.2.8.3.2 Test procedure sequence {#test-procedure-sequence-68 .H6}

Table 8.1.3.2.8.3.2-1 and 8.1.3.2.8.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1, and UTRA Cell 5 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble, while the configuration marked \"T1\" is applied at
the point indicated in the Main behaviour description in Table
8.1.3.2.8.3.2-3.

Table 8.1.3.2.8.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-------------------------+---------------+-----------+--------+--------+
|    | Parameter               | Unit          | NR Cell 1 | UTRA   | Remark |
|    |                         |               |           |        |        |
|    |                         |               |           | Cell 5 |        |
+====+=========================+===============+===========+========+========+
| T0 | SS/PBCH                 | dBm/          | -78       | \-     |        |
|    |                         |               |           |        |        |
|    | SSS EPRE                | SCS           |           |        |        |
+----+-------------------------+---------------+-----------+--------+--------+
|    | Cell-specific CPICH\_Ec | dBm/3.84 MkHz | \-        | Off    |        |
+----+-------------------------+---------------+-----------+--------+--------+
| T1 | SS/PBCH                 | dBm/          | -78       | \-     |        |
|    |                         |               |           |        |        |
|    | SSS EPRE                | SCS           |           |        |        |
+----+-------------------------+---------------+-----------+--------+--------+
|    | Cell-specific CPICH\_Ec | dBm/3.84 MkHz | \-        | -85    |        |
+----+-------------------------+---------------+-----------+--------+--------+

Table 8.1.3.2.8.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+-------------------------+---------------+-----------+--------+--------+
|    | Parameter               | Unit          | NR Cell 1 | UTRA   | Remark |
|    |                         |               |           |        |        |
|    |                         |               |           | Cell 5 |        |
+====+=========================+===============+===========+========+========+
| T0 | SS/PBCH                 | dBm/          | -82       | \-     |        |
|    |                         |               |           |        |        |
|    | SSS EPRE                | SCS           |           |        |        |
+----+-------------------------+---------------+-----------+--------+--------+
|    | Cell-specific CPICH\_Ec | dBm/3.84 MkHz | \-        | Off    |        |
+----+-------------------------+---------------+-----------+--------+--------+
| T1 | SS/PBCH                 | dBm/          | -82       | \-     |        |
|    |                         |               |           |        |        |
|    | SSS EPRE                | SCS           |           |        |        |
+----+-------------------------+---------------+-----------+--------+--------+
|    | Cell-specific CPICH\_Ec | dBm/3.84 MkHz | \-        | -60    |        |
+----+-------------------------+---------------+-----------+--------+--------+

Table 8.1.3.2.8.3.2-3: Main behaviour

  St   Procedure                                                                                                                            Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                            U - S              Message                                          
  1    The SS transmits an RRCReconfiguration message including measConfig to setup inter RAT measurements and reporting for UTRA cells.    \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an RRCReconfigurationComplete message.                                                                              \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    The SS changes UTRA Cell 5 parameters according to the row \"T1\".                                                                   \-                 *-*                                    \-        \-
  4    Void                                                                                                                                 \-                 *-*                                    \-        \-
  5    Check: Does the UE transmit at least 3 *MeasurementReport* messages on NR Cell 1 to perform periodical reporting for UTRA Cell 5?    \--\>              *NR RRC: MeasurementReport*            1         P
  6    The SS transmits an *RRCReconfiguration* message including *measConfig* to remove the measId of periodic reporting of UTRA cell 5.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  7    The UE transmits an RRCReconfigurationComplete message.                                                                              \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  8    Check: Does the UE transmit a *MeasurementReport* message in the next 10s?                                                           \-                 *-*                                    2         F

##### 8.1.3.2.8.3.3 Specific message contents {#specific-message-contents-59 .H6}

Table 8.1.3.2.8.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.2.8.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-13, condition NR\_MEAS
  ------------------------------------------------------------------------

Table 8.1.3.2.8.3.3-2: *MeasConfig* (Table 8.1.3.2.8.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                                                                           
  ------------------------------------------------------------------------------------------ ----------------------------------------------------------------------------------------------------- -------------------------- -----------
  Information Element                                                                        Value/remark                                                                                          Comment                    Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                                                                                   
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                                                                                        
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                                                                               entry 1                    
  measObjectId                                                                               1                                                                                                     MeasObjectIdNR-f1          
  measObject CHOICE {                                                                                                                                                                                                         
  measObjectNR SEQUENCE {                                                                                                                                                                                                     
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                                                                                   
  absThreshSS-BlocksConsolidation                                                            Not present                                                                                                                      
  }                                                                                                                                                                                                                           
  }                                                                                                                                                                                                                           
  }                                                                                                                                                                                                                           
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                                                                               entry 2                    
  measObjectId                                                                               2                                                                                                     MeasObjectIdUTRA-FDD-r16   
  measObject CHOICE {                                                                                                                                                                                                         
  measObjectUTRA-FDD-r16                                                                     MeasObjectUTRA-FDD-r16                                                                                                           
  }                                                                                                                                                                                                                           
  }                                                                                                                                                                                                                           
  }                                                                                                                                                                                                                           
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                                                                                          
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                                                                             entry 1                    
  reportConfigId                                                                             1                                                                                                                                
  reportConfig                                                                               ReportConfigInterRAT specified in TS 38.508-1 \[4\] Table 4.6.3-141 with condition PERIODICAL\_UTRA                              
  }                                                                                                                                                                                                                           
  }                                                                                                                                                                                                                           
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                                                                          
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                                                                                   entry 1                    
  measId                                                                                     1                                                                                                                                
  measObjectId                                                                               2                                                                                                                                
  reportConfigId                                                                             1                                                                                                                                
  }                                                                                                                                                                                                                           
  }                                                                                                                                                                                                                           
  quantityConfig                                                                             QuantityConfig with condition INTER-RAT\_UTRA                                                                                    
  measGapConfig                                                                              MeasGapConfig                                                                                                                    
  }                                                                                                                                                                                                                           

Table 8.1.3.2.8.3.3-3: Void

Table 8.1.3.2.8.3.3-4: Void

Table 8.1.3.2.8.3.3-5: *MeasurementReport* (step 5, Table
8.1.3.2.8.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                           
  --------------------------------------------------- -------------- ------------------------ -----------
  Information Element                                 Value/remark   Comment                  Condition
  MeasurementReport ::= SEQUENCE {                                                            
  criticalExtensions CHOICE {                                                                 
  measurementReport SEQUENCE {                                                                
  measResults                                         MeasResults    Table 8.1.3.2.8.3.3-5A   
  }                                                                                           
  }                                                                                           
  }                                                                                           

Table 8.1.3.2.8.3.3-5A: *MeasResults* (Table 8.1.3.2.8.3.3-5)

  ------------------------------------------------------------------------------------------- --------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-79                                                                                            
  Information Element                                                                         Value/remark                            Comment   Condition
  MeasResults ::= SEQUENCE {                                                                                                                    
  measId                                                                                      1                                                 
  measResultNeighCells CHOICE {                                                                                                                 
  measResultListUTRA-FDD-r16 SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultUTRA-FDD-r16 {   1 entry                                           
  MeasResultUTRA-FDD-r16\[1\] SEQUENCE {                                                                                              entry 1   
  physCellId-r16                                                                              PhysCellIdUTRA-FDD-r16 of UTRA Cell 5             
  measResult-r16 SEQUENCE {                                                                                                                     
  utra-FDD-RSCP-r16                                                                           INTEGER (-5..91)                                  
  utra-FDD-EcN0-r16                                                                           Not present                                       
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  ------------------------------------------------------------------------------------------- --------------------------------------- --------- -----------

Table 8.1.3.2.8.3.3-6: *MeasConfig* (step 6, Table 8.1.3.2.8.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-69                                       
  --------------------------------------------------------------- -------------- --------- -----------
  Information Element                                             Value/remark   Comment   Condition
  MeasConfig ::= SEQUENCE {                                                                
  measObjectToAddModList                                          Not present              
  reportConfigToAddModList                                        Not present              
  measIdToRemoveList SEQUENCE (SIZE (1..maxMeasId)) OF MeasId {   1 entry                  
  measId\[1\]                                                     1              entry 1   
  }                                                                                        
  quantityConfig                                                  Not present              
  }                                                                                        

#### 8.1.3.3 Measurement for self-optimized networks

##### 8.1.3.3.1 Measurement configuration control and reporting / CGI reporting of NR cell

##### 8.1.3.3.1.1 Test Purpose (TP) {#test-purpose-tp-68 .H6}

##### (1) {#section-122 .H6}

**with { UE in NR RRC\_CONNECTED state }**

**ensure that {**

**when { Neighbour NR cell becomes offset better than serving }**

**then { UE sends MeasurementReport for event A3 }**

**}**

##### (2) {#section-123 .H6}

**with { UE in NR RRC\_CONNECTED state }**

**ensure that {**

**when { UE is commanded to report the global cell identity of the
neighbour NR cell }**

**then { UE determines the global cell identity of the cell included in
the associated measurement object by acquiring the relevant system
information from the concerned cell and reports the global cell identity
in the MeasurementReport }**

**}**

##### 8.1.3.3.1.2 Conformance requirements {#conformance-requirements-68 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.3, 5.5.3.1, 5.5.4.8 and
5.5.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

1\> else *(MCG RRCReconfiguration)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

> ...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

...

\[TS 38.331, clause 5.5.2.3\]

...

The UE shall:

1\> for each *measId* included in the received *measIdToAddModList*:

2\> if an entry with the matching *measId* exists in the *measIdList*
within the *VarMeasConfig*:

3\> replace the entry with the value received for this *measId*;

2\> else:

3\> add a new entry for this *measId* within the *VarMeasConfig*;

2\> remove the measurement reporting entry for this *measId* from the
*VarMeasReportList*, if included;

2\> stop the periodical reporting timer or timer T321, whichever one is
running, and reset the associated information (e.g. *timeToTrigger*) for
this *measId*;

2\> if the *reportType* is set to *reportCGI* in the *reportConfig*
associated with this *measId*:

...

3\> if the *measObject* associated with this *measId* concerns NR:

4\> if the *measObject* associated with this *measId* concerns FR1:

5\> start timer T321 with the timer value set to 2 seconds for this
*measId*;

4\> if the *measObject* associated with this *measId* concerns FR2:

5\> start timer T321 with the timer value set to 16 seconds for this
*measId*.

\[TS 38.331, clause 5.5.3.1\]

The UE shall:

1\> whenever the UE has a *measConfig*, perform RSRP and RSRQ
measurements for each serving cell for which *servingCellMO* is
configured as follows:

2\> if the *reportConfig* associated with at least one *measId* included
in the *measIdList* within *VarMeasConfig* contains an *rsType* set to
*ssb* and *ssb-ConfigMobility* is configured in the *measObject*
indicated by the *servingCellMO*:

...

3\> derive serving cell measurement results based on SS/PBCH block, as
described in 5.5.3.3;

...

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the *reportType* for the associated *reportConfig* is set to
*reportCGI* and timer T321 is running:

3\> perform the corresponding measurements on the frequency and RAT
indicated in the associated *measObject* using available idle periods;

3\> if the cell indicated by *reportCGI* field for the associated
*measObject* is an NR cell and that indicated cell is broadcasting
*SIB1* (see TS 38.213 \[13\], clause 13):

4\> try to acquire *SIB1* in the concerned cell;

...

2\> if the *reportType* for the associated *reportConfig* is
*periodical* or *eventTriggered*:

...

3\> if the UE does not require measurement gaps to perform the concerned
measurements:

4\> if *s-MeasureConfig* is not configured

...

5\> if the *measObject* is associated to NR and the *rsType* is set to
*ssb*:

6\> if *reportQuantityRS-Indexes* and *maxNrofRS-IndexesToReport* for
the associated *reportConfig* are configured:

7\> derive layer 3 beam measurements only based on SS/PBCH block for
each measurement quantity indicated in *reportQuantityRS-Indexes*, as
described in 5.5.3.3a;

6\> derive cell measurement results based on SS/PBCH block for the
trigger quantity and each measurement quantity indicated in
*reportQuantityCell* using parameters from the associated *measObject*,
as described in 5.5.3.3;

...

2\> perform the evaluation of reporting criteria as specified in 5.5.4.

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

3\> if the corresponding *measObject* concerns NR:

...

4\> if the *eventA3* or *eventA5* is configured in the corresponding
*reportConfig*:

5\> if a serving cell is associated with a *measObjectNR* and neighbours
are associated with another *measObjectNR*, consider any serving cell
associated with the other *measObjectNR* to be a neighbouring cell as
well;

4\> if corresponding *reportConfig* includes *reportType* set to
*periodical*; or

4\> for measurement events other than *eventA1* or *eventA2*:

> ...

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
not included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

...

2\> else if the corresponding *reportConfig* includes a *reportType* set
to *reportCGI*:

3\> consider the cell detected on the associated *measObject* which has
a physical cell identity matching the value of the
*cellForWhichToReportCGI* included in the corresponding *reportConfig*
within the *VarMeasConfig* to be applicable;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

...

2\> if *reportType* is set to *reportCGI*:

3\> if the UE acquired the *SIB1* or *SystemInformationBlockType1* for
the requested cell; or

3\> if the UE detects that the requested NR cell is not transmitting
*SIB1* (see TS 38.213 \[13\], clause 13):

4\> stop timer T321;

4\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

4\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> upon the expiry of T321 for this *measId*:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

\[TS 38.331, clause 5.5.4.4\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A3-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A3-2, as specified below, is fulfilled;

1\> use the SpCell for *Mp*, *Ofp and Ocp*.

NOTE The cell(s) that triggers the event has reference signals indicated
in the *measObjectNR* associated to this event which may be different
from the NR SpCell *measObjectNR*.

Inequality A3-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Mp + Ofp + Ocp + Off*

Inequality A3-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Mp + Ofp + Ocp + Off*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the reference
signal of the neighbour cell (i.e. *offsetMO* as defined within
*measObjectNR* corresponding to the neighbour cell).

***Ocn*** is the cell specific offset of the neighbour cell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the frequency of the neighbour cell), and set to zero if not configured
for the neighbour cell.

***Mp*** is the measurement result of the SpCell, not taking into
account any offsets.

***Ofp*** is the measurement object specific offset of the SpCell (i.e.
*offsetMO* as defined within *measObjectNR* corresponding to the
SpCell).

***Ocp*** is the cell specific offset of the SpCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the SpCell), and is set to zero if not configured for the SpCell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Off*** is the offset parameter for this event (i.e. *a3-Offset* as
defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn***, ***Ocn***, ***Ofp***, ***Ocp***, ***Hys***, ***Off*** are
expressed in dB.

\[TS 38.331, clause 5.5.5\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> for each serving cell configured with *servingCellMO:*

2\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *rsType:*

3\> if the serving cell measurements based on the *rsType included in
the reportConfig* *that triggered the measurement report are available:*

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on the *rsType* included in the *reportConfig that triggered the
measurement report;*

2\> else*:*

3\> if SSB based serving cell measurements are available:

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on SSB;

3\> else if CSI-RS based serving cell measurements are available:

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on CSI-RS;

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

6\> if the *measObject* associated with this *measId* concerns NR:

7\> if *rsType* in the associated *reportConfig* is set to *ssb*:

8\> set *resultsSSB-Cell* within the *measResult* to include the SS/PBCH
block based quantity(ies) indicated in the *reportQuantityCell* within
the concerned *reportConfig*, in decreasing order of the sorting
quantity, determined as specified in 5.5.5.3, i.e. the best cell is
included first;

...

2\> else:

3\> if the cell indicated by *cellForWhichToReportCGI* is an NR cell:

4\> if *plmn-IdentityInfoList* of the *cgi-Info* for the concerned cell
has been obtained:

5\> include the *plmn-IdentityInfoList* including *plmn-IdentityList*,
*trackingAreaCode* (if available), *ranac* (if available) and
*cellIdentity* for each entry of the *plmn-IdentityInfoList*;

5\> include *frequencyBandList* if available;

4\> else if *MIB* indicates the *SIB1* is not broadcast:

5\> include the *noSIB1* including the *ssb-SubcarrierOffset* and
*pdcch-ConfigSIB1* obtained from *MIB* of the concerned cell;

> ...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.3.1.3 Test description {#test-description-68 .H6}

##### 8.1.3.3.1.3.1 Pre-test conditions {#pre-test-conditions-68 .H6}

##### System Simulator: {#system-simulator-45 .H6}

\- NR Cell 1 is the PCell, NR Cell 2 is the intra-frequency neighbour
cell of NR Cell 1.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-42 .H6}

\- None.

##### Preamble: {#preamble-44 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.3.3.1.3.2 Test procedure sequence {#test-procedure-sequence-69 .H6}

Table 8.1.3.3.1.3.2-1 and 8.1.3.3.1.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1, and NR Cell 2 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble, while the configuration marked \"T1\" is applied at
the point indicated in the Main behaviour description in Table
8.1.3.3.1.3.2-3.

Table 8.1.3.3.1.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-----------+------+-----------+-----------+------------+
|    | Parameter | Unit | NR Cell 1 | NR Cell 2 | Remark     |
+====+===========+======+===========+===========+============+
| T0 | SS/PBCH   | dBm/ | -85       | -91       | Power      |
|    |           |      |           |           | levels are |
|    | SSS EPRE  | SCS  |           |           | such that  |
|    |           |      |           |           | entry      |
|    |           |      |           |           | condition  |
|    |           |      |           |           | for event  |
|    |           |      |           |           | A3 is not  |
|    |           |      |           |           | satisfied: |
|    |           |      |           |           |            |
|    |           |      |           |           | *Mn + Ofn  |
|    |           |      |           |           | + Ocn --   |
|    |           |      |           |           | Hys \< Mp  |
|    |           |      |           |           | + Ofp +    |
|    |           |      |           |           | Ocp + Off* |
+----+-----------+------+-----------+-----------+------------+
| T1 | SS/PBCH   | dBm/ | -85       | -79       | Power      |
|    |           |      |           |           | levels are |
|    | SSS EPRE  | SCS  |           |           | such that  |
|    |           |      |           |           | entry      |
|    |           |      |           |           | condition  |
|    |           |      |           |           | for event  |
|    |           |      |           |           | A3 is      |
|    |           |      |           |           | satisfied: |
|    |           |      |           |           |            |
|    |           |      |           |           | *Mn + Ofn  |
|    |           |      |           |           | + Ocn --   |
|    |           |      |           |           | Hys \> Mp  |
|    |           |      |           |           | + Ofp +    |
|    |           |      |           |           | Ocp + Off* |
+----+-----------+------+-----------+-----------+------------+

Table 8.1.3.3.1.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+-----------+------+-----------+-----------+------------+
|    | Parameter | Unit | NR Cell 1 | NR Cell 2 | Remark     |
+====+===========+======+===========+===========+============+
| T0 | SS/PBCH   | dBm/ | -91       | -100      | Power      |
|    |           |      |           |           | levels are |
|    | SSS EPRE  | SCS  |           |           | such that  |
|    |           |      |           |           | entry      |
|    |           |      |           |           | condition  |
|    |           |      |           |           | for event  |
|    |           |      |           |           | A3 is not  |
|    |           |      |           |           | satisfied: |
|    |           |      |           |           |            |
|    |           |      |           |           | *Mn + Ofn  |
|    |           |      |           |           | + Ocn --   |
|    |           |      |           |           | Hys \< Mp  |
|    |           |      |           |           | + Ofp +    |
|    |           |      |           |           | Ocp + Off* |
+----+-----------+------+-----------+-----------+------------+
| T1 | SS/PBCH   | dBm/ | -91       | -82       | Power      |
|    |           |      |           |           | levels are |
|    | SSS EPRE  | SCS  |           |           | such that  |
|    |           |      |           |           | entry      |
|    |           |      |           |           | condition  |
|    |           |      |           |           | for event  |
|    |           |      |           |           | A3 is      |
|    |           |      |           |           | satisfied: |
|    |           |      |           |           |            |
|    |           |      |           |           | *Mn + Ofn  |
|    |           |      |           |           | + Ocn --   |
|    |           |      |           |           | Hys \> Mp  |
|    |           |      |           |           | + Ofp +    |
|    |           |      |           |           | Ocp + Off* |
+----+-----------+------+-----------+-----------+------------+

Table 8.1.3.3.1.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                                            Message Sequence   TP                                     Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                            U -- S             Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup intra-frequency measurement and reporting for event A3.                                                             \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                            \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.3.1.3.2-1/2.                                                                                           \-                 *-*                                    \-        \-
  4    Check: Does the UE transmit a *MeasurementReport* message to report event A3 with the measured RSRP value for NR Cell 2?                                                                             \--\>              *NR RRC: MeasurementReport*            1         P
  5    The SS transmits an *RRCReconfiguration* message including *measConfig* including *reportCGI* for Cell 2 and sufficient idle periods for UE to acquire the relevant system information from Cell 2   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  6    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                            \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  7    Check: Does the UE transmit a *MeasurementReport* message with CGI of Cell 2 within 2 sec if Cell 2 is in FR1 (or within 16 sec if Cell 2 is in FR2)?                                                \--\>              *NR RRC: MeasurementReport*            2         P

##### 8.1.3.3.1.3.3 Specific message contents {#specific-message-contents-60 .H6}

Table 8.1.3.3.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.3.1.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.3.1.3.3-2: *CellGroupConfig-DRX* (Table 8.1.3.3.1.3.3-1)

  --------------------------------------------------------------------- --------------------- ----------------------- -----------
  Derivation Path: TS 508-1 \[4\], Table 4.6.3-19 with condition MEAS                                                 
  Information Element                                                   Value/remark          Comment                 Condition
  CellGroupConfig ::= SEQUENCE {                                                                                      
  mac-CellGroupConfig                                                   MAC-CellGroupConfig   Table 8.1.3.3.1.3.3-9   
  }                                                                                                                   
  --------------------------------------------------------------------- --------------------- ----------------------- -----------

Table 8.1.3.3.1.3.3-3: *MeasConfig-A3* (Table 8.1.3.3.1.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                         
  ------------------------------------------------------------------------------------------ ------------------------------------------------ ----------------------------- -----------
  Information Element                                                                        Value/remark                                     Comment                       Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                                 
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                                        
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                       
  measObjectId                                                                               1                                                                              
  measObject CHOICE {                                                                                                                                                       
  measObjectNR SEQUENCE {                                                                                                                                                   
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                                 
  absThreshSS-BlocksConsolidation                                                            Not present                                                                    
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   2 entries                                                                      
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                       
  reportConfigId                                                                             1                                                                              
  reportConfig CHOICE {                                                                                                                                                     
  reportConfigNR                                                                             ReportConfigNR-A3                                Table 8.1.3.3.1.3.3-4         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  ReportConfigToAddMod\[2\] SEQUENCE {                                                                                                        entry 2                       
  reportConfigId                                                                             2                                                                              
  reportConfig CHOICE {                                                                                                                                                     
  reportConfigNR                                                                             ReportConfigNR-CGI                               Table 8.1.3.3.1.3.3-5         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                        
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                       
  measId                                                                                     1                                                                              
  measObjectId                                                                               1                                                                              
  reportConfigId                                                                             1                                                reportConfigId for event A3   
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         

Table 8.1.3.3.1.3.3-4: *ReportConfigNR-A3 (Table 8.1.3.3.1.3.3-2)*

  ----------------------------------------------------------------------------- -------------- ---------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with Condition EVENT\_A3                                   
  Information Element                                                           Value/remark   Comment          Condition
  ReportConfigNR::= SEQUENCE {                                                                                  
  reportType CHOICE {                                                                                           
  eventTriggered SEQUENCE {                                                                                     
  eventId CHOICE {                                                                                              
  eventA3 SEQUENCE {                                                                                            
  a3-Offset CHOICE {                                                                                            
  rsrp                                                                          2              1 dB(2\*0.5dB)   
  }                                                                                                             
  }                                                                                                             
  }                                                                                                             
  reportAmount                                                                  r1                              
  }                                                                                                             
  }                                                                                                             
  }                                                                                                             
  ----------------------------------------------------------------------------- -------------- ---------------- -----------

Table 8.1.3.3.1.3.3-5: *ReportConfigNR-CGI (Table 8.1.3.3.1.3.3-2)*

  ----------------------------------------------------------------------- ------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with Condition CGI                                       
  Information Element                                                     Value/remark              Comment   Condition
  ReportConfigNR::= SEQUENCE {                                                                                
  reportType CHOICE {                                                                                         
  reportCGI SEQUENCE {                                                                                        
  cellForWhichToReportCGI                                                 PhysCellId of NR Cell 2             
  }                                                                                                           
  }                                                                                                           
  }                                                                                                           
  ----------------------------------------------------------------------- ------------------------- --------- -----------

Table 8.1.3.3.1.3.3-6: *RRCReconfiguration* (step 5, Table
8.1.3.3.1.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                                                 
  --------------------------------------------------- --------------------- ----------------------- -----------
  Information Element                                 Value/remark          Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                 
  criticalExtensions CHOICE {                                                                       
  rrcReconfiguration SEQUENCE {                                                                     
  measConfig                                          MeasConfig-CGI        Table 8.1.3.3.1.3.3-7   
  nonCriticalExtension SEQUENCE {                                                                   
  masterCellGroup                                     CellGroupConfig-DRX   Table 8.1.3.3.1.3.3-2   
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 

Table 8.1.3.3.1.3.3-7: *MeasConfig-CGI* (Table 8.1.3.3.1.3.3-6)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                               
  --------------------------------------------------------------------------- -------------- ------------------------------------ -----------
  Information Element                                                         Value/remark   Comment                              Condition
  MeasConfig ::= SEQUENCE {                                                                                                       
  measObjectToAddModList                                                      Not present                                         
  reportConfigToAddModList                                                    Not present                                         
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {   1 entry                                             
  MeasIdToAddMod\[1\] SEQUENCE {                                                             entry 1                              
  measId                                                                      1                                                   
  measObjectId                                                                1                                                   
  reportConfigId                                                              2              reportConfigId for CGI measurement   
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               

Table 8.1.3.3.1.3.3-8: *MeasurementReport* (step 4 and step 7, Table
8.1.3.3.1.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                              
  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------
  Information Element                                                                      Value/remark                                Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                                    
  measurementReport SEQUENCE {                                                                                                                   
  measResults SEQUENCE {                                                                                                                         
  measId                                                                                   1                                                     
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1   
  servCellId                                                                               ServCellIndex of NR Cell 1                            
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 1             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell                                                                          Not Checked                                           Step 7
  resultsSSB-Cell SEQUENCE {                                                                                                                     Step 4
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     (0..127)                                              
  sinr                                                                                     (0..127)                                              pc\_ss\_SINR\_Meas
                                                                                           Not present                                           
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  measResultNeighCells CHOICE {                                                                                                                  
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                               
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1   
  physCellId                                                                               Physical layer cell identity of NR Cell 2             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell                                                                          Not present                                           Step 7
  resultsSSB-Cell SEQUENCE {                                                                                                                     Step 4
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     (0..127)                                              
  sinr                                                                                     (0..127)                                              pc\_ss\_SINR\_Meas
  }                                                                                                                                              
  resultsCSI-RS-Cell                                                                       Not present                                           
  }                                                                                                                                              
  rsIndexResults                                                                           Not present                                           
  }                                                                                                                                              
  cgi-Info                                                                                 Not present                                           Step 4
  cgi-Info SEQUENCE {                                                                                                                            Step 7
  plmn-IdentityInfoList                                                                    Set according to specific message content             
  frequencyBandList                                                                        Set according to specific message content             
  noSIB1                                                                                   Not present                                           
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

Table 8.1.3.3.1.3.3-9: *MAC-CellGroupConfig*

  ----------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-68 with Condition DRX                            
  Information Element                                                     Value/remark   Comment   Condition
  MAC-CellGroupConfig ::= SEQUENCE {                                                               
  drx-Config CHOICE {                                                                              
  setup SEQUENCE {                                                                                 
  drx-InactivityTimer                                                     ms100                    
  drx-LongCycleStartOffset CHOICE {                                                                
  ms640                                                                   0                        
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  ----------------------------------------------------------------------- -------------- --------- -----------

##### 8.1.3.3.2 Measurement configuration control and reporting / CGI reporting of E-UTRA cell

##### 8.1.3.3.2.1 Test Purpose (TP) {#test-purpose-tp-69 .H6}

##### (1) {#section-124 .H6}

**with { UE in NR RRC\_CONNECTED state }**

**ensure that {**

**when { UE detects that entering condition 1 and 2 for event B2 is met
}**

**then { UE transmits a MeasurementReport for event B2 }**

**}**

##### (2) {#section-125 .H6}

**with { UE in NR RRC\_CONNECTED state }**

**ensure that {**

**when { UE is commanded to report the global cell identity of the
neighbour E-UTRA cell }**

**then { UE determines the global cell identity of the cell included in
the associated measurement object by acquiring the relevant system
information from the concerned cell and reports the global cell identity
in the MeasurementReport }**

**}**

##### 8.1.3.3.2.2 Conformance requirements {#conformance-requirements-69 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.2.3, 5.5.3.1, 5.5.4.8 and
5.5.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

1\> else *(MCG RRCReconfiguration)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

> ...

\[TS 38.331, clause 5.5.2.1\]

...

The UE shall:

...

1\> if the received *measConfig* includes the *measObjectToAddModList*:

2\> perform the measurement object addition/modification procedure as
specified in 5.5.2.5;

...

1\> if the received *measConfig* includes the
*reportConfigToAddModList*:

2\> perform the reporting configuration addition/modification procedure
as specified in 5.5.2.7;

...

1\> if the received *measConfig* includes the *measIdToAddModList*:

2\> perform the measurement identity addition/modification procedure as
specified in 5.5.2.3;

1\> if the received *measConfig* includes the *measGapConfig*:

2\> perform the measurement gap configuration procedure as specified in
5.5.2.9;

...

\[TS 38.331, clause 5.5.2.3\]

...

The UE shall:

1\> for each *measId* included in the received *measIdToAddModList*:

2\> if an entry with the matching *measId* exists in the *measIdList*
within the *VarMeasConfig*:

3\> replace the entry with the value received for this *measId*;

2\> else:

3\> add a new entry for this *measId* within the *VarMeasConfig*;

2\> remove the measurement reporting entry for this *measId* from the
*VarMeasReportList*, if included;

2\> stop the periodical reporting timer or timer T321, whichever one is
running, and reset the associated information (e.g. *timeToTrigger*) for
this *measId*;

2\> if the *reportType* is set to *reportCGI* in the *reportConfig*
associated with this *measId*:

3\> if the *measObject* associated with this *measId* concerns E-UTRA:

4\> start timer T321 with the timer value set to 1 second for this
*measId*;

...

\[TS 38.331, clause 5.5.2.9\]

The UE shall:

...

1\> if *gapUE* is set to *setup*:

2\> if a per UE measurement gap configuration is already setup, release
the per UE measurement gap configuration;

2\> setup the per UE measurement gap configuration indicated by the
*measGapConfig* in accordance with the received *gapOffset*, i.e., the
first subframe of each gap occurs at an SFN and subframe meeting the
following condition:

SFN mod *T* = FLOOR(*gapOffset*/10);

subframe = *gapOffset* mod 10;

with *T* = MGRP/10 as defined in TS 38.133 \[14\];

2\> apply the specified timing advance *mgta* to the gap occurrences
calculated above (i.e. the UE starts the measurement *mgta* ms before
the gap subframe occurrences);

1\> else if *gapUE* is set to *release*:

2\> release the per UE measurement gap configuration.

\[TS 38.331, clause 5.5.3.1\]

The UE shall:

1\> whenever the UE has a *measConfig*, perform RSRP and RSRQ
measurements for each serving cell for which *servingCellMO* is
configured as follows:

2\> if the *reportConfig* associated with at least one *measId* included
in the *measIdList* within *VarMeasConfig* contains an *rsType* set to
*ssb* and *ssb-ConfigMobility* is configured in the *measObject*
indicated by the *servingCellMO*:

...

3\> derive serving cell measurement results based on SS/PBCH block, as
described in 5.5.3.3;

...

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the *reportType* for the associated *reportConfig* is set to
*reportCGI* and timer T321 is running:

3\> perform the corresponding measurements on the frequency and RAT
indicated in the associated *measObject* using available idle periods;

...

3\> if the cell indicated by *reportCGI* field is an E-UTRA cell:

4\> try to acquire *SystemInformationBlockType1* in the concerned cell;

2\> if the *reportType* for the associated *reportConfig* is
*periodical* or *eventTriggered*:

3\> if a measurement gap configuration is setup

...

4\> if *s-MeasureConfig* is not configured

...

5\> if the *measObject* is associated to E-UTRA:

6\> perform the corresponding measurements associated to neighbouring
cells on the frequencies indicated in the concerned *measObject*, as
described in 5.5.3.2;

...

2\> perform the evaluation of reporting criteria as specified in 5.5.4.

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

...

3\> else if the corresponding *measObject* concerns E-UTRA:

4\> if *eventB1* or *eventB2* is configured in the corresponding
*reportConfig*:

5\> consider a serving cell, if any, on the associated E-UTRA frequency
as neighbour cell;

4\> else:

5\> consider any neighbouring cell detected on the associated frequency
to be applicable when the concerned cell is not included in the
*excludedCellsToAddModListEUTRAN* defined within the *VarMeasConfig* for
this *measId*;

...

2\> else if the corresponding *reportConfig* includes a *reportType* set
to *reportCGI*:

3\> consider the cell detected on the associated *measObject* which has
a physical cell identity matching the value of the
*cellForWhichToReportCGI* included in the corresponding *reportConfig*
within the *VarMeasConfig* to be applicable;

...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

...

2\> upon expiry of the periodical reporting timer for this *measId*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

...

2\> if *reportType* is set to *reportCGI*:

3\> if the UE acquired the *SIB1* or *SystemInformationBlockType1* for
the requested cell

...

4\> stop timer T321;

4\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

4\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> upon the expiry of T321 for this *measId*:

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> initiate the measurement reporting procedure, as specified in 5.5.5.

\[TS 38.331, clause 5.5.4.9\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition B2-1 and condition B2-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition B2-3 or condition B2-4, i.e. at least one of the two, as
specified below, is fulfilled;

Inequality B2-1 (Entering condition 1)

*Mp + Hys \< Thresh1*

Inequality B2-2 (Entering condition 2)

*Mn + Ofn + Ocn -- Hys \> Thresh2*

Inequality B2-3 (Leaving condition 1)

*Mp -- Hys \> Thresh1*

Inequality B2-4 (Leaving condition 2)

*Mn + Ofn + Ocn + Hys \< Thresh2*

The variables in the formula are defined as follows:

***Mp*** is the measurement result of the PCell, not taking into account
any offsets.

***Mn*** is the measurement result of the inter-RAT neighbour cell, not
taking into account any offsets.

***Ofn*** is the measurement object specific offset of the frequency of
the inter-RAT neighbour cell (i.e. *eutra-Q-OffsetRange* as defined
within the *measObjectEUTRA* corresponding to the frequency of the
inter-RAT neighbour cell).

***Ocn*** is the cell specific offset of the inter-RAT neighbour cell
(i.e. *cellIndividualOffset* as defined within the *measObjectEUTRA*
corresponding to the neighbour inter-RAT cell), and set to zero if not
configured for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigInterRAT* for this event).

***Thresh1*** is the threshold parameter for this event (i.e.
b2*-Threshold1* as defined within *reportConfigInterRAT* for this
event).

***Thresh2*** is the threshold parameter for this event (i.e.
*b2-Threshold2EUTRA* as defined within *reportConfigInterRAT* for this
event).

***Mp*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and SINR.

***Mn*** is expressed in dBm or dB, depending on the measurement
quantity of the inter-RAT neighbour cell.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh1*** is expressed in the same unit as ***Mp***.

***Thresh2*** is expressed in the same unit as ***Mn***.

\[TS 38.331, clause 5.5.5\]

Figure 5.5.5.1-1: Measurement reporting

The purpose of this procedure is to transfer measurement results from
the UE to the network. The UE shall initiate this procedure only after
successful AS security activation.

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

1\> for each serving cell configured with *servingCellMO:*

2\> if the *reportConfig* associated with the *measId* that triggered
the measurement reporting includes *rsType:*

3\> if the serving cell measurements based on the *rsType included in
the reportConfig* *that triggered the measurement report are available:*

4\> set the *measResultServingCell* within *measResultServingMOList* to
include RSRP, RSRQ and the available SINR of the serving cell, derived
based on the *rsType* included in the *reportConfig that triggered the
measurement report;*

...

1\> set the *servCellId* within *measResultServingMOList* to include
each NR serving cell that is configured with *servingCellMO*, if any;

...

1\> if there is at least one applicable neighbouring cell to report:

2\> if the *reportType* is set to *eventTriggered* or *periodical*:

3\> set the *measResultNeighCells* to include the best neighbouring
cells up to *maxReportCells* in accordance with the following:

4\> if the *reportType* is set to *eventTriggered*:

5\> include the cells included in the *cellsTriggeredList* as defined
within the *VarMeasReportList* for this *measId*;

...

4\> for each cell that is included in the *measResultNeighCells*,
include the *physCellId*;

4\> if the *reportType* is set to *eventTriggered* or *periodical*:

5\> for each included cell, include the layer 3 filtered measured
results in accordance with the *reportConfig* for this *measId*, ordered
as follows:

...

6\> if the *measObject* associated with this *measId* concerns E-UTRA:

7\> set the *measResult* to include the quantity(ies) indicated in the
*reportQuantity* within the concerned *reportConfigInterRAT* in
decreasing order of the sorting quantity, determined as specified in
5.5.5.3, i.e. the best cell is included first;

2\> else:

...

3\> if the cell indicated by *cellForWhichToReportCGI* is an E-UTRA
cell:

4\> if all mandatory fields of the *cgi-Info-EPC* for the concerned cell
have been obtained:

5\> include in the *cgi-Info-EPC* the fields broadcasted in E-UTRA
*SystemInformationBlockType1* associated to EPC;

4\> if the UE is E-UTRA/5GC capable and all mandatory fields of the
*cgi-Info-5GC* for the concerned cell have been obtained:

5\> include in the *cgi-Info-5GC* the fields broadcasted in E-UTRA
*SystemInformationBlockType1* associated to 5GC;

4\> if the mandatory present fields of the *cgi-Info* for the cell
indicated by the *cellForWhichToReportCGI* in the associated
*measObject* have been obtained:

5\> include the *freqBandIndicator*;

5\> if the cell broadcasts the *multiBandInfoList*, include the
*multiBandInfoList*;

5\> if the cell broadcasts the *freqBandIndicatorPriority*, include the
*freqBandIndicatorPriority*;

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

...

1\> else:

2\> submit the *MeasurementReport* message to lower layers for
transmission, upon which the procedure ends.

##### 8.1.3.3.2.3 Test description {#test-description-69 .H6}

##### 8.1.3.3.2.3.1 Pre-test conditions {#pre-test-conditions-69 .H6}

##### System Simulator: {#system-simulator-46 .H6}

\- NR Cell 1 is the PCell, E-UTRA Cell 1 is the inter-RAT neighbour cell
of NR Cell 1.

\- NR Cell 1 is configured to operate in FR1 bands as defined in TS
38.508-1 \[4\] clause 6.2.3.

\- System information combination NR-6 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-43 .H6}

\- None.

##### Preamble: {#preamble-45 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.3.3.2.3.2 Test procedure sequence {#test-procedure-sequence-70 .H6}

Table 8.1.3.3.2.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1, and NR Cell 2 at various time instants of the
test execution. Row marked \"T0\" denotes the conditions after the
preamble, while the configuration marked \"T1\" is applied at the point
indicated in the Main behaviour description in Table 8.1.3.3.2.3.2-3.

Table 8.1.3.3.2.3.2-1: Time instances of cell power level and parameter
changes for conducted test environment

+----+-----------+-----------+-----------+-----------+-----------+
|    | Parameter | Unit      | NR Cell 1 | E-UTRA    | Remark    |
|    |           |           |           | Cell 1    |           |
|    |           |           |           |           |           |
|    |           |           |           | (DL only) |           |
+====+===========+===========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS   | -85       | \-        | Power     |
|    | SSS EPRE  |           |           |           | levels    |
|    |           |           |           |           | are such  |
|    |           |           |           |           | that      |
|    |           |           |           |           | entry     |
|    |           |           |           |           | condition |
|    |           |           |           |           | for event |
|    |           |           |           |           | B2 is not |
|    |           |           |           |           | s         |
|    |           |           |           |           | atisfied: |
|    |           |           |           |           |           |
|    |           |           |           |           | *Mp + Hys |
|    |           |           |           |           | \<        |
|    |           |           |           |           | Thresh1   |
|    |           |           |           |           | a*nd      |
|    |           |           |           |           |           |
|    |           |           |           |           | *Mn + Ofn |
|    |           |           |           |           | + Ocn -   |
|    |           |           |           |           | Hys \<    |
|    |           |           |           |           | Thresh2*  |
+----+-----------+-----------+-----------+-----------+-----------+
|    | Cell      | dBm/15kHz | \-        | -91       |           |
|    | -specific |           |           |           |           |
|    | RS EPRE   |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS   | -85       | \-        | Power     |
|    | SSS EPRE  |           |           |           | levels    |
|    |           |           |           |           | are such  |
|    |           |           |           |           | that      |
|    |           |           |           |           | entry     |
|    |           |           |           |           | condition |
|    |           |           |           |           | for event |
|    |           |           |           |           | B2 is     |
|    |           |           |           |           | s         |
|    |           |           |           |           | atisfied: |
|    |           |           |           |           |           |
|    |           |           |           |           | *Mp + Hys |
|    |           |           |           |           | \<        |
|    |           |           |           |           | Thresh1*  |
|    |           |           |           |           | and       |
|    |           |           |           |           |           |
|    |           |           |           |           | *Mn + Ofn |
|    |           |           |           |           | + Ocn -   |
|    |           |           |           |           | Hys \>    |
|    |           |           |           |           | Thresh2*  |
+----+-----------+-----------+-----------+-----------+-----------+
|    | Cell      | dBm/15kHz | \-        | -79       |           |
|    | -specific |           |           |           |           |
|    | RS EPRE   |           |           |           |           |
+----+-----------+-----------+-----------+-----------+-----------+

Table 8.1.3.3.2.3.2-2: Void

Table 8.1.3.3.2.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                                                          Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                          U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup inter-RAT measurement and reporting for event B2.                                                                                 \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                                          \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.3.3.2.3.2-1.                                                                                                           \-                 *-*                                    \-        \-
  4    Check: Does the UE transmit a *MeasurementReport* message to report event B2 with the measured RSRP value for E-UTRA Cell 1?                                                                                       \--\>              *NR RRC: MeasurementReport*            1         P
  5    The SS transmits an *RRCReconfiguration* message including *measConfig* including *reportCGI* for E-UTRA Cell 1 and sufficient idle periods for UE to acquire the relevant system information from E-UTRA Cell 1   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  6    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                                          \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  7    Check: Does the UE transmit a *MeasurementReport* message with CGI of E-UTRA Cell 1 within 1 sec?                                                                                                                  \--\>              *NR RRC: MeasurementReport*            2         P

##### 8.1.3.3.2.3.3 Specific message contents {#specific-message-contents-61 .H6}

Table 8.1.3.3.2.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.3.3.2.3.2-3)

  ---------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR\_MEAS
  ---------------------------------------------------------------------------

Table 8.1.3.3.2.3.3-2: *CellGroupConfig-DRX* (Table 8.1.3.3.2.3.3-1)

  --------------------------------------------------------------------- --------------------- ----------------------- -----------
  Derivation Path: TS 508-1 \[4\], Table 4.6.3-19 with condition MEAS                                                 
  Information Element                                                   Value/remark          Comment                 Condition
  CellGroupConfig ::= SEQUENCE {                                                                                      
  mac-CellGroupConfig                                                   MAC-CellGroupConfig   Table 8.1.3.3.2.3.3-9   
  }                                                                                                                   
  --------------------------------------------------------------------- --------------------- ----------------------- -----------

Table 8.1.3.3.2.3.3-3: *MeasConfig-B2* (Table 8.1.3.3.2.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                                         
  ------------------------------------------------------------------------------------------ ------------------------------------------------ ----------------------------- -----------
  Information Element                                                                        Value/remark                                     Comment                       Condition
  MeasConfig ::= SEQUENCE {                                                                                                                                                 
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                                      
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1                       
  measObjectId                                                                               1                                                                              
  measObject CHOICE {                                                                                                                                                       
  measObjectNR SEQUENCE {                                                                                                                                                   
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1                                 
  absThreshSS-BlocksConsolidation                                                            Not present                                                                    
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2                       
  measObjectId                                                                               2                                                                              
  measObject CHOICE {                                                                                                                                                       
  measObjectEUTRA                                                                            MeasObjectEUTRA                                  MO for E-UTRA Cell 1          
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   2 entries                                                                      
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1                       
  reportConfigId                                                                             1                                                                              
  reportConfig CHOICE {                                                                                                                                                     
  reportConfigInterRAT                                                                       ReportConfigInterRAT-B2                          Table 8.1.3.3.2.3.3-4         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  ReportConfigToAddMod\[2\] SEQUENCE {                                                                                                        entry 2                       
  reportConfigId                                                                             2                                                                              
  reportConfig CHOICE {                                                                                                                                                     
  reportConfigInterRAT                                                                       ReportConfigInterRAT-CGI                         Table 8.1.3.3.2.3.3-5         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                                        
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1                       
  measId                                                                                     1                                                                              
  measObjectId                                                                               2                                                                              
  reportConfigId                                                                             1                                                reportConfigId for event B2   
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  quantityConfig                                                                             QuantityConfig with Condition INTER-RAT                                        
  measGapConfig                                                                              MeasGapConfig                                                                  
  }                                                                                                                                                                         

Table 8.1.3.3.2.3.3-4: *ReportConfigInterRAT-B2 (Table 8.1.3.3.2.3.3-2)*

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-141 with Condition EVENT\_B2                            
  Information Element                                                           Value/remark   Comment   Condition
  ReportConfigInterRAT ::= SEQUENCE {                                                                    
  reportType CHOICE {                                                                                    
  eventTriggered SEQUENCE {                                                                              
  eventId CHOICE {                                                                                       
  eventB2 SEQUENCE {                                                                                     
  b2-Threshold1 CHOICE {                                                                                 
  rsrp                                                                          *77*           -79 dBm   
  }                                                                                                      
  b2-Threshold2EUTRA CHOICE {                                                                            
  rsrp                                                                          *56*           -85dBm    
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  reportAmount                                                                  r1                       
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.3.3.2.3.3-5: *ReportConfigInterRAT-CGI (Table
8.1.3.3.2.3.3-2)*

  ----------------------------------------------------------------------- ----------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-141 with Condition CGI                                                 
  Information Element                                                     Value/remark                        Comment   Condition
  ReportConfigInterRAT ::= SEQUENCE {                                                                                   
  reportType CHOICE {                                                                                                   
  reportCGI SEQUENCE {                                                                                                  
  cellForWhichToReportCGI                                                 EUTRA-PhysCellId of E-UTRA Cell 1             
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     
  ----------------------------------------------------------------------- ----------------------------------- --------- -----------

Table 8.1.3.3.2.3.3-6: *RRCReconfiguration* (step 5, Table
8.1.3.3.2.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                                                 
  --------------------------------------------------- --------------------- ----------------------- -----------
  Information Element                                 Value/remark          Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                 
  criticalExtensions CHOICE {                                                                       
  rrcReconfiguration SEQUENCE {                                                                     
  measConfig                                          MeasConfig-CGI        Table 8.1.3.3.2.3.3-7   
  nonCriticalExtension SEQUENCE {                                                                   
  masterCellGroup                                     CellGroupConfig-DRX   Table 8.1.3.3.2.3.3-2   
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 

Table 8.1.3.3.2.3.3-7: *MeasConfig-CGI* (Table 8.1.3.3.2.3.3-6)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                               
  --------------------------------------------------------------------------- -------------- ------------------------------------ -----------
  Information Element                                                         Value/remark   Comment                              Condition
  MeasConfig ::= SEQUENCE {                                                                                                       
  measObjectToAddModList                                                      Not present                                         
  reportConfigToAddModList                                                    Not present                                         
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {   1 entry                                             
  MeasIdToAddMod\[1\] SEQUENCE {                                                             entry 1                              
  measId                                                                      1                                                   
  measObjectId                                                                2                                                   
  reportConfigId                                                              2              reportConfigId for CGI measurement   
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               

Table 8.1.3.3.2.3.3-8: *MeasurementReport* (step 4 and step 7, Table
8.1.3.3.2.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                              
  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------
  Information Element                                                                      Value/remark                                Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                                    
  measurementReport SEQUENCE {                                                                                                                   
  measResults SEQUENCE {                                                                                                                         
  measId                                                                                   1                                                     
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1   
  servCellId                                                                               ServCellIndex of NR Cell 1                            
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 1             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell                                                                          Not Checked                                           Step 7
  resultsSSB-Cell SEQUENCE {                                                                                                                     Step 4
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     (0..127)                                              
  sinr                                                                                     Not present                                           
                                                                                           Not checked                                           pc\_ss\_SINR\_Meas
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  measResultNeighCells CHOICE {                                                                                                                  
  measResultListEUTRA SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultEUTRA {                                                                   
  MeasResultEUTRA\[1\] SEQUENCE {                                                                                                      entry 1   
  eutra-PhysCellId\[1\]                                                                    PhysCellId of E-UTRA Cell 1                           
  measResult\[1\] SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..97)                                               Step 4
                                                                                           Not present                                           Step 7
  rsrq                                                                                     (0..34)                                               Step 4
                                                                                           Not present                                           Step 7
  sinr                                                                                     Not present                                           
  }                                                                                                                                              
  cgi-Info                                                                                 Not present                                           Step 4
  cgi-Info SEQUENCE {                                                                                                                            Step 7
  cgi-info-EPC SEQUENCE {                                                                                                                        
  cgi-info-EPC-legacy                                                                      Set according to specific message content             
  cgi-info-EPC-list                                                                        Set according to specific message content             
  }                                                                                                                                              
  cgi-info-5GC                                                                             Not check                                             
  freqBandIndicator                                                                        Set according to specific message content             
  multiBandInfoList                                                                        Set according to specific message content             
  freqBandIndicatorPriority                                                                Set according to specific message content             
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

Table 8.1.3.3.2.3.3-9: *MAC-CellGroupConfig*

  ----------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-68 with Condition DRX                            
  Information Element                                                     Value/remark   Comment   Condition
  MAC-CellGroupConfig ::= SEQUENCE {                                                               
  drx-Config CHOICE {                                                                              
  setup SEQUENCE {                                                                                 
  drx-InactivityTimer                                                     ms100                    
  drx-LongCycleStartOffset CHOICE {                                                                
  ms640                                                                   0                        
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  ----------------------------------------------------------------------- -------------- --------- -----------

#### 8.1.3.4 Void

### 8.1.4 Handover

#### 8.1.4.1 Intra NR handover

##### 8.1.4.1.1 Void

##### 8.1.4.1.2 Intra NR handover / Success / Inter-frequency

##### 8.1.4.1.2.1 Test Purpose (TP) {#test-purpose-tp-70 .H6}

\(1\)

**with** { UE in NR RRC\_CONNECTED state and having performed the
inter-frequency measurements for the neighbour cell }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including a
reconfigurationWithSync with rach-ConfigDedicated }

**then** { UE performs handover to the target cell and transmits an
RRCReconfigurationComplete message }

}

\(2\)

**with** { UE in NR RRC\_CONNECTED state and having performed the
inter-frequency measurements for the neighbour cell }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including a
reconfigurationWithSync without rach-ConfigDedicated }

**then** { UE performs handover to the target cell and transmits an
RRCReconfigurationComplete message }

}

\(3\)

**with** { UE in NR RRC\_CONNECTED state}

**ensure that** {

**when** { UE receives an RRCReconfiguration message including
dedicatedSIB1-Delivery containing SIB1 information with a change of
trackingAreaCode }

**then** { UE reads the updated SIB1 information and sends an
RRCReconfigurationComplete message followed by registration on the new
tracking area }

}

\(4\)

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including a
reconfigurationWithSync and keySetChangeIndicator set to \'true\' in
MasterKeyUpdate for handover to the target cell }

**then** { UE performs handover to the target cell with security key
update and transmits an RRCReconfigurationComplete message }

}

##### 8.1.4.1.2.2 Conformance requirements {#conformance-requirements-70 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.3.5.5.1, 5.3.5.5.2, 5.5.4.4,
5.2.2.4.2 and 5.3.5.7. Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

1\> if the *RRCReconfiguration* includes the *masterKeyUpdate*:

2\> perform security key update procedure as specified in 5.3.5.7;

> ...
>
> 1\> if the *RRCReconfiguration* message includes the
> *radioBearerConfig*:
>
> 2\> perform the radio bearer configuration according to 5.3.5.6;
>
> ...
>
> 1\> if the *RRCReconfiguration* message includes the
> *dedicatedSIB1-Delivery*:
>
> 2\> perform the action upon reception of *SIB1* as specified in
> 5.2.2.4.2;

...1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

1\> if *reconfigurationWithSync* was included in *spCellConfig* of an
MCG or SCG, and when MAC of an NR cell group successfully completes a
random access procedure triggered above;

2\> stop timer T304 for that cell group;

2\> apply the parts of the CQI reporting configuration, the scheduling
request configuration and the sounding RS configuration that do not
require the UE to know the SFN of the respective target SpCell, if any;

2\> apply the parts of the measurement and the radio resource
configuration that require the UE to know the SFN of the respective
target SpCell (e.g. measurement gaps, periodic CQI reporting, scheduling
request configuration, sounding RS configuration), if any, upon
acquiring the SFN of that target SpCell;

2\> if the *reconfigurationWithSync* was included in *spCellConfig* of
an MCG:

3\> if T390 is running:

4\> stop timer T390 for all access categories;

4\> perform the actions as specified in 5.3.14.4.

3\> if *RRCReconfiguration* does not include *dedicatedSIB1-Delivery*
and

3\> if the active downlink BWP, which is indicated by the
*firstActiveDownlinkBWP-Id* for the target SpCell of the MCG, has a
common search space configured by *searchSpaceSIB1*:

4\> acquire the *SIB1*, which is scheduled as specified in TS 38.213
\[13\], of the target SpCell of the MCG;

4\> upon acquiring *SIB1*, perform the actions specified in clause
5.2.2.4.2;

2\> the procedure ends.

NOTE: The UE is only required to acquire broadcasted *SIB1* if the UE
can acquire it without disrupting unicast data reception, i.e. the
broadcast and unicast beams are quasi co-located.

\[TS 38.331, clause 5.3.5.5.1\]

The network configures the UE with Master Cell Group (MCG), and zero or
one Secondary Cell Group (SCG). In (NG)EN-DC, the MCG is configured as
specified in TS 36.331 \[10\], and for NE-DC, the SCG is configured as
specified in TS 36.331 \[10\]. The network provides the configuration
parameters for a cell group in the *CellGroupConfig* IE.

The UE performs the following actions based on a received
*CellGroupConfig* IE:

1\> if the *CellGroupConfig* contains the *spCellConfig* with
*reconfigurationWithSync*:

2\> perform Reconfiguration with sync according to 5.3.5.5.2;

2\> resume all suspended radio bearers and resume SCG transmission for
all radio bearers, if suspended;

...

1\> if the *CellGroupConfig* contains the mac-*CellGroupConfig*:

2\> configure the MAC entity of this cell group as specified in
5.3.5.5.5;

...

1\> if the *CellGroupConfig* contains the *spCellConfig*:

2\> configure the SpCell as specified in 5.3.5.5.7;

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the security is not activated, perform the actions upon going to
RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\' upon
which the procedure ends;

1\> stop timer T310 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> acquire the *MIB*, which is scheduled as specified in TS 38.213
\[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the MIB if the UE already has the
required timing information, or the timing information is not needed for
random access.

1\> reset the MAC entity of this cell group;

1\> consider the SCell(s) of this cell group, if configured, to be in
deactivated state;

1\> apply the value of the *newUE-Identity* as the C-RNTI for this cell
group;

1\> configure lower layers in accordance with the received
s*pCellConfigCommon*;

1\> configure lower layers in accordance with any additional fields, not
covered in the previous, if included in the received
*reconfigurationWithSync.*

\[TS 38.331, clause 5.5.4.4\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A3-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A3-2, as specified below, is fulfilled;

1\> use the SpCell for *Mp*, *Ofp and Ocp*.

NOTE The cell(s) that triggers the event has reference signals indicated
in the *measObjectNR* associated to this event which may be different
from the NR SpCell *measObjectNR*.

Inequality A3-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Mp + Ofp + Ocp + Off*

Inequality A3-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Mp + Ofp + Ocp + Off*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the reference
signal of the neighbour cell (i.e. *offsetMO* as defined within
*measObjectNR* corresponding to the neighbour cell).

***Ocn*** is the cell specific offset of the neighbour cell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the frequency of the neighbour cell), and set to zero if not configured
for the neighbour cell.

***Mp*** is the measurement result of the SpCell, not taking into
account any offsets.

***Ofp*** is the measurement object specific offset of the SpCell (i.e.
*offsetMO* as defined within *measObjectNR* corresponding to the
SpCell).

***Ocp*** is the cell specific offset of the SpCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the SpCell), and is set to zero if not configured for the SpCell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Off*** is the offset parameter for this event (i.e. *a3-Offset* as
defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn***, ***Ocn***, ***Ofp***, ***Ocp***, ***Hys***, ***Off*** are
expressed in dB.

\[TS 38.331, clause 5.2.2.4.2\]

Upon receiving the *SIB1* the UE shall:

1\> store the acquired *SIB1*;

1\> if the *cellAccessRelatedInfo* contains an entry with the
*PLMN-Identity* of the selected PLMN:

2\> in the remainder of the procedures use *plmn-IdentityList*,
*trackingAreaCode*, and *cellIdentity* for the cell as received in the
corresponding *PLMN-IdentityInfo* containing the selected PLMN;

1\> if in RRC\_CONNECTED while T311 is not running:

2\> disregard the *frequencyBandList*, if received, while in
RRC\_CONNECTED;

2\> forward the *cellIdentity* to upper layers;

2\> forward the *trackingAreaCode* to upper layers;

2\> apply the configuration included in the
*servingCellConfigCommonSIB*;

\[TS 38.331, clause 5.3.5.7\]

The UE shall:

1\> if UE is connected to E-UTRA/EPC:

2\> upon reception of *sk-Counter* as specified in TS 36.331 \[10\]:

3\> update the S-K~gNB~ key based on the K~eNB~ key and using the
received *sk-Counter* value, as specified in TS 33.401 \[30\];

3\> derive the K~RRCenc~ and K~UPenc~ keys as specified in TS 33.401
\[30\];

3\> derive the K~RRCint~ and K~UPint~ keys as specified in TS 33.401
\[30\].

1\> else:

2\> if the *nas-Container* is included in the received
*masterKeyUpdate*:

3\> forward the *nas-Container* to the upper layers;

2\> if the keySetChangeIndicator is set to *true*:

3\> derive or update the K~gNB~ key based on the K~AMF~ key, as
specified in TS 33.501 \[11\];

2\> else:

3\> derive or update the K~gNB~ key based on the current K~gNB~ key or
the NH, using the *nextHopChainingCount* value indicated in the received
*masterKeyUpdate*, as specified in TS 33.501 \[11\];

2\> store the *nextHopChainingCount* value;

2\> derive the keys associated with the K~gNB~ key as follows:

3\> if the securityAlgorithmConfig is included in SecurityConfig:

4\> derive the K~RRCenc~ and K~UPenc~ keys associated with the
*cipheringAlgorithm* indicated in the *securityAlgorithmConfig,* as
specified in TS 33.501 \[11\];

4\> derive the K~RRCint~ and K~UPint~ keys associated with the
*integrityProtAlgorithm* indicated in the *securityAlgorithmConfig,* as
specified in TS 33.501 \[11\];

3\> else:

4\> derive the K~RRCenc~ and K~UPenc~ keys associated with the current
*cipheringAlgorithm,* as specified in TS 33.501 \[11\];

4\> derive the K~RRCint~ and K~UPint~ keys associated with the current
*integrityProtAlgorithm,* as specified in TS 33.501 \[11\].

NOTE: Ciphering and integrity protection are optional to configure for
the DRBs.

##### 8.1.4.1.2.3 Test description {#test-description-70 .H6}

##### 8.1.4.1.2.3.1 Pre-test conditions {#pre-test-conditions-70 .H6}

##### System Simulator: {#system-simulator-47 .H6}

\- NR Cell 1 is the serving cell and NR Cell 3 is the inter-frequency
neighbour cell of NR Cell 1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-44 .H6}

> \- None.

##### Preamble: {#preamble-46 .H6}

> \- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A
> according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.
>
> \- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*)
> with UE test loop mode B on NR Cell 1 according to 38.508-1\[4\],
> clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.4.1.2.3.2 Test procedure sequence {#test-procedure-sequence-71 .H6}

Tables 8.1.4.1.2.3.2-1 and 8.1.4.1.2.3.2-2 illustrate the downlink power
levels to be applied for NR Cell 1 and NR Cell 3 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble, while the configuration marked \"T1\", T2 and
\"T3\", are applied at the point indicated in the Main behaviour
description in Table 8.1.4.1.2.3.2-3.

Table 8.1.4.1.2.3.2-1: Power levels in FR1

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 3 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -85       | -91    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied    |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -85       | -79    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | for NR Cell  |
|    |              |      |           |        | 3            |
+----+--------------+------+-----------+--------+--------------+
| T2 | SS/PBCH SSS  | dBm/ | -79       | -85    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | for NR Cell  |
|    |              |      |           |        | 1            |
+----+--------------+------+-----------+--------+--------------+
| T3 | SS/PBCH SSS  | dBm/ | -88       | -78    |              |
|    | EPRE         |      |           |        |              |
|    |              | SCS  |           |        |              |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.4.1.2.3.2-2: Power levels in FR2

+----+-------------+----------+--------+--------+-------------+
|    | Parameter   | Unit     | NR     | NR     | Remark      |
|    |             |          |        |        |             |
|    |             |          | Cell 1 | Cell 3 |             |
+====+=============+==========+========+========+=============+
| T0 | SS/PBCH SSS | dBm/ SCS | -91    | -100   | Power       |
|    | EPRE        |          |        |        | levels are  |
|    |             |          |        |        | such that   |
|    |             |          |        |        | entry       |
|    |             |          |        |        | condition   |
|    |             |          |        |        | for event   |
|    |             |          |        |        | A3 is not   |
|    |             |          |        |        | satisfied   |
+----+-------------+----------+--------+--------+-------------+
| T1 | SS/PBCH SSS | dBm/ SCS | -91    | -82    | Power       |
|    | EPRE        |          |        |        | levels are  |
|    |             |          |        |        | such that   |
|    |             |          |        |        | entry       |
|    |             |          |        |        | condition   |
|    |             |          |        |        | for event   |
|    |             |          |        |        | A3 is       |
|    |             |          |        |        | satisfied   |
|    |             |          |        |        | for NR Cell |
|    |             |          |        |        | 3           |
+----+-------------+----------+--------+--------+-------------+
| T2 | SS/PBCH SSS | dBm/ SCS | -82    | -91    | Power       |
|    | EPRE        |          |        |        | levels are  |
|    |             |          |        |        | such that   |
|    |             |          |        |        | entry       |
|    |             |          |        |        | condition   |
|    |             |          |        |        | for event   |
|    |             |          |        |        | A3 is       |
|    |             |          |        |        | satisfied   |
|    |             |          |        |        | for NR Cell |
|    |             |          |        |        | 1           |
+----+-------------+----------+--------+--------+-------------+
| T3 | SS/PBCH SSS | dBm/ SCS | -91    | -82    |             |
|    | EPRE        |          |        |        |             |
+----+-------------+----------+--------+--------+-------------+

Table 8.1.4.1.2.3.2-3: Main behaviour

+-----+--------------+--------------+--------------+---------+----+
| St  | Procedure    | Message      | TP           | Verdict |    |
|     |              | Sequence     |              |         |    |
+=====+==============+==============+==============+=========+====+
|     |              | U - S        | Message      |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1   | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCReco      |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message      |              |              |         |    |
|     | *including   |              |              |         |    |
|     | MeasConfig*  |              |              |         |    |
|     | to setup     |              |              |         |    |
|     | intra NR     |              |              |         |    |
|     | measurement  |              |              |         |    |
|     | and          |              |              |         |    |
|     | reporting    |              |              |         |    |
|     | for          |              |              |         |    |
|     | int          |              |              |         |    |
|     | er-frequency |              |              |         |    |
|     | event A3.    |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2   | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRC          |         |    |
|     | *RRC         |              | Reconfigurat |         |    |
|     | Reconfigurat |              | ionComplete* |         |    |
|     | ionComplete* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 3   | SS adjusts   | \-           | *-*          | \-      | \- |
|     | the          |              |              |         |    |
|     | c            |              |              |         |    |
|     | ell-specific |              |              |         |    |
|     | reference    |              |              |         |    |
|     | signal level |              |              |         |    |
|     | according to |              |              |         |    |
|     | row \"T1\".  |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 4   | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|     | transmits a  |              | Measur       |         |    |
|     | *Measur      |              | ementReport* |         |    |
|     | ementReport* |              |              |         |    |
|     | message to   |              |              |         |    |
|     | report event |              |              |         |    |
|     | A3 with the  |              |              |         |    |
|     | measured     |              |              |         |    |
|     | RSRP value   |              |              |         |    |
|     | for NR Cell  |              |              |         |    |
|     | 3.           |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 5   | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCReco      |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message      |              |              |         |    |
|     | *including   |              |              |         |    |
|     | reconfigura  |              |              |         |    |
|     | tionWithSync |              |              |         |    |
|     | with         |              |              |         |    |
|     | rach-Co      |              |              |         |    |
|     | nfigDedicate |              |              |         |    |
|     | d,keySetChan |              |              |         |    |
|     | geIndicator* |              |              |         |    |
|     | set to *true |              |              |         |    |
|     | and          |              |              |         |    |
|     | including    |              |              |         |    |
|     | n            |              |              |         |    |
|     | as-Container |              |              |         |    |
|     | IE to order  |              |              |         |    |
|     | the UE to    |              |              |         |    |
|     | perform      |              |              |         |    |
|     | int          |              |              |         |    |
|     | er-frequency |              |              |         |    |
|     | handover to  |              |              |         |    |
|     | NR Cell 3*   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6   | Check: Does  | \--\>        | *NR RRC:     | 1, 4    | P  |
|     | the UE       |              | RRC          |         |    |
|     | transmit an  |              | Reconfigurat |         |    |
|     | *RR          |              | ionComplete* |         |    |
|     | CReconfgurat |              |              |         |    |
|     | ionComplete* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 3?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6A  | Check: Does  | \-           | \-           | 1,4     | \- |
|     | the test     |              |              |         |    |
|     | result of    |              |              |         |    |
|     | generic test |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | subclause    |              |              |         |    |
|     | 4.9.1        |              |              |         |    |
|     | indicate     |              |              |         |    |
|     | that the UE  |              |              |         |    |
|     | is capable   |              |              |         |    |
|     | of           |              |              |         |    |
|     | exchanging   |              |              |         |    |
|     | IP data on   |              |              |         |    |
|     | DRB \#n      |              |              |         |    |
|     | associated   |              |              |         |    |
|     | with the     |              |              |         |    |
|     | first PDU    |              |              |         |    |
|     | session on   |              |              |         |    |
|     | NR Cell 3?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 7   | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCReco      |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message      |              |              |         |    |
|     | *including   |              |              |         |    |
|     | MeasConfig*  |              |              |         |    |
|     | to setup     |              |              |         |    |
|     | intra NR     |              |              |         |    |
|     | measurement  |              |              |         |    |
|     | and          |              |              |         |    |
|     | reporting    |              |              |         |    |
|     | for          |              |              |         |    |
|     | int          |              |              |         |    |
|     | er-frequency |              |              |         |    |
|     | event A3.    |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 8   | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRC          |         |    |
|     | *RRC         |              | Reconfigurat |         |    |
|     | Reconfigurat |              | ionComplete* |         |    |
|     | ionComplete* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 9   | SS adjusts   | \-           | *-*          | \-      | \- |
|     | the          |              |              |         |    |
|     | c            |              |              |         |    |
|     | ell-specific |              |              |         |    |
|     | reference    |              |              |         |    |
|     | signal level |              |              |         |    |
|     | according to |              |              |         |    |
|     | row \"T2\".  |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 10  | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|     | transmits a  |              | Measur       |         |    |
|     | *Measur      |              | ementReport* |         |    |
|     | ementReport* |              |              |         |    |
|     | message to   |              |              |         |    |
|     | report event |              |              |         |    |
|     | A3 with the  |              |              |         |    |
|     | measured     |              |              |         |    |
|     | RSRP value   |              |              |         |    |
|     | for NR Cell  |              |              |         |    |
|     | 1.           |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCReco      |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message      |              |              |         |    |
|     | *including   |              |              |         |    |
|     | reconfigura  |              |              |         |    |
|     | tionWithSync |              |              |         |    |
|     | without      |              |              |         |    |
|     | rach-Conf    |              |              |         |    |
|     | igDedicated, |              |              |         |    |
|     | keySetChan   |              |              |         |    |
|     | geIndicator* |              |              |         |    |
|     | set to *true |              |              |         |    |
|     | and          |              |              |         |    |
|     | including    |              |              |         |    |
|     | n            |              |              |         |    |
|     | as-Container |              |              |         |    |
|     | IE to order  |              |              |         |    |
|     | the UE to    |              |              |         |    |
|     | perform      |              |              |         |    |
|     | int          |              |              |         |    |
|     | er-frequency |              |              |         |    |
|     | handover to  |              |              |         |    |
|     | NR Cell 1*   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 12  | Check: Does  | \--\>        | *NR RRC:     | 2, 4    | P  |
|     | the UE       |              | RRC          |         |    |
|     | transmit an  |              | Reconfigurat |         |    |
|     | *RR          |              | ionComplete* |         |    |
|     | CReconfgurat |              |              |         |    |
|     | ionComplete* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 1?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 12A | Check: Does  | \-           | \-           | 2,4     | \- |
|     | the test     |              |              |         |    |
|     | result of    |              |              |         |    |
|     | generic test |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | subclause    |              |              |         |    |
|     | 4.9.1        |              |              |         |    |
|     | indicate     |              |              |         |    |
|     | that the UE  |              |              |         |    |
|     | is capable   |              |              |         |    |
|     | of           |              |              |         |    |
|     | exchanging   |              |              |         |    |
|     | IP data on   |              |              |         |    |
|     | DRB \#n      |              |              |         |    |
|     | associated   |              |              |         |    |
|     | with the     |              |              |         |    |
|     | first PDU    |              |              |         |    |
|     | session on   |              |              |         |    |
|     | NR Cell 1?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 13  | SS adjusts   | \-           | \-           | \-      | \- |
|     | the          |              |              |         |    |
|     | c            |              |              |         |    |
|     | ell-specific |              |              |         |    |
|     | reference    |              |              |         |    |
|     | signal level |              |              |         |    |
|     | according to |              |              |         |    |
|     | row \"T3\".  |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 14  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCReco     |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | including    |              |              |         |    |
|     | dedicatedS   |              |              |         |    |
|     | IB1-Delivery |              |              |         |    |
|     | containing   |              |              |         |    |
|     | SIB1 of NR   |              |              |         |    |
|     | Cell 3 to    |              |              |         |    |
|     | order the UE |              |              |         |    |
|     | to perform   |              |              |         |    |
|     | handover to  |              |              |         |    |
|     | NR Cell 3.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 15  | Check: Does  | \--\>        | NR RRC:      | 3       | P  |
|     | the UE       |              | *RRC         |         |    |
|     | transmit an  |              | Reconfigurat |         |    |
|     | *RRC         |              | ionComplete* |         |    |
|     | Reconfigurat |              |              |         |    |
|     | ionComplete* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 3?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 16  | Check: Does  | \--\>        | NR RRC:      | 3       | P  |
|     | UE transmit  |              | *ULInformat  |         |    |
|     | a            |              | ionTransfer* |         |    |
|     | REGISTRATION |              |              |         |    |
|     | REQUEST      |              | 5GMM:        |         |    |
|     | message to   |              | REGISTRATION |         |    |
|     | update the   |              | REQUEST      |         |    |
|     | registration |              |              |         |    |
|     | of the       |              |              |         |    |
|     | actual       |              |              |         |    |
|     | tracking     |              |              |         |    |
|     | area?        |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| \-  | EXCEPTION:   | \-           | \-           | \-      | \- |
|     | In parallel  |              |              |         |    |
|     | to the       |              |              |         |    |
|     | events       |              |              |         |    |
|     | described in |              |              |         |    |
|     | steps 16A to |              |              |         |    |
|     | 19, the      |              |              |         |    |
|     | steps        |              |              |         |    |
|     | specified in |              |              |         |    |
|     | Table        |              |              |         |    |
|     | 8.1          |              |              |         |    |
|     | .4.1.2.3.2-4 |              |              |         |    |
|     | may take     |              |              |         |    |
|     | place.       |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 16A | SS transmits | \-           | \-           | \-      | \- |
|     | SIB1 with    |              |              |         |    |
|     | TAC=2 on NR  |              |              |         |    |
|     | Cell 3       |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 17  | SS responds  | \<\--        | NR RRC:      | \-      | \- |
|     | with         |              | *DLInformat  |         |    |
|     | REGISTRATION |              | ionTransfer* |         |    |
|     | ACCEPT       |              |              |         |    |
|     | message with |              | 5GMM:        |         |    |
|     | TAC=2 in     |              | REGISTRATION |         |    |
|     | Tracking     |              | ACCEPT       |         |    |
|     | Area         |              |              |         |    |
|     | Identity     |              |              |         |    |
|     | List IE.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 18  | The UE sends | \--\>        | NR RRC:      | \-      | \- |
|     | a            |              | *ULInformat  |         |    |
|     | REGISTRATION |              | ionTransfer* |         |    |
|     | COMPLETE     |              |              |         |    |
|     | message.     |              | 5GMM:        |         |    |
|     |              |              | REGISTRATION |         |    |
|     |              |              | COMPLETE     |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 19  | Check: Does  | \-           | \-           | 3       | \- |
|     | the test     |              |              |         |    |
|     | result of    |              |              |         |    |
|     | generic test |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | subclause    |              |              |         |    |
|     | 4.9.1        |              |              |         |    |
|     | indicate     |              |              |         |    |
|     | that the UE  |              |              |         |    |
|     | is capable   |              |              |         |    |
|     | of           |              |              |         |    |
|     | exchanging   |              |              |         |    |
|     | IP data on   |              |              |         |    |
|     | DRB \#n      |              |              |         |    |
|     | associated   |              |              |         |    |
|     | with the     |              |              |         |    |
|     | first PDU    |              |              |         |    |
|     | session on   |              |              |         |    |
|     | NR Cell 3?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+

Table 8.1.4.1.2.3.2-4: Parallel behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The UE sends | \--\>        | NR RRC:      | \-      | \- |
|    | REGISTRATION |              | ULInforma    |         |    |
|    | REQUEST      |              | tionTransfer |         |    |
|    |              |              |              |         |    |
|    | NOTE: This   |              | 5GMM:        |         |    |
|    | request may  |              | REGISTRATION |         |    |
|    | be to        |              | REQUEST      |         |    |
|    | register for |              |              |         |    |
|    | TAC=1 or     |              |              |         |    |
|    | TAC=2        |              |              |         |    |
|    | depending    |              |              |         |    |
|    | upon when UE |              |              |         |    |
|    | reads the    |              |              |         |    |
|    | SIB1 after   |              |              |         |    |
|    | step 16      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.4.1.2.3.3 Specific message contents {#specific-message-contents-62 .H6}

Table 8.1.4.1.2.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.4.1.2.3.2-3)

  -----------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition MEAS
  -----------------------------------------------------------------------

Table 8.1.4.1.2.3.3-2: *MeasConfig* (Table 8.1.4.1.2.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                     
  Information Element                                                                        Value/remark                                     Comment   Condition
  MeasConfig ::= SEQUENCE {                                                                                                                             
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                  
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1   
  measObjectId                                                                               1                                                          
  measObject CHOICE {                                                                                                                                   
  measObjectNR SEQUENCE {                                                                                                                               
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 3             
  absThreshSS-BlocksConsolidation                                                            Not present                                                
  }                                                                                                                                                     
  }                                                                                                                                                     
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2   
  measObjectId                                                                               2                                                          
  measObject CHOICE {                                                                                                                                   
  measObjectNR SEQUENCE {                                                                                                                               
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1             
  absThreshSS-BlocksConsolidation                                                            Not present                                                
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                    
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1   
  reportConfigId                                                                             1                                                          
  reportConfig CHOICE {                                                                                                                                 
  reportConfigNR                                                                             ReportConfigNR-EventA3                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                    
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1   
  measId                                                                                     1                                                          
  measObjectId                                                                               1                                                          
  reportConfigId                                                                             1                                                          
  }                                                                                                                                                     
  }                                                                                                                                                     
  measGapConfig                                                                              MeasGapConfig                                              
  }                                                                                                                                                     
  ------------------------------------------------------------------------------------------ ------------------------------------------------ --------- -----------

Table 8.1.4.1.2.3.3-3: *ReportConfigNR-EventA3* (Table 8.1.4.1.2.3.3-2
and Table 8.1.4.1.2.3.3-8)

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------- --------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition EVENT\_A3                                                                                                                                                                                                                             
  Information Element                                                                                                                                                                                           Value/remark                    Comment                                                   Condition
  ReportConfigNR ::= SEQUENCE {                                                                                                                                                                                                                                                                           
  reportType CHOICE {                                                                                                                                                                                                                                                                                     
  eventTriggered SEQUENCE {                                                                                                                                                                                                                                                                               
  eventId CHOICE {                                                                                                                                                                                                                                                                                        
  eventA3 SEQUENCE {                                                                                                                                                                                                                                                                                      EVENT\_A3
  a3-Offset CHOICE {                                                                                                                                                                                                                                                                                      
  rsrp                                                                                                                                                                                                          6                               3dB                                                       FR1
                                                                                                                                                                                                                2 + Delta(NRf2) - Delta(NRf1)   a3-Offset value set to (2 + Delta(NRf2) - Delta(NRf1)).   FR2
  }                                                                                                                                                                                                                                                                                                       
  hysteresis                                                                                                                                                                                                    0                               0 dB                                                      
  timeToTrigger                                                                                                                                                                                                 ms640                                                                                     
  }                                                                                                                                                                                                                                                                                                       
  }                                                                                                                                                                                                                                                                                                       
  reportAmount                                                                                                                                                                                                  r1                                                                                        
  reportQuantityCell SEQUENCE {                                                                                                                                                                                                                                                                           
  rsrp                                                                                                                                                                                                          true                                                                                      
  rsrq                                                                                                                                                                                                          false                                                                                     
  sinr                                                                                                                                                                                                          false                                                                                     
  }                                                                                                                                                                                                                                                                                                       
  }                                                                                                                                                                                                                                                                                                       
  }                                                                                                                                                                                                                                                                                                       
  }                                                                                                                                                                                                                                                                                                       
  NOTE 1: Delta(NRf~2~) and Delta(NRf~1~) are derived based on calibration procedure defined in the TS 38.508-1 \[4\], clause 6.1.3.3 where Delta(NRf~1~) derived NR Cell1 and Delta(NRf~2~) derived NR Cell3                                                                                             
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------- --------------------------------------------------------- -----------

Table 8.1.4.1.2.3.3-4: *MeasurementReport* (step 4, Table
8.1.4.1.2.3.2-3)

  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                              
  Information Element                                                                      Value/remark                                Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                                    
  measurementReport SEQUENCE {                                                                                                                   
  measResults SEQUENCE {                                                                                                                         
  measId                                                                                   1                                                     
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1   
  servCellId                                                                               Cell index corresponding to NR Cell 1                 
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 1             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     (0..127)                                              
  sinr                                                                                     Not present                                           
                                                                                           Not checked                                           pc\_ss\_SINR\_Meas
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  measResultNeighCells CHOICE {                                                                                                                  
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                               
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1   
  physCellId                                                                               Physical layer cell identity of NR Cell 3             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     Not present                                           
  sinr                                                                                     Not present                                           
  }                                                                                                                                              
  resultsCSI-RS-Cell                                                                       Not present                                           
  }                                                                                                                                              
  rsIndexResults                                                                           Not present                                           
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------

Table 8.1.4.1.2.3.3-5: *RRCReconfiguration* (step 5, Table
8.1.4.1.2.3.2-3)

  -------------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                 
  Information Element                                                                    Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                    
  criticalExtensions CHOICE {                                                                                                                          
  rrcReconfiguration SEQUENCE {                                                                                                                        
  measConfig SEQUENCE {                                                                                                                                
  measObjectToRemoveList SEQUENCE (SIZE (1..maxNrofObjectId)) OF MeasObjectId {          2 entries                                                     
  measObjectId\[1\]                                                                      1                 entry 1                                     
  measObjectId\[2\]                                                                      2                 entry 2                                     
  }                                                                                                                                                    
  measIdToRemoveList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasId {                      1 entry                                                       
  measId\[1\]                                                                            1                 entry 1                                     
  }                                                                                                                                                    
  }                                                                                                                                                    
  nonCriticalExtension SEQUENCE {                                                                                                                      
  masterCellGroup                                                                        CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  masterKeyUpdate SEQUENCE {                                                                                                                           
  keySetChangeIndicator                                                                  true                                                          
  nextHopChainingCount                                                                   0                                                             
  nas-Container                                                                          NASContainer      Intra N1 mode NAS transparent container     
  }                                                                                                                                                    
  }                                                                                                                                                    
  }                                                                                                                                                    
  }                                                                                                                                                    
  }                                                                                                                                                    
  -------------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------

Table 8.1.4.1.2.3.3-6: *CellGroupConfig* (Table 8.1.4.1.2.3.3-5)

  ------------------------------------------------------------------------------------------ ----------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change and CFRA                                                       
  Information Element                                                                        Value/remark                              Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                 
  spCellConfig SEQUENCE {                                                                                                                        
  reconfigurationWithSync SEQUENCE {                                                                                                             
  spCellConfigCommon SEQUENCE {                                                              Same as default ServingCellConfigCommon             
  physCellId                                                                                 Physical cell Id of NR Cell 3                       
  }                                                                                                                                              
  rach-ConfigDedicated CHOICE {                                                                                                                  
  Uplink                                                                                     RACH-ConfigDedicated                                
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ------------------------------------------------------------------------------------------ ----------------------------------------- --------- -----------

Table 8.1.4.1.2.3.3-6A: NASContainer (Table 8.1.4.1.2.3.3-5, Table
8.1.4.1.2.3.3-10)

  Derivation Path: TS 24.501, table 9.11.2.6                                                                                                                                                                                                              
  -------------------------------------------- ---------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------- -----------
  Information Element                          Value/Remark                                                                                         Comment                                                                                               Condition
  Message authentication code                  The calculated value of MAC-I for this message.                                                      The value of MAC-I is calculated by SS using COUNT = 0xFFFFFFFF( as per TS 33.501\[20\], 6.9.2.3.3)   
  Type of ciphering algorithm                  Set according to PIXIT px\_NAS\_5GC\_CipheringAlgorithm for default ciphering algorithm                                                                                                                    
  Type of integrity protection algorithm       Set according to PIXIT px\_NAS\_5GC\_IntegrityAlgorithm for default integrity protection algorithm   This value should not be equal to the null integrity algorithm.                                       
  KACF                                         '1'B                                                                                                 a new K~AMF~ has been calculated by the network                                                       
  TSC                                          \'0\'B                                                                                               native security context (for KSI~AMF~)                                                                
  Key set identifier in 5G                     KSI~AMF~ that was created when the UE last registered to 5GCN                                                                                                                                              
  Sequence number                              The internal counter of the SS                                                                       eight least significant bits of the downlink NAS COUNT                                                

Table 8.1.4.1.2.3.3-7: *RRCReconfiguration* (step 7, Table
8.1.4.1.2.3.2-3)

  -----------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition MEAS
  -----------------------------------------------------------------------

Table 8.1.4.1.2.3.3-8: *MeasConfig* (Table 8.1.4.1.2.3.3-7)

  ------------------------------------------------------------------------------------------ ------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                     
  Information Element                                                                        Value/remark                                     Comment   Condition
  MeasConfig ::= SEQUENCE {                                                                                                                             
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                  
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1   
  measObjectId                                                                               1                                                          
  measObject CHOICE {                                                                                                                                   
  measObjectNR SEQUENCE {                                                                                                                               
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1             
  absThreshSS-BlocksConsolidation                                                            Not present                                                
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2   
  measObjectId                                                                               2                                                          
  measObject CHOICE {                                                                                                                                   
  measObjectNR SEQUENCE {                                                                                                                               
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 3             
  absThreshSS-BlocksConsolidation                                                            Not present                                                
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                    
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1   
  reportConfigId                                                                             1                                                          
  reportConfig CHOICE {                                                                                                                                 
  reportConfigNR                                                                             ReportConfigNR-EventA3                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                    
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1   
  measId                                                                                     1                                                          
  measObjectId                                                                               1                                                          
  reportConfigId                                                                             1                                                          
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  ------------------------------------------------------------------------------------------ ------------------------------------------------ --------- -----------

Table 8.1.4.1.2.3.3-9: *MeasurementReport* (step 10, Table
8.1.4.1.2.3.2-3)

  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                              
  Information Element                                                                      Value/remark                                Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                                    
  measurementReport SEQUENCE {                                                                                                                   
  measResults SEQUENCE {                                                                                                                         
  measId                                                                                   1                                                     
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1   
  servCellId                                                                               Cell index corresponding to NR Cell 3                 
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 3             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     (0..127)                                              
  sinr                                                                                     Not present                                           
                                                                                           Not checked                                           pc\_ss\_SINR\_Meas
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  measResultNeighCells CHOICE {                                                                                                                  
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                               
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1   
  physCellId                                                                               Physical layer cell identity of NR Cell 1             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     Not present                                           
  sinr                                                                                     Not present                                           
  }                                                                                                                                              
  resultsCSI-RS-Cell                                                                       Not present                                           
  }                                                                                                                                              
  rsIndexResults                                                                           Not present                                           
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------

Table 8.1.4.1.2.3.3-10: *RRCReconfiguration* (step 11, Table
8.1.4.1.2.3.2-3)

  -------------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                 
  Information Element                                                                    Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                    
  criticalExtensions CHOICE {                                                                                                                          
  rrcReconfiguration SEQUENCE {                                                                                                                        
  measConfig SEQUENCE {                                                                                                                                
  measObjectToRemoveList SEQUENCE (SIZE (1..maxNrofObjectId)) OF MeasObjectId {          2 entries                                                     
  measObjectId\[1\]                                                                      1                 entry 1                                     
  measObjectId\[2\]                                                                      2                 entry 2                                     
  }                                                                                                                                                    
  measIdToRemoveList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasId {                      1 entry                                                       
  measId\[1\]                                                                            1                 entry 1                                     
  }                                                                                                                                                    
  }                                                                                                                                                    
  nonCriticalExtension SEQUENCE {                                                                                                                      
  masterCellGroup                                                                        CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  masterKeyUpdate SEQUENCE {                                                                                                                           
  keySetChangeIndicator                                                                  true                                                          
  nextHopChainingCount                                                                   0                                                             
  nas-Container                                                                          NASContainer      Intra N1 mode NAS transparent container     
  }                                                                                                                                                    
  }                                                                                                                                                    
  }                                                                                                                                                    
  }                                                                                                                                                    
  }                                                                                                                                                    
  -------------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------

Table 8.1.4.1.2.3.3-11: *CellGroupConfig* (Table 8.1.4.1.2.3.3-10)

  --------------------------------------------------------------------------------- ----------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change                                                       
  Information Element                                                               Value/remark                              Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                        
  spCellConfig SEQUENCE {                                                                                                               
  reconfigurationWithSync SEQUENCE {                                                                                                    
  spCellConfigCommon SEQUENCE {                                                     Same as default ServingCellConfigCommon             
  physCellId                                                                        Physical cell Id of NR Cell 1                       
  }                                                                                                                                     
  rach-ConfigDedicated                                                              Not Present                                         
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  --------------------------------------------------------------------------------- ----------------------------------------- --------- -----------

Table 8.1.4.1.2.3.3-12: RRCReconfiguration (step 14, Table
8.1.4.1.2.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with condition RBConfig\_NoKeyChange                                                                 
  ----------------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------
  Information Element                                                                       Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                       
  criticalExtensions CHOICE {                                                                                                                             
  rrcReconfiguration SEQUENCE {                                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                                         
  masterCellGroup                                                                           CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  dedicatedSIB1-Delivery                                                                    SIB1              OCTET STRING (CONTAINING SIB1)              
  }                                                                                                                                                       
  }                                                                                                                                                       
  }                                                                                                                                                       
  }                                                                                                                                                       

Table 8.1.4.1.2.3.3-12A: *CellGroupConfig* (Table 8.1.4.1.2.3.3-12)

  --------------------------------------------------------------------------------- ----------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change                                                       
  Information Element                                                               Value/remark                              Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                        
  spCellConfig SEQUENCE {                                                                                                               
  reconfigurationWithSync SEQUENCE {                                                                                                    
  spCellConfigCommon SEQUENCE {                                                     Same as default ServingCellConfigCommon             
  physCellId                                                                        Physical cell Id of NR Cell 3                       
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  --------------------------------------------------------------------------------- ----------------------------------------- --------- -----------

Table 8.1.4.1.2.3.3-13: SIB1 (Table 8.1.4.1.2.3.3-12)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                                           
  ------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                 Value/remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                                          
  cellAccessRelatedInfo SEQUENCE {                                                             
  plmn-IdentityList SEQUENCE (SIZE (1..maxPLMN)) OF PLMN-Identity {   1 entry                  
  plmn-Identity\[1\]                                                                 entry 1   
  trackingAreaCode                                                    2                        
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            

Table 8.1.4.1.2.3.3-14: REGISTRATION REQUEST (step 16, Table
8.1.4.1.2.3.2-3)

  --------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.7.1-6 with condition MOBILITY                            
  Information Element                                                         Value/remark   Comment   Condition
  Last visited registered TAI                                                                          
  tac                                                                         1                        
  --------------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.4.1.2.3.3-15: SIB1 (step 16A, Table 8.1.4.1.2.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                                           
  ------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                 Value/remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                                          
  cellAccessRelatedInfo SEQUENCE {                                                             
  plmn-IdentityList SEQUENCE (SIZE (1..maxPLMN)) OF PLMN-Identity {   1 entry                  
  plmn-Identity\[1\]                                                                 entry 1   
  trackingAreaCode                                                    2                        
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            

Table 8.1.4.1.2.3.3-16: REGISTRATION ACCEPT (step 17, Table
8.1.4.1.2.3.2-3)

  --------------------------------------------------- -------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.7.1-7                            
  Information Element                                 Value/remark   Comment   Condition
  TAI list                                                                     
  TAC 1                                               2                        
  --------------------------------------------------- -------------- --------- -----------

Table 8.1.4.1.2.3.3-17: REGISTRATION REQUEST (step 1, Table
8.1.4.1.2.3.2-4)

  --------------------------------------------------------------------------- -------------- -------------------------------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.7.1-6 with condition MOBILITY                                                                                                   
  Information Element                                                         Value/remark   Comment                                                                          Condition
  Last visited registered TAI                                                                                                                                                 
  tac                                                                         Not Checked    The value may be 1 or 2, please check note for step 1 in Table 8.1.4.1.2.3.2-4   
  --------------------------------------------------------------------------- -------------- -------------------------------------------------------------------------------- -----------

##### 8.1.4.1.3 Void

##### 8.1.4.1.4 Void

##### 8.1.4.1.5 Intra NR handover / Failure / Re-establishment successful

##### 8.1.4.1.5.1 Test Purpose (TP) {#test-purpose-tp-71 .H6}

##### (1) {#section-126 .H6}

**with** { UE in NR RRC\_CONNECTED state and having received an
RRCReconfiguration message including a reconfigurationWithSync for
handover to the target cell }

**ensure that** {

**when** { UE detects handover failure and the initial cell is
selectable }

**then** { UE performs an RRCReestablishment procedure on the source
cell }

}

##### (2) {#section-127 .H6}

**with** { UE detects handover failure and having transmitted an
RRCReestablishmentRequest message }

**ensure that** {

**when** { UE receives an RRCReestablishment message with a
nextHopChainingCount which is different from the NCC associated with the
currently active KgNB }

**then** { UE derives new KgNB from the nextHopChainingCount and
completes RRCReestablishment procedure on the source cell }

}

##### (3) {#section-128 .H6}

**with** { UE detects handover failure and having transmitted an
RRCReestablishmentRequest message }

**ensure that** {

**when** { UE receives an RRCReestablishment message with a
nextHopChainingCount which is same as the NCC associated with the
currently active KgNB }

**then** { UE derives new KgNB from the currently active KgNB and
completes RRCReestablishment procedure on the source cell }

}

##### 8.1.4.1.5.2 Conformance requirements {#conformance-requirements-71 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clauses 5.3.5.5.2, 5.3.5.7, 5.3.5.8.3
and 5.3.7.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the AS security is not activated, perform the actions upon going
to RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\'
upon which the procedure ends;

1\> stop timer T310 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> acquire the *MIB*, which is scheduled as specified in TS 38.213
\[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the *MIB* if the UE already has the
required timing information, or the timing information is not needed for
random access.

1\> reset the MAC entity of this cell group;

1\> consider the SCell(s) of this cell group, if configured, to be in
deactivated state;

1\> apply the value of the *newUE-Identity* as the C-RNTI for this cell
group;

1\> configure lower layers in accordance with the received
s*pCellConfigCommon*;

1\> configure lower layers in accordance with any additional fields, not
covered in the previous, if included in the received
*reconfigurationWithSync.*

\[TS 38.331, clause 5.3.5.7\]

The UE shall:

...

1\> else:

2\> if the *nas-Container* is included in the received
*masterKeyUpdate*:

3\> forward the *nas-Container* to the upper layers;

2\> if the *keySetChangeIndicator* is set to *true*:

3\> derive or update the K~gNB~ key based on the K~AMF~ key, as
specified in TS 33.501 \[11\];

2\> else:

3\> derive or update the K~gNB~ key based on the current K~gNB~ key or
the NH, using the *nextHopChainingCount* value indicated in the received
*masterKeyUpdate*, as specified in TS 33.501 \[11\];

2\> store the *nextHopChainingCount* value;

2\> derive the keys associated with the K~gNB~ key as follows:

3\> if the *securityAlgorithmConfig* is included in *SecurityConfig*:

4\> derive the K~RRCenc~ and K~UPenc~ keys associated with the
*cipheringAlgorithm* indicated in the *securityAlgorithmConfig,* as
specified in TS 33.501 \[11\];

4\> derive the K~RRCint~ and K~UPint~ keys associated with the
*integrityProtAlgorithm* indicated in the *securityAlgorithmConfig,* as
specified in TS 33.501 \[11\];

3\> else:

4\> derive the K~RRCenc~ and K~UPenc~ keys associated with the current
*cipheringAlgorithm,* as specified in TS 33.501 \[11\];

4\> derive the K~RRCint~ and K~UPint~ keys associated with the current
*integrityProtAlgorithm,* as specified in TS 33.501 \[11\].

NOTE: Ciphering and integrity protection are optional to configure for
the DRBs.

\[TS 38.331, clause 5.3.5.8.3\]

The UE shall:

1\> if T304 of the MCG expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated* if
configured;

2\> revert back to the UE configuration used in the source PCell;

2\> initiate the connection re-establishment procedure as specified in
subclause 5.3.7.

NOTE 1: In the context above, \"the UE configuration\" includes state
variables and parameters of each radio bearer.

1\> else if T304 of a secondary cell group expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated,* if
configured;

2\> initiate the SCG failure information procedure as specified in
subclause 5.7.3 to report SCG reconfiguration with sync failure, upon
which the RRC reconfiguration procedure ends;

1\> else if T304 expires when *RRCReconfiguration* is received via other
RAT (HO to NR failure):

2\> reset MAC;

2\> perform the actions defined for this failure case as defined in the
specifications applicable for the other RAT.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

1\> stop timer T301;

1\> consider the current cell to be the PCell;

1\> store the *nextHopChainingCount* value indicated in the
*RRCReestablishment message*;

1\> update the K~gNB~ key based on the current K~gNB~ key or the NH*,*
using the stored *nextHopChainingCount* value, as specified in TS 33.501
\[11\];

1\> derive the K~RRCenc~ and K~UPenc~ keys associated with the
previously configured *cipheringAlgorithm,* as specified in TS 33.501
\[11\];

1\> derive the K~RRCint~ and K~UPint~ keys associated with the
previously configured *integrityProtAlgorithm,* as specified in TS
33.501 \[11\].

1\> request lower layers to verify the integrity protection of the
*RRCReestablishment* message, using the previously configured algorithm
and the K~RRCint~ key;

1\> if the integrity protection check of the *RRCReestablishment*
message fails:

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\', upon which the procedure
ends;

1\> configure lower layers to resume integrity protection for SRB1 using
the previously configured algorithm and the K~RRCint~ key immediately,
i.e., integrity protection shall be applied to all subsequent messages
received and sent by the UE, including the message used to indicate the
successful completion of the procedure;

1\> configure lower layers to resume ciphering for SRB1 using the
previously configured algorithm and, the K~RRCenc~ key immediately,
i.e., ciphering shall be applied to all subsequent messages received and
sent by the UE, including the message used to indicate the successful
completion of the procedure;

1\> release the measurement gap configuration indicated by the
*measGapConfig*, if configured;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

1\> the procedure ends.

##### 8.1.4.1.5.3 Test Description {#test-description-71 .H6}

##### 8.1.4.1.5.3.1 Pre-test conditions {#pre-test-conditions-71 .H6}

##### System Simulator: {#system-simulator-48 .H6}

\- NR Cell 1 is the Serving cell.

\- NR Cell 2 is the Suitable neighbour intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for both NR Cells.

##### UE: {#ue-45 .H6}

\- None.

##### Preamble: {#preamble-47 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.4.1.5.3.2 Test procedure sequence {#test-procedure-sequence-72 .H6}

Table 8.1.4.1.5.3.2-1 and Table 8.1.4.1.5.3.2-2 illustrates the downlink
power levels and other changing parameters to be applied for the cells
at various time instants of the test execution. The exact instants on
which these values shall be applied are described in the texts in this
clause.

Table 8.1.4.1.5.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T1 | SS/PBCH   | dBm/SCS | -88       | -88       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -88       | -94       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.4.1.5.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T1 | SS/PBCH   | dBm/SCS | -82       | -82       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -82       | -91       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.4.1.5.3.2-3: Main behaviour

+-----+--------------+--------------+--------------+---------+----+
| St  | Procedure    | Message      | TP           | Verdict |    |
|     |              | Sequence     |              |         |    |
+=====+==============+==============+==============+=========+====+
|     |              | U - S        | Message      |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1   | The SS       | \-           | \-           | \-      | \- |
|     | changes the  |              |              |         |    |
|     | power level  |              |              |         |    |
|     | setting      |              |              |         |    |
|     |              |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T1\".      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2   | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCReco     |         |    |
|     | RRCRec       |              | nfiguration* |         |    |
|     | onfiguration |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 1 to |              |              |         |    |
|     | order the UE |              |              |         |    |
|     | to perform   |              |              |         |    |
|     | handover to  |              |              |         |    |
|     | NR Cell 2.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| \-  | EXCEPTION:   | \-           | \-           | \-      | \- |
|     | In parallel  |              |              |         |    |
|     | to the       |              |              |         |    |
|     | events       |              |              |         |    |
|     |              |              |              |         |    |
|     | described in |              |              |         |    |
|     | step 3 the   |              |              |         |    |
|     | steps        |              |              |         |    |
|     | specified in |              |              |         |    |
|     | Table        |              |              |         |    |
|     |              |              |              |         |    |
|     | 8.1          |              |              |         |    |
|     | .4.1.5.3.2-4 |              |              |         |    |
|     | should take  |              |              |         |    |
|     | place.       |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 3   | The SS       | \-           | \-           | \-      | \- |
|     | changes the  |              |              |         |    |
|     | power level  |              |              |         |    |
|     | setting      |              |              |         |    |
|     |              |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T2\".      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 4   | Check: Does  | \--\>        | NR RRC:      | 1       | P  |
|     | the UE       |              | *RR          |         |    |
|     | transmit an  |              | CReestablish |         |    |
|     | R            |              | mentRequest* |         |    |
|     | RCReestablis |              |              |         |    |
|     | hmentRequest |              |              |         |    |
|     |              |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 1?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 5   | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCRees     |         |    |
|     | RRCRee       |              | tablishment* |         |    |
|     | stablishment |              |              |         |    |
|     | message to   |              |              |         |    |
|     | resume SRB1  |              |              |         |    |
|     | operation    |              |              |         |    |
|     | and          |              |              |         |    |
|     | re-activate  |              |              |         |    |
|     | security on  |              |              |         |    |
|     | NR Cell 1.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6   | Does the UE  | \--\>        | NR RRC:      | 2       | P  |
|     | transmit an  |              | *RRC         |         |    |
|     |              |              | Reestablishm |         |    |
|     | RR           |              | entComplete* |         |    |
|     | CReestablish |              |              |         |    |
|     | mentComplete |              |              |         |    |
|     | message      |              |              |         |    |
|     | using the    |              |              |         |    |
|     | security key |              |              |         |    |
|     | derived from |              |              |         |    |
|     | the          |              |              |         |    |
|     | nextHopC     |              |              |         |    |
|     | hainingCount |              |              |         |    |
|     | on NR Cell   |              |              |         |    |
|     | 1?           |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6A  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | RRCRec       |         |    |
|     | RRCRec       |              | onfiguration |         |    |
|     | onfiguration |              |              |         |    |
|     | message to   |              |              |         |    |
|     | resume       |              |              |         |    |
|     | existing     |              |              |         |    |
|     | radio        |              |              |         |    |
|     | bearers on   |              |              |         |    |
|     | NR Cell 1.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6B  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits an |              | RR           |         |    |
|     | *RRC         |              | CReconfigura |         |    |
|     | Reconfigurat |              | tionComplete |         |    |
|     | ionComplete* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 1.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 7   | The SS       | \-           | \-           | \-      | \- |
|     | changes the  |              |              |         |    |
|     | power level  |              |              |         |    |
|     | setting      |              |              |         |    |
|     |              |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T1\".      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 8   | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCReco     |         |    |
|     | RRCRec       |              | nfiguration* |         |    |
|     | onfiguration |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 1 to |              |              |         |    |
|     | order the UE |              |              |         |    |
|     | to perform   |              |              |         |    |
|     | handover to  |              |              |         |    |
|     | NR Cell 2.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| \-  | EXCEPTION:   | \-           | \-           | \-      | \- |
|     | In parallel  |              |              |         |    |
|     | to the       |              |              |         |    |
|     | events       |              |              |         |    |
|     |              |              |              |         |    |
|     | described in |              |              |         |    |
|     | step 9 the   |              |              |         |    |
|     | steps        |              |              |         |    |
|     | specified in |              |              |         |    |
|     | Table        |              |              |         |    |
|     |              |              |              |         |    |
|     | 8.1          |              |              |         |    |
|     | .4.1.5.3.2-4 |              |              |         |    |
|     | should take  |              |              |         |    |
|     | place.       |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 9   | The SS       | \-           | \-           | \-      | \- |
|     | changes the  |              |              |         |    |
|     | power level  |              |              |         |    |
|     | setting      |              |              |         |    |
|     |              |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T2\".      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 10  | Check: Does  | \--\>        | NR RRC:      | \-      | \- |
|     | the UE       |              | *RR          |         |    |
|     | transmit an  |              | CReestablish |         |    |
|     | R            |              | mentRequest* |         |    |
|     | RCReestablis |              |              |         |    |
|     | hmentRequest |              |              |         |    |
|     |              |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 1?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCRees     |         |    |
|     | RRCRee       |              | tablishment* |         |    |
|     | stablishment |              |              |         |    |
|     | message to   |              |              |         |    |
|     | resume SRB1  |              |              |         |    |
|     | operation    |              |              |         |    |
|     | and          |              |              |         |    |
|     | re-activate  |              |              |         |    |
|     | security on  |              |              |         |    |
|     | NR Cell 1.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 12  | Does the UE  | \--\>        | NR RRC:      | 3       | P  |
|     | transmit an  |              | *RRC         |         |    |
|     |              |              | Reestablishm |         |    |
|     | RR           |              | entComplete* |         |    |
|     | CReestablish |              |              |         |    |
|     | mentComplete |              |              |         |    |
|     | message      |              |              |         |    |
|     | using the    |              |              |         |    |
|     | security key |              |              |         |    |
|     | derived from |              |              |         |    |
|     | the          |              |              |         |    |
|     | nextHopC     |              |              |         |    |
|     | hainingCount |              |              |         |    |
|     | on NR Cell   |              |              |         |    |
|     | 1?           |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 12A | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | RRCRec       |         |    |
|     | RRCRec       |              | onfiguration |         |    |
|     | onfiguration |              |              |         |    |
|     | message to   |              |              |         |    |
|     | resume       |              |              |         |    |
|     | existing     |              |              |         |    |
|     | radio        |              |              |         |    |
|     | bearers on   |              |              |         |    |
|     | NR Cell 1.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 12B | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits an |              | RR           |         |    |
|     | RR           |              | CReconfigura |         |    |
|     | CReconfigura |              | tionComplete |         |    |
|     | tionComplete |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 1.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 13  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCRelease* |         |    |
|     | *RRCRelease* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 1.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+

Table 8.1.4.1.5.3.2-4: Parallel behaviour

  St   Procedure                                                                                Message Sequence   TP        Verdict   
  ---- ---------------------------------------------------------------------------------------- ------------------ --------- --------- ----
                                                                                                U - S              Message             
  \-   EXCEPTION: The steps 1 and 2 below are repeated for the duration of T304.                \-                 *-*       \-        \-
  1    The UE attempts to perform the handover using MAC Random Access Preamble on NR Cell 2.   \-                 *-*       \-        \-
  2    The SS does not respond.                                                                 \-                 *-*       \-        \-

##### 8.1.4.1.5.3.3 Specific message contents {#specific-message-contents-63 .H6}

Table 8.1.4.1.5.3.3-1: *SIB1 for NR Cell 1 and NR Cell 2* (preamble and
all steps, Table 8.1.4.1.5.3.2-3)

  ----------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1, Table 4.6.3-130                            
  Information Element                             Value/remark   Comment   Condition
  RACH-ConfigGeneric ::= SEQUENCE {                                        
  preambleTransMax                                n50                      
  }                                                                        
  ----------------------------------------------- -------------- --------- -----------

Table 8.1.4.1.5.3.3-2: *RRCReconfiguration-HO* (steps 2, 8, Table
8.1.4.1.5.3.2-3)

  --------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange
  --------------------------------------------------------------------------------------

Table 8.1.4.1.5.3.3-3: *RRCReestablishmentRequest* (step 4, 10, Table
8.1.4.1.5.3.2-3)

+----------------------+----------------------+---------+-----------+
| Derivation Path: TS  |                      |         |           |
| 38.508-1, Table      |                      |         |           |
| 4.6.1-12             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| RRCRe                |                      |         |           |
| establishmentRequest |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ue-Identity SEQUENCE |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| c-RNTI               | the value of the     |         |           |
|                      | C-RNTI of the UE     |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId           | PhysicalCellIdentity |         |           |
|                      | of NR Cell 1         |         |           |
+----------------------+----------------------+---------+-----------+
| shortMAC-I           | The same value as    |         |           |
|                      | the 16 least         |         |           |
|                      | significant bits of  |         |           |
|                      | the MAC-I value      |         |           |
|                      |                      |         |           |
|                      | calculated by SS.    |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| reestablishmentCause | handoverFailure      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

Table 8.1.4.1.5.3.3-4: *RRCReestablishment* (step 5, 11, Table
8.1.4.1.5.3.2-3)

  ---------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1, Table 4.6.1-10                            
  Information Element                            Value/remark   Comment   Condition
  RRCReestablishment ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                             
  rrcReestablishment SEQUENCE {                                           
  nextHopChainingCount                           2                        
  }                                                                       
  }                                                                       
  }                                                                       
  ---------------------------------------------- -------------- --------- -----------

Table 8.1.4.1.5.3.3-5: Void

Table 8.1.4.1.5.3.3-6: Void

Table 8.1.4.1.5.3.3-7: RRCReconfiguration (step 6A and 12A, Table
8.1.4.1.5.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1\[4\], table 4.6.1-13 with condition REEST
  ------------------------------------------------------------------------

##### 8.1.4.1.6 Intra NR handover / Failure / Re-establishment failure

##### 8.1.4.1.6.1 Test Purpose (TP) {#test-purpose-tp-72 .H6}

##### (1) {#section-129 .H6}

**with** { UE in NR RRC\_CONNECTED state and having received an
RRCReconfiguration message including a reconfigurationWithSync for
handover to the target cell }

**ensure that** {

**when** { UE detects handover failure and fails an RRCReestablishment
procedure }

**then** { UE enters NR RRC\_IDLE state }

}

##### 8.1.4.1.6.2 Conformance requirements {#conformance-requirements-72 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clauses 5.3.5.5.2, 5.3.5.8.3 and
5.3.7.5 and TS 24.501, clause 5.5.1.3.2. Unless otherwise stated these
are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the AS security is not activated, perform the actions upon going
to RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\'
upon which the procedure ends;

1\> stop timer T310 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> acquire the *MIB*, which is scheduled as specified in TS 38.213
\[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the *MIB* if the UE already has the
required timing information, or the timing information is not needed for
random access.

1\> reset the MAC entity of this cell group;

1\> consider the SCell(s) of this cell group, if configured, to be in
deactivated state;

1\> apply the value of the *newUE-Identity* as the C-RNTI for this cell
group;

1\> configure lower layers in accordance with the received
s*pCellConfigCommon*;

1\> configure lower layers in accordance with any additional fields, not
covered in the previous, if included in the received
*reconfigurationWithSync.*

\[TS 38.331, clause 5.3.5.8.3\]

The UE shall:

1\> if T304 of the MCG expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated* if
configured;

2\> revert back to the UE configuration used in the source PCell;

2\> initiate the connection re-establishment procedure as specified in
subclause 5.3.7.

NOTE 1: In the context above, \"the UE configuration\" includes state
variables and parameters of each radio bearer.

1\> else if T304 of a secondary cell group expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated,* if
configured;

2\> initiate the SCG failure information procedure as specified in
subclause 5.7.3 to report SCG reconfiguration with sync failure, upon
which the RRC reconfiguration procedure ends;

1\> else if T304 expires when *RRCReconfiguration* is received via other
RAT (HO to NR failure):

2\> reset MAC;

2\> perform the actions defined for this failure case as defined in the
specifications applicable for the other RAT.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

1\> stop timer T301;

1\> consider the current cell to be the PCell;

1\> store the *nextHopChainingCount* value indicated in the
*RRCReestablishment message*;

1\> update the K~gNB~ key based on the current K~gNB~ key or the NH*,*
using the stored *nextHopChainingCount* value, as specified in TS 33.501
\[11\];

1\> derive the K~RRCenc~ and K~UPenc~ keys associated with the
previously configured *cipheringAlgorithm,* as specified in TS 33.501
\[11\];

1\> derive the K~RRCint~ and K~UPint~ keys associated with the
previously configured *integrityProtAlgorithm,* as specified in TS
33.501 \[11\].

1\> request lower layers to verify the integrity protection of the
*RRCReestablishment* message, using the previously configured algorithm
and the K~RRCint~ key;

1\> if the integrity protection check of the *RRCReestablishment*
message fails:

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\', upon which the procedure
ends;

1\> configure lower layers to resume integrity protection for SRB1 using
the previously configured algorithm and the K~RRCint~ key immediately,
i.e., integrity protection shall be applied to all subsequent messages
received and sent by the UE, including the message used to indicate the
successful completion of the procedure;

1\> configure lower layers to resume ciphering for SRB1 using the
previously configured algorithm and, the K~RRCenc~ key immediately,
i.e., ciphering shall be applied to all subsequent messages received and
sent by the UE, including the message used to indicate the successful
completion of the procedure;

1\> release the measurement gap configuration indicated by the
*measGapConfig*, if configured;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

1\> the procedure ends.

\[TS 24.501, clause 5.5.1.3.2\]

The UE in state 5GMM-REGISTERED shall initiate the registration
procedure for mobility and periodic registration update by sending a
REGISTRATION REQUEST message to the AMF,

...

f\) when the UE receives an indication of \"RRC Connection failure\"
from the lower layers and does not have signalling pending (i.e. when
the lower layer requests NAS signalling connection recovery) except for
the case specified in subclause 5.3.1.4;

##### 8.1.4.1.6.3 Test Description {#test-description-72 .H6}

##### 8.1.4.1.6.3.1 Pre-test conditions {#pre-test-conditions-72 .H6}

##### System Simulator: {#system-simulator-49 .H6}

\- NR Cell 1 is the Serving cell.

\- NR Cell 2 is the Suitable neighbour intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for both NR Cells.

##### UE: {#ue-46 .H6}

\- None.

##### Preamble: {#preamble-48 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.4.1.6.3.2 Test procedure sequence {#test-procedure-sequence-73 .H6}

Table 8.1.4.1.6.3.2-1 and Table 8.1.4.1.6.3.2-2 illustrates the downlink
power levels and other changing parameters to be applied for the cells
at various time instants of the test execution. The exact instants on
which these values shall be applied are described in the texts in this
clause.

Table 8.1.4.1.6.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T1 | SS/PBCH   | dBm/SCS | -88       | -88       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -88       | -94       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.4.1.6.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T1 | SS/PBCH   | dBm/SCS | -82       | -82       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -91       | -91       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.4.1.6.3.2-3: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \-           | \-           | \-      | \- |
|    | changes the  |              |              |         |    |
|    | power level  |              |              |         |    |
|    | setting      |              |              |         |    |
|    | according to |              |              |         |    |
|    | the row      |              |              |         |    |
|    | \"T1\".      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRCReco     |         |    |
|    | RRCRec       |              | nfiguration* |         |    |
|    | onfiguration |              |              |         |    |
|    | message on   |              |              |         |    |
|    | NR Cell 1 to |              |              |         |    |
|    | order the UE |              |              |         |    |
|    | to perform   |              |              |         |    |
|    | handover to  |              |              |         |    |
|    | NR Cell 2.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| \- | EXCEPTION:   | \-           | \-           | \-      | \- |
|    | In parallel  |              |              |         |    |
|    | to the       |              |              |         |    |
|    | events       |              |              |         |    |
|    | described in |              |              |         |    |
|    | step 3 the   |              |              |         |    |
|    | steps        |              |              |         |    |
|    | specified in |              |              |         |    |
|    | Table        |              |              |         |    |
|    | 8.1          |              |              |         |    |
|    | .4.1.6.3.2-4 |              |              |         |    |
|    | should take  |              |              |         |    |
|    | place.       |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The SS       | \-           | \-           | \-      | \- |
|    | changes the  |              |              |         |    |
|    | power level  |              |              |         |    |
|    | setting      |              |              |         |    |
|    | according to |              |              |         |    |
|    | the row      |              |              |         |    |
|    | \"T2\".      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | Check: Does  | \--\>        | NR RRC:      | 1       | P  |
|    | the UE       |              | *RR          |         |    |
|    | transmit an  |              | CReestablish |         |    |
|    | R            |              | mentRequest* |         |    |
|    | RCReestablis |              |              |         |    |
|    | hmentRequest |              |              |         |    |
|    | message on   |              |              |         |    |
|    | NR Cell 1?   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRCRees     |         |    |
|    | RRCRee       |              | tablishment* |         |    |
|    | stablishment |              |              |         |    |
|    | message to   |              |              |         |    |
|    | resume SRB1  |              |              |         |    |
|    | operation    |              |              |         |    |
|    | and          |              |              |         |    |
|    | re-activate  |              |              |         |    |
|    | security on  |              |              |         |    |
|    | NR Cell 1.   |              |              |         |    |
|    |              |              |              |         |    |
|    | Note:        |              |              |         |    |
|    | RRCRee       |              |              |         |    |
|    | stablishment |              |              |         |    |
|    | includes a   |              |              |         |    |
|    | wrong        |              |              |         |    |
|    | nextHopC     |              |              |         |    |
|    | hainingCount |              |              |         |    |
|    | value        |              |              |         |    |
|    | causing an   |              |              |         |    |
|    | integrity    |              |              |         |    |
|    | check        |              |              |         |    |
|    | failure.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | Check: Does  | \-           | *-*          | 1       | \- |
|    | the test     |              |              |         |    |
|    | result of    |              |              |         |    |
|    | test         |              |              |         |    |
|    | procedure in |              |              |         |    |
|    | TS 38.508-1  |              |              |         |    |
|    | \[4\]        |              |              |         |    |
|    | subclause    |              |              |         |    |
|    | 4.9.5        |              |              |         |    |
|    | indicate     |              |              |         |    |
|    | that the UE  |              |              |         |    |
|    | has          |              |              |         |    |
|    | performed    |              |              |         |    |
|    | mobility     |              |              |         |    |
|    | registration |              |              |         |    |
|    | on NR cell 1 |              |              |         |    |
|    | started in   |              |              |         |    |
|    | NR           |              |              |         |    |
|    | RRC\_IDLE?   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

Table 8.1.4.1.6.3.2-4: Parallel behaviour

  St   Procedure                                                                                Message Sequence   TP        Verdict   
  ---- ---------------------------------------------------------------------------------------- ------------------ --------- --------- ----
                                                                                                U - S              Message             
  \-   EXCEPTION: The steps 1 and 2 below are repeated for the duration of T304.                \-                 *-*       \-        \-
  1    The UE attempts to perform the handover using MAC Random Access Preamble on NR Cell 2.   \-                 *-*       \-        \-
  2    The SS does not respond.                                                                 \-                 *-*       \-        \-

##### 8.1.4.1.6.3.3 Specific message contents {#specific-message-contents-64 .H6}

Table 8.1.4.1.6.3.3-1: *SIB1 for NR Cell 1 and NR Cell 2* (preamble and
all steps, Table 8.1.4.1.6.3.2-3)

  ----------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1, Table 4.6.3-130                            
  Information Element                             Value/remark   Comment   Condition
  RACH-ConfigGeneric ::= SEQUENCE {                                        
  preambleTransMax                                n50                      
  }                                                                        
  ----------------------------------------------- -------------- --------- -----------

Table 8.1.4.1.6.3.3-2: *RRCReconfiguration-HO* (step 2, Table
8.1.4.1.6.3.2-3)

  --------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange
  --------------------------------------------------------------------------------------

Table 8.1.4.1.6.3.3-3: *RRCReestablishmentRequest* (step 4, Table
8.1.4.1.6.3.2-3)

+----------------------+----------------------+---------+-----------+
| Derivation Path: TS  |                      |         |           |
| 38.508-1, Table      |                      |         |           |
| 4.6.1-12             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| RRCRe                |                      |         |           |
| establishmentRequest |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ue-Identity SEQUENCE |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| c-RNTI               | the value of the     |         |           |
|                      | C-RNTI of the UE     |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId           | PhysicalCellIdentity |         |           |
|                      | of NR Cell 1         |         |           |
+----------------------+----------------------+---------+-----------+
| shortMAC-I           | The same value as    |         |           |
|                      | the 16 least         |         |           |
|                      | significant bits of  |         |           |
|                      | the MAC-I value      |         |           |
|                      |                      |         |           |
|                      | calculated by SS.    |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| reestablishmentCause | handoverFailure      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

Table 8.1.4.1.6.3.3-4: *RRCReestablishment* (step 5, Table
8.1.4.1.6.3.2-3)

  ---------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1, Table 4.6.1-10                            
  Information Element                            Value/remark   Comment   Condition
  RRCReestablishment ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                             
  rrcReestablishment SEQUENCE {                                           
  nextHopChainingCount                           7                        
  }                                                                       
  }                                                                       
  }                                                                       
  ---------------------------------------------- -------------- --------- -----------

##### 8.1.4.1.7 NR CA / Intra NR handover / Success / PCell Change and SCell addition / SCell release

###### 8.1.4.1.7.1 NR CA / Intra NR handover / Success / PCell Change and SCell addition / SCell release / Intra-band Contiguous CA

##### 8.1.4.1.7.1.1 Test Purpose (TP) {#test-purpose-tp-73 .H6}

##### (1) {#section-130 .H6}

**with** { UE in NR RRC\_CONNECTED state and configured an SCell }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including a
reconfigurationWithSync for handover to one of the SCell and
sCellToAddModList for an SCell addition }

**then** { UE transmits an RRCReconfigurationComplete message }

}

##### (2) {#section-131 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including a
reconfigurationWithSync for PCell change and including
sCellToReleaseList with an sCellIndex set to the configured Scell }

**then** { UE sends an RRCReconfigurationComplete message }

}

##### 8.1.4.1.7.1.2 Conformance requirements {#conformance-requirements-73 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.5.5.2, clauses 5.3.5.5.9 and clauses
5.3.5.5.8. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the AS security is not activated, perform the actions upon going
to RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\'
upon which the procedure ends;

1\> stop timer T310 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> acquire the *MIB*, which is scheduled as specified in TS 38.213
\[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the *MIB* if the UE already has the
required timing information, or the timing information is not needed for
random access.

1\> reset the MAC entity of this cell group;

1\> consider the SCell(s) of this cell group, if configured, to be in
deactivated state;

1\> apply the value of the *newUE-Identity* as the C-RNTI for this cell
group;

1\> configure lower layers in accordance with the received
s*pCellConfigCommon*;

> 1\> configure lower layers in accordance with any additional fields,
> not covered in the previous, if included in the received
> *reconfigurationWithSync.*

\[TS 38.331, clause 5.3.5.5.9\]

The UE shall:

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is not part of the current UE configuration (SCell addition):

2\> add the SCell, corresponding to the *sCellIndex*, in accordance with
the *sCellConfigCommon* and *sCellConfigDedicated*;

2\> configure lower layers to consider the SCell to be in deactivated
state;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

3\> if SCells are not applicable for the associated measurement; and

3\> if the concerned SCell is included in *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*:

4\> remove the concerned SCell from *cellsTriggeredList* defined within
the *VarMeasReportList* for this *measId*;

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is part of the current UE configuration (SCell modification):

2\> modify the SCell configuration in accordance with the
*sCellConfigDedicated*.

\[TS 38.331, clause 5.3.5.5.8\]

The UE shall:

1\> if the release is triggered by reception of the
*sCellToReleaseList*:

2\> for each *sCellIndex* value included in the *sCellToReleaseList*:

3\> if the current UE configuration includes an SCell with value
*sCellIndex*:

4\> release the SCell.

##### 8.1.4.1.7.1.3 Test description {#test-description-73 .H6}

##### 8.1.4.1.7.1.3.1 Pre-test conditions {#pre-test-conditions-73 .H6}

##### System Simulator: {#system-simulator-50 .H6}

\- NR Cell 1 is the PCell, NR Cell 3 is the configured SCell and target
PCell. NR Cell 2 is the active target SCell. NR Cell 12 is the target
intra-frequency Cell of NR Cell 3, and also the target PCell.

\- NR Cell 1 and NR Cell 3 are Intra-band Contiguous. NR Cell 2 and NR
Cell 12 are Intra-band Contiguous.

\- NR Cell 12 belongs to the same PLMN and TAI with NR Cell 1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-47 .H6}

\- None.

##### Preamble: {#preamble-49 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.4.1.7.1.3.2 Test procedure sequence {#test-procedure-sequence-74 .H6}

Table 8.1.4.1.7.1.3.2-1 and Table 8.1.4.1.7.1.3.2-2 illustrates the
downlink power levels to be applied for NR Cell 1, NR Cell 3, NR Cell 2
and NR Cell 12 at various time instants of the test execution. Row
marked "T0" denotes the conditions after the preamble, while rows marked
"T1" are to be applied subsequently. The exact instants on which these
values shall be applied are described in the texts in this clause.

Table 8.1.4.1.7.1.3.2-1: Time instances of cell power level and
parameter changes for conducted test environment

+----+-------+-------+-------+-------+-------+-------+-------+
|    | Para  | Unit  | NR    | NR    | NR    | NR    | R     |
|    | meter |       | Cell  | Cell  | Cell  |       | emark |
|    |       |       | 1     | 3     | 2     | Cell  |       |
|    |       |       |       |       |       | 12    |       |
+====+=======+=======+=======+=======+=======+=======+=======+
| T0 | SS    | dB    | -88   | -88   | -88   | "Off" | NR    |
|    | /PBCH | m/SCS |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 1, NR |
|    | SSS   |       |       |       |       |       | Cell  |
|    | EPRE  |       |       |       |       |       | 2 and |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 3 are |
|    |       |       |       |       |       |       | avail |
|    |       |       |       |       |       |       | able. |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 12 is |
|    |       |       |       |       |       |       | not   |
|    |       |       |       |       |       |       | avail |
|    |       |       |       |       |       |       | able. |
+----+-------+-------+-------+-------+-------+-------+-------+
| T1 | SS    | dB    | "Off" | -88   | -88   | -82   | NR    |
|    | /PBCH | m/SCS |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 3, NR |
|    | SSS   |       |       |       |       |       | Cell  |
|    | EPRE  |       |       |       |       |       | 2 and |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 12    |
|    |       |       |       |       |       |       | are   |
|    |       |       |       |       |       |       | avail |
|    |       |       |       |       |       |       | able. |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 1 is  |
|    |       |       |       |       |       |       | not   |
|    |       |       |       |       |       |       | avail |
|    |       |       |       |       |       |       | able. |
+----+-------+-------+-------+-------+-------+-------+-------+

Table 8.1.4.1.7.1.3.2-2: Time instances of cell power level and
parameter changes for OTA test environment

+----+-------+-------+-------+-------+-------+-------+-------+
|    | Para  | Unit  | NR    | NR    | NR    | NR    | R     |
|    | meter |       | Cell  | Cell  | Cell  |       | emark |
|    |       |       | 1     | 3     | 2     | Cell  |       |
|    |       |       |       |       |       | 12    |       |
+====+=======+=======+=======+=======+=======+=======+=======+
| T0 | SS    | dB    | -91   | -91   | -91   | "Off" | NR    |
|    | /PBCH | m/SCS |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 1, NR |
|    | SSS   |       |       |       |       |       | Cell  |
|    | EPRE  |       |       |       |       |       | 2 and |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 3 are |
|    |       |       |       |       |       |       | avail |
|    |       |       |       |       |       |       | able. |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 12 is |
|    |       |       |       |       |       |       | not   |
|    |       |       |       |       |       |       | avail |
|    |       |       |       |       |       |       | able. |
+----+-------+-------+-------+-------+-------+-------+-------+
| T1 | SS    | dB    | "Off" | -91   | -91   | -82   | NR    |
|    | /PBCH | m/SCS |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 3, NR |
|    | SSS   |       |       |       |       |       | Cell  |
|    | EPRE  |       |       |       |       |       | 2 and |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 12    |
|    |       |       |       |       |       |       | are   |
|    |       |       |       |       |       |       | avail |
|    |       |       |       |       |       |       | able. |
|    |       |       |       |       |       |       | NR    |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 1 is  |
|    |       |       |       |       |       |       | not   |
|    |       |       |       |       |       |       | avail |
|    |       |       |       |       |       |       | able. |
+----+-------+-------+-------+-------+-------+-------+-------+

Table 8.1.4.1.7.1.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                                                       Message Sequence   TP                                     Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                       U - S              Message                                          
  1    The SS changes Cell parameters according to the row "T0" in table 8.1.4.1.7.1.3.2-1/2.                                                                                                                          \-                 \-                                     \-        \-
  2    The SS transmits an *RRCReconfiguration* message including a sCellToAddModList to add NR Cell 3 as a SCell.                                                                                                     \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  3    The UE transmits the *RRCReconfigurationComplete* message.                                                                                                                                                      \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  4    The SS transmits an *RRCReconfiguration* message including a reconfigurationWithSync for handover to NR Cell 3 and sCellToAddModList to add NR Cell 2 as a SCell.                                               \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  5    Check: Does UE transmit the *RRCReconfigurationComplete* message?                                                                                                                                               \--\>              NR RRC: *RRCReconfigurationComplete*   1         P
  5A   Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1A indicate that the UE is capable of exchanging IP data on DRB \#n associated with the first PDU session on Cell 2?     \-                 \-                                     1         \-
  6    The SS changes Cell parameters according to the row "T1" in table 8.1.4.1.7.1.3.2-1/2.                                                                                                                          \-                 \-                                     \-        \-
  7    The SS transmits an *RRCReconfiguration* message including a reconfigurationWithSync to change PCell to NR Cell 12 and including sCellToReleaseList with a sCellIndex of NR Cell 2.                             \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  8    Check: Does the UE transmit the *RRCReconfigurationComplete* message?                                                                                                                                           \--\>              NR RRC: *RRCReconfigurationComplete*   2         P
  9    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB \#n associated with the first PDU session on Cell 12?   \-                 \-                                     2         \-

##### 8.1.4.1.7.1.3.3 Specific message contents {#specific-message-contents-65 .H6}

Table 8.1.4.1.7.1.3.3-1: *RRCReconfiguration* (step 2, Table
8.1.4.1.7.1.3.2-3)

  ------------------------------------------------------------------------------ ----------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition SCell\_add                                                                 
  Information Element                                                            Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                            
  criticalExtensions CHOICE {                                                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                                                
  nonCriticalExtension SEQUENCE{                                                                                                               
  masterCellGroup                                                                CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  ------------------------------------------------------------------------------ ----------------- ------------------------------------------- -----------

Table 8.1.4.1.7.1.3.3-2: *CellGroupConfig* (Table 8.1.4.1.7.1.3.3-1)

  ------------------------------------------------------------------------------ ------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition SCell\_add                                                   
  Information Element                                                            Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                 
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {          1 entry                                         
  SCellConfig\[1\] SEQUENCE {                                                                                          entry 1   
  sCellConfigCommon SEQUENCE {                                                                                                   
  physCellId                                                                     Physical Cell Identity of NR Cell 3             
  }                                                                                                                              
  }                                                                                                                              
  }                                                                                                                              
  }                                                                                                                              
  ------------------------------------------------------------------------------ ------------------------------------- --------- -----------

Table 8.1.4.1.7.1.3.3-3: *RRCReconfiguration-HO* (step 4, Table
8.1.4.1.7.1.3.2-3)

  -------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] 4.8.1-1A with condition RBConfig\_KeyChange                                                                 
  Information Element                                                              Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                              
  criticalExtensions CHOICE {                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                  
  nonCriticalExtension SEQUENCE{                                                                                                                 
  masterCellGroup                                                                  CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  -------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------

Table 8.1.4.1.7.1.3.3-4: *CellGroupConfig* (Table 8.1.4.1.7.1.3.3-3)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.3-19  |                 |                 |           |
| with Condition  |                 |                 |           |
| PCell\_change   |                 |                 |           |
| and SCell\_add  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| CellGroupConfig |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spCellConfig    |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reconfig        |                 |                 |           |
| urationWithSync |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spC             |                 |                 |           |
| ellConfigCommon |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| physCellId      | Physical Cell   |                 |           |
|                 | Identity of NR  |                 |           |
|                 | Cell 3          |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sC              | 1 entry         |                 |           |
| ellToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofSCells)) |                 |                 |           |
| OF SCellConfig  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| S               |                 | entry 1         |           |
| CellConfig\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sC              |                 |                 |           |
| ellConfigCommon |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| physCellId      | Physical Cell   |                 |           |
|                 | Identity of NR  |                 |           |
|                 | Cell 2          |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sCe             | 1 entry         |                 |           |
| llToReleaseList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofSCells)) |                 |                 |           |
| OF SCellIndex { |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| SCellIndex\[1\] | 1               | entry 1         |           |
|                 |                 |                 |           |
|                 |                 | SCell release   |           |
|                 |                 | for NR Cell 3   |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.4.1.7.1.3.3-5: *RRCReconfiguration-HO* (step 7, Table
8.1.4.1.7.1.3.2-3)

  ---------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with condition RBConfig\_KeyChange
  ---------------------------------------------------------------------------------------

Table 8.1.4.1.7.1.3.3-6: *CellGroupConfig* (Table 8.1.4.1.7.1.3.3-5)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.3-19  |                 |                 |           |
| with conditions |                 |                 |           |
| PCell\_change   |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| CellGroupConfig |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spCellConfig    |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reconfig        |                 |                 |           |
| urationWithSync |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spC             |                 |                 |           |
| ellConfigCommon |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| physCellId      | Physical Cell   |                 |           |
|                 | Identity of NR  |                 |           |
|                 | Cell 12         |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sCe             | 1 entry         |                 |           |
| llToReleaseList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofSCells)) |                 |                 |           |
| OF SCellIndex { |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| SCellIndex\[1\] | 1               | entry 1         |           |
|                 |                 |                 |           |
|                 |                 | SCell release   |           |
|                 |                 | for NR Cell 2   |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

###### 8.1.4.1.7.2 NR CA / Intra NR handover / Success / PCell Change and SCell addition / SCell release / Inter-band CA

##### 8.1.4.1.7.2.1 Test Purpose (TP) {#test-purpose-tp-74 .H6}

Same as TC 8.1.4.1.7.1 but applied to Inter-band CA case.

##### 8.1.4.1.7.2.2 Conformance requirements {#conformance-requirements-74 .H6}

Same as TC 8.1.4.1.7.1 but applied to Inter-band CA case.

##### 8.1.4.1.7.2.3 Test description {#test-description-74 .H6}

##### 8.1.4.1.7.2.3.1 Pre-test conditions {#pre-test-conditions-74 .H6}

Same as test case 8.1.4.1.7.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3, NR Cell 30
replaces NR Cell 12.

\- NR Cell 30 belongs to the same PLMN and TAI with NR Cell 1.

##### 8.1.4.1.7.2.3.2 Test procedure sequence {#test-procedure-sequence-75 .H6}

Same as TC 8.1.4.1.7.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

##### 8.1.4.1.7.2.3.3 Specific message contents {#specific-message-contents-66 .H6}

Same as TC 8.1.4.1.7.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3, NR Cell 30
replaces NR Cell 12.

Table 8.1.4.1.7.2.3.3-1: SIB3 of NR Cell 10 (step 6, Table
8.1.4.1.7.1.3.2-3)

  --------------------------------------------------------------------------------------- -------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-2                                                                                        
  Information Element                                                                     Value/remark                           Comment   Condition
  SIB3 ::= SEQUENCE {                                                                                                                      
  intraFreqNeighCellList SEQUENCE (SIZE (1.. maxCellIntra)) OF IntraFreqNeighCellInfo {   1 entry                                          
  IntraFreqNeighCellInfo \[1\] SEQUENCE {                                                                                        entry 1   
  physCellId                                                                              Physical Cell Identity of NR Cell 30             
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  --------------------------------------------------------------------------------------- -------------------------------------- --------- -----------

###### 8.1.4.1.7.3 NR CA / Intra NR handover / Success / PCell Change and SCell addition / SCell release / Intra-band non-contiguous CA

##### 8.1.4.1.7.3.1 Test Purpose (TP) {#test-purpose-tp-75 .H6}

Same as TC 8.1.4.1.7.1 but applied to Intra-band non-Contiguous CA.

##### 8.1.4.1.7.3.2 Conformance requirements {#conformance-requirements-75 .H6}

Same as TC 8.1.4.1.7.1 but applied to Intra-band non-Contiguous CA.

##### 8.1.4.1.7.3.3 Test description {#test-description-75 .H6}

##### 8.1.4.1.7.3.3.1 Pre-test conditions {#pre-test-conditions-75 .H6}

Same as test case 8.1.4.1.7.1 with the following differences:

\- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
Contiguous CA.

##### 8.1.4.1.7.3.3.2 Test procedure sequence {#test-procedure-sequence-76 .H6}

Same as TC 8.1.4.1.7.1 with the following differences:

\- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
Contiguous CA

##### 8.1.4.1.7.3.3.3 Specific message contents {#specific-message-contents-67 .H6}

Same as TC 8.1.4.1.7.1 with the following differences:

\- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
Contiguous CA

##### 8.1.4.1.8 NR CA / Intra NR handover / Success / PCell Change / SCell no Change

###### 8.1.4.1.8.1 NR CA / Intra NR handover / Success / PCell Change / SCell no Change / Intra-band Contiguous CA

##### 8.1.4.1.8.1.1 Test Purpose (TP) {#test-purpose-tp-76 .H6}

##### (1) {#section-132 .H6}

**with** { UE in NR RRC\_CONNECTED state and configured an SCell }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including a
*reconfigurationWithSync* for PCell change and *sCellToAddModList* with
an SCell same from configured Scell }

**then** { UE transmits an *RRCReconfigurationComplete* message }

}

##### 8.1.4.1.8.1.2 Conformance requirements {#conformance-requirements-76 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.5.5.2, clauses 5.3.5.5.9. Unless
otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the AS security is not activated, perform the actions upon going
to RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\'
upon which the procedure ends;

1\> stop timer T310 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> acquire the *MIB*, which is scheduled as specified in TS 38.213
\[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the *MIB* if the UE already has the
required timing information, or the timing information is not needed for
random access.

1\> reset the MAC entity of this cell group;

1\> consider the SCell(s) of this cell group, if configured, to be in
deactivated state;

1\> apply the value of the *newUE-Identity* as the C-RNTI for this cell
group;

1\> configure lower layers in accordance with the received
s*pCellConfigCommon*;

> 1\> configure lower layers in accordance with any additional fields,
> not covered in the previous, if included in the received
> *reconfigurationWithSync.*

\[TS 38.331, clause 5.3.5.5.9\]

The UE shall:

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is not part of the current UE configuration (SCell addition):

2\> add the SCell, corresponding to the *sCellIndex*, in accordance with
the *sCellConfigCommon* and *sCellConfigDedicated*;

2\> configure lower layers to consider the SCell to be in deactivated
state;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

3\> if SCells are not applicable for the associated measurement; and

3\> if the concerned SCell is included in *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*:

4\> remove the concerned SCell from *cellsTriggeredList* defined within
the *VarMeasReportList* for this *measId*;

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is part of the current UE configuration (SCell modification):

2\> modify the SCell configuration in accordance with the
*sCellConfigDedicated*.

##### 8.1.4.1.8.1.3 Test description {#test-description-76 .H6}

##### 8.1.4.1.8.1.3.1 Pre-test conditions {#pre-test-conditions-76 .H6}

##### System Simulator: {#system-simulator-51 .H6}

\- NR Cell 1 is the PCell, NR Cell 3 is the configured active SCell. NR
Cell 2 is the target intra-frequency Cell of NR Cell 1, and also the
target PCell.

\- NR Cell 1 and NR Cell 3 are Intra-band Contiguous.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-48 .H6}

\- None.

##### Preamble: {#preamble-50 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.4.1.8.1.3.2 Test procedure sequence {#test-procedure-sequence-77 .H6}

Table 8.1.4.1.8.1.3.2-1 and Table 8.1.4.1.8.1.3.2-2 illustrates the
downlink power levels to be applied for NR Cell 1, NR Cell 3 and NR Cell
2 at various time instants of the test execution. Row marked "T0"
denotes the conditions after the preamble, while rows marked "T1" are to
be applied subsequently. The exact instants on which these values shall
be applied are described in the texts in this clause.

Table 8.1.4.1.8.1.3.2-1: Time instances of cell power level and
parameter changes for conducted test environment

+----+---------+---------+---------+---------+---------+---------+
|    | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|    | rameter |         | 1       | 3       | 2       |         |
+====+=========+=========+=========+=========+=========+=========+
| T0 | SS/PBCH | dBm/SCS | -88     | **-99** | "Off"   | NR Cell |
|    |         |         |         |         |         | 1, NR   |
|    | SSS     |         |         |         |         | Cell 3  |
|    | EPRE    |         |         |         |         | are     |
|    |         |         |         |         |         | ava     |
|    |         |         |         |         |         | ilable. |
|    |         |         |         |         |         | NR Cell |
|    |         |         |         |         |         | 2 is    |
|    |         |         |         |         |         | not     |
|    |         |         |         |         |         | ava     |
|    |         |         |         |         |         | ilable. |
+----+---------+---------+---------+---------+---------+---------+
| T1 | SS/PBCH | dBm/SCS | -88     | **-99** | -88     | NR Cell |
|    |         |         |         |         |         | 1, NR   |
|    | SSS     |         |         |         |         | Cell 3  |
|    | EPRE    |         |         |         |         | and NR  |
|    |         |         |         |         |         | Cell 2  |
|    |         |         |         |         |         | are     |
|    |         |         |         |         |         | ava     |
|    |         |         |         |         |         | ilable. |
+----+---------+---------+---------+---------+---------+---------+

Table 8.1.4.1.8.1.3.2-2: Time instances of cell power level and
parameter changes for OTA test environment

+----+---------+---------+---------+---------+---------+---------+
|    | Pa      | Unit    | NR Cell | NR Cell | NR Cell | Remark  |
|    | rameter |         | 1       | 3       | 2       |         |
+====+=========+=========+=========+=========+=========+=========+
| T0 | SS/PBCH | dBm/SCS | -82     | -91     | "Off"   | NR Cell |
|    |         |         |         |         |         | 1, NR   |
|    | SSS     |         |         |         |         | Cell 3  |
|    | EPRE    |         |         |         |         | are     |
|    |         |         |         |         |         | ava     |
|    |         |         |         |         |         | ilable. |
|    |         |         |         |         |         | NR Cell |
|    |         |         |         |         |         | 2 is    |
|    |         |         |         |         |         | not     |
|    |         |         |         |         |         | ava     |
|    |         |         |         |         |         | ilable. |
+----+---------+---------+---------+---------+---------+---------+
| T1 | SS/PBCH | dBm/SCS | -82     | -91     | -82     | NR Cell |
|    |         |         |         |         |         | 1, NR   |
|    | SSS     |         |         |         |         | Cell 3  |
|    | EPRE    |         |         |         |         | and NR  |
|    |         |         |         |         |         | Cell 2  |
|    |         |         |         |         |         | are     |
|    |         |         |         |         |         | ava     |
|    |         |         |         |         |         | ilable. |
+----+---------+---------+---------+---------+---------+---------+

Table 8.1.4.1.8.1.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                U - S              Message                                          
  1    The SS changes Cell parameters according to the row "T0" in table 8.1.4.1.8.1.3.2-1/2.                                                                                   \-                 \-                                     \-        \-
  2    The SS transmits an *RRCReconfiguration* message including a sCellToAddModList to add NR Cell 3 as a SCell.                                                              \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  3    The UE transmits the *RRCReconfigurationComplete* message?                                                                                                               \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  3A   Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1A indicate that the UE is capable of exchanging IP data on DRB1 and NR Cell 3?   \-                 \-                                     1         \-
  4    The SS changes Cell parameters according to the row "T1" in table 8.1.4.1.8.1.3.2-1/2.                                                                                   \-                 \-                                     \-        \-
  5    The SS transmits an *RRCReconfiguration* message including a reconfigurationWithSync to change PCell to NR Cell 2 and sCellToAddModList to add NR Cell 3 as the Scell.   \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  6    Check: Does the UE transmit the *RRCReconfigurationComplete* message?                                                                                                    \--\>              NR RRC: *RRCReconfigurationComplete*   1         P
  7    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1A indicate that the UE is capable of exchanging IP data on DRB1 and NR Cell 3?   \-                 \-                                     1         \-
  8    The SS transmits an RRCReconfiguration message containing an sCellToReleaseList with SCell NR Cell 3.                                                                    \<\--              NR RRC: RRCReconfiguration             \-        \-
  9    The UE transmits an RRCReconfigurationComplete message.                                                                                                                  \--\>              NR RRC: RRCReconfigurationComplete     \-        \-

##### 8.1.4.1.8.1.3.3 Specific message contents {#specific-message-contents-68 .H6}

Table 8.1.4.1.8.1.3.3-1: *RRCReconfiguration* (step 2, Table
8.1.4.1.8.1.3.2-3)

  ------------------------------------------------------------------------------ ----------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition SCell\_add                                                                 
  Information Element                                                            Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                            
  criticalExtensions CHOICE {                                                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                                                
  nonCriticalExtension SEQUENCE{                                                                                                               
  masterCellGroup                                                                CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  ------------------------------------------------------------------------------ ----------------- ------------------------------------------- -----------

Table 8.1.4.1.8.1.3.3-2: *CellGroupConfig* (Table 8.1.4.1.8.1.3.3-1)

  ------------------------------------------------------------------------------ ------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition SCell\_add                                                   
  Information Element                                                            Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                 
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {          1 entry                                         
  SCellConfig\[1\] SEQUENCE {                                                                                          entry 1   
  sCellIndex                                                                     1                                               
  sCellConfigCommon SEQUENCE {                                                                                                   
  physCellId                                                                     Physical Cell Identity of NR Cell 3             
  }                                                                                                                              
  }                                                                                                                              
  }                                                                                                                              
  }                                                                                                                              
  ------------------------------------------------------------------------------ ------------------------------------- --------- -----------

Table 8.1.4.1.8.1.3.3-3: *RRCReconfiguration-HO* (step 5, Table
8.1.4.1.8.1.3.2-3)

  ---------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with condition RBConfig\_KeyChange
  ---------------------------------------------------------------------------------------

Table 8.1.4.1.8.1.3.3-4: *CellGroupConfig* (Table 8.1.4.1.8.1.3.3-3)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.3-19  |                 |                 |           |
| with condition  |                 |                 |           |
| PCell\_change   |                 |                 |           |
| and SCell\_add  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| CellGroupConfig |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spCellConfig    |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reconfig        |                 |                 |           |
| urationWithSync |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spC             |                 |                 |           |
| ellConfigCommon |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| physCellId      | Physical Cell   |                 |           |
|                 | Identity of NR  |                 |           |
|                 | Cell 2          |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sC              | 1 entry         |                 |           |
| ellToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofSCells)) |                 |                 |           |
| OF SCellConfig  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| S               |                 | entry 1         |           |
| CellConfig\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sCellIndex      | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sC              |                 |                 |           |
| ellConfigCommon |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| physCellId      | Physical Cell   |                 |           |
|                 | Identity of NR  |                 |           |
|                 | Cell 3          |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sCe             | 1 entry         |                 |           |
| llToReleaseList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofSCells)) |                 |                 |           |
| OF SCellIndex { |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| SCellIndex\[1\] | 1               | entry 1         |           |
|                 |                 |                 |           |
|                 |                 | SCell release   |           |
|                 |                 | for NR Cell 3   |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.4.1.8.1.3.3-5: *RRCReconfiguration* (step 8, Table
8.1.4.1.8.1.3.2-3)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE{                                                                            
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.4.1.1.1.3.3-6: *CellGroupConfig* (Table 8.1.4.1.8.1.3.3-5)\`

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                            
  Information Element                                                           Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                         
  sCellToAddModList                                                             Not present              
  sCellToReleaseList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellIndex {         1 entry                  
  SCellIndex\[1\]                                                               1              entry 1   
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

###### 8.1.4.1.8.2 NR CA / Intra NR handover / Success / PCell Change / SCell no Change / Inter-band CA

##### 8.1.4.1.8.2.1 Test Purpose (TP) {#test-purpose-tp-77 .H6}

Same as TC 8.1.4.1.8.1 but applied to Inter-band CA case.

##### 8.1.4.1.8.2.2 Conformance requirements {#conformance-requirements-77 .H6}

Same as TC 8.1.4.1.8.1 but applied to Inter-band CA case.

##### 8.1.4.1.8.2.3 Test description {#test-description-77 .H6}

##### 8.1.4.1.8.2.3.1 Pre-test conditions {#pre-test-conditions-77 .H6}

Same as test case 8.1.4.1.8.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3.

##### 8.1.4.1.8.2.3.2 Test procedure sequence {#test-procedure-sequence-78 .H6}

Same as TC 8.1.4.1.8.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

##### 8.1.4.1.8.2.3.3 Specific message contents {#specific-message-contents-69 .H6}

Same as TC 8.1.4.1.8.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA

\- Cells configuration: NR Cell 10 replaces NR Cell 3.

###### 8.1.4.1.8.3 NR CA / Intra NR handover / Success / PCell Change / SCell no Change / Intra-band non-contiguous CA

##### 8.1.4.1.8.3.1 Test Purpose (TP) {#test-purpose-tp-78 .H6}

Same as TC 8.1.4.1.8.1 but applied to Intra-band non-Contiguous CA.

##### 8.1.4.1.8.3.2 Conformance requirements {#conformance-requirements-78 .H6}

Same as TC 8.1.4.1.8.1 but applied to Intra-band non-Contiguous CA.

##### 8.1.4.1.8.3.3 Test description {#test-description-78 .H6}

##### 8.1.4.1.8.3.3.1 Pre-test conditions {#pre-test-conditions-78 .H6}

Same as test case 8.1.4.1.8.1 with the following differences:

\- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
Contiguous CA.

##### 8.1.4.1.8.3.3.2 Test procedure sequence {#test-procedure-sequence-79 .H6}

Same as TC 8.1.4.1.8.1 with the following differences:

\- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
Contiguous CA

##### 8.1.4.1.8.3.3.3 Specific message contents {#specific-message-contents-70 .H6}

Same as TC 8.1.4.1.8.1 with the following differences:

\- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
Contiguous CA

##### 8.1.4.1.9 NR CA / Intra NR handover / Failure / Re-establishment successful

###### 8.1.4.1.9.1 NR CA / Intra NR handover / Failure / Re-establishment successful / Intra-band Contiguous CA 

##### 8.1.4.1.9.1.1 Test Purpose (TP) {#test-purpose-tp-79 .H6}

##### (1) {#section-133 .H6}

**with {** UE in NR RRC\_CONNECTED state and having received an
RRCReconfiguration message including a reconfigurationWithSync for PCell
change and including sCellToReleaseList with an sCellIndex set to the
configured Scell **}**

**ensure that {**

**when {** UE detects handover failure and the source PCell is
selectable**}**

**then {** UE successfully performs an RRCReestablishment procedure on
source Pcel**l}**

**}**

##### (2) {#section-134 .H6}

**with { UE in NR RRC\_CONNECTED state and having received an
RRCReconfiguration message including a reconfigurationWithSync for PCell
change and including sCellToReleaseList with an sCellIndex set to the
configured SCell }**

**ensure that {**

**when { UE detects handover failure and the initial SCell is
selectable}**

**then { UE successfully performs an RRCReestablishment procedure on
original SCell and the original SCell becomes the PCell}**

**}**

##### 8.1.4.1.9.1.2 Conformance requirements {#conformance-requirements-79 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clause 5.3.5.5.2, 5.3.5.5.9, 5.3.5.5.8
and 5.3.7.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the AS security is not activated, perform the actions upon going
to RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\'
upon which the procedure ends;

1\> stop timer T310 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> acquire the *MIB*, which is scheduled as specified in TS 38.213
\[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the *MIB* if the UE already has the
required timing information, or the timing information is not needed for
random access.

1\> reset the MAC entity of this cell group;

1\> consider the SCell(s) of this cell group, if configured, to be in
deactivated state;

1\> apply the value of the *newUE-Identity* as the C-RNTI for this cell
group;

1\> configure lower layers in accordance with the received
s*pCellConfigCommon*;

1\> configure lower layers in accordance with any additional fields, not
covered in the previous, if included in the received
*reconfigurationWithSync.*

\[TS 38.331, clause 5.3.5.5.9\]

The UE shall:

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is not part of the current UE configuration (SCell addition):

2\> add the SCell, corresponding to the *sCellIndex*, in accordance with
the *sCellConfigCommon* and *sCellConfigDedicated*;

2\> configure lower layers to consider the SCell to be in deactivated
state;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

3\> if SCells are not applicable for the associated measurement; and

3\> if the concerned SCell is included in *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*:

4\> remove the concerned SCell from *cellsTriggeredList* defined within
the *VarMeasReportList* for this *measId*;

1\> for each *sCellIndex* value included in the *sCellToAddModList* that
is part of the current UE configuration (SCell modification):

2\> modify the SCell configuration in accordance with the
*sCellConfigDedicated*.

\[TS 38.331, clause 5.3.5.5.8\]

The UE shall:

1\> if the release is triggered by reception of the
*sCellToReleaseList*:

2\> for each *sCellIndex* value included in the *sCellToReleaseList*:

3\> if the current UE configuration includes an SCell with value
*sCellIndex*:

4\> release the SCell.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

1\> stop timer T301;

1\> consider the current cell to be the PCell;

1\> store the *nextHopChainingCount* value indicated in the
*RRCReestablishment message*;

1\> update the K~gNB~ key based on the current K~gNB~ key or the NH*,*
using the stored *nextHopChainingCount* value, as specified in TS 33.501
\[11\];

1\> derive the K~RRCenc~ and K~UPenc~ keys associated with the
previously configured *cipheringAlgorithm,* as specified in TS 33.501
\[11\];

1\> derive the K~RRCint~ and K~UPint~ keys associated with the
previously configured *integrityProtAlgorithm,* as specified in TS
33.501 \[11\].

1\> request lower layers to verify the integrity protection of the
*RRCReestablishment* message, using the previously configured algorithm
and the K~RRCint~ key;

1\> if the integrity protection check of the *RRCReestablishment*
message fails:

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\', upon which the procedure
ends;

1\> configure lower layers to resume integrity protection for SRB1 using
the previously configured algorithm and the K~RRCint~ key immediately,
i.e., integrity protection shall be applied to all subsequent messages
received and sent by the UE, including the message used to indicate the
successful completion of the procedure;

1\> configure lower layers to resume ciphering for SRB1 using the
previously configured algorithm and, the K~RRCenc~ key immediately,
i.e., ciphering shall be applied to all subsequent messages received and
sent by the UE, including the message used to indicate the successful
completion of the procedure;

1\> release the measurement gap configuration indicated by the
*measGapConfig*, if configured;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

1\> the procedure ends.

##### 8.1.4.1.9.1.3 Test Description {#test-description-79 .H6}

##### 8.1.4.1.9.1.3.1 Pre-test conditions {#pre-test-conditions-79 .H6}

##### System Simulator: {#system-simulator-52 .H6}

\- NR Cell 1 is the PCell and NR Cell 3 is the configured SCell and
target PCell.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in all NR cells.

##### UE: {#ue-49 .H6}

\- None.

Preamble:

\- The UE is in 5GS state 3N-A as defined in TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3 on NR Cell 1.

##### 8.1.4.1.9.1.3.2 Test procedure sequence {#test-procedure-sequence-80 .H6}

Table 8.1.4.1.9.1.3.2-1 and Table 8.1.4.1.9.1.3.2-1A illustrates the
downlink power levels to be applied for NR Cell 1 and NR Cell 3 at
various time instants of the test execution. Row marked \"T0\" denotes
the conditions after the preamble, while rows marked \"T1\", \"T2\",
\"T3\" and \"T4\" are to be applied subsequently. The exact instants on
which these values shall be applied are described in the texts in this
clause.

Table 8.1.4.1.9.1.3.2-1: Time instances of cell power level and
parameter changes for conducted test environment

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 3 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -85       | -91       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 is not |
|    |           |         |           |           | satisfied |
|    |           |         |           |           |           |
|    |           |         |           |           | *Mn + Ofn |
|    |           |         |           |           | + Ocn --  |
|    |           |         |           |           | Hys \< Mp |
|    |           |         |           |           | + Ofp +   |
|    |           |         |           |           | Ocp +     |
|    |           |         |           |           | Off*      |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -85       | -79       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 is     |
|    |           |         |           |           | satisfied |
|    |           |         |           |           |           |
|    |           |         |           |           | *Mn + Ofn |
|    |           |         |           |           | + Ocn --  |
|    |           |         |           |           | Hys \> Mp |
|    |           |         |           |           | + Ofp +   |
|    |           |         |           |           | Ocp +     |
|    |           |         |           |           | Off*      |
+----+-----------+---------+-----------+-----------+-----------+
| T2 | SS/PBCH   | dBm/SCS | -85       | "Off"     | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are       |
|    |           |         |           |           | assigned  |
|    |           |         |           |           | to        |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | Sr        |
|    |           |         |           |           | xLevCell3 |
|    |           |         |           |           | \< 0 such |
|    |           |         |           |           | that      |
|    |           |         |           |           | selecting |
|    |           |         |           |           | Cell 1 is |
|    |           |         |           |           | g         |
|    |           |         |           |           | uaranteed |
+----+-----------+---------+-----------+-----------+-----------+
| T3 | SS/PBCH   | dBm/SCS | -85       | -79       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 is     |
|    |           |         |           |           | satisfied |
|    |           |         |           |           |           |
|    |           |         |           |           | *Mn + Ofn |
|    |           |         |           |           | + Ocn --  |
|    |           |         |           |           | Hys \> Mp |
|    |           |         |           |           | + Ofp +   |
|    |           |         |           |           | Ocp +     |
|    |           |         |           |           | Off*      |
+----+-----------+---------+-----------+-----------+-----------+
| T4 | SS/PBCH   | dBm/SCS | "Off"     | -79       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are       |
|    |           |         |           |           | assigned  |
|    |           |         |           |           | to        |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | Sr        |
|    |           |         |           |           | xLevCell1 |
|    |           |         |           |           | \< 0 such |
|    |           |         |           |           | that      |
|    |           |         |           |           | selecting |
|    |           |         |           |           | Cell 3 is |
|    |           |         |           |           | g         |
|    |           |         |           |           | uaranteed |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.4.1.9.1.3.2-1A: TOTA test environment time instances of cell
power level and parameter changes

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 3 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -91       | -100      | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 is not |
|    |           |         |           |           | satisfied |
|    |           |         |           |           |           |
|    |           |         |           |           | *Mn + Ofn |
|    |           |         |           |           | + Ocn --  |
|    |           |         |           |           | Hys \< Mp |
|    |           |         |           |           | + Ofp +   |
|    |           |         |           |           | Ocp +     |
|    |           |         |           |           | Off*      |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -91       | -82       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 is     |
|    |           |         |           |           | satisfied |
|    |           |         |           |           |           |
|    |           |         |           |           | *Mn + Ofn |
|    |           |         |           |           | + Ocn --  |
|    |           |         |           |           | Hys \> Mp |
|    |           |         |           |           | + Ofp +   |
|    |           |         |           |           | Ocp +     |
|    |           |         |           |           | Off*      |
+----+-----------+---------+-----------+-----------+-----------+
| T2 | SS/PBCH   | dBm/SCS | -91       | "Off"     | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are       |
|    |           |         |           |           | assigned  |
|    |           |         |           |           | to        |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | Sr        |
|    |           |         |           |           | xLevCell3 |
|    |           |         |           |           | \< 0 such |
|    |           |         |           |           | that      |
|    |           |         |           |           | selecting |
|    |           |         |           |           | Cell 1 is |
|    |           |         |           |           | g         |
|    |           |         |           |           | uaranteed |
+----+-----------+---------+-----------+-----------+-----------+
| T3 | SS/PBCH   | dBm/SCS | -91       | -82       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 is     |
|    |           |         |           |           | satisfied |
|    |           |         |           |           |           |
|    |           |         |           |           | *Mn + Ofn |
|    |           |         |           |           | + Ocn --  |
|    |           |         |           |           | Hys \> Mp |
|    |           |         |           |           | + Ofp +   |
|    |           |         |           |           | Ocp +     |
|    |           |         |           |           | Off*      |
+----+-----------+---------+-----------+-----------+-----------+
| T4 | SS/PBCH   | dBm/SCS | "Off"     | -82       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are       |
|    |           |         |           |           | assigned  |
|    |           |         |           |           | to        |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | Sr        |
|    |           |         |           |           | xLevCell1 |
|    |           |         |           |           | \< 0 such |
|    |           |         |           |           | that      |
|    |           |         |           |           | selecting |
|    |           |         |           |           | Cell 3 is |
|    |           |         |           |           | g         |
|    |           |         |           |           | uaranteed |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.4.1.9.1.3.2-2: Main behaviour

  St    Procedure                                                                                                                                                        Message Sequence   TP                                     Verdict   
  ----- ---------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                         U - S              Message                                          
  1     The SS transmits an *RRCReconfiguration* message on NR Cell 1 to configure NR Cell 3 as an SCell                                                                 \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  2     The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1.                                                                                           \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  3     The SS transmits an *RRCReconfiguration* message on NR Cell 1 to setup event A3 reporting configuration.                                                         \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  4     The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1.                                                                                           \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  5     The SS changes NR Cell 1 and NR Cell 3 parameters according to the row \"T1\" in table 8.1.4.1.9.1.3.2-1/1A                                                      \-                 \-                                     \-        \-
  6     The UE transmits a *MeasurementReport* message on NR Cell 1 to report event A3 with the measured RSRP, RSRQ value for NR Cell 3.                                 \--\>              NR RRC: *MeasurementReport*            \-        \-
  7     The SS transmits an *RRCReconfiguration* message on NR Cell 1 to order the UE to perform inter frequency handover to NR Cell 3 and to release SCell NR Cell 3.   \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  \-    EXCEPTION: In parallel to the events described in step 8 the steps specified in Table 8.1.4.1.9.1.3.2-3 should take place.                                       \-                 \-                                     \-        \-
  8     The SS changes NR Cell 1 and NR Cell 3 parameters according to the row \"T2\" in table 8.1.4.1.9.1.3.2-1/1A                                                      \-                 *-*                                    \-        \-
  9     Check: Does the UE transmit an *RRCReestablishmentRequest* message on NR Cell 1?                                                                                 \--\>              NR RRC: *RRCReestablishmentRequest*    1         P
  10    The SS transmits an *RRCReestablishment* message to resume SRB1 operation and re-activate security on NR Cell 1.                                                 \<\--              NR RRC: *RRCReestablishment*           \-        \-
  11    The UE transmits an *RRCReestablishmentComplete* message                                                                                                         \--\>              NR RRC: *RRCReestablishmentComplete*   \-        \-
  11A   Void                                                                                                                                                             \-                 *-*                                    \-        \-
  12    The SS transmits an *RRCReconfiguration* message to resume existing radio bearer on NR Cell 1                                                                    \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  13    The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1                                                                                            \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  13A   The SS changes NR Cell 1 and NR Cell 3 parameters according to the row \"T0\" in table 8.1.4.1.9.1.3.2-1/1A                                                      \-                 \-                                     \-        \-
  13B   The SS transmits an RRCReconfiguration message to configure NR Cell 3 as an SCell                                                                                \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  13C   The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1                                                                                            \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  14    The SS transmits an *RRCReconfiguration* message on NR Cell 1 to setup event A3 reporting configuration.                                                         \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  15    The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1.                                                                                           \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  16    Void                                                                                                                                                             \-                 *-*                                    \-        \-
  16A   The SS changes NR Cell 1 and NR Cell 3 parameters according to the row \"T3\" in table 8.1.4.1.9.1.3.2-1/1A                                                      \-                 \-                                     \-        \-
  17    The UE transmits a *MeasurementReport* message on NR Cell 1 to report event A3 with the measured RSRP, RSRQ value for NR Cell 3.                                 \--\>              NR RRC: *MeasurementReport*            \-        \-
  18    The SS transmits an *RRCReconfiguration* message on NR Cell 1 to order the UE to perform handover to NR Cell 3 and to release SCell NR Cell3.                    \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  \-    EXCEPTION: In parallel to the events described in step 19 the steps specified in Table 8.1.4.1.9.1.3.2-3 should take place.                                      \-                 \-                                     \-        \-
  19    The SS changes NR Cell 1 and NR Cell 3 parameters according to the row \"T4\" in table 8.1.4.1.9.1.3.2-1/1A                                                      \-                 *-*                                    \-        \-
  20    Check: Does the UE transmit an *RRCReestablishmentRequest* message on NR Cell 3?                                                                                 \--\>              NR RRC: *RRCReestablishmentRequest*    2         P
  21    The SS transmits an *RRCReestablishment* message to resume SRB1 operation and re-activate security on NR Cell 3.                                                 \<\--              NR RRC: *RRCReestablishment*           \-        \-
  22    The UE transmits an *RRCReestablishmentComplete* message                                                                                                         \--\>              NR RRC: *RRCReestablishmentComplete*   \-        \-
  23    The SS transmits an *RRCReconfiguration* message to resume existing radio bearer on NR Cell 3.                                                                   \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  24    The UE transmits an *RRCReconfigurationComplete* message on NR Cell 3.                                                                                           \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-

Table 8.1.4.1.9.1.3.2-3: Parallel behaviour

  St   Procedure                                                                                                Message Sequence   TP        Verdict   
  ---- -------------------------------------------------------------------------------------------------------- ------------------ --------- --------- ----
                                                                                                                U - S              Message             
  \-   EXCEPTION: The steps 1 and 2 below are repeated for the duration of T304.                                \-                 *-*       \-        \-
  1    The UE attempts to perform the inter frequency handover using MAC Random Access Preamble on NR Cell 3.   \-                 *-*       \-        \-
  2    The SS does not respond.                                                                                 \-                 *-*       \-        \-

##### 8.1.4.1.9.1.3.3 Specific message contents {#specific-message-contents-71 .H6}

Table 8.1.4.1.9.1.3.3-1: SIB1 for NR Cell 1 and NR Cell 3 (Preamble and
all the steps in Table 8.1.4.1.9.1.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/Remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                          
  servingCellConfigCommon SEQUENCE {                                           
  uplinkConfigCommon SEQUENCE {                                                
  initialUplinkBWP SEQUENCE {                                                  
  rach-ConfigCommon SEQUENCE {                                                 
  rach-ConfigGeneric SEQUENCE {                                                
  preambleTransMax                                    n50                      
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.4.1.9.1.3.3-2: RRCReconfiguration (step 1 and 13B, Table
8.1.4.1.9.1.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-13                               
  ---------------------------------------------------- ----------------- --------- -----------
  Information Element                                  Value/Remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                
  criticalExtensions CHOICE {                                                      
  rrcReconfiguration SEQUENCE {                                                    
  masterCellGroup                                      CellGroupConfig             
  }                                                                                
  }                                                                                
  }                                                                                

Table 8.1.4.1.9.1.3.3-3: CellGroupConfig (Table 8.1.4.1.9.1.3.3-2)

  Derivation path: TS 38.508-1 \[4\], table 4.6.3-19                                                          
  ----------------------------------------------------------------------- ------------------------- --------- -----------
  Information Element                                                     Value/Remark              Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                              
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {   1 entry                             
  SCellConfig\[1\] SEQUENCE {                                                                       entry 1   
  sCellIndex                                                              1                                   
  sCellConfigCommon                                                       ServingCellConfigCommon             
  sCellConfigDedicated                                                    ServingCellConfig                   
  }                                                                                                           
  }                                                                                                           
  sCellToReleaseList                                                      Not present                         
  }                                                                                                           

Table 8.1.4.1.9.1.3.3-4: ServingCellConfigCommon (Table
8.1.4.1.9.1.3.3-3)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-168                                                         
  ----------------------------------------------------- ------------------------------------------- --------- -----------
  Information Element                                   Value/remark                                Comment   Condition
  ServingCellConfigCommon ::= SEQUENCE {                                                                      
  physCellId                                            Physical layer cell identity of NR Cell 3             
  }                                                                                                           

Table 8.1.4.1.9.1.3.3-5: RRCReconfiguration (steps 3 and 14, Table
8.1.4.1.9.1.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-13 and condition NR\_MEAS                                                
  --------------------------------------------------------------------------- ----------------- -------------------------- -----------
  Information Element                                                         Value/remark      Comment                    Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                        
  criticalExtensions CHOICE {                                                                                              
  rrcReconfiguration SEQUENCE {                                                                                            
  measConfig                                                                  MeasConfig        Table 8.1.4.1.9.1.3.3-6    
  nonCriticalExtension SEQUENCE {                                                                                          
  masterCellGroup                                                             CellGroupConfig   Table 8.1.4.1.9.1.3.3-9A   
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        

Table 8.1.4.1.9.1.3.3-6: MeasConfig (Table 8.1.4.1.9.1.3.3-5)

  Derivation path: TS 38.508-1\[4\], table 4.6.3-69                                                                          
  ------------------------------------------------------------------------------------------ ------------------- ----------- -----------
  Information Element                                                                        Value/Remark        Comment     Condition
  measConfig ::= SEQUENCE {                                                                                                  
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                       
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                             entry 1     
  measObjectId                                                                               1                               
  measObject CHOICE {                                                                                                        
  measObjectNR                                                                               MeasObjectNR-f1     NR Cell 1   
  }                                                                                                                          
  }                                                                                                                          
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                             entry 2     
  measObjectId                                                                               2                               
  measObject CHOICE {                                                                                                        
  measObjectNR                                                                               MeasObjectNR-f2     NR Cell 3   
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                         
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                           entry 1     
  reportConfigId\[1\]                                                                        1                               
  reportConfig\[1\] CHOICE {                                                                                                 
  reportConfigNR                                                                             ReportConfigNR-A3               
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                         
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                 entry 1     
  measId                                                                                     1                               
  measObjectId                                                                               2                               
  reportConfigId                                                                             1                               
  }                                                                                                                          
  }                                                                                                                          

Table 8.1.4.1.9.1.3.3-7: *MeasObjectNR*-f1 (Table 8.1.4.1.9.1.3.3-6)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                               
  ---------------------------------------------------- --------------------------------- --------- -----------
  Information Element                                  Value/remark                      Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                       
  ssbFrequency                                         Downlink ARFCN of NR Cell 1 SSB             
  absThreshSS-BlocksConsolidation                      Not present                                 
  nrofSS-BlocksToAverage                               Not present                                 
  }                                                                                                

Table 8.1.4.1.9.1.3.3-8: *MeasObjectNR*-f2 (Table 8.1.4.1.9.1.3.3-6)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                               
  ---------------------------------------------------- --------------------------------- --------- -----------
  Information Element                                  Value/remark                      Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                       
  ssbFrequency                                         Downlink ARFCN of NR Cell 3 SSB             
  absThreshSS-BlocksConsolidation                      Not present                                 
  nrofSS-BlocksToAverage                               Not present                                 
  }                                                                                                

Table 8.1.4.1.9.1.3.3-9: *ReportConfigNR-A3* (Table 8.1.4.1.9.1.3.3-6)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-142 with condition EVENT\_A3                                                                                                                                                                                                                          
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------ -------------------------------------------------------- -----------
  Information Element                                                                                                                                                                                           Value/remark                   Comment                                                  Condition
  ReportConfigNR::= SEQUENCE {                                                                                                                                                                                                                                                                          
  reportType CHOICE {                                                                                                                                                                                                                                                                                   
  eventTriggered SEQUENCE {                                                                                                                                                                                                                                                                             
  eventId CHOICE {                                                                                                                                                                                                                                                                                      
  eventA3 SEQUENCE {                                                                                                                                                                                                                                                                                    
  a3-Offset CHOICE {                                                                                                                                                                                                                                                                                    
  rsrp                                                                                                                                                                                                          2                              1 dB (2\*0.5 dB)                                         FR1
                                                                                                                                                                                                                2+ Delta(NRf2) - Delta(NRf1)   a3-Offset value set to (2+ Delta(NRf2) - Delta(NRf1)).   FR2
  }                                                                                                                                                                                                                                                                                                     
  timeToTrigger                                                                                                                                                                                                 ms2560                                                                                  
  }                                                                                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                                                                                     
  NOTE 1: Delta(NRf~2~) and Delta(NRf~1~) are derived based on calibration procedure defined in the TS 38.508-1 \[4\], clause 6.1.3.3 where Delta(NRf~1~) derived NR Cell1 and Delta(NRf~2~) derived NR Cell3                                                                                           

Table 8.1.4.1.9.1.3.3-9A: *CellGroupConfig* (Table 8.1.4.1.9.1.3.3-5)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition MEAS                                                     
  ------------------------------------------------------------------------ ---------------------- -------------------------- -----------
  Information Element                                                      Value/remark           Comment                    Condition
  CellGroupConfig ::= SEQUENCE {                                                                                             
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {    1 entry                                           
  SCellConfig\[1\] SEQUENCE {                                                                     entry 1                    
  sCellIndex                                                               SCellIndex of Cell 3                              
  sCellConfigDedicated                                                     ServingCellConfig      Table 8.1.4.1.9.1.3.3-9B   
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          

Table 8.1.4.1.9.1.3.3-9B: *ServingCellConfig* (Table 8.1.4.1.9.1.3.3-9A)

  Derivation Path: TS 38.331 \[6\], Table 4.6.3-167 with condition MEAS                            
  ----------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                     Value/remark   Comment   Condition
  ServingCellConfig ::= SEQUENCE {                                                                 
  servingCellMO                                                           2                        
  }                                                                                                

Table 8.1.4.1.9.1.3.3-10: *MeasurementReport* (steps 6 and 17, Table
8.1.4.1.9.1.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-5A                                                          
  ----------------------------------------------------------------------- ------------------------- --------- -----------
  Information Element                                                     Value/remark              Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                            
  criticalExtensions CHOICE {                                                                                 
  measurementReport SEQUENCE {                                                                                
  measResults SEQUENCE {                                                                                      
  measResultServingMOList                                                 Not checked                         
  measResultNeighCells CHOICE {                                           1 entry                             
  measResultListNR SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {                                       
  MeasResultNR\[1\] SEQUENCE {                                                                      entry 1   
  physCellId                                                              PhysCellId of NR Cell 3             
  measResult SEQUENCE {                                                                                       
  cellResults SEQUENCE {                                                                                      
  resultsSSB-Cell SEQUENCE {                                                                                  
  rsrp                                                                    (0..127)                            
  rsrp                                                                    (0..127)                            
  sinr                                                                    (0..127)                            
  }                                                                                                           
  resultsCSI-RS-Cell                                                      Not present                         
  }                                                                                                           
  rsIndexResults                                                          Not present                         
  }                                                                                                           
  }                                                                                                           
  }                                                                                                           
  }                                                                                                           
  }                                                                                                           
  }                                                                                                           
  }                                                                                                           
  }                                                                                                           

Table 8.1.4.1.9.1.3.3-11: RRCReconfiguration (steps 7 and 18, Table
8.1.4.1.9.1.3.2-2)

  Derivation Path: TS 38.508-1\[4\], table 4.6.1-13 with condition NR                               
  --------------------------------------------------------------------- ----------------- --------- -----------
  Information Element                                                   Value/Remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                 
  criticalExtensions CHOICE {                                                                       
  rrcReconfiguration SEQUENCE {                                                                     
  nonCriticalExtension SEQUENCE {                                                                   
  masterCellGroup                                                       CellGroupConfig             
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 

Table 8.1.4.1.9.1.3.3-12: CellGroupConfig (Table 8.1.4.1.9.1.3.3-11)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| table 4.6.3-19  |                 |                 |           |
| with condition  |                 |                 |           |
| PCell\_Change   |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| CellGroupConfig |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spCellConfig    |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reconfig        |                 |                 |           |
| urationWithSync |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spC             |                 |                 |           |
| ellConfigCommon |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| physCellId      | PhysCellId of   |                 |           |
|                 | NR Cell 3       |                 |           |
+-----------------+-----------------+-----------------+-----------+
| downl           |                 |                 |           |
| inkConfigCommon |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| frequencyInfoDL |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| absol           | Downlink ARFCN  |                 |           |
| uteFrequencySSB | of NR Cell 3    |                 |           |
|                 | SSB             |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rach-           |                 |                 |           |
| ConfigDedicated |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| uplink SEQUENCE |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cfra SEQUENCE { |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| resources       |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ssb SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| s               | 1 entry         |                 |           |
| sb-ResourceList |                 |                 |           |
| SEQUENCE        |                 |                 |           |
| (SIZE(1..maxRA- |                 |                 |           |
| SSB-Resources)) |                 |                 |           |
| OF              |                 |                 |           |
| CF              |                 |                 |           |
| RA-SSB-Resource |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| CFRA-SS         |                 | entry 1         |           |
| B-Resource\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| r               | 63              |                 |           |
| a-PreambleIndex |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sCe             | 1 entry         |                 |           |
| llToReleaseList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofSCells)) |                 |                 |           |
| OF SCellIndex { |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| SCellIndex\[1\] | 1               | entry 1         |           |
|                 |                 |                 |           |
|                 |                 | SCellIndex of   |           |
|                 |                 | NR Cell 3       |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.4.1.9.1.3.3-13: *RRCReestablishmentRequest* (steps 9 and 20,
Table 8.1.4.1.9.1.3.2-2)

  ---------------------------------------------------- ------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-12                                       
  Information Element                                  Value/remark              Comment   Condition
  RRCReestablishmentRequest ::= SEQUENCE {                                                 
  ue-Identity SEQUENCE {                                                                   
  physCellId                                           PhysCellId of NR Cell 1             
  }                                                                                        
  reestablishmentCause                                 handoverFailure                     
  }                                                                                        
  ---------------------------------------------------- ------------------------- --------- -----------

Table 8.1.4.1.9.1.3.3-14: *RRCReestablishment* (steps 10 and 21, Table
8.1.4.1.9.1.3.2-2)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-10                            
  Information Element                                  Value/remark   Comment   Condition
  RRCReestablishment ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                   
  rrcReestablishment SEQUENCE {                                                 
  nextHopChainingCount                                 0                        
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.4.1.9.1.3.3-15: RRCReconfiguration (Steps 12 and 23, Table
8.1.4.1.9.1.3.2-2)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

###### 8.1.4.1.9.2 NR CA / Intra NR handover / Failure / Re-establishment successful / Inter-band CA 

##### 8.1.4.1.9.2.1 Test Purpose (TP) {#test-purpose-tp-80 .H6}

**Same as TC 8.1.4.1.9.1 but applied to Inter-band CA case**

##### 8.1.4.1.9.2.2 Conformance requirements {#conformance-requirements-80 .H6}

**Same as TC 8.1.4.1.9.1 but applied to Inter-band CA case**

##### 8.1.4.1.9.2.3 Test Description {#test-description-80 .H6}

##### 8.1.4.1.9.2.3.1 Pre-test conditions {#pre-test-conditions-80 .H6}

Same as test case **8.1.4.1.9.1** with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3.

\- NR Cell 10 is an Inactive SCell according to TS 38.508-1 \[4\] clause
6.3.1.

##### 8.1.4.1.9.2.3.2 Test procedure sequence {#test-procedure-sequence-81 .H6}

Same as test case **8.1.4.1.9.1** with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3.

##### 8.1.4.1.9.2.3.3 Specific message contents {#specific-message-contents-72 .H6}

**Same as TC 8.1.4.1.9.1 but applied to Inter-band CA case**

###### 8.1.4.1.9.3 NR CA / Intra NR handover / Failure / Re-establishment successful / Intra-band non-contiguous CA 

##### 8.1.4.1.9.3.1 Test Purpose (TP) {#test-purpose-tp-81 .H6}

**Same as TC 8.1.4.1.9.1 but applied to Intra-band non-contiguous CA
case**

##### 8.1.4.1.9.3.2 Conformance requirements {#conformance-requirements-81 .H6}

**Same as TC 8.1.4.1.9.1 but applied to Intra-band non-contiguous CA
case**

##### 8.1.4.1.9.3.3 Test Description {#test-description-81 .H6}

##### 8.1.4.1.9.3.3.1 Pre-test conditions {#pre-test-conditions-81 .H6}

Same as test case **8.1.4.1.9.1** with the following differences:

\- CA configuration: Intra-band Contiguous CA replaces Intra-band
non-contiguous CA.

##### 8.1.4.1.9.3.3.2 Test procedure sequence {#test-procedure-sequence-82 .H6}

Same as test case **8.1.4.1.9.1** with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

##### 8.1.4.1.9.3.3.3 Specific message contents {#specific-message-contents-73 .H6}

Same as TC 8.1.4.1.9.1 but applied to Intra-band non-contiguous CA case

##### 8.1.4.1.10 eCall Only mode / Intra NR handover / Success / Inter-frequency

##### 8.1.4.1.10.1 Test Purpose (TP) {#test-purpose-tp-82 .H6}

\(1\)

**with** { UE in eCall Only mode and an eCall over IMS is ongoing }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including a
reconfigurationWithSync for handover }

**then** { UE performs handover to the target cell and transmits an
RRCReconfigurationComplete message }

}

##### 8.1.4.1.10.2 Conformance requirements {#conformance-requirements-82 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clauses 5.3.5.3, 5.3.5.5.1, 5.3.5.5.2,
5.5.4.4, 5.2.2.4.2 and 6.2.2.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> if the *RRCReconfiguration* message includes the
*radioBearerConfig*:

2\> perform the radio bearer configuration according to 5.3.5.6;

...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

1\> if *reconfigurationWithSync* was included in *spCellConfig* of an
MCG or SCG, and when MAC of an NR cell group successfully completes a
Random Access procedure triggered above:

2\> stop timer T304 for that cell group;

2\> stop timer T310 for source SpCell if running;

...

2\> apply the parts of the measurement and the radio resource
configuration that require the UE to know the SFN of the respective
target SpCell (e.g. measurement gaps, periodic CQI reporting, scheduling
request configuration, sounding RS configuration), if any, upon
acquiring the SFN of that target SpCell;

...

2\> if the *reconfigurationWithSync* was included in *spCellConfig* of
an MCG:

3\> if T390 is running:

4\> stop timer T390 for all access categories;

4\> perform the actions as specified in 5.3.14.4.

3\> if T350 is running:

4\> stop timer T350;

3\> if *RRCReconfiguration* does not include *dedicatedSIB1-Delivery*
and

3\> if the active downlink BWP, which is indicated by the
*firstActiveDownlinkBWP-Id* for the target SpCell of the MCG, has a
common search space configured by *searchSpaceSIB1*:

4\> acquire the *SIB1*, which is scheduled as specified in TS 38.213
\[13\], of the target SpCell of the MCG;

4\> upon acquiring *SIB1*, perform the actions specified in clause
5.2.2.4.2;

> ...

2\> the procedure ends.

> NOTE 3: The UE is only required to acquire broadcasted *SIB1* if the
> UE can acquire it without disrupting unicast data reception, i.e. the
> broadcast and unicast beams are quasi co-located.

\[TS 38.331, clause 5.3.5.5.1\]

The network configures the UE with Master Cell Group (MCG), and zero or
one Secondary Cell Group (SCG). In (NG)EN-DC, the MCG is configured as
specified in TS 36.331 \[10\], and for NE-DC, the SCG is configured as
specified in TS 36.331 \[10\]. The network provides the configuration
parameters for a cell group in the *CellGroupConfig* IE.

The UE performs the following actions based on a received
*CellGroupConfig* IE:

1\> if the *CellGroupConfig* contains the *spCellConfig* with
*reconfigurationWithSync*:

2\> perform Reconfiguration with sync according to 5.3.5.5.2;

2\> resume all suspended radio bearers except the SRBs for the source
cell group, and resume SCG transmission for all radio bearers, and
resume BH RLC channels and resume SCG transmission for BH RLC channels
for IAB-MT, if suspended;

...

1\> if the *CellGroupConfig* contains the *rlc-BearerToAddModList*:

2\> perform the RLC bearer addition/modification as specified in
5.3.5.5.4;

1\> if the *CellGroupConfig* contains the *mac-CellGroupConfig*:

2\> configure the MAC entity of this cell group as specified in
5.3.5.5.5;

...

1\> if the *CellGroupConfig* contains the *spCellConfig*:

2\> configure the SpCell as specified in 5.3.5.5.7;

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the AS security is not activated, perform the actions upon going
to RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\'
upon which the procedure ends;

1\> if no DAPS bearer is configured:

2\> stop timer T310 for the corresponding SpCell, if running;

> 1\> if this procedure is executed for the MCG:

2\> if timer T316 is running;

3\> stop timer T316;

3\> clear the information included in *VarRLF-Report*, if any;

2\> resume MCG transmission, if suspended.

1\> stop timer T312 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1 for the
target SpCell;

1\> acquire the *MIB* of the target SpCell, which is scheduled as
specified in TS 38.213 \[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the *MIB* if the UE already has the
required timing information, or the timing information is not needed for
random access.

*...*

1\> else:

2\> reset the MAC entity of this cell group;

2\> consider the SCell(s) of this cell group, if configured, that are
not included in the *SCellToAddModList* in the *RRCReconfiguration*
message, to be in deactivated state;

2\> apply the value of the *newUE-Identity* as the C-RNTI for this cell
group;

2\> configure lower layers in accordance with the received
s*pCellConfigCommon*;

2\> configure lower layers in accordance with any additional fields, not
covered in the previous, if included in the received
*reconfigurationWithSync.*

\[TS 38.331, clause 5.5.4.4\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A3-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A3-2, as specified below, is fulfilled;

1\> use the SpCell for *Mp*, *Ofp and Ocp*.

NOTE 1: The cell(s) that triggers the event has reference signals
indicated in the *measObjectNR* associated to this event which may be
different from the NR SpCell *measObjectNR*.

Inequality A3-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Mp + Ofp + Ocp + Off*

Inequality A3-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Mp + Ofp + Ocp + Off*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the reference
signal of the neighbour cell (i.e. *offsetMO* as defined within
*measObjectNR* corresponding to the neighbour cell).

***Ocn*** is the cell specific offset of the neighbour cell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the frequency of the neighbour cell), and set to zero if not configured
for the neighbour cell.

***Mp*** is the measurement result of the SpCell, not taking into
account any offsets.

***Ofp*** is the measurement object specific offset of the SpCell (i.e.
*offsetMO* as defined within *measObjectNR* corresponding to the
SpCell).

***Ocp*** is the cell specific offset of the SpCell (i.e.
*cellIndividualOffset* as defined within *measObjectNR* corresponding to
the SpCell), and is set to zero if not configured for the SpCell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Off*** is the offset parameter for this event (i.e. *a3-Offset* as
defined within *reportConfigNR* for this event).

***Mn, Mp*** are expressed in dBm in case of RSRP, or in dB in case of
RSRQ and RS-SINR.

***Ofn***, ***Ocn***, ***Ofp***, ***Ocp***, ***Hys***, ***Off*** are
expressed in dB.

NOTE 2: The definition of Event A3 also applies to CondEvent A3.

\[TS 38.331, clause 5.2.2.4.2\]

Upon receiving the *SIB1* the UE shall:

1\> store the acquired *SIB1*;

...

4\> forward the *eCallOverIMS-Support* to upper layers, if present;

\[TS 38.331, clause 6.2.2\]

##### eCallOverIMS-Support {#ecalloverims-support .H6}

Indicates whether the cell supports eCall over IMS services as defined
in TS 23.501 \[32\]. If absent, eCall over IMS is not supported by the
network in the cell.

##### 8.1.4.1.10.3 Test description {#test-description-82 .H6}

##### 8.1.4.1.10.3.1 Pre-test conditions {#pre-test-conditions-82 .H6}

##### System Simulator: {#system-simulator-53 .H6}

\- NR Cell 1 is the serving cell and NR Cell 3 is the inter-frequency
neighbour cell of NR Cell 1.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-50 .H6}

> \- the eCall capable UE is equipped with 'eCall only' enabled USIM
> configured as per TS 38.508-1 \[4\] Table 6.4.1-24.

##### Preamble: {#preamble-51 .H6}

\- An eCall is established according to TS 38.508-1 \[4\] clause 4.9.29
using condition A21 (automatic eCall initiation) for the INVITE at step
1 of TS 34.229-5 \[41\] annex A.23.

##### 8.1.4.1.10.3.2 Test procedure sequence {#test-procedure-sequence-83 .H6}

Table 8.1.4.1.10.3.2-1/1A illustrate the downlink power levels to be
applied for NR Cell 1 and NR Cell 3 at various time instants of the test
execution. Row marked \"T0\" denotes the conditions after the preamble,
while the configuration marked \"T1\" is applied at the point indicated
in the Main behaviour description in Table 8.1.4.1.10.3.2-2.

Table 8.1.4.1.10.3.2-1: Power levels in FR1

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 3 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -85       | -91    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied    |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -85       | -79    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | for NR Cell  |
|    |              |      |           |        | 3            |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.4.1.10.3.2-1A: Power levels in FR2

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 3 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -91       | -100   | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied    |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -91       | -82    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | for NR Cell  |
|    |              |      |           |        | 3            |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.4.1.10.3.2-2: Main behaviour

  St   Procedure                                                                                                                                                Message Sequence   TP                                     Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup intra NR measurement and reporting for inter-frequency event A3.        \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    SS adjusts the cell-specific reference signal level according to row \"T1\".                                                                             \-                 *-*                                    \-        \-
  4    The UE transmits a *MeasurementReport* message to report event A3 with the measured RSRP value for NR Cell 3.                                            \--\>              *NR RRC: MeasurementReport*            \-        \-
  5    The SS transmits an *RRCReconfiguration* message *including reconfigurationWithSync to order the UE to perform inter-frequency handover to NR Cell 3.*   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  6    Check: Does the UE transmit RRCReconfigurationComplete message on NR Cell 3?                                                                             \--\>              *NR RRC: RRCReconfigurationComplete*   1         P
  7    Release eCall over IMS using the generic procedure described in TS 34.229-5 \[41\] subclause A.8 using condition A9 for the BYE at step 1.               \-                 *-*                                    \-        \-

##### 8.1.4.1.10.3.3 Specific message contents {#specific-message-contents-74 .H6}

Table 8.1.4.1.10.3.3-1: SIB1 for NR Cell 1, NR Cell 3 (All steps, Table
8.1.4.1.10.3.2-2)

  -------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\] table 4.6.1-28 Condition eCalloverIMSforNR
  -------------------------------------------------------------------------------

Table 8.1.4.1.10.3.3-2: *RRCReconfiguration* (step 1, Table
8.1.4.1.10.3.2-2)

  -----------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition MEAS
  -----------------------------------------------------------------------

Table 8.1.4.1.10.3.3-3: *MeasConfig* (Table 8.1.4.1.10.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                     
  ------------------------------------------------------------------------------------------ ------------------------------------------------ --------- -----------
  Information Element                                                                        Value/remark                                     Comment   Condition
  MeasConfig ::= SEQUENCE {                                                                                                                             
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                                  
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                          entry 1   
  measObjectId                                                                               1                                                          
  measObject CHOICE {                                                                                                                                   
  measObjectNR SEQUENCE {                                                                                                                               
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 3             
  absThreshSS-BlocksConsolidation                                                            Not present                                                
  }                                                                                                                                                     
  }                                                                                                                                                     
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                          entry 2   
  measObjectId                                                                               2                                                          
  measObject CHOICE {                                                                                                                                   
  measObjectNR SEQUENCE {                                                                                                                               
  ssbFrequency                                                                               ssbFrequency IE equals the ARFCN for NR Cell 1             
  absThreshSS-BlocksConsolidation                                                            Not present                                                
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                    
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                        entry 1   
  reportConfigId                                                                             1                                                          
  reportConfig CHOICE {                                                                                                                                 
  reportConfigNR                                                                             ReportConfigNR-EventA3                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  }                                                                                                                                                     
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                    
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                              entry 1   
  measId                                                                                     1                                                          
  measObjectId                                                                               1                                                          
  reportConfigId                                                                             1                                                          
  }                                                                                                                                                     
  }                                                                                                                                                     
  measGapConfig                                                                              MeasGapConfig                                              
  }                                                                                                                                                     

Table 8.1.4.1.10.3.3-4: *ReportConfigNR-EventA3* (Table
8.1.4.1.10.3.3-3)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| Table 4.6.3-142 |                 |                 |           |
| with condition  |                 |                 |           |
| EVENT\_A3       |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConfigNR  |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportType      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventTriggered  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventId CHOICE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventA3         |                 |                 | EVENT\_A3 |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| a3-Offset       |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | 2               | a3-Offset       | FR1       |
|                 |                 | Thresh value    |           |
|                 |                 | set to 1dB      |           |
|                 |                 | (2\*0.5)        |           |
+-----------------+-----------------+-----------------+-----------+
|                 | 2 + Delta(NRf2) | a3-Offset value | FR2       |
|                 | - Delta(NRf1)   | set to (2+      |           |
|                 |                 | Delta(NRf2) -   |           |
|                 |                 | Del             |           |
|                 |                 | ta(NRf1))\*0.5. |           |
|                 |                 |                 |           |
|                 |                 | (Note 1)        |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| hysteresis      | 0               | 0 dB            |           |
+-----------------+-----------------+-----------------+-----------+
| timeToTrigger   | ms640           |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportAmount    | r1              |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rep             |                 |                 |           |
| ortQuantityCell |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | true            |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrq            | false           |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sinr            | false           |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Note 1:         |                 |                 |           |
| Delta(NRf~2~)   |                 |                 |           |
| and             |                 |                 |           |
| Delta(NRf~1~)   |                 |                 |           |
| are derived     |                 |                 |           |
| based on        |                 |                 |           |
| calibration     |                 |                 |           |
| procedure       |                 |                 |           |
| defined in the  |                 |                 |           |
| TS 38.508-1     |                 |                 |           |
| \[4\], clause   |                 |                 |           |
| 6.1.3.3.        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.4.1.10.3.3-5: *MeasurementReport* (step 4, Table
8.1.4.1.10.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                              
  ---------------------------------------------------------------------------------------- ------------------------------------------- --------- --------------------
  Information Element                                                                      Value/remark                                Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                                    
  measurementReport SEQUENCE {                                                                                                                   
  measResults SEQUENCE {                                                                                                                         
  measId                                                                                   1                                                     
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                                               
  MeasResultServMO\[1\] SEQUENCE {                                                                                                     entry 1   
  servCellId                                                                               Cell index corresponding to NR Cell 1                 
  measResultServingCell SEQUENCE {                                                                                                               
  physCellId                                                                               Physical layer cell identity of NR Cell 1             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     (0..127)                                              
  sinr                                                                                     Not present                                           
                                                                                           Not checked                                           pc\_ss\_SINR\_Meas
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  measResultNeighCells CHOICE {                                                                                                                  
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                                               
  MeasResultNR\[1\] SEQUENCE {                                                                                                         entry 1   
  physCellId                                                                               Physical layer cell identity of NR Cell 3             
  measResult SEQUENCE {                                                                                                                          
  cellResults SEQUENCE {                                                                                                                         
  resultsSSB-Cell SEQUENCE {                                                                                                                     
  rsrp                                                                                     (0..127)                                              
  rsrq                                                                                     Not present                                           
  sinr                                                                                     Not present                                           
  }                                                                                                                                              
  resultsCSI-RS-Cell                                                                       Not present                                           
  }                                                                                                                                              
  rsIndexResults                                                                           Not present                                           
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

Table 8.1.4.1.10.3.3-6: *RRCReconfiguration* (step 5, Table
8.1.4.1.10.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                                         
  -------------------------------------------------------------------------------------- ------------------------------------------- ----------------------------------------- -----------
  Information Element                                                                    Value/remark                                Comment                                   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                                                                                
  measConfig SEQUENCE {                                                                                                                                                        
  measObjectToRemoveList SEQUENCE (SIZE (1..maxNrofObjectId)) OF MeasObjectId {          2 entries                                                                             
  measObjectId\[1\]                                                                      1                                           entry 1                                   
  measObjectId\[2\]                                                                      2                                           entry 2                                   
  }                                                                                                                                                                            
  measIdToRemoveList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasId {                      1 entry                                                                               
  measId\[1\]                                                                            1                                           entry 1                                   
  }                                                                                                                                                                            
  }                                                                                                                                                                            
  nonCriticalExtension SEQUENCE {                                                                                                                                              
  masterCellGroup                                                                        OCTET STRING (CONTAINING CellGroupConfig)                                             
  masterKeyUpdate SEQUENCE {                                                                                                                                                   
  keySetChangeIndicator                                                                  True                                                                                  
  nextHopChainingCount                                                                   0                                                                                     
  nas-Container                                                                          NASContainer                                Intra N1 mode NAS transparent container   
  }                                                                                                                                                                            
  }                                                                                                                                                                            
  }                                                                                                                                                                            
  }                                                                                                                                                                            
  }                                                                                                                                                                            

Table 8.1.4.1.10.3.3-7: *CellGroupConfig* (Table 8.1.4.1.10.3.3-6)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change and CFRA                                                       
  ------------------------------------------------------------------------------------------ ----------------------------------------- --------- -----------
  Information Element                                                                        Value/remark                              Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                 
  spCellConfig SEQUENCE {                                                                                                                        
  reconfigurationWithSync SEQUENCE {                                                                                                             
  spCellConfigCommon SEQUENCE {                                                              Same as default ServingCellConfigCommon             
  physCellId                                                                                 Physical cell Id of NR Cell 3                       
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

Table 8.1.4.1.10.3.3-8: NASContainer (Table 8.1.4.1.10.3.3-6)

  Derivation Path: TS 24.501, table 9.11.2.6                                                                                                                                                                                                              
  -------------------------------------------- ---------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------- -----------
  Information Element                          Value/Remark                                                                                         Comment                                                                                               Condition
  Message authentication code                  The calculated value of MAC-I for this message.                                                      The value of MAC-I is calculated by SS using COUNT = 0xFFFFFFFF( as per TS 33.501\[20\], 6.9.2.3.3)   
  Type of ciphering algorithm                  Set according to PIXIT px\_NAS\_5GC\_CipheringAlgorithm for default ciphering algorithm                                                                                                                    
  Type of integrity protection algorithm       Set according to PIXIT px\_NAS\_5GC\_IntegrityAlgorithm for default integrity protection algorithm   This value should not be equal to the null integrity algorithm.                                       
  KACF                                         '1'B                                                                                                 a new K~AMF~ has been calculated by the network                                                       
  TSC                                          \'0\'B                                                                                               native security context (for KSI~AMF~)                                                                
  Key set identifier in 5G                     KSI~AMF~ that was created when the UE last registered to 5GCN                                                                                                                                              
  Sequence number                              The internal counter of the SS                                                                       eight least significant bits of the downlink NAS COUNT                                                

#### 8.1.4.2 Inter-RAT handover

##### 8.1.4.2.1 Inter-RAT handover from NR

###### 8.1.4.2.1.1 Inter-RAT handover / From NR to E-UTRA / Success

##### 8.1.4.2.1.1.1 Test Purpose (TP) {#test-purpose-tp-83 .H6}

##### (1) {#section-135 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives a MobilityFromNRCommand message }

**then** { UE transmits an RRCConnectionReconfigurationComplete message
on the E-UTRA cell }

}

##### 8.1.4.2.1.1.2 Conformance requirements {#conformance-requirements-83 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clause 5.4.3.2, clause 5.4.3.3 and clause
5.4.3.4 and TS 36.331, clause 5.4.2.2 and clause 5.4.2.3. Unless
otherwise stated these are Rel-15 requirements.

\[TS.38.331, clause 5.4.3.2\]

The network initiates the mobility from NR procedure to a UE in
RRC\_CONNECTED, possibly in response to a MeasurementReport message, by
sending a MobilityFromNRCommand message. The network applies the
procedure as follows:

\- the procedure is initiated only when AS-security has been activated,
and SRB2 with at least one DRB are setup and not suspended.

\[TS 38.331, clause 5.4.3.3\]

The UE shall:

1\> if the targetRAT-Type is set to eutra:

2\> consider inter-RAT mobility as initiated towards E-UTRA;

2\> forward the nas-SecurityParamFromNR to the upper layers, if
included;

1\> access the target cell indicated in the inter-RAT message in
accordance with the specifications of the target RAT.

\[TS.38.331, clause 5.4.3.4\]

Upon successfully completing the handover, at the source side the UE
shall:

1\> reset MAC;

1\> stop all timers that are running;

1\> release *ran-NotificationAreaInfo*, if stored;

1\> release the AS security context including the K~RRCenc~ key, the
K~RRCint~, the K~UPint~ key and the K~UPenc~ key, if stored;

1\> release all radio resources, including release of the RLC entity and
the MAC configuration;

1\> release the associated PDCP entity and SDAP entity for all
established RBs;

NOTE : PDCP and SDAP configured by the source RAT prior to the handover
that are reconfigured and re-used by target RAT when delta signalling
(i.e., during inter-RAT intra-system handover when *fullConfig* is not
present) is used, are not released as part of this procedure.

1\> indicate the release of the RRC connection to upper layers together
with the release cause \'other\'.

\[TS 36.331, clause 5.4.2.2\]

The RAN using another RAT or the E-UTRA connected to a different type of
CN initiates the handover to E-UTRA procedure, in accordance with the
specifications applicable for the other RAT or for the E-UTRA connected
to a different type of CN, by sending the *RRCConnectionReconfiguration*
message via the radio access technology from which the inter-RAT
handover is performed.

E-UTRAN applies the procedure as follows:

\- to activate ciphering, possibly using NULL algorithm, if not yet
activated in the other RAT or in the E-UTRA connected to a different
type of CN;

\- to establish SRB1, SRB2 and one or more DRBs, i.e. at least the DRB
associated with the default EPS bearer is established if the target CN
is EPC and at least one DRB is established if the target CN is 5GC.

\[TS 36.331, clause 5.4.2.3\]

If the UE is able to comply with the configuration included in the
RRCConnectionReconfiguration message, the UE shall:

1\> if the RRCConnectionReconfiguration message includes the fullConfig
and the source RAT was E-UTRA(i.e., intra-RAT inter-system handover):

...

1\> apply the default physical channel configuration as specified in
9.2.4;

1\> apply the default semi-persistent scheduling configuration as
specified in 9.2.3;

1\> apply the default MAC main configuration as specified in 9.2.2;

1\> start timer T304 with the timer value set to t304, as included in
the mobilityControlInfo;

1\> consider the target PCell to be one on the frequency indicated by
the carrierFreq with a physical cell identity indicated by the
targetPhysCellId;

1\> start synchronising to the DL of the target PCell;

1\> set the C-RNTI to the value of the newUE-Identity;

1\> for the target PCell, apply the downlink bandwidth indicated by the
dl-Bandwidth;

1\> for the target PCell, apply the uplink bandwidth indicated by (the
absence or presence of) the ul-Bandwidth;

1\> configure lower layers in accordance with the received
radioResourceConfigCommon;

1\> configure lower layers in accordance with any additional fields, not
covered in the previous, if included in the received
mobilityControlInfo;

1\> perform the radio resource configuration procedure as specified in
5.3.10;

1\> if the handoverType in securityConfigHO is set to fivegc-ToEPC:

2\> indicate to higher layer that the CN has changed from 5GC to EPC;

2\> derive the key KeNB based on the mapped KASME key as specified for
interworking between EPS and 5GS in TS 33.501 \[86\];

2\> store the nextHopChainingCount-r15 value;

1\> else if the handoverType in securityConfigHO is set to intra5GC:

...

1\> derive the KRRCint key associated with the integrityProtAlgorithm,
as specified in TS 33.401 \[32\];

1\> derive the KRRCenc key and the KUPenc key associated with the
cipheringAlgorithm, as specified in TS 33.401 \[32\];

...

1\> if the handoverType in securityConfigHO is set to fivegc-ToEPC or if
the handoverType-v1530 is not present:

2\> configure lower layers to apply the indicated integrity protection
algorithm and the KRRCint key immediately, i.e. the indicated integrity
protection configuration shall be applied to all subsequent messages
received and sent by the UE, including the message used to indicate the
successful completion of the procedure;

2\> configure lower layers to apply the indicated ciphering algorithm,
the KRRCenc key and the KUPenc key immediately, i.e. the indicated
ciphering configuration shall be applied to all subsequent messages
received and sent by the UE, including the message used to indicate the
successful completion of the procedure;

1\> if the received RRCConnectionReconfiguration includes the
sCellToAddModList:

...

1\> if the RRCConnectionReconfiguration message includes the measConfig:

2\> perform the measurement configuration procedure as specified in
5.5.2;

...

1\> submit the RRCConnectionReconfigurationComplete message to lower
layers for transmission using the new configuration;

1\> if the RRCConnectionReconfiguration message does not include
rlf-TimersAndConstants set to setup:

2\> use the default values specified in 9.2.5 for timer T310, T311 and
constant N310, N311;

1\> if MAC successfully completes the random access procedure:

2\> stop timer T304;

2\> apply the parts of the CQI reporting configuration, the scheduling
request configuration and the sounding RS configuration that do not
require the UE to know the SFN of the target PCell, if any;

2\> apply the parts of the measurement and the radio resource
configuration that require the UE to know the SFN of the target PCell
(e.g. measurement gaps, periodic CQI reporting, scheduling request
configuration, sounding RS configuration), if any, upon acquiring the
SFN of the target PCell;

NOTE 1: Whenever the UE shall setup or reconfigure a configuration in
accordance with a field that is received it applies the new
configuration, except for the cases addressed by the above statements.

2\> enter E-UTRA RRC\_CONNECTED, upon which the procedure ends;

##### 8.1.4.2.1.1.3 Test description {#test-description-83 .H6}

##### 8.1.4.2.1.1.3.1 Pre-test conditions {#pre-test-conditions-83 .H6}

##### System Simulator: {#system-simulator-54 .H6}

\- NR Cell 1 and E-UTRA Cell 1.

\- System information Combination NR-6 as defined in TS 38.508 \[4\]
clause 4.4.3.1 is used in NR cells.

##### UE: {#ue-51 .H6}

\- None

##### Preamble: {#preamble-52 .H6}

\- The UE is in 5GS state 3N-A and Test Loop Function (*On*) with UE
test loop mode B on NR Cell 1 according to TS 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.4.2.1.1.3.2 Test procedure sequence {#test-procedure-sequence-84 .H6}

Table 8.1.4.2.1.1.3.2-1: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits a  |              | MobilityF    |         |    |
|    | MobilityF    |              | romNRCommand |         |    |
|    | romNRCommand |              |              |         |    |
|    | message on   |              |              |         |    |
|    | NR Cell 1.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | Check: Does  | \--\>        | E-UTRA RRC:  | 1       | P  |
|    | the UE       |              | RRCConnectio |         |    |
|    | transmit an  |              | nReconfigura |         |    |
|    | RRCConnectio |              | tionComplete |         |    |
|    | nReconfigura |              |              |         |    |
|    | tionComplete |              |              |         |    |
|    | message on   |              |              |         |    |
|    | E-UTRA Cell  |              |              |         |    |
|    | 1 using the  |              |              |         |    |
|    | security key |              |              |         |    |
|    | derived from |              |              |         |    |
|    | the new      |              |              |         |    |
|    | KeNB?        |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The UE       | \--\>        | E-UTRA RRC:  | \-      | \- |
|    | transmits an |              | ULInforma    |         |    |
|    | ULInforma    |              | tionTransfer |         |    |
|    | tionTransfer |              |              |         |    |
|    | message on   |              | E-UTRA NAS:  |         |    |
|    | E-UTRA Cell  |              | TRACKING     |         |    |
|    | 1.           |              | AREA UPDATE  |         |    |
|    |              |              | REQUEST      |         |    |
|    | This message |              |              |         |    |
|    | includes a   |              |              |         |    |
|    | TRACKING     |              |              |         |    |
|    | AREA UPDATE  |              |              |         |    |
|    | REQUEST      |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | The SS       | \<\--        | E-UTRA RRC:  | \-      | \- |
|    | transmits a  |              | DLInforma    |         |    |
|    | DLInforma    |              | tionTransfer |         |    |
|    | tionTransfer |              |              |         |    |
|    | message.     |              | E-UTRA NAS:  |         |    |
|    |              |              | TRACKING     |         |    |
|    | This message |              | AREA UPDATE  |         |    |
|    | includes a   |              | ACCEPT       |         |    |
|    | TRACKING     |              |              |         |    |
|    | AREA UPDATE  |              |              |         |    |
|    | ACCEPT       |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | The UE       | \--\>        | E-UTRA RRC:  | \-      | \- |
|    | transmits an |              | ULInforma    |         |    |
|    | ULInforma    |              | tionTransfer |         |    |
|    | tionTransfer |              |              |         |    |
|    | message.     |              | E-UTRA NAS:  |         |    |
|    |              |              | TRACKING     |         |    |
|    | This message |              | AREA UPDATE  |         |    |
|    | includes a   |              | COMPLETE     |         |    |
|    | TRACKING     |              |              |         |    |
|    | AREA UPDATE  |              |              |         |    |
|    | COMPLETE     |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | Void         | \-           | \-           | \-      | \- |
+----+--------------+--------------+--------------+---------+----+
| 7  | The SS sends | \-           | \-           | \-      | \- |
|    | one IP       |              |              |         |    |
|    | Packet to    |              |              |         |    |
|    | the UE on    |              |              |         |    |
|    | the default  |              |              |         |    |
|    | DRB          |              |              |         |    |
|    | associated   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | first PDU    |              |              |         |    |
|    | session.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8  | The UE loop  | \-           | \-           | 1       | P  |
|    | backs the IP |              |              |         |    |
|    | packet       |              |              |         |    |
|    | received in  |              |              |         |    |
|    | step 7.      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.4.2.1.1.3.3 Specific message contents {#specific-message-contents-75 .H6}

Table 8.1.4.2.1.1.3.3-1: MobilityFromNRCommand (step 1, Table
8.1.4.2.1.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-8                                                                       
  --------------------------------------------------- --------------------------------------------------------- --------- -----------
  Information Element                                 Value/remark                                              Comment   Condition
  MobilityFromNRCommand::= SEQUENCE {                                                                                     
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier                                           
  criticalExtensions CHOICE {                                                                                             
  mobilityFromNRCommand SEQUENCE {                                                                                        
  targetRAT-Type                                      eutra                                                               
  targetRAT-MessageContainer                          DL-DCCH message containing RRCConnectionReconfiguration             
  nas-SecurityParamFromNR                             8 LSB of the downlink NAS COUNT                                     
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       

Table 8.1.4.2.1.1.3.3-2: RRCConnectionReconfiguration (Table
8.1.4.2.1.1.3.3-1)

  -----------------------------------------------------------------------------
  Derivation Path: TS 36.508 \[7\], Table 4.6.1-8, condition HO-TO-EUTRA(1,0)
  -----------------------------------------------------------------------------

Table 8.1.4.2.1.1.3.3-3: MobilityControlInfo (Table 8.1.4.2.1.1.3.3-2)

  Derivation Path: TS 36.508 \[7\], Table 4.6.5-1, condition HO-TO-EUTRA                                                              
  ------------------------------------------------------------------------ ------------------------------------------------ --------- ------------
  Information Element                                                      Value/remark                                     Comment   Condition
  MobilityControlInfo ::= SEQUENCE {                                                                                                  
  targetPhysCellId                                                         PhysicalCellIdentity of E-UTRA Cell 1                      
  carrierFreq SEQUENCE {                                                                                                              
  dl-CarrierFreq                                                           Same downlink EARFCN as used for E-UTRA Cell 1             
  }                                                                                                                                   
  carrierFreq                                                              Not present                                                Band \> 64
  carrierBandwidth SEQUENCE {                                                                                                         
  dl-Bandwidth                                                             Downlink system bandwidth under test.                      
  ul-Bandwidth                                                             Uplink Bandwidth under test.                               FDD
  ul-Bandwidth                                                             Not present                                                TDD
  }                                                                                                                                   
  carrierFreq-v9e0 SEQUENCE {                                                                                                         Band \> 64
  dl-CarrierFreq-v9e0                                                      Same downlink EARFCN as used for E-UTRA Cell 1             
  }                                                                                                                                   
  }                                                                                                                                   

  Condition    Explanation
  ------------ ---------------------------
  FDD          FDD cell environment
  TDD          TDD cell environment
  Band \> 64   If band \> 64 is selected

Table 8.1.4.2.1.1.3.3-4: SecurityConfigHO-v1530 (Table
8.1.4.2.1.1.3.3-2)

  Derivation Path: TS 36.331 \[11\], clause 6.2.2                                                                                           
  ------------------------------------------------- ----------------------------------------------------------------------------- --------- -----------
  Information Element                               Value/remark                                                                  Comment   Condition
  SecurityConfigHO-v1530 ::= SEQUENCE {                                                                                                     
  handoverType-v1530 CHOICE {                                                                                                               
  fivegc-ToEPC SEQUENCE {                                                                                                                   
  securityAlgorithmConfig-r15 SEQUENCE {                                                                                                    
  cipheringAlgorithm                                Set according to PIXIT parameter for default ciphering algorithm                        
  integrityProtAlgorithm                            Set according to PIXIT parameter for default integrity protection algorithm             
  }                                                                                                                                         
  nextHopChainingCount-r15                          2                                                                                       
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         

Table 8.1.4.2.1.1.3.3-5: Void

Table 8.1.4.2.1.1.3.3-6: TRACKING AREA UPDATE REQUEST (step 3, Table
8.1.4.2.1.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] table 4.9.7.2.3-1                                                                                        
  ------------------------------------------------------ ----------------------------------------- ------------------------------------------ ---------------------------------
  **Information Element**                                **Value/remark**                          **Comment**                                **Condition**
  EPS update type                                                                                                                             
  EPS update type Value                                  \'000\'B                                  TA updating                                TA\_only
                                                         '001'B                                    Combined TA/LA updating                    combined\_TA\_LA\_without\_IMSI
                                                         \'010\'B                                  Combined TA/LA updating with IMSI attach   combined\_TA\_LA
  NAS key set identifier                                                                                                                      
  NAS Key Set Identifier                                 The value of ngKSI assigned in preamble                                              
  Type of security context flag                          '1'B                                      Mapped security context                    
  Old GUTI                                               Mapped 5G-GUTI                                                                       
  Non-current native NAS key set identifier              Not present or any allowed value                                                     
  EPS bearer context status                              Not present or any allowed value                                                     

  --------------------------------- -----------------------------------------------------------
  Condition                         Explanation
  TA\_only                          The UE is configured to initiate EPS attach
  combined\_TA\_LA                  The UE is configured to initiate combined EPS/IMSI attach
  combined\_TA\_LA\_without\_IMSI   The UE is configured to initiate combined attach
  --------------------------------- -----------------------------------------------------------

Table 8.1.4.2.1.1.3.3-7: Void

##### 8.1.4.2.1.2 Inter-RAT handover / From NR to EN-DC / Success

##### 8.1.4.2.1.2.1 Test Purpose (TP) {#test-purpose-tp-84 .H6}

##### (1) {#section-136 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives a *MobilityFromNRCommand* message with the
embedded *RRCConnectionReconfiguration* message including
*nr-SecondaryCellGroupConfig* }

**then** { UE transmits an *RRCConnectionReconfigurationComplete*
message embedding an *RRCReconfigurationComplete* message on the E-UTRA
cell }

}

##### 8.1.4.2.1.2.2 Conformance requirements {#conformance-requirements-84 .H6}

Same as TC 8.1.4.2.1.1 with the addition of: Rel-16 TS 36.331, clause
5.3.5.4 and Rel-16 TS 37.340, clause 10.16.1.

\[TS 36.331, clause 5.3.5.4\]

If the *RRCConnectionReconfiguration* message includes the
*mobilityControlInfo* and the UE is able to comply with the
configuration included in this message, the UE shall:

1\> if the *RRCConnectionReconfiguration* message includes the
*fullConfig*:

...

1\> if the received *RRCConnectionReconfiguration* includes the
*sk-Counter*:

2\> perform key update procedure as specified in in TS 38.331 \[82\],
clause 5.3.5.7;

1\> if the received *RRCConnectionReconfiguration* includes the
*nr-SecondaryCellGroupConfig*:

2\> perform NR RRC Reconfiguration as specified in TS 38.331 \[82\],
clause 5.3.5.3.

...

1\> set the content of *RRCConnectionReconfigurationComplete* message as
follows:

...

2\> if the received *RRCConnectionReconfiguration* message included
*nr-SecondaryCellGroupConfig*:

3\> include *scg-ConfigResponseNR* in accordance with TS 38.331 \[82\],
clause 5.3.5.3;

1\> submit the *RRCConnectionReconfigurationComplete* message to lower
layers for transmission;

\[TS 37.340, clause 10.16.1\]

Inter-system HO from NR to E-UTRA with EN-DC configuration is supported
in this version of the specification. N26 based inter-system HO will be
executed between source RAN and gNB.

##### 8.1.4.2.1.2.3 Test description {#test-description-84 .H6}

##### 8.1.4.2.1.2.3.1 Pre-test conditions {#pre-test-conditions-84 .H6}

##### System Simulator: {#system-simulator-55 .H6}

\- NR Cell 1 is the serving cell. System information combination NR-6 as
defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 is used in NR Cell 1.

\- E-UTRA Cell 1 (PCell) and NR Cell 3 (PSCell) are the target cells.
System information combination 31 as defined in TS 36.508 \[7\] clause
4.4.3.1 is used in the E-UTRA cell. Only NR MIB is broadcasted on NR
Cell 3.

##### UE: {#ue-52 .H6}

\- None

##### Preamble: {#preamble-53 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.4.2.1.2.3.2 Test procedure sequence {#test-procedure-sequence-85 .H6}

Tables 8.1.4.2.1.2.3.2-0A and 8.1.4.2.1.2.3.2-0B illustrate the downlink
power levels to be applied for NR Cell 1, NR Cell 3, and E-UTRA Cell 1
at various time instants of the test execution. Row marked \"T0\"
denotes the conditions after the preamble.

Table 8.1.4.2.1.2.3.2-0A: Time instances of cell power level and
parameter changes for conducted test environment

+----+-----------------------+-----------+-----------+-----------+--------+--------+
|    | Parameter             | Unit      | NR Cell 1 | NR Cell 3 | E-UTRA | Remark |
|    |                       |           |           |           |        |        |
|    |                       |           |           |           | Cell 1 |        |
+====+=======================+===========+===========+===========+========+========+
| T0 | SS/PBCH               | dBm/      | -88       | -91       | \-     |        |
|    |                       |           |           |           |        |        |
|    | SSS EPRE              | SCS       |           |           |        |        |
+----+-----------------------+-----------+-----------+-----------+--------+--------+
|    | Cell-specific RS EPRE | dBm/15kHz | \-        | \-        | -85    |        |
+----+-----------------------+-----------+-----------+-----------+--------+--------+

Table 8.1.4.2.1.2.3.2-0B: Time instances of cell power level and
parameter changes for OTA test environment

+----+-----------------------+-----------+-----------+-----------+--------+--------+
|    | Parameter             | Unit      | NR Cell 1 | NR Cell 3 | E-UTRA | Remark |
|    |                       |           |           |           |        |        |
|    |                       |           |           |           | Cell 1 |        |
+====+=======================+===========+===========+===========+========+========+
| T0 | SS/PBCH               | dBm/      | -82       | -82       | \-     |        |
|    |                       |           |           |           |        |        |
|    | SSS EPRE              | SCS       |           |           |        |        |
+----+-----------------------+-----------+-----------+-----------+--------+--------+
|    | Cell-specific RS EPRE | dBm/15kHz | \-        | \-        | -96    |        |
+----+-----------------------+-----------+-----------+-----------+--------+--------+

Table 8.1.4.2.1.2.3.2-1: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+----+--------------+--------------+--------------+---------+----+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 0A | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRCReco     |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message and  |              | 5GMM: DL NAS |         |    |
|    | a PDU        |              | TRANSPORT    |         |    |
|    | SESSION      |              |              |         |    |
|    | MODIFICATION |              | 5GSM: PDU    |         |    |
|    | COMMAND to   |              | SESSION      |         |    |
|    | add DRB\#a   |              | MODIFICATION |         |    |
|    | associated   |              | COMMAND      |         |    |
|    | with a new   |              |              |         |    |
|    | QoS Flow.    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 0B | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRC         |         |    |
|    | *RRC         |              | Reconfigurat |         |    |
|    | Reconfigurat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 0C | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmits a  |              | *ULInformat  |         |    |
|    | *ULInformat  |              | ionTransfer* |         |    |
|    | ionTransfer* |              |              |         |    |
|    | message, an  |              | 5GMM: UL NAS |         |    |
|    | UL NAS       |              | TRANSPORT    |         |    |
|    | TRANSPORT    |              |              |         |    |
|    | message and  |              | 5GSM: PDU    |         |    |
|    | an PDU       |              | SESSION      |         |    |
|    | SESSION      |              | MODIFICATION |         |    |
|    | MODIFICATION |              | COMPLETE     |         |    |
|    | COMPLETE     |              |              |         |    |
|    | message      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | *MobilityF   | \-      | \- |
|    | transmits a  |              | romNRCommand |         |    |
|    | *MobilityFr  |              | (RRCCon      |         |    |
|    | omNRCommand* |              | nectionRecon |         |    |
|    | message on   |              | figuration)* |         |    |
|    | NR Cell 1,   |              |              |         |    |
|    | and embedded |              |              |         |    |
|    | *RRCCo       |              |              |         |    |
|    | nnectionReco |              |              |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    | contains     |              |              |         |    |
|    | nr-*S        |              |              |         |    |
|    | econdaryCell |              |              |         |    |
|    | GroupConfig* |              |              |         |    |
|    | with the     |              |              |         |    |
|    | c            |              |              |         |    |
|    | onfiguration |              |              |         |    |
|    | of NR Cell 3 |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | Check: Does  | \--\>        | *R           | 1       | P  |
|    | the UE       |              | RCConnection |         |    |
|    | transmit an  |              | Reconfigurat |         |    |
|    | *R           |              | ionComplete* |         |    |
|    | RCConnection |              |              |         |    |
|    | Reconfigurat |              | *(RRCR       |         |    |
|    | ionComplete* |              | econfigurati |         |    |
|    | containing   |              | onComplete)* |         |    |
|    | **NR         |              |              |         |    |
|    | *RRC         |              |              |         |    |
|    | Reconfigurat |              |              |         |    |
|    | ionComplete* |              |              |         |    |
|    | message** on |              |              |         |    |
|    | E-UTRA Cell  |              |              |         |    |
|    | 1 using the  |              |              |         |    |
|    | security key |              |              |         |    |
|    | derived from |              |              |         |    |
|    | the new KeNB |              |              |         |    |
|    | and          |              |              |         |    |
|    | sk-Counter?  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The UE       | \--\>        | RRC:         | \-      | \- |
|    | transmits an |              | *ULInformat  |         |    |
|    | *ULInformat  |              | ionTransfer* |         |    |
|    | ionTransfer* |              |              |         |    |
|    | message on   |              | NAS:         |         |    |
|    | the cell     |              | TRACKING     |         |    |
|    | specified in |              | AREA UPDATE  |         |    |
|    | the test     |              | REQUEST      |         |    |
|    | case.        |              |              |         |    |
|    |              |              |              |         |    |
|    | This message |              |              |         |    |
|    | includes a   |              |              |         |    |
|    | TRACKING     |              |              |         |    |
|    | AREA UPDATE  |              |              |         |    |
|    | REQUEST      |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | The SS       | \<\--        | RRC:         | \-      | \- |
|    | transmits a  |              | *DLInformat  |         |    |
|    | *DLInformat  |              | ionTransfer* |         |    |
|    | ionTransfer* |              |              |         |    |
|    | message on   |              | NAS:         |         |    |
|    | the cell     |              | TRACKING     |         |    |
|    | specified in |              | AREA UPDATE  |         |    |
|    | the test     |              | ACCEPT       |         |    |
|    | case.        |              |              |         |    |
|    |              |              |              |         |    |
|    | This message |              |              |         |    |
|    | includes a   |              |              |         |    |
|    | TRACKING     |              |              |         |    |
|    | AREA UPDATE  |              |              |         |    |
|    | ACCEPT       |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | The UE       | \--\>        | RRC:         | \-      | \- |
|    | transmits an |              | *ULInformat  |         |    |
|    | *ULInformat  |              | ionTransfer* |         |    |
|    | ionTransfer* |              |              |         |    |
|    | message on   |              | NAS:         |         |    |
|    | the cell     |              | TRACKING     |         |    |
|    | specified in |              | AREA UPDATE  |         |    |
|    | the test     |              | COMPLETE     |         |    |
|    | case.        |              |              |         |    |
|    |              |              |              |         |    |
|    | This message |              |              |         |    |
|    | includes a   |              |              |         |    |
|    | TRACKING     |              |              |         |    |
|    | AREA UPDATE  |              |              |         |    |
|    | COMPLETE     |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | Check: Does  | \-           | \-           | 1       | \- |
|    | the test     |              |              |         |    |
|    | result of    |              |              |         |    |
|    | test         |              |              |         |    |
|    | procedure in |              |              |         |    |
|    | TS 38.508-1  |              |              |         |    |
|    | \[4\]        |              |              |         |    |
|    | subclause    |              |              |         |    |
|    | 4.9.1        |              |              |         |    |
|    | indicate     |              |              |         |    |
|    | that the UE  |              |              |         |    |
|    | is capable   |              |              |         |    |
|    | of           |              |              |         |    |
|    | exchanging   |              |              |         |    |
|    | IP data on   |              |              |         |    |
|    | DRB\#b       |              |              |         |    |
|    | associated   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | default EPS  |              |              |         |    |
|    | bearer in    |              |              |         |    |
|    | E-UTRA Cell  |              |              |         |    |
|    | 12           |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | Check: Does  | \-           | \-           | 1       | \- |
|    | the test     |              |              |         |    |
|    | result of    |              |              |         |    |
|    | test         |              |              |         |    |
|    | procedure in |              |              |         |    |
|    | TS 38.508-1  |              |              |         |    |
|    | \[4\]        |              |              |         |    |
|    | subclause    |              |              |         |    |
|    | 4.9.1        |              |              |         |    |
|    | indicate     |              |              |         |    |
|    | that the UE  |              |              |         |    |
|    | is capable   |              |              |         |    |
|    | of           |              |              |         |    |
|    | exchanging   |              |              |         |    |
|    | IP data on   |              |              |         |    |
|    | the SCG      |              |              |         |    |
|    | DRB\#a in NR |              |              |         |    |
|    | Cell 32      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

Table 8.1.4.2.1.2.3.2-1b: Time instances of cell power level and
parameter changes for OTA test environment

+----+-----------------------+-----------+-----------+--------+--------+
|    | Parameter             | Unit      | NR Cell 3 | E-UTRA | Remark |
|    |                       |           |           |        |        |
|    |                       |           |           | Cell 1 |        |
+====+=======================+===========+===========+========+========+
| T0 | SS/PBCH               | dBm/      | -82       | \-     |        |
|    |                       |           |           |        |        |
|    | SSS EPRE              | SCS       |           |        |        |
+----+-----------------------+-----------+-----------+--------+--------+
|    | Cell-specific RS EPRE | dBm/15kHz |           | -96    |        |
+----+-----------------------+-----------+-----------+--------+--------+

##### 8.1.4.2.1.2.3.3 Specific message contents {#specific-message-contents-76 .H6}

Table 8.1.4.2.1.2.3.3-0A: *PDU SESSION MODIFICATION COMMAND* (step 0A,
Table 8.1.4.2.1.2.3.2-1)

  ---------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.7.2-9.                                                                                                                                                                                                                         
  Information Element                                                                Value/remark                                                                                                                                              Comment                       Condition
  PDU session ID                                                                     The same as the PDU session ID in PDU SESSION ESTABLISHMENT REQUEST associated with the Internet PDU session if available or with the first PDU session                                 
  Mapped EPS bearer contexts                                                                                                                                                                                                                                                 
  Mapped EPS bearer context                                                                                                                                                                                                                                                  
  EPS bearer identity                                                                (DRB\#a + 4)                                                                                                                                                                            
  Operation code                                                                     '001'B                                                                                                                                                    Create new EPS bearer         
  E bit                                                                              \'1\'B                                                                                                                                                    Parameters list is included   
  Number of EPS parameters                                                           '0010'B                                                                                                                                                   2 parameters                  
  Mapped EPS QoS parameters                                                          Reference dedicated EPS bearer context \#6 as specified in TS 36.508 \[10\], Table 6.6.2-1.                                                                                             
  TFT                                                                                Reference dedicated EPS bearer context \#6 as specified in TS 36.508 \[10\], Table 6.6.2-1.                                                                                             
  Authorized QoS rules                                                               One entry                                                                                                                                                                               
  QoS rule \[1\]                                                                     Reference QoS rule \#5 as defined in TS 38.508-1 \[4\] Table 4.8.2.1-1.                                                                                   QFI=5                         
  Authorized QoS flow descriptions                                                   One entry                                                                                                                                                                               
  QoS flow \[1\]                                                                     Dedicated QoS Flow                                                                                                                                        QFI=5                         
  NOTE: The mapped EPS bearer will become the Dedicated EPS Bearer after handover.                                                                                                                                                                                           
  ---------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------- -----------

Table 8.1.4.2.1.2.3.3-0B: Dedicated QoS Flow (Table 8.1.4.2.1.2.3.3-0A)

  --------------------------------------------- -------------- --------------------------------- -----------
  Derivation Path: TS 24.501, table 9.11.4.12                                                    
  Information Element                           Value/remark   Comment                           Condition
  QoS flow descriptions                                                                          
  QoS flow description                                                                           
  QFI                                           '00 0101'B     QFI 5                             
  Operation code                                '001'B         Create new QoS flow description   
  E bit                                         '1'B           Parameters list is included       
  Number of parameters                          '00 0010'B     2 parameters                      
  5QI                                           5QI 1          5QI 1                             
  EPS bearer identity                           (DRB\#a + 4)   EBI related to NR DRB\#a          
  --------------------------------------------- -------------- --------------------------------- -----------

Table 8.1.4.2.1.2.3.3-0C: *RRCReconfiguration* (step 0A,
Table8.1.4.2.1.2.3.2-1)

  ---------------------------------------------------------------------- --------------------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition NR.                                                                           
  Information Element                                                    Value/remark                Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                              
  criticalExtensions CHOICE {                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                  
  radioBearerConfig                                                      RadioBearerConfig-HO-ENDC                                               
  nonCriticalExtension SEQUENCE {                                                                                                                
  masterCellGroup                                                        CellGroupConfig-DRB(1,0)    OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  ---------------------------------------------------------------------- --------------------------- ------------------------------------------- -----------

Table 8.1.4.2.1.2.3.3-0D: RadioBearerConfig-HO-ENDC (Table
8.1.4.2.1.2.3.3-0C)

  ------------------------------------------------------------------------------------------------ ------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-132                                                                                              
  Information Element                                                                              Value/remark                          Comment   Condition
  RadioBearerConfig ::= SEQUENCE {                                                                                                                 
  drb-ToAddModList SEQUENCE (SIZE (1..maxDRB)) OF DRB-ToAddMod {                                   1 entry                                         
  DRB-ToAddMod\[1\] SEQUENCE {                                                                                                                     
  cnAssociation CHOICE {                                                                                                                           
  sdap-Config SEQUENCE {                                                                           SDAP-Config                                     
  defaultDRB                                                                                       false                                           
  }                                                                                                                                                
  }                                                                                                                                                
  drb-Identity                                                                                     DRB-Identity using condition DRB\#a             
  reestablishPDCP                                                                                  Not present                                     
  recoverPDCP                                                                                      Not present                                     
  pdcp-Config                                                                                      PDCP-Config                                     
  }                                                                                                                                                
  }                                                                                                                                                
  }                                                                                                                                                
  NOTE: DRB\#a will become the Dedicated EPS Bearer and the SCG DRB on NR Cell 3 after Handover.                                                   
  ------------------------------------------------------------------------------------------------ ------------------------------------- --------- -----------

Table 8.1.4.2.1.2.3.3-1: MobilityFromNRCommand (step 1, Table
8.1.4.2.1.2.3.2-1)

  --------------------------------------------------- ----------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-8                                                                         
  Information Element                                 Value/remark                                                Comment   Condition
  MobilityFromNRCommand::= SEQUENCE {                                                                                       
  rrc-TransactionIdentifier                           RRC-TransactionIdentifier                                             
  criticalExtensions CHOICE {                                                                                               
  mobilityFromNRCommand SEQUENCE {                                                                                          
  targetRAT-Type                                      eutra                                                                 
  targetRAT-MessageContainer                          DL-DCCH message containing *RRCConnectionReconfiguration*             
  nas-SecurityParamFromNR                             8 LSB of the downlink NAS COUNT                                       
  }                                                                                                                         
  }                                                                                                                         
  }                                                                                                                         
  --------------------------------------------------- ----------------------------------------------------------- --------- -----------

Table 8.1.4.2.1.2.3.3-2: RRCConnectionReconfiguration (Table
8.1.4.2.1.2.3.3-1)

  ---------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------ --------- -----------
  Derivation Path: TS 36.508 \[7\], Table 4.6.1-8, condition HO-TO-EN-DC(x,0)                                                                                                                                           
  Information Element                                                                                                    Value/remark                                                                         Comment   Condition
  mobilityControlInfo                                                                                                    MobilityControlInfo\_EN-DC                                                                     
  nr-SecondaryCellGroupConfig-r15                                                                                        OCTET STRING including the *RRCReconfiguration* message and CellGroupConfig\_EN-DC             
  nr-RadioBearerConfig1-r15                                                                                              OCTET STRING including RadioBearerConfig\_EN-DC                                                
  NOTE: x is equal to the number of PDU sessions established on NR Cell 1. These are all included in the HO to E-UTRA.                                                                                                  
  ---------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------ --------- -----------

Table 8.1.4.2.1.2.3.3-2A: CellGroupConfig\_EN-DC (Table
8.1.4.2.1.2.3.3-2)

  ------------------------------------------------------------------------- ------------------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition EN-DC                                                              
  Information Element                                                       Value/remark                                     Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                       
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLCH)) OF RLC-BearerConfig {   1 entry                                                    
  RLC-BearerConfig\[1\]                                                     RLC-BearerConfig with conditions AM and DRB\#a   entry 1   
  }                                                                                                                                    
  }                                                                                                                                    
  NOTE: DRB\#a is the SCG DRB on NR Cell 3 after Handover.                                                                             
  ------------------------------------------------------------------------- ------------------------------------------------ --------- -----------

Table 8.1.4.2.1.2.3.3-2B: RadioBearerConfig\_EN-DC (Table
8.1.4.2.1.2.3.3-2)

  ------------------------------------------------------------------------------------------------- ------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-132                                                                                               
  Information Element                                                                               Value/remark                          Comment   Condition
  RadioBearerConfig ::= SEQUENCE {                                                                                                                  
  drb-ToAddModList SEQUENCE (SIZE (1..maxDRB)) OF DRB-ToAddMod {                                    1 entry                                         
  DRB-ToAddMod\[1\] SEQUENCE {                                                                                                            entry 1   
  cnAssociation CHOICE {                                                                                                                            
  eps-BearerIdentity                                                                                (DRB\#a + 4)                                    
  }                                                                                                                                                 
  drb-Identity                                                                                      DRB-Identity using condition DRB\#a             
  reestablishPDCP                                                                                   true                                            
  recoverPDCP                                                                                       Not present                                     
  pdcp-Config                                                                                       PDCP-Config                                     
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  NOTE: DRB\#a is the SCG DRB on NR Cell associated with the Dedicated EPS Bearer after handover.                                                   
  ------------------------------------------------------------------------------------------------- ------------------------------------- --------- -----------

Table 8.1.4.2.1.2.3.3-3: MobilityControlInfo\_EN-DC (Table
8.1.4.2.1.2.3.3-2)

  ------------------------------------------------------------------------ ------------------------------------------------ --------- ------------
  Derivation Path: TS 36.508 \[7\], Table 4.6.5-1, condition HO-TO-EN-DC                                                              
  Information Element                                                      Value/remark                                     Comment   Condition
  MobilityControlInfo ::= SEQUENCE {                                                                                                  
  targetPhysCellId                                                         PhysicalCellIdentity of E-UTRA Cell 1                      
  carrierFreq SEQUENCE {                                                                                                              
  dl-CarrierFreq                                                           Same downlink EARFCN as used for E-UTRA Cell 1             
  }                                                                                                                                   
  carrierFreq                                                              Not present                                                Band \> 64
  carrierBandwidth SEQUENCE {                                                                                                         
  dl-Bandwidth                                                             Downlink system bandwidth under test.                      
  ul-Bandwidth                                                             Uplink Bandwidth under test.                               FDD
  ul-Bandwidth                                                             Not present                                                TDD
  }                                                                                                                                   
  carrierFreq-v9e0 SEQUENCE {                                                                                                         Band \> 64
  dl-CarrierFreq-v9e0                                                      Same downlink EARFCN as used for E-UTRA Cell 1             
  }                                                                                                                                   
  }                                                                                                                                   
  ------------------------------------------------------------------------ ------------------------------------------------ --------- ------------

  ------------ ---------------------------
  Condition    Explanation
  FDD          FDD cell environment
  TDD          TDD cell environment
  Band \> 64   If band \> 64 is selected
  ------------ ---------------------------

Table 8.1.4.2.1.2.3.3-4: SecurityConfigHO-v1530 (Table
8.1.4.2.1.2.3.3-1)

  ------------------------------------------------- ----------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 36.331 \[11\], clause 6.2.2                                                                                           
  Information Element                               Value/remark                                                                  Comment   Condition
  SecurityConfigHO-v1530 ::= SEQUENCE {                                                                                                     
  handoverType-v1530 CHOICE {                                                                                                               
  fivegc-ToEPC SEQUENCE {                                                                                                                   
  securityAlgorithmConfig-r15 SEQUENCE {                                                                                                    
  cipheringAlgorithm                                Set according to PIXIT parameter for default ciphering algorithm                        
  integrityProtAlgorithm                            Set according to PIXIT parameter for default integrity protection algorithm             
  }                                                                                                                                         
  nextHopChainingCount-r15                          2                                                                                       
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ------------------------------------------------- ----------------------------------------------------------------------------- --------- -----------

Table 8.1.4.2.1.2.3.3-5: Void

Table 8.1.4.2.1.2.3.3-6: *RRCConnectionReconfigurationComplete* (step 2,
Table 8.1.4.2.1.2.3.2-1)

  -----------------------------------------------------------------------------
  Derivation Path: TS 36.508 \[7\], Table 4.6.1-9, condition HO-TO-EN-DC(1,0)
  -----------------------------------------------------------------------------

Table 8.1.4.2.1.2.3.3-7: TRACKING AREA UPDATE REQUEST (step 3, Table
8.1.4.2.1.2.3.2-1)

  -------------------------------------------------- ----------------------------------------- ------------------------------------------ ---------------------------------
  Derivation Path: TS 36.508 \[7\] clause 4.7.2-27                                                                                        
  **Information Element**                            **Value/remark**                          **Comment**                                **Condition**
  EPS update type                                                                                                                         
  EPS update type Value                              \'000\'B                                  TA updating                                TA\_only
                                                     '001'B                                    Combined TA/LA updating                    combined\_TA\_LA\_without\_IMSI
                                                     \'010\'B                                  Combined TA/LA updating with IMSI attach   combined\_TA\_LA
  NAS key set identifier                                                                                                                  
  NAS Key Set Identifier                             The value of ngKSI assigned in preamble                                              
  Type of security context flag                      '1'B                                      Mapped security context                    
  Old GUTI                                           Mapped 5G-GUTI                                                                       
  Non-current native NAS key set identifier          Not present or any allowed value                                                     
  Additional GUTI                                    Any value or not present                                                             
  EPS bearer context status                          Not present or any allowed value                                                     
  Old GUTI type                                      Native GUTI                                                                          
  UE status                                          UE is in 5GMM-REGISTERED state                                                       
  -------------------------------------------------- ----------------------------------------- ------------------------------------------ ---------------------------------

  --------------------------------- -----------------------------------------------------------
  Condition                         Explanation
  TA\_only                          The UE is configured to initiate EPS attach
  combined\_TA\_LA                  The UE is configured to initiate combined EPS/IMSI attach
  combined\_TA\_LA\_without\_IMSI   The UE is configured to initiate combined attach
  --------------------------------- -----------------------------------------------------------

##### 8.1.4.2.2 Inter-RAT handover to NR

###### 8.1.4.2.2.1 Inter-RAT handover / From E-UTRA to NR / Success

##### 8.1.4.2.2.1.1 Test Purpose (TP) {#test-purpose-tp-85 .H6}

##### (1) {#section-137 .H6}

**with** { UE in E-UTRA RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives a MobilityFromEUTRACommand message }

**then** { UE transmits a RRCReconfigurationComplete message on the NR
cell }

}

##### 8.1.4.2.2.1.2 Conformance requirements {#conformance-requirements-85 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.4.2.2, 5.4.2.3, TS 36.331, clause
5.4.3.2, 5.4.3.3, 5.4.3.4.Unless otherwise stated these are Rel-15
requirements.

\[TS 38.331, clause 5.4.2.2\]

The RAN using another RAT initiates the handover to NR procedure, in
accordance with the specifications applicable for the other RAT, by
sending the *RRCReconfiguration* message via the radio access technology
from which the inter-RAT handover is performed.

The network applies the procedure as follows:

\- to activate ciphering, possibly using NULL algorithm, if not yet
activated in the other RAT;

\- to re-establish SRBs and one or more DRBs;

\[TS 38.331, clause 5.4.2.3\]

The UE shall:

1\> perform RRC reconfiguration procedure as specified in 5.3.5;

NOTE: If the UE is connected to 5GC of the source E-UTRA cell, the delta
configuration for PDCP and SDAP can be used for intra-system inter-RAT
handover.

\[TS 36.331, clause 5.4.3.2\]

E-UTRAN initiates the mobility from E-UTRA procedure to a UE in
RRC\_CONNECTED, possibly in response to a *MeasurementReport* message or
in response to reception of CS fallback indication for the UE from MME,
by sending a *MobilityFromEUTRACommand* message. E-UTRAN applies the
procedure as follows:

\- the procedure is initiated only when AS-security has been activated,
and SRB2 with at least one DRB are setup and not suspended;

\[TS 36.331, clause 5.4.3.3\]

The UE shall be able to receive a *MobilityFromEUTRACommand* message and
perform a cell change order to GERAN, even if no prior UE measurements
have been performed on the target cell.

The UE shall:

1\> stop timer T310, if running;

1\> stop timer T312, if running;

1\> if T309 is running:

2\> stop timer T309 for all access categories;

2\> perform the actions as specified in 5.3.16.4.

1\> if the *MobilityFromEUTRACommand* message includes the *purpose* set
to *handover*:

...

2\> else if the *targetRAT-Type* is set to *nr*:

3\> consider inter-RAT mobility as initiated towards NR;

3\> access the target cell indicated in the inter-RAT message in
accordance with the specifications in TS 38.331 \[82\];

\[TS 36.331, clause 5.4.3.4\]

Upon successfully completing the handover, the cell change order or
enhanced 1xRTT CS fallback, the UE shall:

...

1\> else if the UE is connected to 5GC prior to the reception of the
*MobilityFromEUTRACommand* and the *targetRAT-Type* in the received
*MobilityFromEUTRACommand* is set to *nr*:

2\> reset MAC;

2\> stop all timers that are running;

2\> release *ran-NotificationAreaInfo*, if stored;

2\> release the AS security context including the K~RRCenc~ key, the
K~RRCint~, the K~UPint~ key and the K~UPenc~ key, if stored;

2\> release all radio resources, including release of the RLC entity and
the MAC configuration and the associated PDCP entity and SDAP entity for
all established RBs;

NOTE 1: PDCP and SDAP configured by the source configurations RAT prior
to the handover that are reconfigured and re-used by target RAT when
delta signalling (i.e., during inter-RAT intra-sytem handover when
*fullConfig* is not present) is used, are not released as part of this
procedure.

1\> else:

2\> perform the actions upon leaving RRC\_CONNECTED as specified in
5.3.12, with release cause \'other\';

NOTE 2: If the UE performs enhanced 1xRTT CS fallback along with
concurrent mobility to CDMA2000 HRPD and the connection to either
CDMA2000 1xRTT or CDMA2000 HRPD succeeds, then the mobility from E-UTRA
is considered successful.

##### 8.1.4.2.2.1.3 Test description {#test-description-85 .H6}

##### 8.1.4.2.2.1.3.1 Pre-test conditions {#pre-test-conditions-85 .H6}

##### System Simulator: {#system-simulator-56 .H6}

\- E-UTRA Cell 1 \"Serving cell\" and NR Cell 1 \"Non-suitable \"Off\"
cell\".

\- System information combination 31 as defined in TS 36.508 \[7\]
clause 4.4.3.1 is used in the E-UTRA cell.

\- System information combination NR-6 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in the NR cell.

##### UE: {#ue-53 .H6}

\- None.

##### Preamble: {#preamble-54 .H6}

\- The UE isbrought to state RRC\_CONNECTED using generic procedure
parameters Connectivity (*E-UTRA/EPC*), Unrestricted nr PDN (*On*), Test
Loop Function (*On*) with UE test loop mode B, on E-UTRA Cell 1
according to the procedure described in TS 38.508-1 \[4\], clause 4.5.4.

##### 8.1.4.2.2.1.3.2 Test procedure sequence {#test-procedure-sequence-86 .H6}

Table 8.1.4.2.2.1.3.2-1: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 0  | The SS       | \-           | \-           | \-      | \- |
|    | configures   |              |              |         |    |
|    | NR Cell 1 as |              |              |         |    |
|    | the          |              |              |         |    |
|    | \"Serving    |              |              |         |    |
|    | cell\" and   |              |              |         |    |
|    | wait 5s.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | E-UTRA RRC:  | \-      | \- |
|    | transmits a  |              | *M           |         |    |
|    | *M           |              | obilityFromE |         |    |
|    | obilityFromE |              | UTRACommand* |         |    |
|    | UTRACommand* |              |              |         |    |
|    | message on   |              |              |         |    |
|    | E-UTRA Cell  |              |              |         |    |
|    | 1.           |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | Check: Does  | \--\>        | NR RRC:      | 1       | P  |
|    | the UE       |              | *RRC         |         |    |
|    | transmit a   |              | Reconfigurat |         |    |
|    | *RRC         |              | ionComplete* |         |    |
|    | Reconfigurat |              |              |         |    |
|    | ionComplete* |              |              |         |    |
|    | message on   |              |              |         |    |
|    | NR Cell 1?   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmits a  |              | *ULInformat  |         |    |
|    | *ULInformat  |              | ionTransfer* |         |    |
|    | ionTransfer* |              |              |         |    |
|    | message and  |              | 5GMM:        |         |    |
|    | a            |              | REGISTRATION |         |    |
|    | REGISTRATION |              | REQUEST      |         |    |
|    | REQUEST      |              |              |         |    |
|    | message      |              |              |         |    |
|    | indicating   |              |              |         |    |
|    | "mobility    |              |              |         |    |
|    | registration |              |              |         |    |
|    | updating" is |              |              |         |    |
|    | sent to      |              |              |         |    |
|    | update the   |              |              |         |    |
|    | registration |              |              |         |    |
|    | of the       |              |              |         |    |
|    | actual       |              |              |         |    |
|    | tracking     |              |              |         |    |
|    | area.        |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | SS sends an  | \<\--        | NR RRC:      | \-      | \- |
|    | *DLInformat  |              | *DLInformat  |         |    |
|    | ionTransfer* |              | ionTransfer* |         |    |
|    | message and  |              |              |         |    |
|    | a            |              | 5GMM:        |         |    |
|    | REGISTRATION |              | REGISTRATION |         |    |
|    | ACCEPT       |              | ACCEPT       |         |    |
|    | message      |              |              |         |    |
|    | containing a |              |              |         |    |
|    | 5G-GUTI.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmits an |              | *ULInformat  |         |    |
|    | *ULInformat  |              | ionTransfer* |         |    |
|    | ionTransfer* |              |              |         |    |
|    | message and  |              | 5GMM:        |         |    |
|    | a            |              | REGISTRATION |         |    |
|    | REGISTRATION |              | COMPLETE     |         |    |
|    | COMPLETE     |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | The          | \-           | \-           | \-      | \- |
|    | procedure in |              |              |         |    |
|    | table        |              |              |         |    |
|    | 4            |              |              |         |    |
|    | .5A.2C.2.2-1 |              |              |         |    |
|    | in TS        |              |              |         |    |
|    | 38.508-1     |              |              |         |    |
|    | \[4\] is     |              |              |         |    |
|    | performed.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | Void         | \-           | \-           | \-      | \- |
+----+--------------+--------------+--------------+---------+----+
| 8  | The SS sends | \-           | \-           | \-      | \- |
|    | one IP       |              |              |         |    |
|    | Packet to    |              |              |         |    |
|    | the UE on    |              |              |         |    |
|    | the default  |              |              |         |    |
|    | DRB          |              |              |         |    |
|    | associated   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | first PDU    |              |              |         |    |
|    | session.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | The UE loop  | \-           | \-           | \-      | \- |
|    | backs the IP |              |              |         |    |
|    | packet       |              |              |         |    |
|    | received in  |              |              |         |    |
|    | step 8.      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

Table 8.1.4.2.2.1.3.2-2: Void

##### 8.1.4.2.2.1.3.3 Specific message contents {#specific-message-contents-77 .H6}

Table 8.1.4.2.2.1.3.3-1: *MobilityFromEUTRACommand* (step 1, Table
8.1.4.2.2.1.3.2-1)

  Derivation Path: TS 36.508 \[7\] table 4.6.1-6                                  
  ------------------------------------------------ -------------------- --------- -----------
  Information Element                              Value/remark         Comment   Condition
  MobilityFromEUTRACommand ::= SEQUENCE {                                         
  criticalExtensions CHOICE {                                                     
  c1 CHOICE {                                                                     
  mobilityFromEUTRACommand-r8 SEQUENCE {                                          
  purpose CHOICE {                                                                
  handover SEQUENCE {                                                             
  targetRAT-Type                                   nr                             
  targetRAT-MessageContainer                       RRCReconfiguration             
  nas-SecurityParamFromEUTRA                       Not present                    
  systemInformation                                Not present                    
  }                                                                               
  }                                                                               
  }                                                                               
  }                                                                               
  }                                                                               
  }                                                                               

Table 8.1.4.2.2.1.3.3-2: *RRCReconfiguration* (Table 8.1.4.2.2.1.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                                                                                                                                                  
  --------------------------------------------------- -------------------------------------------------------------------------------------------------- ------------------------------------------- -----------
  Information Element                                 Value/remark                                                                                       Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                                                                  
  criticalExtensions CHOICE {                                                                                                                                                                        
  rrcReconfiguration SEQUENCE {                                                                                                                                                                      
  radioBearerConfig                                   RadioBearerConfig as per table 4.6.3-132 in TS 38.508-1 \[4\] with conditions SRB1,SRB2 and DRB1                                               
  nonCriticalExtension SEQUENCE {                                                                                                                                                                    
  masterCellGroup                                     CellGroupConfig with conditions SRB1,SRB2 and DRB1                                                 OCTET STRING (CONTAINING CellGroupConfig)   
  fullConfig                                          true                                                                                                                                           
  masterKeyUpdate                                     MasterKeyUpdate                                                                                                                                
  }                                                                                                                                                                                                  
  }                                                                                                                                                                                                  
  }                                                                                                                                                                                                  
  }                                                                                                                                                                                                  

Table 8.1.4.2.2.1.3.3-3: Void

Table 8.1.4.2.2.1.3.3-4: CellGroupConfig (Table 8.1.4.2.2.1.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19                                                                             
  --------------------------------------------------------------------------- --------------------------------------- --------- -----------
  Information Element                                                         Value/remark                            Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLC-ID)) OF RLC-BearerConfig {   3 entries                                         
  RLC-Bearer-Config\[1\]                                                      RLC-Bearer-Config with condition SRB1   entry 1   
  RLC-Bearer-Config\[2\]                                                      RLC-Bearer-Config with condition SRB2   entry 2   
  RLC-Bearer-Config\[3\]                                                      RLC-Bearer-Config with condition DRB1   entry 3   
  }                                                                                                                             
  mac-CellGroupConfig                                                         MAC-CellGroupConfig                               
  physicalCellGroupConfig                                                     PhysicalCellGroupConfig                           
  spCellConfig SEQUENCE {                                                                                                       
  reconfigurationWithSync SEQUENCE {                                                                                            
  spCellConfigCommon                                                          ServingCellConfigCommon                           
  newUE-Identity                                                              RNTI-Value                                        
  t304                                                                        ms1000                                            
  rach-ConfigDedicated CHOICE {                                                                                                 
  uplink                                                                      RACH-ConfigDedicated                              
  supplementaryUplink                                                         Not present                                       
  }                                                                                                                             
  }                                                                                                                             
  rlf-TimersAndConstants CHOICE {                                                                                               
  setup                                                                       RLF-TimersAndConstants                            
  }                                                                                                                             
  spCellConfigDedicated                                                       ServingCellConfig                                 
  }                                                                                                                             
  }                                                                                                                             

Table 8.1.4.2.2.1.3.3-5: ServingCellConfigCommon (Table
8.1.4.2.2.1.3.3-4)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-168                                                
  ---------------------------------------------------- ---------------------------------- --------- -----------
  Information Element                                  Value/remark                       Comment   Condition
  ServingCellConfigCommon ::= SEQUENCE {                                                            
  physCellId                                           Physical CellID of the NR Cell 1             
  }                                                                                                 

Table 8.1.4.2.2.1.3.3-6: MasterKeyUpdate (Table 8.1.4.2.2.1.3.3-2)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS 38.331 |                 |                 |           |
| \[12\], clause  |                 |                 |           |
| 6.2.2           |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| MasterKeyUpdate |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| keySet          | True            |                 |           |
| ChangeIndicator |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| nextH           | NextH           | 38.508-1 \[4\]  |           |
| opChainingCount | opChainingCount | Table 4.6.3-83  |           |
+-----------------+-----------------+-----------------+-----------+
| nas-Container   | Octets 1 to 4   | 24.501 \[22\]   |           |
|                 | are Message     | 9.11.2.9 The    |           |
|                 | authentication  | value part of   |           |
|                 | code(MAC) IE    | S1 mode to N1   |           |
|                 | using {NH,      | mode NAS        |           |
|                 | NCC=2}          | transparent     |           |
|                 |                 | container       |           |
|                 | Bits 1 to 4 of  |                 |           |
|                 | octet 5 are set |                 |           |
|                 | according to    |                 |           |
|                 | PIXIT parameter |                 |           |
|                 | for default     |                 |           |
|                 | integrity       |                 |           |
|                 | protection      |                 |           |
|                 | algorithm.      |                 |           |
|                 |                 |                 |           |
|                 | Bits 5 to 8 of  |                 |           |
|                 | octet 5 are set |                 |           |
|                 | according to    |                 |           |
|                 | PIXIT parameter |                 |           |
|                 | for default     |                 |           |
|                 | ciphering       |                 |           |
|                 | algorithm.      |                 |           |
|                 |                 |                 |           |
|                 | Bits 1 to 3 of  |                 |           |
|                 | octet 6         |                 |           |
|                 | contains the    |                 |           |
|                 | Key set         |                 |           |
|                 | identifier in   |                 |           |
|                 | 5G.             |                 |           |
|                 |                 |                 |           |
|                 | Bit 4 of octet  |                 |           |
|                 | 6 contains the  |                 |           |
|                 | type of         |                 |           |
|                 | security        |                 |           |
|                 | context         |                 |           |
|                 | flag(TSC).      |                 |           |
|                 |                 |                 |           |
|                 | Bits 5 to 7 of  |                 |           |
|                 | octet 6         |                 |           |
|                 | contains the    |                 |           |
|                 | 3bit Next hop   |                 |           |
|                 | chaining        |                 |           |
|                 | counter.        |                 |           |
|                 |                 |                 |           |
|                 | Bit 8 of octet  |                 |           |
|                 | 6 is Spare.     |                 |           |
|                 |                 |                 |           |
|                 | Octets 7 and 8  |                 |           |
|                 | are spare and   |                 |           |
|                 | shall be coded  |                 |           |
|                 | as zero.        |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

#### 8.1.4.3 DAPS handover

##### 8.1.4.3.1 DAPS handover with key change / Success / Intra-frequency

##### 8.1.4.3.1.1 Test Purpose (TP) {#test-purpose-tp-86 .H6}

##### (1) {#section-138 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting DAPS handover }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including a
*reconfigurationWithSync* for handover with key change and *dapsConfig*
is configured for a DRB } **then** { UE performs DAPS handover to the
target cell and keeps DL/UL reception/transmission with the source gNB
for the DRB configured with *dapsConfig* }

}

##### (2) {#section-139 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting DAPS handover
and having received an *RRCReconfiguration* message including a
*reconfigurationWithSync* for handover to the neighbour cell and a
*dapsConfig* configured for any DRB }

**ensure that** {

**when** { UE has performed random access procedure to the target cell
successfully } **then** { UE transmits an *RRCReconfigurationComplete*
message to the target gNB }

}

##### (3) {#section-140 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting DAPS handover
and having received an *RRCReconfiguration* message including a
*reconfigurationWithSync* for handover to the neighbour cell and a
dapsConfig configured for any DRB }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including a
*daps-SourceRelease* } **then** { UE releases the radio link with the
source cell }

}

##### (4) {#section-141 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting DAPS handover
and having received an *RRCReconfiguration* message including a
*reconfigurationWithSync* for handover to the neighbour cell and a
dapsConfig configured for any DRB }

**ensure that** {

**when** { UE has performed random access procedure to the target cell
successfully }

**then** { UE continues the downlink user data reception from the source
gNB until releasing the source cell }

}

##### 8.1.4.3.1.2 Conformance requirements {#conformance-requirements-86 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 9.2.3.1 and 9.2.3.2.1 and TS 38.331 clause
5.3.5.3 and 5.3.5.5.2. Unless otherwise stated these are Rel-16
requirements.

\[TS 38.300, clause 9.2.3.1\]

Network controlled mobility applies to UEs in RRC\_CONNECTED and is
categorized into two types of mobility: cell level mobility and beam
level mobility.

**Cell Level Mobility** requires explicit RRC signalling to be
triggered, i.e. handover. For inter-gNB handover, the signalling
procedures consist of at least the following elemental components
illustrated in Figure 9.2.3.1-1:

Figure 9.2.3.1-1: Inter-gNB handover procedures

1\. The source gNB initiates handover and issues a HANDOVER REQUEST over
the Xn interface.

2\. The target gNB performs admission control and provides the new RRC
configuration as part of the HANDOVER REQUEST ACKNOWLEDGE.

3\. The source gNB provides the RRC configuration to the UE by
forwarding the *RRCReconfiguration* message received in the HANDOVER
REQUEST ACKNOWLEDGE. The *RRCReconfiguration* message includes at least
cell ID and all information required to access the target cell so that
the UE can access the target cell without reading system information.
For some cases, the information required for contention-based and
contention-free random access can be included in the
*RRCReconfiguration* message. The access information to the target cell
may include beam specific information, if any.

4\. The UE moves the RRC connection to the target gNB and replies with
the *RRCReconfigurationComplete*.

NOTE 1: User Data can also be sent in step 4 if the grant allows.

In case of DAPS handover, the UE continues the downlink user data
reception from the source gNB until releasing the source cell and
continues the uplink user data transmission to the source gNB until
successful random access procedure to the target gNB.

Only source and target PCell are used during DAPS handover. CA, DC, SUL,
multi-TRP, NR sidelink configurations and V2X sidelink configurations
are released by the source gNB before the handover command is sent to
the UE and are not configured by the target gNB until the DAPS handover
has completed (i.e. at source cell release).

The handover mechanism triggered by RRC requires the UE at least to
reset the MAC entity and re-establish RLC, except for DAPS handover,
where upon reception of the handover command, the UE:

\- Creates a MAC entity for target;

\- Establishes the RLC entity and an associated DTCH logical channel for
target for each DRB configured with DAPS;

\- For each DRB configured with DAPS, reconfigures the PDCP entity with
separate security and ROHC functions for source and target and
associates them with the RLC entities configured by source and target
respectively;

\- Retains the rest of the source configurations until release of the
source.

NOTE 2: The handling on RLC and PDCP for DRBs not configured with DAPS
is the same as in normal handover.

NOTE 3: Void.

RRC managed handovers with and without PDCP entity re-establishment are
both supported. For DRBs using RLC AM mode, PDCP can either be
re-established together with a security key change or initiate a data
recovery procedure without a key change. For DRBs using RLC UM mode and
for SRBs, PDCP can either be re-established together with a security key
change or remain as it is without a key change.

Data forwarding, in-sequence delivery and duplication avoidance at
handover can be guaranteed when the target gNB uses the same DRB
configuration as the source gNB.

Timer based handover failure procedure is supported in NR. RRC
connection re-establishment procedure is used for recovering from
handover failure except in certain CHO or DAPS handover scenarios:

\- When DAPS handover fails, the UE falls back to the source cell
configuration, resumes the connection with the source cell, and reports
DAPS handover failure via the source without triggering RRC connection
re-establishment if the source link has not been released.

\- When initial CHO execution attempt fails or HO fails, the UE performs
cell selection, and if the selected cell is a CHO candidate and if
network configured the UE to try CHO after handover/CHO failure, then
the UE attempts CHO execution once, otherwise re-establishment is
performed.

DAPS handover for FR2 to FR2 case is not supported in this release of
the specification.

\[TS 38.300, clause 9.2.3.2.1\]

The intra-NR RAN handover performs the preparation and execution phase
of the handover procedure performed without involvement of the 5GC, i.e.
preparation messages are directly exchanged between the gNBs. The
release of the resources at the source gNB during the handover
completion phase is triggered by the target gNB. The figure below
depicts the basic handover scenario where neither the AMF nor the UPF
changes:

Figure 9.2.3.2.1-1: Intra-AMF/UPF Handover

0\. The UE context within the source gNB contains information regarding
roaming and access restrictions which were provided either at connection
establishment or at the last TA update.

1\. The source gNB configures the UE measurement procedures and the UE
reports according to the measurement configuration.

2\. The source gNB decides to handover the UE, based on
*MeasurementReport* and RRM information.

3\. The source gNB issues a Handover Request message to the target gNB
passing a transparent RRC container with necessary information to
prepare the handover at the target side. The information includes at
least the target cell ID, KgNB\*, the C-RNTI of the UE in the source
gNB, RRM-configuration including UE inactive time, basic
AS-configuration including *antenna Info and DL Carrier Frequency*, the
current QoS flow to DRB mapping rules applied to the UE, the SIB1 from
source gNB, the UE capabilities for different RATs, PDU session related
information, and can include the UE reported measurement information
including beam-related information if available. The PDU session related
information includes the slice information and QoS flow level QoS
profile(s). The source gNB may also request a DAPS handover for one or
more DRBs.

NOTE 1: After issuing a Handover Request, the source gNB should not
reconfigure the UE, including performing Reflective QoS flow to DRB
mapping.

4\. Admission Control may be performed by the target gNB. Slice-aware
admission control shall be performed if the slice information is sent to
the target gNB. If the PDU sessions are associated with non-supported
slices the target gNB shall reject such PDU Sessions.

5\. The target gNB prepares the handover with L1/L2 and sends the
HANDOVER REQUEST ACKNOWLEDGE to the source gNB, which includes a
transparent container to be sent to the UE as an RRC message to perform
the handover. The target gNB also indicates if a DAPS handover is
accepted.

NOTE 2: As soon as the source gNB receives the HANDOVER REQUEST
ACKNOWLEDGE, or as soon as the transmission of the handover command is
initiated in the downlink, data forwarding may be initiated.

> NOTE 3: For DRBs configured with DAPS, downlink PDCP SDUs are
> forwarded with SN assigned by the source gNB, until SN assignment is
> handed over to the target gNB in step 8b, for which the normal data
> forwarding follows as defined in 9.2.3.2.3.

6\. The source gNB triggers the Uu handover by sending an
*RRCReconfiguration* message to the UE, containing the information
required to access the target cell: at least the target cell ID, the new
C-RNTI, the target gNB security algorithm identifiers for the selected
security algorithms. It can also include a set of dedicated RACH
resources, the association between RACH resources and SSB(s), the
association between RACH resources and UE-specific CSI-RS
configuration(s), common RACH resources, and system information of the
target cell, etc.

NOTE 4: For DRBs configured with DAPS, the source gNB does not stop
transmitting downlink packets until it receives the HANDOVER SUCCESS
message from the target gNB in step 8a.

NOTE 4a: CHO cannot be configured simultaneously with DAPS handover.

7a. For DRBs configured with DAPS, the source gNB sends the EARLY STATUS
TRANSFER message. The DL COUNT value conveyed in the EARLY STATUS
TRANSFER message indicates PDCP SN and HFN of the first PDCP SDU that
the source gNB forwards to the target gNB. The source gNB does not stop
assigning SNs to downlink PDCP SDUs until it sends the SN STATUS
TRANSFER message to the target gNB in step 8b.

7\. For DRBs not configured with DAPS, the source gNB sends the SN
STATUS TRANSFER message to the target gNB to convey the uplink PDCP SN
receiver status and the downlink PDCP SN transmitter status of DRBs for
which PDCP status preservation applies (i.e. for RLC AM). The uplink
PDCP SN receiver status includes at least the PDCP SN of the first
missing UL PDCP SDU and may include a bit map of the receive status of
the out of sequence UL PDCP SDUs that the UE needs to retransmit in the
target cell, if any. The downlink PDCP SN transmitter status indicates
the next PDCP SN that the target gNB shall assign to new PDCP SDUs, not
having a PDCP SN yet.

NOTE 5: In case of DAPS handover, the uplink PDCP SN receiver status and
the downlink PDCP SN transmitter status for a DRB with RLC-AM and not
configured with DAPS may be transferred by the SN STATUS TRANSFER
message in step 8b instead of step 7.

NOTE 6: For DRBs configured with DAPS, the source gNB may additionally
send the EARLY STATUS TRANSFER message(s) between step 7 and step 8b, to
inform discarding of already forwarded PDCP SDUs. The target gNB does
not transmit forwarded downlink PDCP SDUs to the UE, whose COUNT is less
than the conveyed DL COUNT value and discards them if transmission has
not been attempted already.

8\. The UE synchronises to the target cell and completes the RRC
handover procedure by sending *RRCReconfigurationComplete* message to
target gNB. In case of DAPS handover, the UE does not detach from the
source cell upon receiving the *RRCReconfiguration* message. The UE
releases the source resources and configurations and stops DL/UL
reception/transmission with the source upon receiving an explicit
release from the target node.

NOTE 6a: From RAN point of view, the DAPS handover is considered to only
be completed after the UE has released the source cell as explicitly
requested from the target node. RRC suspend, a subsequent handover or
inter-RAT handover cannot be initiated until the source cell has been
released.

8a/b In case of DAPS handover, the target gNB sends the HANDOVER SUCCESS
message to the source gNB to inform that the UE has successfully
accessed the target cell. In return, the source gNB sends the SN STATUS
TRANSFER message for DRBs configured with DAPS for which the description
in step 7 applies, and the normal data forwarding follows as defined in
9.2.3.2.3.

NOTE 7: The uplink PDCP SN receiver status and the downlink PDCP SN
transmitter status are also conveyed for DRBs with RLC-UM in the SN
STATUS TRANSFER message in step 8b, if configured with DAPS.

NOTE 8: For DRBs configured with DAPS, the source gNB does not stop
delivering uplink QoS flows to the UPF until it sends the SN STATUS
TRANSFER message in step 8b. The target gNB does not forward QoS flows
of the uplink PDCP SDUs successfully received in-sequence to the UPF
until it receives the SN STATUS TRANSFER message, in which UL HFN and
the first missing SN in the uplink PDCP SN receiver status indicates the
start of uplink PDCP SDUs to be delivered to the UPF. The target gNB
does not deliver any uplink PDCP SDUs which has an UL COUNT lower than
the provided.

NOTE 9: Void.

9\. The target gNB sends a PATH SWITCH REQUEST message to AMF to trigger
5GC to switch the DL data path towards the target gNB and to establish
an NG-C interface instance towards the target gNB.

10\. 5GC switches the DL data path towards the target gNB. The UPF sends
one or more \"end marker\" packets on the old path to the source gNB per
PDU session/tunnel and then can release any U-plane/TNL resources
towards the source gNB.

11\. The AMF confirms the PATH SWITCH REQUEST message with the PATH
SWITCH REQUEST ACKNOWLEDGE message.

12\. Upon reception of the PATH SWITCH REQUEST ACKNOWLEDGE message from
the AMF, the target gNB sends the UE CONTEXT RELEASE to inform the
source gNB about the success of the handover. The source gNB can then
release radio and C-plane related resources associated to the UE
context. Any ongoing data forwarding may continue.

...

Upon receiving a handover command requesting DAPS handover, the UE
suspends source cell SRBs, stops sending and receiving any RRC control
plane signalling toward the source cell, and establishes SRBs for the
target cell. The UE releases the source cell SRBs configuration upon
receiving source cell release indication from the target cell after
successful DAPS handover execution. When DAPS handover to the target
cell fails and if the source cell link is available, then the UE reverts
back to the source cell configuration and resumes source cell SRBs for
control plane signalling transmission.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

1\> if the *RRCReconfiguration* is applied due to a conditional
reconfiguration execution upon cell selection while timer T311 is
running, as defined in 5.3.7.3:

2\> remove all the entries within *VarConditionalReconfig*, if any;

1\> if the *RRCReconfiguration* includes the *daps-SourceRelease*:

2\> reset the source MAC and release the source MAC configuration;

2\> for each DAPS bearer:

3\> release the RLC entity or entities as specified in TS 38.322 \[4\],
clause 5.1.3, and the associated logical channel for the source SpCell;

3\> reconfigure the PDCP entity to release DAPS as specified in TS
38.323 \[5\];

2\> for each SRB:

3\> release the PDCP entity for the source SpCell;

3\> release the RLC entity as specified in TS 38.322 \[4\], clause
5.1.3, and the associated logical channel for the source SpCell;

2\> release the physical channel configuration for the source SpCell;

2\> discard the keys used in the source SpCell (the K~gNB~ key, the
K~RRCenc~ key, the K~RRCint~ key, the K~UPint~ key and the K~UPenc~
key), if any;

...

1\> if *reconfigurationWithSync* was included in *spCellConfig* of an
MCG or SCG, and when MAC of an NR cell group successfully completes a
Random Access procedure triggered above:

2\> stop timer T304 for that cell group;

2\> stop timer T310 for source SpCell if running;

2\> apply the parts of the CSI reporting configuration, the scheduling
request configuration and the sounding RS configuration that do not
require the UE to know the SFN of the respective target SpCell, if any;

2\> apply the parts of the measurement and the radio resource
configuration that require the UE to know the SFN of the respective
target SpCell (e.g. measurement gaps, periodic CQI reporting, scheduling
request configuration, sounding RS configuration), if any, upon
acquiring the SFN of that target SpCell;

2\> for each DRB configured as DAPS bearer, request uplink data
switching to the PDCP entity, as specified in TS 38.323 \[5\];

...

> NOTE 3: The UE is only required to acquire broadcasted *SIB1* if the
> UE can acquire it without disrupting unicast data reception, i.e. the
> broadcast and unicast beams are quasi co-located.

NOTE 4: The UE sets the content of *UEAssistanceInformation* according
to latest configuration (i.e. the configuration after applying the
*RRCReconfiguration* message) and latest UE preference. The UE may
include more than the concerned UE assistance information within the
*UEAssistanceInformation* according to 5.7.4.2. Therefore, the content
of *UEAssistanceInformation* message may not be similar to the original
one.

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the AS security is not activated, perform the actions upon going
to RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\'
upon which the procedure ends;

1\> if no DAPS bearer is configured:

2\> stop timer T310 for the corresponding SpCell, if running;

> 1\> if this procedure is executed for the MCG:

2\> if timer T316 is running;

3\> stop timer T316;

3\> clear the information included in *VarRLF-Report*, if any;

2\> resume MCG transmission, if suspended.

1\> stop timer T312 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1 for the
target SpCell;

1\> acquire the *MIB* of the target SpCell, which is scheduled as
specified in TS 38.213 \[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the *MIB* if the UE already has the
required timing information, or the timing information is not needed for
random access.

NOTE 2a: A UE with DAPS bearer does not monitor for system information
updates in the source PCell.

1\> If any DAPS bearer is configured:

2\> create a MAC entity for the target cell group with the same
configuration as the MAC entity for the source cell group;

2\> for each DAPS bearer:

3\> establish an RLC entity or entities for the target cell group, with
the same configurations as for the source cell group;

3\> establish the logical channel for the target cell group, with the
same configurations as for the source cell group;

NOTE 2b: In order to understand if a DAPS bearer is configured, the UE
needs to check the presence of the field *daps-Config* within the
*RadioBearerConfig* IE received in *radioBearerConfig* or
*radioBearerConfig2*.

2\> for each SRB:

3\> establish an RLC entity for the target cell group, with the same
configurations as for the source cell group;

3\> establish the logical channel for the target cell group, with the
same configurations as for the source cell group;

3\> suspend SRBs for the source cell group;

NOTE 3: Void

2\> apply the value of the *newUE-Identity* as the C-RNTI in the target
cell group;

2\> configure lower layers for the target SpCell in accordance with the
received s*pCellConfigCommon*;

2\> configure lower layers for the target SpCell in accordance with any
additional fields, not covered in the previous, if included in the
received *reconfigurationWithSync.*

##### 8.1.4.3.1.3 Test description {#test-description-86 .H6}

##### 8.1.4.3.1.3.1 Pre-test conditions {#pre-test-conditions-86 .H6}

##### System Simulator: {#system-simulator-57 .H6}

\- NR Cell 1 is the Serving cell and the power level is configured to
\'\'Serving Cell" defined in TS 38.508-1 \[4\] Table 6.2.2.1-3.

\- NR Cell 2 is the Suitable neighbour intra-frequency cell and the
power level is configured to \'\' Suitable neighbour intra-frequency
cell" defined in TS 38.508-1 \[4\] Table 6.2.2.1-3

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for both NR Cells

##### UE: {#ue-54 .H6}

\- None.

##### Preamble: {#preamble-55 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.4.3.1.3.2 Test procedure sequence {#test-procedure-sequence-87 .H6}

Table 8.1.4.3.1.3.2-1: Main behaviour

  St   Procedure                                                                                                                                                                                                Message Sequence   TP                                     Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message containing *reconfigurationWithSync* to order UE to perform DAPS handover to NR Cell 2. DRB\#n of the first PDU session is configured as DAPS bearer.   \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  \-   EXCEPTION: In parallel with step 2-3, parallel behaviour defined in table 8.1.4.3.1.3.2-2 is executed repeatedly.                                                                                        \-                 \-                                     \-        \-
  2    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on DRB\#n of the first PDU session on NR Cell 1?          \<\--              \-                                     1         \-
  3    Void                                                                                                                                                                                                     \-                 \-                                     \-        \-
  4    The SS transmits Random Access Response to respond to the latest preamble on NR Cell 2.                                                                                                                  \<\--              Random Access Response                 \-        \-
  5    Check: Does UE transmit an RRCReconfigurationComplete message in NR Cell 2?                                                                                                                              \--\>              NR RRC: *RRCReconfigurationComplete*   1,2       P
  5A   The SS transmits one IP Packet to verify data path on DRB\#n of the first PDU session on NR Cell 1                                                                                                       \-                 \-                                     \-        \-
  5B   Check: Does the UE transmit HARQ feedback after step 5A?                                                                                                                                                 \-                 \-                                     4         P
  5C   The UE loops back the IP packet received in step 5A on DRB\#n of the first PDU session on NR Cell 2.                                                                                                     \-                 \-                                     \-        \-
  6    The SS transmits an *RRCReconfiguration* message with condition DAPS\_HO\_ReleaseSource in NR Cell 2.                                                                                                    \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  7    Check: Does the UE transmit an RRCReconfigurationComplete message in NR Cell 2?                                                                                                                          \--\>              NR RRC: *RRCReconfigurationComplete*   3         P
  8    Check: Does the test result of generic test procedure in TS 38.508-1 Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on DRB\#n of the first PDU session on NR Cell 2?                \-                 \-                                     2         \-
  9    The SS transmits one IP Packet to verify data path on DRB\#n of the first PDU session on NR Cell 1.                                                                                                      \-                 \-                                     \-        \-
  10   Check: Does UE send the IP Packet on DRB\#n of the first PDU session in the uplink on NR Cell 1 within the next 1s?                                                                                      \-                 \-                                     3         F

Table 8.1.4.3.1.3.2-2: Parallel behaviour

  St   Procedure                                 Message Sequence   TP                 Verdict   
  ---- ----------------------------------------- ------------------ ------------------ --------- ----
                                                 U - S              Message                      
  1    The UE transmits preamble to NR Cell 2.   -\>                (PRACH Preamble)   \-        \-

##### 8.1.4.3.1.3.3 Specific message contents {#specific-message-contents-78 .H6}

Table 8.1.4.3.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.4.3.1.3.2-1)

  --------------------------------------------------------------------------------------- --------------------------------------------------------------------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with Condition RBConfig\_KeyChange                                                                                                                           
  Information Element                                                                     Value/remark                                                                Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                                                                               
  criticalExtensions CHOICE {                                                                                                                                                                                     
  rrcReconfiguration SEQUENCE {                                                                                                                                                                                   
  radioBearerConfig                                                                       RadioBearerConfig with conditions SRB\_NR\_PDCP and (DRBn AND DAPS\_PDCP)                                               
  nonCriticalExtension SEQUENCE{                                                                                                                                                                                  
  masterCellGroup                                                                         CellGroupConfig                                                             OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                                                                                               
  }                                                                                                                                                                                                               
  }                                                                                                                                                                                                               
  }                                                                                                                                                                                                               
  --------------------------------------------------------------------------------------- --------------------------------------------------------------------------- ------------------------------------------- -----------

Table 8.1.4.3.1.3.3-2: *CellGroupConfig* (Table 8.1.4.3.1.3.3-1)

  ------------------------------------------------------------------------- ------------------------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition CFRA                                                                        
  Information Element                                                       Value/remark                                Comment                 Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLCH)) OF RLC-BearerConfig {   3 entries                                                           
  RLC-BearerConfig\[1\]                                                     RLC-BearerConfig with conditions SRB1       entry 1                 
  RLC-BearerConfig\[2\]                                                     RLC-BearerConfig with conditions SRB2       entry 2                 
  RLC-BearerConfig\[3\]                                                     RLC-BearerConfig with conditions AM, DRBn   entry 3                 
  }                                                                                                                                             
  mac-CellGroupConfig                                                       MAC-CellGroupConfig                         Table 8.1.4.3.1.3.3-6   
  spCellConfig SEQUENCE {                                                                                                                       
  reconfigurationWithSync SEQUENCE {                                                                                                            
  spCellConfigCommon SEQUENCE {                                                                                                                 
  physCellId                                                                Physical Cell Identity of NR Cell 2                                 
  uplinkConfigCommon SEQUENCE {                                                                                                                 
  initialUplinkBWP SEQUENCE {                                                                                                                   
  rach-ConfigCommon CHOICE {                                                                                                                    
  setup SEQUENCE {                                                                                                                              
  rach-ConfigGeneric                                                        RACH-ConfigGeneric                          Table 8.1.4.3.1.3.3-4   
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  ------------------------------------------------------------------------- ------------------------------------------- ----------------------- -----------

Table 8.1.4.3.1.3.3-3: *Void*

Table 8.1.4.3.1.3.3-4: *RACH-ConfigGeneric* (Table 8.1.4.3.1.3.3-2)

  ----------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-130                            
  Information Element                                   Value/remark   Comment   Condition
  RACH-ConfigGeneric ::= SEQUENCE {                                              
  preambleTransMax                                      n200                     
  }                                                                              
  ----------------------------------------------------- -------------- --------- -----------

Table 8.1.4.3.1.3.3-5: *RRCReconfiguration* (step 6, Table
8.1.4.3.1.3.2-1)

  -------------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with Condition DAPS\_HO\_ReleaseSource
  -------------------------------------------------------------------------------------------

Table 8.1.4.3.1.3.3-6: MAC-CellGroupConfig (Table 8.1.4.3.1.3.3-2)

  ------------------------------------------- -------------- --------- -----------
  Derivation Path: 38.508-1, Table 4.6.3-68                            
  Information Element                         Value/remark   Comment   Condition
  MAC-CellGroupConfig ::= SEQUENCE {                                   
  tag-Config                                  Not present              
  }                                                                    
  ------------------------------------------- -------------- --------- -----------

##### 8.1.4.3.2 DAPS handover / HO Failure and source link available / HO Success and RLF in source / Intra-frequency

##### 8.1.4.3.2.1 Test Purpose (TP) {#test-purpose-tp-87 .H6}

##### (1) {#section-142 .H6}

**with** { UE in NR RRC\_CONNECTED state and having received an
RRCReconfiguration message including a reconfigurationWithSync for
handover to the neighbour cell and a dapsConfig configured for a DRB }

**ensure that** {

**when** { T304 of the MCG expires and the source link has not been
released }

**then** { UE falls back to source cell configuration, resumes the
connection with source cell, and reports DAPS HO failure via the source
without triggering RRC connection re-establishment }

}

##### (2) {#section-143 .H6}

**with** { UE in NR RRC\_CONNECTED state and having received an
RRCReconfiguration message including a reconfigurationWithSync for
handover to the neighbour cell and a dapsConfig configured for a DRB }

**ensure that** {

**when** { Radio link failure is detected for the source MCG }

**then** { UE suspends all DRBs in the source, releases the source
connection and continues the handover procedure to target }

}

##### 8.1.4.3.2.2 Conformance requirements {#conformance-requirements-87 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 9.2.3.1 and 9.2.3.2.1 and TS 38.331 clause
5.3.5.3, 5.3.5.5.2, 5.3.5.5.6, 5.3.5.5.7, 5.3.5.8.3, 5.3.10.3 and
5.7.5.3. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.300, clause 9.2.3.1\]

Network controlled mobility applies to UEs in RRC\_CONNECTED and is
categorized into two types of mobility: cell level mobility and beam
level mobility.

**Cell Level Mobility** requires explicit RRC signalling to be
triggered, i.e. handover. For inter-gNB handover, the signalling
procedures consist of at least the following elemental components
illustrated in Figure 9.2.3.1-1:

Figure 9.2.3.1-1: Inter-gNB handover procedures

1\. The source gNB initiates handover and issues a HANDOVER REQUEST over
the Xn interface.

2\. The target gNB performs admission control and provides the new RRC
configuration as part of the HANDOVER REQUEST ACKNOWLEDGE.

3\. The source gNB provides the RRC configuration to the UE by
forwarding the *RRCReconfiguration* message received in the HANDOVER
REQUEST ACKNOWLEDGE. The *RRCReconfiguration* message includes at least
cell ID and all information required to access the target cell so that
the UE can access the target cell without reading system information.
For some cases, the information required for contention-based and
contention-free random access can be included in the
*RRCReconfiguration* message. The access information to the target cell
may include beam specific information, if any.

4\. The UE moves the RRC connection to the target gNB and replies with
the *RRCReconfigurationComplete*.

NOTE 1: User Data can also be sent in step 4 if the grant allows.

In case of DAPS handover, the UE continues the downlink user data
reception from the source gNB until releasing the source cell and
continues the uplink user data transmission to the source gNB until
successful random access procedure to the target gNB.

Only source and target PCell are used during DAPS handover. CA, DC, SUL,
multi-TRP, NR sidelink configurations and V2X sidelink configurations
are released by the source gNB before the handover command is sent to
the UE and are not configured by the target gNB until the DAPS handover
has completed (i.e. at source cell release).

The handover mechanism triggered by RRC requires the UE at least to
reset the MAC entity and re-establish RLC, except for DAPS handover,
where upon reception of the handover command, the UE:

\- Creates a MAC entity for target;

\- Establishes the RLC entity and an associated DTCH logical channel for
target for each DRB configured with DAPS;

\- For each DRB configured with DAPS, reconfigures the PDCP entity with
separate security and ROHC functions for source and target and
associates them with the RLC entities configured by source and target
respectively;

\- Retains the rest of the source configurations until release of the
source.

NOTE 2: The handling on RLC and PDCP for DRBs not configured with DAPS
is the same as in normal handover.

NOTE 3: Void.

RRC managed handovers with and without PDCP entity re-establishment are
both supported. For DRBs using RLC AM mode, PDCP can either be
re-established together with a security key change or initiate a data
recovery procedure without a key change. For DRBs using RLC UM mode and
for SRBs, PDCP can either be re-established together with a security key
change or remain as it is without a key change.

Data forwarding, in-sequence delivery and duplication avoidance at
handover can be guaranteed when the target gNB uses the same DRB
configuration as the source gNB.

Timer based handover failure procedure is supported in NR. RRC
connection re-establishment procedure is used for recovering from
handover failure except in certain CHO or DAPS handover scenarios:

\- When DAPS handover fails, the UE falls back to the source cell
configuration, resumes the connection with the source cell, and reports
DAPS handover failure via the source without triggering RRC connection
re-establishment if the source link has not been released.

\- When initial CHO execution attempt fails or HO fails, the UE performs
cell selection, and if the selected cell is a CHO candidate and if
network configured the UE to try CHO after handover/CHO failure, then
the UE attempts CHO execution once, otherwise re-establishment is
performed.

DAPS handover for FR2 to FR2 case is not supported in this release of
the specification.

\[TS 38.300, clause 9.2.3.2.1\]

The intra-NR RAN handover performs the preparation and execution phase
of the handover procedure performed without involvement of the 5GC, i.e.
preparation messages are directly exchanged between the gNBs. The
release of the resources at the source gNB during the handover
completion phase is triggered by the target gNB. The figure below
depicts the basic handover scenario where neither the AMF nor the UPF
changes:

Figure 9.2.3.2.1-1: Intra-AMF/UPF Handover

0\. The UE context within the source gNB contains information regarding
roaming and access restrictions which were provided either at connection
establishment or at the last TA update.

1\. The source gNB configures the UE measurement procedures and the UE
reports according to the measurement configuration.

2\. The source gNB decides to handover the UE, based on
*MeasurementReport* and RRM information.

3\. The source gNB issues a Handover Request message to the target gNB
passing a transparent RRC container with necessary information to
prepare the handover at the target side. The information includes at
least the target cell ID, KgNB\*, the C-RNTI of the UE in the source
gNB, RRM-configuration including UE inactive time, basic
AS-configuration including *antenna Info and DL Carrier Frequency*, the
current QoS flow to DRB mapping rules applied to the UE, the SIB1 from
source gNB, the UE capabilities for different RATs, PDU session related
information, and can include the UE reported measurement information
including beam-related information if available. The PDU session related
information includes the slice information and QoS flow level QoS
profile(s). The source gNB may also request a DAPS handover for one or
more DRBs.

NOTE 1: After issuing a Handover Request, the source gNB should not
reconfigure the UE, including performing Reflective QoS flow to DRB
mapping.

4\. Admission Control may be performed by the target gNB. Slice-aware
admission control shall be performed if the slice information is sent to
the target gNB. If the PDU sessions are associated with non-supported
slices the target gNB shall reject such PDU Sessions.

5\. The target gNB prepares the handover with L1/L2 and sends the
HANDOVER REQUEST ACKNOWLEDGE to the source gNB, which includes a
transparent container to be sent to the UE as an RRC message to perform
the handover. The target gNB also indicates if a DAPS handover is
accepted.

NOTE 2: As soon as the source gNB receives the HANDOVER REQUEST
ACKNOWLEDGE, or as soon as the transmission of the handover command is
initiated in the downlink, data forwarding may be initiated.

> NOTE 3: For DRBs configured with DAPS, downlink PDCP SDUs are
> forwarded with SN assigned by the source gNB, until SN assignment is
> handed over to the target gNB in step 8b, for which the normal data
> forwarding follows as defined in 9.2.3.2.3.

6\. The source gNB triggers the Uu handover by sending an
*RRCReconfiguration* message to the UE, containing the information
required to access the target cell: at least the target cell ID, the new
C-RNTI, the target gNB security algorithm identifiers for the selected
security algorithms. It can also include a set of dedicated RACH
resources, the association between RACH resources and SSB(s), the
association between RACH resources and UE-specific CSI-RS
configuration(s), common RACH resources, and system information of the
target cell, etc.

NOTE 4: For DRBs configured with DAPS, the source gNB does not stop
transmitting downlink packets until it receives the HANDOVER SUCCESS
message from the target gNB in step 8a.

NOTE 4a: CHO cannot be configured simultaneously with DAPS handover.

7a. For DRBs configured with DAPS, the source gNB sends the EARLY STATUS
TRANSFER message. The DL COUNT value conveyed in the EARLY STATUS
TRANSFER message indicates PDCP SN and HFN of the first PDCP SDU that
the source gNB forwards to the target gNB. The source gNB does not stop
assigning SNs to downlink PDCP SDUs until it sends the SN STATUS
TRANSFER message to the target gNB in step 8b.

7\. For DRBs not configured with DAPS, the source gNB sends the SN
STATUS TRANSFER message to the target gNB to convey the uplink PDCP SN
receiver status and the downlink PDCP SN transmitter status of DRBs for
which PDCP status preservation applies (i.e. for RLC AM). The uplink
PDCP SN receiver status includes at least the PDCP SN of the first
missing UL PDCP SDU and may include a bit map of the receive status of
the out of sequence UL PDCP SDUs that the UE needs to retransmit in the
target cell, if any. The downlink PDCP SN transmitter status indicates
the next PDCP SN that the target gNB shall assign to new PDCP SDUs, not
having a PDCP SN yet.

NOTE 5: In case of DAPS handover, the uplink PDCP SN receiver status and
the downlink PDCP SN transmitter status for a DRB with RLC-AM and not
configured with DAPS may be transferred by the SN STATUS TRANSFER
message in step 8b instead of step 7.

NOTE 6: For DRBs configured with DAPS, the source gNB may additionally
send the EARLY STATUS TRANSFER message(s) between step 7 and step 8b, to
inform discarding of already forwarded PDCP SDUs. The target gNB does
not transmit forwarded downlink PDCP SDUs to the UE, whose COUNT is less
than the conveyed DL COUNT value and discards them if transmission has
not been attempted already.

8\. The UE synchronises to the target cell and completes the RRC
handover procedure by sending *RRCReconfigurationComplete* message to
target gNB. In case of DAPS handover, the UE does not detach from the
source cell upon receiving the *RRCReconfiguration* message. The UE
releases the source resources and configurations and stops DL/UL
reception/transmission with the source upon receiving an explicit
release from the target node.

NOTE 6a: From RAN point of view, the DAPS handover is considered to only
be completed after the UE has released the source cell as explicitly
requested from the target node. RRC suspend, a subsequent handover or
inter-RAT handover cannot be initiated until the source cell has been
released.

8a/b In case of DAPS handover, the target gNB sends the HANDOVER SUCCESS
message to the source gNB to inform that the UE has successfully
accessed the target cell. In return, the source gNB sends the SN STATUS
TRANSFER message for DRBs configured with DAPS for which the description
in step 7 applies, and the normal data forwarding follows as defined in
9.2.3.2.3.

NOTE 7: The uplink PDCP SN receiver status and the downlink PDCP SN
transmitter status are also conveyed for DRBs with RLC-UM in the SN
STATUS TRANSFER message in step 8b, if configured with DAPS.

NOTE 8: For DRBs configured with DAPS, the source gNB does not stop
delivering uplink QoS flows to the UPF until it sends the SN STATUS
TRANSFER message in step 8b. The target gNB does not forward QoS flows
of the uplink PDCP SDUs successfully received in-sequence to the UPF
until it receives the SN STATUS TRANSFER message, in which UL HFN and
the first missing SN in the uplink PDCP SN receiver status indicates the
start of uplink PDCP SDUs to be delivered to the UPF. The target gNB
does not deliver any uplink PDCP SDUs which has an UL COUNT lower than
the provided.

NOTE 9: Void.

9\. The target gNB sends a PATH SWITCH REQUEST message to AMF to trigger
5GC to switch the DL data path towards the target gNB and to establish
an NG-C interface instance towards the target gNB.

10\. 5GC switches the DL data path towards the target gNB. The UPF sends
one or more \"end marker\" packets on the old path to the source gNB per
PDU session/tunnel and then can release any U-plane/TNL resources
towards the source gNB.

11\. The AMF confirms the PATH SWITCH REQUEST message with the PATH
SWITCH REQUEST ACKNOWLEDGE message.

12\. Upon reception of the PATH SWITCH REQUEST ACKNOWLEDGE message from
the AMF, the target gNB sends the UE CONTEXT RELEASE to inform the
source gNB about the success of the handover. The source gNB can then
release radio and C-plane related resources associated to the UE
context. Any ongoing data forwarding may continue.

...

Upon receiving a handover command requesting DAPS handover, the UE
suspends source cell SRBs, stops sending and receiving any RRC control
plane signalling toward the source cell, and establishes SRBs for the
target cell. The UE releases the source cell SRBs configuration upon
receiving source cell release indication from the target cell after
successful DAPS handover execution. When DAPS handover to the target
cell fails and if the source cell link is available, then the UE reverts
back to the source cell configuration and resumes source cell SRBs for
control plane signalling transmission.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

1\> if the *RRCReconfiguration* is applied due to a conditional
reconfiguration execution upon cell selection while timer T311 is
running, as defined in 5.3.7.3:

2\> remove all the entries within *VarConditionalReconfig*, if any;

1\> if the *RRCReconfiguration* includes the *daps-SourceRelease*:

2\> reset the source MAC and release the source MAC configuration;

2\> for each DAPS bearer:

3\> release the RLC entity or entities as specified in TS 38.322 \[4\],
clause 5.1.3, and the associated logical channel for the source SpCell;

3\> reconfigure the PDCP entity to release DAPS as specified in TS
38.323 \[5\];

2\> for each SRB:

3\> release the PDCP entity for the source SpCell;

3\> release the RLC entity as specified in TS 38.322 \[4\], clause
5.1.3, and the associated logical channel for the source SpCell;

2\> release the physical channel configuration for the source SpCell;

2\> discard the keys used in the source SpCell (the K~gNB~ key, the
K~RRCenc~ key, the K~RRCint~ key, the K~UPint~ key and the K~UPenc~
key), if any;

...

1\> if *reconfigurationWithSync* was included in *spCellConfig* of an
MCG or SCG, and when MAC of an NR cell group successfully completes a
Random Access procedure triggered above:

2\> stop timer T304 for that cell group;

2\> stop timer T310 for source SpCell if running;

2\> apply the parts of the CSI reporting configuration, the scheduling
request configuration and the sounding RS configuration that do not
require the UE to know the SFN of the respective target SpCell, if any;

2\> apply the parts of the measurement and the radio resource
configuration that require the UE to know the SFN of the respective
target SpCell (e.g. measurement gaps, periodic CQI reporting, scheduling
request configuration, sounding RS configuration), if any, upon
acquiring the SFN of that target SpCell;

2\> for each DRB configured as DAPS bearer, request uplink data
switching to the PDCP entity, as specified in TS 38.323 \[5\];

...

> NOTE 3: The UE is only required to acquire broadcasted *SIB1* if the
> UE can acquire it without disrupting unicast data reception, i.e. the
> broadcast and unicast beams are quasi co-located.

NOTE 4: The UE sets the content of *UEAssistanceInformation* according
to latest configuration (i.e. the configuration after applying the
*RRCReconfiguration* message) and latest UE preference. The UE may
include more than the concerned UE assistance information within the
*UEAssistanceInformation* according to 5.7.4.2. Therefore, the content
of *UEAssistanceInformation* message may not be similar to the original
one.

\[TS 38.331, clause 5.3.5.5.2\]

The UE shall perform the following actions to execute a reconfiguration
with sync.

1\> if the AS security is not activated, perform the actions upon going
to RRC\_IDLE as specified in 5.3.11 with the release cause \'*other*\'
upon which the procedure ends;

1\> if no DAPS bearer is configured:

2\> stop timer T310 for the corresponding SpCell, if running;

> 1\> if this procedure is executed for the MCG:

2\> if timer T316 is running;

3\> stop timer T316;

3\> clear the information included in *VarRLF-Report*, if any;

2\> resume MCG transmission, if suspended.

1\> stop timer T312 for the corresponding SpCell, if running;

1\> start timer T304 for the corresponding SpCell with the timer value
set to *t304*, as included in the *reconfigurationWithSync*;

1\> if the *frequencyInfoDL* is included:

2\> consider the target SpCell to be one on the SSB frequency indicated
by the *frequencyInfoDL* with a physical cell identity indicated by the
*physCellId*;

1\> else:

2\> consider the target SpCell to be one on the SSB frequency of the
source SpCell with a physical cell identity indicated by the
*physCellId*;

1\> start synchronising to the DL of the target SpCell;

1\> apply the specified BCCH configuration defined in 9.1.1.1 for the
target SpCell;

1\> acquire the *MIB* of the target SpCell, which is scheduled as
specified in TS 38.213 \[13\];

NOTE 1: The UE should perform the reconfiguration with sync as soon as
possible following the reception of the RRC message triggering the
reconfiguration with sync, which could be before confirming successful
reception (HARQ and ARQ) of this message.

NOTE 2: The UE may omit reading the *MIB* if the UE already has the
required timing information, or the timing information is not needed for
random access.

NOTE 2a: A UE with DAPS bearer does not monitor for system information
updates in the source PCell.

1\> If any DAPS bearer is configured:

2\> create a MAC entity for the target cell group with the same
configuration as the MAC entity for the source cell group;

2\> for each DAPS bearer:

3\> establish an RLC entity or entities for the target cell group, with
the same configurations as for the source cell group;

3\> establish the logical channel for the target cell group, with the
same configurations as for the source cell group;

NOTE 2b: In order to understand if a DAPS bearer is configured, the UE
needs to check the presence of the field *daps-Config* within the
*RadioBearerConfig* IE received in *radioBearerConfig* or
*radioBearerConfig2*.

2\> for each SRB:

3\> establish an RLC entity for the target cell group, with the same
configurations as for the source cell group;

3\> establish the logical channel for the target cell group, with the
same configurations as for the source cell group;

3\> suspend SRBs for the source cell group;

NOTE 3: Void

2\> apply the value of the *newUE-Identity* as the C-RNTI in the target
cell group;

2\> configure lower layers for the target SpCell in accordance with the
received s*pCellConfigCommon*;

2\> configure lower layers for the target SpCell in accordance with any
additional fields, not covered in the previous, if included in the
received *reconfigurationWithSync.*

\[TS 38.331, clause 5.3.5.5.6\]

The UE shall:

1\> if the received *rlf-TimersAndConstants* is set to *release*:

2\> if any DAPS bearer is configured:

3\> use values for timers T301, T310, T311 and constants N310, N311 for
the target cell group, as included in *ue-TimersAndConstants* received
in *SIB1*;

2\> else:

3\> use values for timers T301, T310, T311 and constants N310, N311, as
included in *ue-TimersAndConstants* received in *SIB1*;

1\> else:

2\> if any DAPS bearer is configured:

3\> configure the value of timers and constants for the target cell
group in accordance with received *rlf-TimersAndConstants*;

2\> else:

3\> (re-)configure the value of timers and constants in accordance with
received *rlf-TimersAndConstants*;

3\> stop timer T310 for this cell group, if running;

3\> stop timer T312 for this cell group, if running;

3\> reset the counters N310 and N311.

\[TS 38.331, clause 5.3.5.5.7\]

The UE shall:

1\> if the *SpCellConfig* contains the *rlf-TimersAndConstants*:

2\> configure the RLF timers and constants for this cell group as
specified in 5.3.5.5.6;

1\> else if *rlf-TimersAndConstants* is not configured for this cell
group:

2\> if any DAPS bearer is configured:

3\> use values for timers T301, T310, T311 and constants N310, N311 for
the target cell group, as included in *ue-TimersAndConstants* received
in *SIB1*;

2\> else

3\> use values for timers T301, T310, T311 and constants N310, N311, as
included in *ue-TimersAndConstants* received in *SIB1*;

...

\[TS 38.331, clause 5.3.5.8.3\]

The UE shall:

1\> if T304 of the MCG expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated* if
configured;

2\> release dedicated msgA PUSCH resources provided in
*rach-ConfigDedicated* if configured;

2\> if any DAPS bearer is configured, and radio link failure is not
detected in the source PCell, according to subclause 5.3.10.3:

3\> reset MAC for the target PCell and release the MAC configuration for
the target PCell;

3\> for each DAPS bearer:

4\> release the RLC entity or entities as specified in TS 38.322 \[4\],
clause 5.1.3, and the associated logical channel for the target PCell;

4\> reconfigure the PDCP entity to release DAPS as specified in TS
38.323 \[5\];

3\> for each SRB:

4\> if the *masterKeyUpdate* was not received:

5\> configure the PDCP entity for the source PCell with state variables
continuation as specified in TS 38.323 \[5\], the state variables as the
PDCP entity for the target PCell;

4\> release the PDCP entity for the target PCell;

4\> release the RLC entity as specified in TS 38.322 \[4\], clause
5.1.3, and the associated logical channel for the target PCell;

4\> trigger the PDCP entity for the source PCell to perform SDU discard
as specified in TS 38.323 \[5\];

4\> re-establish the RLC entity for the source PCell;

3\> release the physical channel configuration for the target PCell;

3\> revert back to the SDAP configuration used in the source PCell;

3\> discard the keys used in target PCell (the K~gNB~ key, the K~RRCenc~
key, the K~RRCint~ key, the K~UPint~ key and the K~UPenc~ key), if any;

3\> resume suspended SRBs in the source PCell;

3\> for each non DAPS bearer:

4\> revert back to the UE configuration used for the DRB in the source
PCell, includes PDCP, RLC states variables, the security configuration
and the data stored in transmission and reception buffers in PDCP and
RLC entities ;

3\> revert back to the UE measurement configuration used in the source
PCell;

3\> initiate the failure information procedure as specified in subclause
5.7.5 to report DAPS handover failure.

...

NOTE 2: In this clause, the term \'handover failure\' has been used to
refer to \'reconfiguration with sync failure\'.

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

1\> if any DAPS bearer is configured and T304 is running:

2\> upon T310 expiry in source SpCell; or

2\> upon random access problem indication from source MCG MAC; or

2\> upon indication from source MCG RLC that the maximum number of
retransmissions has been reached; or

2\> upon consistent uplink LBT failure indication from source MCG MAC:

3\> consider radio link failure to be detected for the source MCG i.e.
source RLF;

3\> suspend the transmission and reception of all DRBs in the source
MCG;

3\> reset MAC for the source MCG;

3\> release the source connection.

\[TS 38.331, clause 5.7.5.3\]

The UE shall:

...

1\> if initiated to provide DAPS failure information, set
*FailureInfoDAPS* as follows:

2\> set the *failureType* as *daps-failure*;

1\> if used to inform the network about a failure for an MCG RLC bearer
or DAPS failure information:

2\> submit the *FailureInformation* message to lower layers for
transmission via SRB1;

##### 8.1.4.3.2.3 Test description {#test-description-87 .H6}

##### 8.1.4.3.2.3.1 Pre-test conditions {#pre-test-conditions-87 .H6}

##### System Simulator: {#system-simulator-58 .H6}

\- NR Cell 1 is the Serving cell and NR Cell 2 is the Suitable neighbour
intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR Cells.

##### UE: {#ue-55 .H6}

\- None.

##### Preamble: {#preamble-56 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.4.3.2.3.2 Test procedure sequence {#test-procedure-sequence-88 .H6}

Table 8.1.4.3.2.3.2-1 illustrates the downlink power levels and other
changing parameters to be applied for the NR cells at various time
instants of the test execution. The exact instants on which these values
shall be applied are described in the texts in this clause. The
configuration \"T0\" indicates the initial conditions. Subsequent
configurations marked \"T1\", \"T2\" and \"T3\" are applied at the
points indicated in the Main behaviour description in Table
8.1.4.3.2.3.2-2.

Table 8.1.4.3.2.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T0 | SS/PBCH   | dBm/SCS | -88       | -94       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T1 | Void      | Void    | Void      | Void      |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -88       | -88       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T3 | SS/PBCH   | dBm/SCS | off       | -88       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.4.3.2.3.2-2: Main behaviour

  St   Procedure                                                                                                                                                                                                                  Message Sequence   TP                                     Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                                  U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message containing *reconfigurationWithSync* to order UE to perform DAPS handover to NR Cell 2. DRB\#n of the first PDU session is configured as DAPS bearer.                     \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  \-   EXCEPTION: In parallel with step 3, parallel behaviour defined in table 8.1.4.3.2.3.2-3 is executed repeatedly until T304 expiry.                                                                                          \-                 \-                                     \-        \-
  2    Void                                                                                                                                                                                                                       \-                 \-                                     \-        \-
  3    Check: Does the UE transmit an *RRCReestablishmentRequest* message on NR Cell 1 within 5s?                                                                                                                                 \--\>              NR RRC: *RRCReestablishmentRequest*    1         F
  4    Check: Does the UE transmit a *FailureInformation* message with failureType-r16 set to *daps-failure* on NR Cell 1 within 5s of T304 expiry?                                                                               \--\>              NR RRC: *FailureInformation*           1         P
  5    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE revert back to the configuration used in the source PCell on DRB\#n of the first PDU session on NR Cell 1?   \-                 \-                                     1         \-
  6    The SS changes the power level setting according to the row \"T2\".                                                                                                                                                        \-                 \-                                     \-        \-
  7    The SS transmits an *RRCReconfiguration* message containing *reconfigurationWithSync* to order UE to perform DAPS handover to NR Cell 2. DRB\#n of the first PDU session is configured as DAPS bearer.                     \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  \-   EXCEPTION: In parallel with step 8, parallel behaviour defined in table 8.1.4.3.2.3.2-3 is executed repeatedly.                                                                                                            \-                 \-                                     \-        \-
  8    The SS changes the power level setting according to the row \"T3\" and waits 300ms to ensure T310 expires in NR Cell 1.                                                                                                    \-                 \-                                     \-        \-
  9    The SS transmits Random Access Response to respond to the latest preamble on NR Cell 2.                                                                                                                                    \<\--              Random Access Response                 \-        \-
  10   Check: Does UE transmit an *RRCReconfigurationComplete* message in NR Cell 2?                                                                                                                                              \--\>              NR RRC: *RRCReconfigurationComplete*   2         P
  11   Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on DRB\#n of the first PDU session on NR Cell 2?                            \-                 \-                                     2         \-
  12   The SS transmits an *RRCReconfiguration* message with condition DAPS\_HO\_ReleaseSource in NR Cell 2.                                                                                                                      \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  13   The UE transmits an *RRCReconfigurationComplete* message in NR Cell 2.                                                                                                                                                     \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-

Table 8.1.4.3.2.3.2-3: Parallel behaviour

  St   Procedure                                 Message Sequence   TP                 Verdict   
  ---- ----------------------------------------- ------------------ ------------------ --------- ----
                                                 U - S              Message                      
  1    The UE transmits preamble to NR Cell 2.   -\>                (PRACH Preamble)   \-        \-
  2    The SS does not respond.                  \-                 \-                 \-        \-

##### 8.1.4.3.2.3.3 Specific message contents {#specific-message-contents-79 .H6}

Table 8.1.4.3.2.3.3-1: *SIB1* for NR Cell 1 (all steps)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/Remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                          
  ue-TimersAndConstants SEQUENCE {                                             
  t310                                                ms0            0 ms      
  }                                                                            
  }                                                                            

Table 8.1.4.3.2.3.3-2: *RRCReconfiguration* (step 1 and step 7, Table
8.1.4.3.2.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with Condition RBConfig\_KeyChange                                                                                                                                                  
  --------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ---------------------------------------------------------------- -----------
  Information Element                                                                     Value/remark                                                                  Comment                                                          Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                                                                                                      
  criticalExtensions CHOICE {                                                                                                                                                                                                            
  rrcReconfiguration SEQUENCE {                                                                                                                                                                                                          
  radioBearerConfig                                                                       RadioBearerConfig with conditions (SRB\_NR\_PDCP) and (DRBn AND DAPS\_PDCP)                                                                    
  nonCriticalExtension SEQUENCE{                                                                                                                                                                                                         
  masterCellGroup                                                                         CellGroupConfig                                                               OCTET STRING (CONTAINING CellGroupConfig)Table 8.1.4.3.2.3.3-3   
  }                                                                                                                                                                                                                                      
  }                                                                                                                                                                                                                                      
  }                                                                                                                                                                                                                                      
  }                                                                                                                                                                                                                                      

Table 8.1.4.3.2.3.3-3: *CellGroupConfig* (Table 8.1.4.3.2.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change and CFRA                                                                       
  ------------------------------------------------------------------------------------------ ------------------------------------------- ----------------------- -----------
  Information Element                                                                        Value/remark                                Comment                 Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                                 
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLCH)) OF RLC-BearerConfig {                    3 entries                                                           
  RLC-BearerConfig\[1\]                                                                      RLC-BearerConfig with conditions SRB1       entry 1                 
  RLC-BearerConfig\[2\]                                                                      RLC-BearerConfig with conditions SRB2       entry 2                 
  RLC-BearerConfig\[3\]                                                                      RLC-BearerConfig with conditions AM, DRBn   entry 3                 
  }                                                                                                                                                              
  spCellConfig SEQUENCE {                                                                                                                                        
  reconfigurationWithSync SEQUENCE {                                                                                                                             
  spCellConfigCommon SEQUENCE {                                                                                                                                  
  physCellId                                                                                 Physical Cell Identity of NR Cell 2                                 
  uplinkConfigCommon SEQUENCE {                                                                                                                                  
  initialUplinkBWP SEQUENCE {                                                                                                                                    
  rach-ConfigCommon CHOICE {                                                                                                                                     
  setup SEQUENCE {                                                                                                                                               
  rach-ConfigGeneric                                                                         RACH-ConfigGeneric                          Table 8.1.4.3.2.3.3-5   
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              

Table 8.1.4.3.2.3.3-4: Void

Table 8.1.4.3.2.3.3-5: *RACH-ConfigGeneric* (Table 8.1.4.3.2.3.3-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-130                            
  ----------------------------------------------------- -------------- --------- -----------
  Information Element                                   Value/remark   Comment   Condition
  RACH-ConfigGeneric ::= SEQUENCE {                                              
  preambleTransMax                                      n200                     
  }                                                                              

Table 8.1.4.3.2.3.3-6: *FailureInformation* (step 4, Table
8.1.4.3.2.3.2-2)

  ----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-4 with Condition DAPS\_HOF
  ----------------------------------------------------------------------------

Table 8.1.4.3.2.3.3-7: *RRCReconfiguration* (step 12, Table
8.1.4.3.2.3.2-2)

  -------------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with Condition DAPS\_HO\_ReleaseSource
  -------------------------------------------------------------------------------------------

##### 8.1.4.3.3 

##### 8.1.4.3.4 DAPS handover with key change / Success / Inter-frequency

###### 8.1.4.3.4.1 DAPS handover with key change / Success / Inter-frequency / Intra-band non-contiguous

##### 8.1.4.3.4.1.1 Test Purpose (TP)

##### (1) {#section-145 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting DAPS handover }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including a
*reconfigurationWithSync* for handover with key change and *dapsConfig*
is configured for a DRB } **then** { UE performs DAPS handover to the
target cell and keeps DL/UL reception/transmission with the source gNB
for the DRB configured with *dapsConfig* }

}

##### (2) {#section-146 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting DAPS handover
and having received an *RRCReconfiguration* message including a
*reconfigurationWithSync* for handover to the neighbour cell and a
*dapsConfig* configured for any DRB }

**ensure that** {

**when** { UE has performed random access procedure to the target cell
successfully } **then** { UE transmits an *RRCReconfigurationComplete*
message to the target gNB }

}

##### (3) {#section-147 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting DAPS handover
and having received an *RRCReconfiguration* message including a
*reconfigurationWithSync* for handover to the neighbour cell and a
dapsConfig configured for any DRB }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including a
*daps-SourceRelease* } **then** { UE releases the radio link with the
source cell }

}

##### (4) {#section-148 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting DAPS handover
and having received an RRCReconfiguration message including a
reconfigurationWithSync for handover to the neighbour cell and a
dapsConfig configured for any DRB }

**ensure that** {

**when** { UE has performed random access procedure to the target cell
successfully } **then** { UE continues the downlink user data reception
from the source gNB until releasing the source cell }

}

##### 8.1.4.3.4.1.2 Conformance requirements {#conformance-requirements-88 .H6}

Same as test case 8.1.4.3.1.

##### 8.1.4.3.4.1.3 Test description {#test-description-88 .H6}

##### 8.1.4.3.4.1.3.1 Pre-test conditions {#pre-test-conditions-88 .H6}

Same as test case 8.1.4.3.1 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

\- System information combination: NR-4 replaces NR-2.

##### 8.1.4.3.4.1.3.2 Test procedure sequence {#test-procedure-sequence-89 .H6}

Same as test case 8.1.4.3.1 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.4.3.4.1.3.3 Specific message contents {#specific-message-contents-80 .H6}

Same as test case 8.1.4.3.1 with the following difference:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

###### 8.1.4.3.4.2 DAPS handover with key change / Success / Inter-frequency / Intra-band contiguous

##### 8.1.4.3.4.2.1 Test Purpose (TP) {#test-purpose-tp-89 .H6}

Same as test case 8.1.4.3.4.1.

##### 8.1.4.3.4.2.2 Conformance requirements {#conformance-requirements-89 .H6}

Same as test case 8.1.4.3.1.

##### 8.1.4.3.4.2.3 Test description {#test-description-89 .H6}

##### 8.1.4.3.4.2.3.1 Pre-test conditions {#pre-test-conditions-89 .H6}

Same as test case 8.1.4.3.1 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

\- System information combination: NR-4 replaces NR-2.

\- Test frequency of NR Cell 1 and NR Cell 3 is configured according to
TS 38.508-1\[4\] Table 6.2.3.4-1.

##### 8.1.4.3.4.2.3.2 Test procedure sequence {#test-procedure-sequence-90 .H6}

Same as test case 8.1.4.3.1 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.4.3.4.2.3.3 Specific message contents {#specific-message-contents-81 .H6}

Same as test case 8.1.4.3.1 with the following difference:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.4.3.5 DAPS handover / HO Failure and source link available / HO Success and RLF in source / Inter-frequency 

###### 8.1.4.3.5.1 DAPS handover / HO Failure and source link available / HO Success and RLF in source / Inter-frequency / Intra-band non-contiguous

##### 8.1.4.3.5.1.1 Test Purpose (TP)

##### (1) {#section-149 .H6}

**with** { UE in NR RRC\_CONNECTED state and having received an
RRCReconfiguration message including a reconfigurationWithSync for
handover to the neighbour cell and a dapsConfig configured for a DRB }

**ensure that** {

**when** { T304 of the MCG expires and the source link has not been
released }

**then** { UE falls back to source cell configuration, resumes the
connection with source cell, and reports DAPS HO failure via the source
without triggering RRC connection re-establishment }

}

##### (2) {#section-150 .H6}

**with** { UE in NR RRC\_CONNECTED state and having received an
RRCReconfiguration message including a reconfigurationWithSync for
handover to the neighbour cell and a dapsConfig configured for a DRB }

**ensure that** {

**when** { Radio link failure is detected for the source MCG }

**then** { UE suspends all DRBs in the source, releases the source
connection and continues the handover procedure to target }

}

##### 8.1.4.3.5.1.2 Conformance requirements {#conformance-requirements-90 .H6}

Same as test case 8.1.4.3.2.

##### 8.1.4.3.5.1.3 Test description {#test-description-90 .H6}

##### 8.1.4.3.5.1.3.1 Pre-test conditions {#pre-test-conditions-90 .H6}

Same as test case 8.1.4.3.2 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

\- System information combination: NR-4 replaces NR-2.

##### 8.1.4.3.5.1.3.2 Test procedure sequence {#test-procedure-sequence-91 .H6}

Same as test case 8.1.4.3.2 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.4.3.5.1.3.3 Specific message contents {#specific-message-contents-82 .H6}

Same as test case 8.1.4.3.2 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

###### 8.1.4.3.5.2 DAPS handover / HO Failure and source link available / HO Success and RLF in source / Inter-frequency / Intra-band contiguous

##### 8.1.4.3.5.2.1 Test Purpose (TP) {#test-purpose-tp-91 .H6}

Same as test case 8.1.4.3.5.1.

##### 8.1.4.3.5.2.2 Conformance requirements {#conformance-requirements-91 .H6}

Same as test case 8.1.4.3.2.

##### 8.1.4.3.5.2.3 Test description {#test-description-91 .H6}

##### 8.1.4.3.5.2.3.1 Pre-test conditions {#pre-test-conditions-91 .H6}

Same as test case 8.1.4.3.2 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

\- System information combination: NR-4 replaces NR-2.

\- Test frequency of NR Cell 1 and NR Cell 3 is configured according to
TS 38.508-1\[4\] Table 6.2.3.4-1.

##### 8.1.4.3.5.2.3.2 Test procedure sequence {#test-procedure-sequence-92 .H6}

Same as test case 8.1.4.3.2 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.4.3.5.2.3.3 Specific message contents {#specific-message-contents-83 .H6}

Same as test case 8.1.4.3.2 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

#### 8.1.4.4 Conditional handover

##### 8.1.4.4.1 Conditional handover / Success / A3 / A5 / A3+A5

##### 8.1.4.4.1.1 Test Purpose (TP) {#test-purpose-tp-92 .H6}

##### (1) {#section-151 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and receiving an *RRCReconfiguration* message including
*ConditionalReconfiguration* }

**ensure that** {

**when** { any CHO execution condition is not satisfied } **then** { UE
maintains connection with source gNB and starts evaluating the CHO
execution conditions for the candidate cell(s) }

}

##### (2) {#section-152 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including
*ConditionalReconfiguration* and only event A3 is configured as
conditional handover trigger event } **then** { UE starts evaluating the
CHO execution condition A3 and perform conditional handover to the
neighbour cell triggered in conditional configuration execution }

}

##### (3) {#section-153 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including
*ConditionalReconfiguration* and only event A5 is configured as
conditional handover trigger event } **then** { UE starts evaluating the
CHO execution condition A5 and perform conditional handover to the
neighbour cell triggered in conditional configuration execution }

}

##### (4) {#section-154 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including
*ConditionalReconfiguration* and both event A3 and event A5 are
configured as conditional handover trigger events } **then** { UE starts
evaluating the CHO execution condition A3 and A5 and perform conditional
handover to the neighbour cell triggered in conditional configuration
execution }

}

##### (5) {#section-155 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover }

**ensure that** {

**when** { UE perform conditional handover procedure successfully }
**then** { UE releases stored CHO configurations }

}

##### 8.1.4.4.1.2 Conformance requirements {#conformance-requirements-92 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 clause 9.2.3.4.1 and 9.2.3.4.2 and TS 38.331
clause 5.3.5.1, 5.3.5.13.1, 5.3.5.13.4 and 5.3.5.13.5. Unless otherwise
stated these are Rel-16 requirements.

\[TS 38.300, clause 9.2.3.4.1\]

A Conditional Handover (CHO) is defined as a handover that is executed
by the UE when one or more handover execution conditions are met. The UE
starts evaluating the execution condition(s) upon receiving the CHO
configuration, and stops evaluating the execution condition(s) once a
handover is executed (legacy handover or conditional handover
execution).

The following principles apply to CHO:

\- The CHO configuration contains the configuration of CHO candidate
cell(s) generated by the candidate gNB(s) and execution condition(s)
generated by the source gNB.

\- An execution condition may consist of one or two trigger condition(s)
(CHO events A3/A5, as defined in \[12\]). Only single RS type is
supported and at most two different trigger quantities (e.g. RSRP and
RSRQ, RSRP and SINR, etc.) can be configured simultaneously for the
evaluation of CHO execution condition of a single candidate cell.

\- Before any CHO execution condition is satisfied, upon reception of HO
command (without CHO configuration), the UE executes the HO procedure as
described in clause 9.2.3.2, regardless of any previously received CHO
configuration.

\- While executing CHO, i.e. from the time when the UE starts
synchronization with target cell, UE does not monitor source cell.

CHO is not supported for NG-C based handover in this release of the
specification.

\[TS 38.300, clause 9.2.3.4.2\]

As in intra-NR RAN handover, in intra-NR RAN CHO, the preparation and
execution phase of the conditional handover procedure is performed
without involvement of the 5GC; i.e. preparation messages are directly
exchanged between gNBs. The release of the resources at the source gNB
during the conditional handover completion phase is triggered by the
target gNB. The figure below depicts the basic conditional handover
scenario where neither the AMF nor the UPF changes:

Figure 9.2.3.4.2-1: Intra-AMF/UPF Conditional Handover

0/1. Same as step 0, 1 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

2\. The source gNB decides to use CHO.

3\. The source gNB requests CHO for one or more candidate cells
belonging to one or more candidate gNBs. A CHO request message is sent
for each candidate cell.

4\. Same as step 4 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

5\. The candidate gNB(s) sends CHO response (HO REQUEST ACKNOWLEDGE)
including configuration of CHO candidate cell(s) to the source gNB. The
CHO response message is sent for each candidate cell.

6\. The source gNB sends an *RRCReconfiguration* message to the UE,
containing the configuration of CHO candidate cell(s) and CHO execution
condition(s).

NOTE 1: CHO configuration of candidate cells can be followed by other
reconfiguration from the source gNB.

NOTE 1a: A configuration of a CHO candidate cell cannot contain a DAPS
handover configuration.

7\. The UE sends an *RRCReconfigurationComplete* message to the source
gNB.

7a If early data forwarding is applied, the source gNB sends the EARLY
STATUS TRANSFER message.

8\. The UE maintains connection with the source gNB after receiving CHO
configuration, and starts evaluating the CHO execution conditions for
the candidate cell(s). If at least one CHO candidate cell satisfies the
corresponding CHO execution condition, the UE detaches from the source
gNB, applies the stored corresponding configuration for that selected
candidate cell, synchronises to that candidate cell and completes the
RRC handover procedure by sending *RRCReconfigurationComplete* message
to the target gNB. The UE releases stored CHO configurations after
successful completion of RRC handover procedure.

8a/b The target gNB sends the HANDOVER SUCCESS message to the source gNB
to inform that the UE has successfully accessed the target cell. In
return, the source gNB sends the SN STATUS TRANSFER message following
the principles described in step 7 of Intra-AMF/UPF Handover in clause
9.2.3.2.1.

NOTE 2: Late data forwarding may be initiated as soon as the source gNB
receives the HANDOVER SUCCESS message.

8c. The source gNB sends the HANDOVER CANCEL message toward the other
signalling connections or other candidate target gNBs, if any, to cancel
CHO for the UE.

\[TS 38.331, clause 5.3.5.1\]

Figure 5.3.5.1-1: RRC reconfiguration, successful

Figure 5.3.5.1-2: RRC reconfiguration, failure

The purpose of this procedure is to modify an RRC connection, e.g. to
establish/modify/release RBs, to perform reconfiguration with sync, to
setup/modify/release measurements, to add/modify/release SCells and cell
groups, to add/modify/release conditional handover configuration, to
add/modify/release conditional PSCell change configuration. As part of
the procedure, NAS dedicated information may be transferred from the
Network to the UE.

\[TS 38.331, clause 5.3.5.13.1\]

The network configures the UE with one or more candidate target SpCells
in the conditional reconfiguration. The UE evaluates the condition of
each configured candidate target SpCell. The UE applies the conditional
reconfiguration associated with one of the target SpCells which fulfils
associated execution condition. The network provides the configuration
parameters for the target SpCell in the *ConditionalReconfiguration* IE.

The UE performs the following actions based on a received
*ConditionalReconfiguration* IE:

1\> if the *ConditionalReconfiguration* contains the
*condReconfigToRemoveList*:

2\> perform conditional reconfiguration removal procedure as specified
in 5.3.5.13.2;

1\> if the *ConditionalReconfiguration* contains the
*condReconfigToAddModList*:

2\> perform conditional reconfiguration addition/modification as
specified in 5.3.5.13.3;

\[TS 38.331, clause 5.3.5.13.4\]

The UE shall:

1\> for each *condReconfigId* within the *VarConditionalReconfig*:

2\> consider the cell which has a physical cell identity matching the
value indicated in the *ServingCellConfigCommon* included in the
*reconfigurationWithSync* in the received *condRRCReconfig* to be
applicable cell;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig* indicated in the *condExecutionCond* associated to
*condReconfigId:*

3\> if the entry condition(s) applicable for this event associated with
the *condReconfigId*, i.e. the event corresponding with the
*condEventId(s)* of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cells for all
measurements after layer 3 filtering taken during the corresponding
*timeToTrigger* defined for this event within the
*VarConditionalReconfig*:

4\> consider the event associated to that *measId* to be fulfilled;

3\> if the leaving condition(s) applicable for this event associated
with the *condReconfigId*, i.e. the event corresponding with the
*condEventId(s)* of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cells for all
measurements after layer 3 filtering taken during the corresponding
*timeToTrigger* defined for this event within the
*VarConditionalReconfig*:

4\> consider the event associated to that *measId* to be not fulfilled;

2\> if event(s) associated to all *measId*(s) within *condTriggerConfig*
for a target candidate cell within the stored *condRRCReconfig* are
fulfilled:

3\> consider the target candidate cell within the stored
*condRRCReconfig*, associated to that *condReconfigId*, as a triggered
cell;

3\> initiate the conditional reconfiguration execution, as specified in
5.3.5.13.5;

NOTE: Up to 2 *MeasId* can be configured for each *condReconfigId.* The
conditional reconfiguration event of the 2 *MeasId* may have the same or
different event conditions, triggering quantity, time to trigger, and
triggering threshold.

\[TS 38.331, clause 5.3.5.13.5\]

The UE shall:

1\> if more than one triggered cell exists:

2\> select one of the triggered cells as the selected cell for
conditional reconfiguration execution;

1\> for the selected cell of conditional reconfiguration execution:

2\> apply the stored *condRRCReconfig* of the selected cell and perform
the actions as specified in 5.3.5.3;

NOTE: If multiple NR cells are triggered in conditional reconfiguration
execution, it is up to UE implementation which one to select, e.g. the
UE considers beams and beam quality to select one of the triggered cells
for execution.

##### 8.1.4.4.1.3 Test description {#test-description-92 .H6}

##### 8.1.4.4.1.3.1 Pre-test conditions {#pre-test-conditions-92 .H6}

##### System Simulator: {#system-simulator-59 .H6}

\- NR Cell 1, NR Cell 2 and NR Cell 4.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR cells

##### UE: {#ue-56 .H6}

\- None.

##### Preamble: {#preamble-57 .H6}

> \- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
> NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table
> 4.4A.2-3.
>
> \- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*)
> with UE test loop mode B on NR Cell 1 according to TS 38.508-1 \[4\],
> clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.4.4.1.3.2 Test procedure sequence {#test-procedure-sequence-93 .H6}

Tables 8.1.4.4.1.3.2-1 and 8.1.4.4.1.3.2-2 illustrate the downlink power
levels to be applied for NR Cells at various time instants of the test
execution. Row marked \"T0\" denotes the conditions after the preamble,
while the configuration marked \"T1\", \"T2\" and \"T3\", are applied at
the point indicated in the Main behaviour description in Table
8.1.4.4.1.3.2-3.

Table 8.1.4.4.1.3.2-1: Power levels in FR1

+----+------------+------+-----------+--------+--------+------------+
|    | Parameter  | Unit | NR Cell 1 | NR     | NR     | Remark     |
|    |            |      |           |        |        |            |
|    |            |      |           | Cell 2 | Cell 4 |            |
+====+============+======+===========+========+========+============+
| T0 | SS/PBCH    | dBm/ | -82       | -91    | -91    | Power      |
|    | SSS EPRE   |      |           |        |        | levels are |
|    |            | SCS  |           |        |        | such that  |
|    |            |      |           |        |        | UE         |
|    |            |      |           |        |        | registered |
|    |            |      |           |        |        | on NR Cell |
|    |            |      |           |        |        | 1 and      |
|    |            |      |           |        |        | entry      |
|    |            |      |           |        |        | condition  |
|    |            |      |           |        |        | for event  |
|    |            |      |           |        |        | A3 is not  |
|    |            |      |           |        |        | satisfied  |
+----+------------+------+-----------+--------+--------+------------+
| T1 | SS/PBCH    | dBm/ | -91       | -79    | -91    | Power      |
|    | SSS EPRE   |      |           |        |        | levels are |
|    |            | SCS  |           |        |        | such that  |
|    |            |      |           |        |        | entry      |
|    |            |      |           |        |        | condition  |
|    |            |      |           |        |        | for event  |
|    |            |      |           |        |        | A3 is      |
|    |            |      |           |        |        | satisfied  |
|    |            |      |           |        |        | for NR     |
|    |            |      |           |        |        | Cell 2     |
+----+------------+------+-----------+--------+--------+------------+
| T2 | SS/PBCH    | dBm/ | -91       | -91    | -79    | Power      |
|    | SSS EPRE   |      |           |        |        | levels are |
|    |            | SCS  |           |        |        | such that  |
|    |            |      |           |        |        | entry      |
|    |            |      |           |        |        | condition  |
|    |            |      |           |        |        | for event  |
|    |            |      |           |        |        | A5 is      |
|    |            |      |           |        |        | satisfied  |
|    |            |      |           |        |        | for NR     |
|    |            |      |           |        |        | Cell 4     |
+----+------------+------+-----------+--------+--------+------------+
| T3 | SS/PBCH    | dBm/ | -79       | -91    | -91    | Power      |
|    | SSS EPRE   |      |           |        |        | levels are |
|    |            | SCS  |           |        |        | such that  |
|    |            |      |           |        |        | entry      |
|    |            |      |           |        |        | condition  |
|    |            |      |           |        |        | for event  |
|    |            |      |           |        |        | A3 and     |
|    |            |      |           |        |        | event A5   |
|    |            |      |           |        |        | are        |
|    |            |      |           |        |        | satisfied  |
|    |            |      |           |        |        | for NR     |
|    |            |      |           |        |        | Cell 1     |
+----+------------+------+-----------+--------+--------+------------+

Table 8.1.4.4.1.3.2-2: Power levels in FR2

+----+------------+------+-----------+--------+--------+------------+
|    | Parameter  | Unit | NR Cell 1 | NR     | NR     | Remark     |
|    |            |      |           |        |        |            |
|    |            |      |           | Cell 2 | Cell 4 |            |
+====+============+======+===========+========+========+============+
| T0 | SS/PBCH    | dBm/ | -82       | -91    | -91    | Power      |
|    | SSS EPRE   |      |           |        |        | levels are |
|    |            | SCS  |           |        |        | such that  |
|    |            |      |           |        |        | UE         |
|    |            |      |           |        |        | registered |
|    |            |      |           |        |        | on NR Cell |
|    |            |      |           |        |        | 1 and      |
|    |            |      |           |        |        | entry      |
|    |            |      |           |        |        | condition  |
|    |            |      |           |        |        | for event  |
|    |            |      |           |        |        | A3 is not  |
|    |            |      |           |        |        | satisfied  |
+----+------------+------+-----------+--------+--------+------------+
| T1 | SS/PBCH    | dBm/ | -91       | -82    | -91    | Power      |
|    | SSS EPRE   |      |           |        |        | levels are |
|    |            | SCS  |           |        |        | such that  |
|    |            |      |           |        |        | entry      |
|    |            |      |           |        |        | condition  |
|    |            |      |           |        |        | for event  |
|    |            |      |           |        |        | A3 is      |
|    |            |      |           |        |        | satisfied  |
|    |            |      |           |        |        | for NR     |
|    |            |      |           |        |        | Cell 2     |
+----+------------+------+-----------+--------+--------+------------+
| T2 | SS/PBCH    | dBm/ | -91       | -91    | -82    | Power      |
|    | SSS EPRE   |      |           |        |        | levels are |
|    |            | SCS  |           |        |        | such that  |
|    |            |      |           |        |        | entry      |
|    |            |      |           |        |        | condition  |
|    |            |      |           |        |        | for event  |
|    |            |      |           |        |        | A5 is      |
|    |            |      |           |        |        | satisfied  |
|    |            |      |           |        |        | for NR     |
|    |            |      |           |        |        | Cell 4     |
+----+------------+------+-----------+--------+--------+------------+
| T3 | SS/PBCH    | dBm/ | -82       | -91    | -91    | Power      |
|    | SSS EPRE   |      |           |        |        | levels are |
|    |            | SCS  |           |        |        | such that  |
|    |            |      |           |        |        | entry      |
|    |            |      |           |        |        | condition  |
|    |            |      |           |        |        | for event  |
|    |            |      |           |        |        | A3 and     |
|    |            |      |           |        |        | event A5   |
|    |            |      |           |        |        | are        |
|    |            |      |           |        |        | satisfied  |
|    |            |      |           |        |        | for NR     |
|    |            |      |           |        |        | Cell 1     |
+----+------------+------+-----------+--------+--------+------------+

Table 8.1.4.4.1.3.2-3: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCReco      |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    | *including   |              |              |         |    |
|    | MeasConfig*  |              |              |         |    |
|    | and          |              |              |         |    |
|    | *Con         |              |              |         |    |
|    | ditionalReco |              |              |         |    |
|    | nfiguration* |              |              |         |    |
|    | to set NR    |              |              |         |    |
|    | Cell 2 and   |              |              |         |    |
|    | NR Cell 4 as |              |              |         |    |
|    | target       |              |              |         |    |
|    | candidate    |              |              |         |    |
|    | cells and    |              |              |         |    |
|    | configure    |              |              |         |    |
|    | event A3 as  |              |              |         |    |
|    | trigger      |              |              |         |    |
|    | event in NR  |              |              |         |    |
|    | cell 1.      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRC          |         |    |
|    | *RRC         |              | Reconfigurat |         |    |
|    | Reconfigurat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message in   |              |              |         |    |
|    | NR cell 1.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | Check: Does  | \--\>        | (PRACH       | 1       | F  |
|    | the UE       |              | Preamble)    |         |    |
|    | initiate a   |              |              |         |    |
|    | random       |              |              |         |    |
|    | access       |              |              |         |    |
|    | procedure    |              |              |         |    |
|    | transmitting |              |              |         |    |
|    | Preamble in  |              |              |         |    |
|    | NR Cell 2 or |              |              |         |    |
|    | in NR cell 4 |              |              |         |    |
|    | within 10s?  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | SS adjusts   | \-           | *-*          | \-      | \- |
|    | the          |              |              |         |    |
|    | c            |              |              |         |    |
|    | ell-specific |              |              |         |    |
|    | reference    |              |              |         |    |
|    | signal level |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T1\".  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | Check: Does  | \--\>        | (PRACH       | 2       | P  |
|    | the UE       |              | Preamble)    |         |    |
|    | initiate a   |              |              |         |    |
|    | random       |              |              |         |    |
|    | access       |              |              |         |    |
|    | procedure by |              |              |         |    |
|    | transmitting |              |              |         |    |
|    | Preamble in  |              |              |         |    |
|    | NR Cell 2    |              |              |         |    |
|    | within 10s?  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | The SS       | \<\--        | Random       | \-      | \- |
|    | transmits    |              | Access       |         |    |
|    | Random       |              | Response     |         |    |
|    | Access       |              |              |         |    |
|    | Response.    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits    |              | RRC          |         |    |
|    | *RRC         |              | Reconfigurat |         |    |
|    | Reconfigurat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message in   |              |              |         |    |
|    | NR Cell 2.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8  | Check: Does  | \-           | *-*          | 2       | \- |
|    | the test     |              |              |         |    |
|    | result of    |              |              |         |    |
|    | generic test |              |              |         |    |
|    | procedure in |              |              |         |    |
|    | TS 38.508-1  |              |              |         |    |
|    | \[4\] Table  |              |              |         |    |
|    | 4.9.1-1      |              |              |         |    |
|    | indicate     |              |              |         |    |
|    | that the UE  |              |              |         |    |
|    | is capable   |              |              |         |    |
|    | of           |              |              |         |    |
|    | exchanging   |              |              |         |    |
|    | IP data on   |              |              |         |    |
|    | DRB1 and NR  |              |              |         |    |
|    | Cell 2?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCReco      |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    | *including   |              |              |         |    |
|    | MeasConfig*  |              |              |         |    |
|    | and          |              |              |         |    |
|    | *Con         |              |              |         |    |
|    | ditionalReco |              |              |         |    |
|    | nfiguration* |              |              |         |    |
|    | to set NR    |              |              |         |    |
|    | Cell 1 and   |              |              |         |    |
|    | NR Cell 4 as |              |              |         |    |
|    | target       |              |              |         |    |
|    | candidate    |              |              |         |    |
|    | cells and    |              |              |         |    |
|    | configure    |              |              |         |    |
|    | event A5 as  |              |              |         |    |
|    | trigger      |              |              |         |    |
|    | event in NR  |              |              |         |    |
|    | cell 2.      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 10 | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRC          |         |    |
|    | *RRC         |              | Reconfigurat |         |    |
|    | Reconfigurat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message in   |              |              |         |    |
|    | NR cell 2.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 11 | SS adjusts   | \-           | *-*          | \-      | \- |
|    | the          |              |              |         |    |
|    | c            |              |              |         |    |
|    | ell-specific |              |              |         |    |
|    | reference    |              |              |         |    |
|    | signal level |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T2\".  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 12 | Check: Does  | \--\>        | (PRACH       | 3       | P  |
|    | the UE       |              | Preamble)    |         |    |
|    | initiate a   |              |              |         |    |
|    | random       |              |              |         |    |
|    | access       |              |              |         |    |
|    | procedure by |              |              |         |    |
|    | transmitting |              |              |         |    |
|    | Preamble in  |              |              |         |    |
|    | NR Cell 4    |              |              |         |    |
|    | within 10s?  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 13 | The SS       | \<\--        | Random       | \-      | \- |
|    | transmits    |              | Access       |         |    |
|    | Random       |              | Response     |         |    |
|    | Access       |              |              |         |    |
|    | Response.    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 14 | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits    |              | RRC          |         |    |
|    | *RRC         |              | Reconfigurat |         |    |
|    | Reconfigurat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message in   |              |              |         |    |
|    | NR Cell 4.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 15 | Check: Does  | \-           | *-*          | 3       | \- |
|    | the test     |              |              |         |    |
|    | result of    |              |              |         |    |
|    | generic test |              |              |         |    |
|    | procedure in |              |              |         |    |
|    | TS 38.508-1  |              |              |         |    |
|    | \[4\] Table  |              |              |         |    |
|    | 4.9.1-1      |              |              |         |    |
|    | indicate     |              |              |         |    |
|    | that the UE  |              |              |         |    |
|    | is capable   |              |              |         |    |
|    | of           |              |              |         |    |
|    | exchanging   |              |              |         |    |
|    | IP data on   |              |              |         |    |
|    | DRB1 and NR  |              |              |         |    |
|    | Cell 4?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 16 | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCReco      |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    | *including   |              |              |         |    |
|    | MeasConfig*  |              |              |         |    |
|    | and          |              |              |         |    |
|    | *Con         |              |              |         |    |
|    | ditionalReco |              |              |         |    |
|    | nfiguration* |              |              |         |    |
|    | for intra    |              |              |         |    |
|    |              |              |              |         |    |
|    | -frequency   |              |              |         |    |
|    | event A3 and |              |              |         |    |
|    | A5 in NR     |              |              |         |    |
|    | cell 4.      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 17 | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRC          |         |    |
|    | *RRC         |              | Reconfigurat |         |    |
|    | Reconfigurat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message in   |              |              |         |    |
|    | NR cell 4.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 18 | SS adjusts   | \-           | *-*          | \-      | \- |
|    | the          |              |              |         |    |
|    | c            |              |              |         |    |
|    | ell-specific |              |              |         |    |
|    | reference    |              |              |         |    |
|    | signal level |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T3\".  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 19 | Check: Does  | \--\>        | (PRACH       | 4       | P  |
|    | the UE       |              | Preamble)    |         |    |
|    | initiate a   |              |              |         |    |
|    | random       |              |              |         |    |
|    | access       |              |              |         |    |
|    | procedure by |              |              |         |    |
|    | transmitting |              |              |         |    |
|    | Preamble in  |              |              |         |    |
|    | NR Cell 1    |              |              |         |    |
|    | within 10s?  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 20 | The SS       | \<\--        | Random       | \-      | \- |
|    | transmits    |              | Access       |         |    |
|    | Random       |              | Response     |         |    |
|    | Access       |              |              |         |    |
|    | Response.    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 21 | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|    | transmits    |              | RRC          |         |    |
|    | *RRC         |              | Reconfigurat |         |    |
|    | Reconfigurat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message in   |              |              |         |    |
|    | NR Cell 1.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 22 | Check: Does  | \-           | *-*          | 4       | \- |
|    | the test     |              |              |         |    |
|    | result of    |              |              |         |    |
|    | generic test |              |              |         |    |
|    | procedure in |              |              |         |    |
|    | TS 38.508-1  |              |              |         |    |
|    | \[4\] Table  |              |              |         |    |
|    | 4.9.1-1      |              |              |         |    |
|    | indicate     |              |              |         |    |
|    | that the UE  |              |              |         |    |
|    | is capable   |              |              |         |    |
|    | of           |              |              |         |    |
|    | exchanging   |              |              |         |    |
|    | IP data on   |              |              |         |    |
|    | DRB1 and NR  |              |              |         |    |
|    | Cell 1?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 23 | SS adjusts   | \-           | *-*          | \-      | \- |
|    | the          |              |              |         |    |
|    | c            |              |              |         |    |
|    | ell-specific |              |              |         |    |
|    | reference    |              |              |         |    |
|    | signal level |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T1\".  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 24 | Check: Does  | \--\>        | (PRACH       | 5       | F  |
|    | the UE       |              | Preamble)    |         |    |
|    | initiate a   |              |              |         |    |
|    | random       |              |              |         |    |
|    | access       |              |              |         |    |
|    | procedure by |              |              |         |    |
|    | transmitting |              |              |         |    |
|    | Preamble in  |              |              |         |    |
|    | NR Cell 2    |              |              |         |    |
|    | within 10s?  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.4.4.1.3.3 Specific message contents {#specific-message-contents-84 .H6}

Table 8.1.4.4.1.3.3-1: *RRCReconfiguration* (Step 1, step 9 and step 16,
Table 8.1.4.4.1.3.2-3)

  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                        
  Information Element                                                                  Value/remark                 Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                             
  measConfig                                                                           MeasConfig                   Table 8.1.4.4.1.3.3-2   
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.4.4.1.3.3-6   
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------

Table 8.1.4.4.1.3.3-2: *MeasConfig* (Table 8.1.4.4.1.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- ----------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                 
  Information Element                                                                        Value/remark                   Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                         
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                 
  measObjectId                                                                               1                                                      
  measObject CHOICE {                                                                                                                               
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.4.4.1.3.3-3   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   2 entries                                              
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  reportConfigId                                                                             1                                                      
  reportConfig CHOICE {                                                                                                                             
  reportConfigNR                                                                             *ReportConfigNR-condEventA3*   Table 8.1.4.4.1.3.3-4   
  }                                                                                                                                                 
  }                                                                                                                                                 
  ReportConfigToAddMod\[2\] SEQUENCE {                                                                                      entry 2                 
  reportConfigId                                                                             2                                                      
  reportConfig CHOICE {                                                                                                                             
  reportConfigNR                                                                             ReportConfigNR-condEventA5     Table 8.1.4.4.1.3.3-5   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                Step 1, Step 9
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                 
  measId                                                                                     1                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             1                                                      Step 1
                                                                                             2                                                      Step 9
  }                                                                                                                                                 
  }                                                                                                                                                 
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  2 entries                                              Step 16
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                 
  measId                                                                                     1                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             1                                                      
  }                                                                                                                                                 
  MeasIdToAddMod\[2\] SEQUENCE {                                                                                            entry 2                 
  measId                                                                                     2                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             2                                                      
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- ----------------

Table 8.1.4.4.1.3.3-3: *MeasObjectNR* (Table 8.1.4.4.1.3.3-2)

  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-76                                                                                                                                                                 
  Information Element                                 Value/remark                         Comment                                                                                                                  Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                                                                                                       
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 1   The SSB of NR cell 1, NR Cell 2 and NR cell 4 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                     Not present                                                                                                                                                   
  nrofSS-BlocksToAverage                              Not present                                                                                                                                                   
  }                                                                                                                                                                                                                 
  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------------------ -----------

Table 8.1.4.4.1.3.3-4: *ReportConfigNR-condEventA3* (Table
8.1.4.4.1.3.3-2)

  ------------------------------------------------------------------------------------- -------------- ----------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition CHO AND EVENT\_A3                                    
  Information Element                                                                   Value/remark   Comment           Condition
  ReportConfigNR ::= SEQUENCE {                                                                                          
  reportType CHOICE {                                                                                                    
  condTriggerConfig-r16 SEQUENCE {                                                                                       
  condEventId CHOICE {                                                                                                   
  condEventA3 SEQUENCE {                                                                                                 
  a3-Offset CHOICE {                                                                                                     
  rsrp                                                                                  2              1 dB(2\*0.5 dB)   
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  ------------------------------------------------------------------------------------- -------------- ----------------- -----------

Table 8.1.4.4.1.3.3-5: *ReportConfigNR-condEventA5* (Table
8.1.4.4.1.3.3-2)

  ------------------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition CHO AND EVENT\_A5                            
  Information Element                                                                   Value/remark   Comment   Condition
  ReportConfigNR ::= SEQUENCE {                                                                                  
  reportType CHOICE {                                                                                            
  condTriggerConfig-r16 SEQUENCE {                                                                               
  condEventId CHOICE {                                                                                           
  condEventA5 SEQUENCE {                                                                                         
  a5-Threshold1 CHOICE {                                                                                         
  rsrp                                                                                  76             -80dBm    FR1
                                                                                        73             -83dBm    FR2
  }                                                                                                              
  a5-Threshold2 CHOICE {                                                                                         
  rsrp                                                                                  70             -86dBm    FR1
                                                                                        66             -90dBm    FR2
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  ------------------------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.4.4.1.3.3-6: *ConditionalReconfiguration* (Table
8.1.4.4.1.3.3-1)

  ---------------------------------------------------- -------------------------------------------------- ------------------------ ----------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                                               
  Information Element                                  Value/remark                                       Comment                  Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                                                    
  condReconfigToRemoveList-r16                         Not present                                                                 
  condReconfigToAddModList-r16                         CondReconfigToAddModList-r16 (Step 1 and step 9)   Table 8.1.4.4.1.3.3-7    Step 1, Step 9
                                                       CondReconfigToAddModList-r16 (Step 16)             Table 8.1.4.4.1.3.3-10   Step 16
  }                                                                                                                                
  ---------------------------------------------------- -------------------------------------------------- ------------------------ ----------------

Table 8.1.4.4.1.3.3-7: *CondReconfigToAddModList-r16* (Step 1 and step
9, Table 8.1.4.4.1.3.3-6)

  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                       
  Information Element                                                                                         Value/remark                                         Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   2 entries                                                                    
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                         entry 1                 
  condReconfigId-r16                                                                                          1                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR cell 2   Table 8.1.4.4.1.3.3-8   Step 1
                                                                                                              RRCReconfiguration-HO with condition HO\_NR cell 1   Table 8.1.4.4.1.3.3-8   Step 9
  }                                                                                                                                                                                        
  CondReconfigToAddMod-r16\[2\] SEQUENCE {                                                                                                                         entry 2                 
  condReconfigId-r16                                                                                          2                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR cell 4   Table 8.1.4.4.1.3.3-8   
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------

Table 8.1.4.4.1.3.3-8: RRCReconfiguration-HO (Tables 8.1.4.4.1.3.3-7 and
8.1.4.4.1.3.3-10)

  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                           
  Information Element                                                                    Value/remark                                    Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                                  
  nonCriticalExtension SEQUENCE{                                                                                                                                 
  masterCellGroup                                                                        CellGroupConfig with condition PCI\_NR cell 1   Table 8.1.4.4.1.3.3-9   HO\_NR cell 1
                                                                                         CellGroupConfig with condition PCI\_NR cell 2   Table 8.1.4.4.1.3.3-9   HO\_NR cell 2
                                                                                         CellGroupConfig with condition PCI\_NR cell 4   Table 8.1.4.4.1.3.3-9   HO\_NR cell 4
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------

Table 8.1.4.4.1.3.3-9: *CellGroupConfig* (Table 8.1.4.4.1.3.3-8)

  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 1             PCI\_NR cell 1
                                                                                             Physical Cell Identity of NR Cell 2             PCI\_NR Cell 2
                                                                                             Physical Cell Identity of NR Cell 4             PCI\_NR Cell 4
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------

Table 8.1.4.4.1.3.3-10: *CondReconfigToAddModList-r16* (Step 16, Table
8.1.4.4.1.3.3-6)

  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                       
  Information Element                                                                                         Value/remark                                         Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   2 entries                                                                    
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                         entry 1                 
  condReconfigId-r16                                                                                          1                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  MeasId \[2\]                                                                                                2                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR cell 1   Table 8.1.4.4.1.3.3-8   
  }                                                                                                                                                                                        
  CondReconfigToAddMod-r16\[2\] SEQUENCE {                                                                                                                         entry 2                 
  condReconfigId-r16                                                                                          2                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR cell 2   Table 8.1.4.4.1.3.3-8   
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------

##### 8.1.4.4.2 Conditional handover / modify conditional handover configuration

##### 8.1.4.4.2.1 Test Purpose (TP) {#test-purpose-tp-93 .H6}

##### (1) {#section-156 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and receiving an RRCReconfiguration message including a
ConditionalReconfiguration }

**ensure that** {

**when** { UE received another RRCReconfiguration message with adding a
new entry in the CondReconfigToAddModList before any CHO execution
condition is satisfied } **then** { UE add the new entry within the
*VarConditionalReconfig* and apply the latest conditional handover
configurations }

}

##### (2) {#section-157 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and receiving an RRCReconfiguration message including a
ConditionalReconfiguration }

**ensure that** {

**when** { UE received another RRCReconfiguration message with modifying
an existing entry in the CondReconfigToAddModList before any CHO
execution condition is satisfied } **then** { UE replace the existing
entry with the value received and apply the latest conditional handover
configurations }

}

##### (3) {#section-158 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and receiving an RRCReconfiguration message including a
ConditionalReconfiguration }

**ensure that** {

**when** { UE received another RRCReconfiguration message with
condConfigToRemoveList before any CHO execution condition is satisfied }
**then** { UE removes the entry with the matching condConfigId included
in the condConfigToRemoveList and apply the latest conditional handover
configurations }

}

##### 8.1.4.4.2.2 Conformance requirements {#conformance-requirements-93 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 clause 9.2.3.4.1 and 9.2.3.4.2 and TS 38.331
clause 5.3.5.1, 5.3.5.13.2 and 5.3.5.13.3. Unless otherwise stated these
are Rel-16 requirements.

\[TS 38.300, clause 9.2.3.4.1\]

A Conditional Handover (CHO) is defined as a handover that is executed
by the UE when one or more handover execution conditions are met. The UE
starts evaluating the execution condition(s) upon receiving the CHO
configuration, and stops evaluating the execution condition(s) once a
handover is executed (legacy handover or conditional handover
execution).

The following principles apply to CHO:

\- The CHO configuration contains the configuration of CHO candidate
cell(s) generated by the candidate gNB(s) and execution condition(s)
generated by the source gNB.

\- An execution condition may consist of one or two trigger condition(s)
(CHO events A3/A5, as defined in \[12\]). Only single RS type is
supported and at most two different trigger quantities (e.g. RSRP and
RSRQ, RSRP and SINR, etc.) can be configured simultaneously for the
evaluation of CHO execution condition of a single candidate cell.

\- Before any CHO execution condition is satisfied, upon reception of HO
command (without CHO configuration), the UE executes the HO procedure as
described in clause 9.2.3.2, regardless of any previously received CHO
configuration.

\- While executing CHO, i.e. from the time when the UE starts
synchronization with target cell, UE does not monitor source cell.

CHO is not supported for NG-C based handover in this release of the
specification.

\[TS 38.300, clause 9.2.3.4.2\]

As in intra-NR RAN handover, in intra-NR RAN CHO, the preparation and
execution phase of the conditional handover procedure is performed
without involvement of the 5GC; i.e. preparation messages are directly
exchanged between gNBs. The release of the resources at the source gNB
during the conditional handover completion phase is triggered by the
target gNB. The figure below depicts the basic conditional handover
scenario where neither the AMF nor the UPF changes:

Figure 9.2.3.4.2-1: Intra-AMF/UPF Conditional Handover

0/1. Same as step 0, 1 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

2\. The source gNB decides to use CHO.

3\. The source gNB requests CHO for one or more candidate cells
belonging to one or more candidate gNBs. A CHO request message is sent
for each candidate cell.

4\. Same as step 4 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

5\. The candidate gNB(s) sends CHO response (HO REQUEST ACKNOWLEDGE)
including configuration of CHO candidate cell(s) to the source gNB. The
CHO response message is sent for each candidate cell.

6\. The source gNB sends an *RRCReconfiguration* message to the UE,
containing the configuration of CHO candidate cell(s) and CHO execution
condition(s).

NOTE 1: CHO configuration of candidate cells can be followed by other
reconfiguration from the source gNB.

NOTE 1a: A configuration of a CHO candidate cell cannot contain a DAPS
handover configuration.

7\. The UE sends an *RRCReconfigurationComplete* message to the source
gNB.

7a If early data forwarding is applied, the source gNB sends the EARLY
STATUS TRANSFER message.

8\. The UE maintains connection with the source gNB after receiving CHO
configuration, and starts evaluating the CHO execution conditions for
the candidate cell(s). If at least one CHO candidate cell satisfies the
corresponding CHO execution condition, the UE detaches from the source
gNB, applies the stored corresponding configuration for that selected
candidate cell, synchronises to that candidate cell and completes the
RRC handover procedure by sending *RRCReconfigurationComplete* message
to the target gNB. The UE releases stored CHO configurations after
successful completion of RRC handover procedure.

8a/b The target gNB sends the HANDOVER SUCCESS message to the source gNB
to inform that the UE has successfully accessed the target cell. In
return, the source gNB sends the SN STATUS TRANSFER message following
the principles described in step 7 of Intra-AMF/UPF Handover in clause
9.2.3.2.1.

NOTE 2: Late data forwarding may be initiated as soon as the source gNB
receives the HANDOVER SUCCESS message.

8c. The source gNB sends the HANDOVER CANCEL message toward the other
signalling connections or other candidate target gNBs, if any, to cancel
CHO for the UE.

\[TS 38.331, clause 5.3.5.1\]

Figure 5.3.5.1-1: RRC reconfiguration, successful

Figure 5.3.5.1-2: RRC reconfiguration, failure

The purpose of this procedure is to modify an RRC connection, e.g. to
establish/modify/release RBs, to perform reconfiguration with sync, to
setup/modify/release measurements, to add/modify/release SCells and cell
groups, to add/modify/release conditional handover configuration, to
add/modify/release conditional PSCell change configuration. As part of
the procedure, NAS dedicated information may be transferred from the
Network to the UE.

\[TS 38.331, clause 5.3.5.13.2\]

The UE shall:

1\> for each *condReconfigId* value included in the
*condReconfigToRemoveList* that is part of the current UE conditional
reconfiguration in *VarConditionalReconfig*:

2\> remove the entry with the matching *condReconfigId* from the
*VarConditionalReconfig*;

NOTE: The UE does not consider the message as erroneous if the
*condReconfigToRemoveList* includes any cond*ReconfigId* value that is
not part of the current UE configuration.

\[TS 38.331, clause 5.3.5.13.3\]

For each *condReconfigId* received in the *condReconfigToAddModList* IE
the UE shall:

1\> if an entry with the matching *condReconfigId* exists in the
*condReconfigToAddModList* within the *VarConditionalReconfig*:

2\> if the entry in *condReconfigToAddModList* includes an
*condExecutionCond*;

3\> replace the entry with the value received for this *condReconfigId*;

2\> if the entry in *condReconfigToAddModList* includes an
*condRRCReconfig*;

2\> replace the entry with the value received for this *condReconfigId*;

1\> else:

2\> add a new entry for this *condReconfigId* within the
*VarConditionalReconfig*;

1\> perform conditional reconfiguration evaluation as specified in
5.3.5.13.4;

##### 8.1.4.4.2.3 Test description {#test-description-93 .H6}

##### 8.1.4.4.2.3.1 Pre-test conditions {#pre-test-conditions-93 .H6}

##### System Simulator: {#system-simulator-60 .H6}

\- NR Cell 1, NR Cell 2 and NR Cell 4.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR cells.

##### UE: {#ue-57 .H6}

\- None.

##### Preamble: {#preamble-58 .H6}

> \- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
> NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table
> 4.4A.2-3.
>
> \- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*)
> with UE test loop mode B on NR Cell 1 according to TS 38.508-1 \[4\],
> clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.4.4.2.3.2 Test procedure sequence {#test-procedure-sequence-94 .H6}

Tables 8.1.4.4.2.3.2-1 and 8.1.4.4.2.3.2-2 illustrate the downlink power
levels to be applied for NR cells at various time instants of the test
execution. Row marked \"T0\" denotes the conditions after the preamble,
while the configuration marked \"T1\", \"T2\", \"T3\" and \"T4\", are
applied at the point indicated in the Main behaviour description in
Table 8.1.4.4.2.3.2-3.

Table 8.1.4.4.2.3.2-1: Power levels in FR1

+----+----------+------+----------+----------+----------+----------+
|    | P        | Unit | NR Cell  | NR Cell  | NR Cell  | Remark   |
|    | arameter |      | 1        | 2        | 4        |          |
+====+==========+======+==========+==========+==========+==========+
| T0 | SS/PBCH  | dBm/ | -82      | -91      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that UE  |
|    |          |      |          |          |          | re       |
|    |          |      |          |          |          | gistered |
|    |          |      |          |          |          | on NR    |
|    |          |      |          |          |          | Cell 1   |
|    |          |      |          |          |          | and      |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is not   |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
+----+----------+------+----------+----------+----------+----------+
| T1 | SS/PBCH  | dBm/ | -91      | -79      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 2   |
+----+----------+------+----------+----------+----------+----------+
| T2 | SS/PBCH  | dBm/ | -91      | -91      | -79      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 4   |
+----+----------+------+----------+----------+----------+----------+
| T3 | SS/PBCH  | dBm/ | -91      | -85      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | leaving  |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 4   |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
+----+----------+------+----------+----------+----------+----------+
| T4 | SS/PBCH  | dBm/ | -85      | -91      | -79      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 1   |
|    |          |      |          |          |          | and NR   |
|    |          |      |          |          |          | Cell 4   |
+----+----------+------+----------+----------+----------+----------+

Table 8.1.4.4.2.3.2-2: Power levels in FR2

+----+----------+------+----------+----------+----------+----------+
|    | P        | Unit | NR Cell  | NR Cell  | NR Cell  | Remark   |
|    | arameter |      | 1        | 2        | 4        |          |
+====+==========+======+==========+==========+==========+==========+
| T0 | SS/PBCH  | dBm/ | -82      | -91      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that UE  |
|    |          |      |          |          |          | re       |
|    |          |      |          |          |          | gistered |
|    |          |      |          |          |          | on NR    |
|    |          |      |          |          |          | Cell 1   |
|    |          |      |          |          |          | and      |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is not   |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
+----+----------+------+----------+----------+----------+----------+
| T1 | SS/PBCH  | dBm/ | -91      | -82      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 2   |
+----+----------+------+----------+----------+----------+----------+
| T2 | SS/PBCH  | dBm/ | -91      | -91      | -82      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 4   |
+----+----------+------+----------+----------+----------+----------+
| T3 | SS/PBCH  | dBm/ | -91      | -82      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | leaving  |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 4   |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
+----+----------+------+----------+----------+----------+----------+
| T4 | SS/PBCH  | dBm/ | -91      | -100     | -82      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 1   |
|    |          |      |          |          |          | and NR   |
|    |          |      |          |          |          | Cell 4   |
+----+----------+------+----------+----------+----------+----------+

Table 8.1.4.4.2.3.2-3: Main behaviour

  St    Procedure                                                                                                                                                                        Message Sequence   TP                                     Verdict   
  ----- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                         U - S              Message                                          
  1     The SS transmits an *RRCReconfiguration* message *including MeasConfig* and *ConditionalReconfiguration* to set NR Cell 4 as a target candidate cell.                            \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2     The UE transmits an *RRCReconfigurationComplete* message in NR Cell 1.                                                                                                           \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3     The SS transmits an *RRCReconfiguration* message *including ConditionalReconfiguration* to add NR Cell 2 as another target candidate cell.                                       \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  4     The UE transmits an *RRCReconfigurationComplete* message in NR Cell 1.                                                                                                           \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  5     SS adjusts the cell-specific reference signal level according to row \"T1\".                                                                                                     \-                 *-*                                    \-        \-
  6     Check: Does the UE initiate a random access procedure by transmitting Preamble in NR Cell 2 within 10s?                                                                          \--\>              *(PRACH Preamble)*                     1         P
  7     The SS transmits Random Access Response.                                                                                                                                         \<\--              *Random Access Response*               \-        \-
  8     The UE transmits *RRCReconfigurationComplete* message in NR Cell 2.                                                                                                              \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  9     Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on DRB1 and NR Cell 2?            \-                 *-*                                    1         \-
  10    The SS transmits an *RRCReconfiguration* message *including MeasConfig* and *ConditionalReconfiguration* to set NR Cell 1 and NR Cell 4 as target candidate cells.               \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  11    The UE transmits an *RRCReconfigurationComplete* message in NR Cell 2.                                                                                                           \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  12    The SS transmits an *RRCReconfiguration* message *including ConditionalReconfiguration* with *condConfigToRemoveList* to remove NR Cell 4 from the target candidate cell list.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  13    The UE transmits an *RRCReconfigurationComplete* message in NR Cell 2.                                                                                                           \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  14    SS adjusts the cell-specific reference signal level according to row \"T2\".                                                                                                     \-                 *-*                                    \-        \-
  15    Check: Does the UE initiate a random access procedure by transmitting Preamble in NR Cell 4 within 10s?                                                                          \--\>              *(PRACH Preamble)*                     3         F
  15A   SS adjusts the cell-specific reference signal level according to row \"T3\".                                                                                                     \-                 \-                                     \-        \-
  16    The SS transmits an *RRCReconfiguration* message *including ConditionalReconfiguration* to replace NR Cell 1 with NR Cell 4 as the target candidate cell.                        \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  16A   The UE transmits *RRCReconfigurationComplete* message in NR Cell 2.                                                                                                              \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  17    SS adjusts the cell-specific reference signal level according to row \"T4\".                                                                                                     \-                 *-*                                    \-        \-
  18    Check: Does the UE initiate a random access procedure by transmitting Preamble in NR Cell 4 within 10s?                                                                          \--\>              (PRACH Preamble)                       3         P
  19    The SS transmits Random Access Response.                                                                                                                                         \<\--              Random Access Response                 \-        \-
  20    The UE transmits *RRCReconfigurationComplete* message in NR Cell 4.                                                                                                              \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  21    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on DRB1 and NR Cell 4?            \-                 *-*                                    2         \-

##### 8.1.4.4.2.3.3 Specific message contents {#specific-message-contents-85 .H6}

Table 8.1.4.4.2.3.3-1: *RRCReconfiguration* (Step 1, step 3, step 10,
step 12 and step 16, Table 8.1.4.4.2.3.2-3)

  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- --------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                        
  Information Element                                                                  Value/remark                 Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                             
  measConfig                                                                           Not present                                          Step 3, Step 12, Step 16
                                                                                       MeasConfig                   Table 8.1.4.4.2.3.3-2   Step 1, Step 10
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.4.4.2.3.3-5   
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- --------------------------

Table 8.1.4.4.2.3.3-2: *MeasConfig* (Table 8.1.4.4.2.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                 
  Information Element                                                                        Value/remark                   Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                         
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                 
  measObjectId                                                                               1                                                      
  measObject CHOICE {                                                                                                                               
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.4.4.2.3.3-3   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  reportConfigId                                                                             1                                                      
  reportConfig CHOICE {                                                                                                                             
  reportConfigNR                                                                             *ReportConfigNR-condEventA3*   Table 8.1.4.4.2.3.3-4   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                 
  measId                                                                                     1                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             1                                                      
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------

Table 8.1.4.4.2.3.3-3: *MeasObjectNR* (Table 8.1.4.4.2.3.3-2)

  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-76                                                                                                                                                                 
  Information Element                                 Value/remark                         Comment                                                                                                                  Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                                                                                                       
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 1   The SSB of NR Cell 1, NR Cell 2 and NR Cell 4 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                     Not present                                                                                                                                                   
  nrofSS-BlocksToAverage                              Not present                                                                                                                                                   
  }                                                                                                                                                                                                                 
  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------------------ -----------

Table 8.1.4.4.2.3.3-4: *ReportConfigNR-condEventA3* (Table
8.1.4.4.2.3.3-2)

  ------------------------------------------------------------------------------------- -------------- ----------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition CHO AND EVENT\_A3                                    
  Information Element                                                                   Value/remark   Comment           Condition
  ReportConfigNR ::= SEQUENCE {                                                                                          
  reportType CHOICE {                                                                                                    
  condTriggerConfig-r16 SEQUENCE {                                                                                       
  condEventId CHOICE {                                                                                                   
  condEventA3 SEQUENCE {                                                                                                 
  a3-Offset CHOICE {                                                                                                     
  rsrp                                                                                  2              1 dB(2\*0.5 dB)   
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  ------------------------------------------------------------------------------------- -------------- ----------------- -----------

Table 8.1.4.4.2.3.3-5: *ConditionalReconfiguration* (Table
8.1.4.4.2.3.3-1)

  ------------------------------------------------------------------------------------------------- --------------------------------------------------- ------------------------ -----------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                                                                                             
  Information Element                                                                               Value/remark                                        Comment                  Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                                                                                                  
  condReconfigToRemoveList-r16                                                                      Not present                                                                  
  condReconfigToRemoveList-r16 SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigId-r16 {   1 entry                                                                      Step 12
  CondReconfigId-r16\[1\]                                                                           2                                                   entry 1                  
  }                                                                                                                                                                              
  condReconfigToAddModList-r16                                                                      CondReconfigToAddModList-r16 (Step 1 and step 16)   Table 8.1.4.4.2.3.3-6    Step 1, Step 16
                                                                                                    CondReconfigToAddModList-r16 (Step 3)               Table 8.1.4.4.2.3.3-9    Step 3
                                                                                                    CondReconfigToAddModList-r16 (Step 10)              Table 8.1.4.4.2.3.3-10   Step 10
  }                                                                                                                                                                              
  ------------------------------------------------------------------------------------------------- --------------------------------------------------- ------------------------ -----------------

Table 8.1.4.4.2.3.3-6: *CondReconfigToAddModList-r16* (Step 1 and step
16, Table 8.1.4.4.2.3.3-6)

  ----------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ----------------------- -----------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                                                
  Information Element                                                                                         Value/remark                                                                  Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   1 entry                                                                                               
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                                                  entry 1                 
  condReconfigId-r16                                                                                          1                                                                                                     
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                                                  
  MeasId \[1\]                                                                                                1                                                                                                     
  }                                                                                                                                                                                                                 
  condRRCReconfig-r16                                                                                         OCTETSTRING (Containing RRCReconfiguration-HO with condition HO\_NR Cell 4)   Table 8.1.4.4.2.3.3-7   Step 1, Step 16
  }                                                                                                                                                                                                                 
  }                                                                                                                                                                                                                 
  ----------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ----------------------- -----------------

Table 8.1.4.4.2.3.3-7: RRCReconfiguration-HO (Tables 8.1.4.4.2.3.3-6,
8.1.4.4.2.3.3-9 and 8.1.4.4.2.3.3-10)

  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                           
  Information Element                                                                    Value/remark                                    Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                                  
  nonCriticalExtension SEQUENCE{                                                                                                                                 
  masterCellGroup                                                                        CellGroupConfig with condition PCI\_NR Cell 1   Table 8.1.4.4.2.3.3-8   HO\_NR Cell 1
                                                                                         CellGroupConfig with condition PCI\_NR Cell 2   Table 8.1.4.4.2.3.3-8   HO\_NR Cell 2
                                                                                         CellGroupConfig with condition PCI\_NR Cell 4   Table 8.1.4.4.2.3.3-8   HO\_NR Cell 4
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------

Table 8.1.4.4.2.3.3-8: *CellGroupConfig* (Table 8.1.4.4.2.3.3-7)

  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 1             PCI\_NR Cell 1
                                                                                             Physical Cell Identity of NR Cell 2             PCI\_NR Cell 2
                                                                                             Physical Cell Identity of NR Cell 4             PCI\_NR Cell 4
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------

Table 8.1.4.4.2.3.3-9: *CondReconfigToAddModList-r16* (Step 3, Table
8.1.4.4.2.3.3-6)

  ----------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                                                
  Information Element                                                                                         Value/remark                                                                  Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   1 entry                                                                                               
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                                                  entry 1                 
  condReconfigId-r16                                                                                          2                                                                                                     
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                                                  
  MeasId \[1\]                                                                                                1                                                                                                     
  }                                                                                                                                                                                                                 
  condRRCReconfig-r16                                                                                         OCTETSTRING (Containing RRCReconfiguration-HO with condition HO\_NR Cell 2)   Table 8.1.4.4.2.3.3-7   
  }                                                                                                                                                                                                                 
  }                                                                                                                                                                                                                 
  ----------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ----------------------- -----------

Table 8.1.4.4.2.3.3-10: *CondReconfigToAddModList-r16* (Step 10, Table
8.1.4.4.2.3.3-6)

  ----------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                                                
  Information Element                                                                                         Value/remark                                                                  Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   2 entries                                                                                             
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                                                  entry 1                 
  condReconfigId-r16                                                                                          1                                                                                                     
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                                                  
  MeasId \[1\]                                                                                                1                                                                                                     
  }                                                                                                                                                                                                                 
  condRRCReconfig-r16                                                                                         OCTETSTRING (Containing RRCReconfiguration-HO with condition HO\_NR Cell 1)   Table 8.1.4.4.2.3.3-8   
  }                                                                                                                                                                                                                 
  CondReconfigToAddMod-r16\[2\] SEQUENCE {                                                                                                                                                  entry 2                 
  condReconfigId-r16                                                                                          2                                                                                                     
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                                                  
  MeasId \[1\]                                                                                                1                                                                                                     
  }                                                                                                                                                                                                                 
  condRRCReconfig-r16                                                                                         OCTETSTRING (Containing RRCReconfiguration-HO with condition HO\_NR Cell 4)   Table 8.1.4.4.2.3.3-8   
  }                                                                                                                                                                                                                 
  }                                                                                                                                                                                                                 
  ----------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ----------------------- -----------

##### 8.1.4.4.3 Conditional handover / Failure

##### 8.1.4.4.3.1 Test Purpose (TP) {#test-purpose-tp-94 .H6}

##### (1) {#section-159 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and receiving a RRCReconfiguration message including
ConditionalReconfiguration }

**ensure that** {

**when** { UE detects conditional handover failure and finds a
selectable cell which is the candidate cell included in
ConditionalReconfiguration before T311 expires } **then** { UE applies
the stored condRRCReconfig associated to the selected cell and perform
conditional handover to the selected cell }

}

##### (2) {#section-160 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and receiving a RRCReconfiguration message including
ConditionalReconfiguration }

**ensure that** {

**when** { UE detects conditional handover failure and cannot find any
selectable cell before T311 expires } **then** { UE goes to RRC\_IDLE
and release the stored conditional handover configurations }

}

##### 8.1.4.4.3.2 Conformance requirements {#conformance-requirements-94 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 clause 9.2.3.1, 9.2.3.4.1, and 9.2.3.4.2 and TS
38.331 clause 5.3.7.3, 5.3.7.6 and 5.3.11. Unless otherwise stated these
are Rel-16 requirements.

\[TS 38.300, clause 9.2.3.1\]

Timer based handover failure procedure is supported in NR. RRC
connection re-establishment procedure is used for recovering from
handover failure except in certain CHO or DAPS handover scenarios:

\- When DAPS handover fails, the UE falls back to the source cell
configuration, resumes the connection with the source cell, and reports
DAPS handover failure via the source without triggering RRC connection
re-establishment if the source link has not been released.

\- When initial CHO execution attempt fails or HO fails, the UE performs
cell selection, and if the selected cell is a CHO candidate and if
network configured the UE to try CHO after handover/CHO failure, then
the UE attempts CHO execution once, otherwise re-establishment is
performed.

\[TS 38.300, clause 9.2.3.4.1\]

A Conditional Handover (CHO) is defined as a handover that is executed
by the UE when one or more handover execution conditions are met. The UE
starts evaluating the execution condition(s) upon receiving the CHO
configuration, and stops evaluating the execution condition(s) once a
handover is executed (legacy handover or conditional handover
execution).

The following principles apply to CHO:

\- The CHO configuration contains the configuration of CHO candidate
cell(s) generated by the candidate gNB(s) and execution condition(s)
generated by the source gNB.

\- An execution condition may consist of one or two trigger condition(s)
(CHO events A3/A5, as defined in \[12\]). Only single RS type is
supported and at most two different trigger quantities (e.g. RSRP and
RSRQ, RSRP and SINR, etc.) can be configured simultaneously for the
evaluation of CHO execution condition of a single candidate cell.

\- Before any CHO execution condition is satisfied, upon reception of HO
command (without CHO configuration), the UE executes the HO procedure as
described in clause 9.2.3.2, regardless of any previously received CHO
configuration.

\- While executing CHO, i.e. from the time when the UE starts
synchronization with target cell, UE does not monitor source cell.

CHO is not supported for NG-C based handover in this release of the
specification.

\[TS 38.300, clause 9.2.3.4.2\]

As in intra-NR RAN handover, in intra-NR RAN CHO, the preparation and
execution phase of the conditional handover procedure is performed
without involvement of the 5GC; i.e. preparation messages are directly
exchanged between gNBs. The release of the resources at the source gNB
during the conditional handover completion phase is triggered by the
target gNB. The figure below depicts the basic conditional handover
scenario where neither the AMF nor the UPF changes:

Figure 9.2.3.4.2-1: Intra-AMF/UPF Conditional Handover

0/1. Same as step 0, 1 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

2\. The source gNB decides to use CHO.

3\. The source gNB requests CHO for one or more candidate cells
belonging to one or more candidate gNBs. A CHO request message is sent
for each candidate cell.

4\. Same as step 4 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

5\. The candidate gNB(s) sends CHO response (HO REQUEST ACKNOWLEDGE)
including configuration of CHO candidate cell(s) to the source gNB. The
CHO response message is sent for each candidate cell.

6\. The source gNB sends an *RRCReconfiguration* message to the UE,
containing the configuration of CHO candidate cell(s) and CHO execution
condition(s).

NOTE 1: CHO configuration of candidate cells can be followed by other
reconfiguration from the source gNB.

NOTE 1a: A configuration of a CHO candidate cell cannot contain a DAPS
handover configuration.

7\. The UE sends an *RRCReconfigurationComplete* message to the source
gNB.

7a If early data forwarding is applied, the source gNB sends the EARLY
STATUS TRANSFER message.

8\. The UE maintains connection with the source gNB after receiving CHO
configuration, and starts evaluating the CHO execution conditions for
the candidate cell(s). If at least one CHO candidate cell satisfies the
corresponding CHO execution condition, the UE detaches from the source
gNB, applies the stored corresponding configuration for that selected
candidate cell, synchronises to that candidate cell and completes the
RRC handover procedure by sending *RRCReconfigurationComplete* message
to the target gNB. The UE releases stored CHO configurations after
successful completion of RRC handover procedure.

8a/b The target gNB sends the HANDOVER SUCCESS message to the source gNB
to inform that the UE has successfully accessed the target cell. In
return, the source gNB sends the SN STATUS TRANSFER message following
the principles described in step 7 of Intra-AMF/UPF Handover in clause
9.2.3.2.1.

NOTE 2: Late data forwarding may be initiated as soon as the source gNB
receives the HANDOVER SUCCESS message.

8c. The source gNB sends the HANDOVER CANCEL message toward the other
signalling connections or other candidate target gNBs, if any, to cancel
CHO for the UE.

\[TS 38.331, clause 5.3.7.3\]

Upon selecting a suitable NR cell, the UE shall:

1\> ensure having valid and up to date essential system information as
specified in clause 5.2.2.2;

1\> stop timer T311;

...

1\> if *attemptCondReconfig* is configured; and

1\> if the selected cell is one of the candidate cells for which the
*reconfigurationWithSync* is included in the *masterCellGroup* in
*VarConditionalReconfig*:

2\> apply the stored *condRRCReconfig* associated to the selected cell
and perform actions as specified in 5.3.5.3;

1\> else:

2\> if UE is configured with *conditionalReconfiguration*:

3\> reset MAC;

3\> release *spCellConfig*, if configured;

3\> release the MCG SCell(s), if configured;

3\> release *delayBudgetReportingConfig*, if configured and stop timer
T342, if running;

3\> release *overheatingAssistanceConfig* , if configured and stop timer
T345, if running;

3\> if MR-DC is configured:

4\> perform MR-DC release, as specified in clause 5.3.5.10;

3\> release *idc-AssistanceConfig*, if configured;

3\> release *btNameList*, if configured;

3\> release *wlanNameList*, if configured;

3\> release *sensorNameList*, if configured;

3\> release *drx-PreferenceConfig* for the MCG, if configured and stop
timer T346a associated with the MCG, if running;

3\> release *maxBW-PreferenceConfig* for the MCG, if configured and stop
timer T346b associated with the MCG, if running;

3\> release *maxCC-PreferenceConfig* for the MCG, if configured and stop
timer T346c associated with the MCG, if running;

3\> release *maxMIMO-LayerPreferenceConfig* for the MCG, if configured
and stop timer T346d associated with the MCG, if running;

3\> release *minSchedulingOffsetPreferenceConfig* for the MCG, if
configured and stop timer T346e associated with the MCG, if running;

3\> release *releasePreferenceConfig*, if configured and stop timer
T346f, if running;

3\> release *onDemandSIB-Request* if configured, and stop timer T350, if
running;

3\> suspend all RBs, except SRB0;

2\> remove all the entries within *VarConditionalReconfig*, if any;

2\> for each *measId*, if the associated *reportConfig* has a
*reportType* set to *condTriggerConfig*:

3\> for the associated *reportConfigId*:

4\> remove the entry with the matching *reportConfigId* from the
*reportConfigList* within the *VarMeasConfig*;

3\> if the associated *measObjectId* is only associated to a
*reportConfig* with *reportType* set to *condTriggerConfig*:

4\> remove the entry with the matching *measObjectId* from the
*measObjectList* within the *VarMeasConfig*;

3\> remove the entry with the matching *measId* from the *measIdList*
within the *VarMeasConfig*;

2\> start timer T301;

2\> apply the default L1 parameter values as specified in corresponding
physical layer specifications except for the parameters for which values
are provided in *SIB1*;

2\> apply the default MAC Cell Group configuration as specified in
9.2.2;

2\> apply the CCCH configuration as specified in 9.1.1.2;

2\> apply the *timeAlignmentTimerCommon* included in *SIB1*;

2\> initiate transmission of the *RRCReestablishmentRequest* message in
accordance with 5.3.7.4;

NOTE: This procedure applies also if the UE returns to the source PCell.

Upon selecting an inter-RAT cell, the UE shall:

1\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\'.

\[TS 38.331, clause 5.3.7.6\]

Upon T311 expiry, the UE shall:

1\> if the procedure was initiated due to radio link failure or handover
failure:

2\> set the *noSuitableCellFound* in the *VarRLF-Report* to *true*;

1\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\'.

\[TS 38.331, clause 5.3.11\]

The UE shall:

1\> reset MAC;

...

1\> remove all the entries within *VarConditionalReconfig*, if any;

1\> for each *measId*, if the associated *reportConfig* has a
*reportType* set to *condTriggerConfig*:

2\> for the associated *reportConfigId*:

3\> remove the entry with the matching *reportConfigId* from the
*reportConfigList* within the *VarMeasConfig*;

2\> if the associated *measObjectId* is only associated to a
*reportConfig* with *reportType* set to *condTriggerConfig*:

3\> remove the entry with the matching *measObjectId* from the
*measObjectList* within the *VarMeasConfig*;

2\> remove the entry with the matching *measId* from the *measIdList*
within the *VarMeasConfig*;

1\> discard the K~gNB~ key, the S-K~gNB~ key, the S-K~eNB~ key, the
K~RRCenc~ key, the K~RRCint~ key, the K~UPint~ key and the K~UPenc~ key,
if any;

1\> release all radio resources, including release of the RLC entity,
the BAP entity, the MAC configuration and the associated PDCP entity and
SDAP for all established RBs;

1\> indicate the release of the RRC connection to upper layers together
with the release cause;

1\> except if going to RRC\_IDLE was triggered by inter-RAT cell
reselection while the UE is in RRC\_INACTIVE or RRC\_IDLE or when
selecting an inter-RAT cell while T311 was running or when selecting an
E-UTRA cell for EPS fallback for IMS voice as specified in 5.4.3.5:

2\> enter RRC\_IDLE and perform cell selection as specified in TS 38.304
\[20\];

##### 8.1.4.4.3.3 Test description {#test-description-94 .H6}

##### 8.1.4.4.3.3.1 Pre-test conditions {#pre-test-conditions-94 .H6}

##### System Simulator: {#system-simulator-61 .H6}

\- NR Cell 1, NR Cell 2 and NR Cell 4.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR cells.

##### UE: {#ue-58 .H6}

\- None.

##### Preamble: {#preamble-59 .H6}

> \- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
> NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table
> 4.4A.2-3.
>
> \- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*)
> with UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\],
> clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.4.4.3.3.2 Test procedure sequence {#test-procedure-sequence-95 .H6}

Tables 8.1.4.4.3.3.2-1 and 8.1.4.4.3.3.2-2 illustrate the downlink power
levels to be applied for NR cells at various time instants of the test
execution. Row marked \"T0\" denotes the conditions after the preamble,
while the configuration marked \"T1\", \"T2\", \"T3\", \"T4\" and
\"T5\", are applied at the point indicated in the Main behaviour
description in Table 8.1.4.4.3.3.2-3.

Table 8.1.4.4.3.3.2-1: Power levels in FR1

+----+----------+------+----------+----------+----------+----------+
|    | P        | Unit | NR Cell  | NR Cell  | NR Cell  | Remark   |
|    | arameter |      | 1        | 2        | 4        |          |
+====+==========+======+==========+==========+==========+==========+
| T0 | SS/PBCH  | dBm/ | -85      | -113     | -113     | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that UE  |
|    |          |      |          |          |          | re       |
|    |          |      |          |          |          | gistered |
|    |          |      |          |          |          | on NR    |
|    |          |      |          |          |          | Cell 1   |
+----+----------+------+----------+----------+----------+----------+
| T1 | SS/PBCH  | dBm/ | -91      | -79      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 2   |
+----+----------+------+----------+----------+----------+----------+
| T2 | SS/PBCH  | dBm/ | -113     | -113     | -79      | The      |
|    | SSS EPRE |      |          |          |          | power    |
|    |          | SCS  |          |          |          | level is |
|    |          |      |          |          |          | such     |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | only     |
|    |          |      |          |          |          | Srx      |
|    |          |      |          |          |          | lev~NR\  |
|    |          |      |          |          |          | Cell\ 4~ |
|    |          |      |          |          |          | \> 0     |
+----+----------+------+----------+----------+----------+----------+
| T3 | SS/PBCH  | dBm/ | -79      | -91      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 1   |
+----+----------+------+----------+----------+----------+----------+
| T4 | SS/PBCH  | dBm/ | -113     | -113     | -113     | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that all |
|    |          |      |          |          |          | Srxlev   |
|    |          |      |          |          |          | ~NR~     |
|    |          |      |          |          |          | ~Cell~   |
|    |          |      |          |          |          | \< 0     |
+----+----------+------+----------+----------+----------+----------+
| T5 | SS/PBCH  | dBm/ | -113     | -79      | -113     | The      |
|    | SSS EPRE |      |          |          |          | power    |
|    |          | SCS  |          |          |          | level is |
|    |          |      |          |          |          | such     |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | only     |
|    |          |      |          |          |          | Srx      |
|    |          |      |          |          |          | lev~NR\  |
|    |          |      |          |          |          | Cell\ 2~ |
|    |          |      |          |          |          | \> 0     |
+----+----------+------+----------+----------+----------+----------+

Table 8.1.4.4.3.3.2-2: Power levels in FR2

+----+----------+------+----------+----------+----------+----------+
|    | P        | Unit | NR Cell  | NR Cell  | NR Cell  | Remark   |
|    | arameter |      | 1        | 2        | 4        |          |
+====+==========+======+==========+==========+==========+==========+
| T0 | SS/PBCH  | dBm/ | -82      | "Off"    | "Off"    | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that UE  |
|    |          |      |          |          |          | re       |
|    |          |      |          |          |          | gistered |
|    |          |      |          |          |          | on NR    |
|    |          |      |          |          |          | Cell 1   |
+----+----------+------+----------+----------+----------+----------+
| T1 | SS/PBCH  | dBm/ | -91      | -82      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 2   |
+----+----------+------+----------+----------+----------+----------+
| T2 | SS/PBCH  | dBm/ | "Off"    | "Off"    | -82      | The      |
|    | SSS EPRE |      |          |          |          | power    |
|    |          | SCS  |          |          |          | level is |
|    |          |      |          |          |          | such     |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | only     |
|    |          |      |          |          |          | Srx      |
|    |          |      |          |          |          | lev~NR\  |
|    |          |      |          |          |          | Cell\ 4~ |
|    |          |      |          |          |          | \> 0     |
+----+----------+------+----------+----------+----------+----------+
| T3 | SS/PBCH  | dBm/ | -82      | -91      | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 1   |
+----+----------+------+----------+----------+----------+----------+
| T4 | SS/PBCH  | dBm/ | "Off"    | "Off"    | "Off"    | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that all |
|    |          |      |          |          |          | Srxlev   |
|    |          |      |          |          |          | ~NR~     |
|    |          |      |          |          |          | ~Cell~   |
|    |          |      |          |          |          | \< 0     |
+----+----------+------+----------+----------+----------+----------+
| T5 | SS/PBCH  | dBm/ | "Off"    | -82      | "Off"    | The      |
|    | SSS EPRE |      |          |          |          | power    |
|    |          | SCS  |          |          |          | level is |
|    |          |      |          |          |          | such     |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | only     |
|    |          |      |          |          |          | Srx      |
|    |          |      |          |          |          | lev~NR\  |
|    |          |      |          |          |          | Cell\ 2~ |
|    |          |      |          |          |          | \> 0     |
+----+----------+------+----------+----------+----------+----------+

Table 8.1.4.4.3.3.2-3: Main behaviour

  St                                                                                                              Procedure                                                                                                                                                                Message Sequence   TP                                     Verdict   
  --------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                                                                                           U - S              Message                                          
  1                                                                                                               The SS transmits an *RRCReconfiguration* message *including MeasConfig* and *ConditionalReconfiguration* to set NR Cell 2 and NR Cell 4 as the target candidate cells.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2                                                                                                               The UE transmits an *RRCReconfigurationComplete* message in NR Cell 1.                                                                                                   \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3                                                                                                               SS adjusts the cell-specific reference signal level according to row \"T1\".                                                                                             \-                 *-*                                    \-        \-
  \-                                                                                                              EXCEPTION: The steps 4 and 5 below are repeated for the duration of T304.                                                                                                \-                 *-*                                    \-        \-
  4                                                                                                               The UE attempts to perform the intra frequency handover using MAC Random Access Preamble on NR Cell 2.                                                                   \-                 *-*                                    \-        \-
  5                                                                                                               The SS does not respond.                                                                                                                                                 \-                 *-*                                    \-        \-
  6                                                                                                               SS adjusts the cell-specific reference signal level according to row \"T2\" right before T304 expire.                                                                    \-                 *-*                                    \-        \-
  7                                                                                                               Check: Does the UE initiate a random access procedure by transmitting Preamble in NR Cell 4 within 10s?                                                                  \--\>              *(PRACH Preamble)*                     1         P
  8                                                                                                               The SS transmits Random Access Response.                                                                                                                                 \<\--              *Random Access Response*               \-        \-
  9                                                                                                               The UE transmits RRCReconfigurationComplete message in NR Cell 4.                                                                                                        \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  10                                                                                                              Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on DRB1 and NR Cell 4?    \-                 *-*                                    1         \-
  11                                                                                                              The SS transmits an *RRCReconfiguration* message *including MeasConfig* and *ConditionalReconfiguration* to set NR Cell 1 and NR Cell 2 as the target candidate cells.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  12                                                                                                              The UE transmits an *RRCReconfigurationComplete* message in NR Cell 4.                                                                                                   \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  13                                                                                                              SS adjusts the cell-specific reference signal level according to row \"T3\".                                                                                             \-                 *-*                                    \-        \-
  \-                                                                                                              EXCEPTION: The steps 14 and 15 below are repeated for the duration of T304.                                                                                              \-                 *-*                                    \-        \-
  14                                                                                                              The UE attempts to perform the intra frequency handover using MAC Random Access Preamble on NR Cell 1.                                                                   \-                 *-*                                    \-        \-
  15                                                                                                              The SS does not respond.                                                                                                                                                 \-                 *-*                                    \-        \-
  16                                                                                                              SS adjusts the cell-specific reference signal level according to row \"T4\".                                                                                             \-                 *-*                                    \-        \-
  17                                                                                                              Wait 5s to ensure that T304 and T311 expire. (Note 1)                                                                                                                    \-                 *-*                                    \-        \-
  18                                                                                                              SS adjusts the cell-specific reference signal level according to row \"T5\".                                                                                             \-                 *-*                                    \-        \-
  19                                                                                                              Check: Is the generic mobility registration updating procedure described in TS 38.508-1 \[4\] Table 4.9.5.2.2-1 performed on NR Cell 2?                                  \-                 *-*                                    2         \-
  Note 1: The wait time is selected to cover T304 (2000ms) + T311 (1000ms) to ensure that UE goes to RRC\_IDLE.                                                                                                                                                                                                                                                

##### 8.1.4.4.3.3.3 Specific message contents {#specific-message-contents-86 .H6}

Table 8.1.4.4.3.3.3-1: *SIB1* for NR Cell 2 (preamble and all steps,
Table 8.1.4.4.3.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                                                   
  --------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                         Value/remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                                                  
  cellAccessRelatedInfo SEQUENCE {                                                                     
  plmn-IdentityInfoList SEQUENCE (SIZE (1..maxPLMN)) OF PLMN-IdentityInfo {                            
  PLMN-IdentityInfo\[1\] SEQUENCE {                                                                    
  trackingAreaCode                                                            2                        
  }                                                                                                    
  }                                                                                                    
  }                                                                                                    
  }                                                                                                    

Table 8.1.4.4.3.3.3-2: *RRCReconfiguration* (Step 1 and step 11, Table
8.1.4.4.3.3.2-3)

  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                        
  Information Element                                                                  Value/remark                 Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                             
  measConfig                                                                           MeasConfig                   Table 8.1.4.4.3.3.3-3   
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.4.4.3.3.3-6   
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------

Table 8.1.4.4.3.3.3-3: *MeasConfig* (Table 8.1.4.4.3.3.3-2)

  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                 
  Information Element                                                                        Value/remark                   Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                         
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                 
  measObjectId                                                                               1                                                      
  measObject CHOICE {                                                                                                                               
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.4.4.3.3.3-4   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  reportConfigId                                                                             1                                                      
  reportConfig CHOICE {                                                                                                                             
  reportConfigNR                                                                             *ReportConfigNR-condEventA3*   Table 8.1.4.4.3.3.3-5   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                 
  measId                                                                                     1                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             1                                                      
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------

Table 8.1.4.4.3.3.3-4: *MeasObjectNR* (Table 8.1.4.4.3.3.3-3)

  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-76                                                                                                                                                                 
  Information Element                                 Value/remark                         Comment                                                                                                                  Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                                                                                                       
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 1   The SSB of NR Cell 1, NR Cell 2 and NR Cell 4 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                     Not present                                                                                                                                                   
  nrofSS-BlocksToAverage                              Not present                                                                                                                                                   
  }                                                                                                                                                                                                                 
  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------------------ -----------

Table 8.1.4.4.3.3.3-5: *ReportConfigNR-condEventA3* (Table
8.1.4.4.3.3.3-3)

  ------------------------------------------------------------------------------------- -------------- ------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition CHO AND EVENT\_A3                                     
  Information Element                                                                   Value/remark   Comment            Condition
  ReportConfigNR ::= SEQUENCE {                                                                                           
  reportType CHOICE {                                                                                                     
  condTriggerConfig-r16 SEQUENCE {                                                                                        
  condEventId CHOICE {                                                                                                    
  condEventA3 SEQUENCE {                                                                                                  
  a3-Offset CHOICE {                                                                                                      
  rsrp                                                                                  2              1 dB (2\*0.5 dB)   
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  ------------------------------------------------------------------------------------- -------------- ------------------ -----------

Table 8.1.4.4.3.3.3-6: *ConditionalReconfiguration* (Table
8.1.4.4.3.3.3-2)

  ---------------------------------------------------- ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                          
  Information Element                                  Value/remark                   Comment                 Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                               
  condReconfigToAddModList-r16                         CondReconfigToAddModList-r16   Table 8.1.4.4.3.3.3-7   
  }                                                                                                           
  ---------------------------------------------------- ------------------------------ ----------------------- -----------

Table 8.1.4.4.3.3.3-7: *CondReconfigToAddModList-r16* (Table
8.1.4.4.3.3.3-6)

  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                       
  Information Element                                                                                         Value/remark                                         Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   2 entries                                                                    
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                         entry 1                 
  condReconfigId-r16                                                                                          1                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR Cell 2   Table 8.1.4.4.3.3.3-8   Step 1
                                                                                                              RRCReconfiguration-HO with condition HO\_NR Cell 1   Table 8.1.4.4.3.3.3-8   Step 11
  }                                                                                                                                                                                        
  CondReconfigToAddMod-r16\[2\] SEQUENCE {                                                                                                                         entry 2                 
  condReconfigId-r16                                                                                          2                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR Cell 4   Table 8.1.4.4.3.3.3-8   Step 1
                                                                                                              RRCReconfiguration-HO with condition HO\_NR Cell 2   Table 8.1.4.4.3.3.3-8   Step 11
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------

Table 8.1.4.4.3.3.3-8: RRCReconfiguration-HO (Table 8.1.4.4.3.3.3-7)

  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                           
  Information Element                                                                    Value/remark                                    Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                                  
  nonCriticalExtension SEQUENCE{                                                                                                                                 
  masterCellGroup                                                                        CellGroupConfig with condition PCI\_NR Cell 1   Table 8.1.4.4.3.3.3-9   HO\_NR Cell 1
                                                                                         CellGroupConfig with condition PCI\_NR Cell 2   Table 8.1.4.4.3.3.3-9   HO\_NR Cell 2
                                                                                         CellGroupConfig with condition PCI\_NR Cell 4   Table 8.1.4.4.3.3.3-9   HO\_NR Cell 4
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------

Table 8.1.4.4.3.3.3-9: *CellGroupConfig* (Table 8.1.4.4.3.3.3-8)

  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 1             PCI\_NR Cell 1
                                                                                             Physical Cell Identity of NR Cell 2             PCI\_NR Cell 2
                                                                                             Physical Cell Identity of NR Cell 4             PCI\_NR Cell 4
  }                                                                                                                                          
  t304                                                                                       ms2000                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------

##### 8.1.4.4.4 Conditional handover / legacy Handover / legacy Handover Failure

##### 8.1.4.4.4.1 Test Purpose (TP) {#test-purpose-tp-95 .H6}

##### (1) {#section-161 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and having received an RRCReconfiguration message including a
ConditionalReconfiguration }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including a
reconfigurationWithSync for legacy handover to a neighbour cell }
**then** { UE performs handover procedure }

}

##### (2) {#section-162 .H6}

**with** { UE having stored ConditionalReconfiguration and having
received another RRCReconfiguration message including a
reconfigurationWithSync for legacy handover to a neighbour cell }

**ensure that** {

**when** { UE detects handover failure and find a selectable cell which
is the candidate cell included in ConditionalReconfiguration before T311
expires } **then** { UE applies the stored condRRCReconfig associated to
the selected cell and performs conditional handover to the selected cell
}

}

##### (3) {#section-163 .H6}

**with** { UE having stored ConditionalReconfiguration and having
received another RRCReconfiguration message including a
reconfigurationWithSync for handover to a neighbour cell }

**ensure that** {

**when** { UE detects handover failure and can not find any selectable
cell before T311 expires } **then** { UE goes to RRC\_IDLE and releases
the stored conditional handover configurations }

}

##### 8.1.4.4.4.2 Conformance requirements {#conformance-requirements-95 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 clause 9.2.3.4.1 and 9.2.3.1 and TS 38.331
clause 5.3.7.3 and 5.3.11. Unless otherwise stated these are Rel-16
requirements.

\[TS 38.300, clause 9.2.3.4.1\]

A Conditional Handover (CHO) is defined as a handover that is executed
by the UE when one or more handover execution conditions are met. The UE
starts evaluating the execution condition(s) upon receiving the CHO
configuration, and stops evaluating the execution condition(s) once a
handover is executed (legacy handover or conditional handover
execution).

The following principles apply to CHO:

\- The CHO configuration contains the configuration of CHO candidate
cell(s) generated by the candidate gNB(s) and execution condition(s)
generated by the source gNB.

\- An execution condition may consist of one or two trigger condition(s)
(CHO events A3/A5, as defined in \[12\]). Only single RS type is
supported and at most two different trigger quantities (e.g. RSRP and
RSRQ, RSRP and SINR, etc.) can be configured simultaneously for the
evaluation of CHO execution condition of a single candidate cell.

\- Before any CHO execution condition is satisfied, upon reception of HO
command (without CHO configuration), the UE executes the HO procedure as
described in clause 9.2.3.2, regardless of any previously received CHO
configuration.

\- While executing CHO, i.e. from the time when the UE starts
synchronization with target cell, UE does not monitor source cell.

CHO is not supported for NG-C based handover in this release of the
specification.

\[TS 38.300, clause 9.2.3.1\]

Network controlled mobility applies to UEs in RRC\_CONNECTED and is
categorized into two types of mobility: cell level mobility and beam
level mobility.

**Cell Level Mobility** requires explicit RRC signalling to be
triggered, i.e. handover. For inter-gNB handover, the signalling
procedures consist of at least the following elemental components
illustrated in Figure 9.2.3.1-1:

Figure 9.2.3.1-1: Inter-gNB handover procedures

1\. The source gNB initiates handover and issues a HANDOVER REQUEST over
the Xn interface.

2\. The target gNB performs admission control and provides the new RRC
configuration as part of the HANDOVER REQUEST ACKNOWLEDGE.

3\. The source gNB provides the RRC configuration to the UE by
forwarding the *RRCReconfiguration* message received in the HANDOVER
REQUEST ACKNOWLEDGE. The *RRCReconfiguration* message includes at least
cell ID and all information required to access the target cell so that
the UE can access the target cell without reading system information.
For some cases, the information required for contention-based and
contention-free random access can be included in the
*RRCReconfiguration* message. The access information to the target cell
may include beam specific information, if any.

4\. The UE moves the RRC connection to the target gNB and replies with
the *RRCReconfigurationComplete*.

NOTE 1: User Data can also be sent in step 4 if the grant allows.

...

NOTE 2: Void.

NOTE 3: Void.

RRC managed handovers with and without PDCP entity re-establishment are
both supported. For DRBs using RLC AM mode, PDCP can either be
re-established together with a security key change or initiate a data
recovery procedure without a key change. For DRBs using RLC UM mode,
PDCP can either be re-established together with a security key change or
remain as it is without a key change. For SRBs, PDCP can either remain
as it is, discard its stored PDCP PDUs/SDUs without a key change or be
re-established together with a security key change.

Data forwarding, in-sequence delivery and duplication avoidance at
handover can be guaranteed when the target gNB uses the same DRB
configuration as the source gNB.

Timer based handover failure procedure is supported in NR. RRC
connection re-establishment procedure is used for recovering from
handover failure except in certain CHO or DAPS handover scenarios:

\- When DAPS handover fails, the UE falls back to the source cell
configuration, resumes the connection with the source cell, and reports
DAPS handover failure via the source without triggering RRC connection
re-establishment if the source link has not been released.

\- When initial CHO execution attempt fails or HO fails, the UE performs
cell selection, and if the selected cell is a CHO candidate and if
network configured the UE to try CHO after handover/CHO failure, then
the UE attempts CHO execution once, otherwise re-establishment is
performed.

DAPS handover for FR2 to FR2 case is not supported in this release of
the specification.

The handover of the IAB-MT in SA mode follows the same procedure as
described for the UE. After the backhaul has been established, the
handover of the IAB-MT is part of the intra-CU topology adaptation
procedure defined in TS 38.401 \[4\]. Modifications to the configuration
of BAP sublayer and higher protocol layers above the BAP sublayer are
described in TS 38.401 \[4\].

**Beam Level Mobility** does not require explicit RRC signalling to be
triggered. The gNB provides via RRC signalling the UE with measurement
configuration containing configurations of SSB/CSI resources and
resource sets, reports and trigger states for triggering channel and
interference measurements and reports. Beam Level Mobility is then dealt
with at lower layers by means of physical layer and MAC layer control
signalling, and RRC is not required to know which beam is being used at
a given point in time.

SSB-based Beam Level Mobility is based on the SSB associated to the
initial DL BWP and can only be configured for the initial DL BWPs and
for DL BWPs containing the SSB associated to the initial DL BWP.
For other DL BWPs, Beam Level Mobility can only be performed based on
CSI-RS.

\[TS 38.331, clause 5.3.7.3\]

Upon selecting a suitable NR cell, the UE shall:

1\> ensure having valid and up to date essential system information as
specified in clause 5.2.2.2;

1\> stop timer T311;

...

1\> if *attemptCondReconfig* is configured; and

1\> if the selected cell is one of the candidate cells for which the
*reconfigurationWithSync* is included in the *masterCellGroup* in
*VarConditionalReconfig*:

2\> apply the stored *condRRCReconfig* associated to the selected cell
and perform actions as specified in 5.3.5.3;

1\> else:

2\> if UE is configured with *conditionalReconfiguration*:

3\> reset MAC;

3\> release *spCellConfig*, if configured;

3\> release the MCG SCell(s), if configured;

3\> release *delayBudgetReportingConfig*, if configured and stop timer
T342, if running;

3\> release *overheatingAssistanceConfig* , if configured and stop timer
T345, if running;

3\> if MR-DC is configured:

4\> perform MR-DC release, as specified in clause 5.3.5.10;

3\> release *idc-AssistanceConfig*, if configured;

3\> release *btNameList*, if configured;

3\> release *wlanNameList*, if configured;

3\> release *sensorNameList*, if configured;

3\> release *drx-PreferenceConfig* for the MCG, if configured and stop
timer T346a associated with the MCG, if running;

3\> release *maxBW-PreferenceConfig* for the MCG, if configured and stop
timer T346b associated with the MCG, if running;

3\> release *maxCC-PreferenceConfig* for the MCG, if configured and stop
timer T346c associated with the MCG, if running;

3\> release *maxMIMO-LayerPreferenceConfig* for the MCG, if configured
and stop timer T346d associated with the MCG, if running;

3\> release *minSchedulingOffsetPreferenceConfig* for the MCG, if
configured and stop timer T346e associated with the MCG, if running;

3\> release *releasePreferenceConfig*, if configured and stop timer
T346f, if running;

3\> release *onDemandSIB-Request* if configured, and stop timer T350, if
running;

3\> suspend all RBs, except SRB0;

2\> remove all the entries within *VarConditionalReconfig*, if any;

2\> for each *measId*, if the associated *reportConfig* has a
*reportType* set to *condTriggerConfig*:

3\> for the associated *reportConfigId*:

4\> remove the entry with the matching *reportConfigId* from the
*reportConfigList* within the *VarMeasConfig*;

3\> if the associated *measObjectId* is only associated to a
*reportConfig* with *reportType* set to *condTriggerConfig*:

4\> remove the entry with the matching *measObjectId* from the
*measObjectList* within the *VarMeasConfig*;

3\> remove the entry with the matching *measId* from the *measIdList*
within the *VarMeasConfig*;

2\> start timer T301;

2\> apply the default L1 parameter values as specified in corresponding
physical layer specifications except for the parameters for which values
are provided in *SIB1*;

2\> apply the default MAC Cell Group configuration as specified in
9.2.2;

2\> apply the CCCH configuration as specified in 9.1.1.2;

2\> apply the *timeAlignmentTimerCommon* included in *SIB1*;

2\> initiate transmission of the *RRCReestablishmentRequest* message in
accordance with 5.3.7.4;

NOTE: This procedure applies also if the UE returns to the source PCell.

Upon selecting an inter-RAT cell, the UE shall:

1\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\'.

\[TS 38.331, clause 5.3.11\]

The UE shall:

1\> reset MAC;

...

1\> remove all the entries within *VarConditionalReconfig*, if any;

1\> for each *measId*, if the associated *reportConfig* has a
*reportType* set to *condTriggerConfig*:

2\> for the associated *reportConfigId*:

3\> remove the entry with the matching *reportConfigId* from the
*reportConfigList* within the *VarMeasConfig*;

2\> if the associated *measObjectId* is only associated to a
*reportConfig* with *reportType* set to *condTriggerConfig*:

3\> remove the entry with the matching *measObjectId* from the
*measObjectList* within the *VarMeasConfig*;

2\> remove the entry with the matching *measId* from the *measIdList*
within the *VarMeasConfig*;

1\> discard the K~gNB~ key, the S-K~gNB~ key, the S-K~eNB~ key, the
K~RRCenc~ key, the K~RRCint~ key, the K~UPint~ key and the K~UPenc~ key,
if any;

1\> release all radio resources, including release of the RLC entity,
the BAP entity, the MAC configuration and the associated PDCP entity and
SDAP for all established RBs;

1\> indicate the release of the RRC connection to upper layers together
with the release cause;

1\> except if going to RRC\_IDLE was triggered by inter-RAT cell
reselection while the UE is in RRC\_INACTIVE or RRC\_IDLE or when
selecting an inter-RAT cell while T311 was running or when selecting an
E-UTRA cell for EPS fallback for IMS voice as specified in 5.4.3.5:

2\> enter RRC\_IDLE and perform cell selection as specified in TS 38.304
\[20\];

##### 8.1.4.4.4.3 Test description {#test-description-95 .H6}

##### 8.1.4.4.4.3.1 Pre-test conditions {#pre-test-conditions-95 .H6}

##### System Simulator: {#system-simulator-62 .H6}

\- NR Cell 1, NR Cell 2 and NR Cell 4.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR cells.

##### UE: {#ue-59 .H6}

\- None.

##### Preamble: {#preamble-60 .H6}

> \- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
> NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table
> 4.4A.2-3.
>
> \- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*)
> with UE test loop mode B on NR Cell 1 according to TS 38.508-1 \[4\],
> clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.4.4.4.3.2 Test procedure sequence {#test-procedure-sequence-96 .H6}

Tables 8.1.4.4.4.3.2-1 and 8.1.4.4.4.3.2-2 illustrate the downlink power
levels to be applied for NR cells at various time instants of the test
execution. Row marked \"T0\" denotes the conditions after the preamble,
while the configuration marked \"T1\", \"T2\", \"T3\" and \"T4\" are
applied at the point indicated in the Main behaviour description in
Table 8.1.4.4.4.3.2-3.

Table 8.1.4.4.4.3.2-1: Power levels in FR1

+----+----------+------+----------+----------+----------+----------+
|    | P        | Unit | NR Cell  | NR Cell  | NR Cell  | Remark   |
|    | arameter |      | 1        | 2        | 4        |          |
+====+==========+======+==========+==========+==========+==========+
| T0 | SS/PBCH  | dBm/ | -79      | -113     | -85      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that UE  |
|    |          |      |          |          |          | re       |
|    |          |      |          |          |          | gistered |
|    |          |      |          |          |          | on NR    |
|    |          |      |          |          |          | Cell 1   |
+----+----------+------+----------+----------+----------+----------+
| T1 | SS/PBCH  | dBm/ | -85      | -113     | -79      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that UE  |
|    |          |      |          |          |          | succ     |
|    |          |      |          |          |          | essfully |
|    |          |      |          |          |          | h        |
|    |          |      |          |          |          | andovers |
|    |          |      |          |          |          | to NR    |
|    |          |      |          |          |          | Cell 4   |
+----+----------+------+----------+----------+----------+----------+
| T2 | SS/PBCH  | dBm/ | -85      | -79      | -113     | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 2   |
+----+----------+------+----------+----------+----------+----------+
| T3 | SS/PBCH  | dBm/ | \- 113   | -113     | OFF      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that all |
|    |          |      |          |          |          | Srxlev   |
|    |          |      |          |          |          | ~NR~     |
|    |          |      |          |          |          | ~Cell~   |
|    |          |      |          |          |          | \< 0     |
+----+----------+------+----------+----------+----------+----------+
| T4 | SS/PBCH  | dBm/ | -113     | -113     | -79      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 4   |
+----+----------+------+----------+----------+----------+----------+

Table 8.1.4.4.4.3.2-2: Power levels in FR2

+----+----------+------+----------+----------+----------+----------+
|    | P        | Unit | NR Cell  | NR Cell  | NR Cell  | Remark   |
|    | arameter |      | 1        | 2        | 4        |          |
+====+==========+======+==========+==========+==========+==========+
| T0 | SS/PBCH  | dBm/ | -82      | "Off"    | -91      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that UE  |
|    |          |      |          |          |          | re       |
|    |          |      |          |          |          | gistered |
|    |          |      |          |          |          | on NR    |
|    |          |      |          |          |          | Cell 1   |
+----+----------+------+----------+----------+----------+----------+
| T1 | SS/PBCH  | dBm/ | -91      | "Off"    | -82      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that UE  |
|    |          |      |          |          |          | succ     |
|    |          |      |          |          |          | essfully |
|    |          |      |          |          |          | h        |
|    |          |      |          |          |          | andovers |
|    |          |      |          |          |          | to NR    |
|    |          |      |          |          |          | Cell 4   |
+----+----------+------+----------+----------+----------+----------+
| T2 | SS/PBCH  | dBm/ | -91      | -82      | "Off"    | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 2   |
+----+----------+------+----------+----------+----------+----------+
| T3 | SS/PBCH  | dBm/ | "Off"    | "Off"    | "Off"    | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that all |
|    |          |      |          |          |          | Srxlev   |
|    |          |      |          |          |          | NR Cell  |
|    |          |      |          |          |          | \< 0     |
+----+----------+------+----------+----------+----------+----------+
| T4 | SS/PBCH  | dBm/ | "Off"    | "Off"    | -82      | Power    |
|    | SSS EPRE |      |          |          |          | levels   |
|    |          | SCS  |          |          |          | are such |
|    |          |      |          |          |          | that     |
|    |          |      |          |          |          | entry    |
|    |          |      |          |          |          | c        |
|    |          |      |          |          |          | ondition |
|    |          |      |          |          |          | for      |
|    |          |      |          |          |          | event A3 |
|    |          |      |          |          |          | is       |
|    |          |      |          |          |          | s        |
|    |          |      |          |          |          | atisfied |
|    |          |      |          |          |          | for NR   |
|    |          |      |          |          |          | Cell 4   |
+----+----------+------+----------+----------+----------+----------+

Table 8.1.4.4.4.3.2-3: Main behaviour

  St                                                                                                              Procedure                                                                                                                                                                                         Message Sequence   TP                                     Verdict   
  --------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                                                                                                                    U - S              Message                                          
  1                                                                                                               The SS transmits an *RRCReconfiguration* message *including MeasConfig* and *ConditionalReconfiguration* to set NR Cell 2 as the target candidate cell.                                           \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2                                                                                                               The UE transmits an *RRCReconfigurationComplete* message in NR Cell 1.                                                                                                                            \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  2A                                                                                                              SS adjusts the cell-specific reference signal level according to row \"T1\".                                                                                                                      \-                 *-*                                    \-        \-
  3                                                                                                               The SS transmits an *RRCReconfiguration* message including a *reconfigurationWithSync* for handover to NR Cell 4.                                                                                 \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  4                                                                                                               Check: Does UE transmit the *RRCReconfigurationComplete* message in NR Cell 4 within 10s?                                                                                                         \--\>              *NR RRC: RRCReconfigurationComplete*   1         P
  4A                                                                                                              Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on NR Cell 4?                                      \-                 *-*                                    1         \-
  \-                                                                                                              EXCEPTION: Steps 5-15 describe behaviour that depends on UE configuration; the \"lower case letter\" identifies a step sequence that takes place if pc\_condHandoverFailure\_r16 is configured.   \-                 *-*                                    \-        \-
  5                                                                                                               IF pc\_condHandoverFailure\_r16 THEN the SS transmits an *RRCReconfiguration* message including *MeasConfig* and *ConditionalReconfiguration* to set NR Cell 2 as the target candidate cell.      \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  6                                                                                                               The UE transmits an *RRCReconfigurationComplete* message in NR Cell 4.                                                                                                                            \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  7                                                                                                               The SS transmits an *RRCReconfiguration* message including a *reconfigurationWithSync* for handover to NR Cell 1.                                                                                 \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  \-                                                                                                              EXCEPTION: In parallel to the events described in step 8 the steps specified in Table 8.1.4.4.4.3.2-4 should take place.                                                                          \-                 *-*                                    \-        \-
  8                                                                                                               SS adjusts the cell-specific reference signal level according to row \"T2\".                                                                                                                      \-                 *-*                                    \-        \-
  9                                                                                                               Check: Does UE transmit the *RRCReconfigurationComplete* message in NR Cell 2 within 10s?                                                                                                         \--\>              *NR RRC: RRCReconfigurationComplete*   2         P
  9A                                                                                                              Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on NR Cell 2?                                      \-                 *-*                                    2         \-
  10                                                                                                              The SS transmits an *RRCReconfiguration* message including *MeasConfig* and *ConditionalReconfiguration* to set NR Cell 4 as the target candidate cell.                                           \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  11                                                                                                              The UE transmits an *RRCReconfigurationComplete* message in NR Cell 2.                                                                                                                            \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  12                                                                                                              The SS transmits an *RRCReconfiguration* message including a *reconfigurationWithSync* for handover to NR Cell 1.                                                                                 \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  12A                                                                                                             SS adjusts the cell-specific reference signal level according to row \"T3\".                                                                                                                      \-                 *-*                                    \-        \-
  \-                                                                                                              EXCEPTION: In parallel to the events described in step 13 the steps specified in Table 8.1.4.4.4.3.2-4 should take place until T304 expiry.                                                       \-                 *-*                                    \-        \-
  13                                                                                                              SS waits 5s to make sure that the UE is in idle state. (Note 1)                                                                                                                                   \-                 *-*                                    \-        \-
  14                                                                                                              SS adjusts the cell-specific reference signal level according to row \"T4\".                                                                                                                      \-                 *-*                                    \-        \-
  15                                                                                                              Check: Is the generic mobility registration updating procedure described in TS 38.508-1 \[4\] Table 4.9.5.2.2-1 performed on NR Cell 4?                                                           \-                 \-                                     3         \-
  Note 1: The wait time is selected to cover T304 (1000ms) + T311 (1000ms) to ensure that UE goes to RRC\_IDLE.                                                                                                                                                                                                                                                                         

Table 8.1.4.4.4.3.2-4: Parallel behaviour

  St   Procedure                                                                                                Message Sequence   TP        Verdict   
  ---- -------------------------------------------------------------------------------------------------------- ------------------ --------- --------- ----
                                                                                                                U - S              Message             
  \-   EXCEPTION: The steps 1 and 2 below are repeated for the duration of T304.                                \-                 *-*       \-        \-
  1    The UE attempts to perform the intra frequency handover using MAC Random Access Preamble on NR Cell 1.   \-                 *-*       \-        \-
  2    The SS does not respond.                                                                                 \-                 *-*       \-        \-

##### 8.1.4.4.4.3.3 Specific message contents {#specific-message-contents-87 .H6}

Table 8.1.4.4.4.3.3-1: *RRCReconfiguration* (Step 1, step 5 and step 10,
Table 8.1.4.4.4.3.2-3)

  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                        
  Information Element                                                                  Value/remark                 Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                             
  measConfig                                                                           MeasConfig                   Table 8.1.4.4.4.3.3-2   
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.4.4.4.3.3-5   
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------

Table 8.1.4.4.4.3.3-2: *MeasConfig* (Table 8.1.4.4.4.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                 
  Information Element                                                                        Value/remark                   Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                         
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                 
  measObjectId                                                                               1                                                      
  measObject CHOICE {                                                                                                                               
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.4.4.4.3.3-3   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  reportConfigId                                                                             1                                                      
  reportConfig CHOICE {                                                                                                                             
  reportConfigNR                                                                             *ReportConfigNR-condEventA3*   Table 8.1.4.4.4.3.3-4   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                 
  measId                                                                                     1                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             1                                                      
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------

Table 8.1.4.4.4.3.3-3: *MeasObjectNR* (Table 8.1.4.4.4.3.3-2)

  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-76                                                                                                                                                                 
  Information Element                                 Value/remark                         Comment                                                                                                                  Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                                                                                                       
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 1   The SSB of NR Cell 1, NR Cell 2 and NR Cell 4 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                     Not present                                                                                                                                                   
  nrofSS-BlocksToAverage                              Not present                                                                                                                                                   
  }                                                                                                                                                                                                                 
  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------------------ -----------

Table 8.1.4.4.4.3.3-4: *ReportConfigNR-condEventA3* (Table
8.1.4.4.4.3.3-2)

  ------------------------------------------------------------------------------------- -------------- ------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition CHO AND EVENT\_A3                                     
  Information Element                                                                   Value/remark   Comment            Condition
  ReportConfigNR ::= SEQUENCE {                                                                                           
  reportType CHOICE {                                                                                                     
  condTriggerConfig-r16 SEQUENCE {                                                                                        
  condEventId CHOICE {                                                                                                    
  condEventA3 SEQUENCE {                                                                                                  
  a3-Offset CHOICE {                                                                                                      
  rsrp                                                                                  2              1 dB (2\*0.5 dB)   
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  ------------------------------------------------------------------------------------- -------------- ------------------ -----------

Table 8.1.4.4.4.3.3-5: *ConditionalReconfiguration* (Table
8.1.4.4.4.3.3-1)

  ---------------------------------------------------- ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                          
  Information Element                                  Value/remark                   Comment                 Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                               
  condReconfigToAddModList-r16                         CondReconfigToAddModList-r16   Table 8.1.4.4.4.3.3-6   
  }                                                                                                           
  ---------------------------------------------------- ------------------------------ ----------------------- -----------

Table 8.1.4.4.4.3.3-6: *CondReconfigToAddModList-r16* (Table
8.1.4.4.4.3.3-5)

  ----------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------ ----------------------- ----------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                                                 
  Information Element                                                                                         Value/remark                                                                   Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   1 entry                                                                                                
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                                                   entry 1                 
  condReconfigId-r16                                                                                          1                                                                                                      
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                                                   
  MeasId \[1\]                                                                                                1                                                                                                      
  }                                                                                                                                                                                                                  
  condRRCReconfig-r16                                                                                         OCTET STRING (CONTAINING RRCReconfiguration-HO with condition HO\_NR Cell 2)   Table 8.1.4.4.4.3.3-7   Step 1, Step 5
                                                                                                              OCTET STRING (CONTAINING RRCReconfiguration-HO with condition HO\_NR Cell 4)   Table 8.1.4.4.4.3.3-7   Step 10
  }                                                                                                                                                                                                                  
  }                                                                                                                                                                                                                  
  ----------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------ ----------------------- ----------------

Table 8.1.4.4.4.3.3-7: RRCReconfiguration-HO (Table 8.1.4.4.4.3.3-6)

  -------------------------------------------------------------------------------------- ------------------------------------------------------------------------- ----------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                                                     
  Information Element                                                                    Value/remark                                                              Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                                              
  rrcReconfiguration SEQUENCE {                                                                                                                                                            
  nonCriticalExtension SEQUENCE{                                                                                                                                                           
  masterCellGroup                                                                        OCTET STRING (CONTAINING CellGroupConfig with condition PCI\_NR Cell 2)   Table 8.1.4.4.4.3.3-8   HO\_NR Cell 2
                                                                                         OCTET STRING (CONTAINING CellGroupConfig with condition PCI\_NR Cell 4)   Table 8.1.4.4.4.3.3-8   HO\_NR Cell 4
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  -------------------------------------------------------------------------------------- ------------------------------------------------------------------------- ----------------------- ---------------

Table 8.1.4.4.4.3.3-8: *CellGroupConfig* (Table 8.1.4.4.4.3.3-7 and
8.1.4.4.4.3.3-9)

  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 2             PCI\_NR Cell 2
                                                                                             Physical Cell Identity of NR Cell 4             PCI\_NR Cell 4
                                                                                             Physical Cell Identity of NR Cell 1             PCI\_NR Cell 1
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------

Table 8.1.4.4.4.3.3-9: RRCReconfiguration-HO (Step 3, step 7 and step
12, Table 8.1.4.4.4.3.2-3)

  -------------------------------------------------------------------------------------- ------------------------------------------------------------------------- ----------------------- -----------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                                                     
  Information Element                                                                    Value/remark                                                              Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                                              
  rrcReconfiguration SEQUENCE {                                                                                                                                                            
  nonCriticalExtension SEQUENCE{                                                                                                                                                           
  masterCellGroup                                                                        OCTET STRING (CONTAINING CellGroupConfig with condition PCI\_NR Cell 4)   Table 8.1.4.4.4.3.3-8   Step 3
                                                                                         OCTET STRING (CONTAINING CellGroupConfig with condition PCI\_NR Cell 1)   Table 8.1.4.4.4.3.3-8   Step 7, Step 12
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  -------------------------------------------------------------------------------------- ------------------------------------------------------------------------- ----------------------- -----------------

##### 8.1.4.4.5 NR NTN / Conditional handover / Success / CondEventA4 {#nr-ntn-conditional-handover-success-condeventa4 .H6}

##### 8.1.4.4.5.1 Test Purpose (TP) {#test-purpose-tp-96 .H6}

##### (1) {#section-164 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and receiving an *RRCReconfiguration* message including
*ConditionalReconfiguration* }

**ensure that** {

**when** { any CHO execution condition is not satisfied } **then** { UE
maintains connection with source gNB and starts evaluating the CHO
execution conditions for the candidate cell(s) }

}

##### (2) {#section-165 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and supporting event A4 based conditional handover }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including
*ConditionalReconfiguration* and condEvent A4 is configured as
conditional handover trigger event } **then** { UE starts evaluating the
CHO execution condition A4 and performs conditional handover to the
neighbour cell triggered in conditional configuration execution }

}

##### 8.1.4.4.5.2 Conformance requirements {#conformance-requirements-96 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 clauses 9.2.3.4.1 and 9.2.3.4.2, and TS 38.331
clauses 5.3.5.1, 5.3.5.13.1, 5.3.5.13.4, and 5.5.4.5. Unless otherwise
stated these are Rel-17 requirements.

\[TS 38.300, clause 9.2.3.4.1\]

A Conditional Handover (CHO) is defined as a handover that is executed
by the UE when one or more handover execution conditions are met. The UE
starts evaluating the execution condition(s) upon receiving the CHO
configuration, and stops evaluating the execution condition(s) once a
handover is executed.

The following principles apply to CHO:

\- The CHO configuration contains the configuration of CHO candidate
cell(s) generated by the candidate gNB(s) and execution condition(s)
generated by the source gNB.

\- An execution condition may consist of one or two trigger condition(s)
(CHO events A3/A5, as defined in \[12\]). Only single RS type is
supported and at most two different trigger quantities (e.g. RSRP and
RSRQ, RSRP and SINR, etc.) can be configured simultaneously for the
evalution of CHO execution condition of a single candidate cell.

\- Before any CHO execution condition is satisfied, upon reception of HO
command (without CHO configuration), the UE executes the HO procedure as
described in clause 9.2.3.2, regardless of any previously received CHO
configuration.

\- While executing CHO, i.e. from the time when the UE starts
synchronization with target cell, UE does not monitor source cell.

CHO is also supported for the IAB-MT in context of intra- and
inter-donor IAB-node migration and BH RLF recovery.

CHO is not supported for NG-C based handover in this release of the
specification.

\[TS 38.300, clause 9.2.3.4.2\]

As in intra-NR RAN handover, in intra-NR RAN CHO, the preparation and
execution phase of the conditional handover procedure is performed
without involvement of the 5GC; i.e. preparation messages are directly
exchanged between gNBs. The release of the resources at the source gNB
during the conditional handover completion phase is triggered by the
target gNB. The figure below depicts the basic conditional handover
scenario where neither the AMF nor the UPF changes:

Figure 9.2.3.4.2-1: Intra-AMF/UPF Conditional Handover

0/1. Same as step 0, 1 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

2\. The source gNB decides to use CHO.

3\. The source gNB requests CHO for one or more candidate cells
belonging to one or more candidate gNBs. A CHO request message is sent
for each candidate cell.

4\. Same as step 4 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

5\. The candidate gNB(s) sends CHO response (HO REQUEST ACKNOWLEDGE)
including configuration of CHO candidate cell(s) to the source gNB. The
CHO response message is sent for each candidate cell.

6\. The source gNB sends an *RRCReconfiguration* message to the UE,
containing the configuration of CHO candidate cell(s) and CHO execution
condition(s).

NOTE 1: CHO configuration of candidate cells can be followed by other
reconfiguration from the source gNB.

NOTE 1a: A configuration of a CHO candidate cell cannot contain a DAPS
handover configuration.

7\. The UE sends an *RRCReconfigurationComplete* message to the source
gNB.

7a If early data forwarding is applied, the source gNB sends the EARLY
STATUS TRANSFER message.

8\. The UE maintains connection with the source gNB after receiving CHO
configuration, and starts evaluating the CHO execution conditions for
the candidate cell(s). If at least one CHO candidate cell satisfies the
corresponding CHO execution condition, the UE detaches from the source
gNB, applies the stored corresponding configuration for that selected
candidate cell, synchronises to that candidate cell and completes the
RRC handover procedure by sending *RRCReconfigurationComplete* message
to the target gNB. The UE releases stored CHO configurations after
successful completion of RRC handover procedure.

8a/b The target gNB sends the HANDOVER SUCCESS message to the source gNB
to inform that the UE has successfully accessed the target cell. In
return, the source gNB sends the SN STATUS TRANSFER message following
the principles described in step 7 of Intra-AMF/UPF Handover in clause
9.2.3.2.1.

NOTE 2: Late data forwarding may be initiated as soon as the source gNB
receives the HANDOVER SUCCESS message.

8c. The source gNB sends the HANDOVER CANCEL message toward the other
signalling connections or other candidate target gNBs, if any, to cancel
CHO for the UE.

\[TS 38.331, clause 5.3.5.1\]

Figure 5.3.5.1-1: RRC reconfiguration, successful

Figure 5.3.5.1-2: RRC reconfiguration, failure

The purpose of this procedure is to modify an RRC connection, e.g. to
establish/modify/release RBs, to perform reconfiguration with sync, to
setup/modify/release measurements, to add/modify/release SCells and cell
groups, to add/modify/release conditional handover configuration, to
add/modify/release conditional PSCell change configuration. As part of
the procedure, NAS dedicated information may be transferred from the
Network to the UE.

\[TS 38.331, clause 5.3.5.13.1\]

The network configures the UE with one or more candidate target SpCells
in the conditional reconfiguration. The UE evaluates the condition of
each configured candidate target SpCell. The UE applies the conditional
reconfiguration associated with one of the target SpCells which fulfils
associated execution condition. The network provides the configuration
parameters for the target SpCell in the *ConditionalReconfiguration* IE.

The UE performs the following actions based on a received
*ConditionalReconfiguration* IE:

1\> if the *ConditionalReconfiguration* contains the
*condReconfigToRemoveList*:

2\> perform conditional reconfiguration removal procedure as specified
in 5.3.5.13.2;

1\> if the *ConditionalReconfiguration* contains the
*condReconfigToAddModList*:

2\> perform conditional reconfiguration addition/modification as
specified in 5.3.5.13.3;

\[TS 38.331, clause 5.3.5.13.4\]

The UE shall:

1\> for each *condReconfigId* within the *VarConditionalReconfig*:

2\> if the *RRCReconfiguration* within *condRRCReconfig* includes the
*masterCellGroup* including the *reconfigurationWithSync*:

3\> consider the cell which has a physical cell identity matching the
value indicated in the *ServingCellConfigCommon* included in the
*reconfigurationWithSync* within the *masterCellGroup* in the received
*condRRCReconfig* to be applicable cell;

2\> else if the *RRCReconfiguration* within *condRRCReconfig* includes
the *secondaryCellGroup* including the *reconfigurationWithSync*:

3\> consider the cell which has a physical cell identity matching the
value indicated in the *ServingCellConfigCommon* included in the
*reconfigurationWithSync* within the *secondaryCellGroup* within the
received *condRRCReconfig* to be applicable cell;

2\> if *condExecutionCondSCG* is configured:

3\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCondSCG* as a *measId* in the *VarMeasConfig*
associated with the SCG *measConfig*;

2\> if *condExecutionCond* is configured:

3\> if it is configured via SRB3 or configured within *nr-SCG* or within
*nr-SecondaryCellGroupConfig* (specified in TS 36.331\[10\]) via SRB1:

4\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCond* as a *measId* in the *VarMeasConfig*
associated with the SCG *measConfig*;

3\> else:

4\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCond* as a *measId* in the *VarMeasConfig*
associated with the MCG *measConfig*;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig* indicated in the *condExecutionCond* or
*condExecutionCondSCG* associated to *condReconfigId:*

3\> if the *condEventId* is associated with *condEventT1*, and if the
entry condition applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell; or

3\> if the *condEventId* is associated with *condEventD1*, and if the
entry conditions applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell during
the corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*; or

3\> if the *condEventId* is associated with *condEventA3*, *condEventA4*
or *condEventA5*, and if the entry condition(s) applicable for this
event associated with the *condReconfigId*, i.e. the event corresponding
with the *condEventId(s)* of the corresponding *condTriggerConfig*
within *VarConditionalReconfig*, is fulfilled for the applicable cells
for all measurements after layer 3 filtering taken during the
corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*:

4\> consider the event associated to that *measId* to be fulfilled;

3\> if the *measId* for this event associated with the *condReconfigId*
has been modified; or

3\> if the *condEventId* is associated with *condEventT1*, and if the
leaving condition applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell; or

3\> if the *condEventId* is associated with *condEventD1*, and if the
leaving condition(s) applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell during
the corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*; or

3\> if the *condEventId* is associated with *condEventA3*, *condEventA4*
or *condEventA5*, and if the leaving condition(s) applicable for this
event associated with the *condReconfigId*, i.e. the event corresponding
with the *condEventId(s)* of the corresponding *condTriggerConfig*
within *VarConditionalReconfig*, is fulfilled for the applicable cells
for all measurements after layer 3 filtering taken during the
corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*:

4\> consider the event associated to that *measId* to be not fulfilled;

2\> if event(s) associated to all *measId*(s) within *condTriggerConfig*
for the applicable cell are fulfilled:

3\> consider the applicable cell, associated to that *condReconfigId*,
as a triggered cell;

3\> initiate the conditional reconfiguration execution, as specified in
5.3.5.13.5;

NOTE 1: Up to 2 *MeasId* can be configured for each *condReconfigId.*
The conditional reconfiguration event of the 2 *MeasId* may have the
same or different event conditions, triggering quantity, time to
trigger, and triggering threshold.

NOTE 2: Void.

\[TS 38.331, clause 5.5.4.5\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A4-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A4-2, as specified below, is fulfilled.

Inequality A4-1 (Entering condition)

*Mn + Ofn + Ocn -- Hys \> Thresh*

Inequality A4-2 (Leaving condition)

*Mn + Ofn + Ocn + Hys \< Thresh*

The variables in the formula are defined as follows:

***Mn*** is the measurement result of the neighbouring cell, not taking
into account any offsets.

***Ofn*** is the measurement object specific offset of the neighbour
cell (i.e. *offsetMO* as defined within *measObjectNR* corresponding to
the neighbour cell).

***Ocn*** is the measurement object specific offset of the neighbour
cell (i.e. *cellIndividualOffset* as defined within *measObjectNR*
corresponding to the neighbour cell), and set to zero if not configured
for the neighbour cell.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Thresh*** is the threshold parameter for this event (i.e.
*a4-Threshold* as defined within *reportConfigNR* for this event).

***Mn*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and RS-SINR.

***Ofn, Ocn, Hys*** are expressed in dB.

***Thresh*** is expressed in the same unit as ***Mn***.

NOTE: The definition of Event A4 also applies to CondEvent A4.

##### 8.1.4.4.5.3 Test description {#test-description-96 .H6}

##### 8.1.4.4.5.3.1 Pre-test conditions {#pre-test-conditions-96 .H6}

##### System Simulator: {#system-simulator-63 .H6}

2 NR cells: NR Cell 1 and NR Cell 2 as specified in TS 38.508-1 \[4\]
Table 4.4.2-1.

System information combination NR-29 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-60 .H6}

\- The pre-configured UE location is defined in TS 38.508-1 \[4\] clause
4.5C.

##### Preamble: {#preamble-61 .H6}

> \- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
> NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table
> 4.4A.2-3.
>
> \- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*)
> with UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\],
> clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.4.4.5.3.2 Test procedure sequence {#test-procedure-sequence-97 .H6}

Table 8.1.4.4.5.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1 and NR Cell 2 at various time instants of the test
execution. Row marked \"T0\" denotes the conditions after the preamble,
while the configuration marked \"T1\", is applied at the point indicated
in the Main behaviour description in Table 8.1.4.4.5.3.2-2.

Table 8.1.4.4.5.3.2-1: Time instances of cell power level and parameter
changes for NR Cell 1 and NR Cell 2 in conducted test environment

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 2 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -85       | -91    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A4 |
|    |              |      |           |        | (measId 1)   |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied:   |
|    |              |      |           |        |              |
|    |              |      |           |        | *Mn + Ofn +  |
|    |              |      |           |        | Ocn - Hys ≦  |
|    |              |      |           |        | Thresh*      |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -85       | -79    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A4 |
|    |              |      |           |        | (measId 1)   |
|    |              |      |           |        | is           |
|    |              |      |           |        | satisfied:   |
|    |              |      |           |        |              |
|    |              |      |           |        | *Mn + Ofn +  |
|    |              |      |           |        | Ocn -- Hys   |
|    |              |      |           |        | \> Thresh*   |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.4.4.5.3.2-2: Main behaviour

  St   Procedure                                                                                                                                                                                                       Message Sequence   TP                                     Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                       U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* and *ConditionalReconfiguration* to set NR Cell 2 as target candidate cells and configure condEvent A4 as trigger event in NR Cell 1.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message in NR cell 1.                                                                                                                                          \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    Check: Does the UE initiate a random access procedure transmitting Preamble in NR Cell 2 within 10s?                                                                                                            \--\>              (PRACH Preamble)                       1         F
  4    SS re-adjusts the cell-specific reference signal level according to row \"T1\" in table 8.1.4.4.5.3.2-1.                                                                                                        \-                 *-*                                    \-        \-
  5    Check: Does the UE initiate a random access procedure by transmitting Preamble in NR Cell 2 within 10s?                                                                                                         \--\>              (PRACH Preamble)                       2         P
  6    The SS transmits Random Access Response.                                                                                                                                                                        \<\--              Random Access Response                 \-        \-
  7    The UE transmits *RRCReconfigurationComplete* message in NR Cell 2.                                                                                                                                             \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  8    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] Table 4.9.1-1 indicate that the UE is capable of exchanging IP data on DRB1 and NR Cell 2?                                           \-                 *-*                                    2         \-

##### 8.1.4.4.5.3.3 Specific message contents {#specific-message-contents-88 .H6}

Table 8.1.4.4.5.3.3-1: *RRCReconfiguration* (Step 1, Table
8.1.4.4.5.3.2-2)

  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                        
  Information Element                                                                  Value/remark                 Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                             
  measConfig                                                                           MeasConfig                   Table 8.1.4.4.5.3.3-6   
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.4.4.5.3.3-2   
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------

Table 8.1.4.4.5.3.3-2: ConditionalReconfiguration (Table
8.1.4.4.5.3.3-1)

  ---------------------------------------------------- ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                          
  Information Element                                  Value/remark                   Comment                 Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                               
  condReconfigToRemoveList-r16                         Not present                                            
  condReconfigToAddModList-r16                         CondReconfigToAddModList-r16   Table 8.1.4.4.5.3.3-3   
  }                                                                                                           
  ---------------------------------------------------- ------------------------------ ----------------------- -----------

Table 8.1.4.4.5.3.3-3: CondReconfigToAddModList*-r16* (Table
8.1.4.4.5.3.3-2)

  ----------------------------------------------------------------------------------------------------------- ----------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                          
  Information Element                                                                                         Value/remark            Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   1 entry                                         
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                            entry 1                 
  condReconfigId-r16                                                                                          1                                               
  condExecutionCond-r16 SEQUENCE {                                                                                                                            
  MeasId \[1\]                                                                                                1                                               
  }                                                                                                                                                           
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO   Table 8.1.4.4.5.3.3-4   
  }                                                                                                                                                           
  }                                                                                                                                                           
  ----------------------------------------------------------------------------------------------------------- ----------------------- ----------------------- -----------

Table 8.1.4.4.5.3.3-4: RRCReconfiguration-HO (Table 8.1.4.4.5.3.3-3)

  -------------------------------------------------------------------------------------- ----------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                             
  Information Element                                                                    Value/remark      Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                
  criticalExtensions CHOICE {                                                                                                      
  rrcReconfiguration SEQUENCE {                                                                                                    
  nonCriticalExtension SEQUENCE{                                                                                                   
  masterCellGroup                                                                        CellGroupConfig   Table 8.1.4.4.5.3.3-5   
  }                                                                                                                                
  }                                                                                                                                
  }                                                                                                                                
  }                                                                                                                                
  -------------------------------------------------------------------------------------- ----------------- ----------------------- -----------

8.1.4.4.5.3.3-5: CellGroupConfig (Table 8.1.4.4.5.3.3-4)

  ------------------------------------------------------------------------------------------ ------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 2             
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- -----------

Table 8.1.4.4.5.3.3-6: *MeasConfig* (Table 8.1.4.4.5.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                 
  Information Element                                                                        Value/remark                   Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                         
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                 
  measObjectId                                                                               1                                                      
  measObject CHOICE {                                                                                                                               
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.4.4.5.3.3-7   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  reportConfigId                                                                             1                                                      
  reportConfig CHOICE {                                                                                                                             
  reportConfigNR                                                                             *ReportConfigNR-condEventA4*   Table 8.1.4.4.5.3.3-8   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                 
  measId                                                                                     1                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             1                                                      
  }                                                                                                                                                 
  }                                                                                                                                                 
  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------

Table 8.1.4.4.5.3.3-7: *MeasObjectNR* (Table 8.1.4.4.5.3.3-6)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR ::= SEQUENCE {                                                                         
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.4.4.5.3.3-8: *ReportConfigNR-condEventA4* (Table
8.1.4.4.5.3.3-6)

  Derivation Path: TS 38.508-1\[4\] Table 4.6.63-142                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  ReportConfigNR ::= SEQUENCE {                                                 
  reportType CHOICE {                                                           
  condTriggerConfig-r16 SEQUENCE {                                              
  condEventId CHOICE {                                                          
  condEventA4-r17 SEQUENCE {                                                    
  a4-Threshold-r17 CHOICE {                                                     
  rsrp                                                 70             -86dBm    
  }                                                                             
  hysteresis-r17                                       2              1 dB      
  timeToTrigger-r17                                    ms320                    
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             

##### 8.1.4.4.6 NR NTN / Conditional handover / Success / CondEventT1

##### 8.1.4.4.6.1 Test Purpose (TP) {#test-purpose-tp-97 .H6}

##### (1) {#section-166 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting time based
conditional handover and receiving an *RRCReconfiguration* message
including *ConditionalReconfiguration* }

**ensure that** {

**when** { any CHO execution condition is not satisfied } **then** { UE
maintains connection with source gNB and starts evaluating the CHO
execution conditions for the candidate cell(s) }

}

##### (2) {#section-167 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting conditional
handover and supporting time based conditional handover }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including
*ConditionalReconfiguration* and condEventT1 is configured as
conditional handover trigger event } **then** { UE starts evaluating the
CHO execution condition T1 and performs conditional handover to the
neighbour cell triggered in conditional configuration execution }

}

##### (3) {#section-168 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting time based
conditional handover }

**ensure that** {

**when** { UE performs conditional handover procedure successfully }
**then** { UE releases stored CHO configurations }

}

##### 8.1.4.4.6.2 Conformance requirements {#conformance-requirements-97 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 clauses 9.2.3.4.1 and 9.2.3.4.2, and TS 38.331
clauses 5.3.5.1, 5.3.5.13.1, 5.3.5.13.4, and 5.5.4.16. Unless otherwise
stated these are Rel-17 requirements.

\[TS 38.300, clause 9.2.3.4.1\]

A Conditional Handover (CHO) is defined as a handover that is executed
by the UE when one or more handover execution conditions are met. The UE
starts evaluating the execution condition(s) upon receiving the CHO
configuration, and stops evaluating the execution condition(s) once a
handover is executed.

The following principles apply to CHO:

\- The CHO configuration contains the configuration of CHO candidate
cell(s) generated by the candidate gNB(s) and execution condition(s)
generated by the source gNB.

\- An execution condition may consist of one or two trigger condition(s)
(CHO events A3/A5, as defined in \[12\]). Only single RS type is
supported and at most two different trigger quantities (e.g. RSRP and
RSRQ, RSRP and SINR, etc.) can be configured simultaneously for the
evalution of CHO execution condition of a single candidate cell.

\- Before any CHO execution condition is satisfied, upon reception of HO
command (without CHO configuration), the UE executes the HO procedure as
described in clause 9.2.3.2, regardless of any previously received CHO
configuration.

\- While executing CHO, i.e. from the time when the UE starts
synchronization with target cell, UE does not monitor source cell.

CHO is also supported for the IAB-MT in context of intra- and
inter-donor IAB-node migration and BH RLF recovery.

CHO is not supported for NG-C based handover in this release of the
specification.

\[TS 38.300, clause 9.2.3.4.2\]

As in intra-NR RAN handover, in intra-NR RAN CHO, the preparation and
execution phase of the conditional handover procedure is performed
without involvement of the 5GC; i.e. preparation messages are directly
exchanged between gNBs. The release of the resources at the source gNB
during the conditional handover completion phase is triggered by the
target gNB. The figure below depicts the basic conditional handover
scenario where neither the AMF nor the UPF changes:

Figure 9.2.3.4.2-1: Intra-AMF/UPF Conditional Handover

0/1. Same as step 0, 1 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

2\. The source gNB decides to use CHO.

3\. The source gNB requests CHO for one or more candidate cells
belonging to one or more candidate gNBs. A CHO request message is sent
for each candidate cell.

4\. Same as step 4 in Figure 9.2.3.2.1-1 of clause 9.2.3.2.1.

5\. The candidate gNB(s) sends CHO response (HO REQUEST ACKNOWLEDGE)
including configuration of CHO candidate cell(s) to the source gNB. The
CHO response message is sent for each candidate cell.

6\. The source gNB sends an *RRCReconfiguration* message to the UE,
containing the configuration of CHO candidate cell(s) and CHO execution
condition(s).

NOTE 1: CHO configuration of candidate cells can be followed by other
reconfiguration from the source gNB.

NOTE 1a: A configuration of a CHO candidate cell cannot contain a DAPS
handover configuration.

7\. The UE sends an *RRCReconfigurationComplete* message to the source
gNB.

7a If early data forwarding is applied, the source gNB sends the EARLY
STATUS TRANSFER message.

8\. The UE maintains connection with the source gNB after receiving CHO
configuration, and starts evaluating the CHO execution conditions for
the candidate cell(s). If at least one CHO candidate cell satisfies the
corresponding CHO execution condition, the UE detaches from the source
gNB, applies the stored corresponding configuration for that selected
candidate cell, synchronises to that candidate cell and completes the
RRC handover procedure by sending *RRCReconfigurationComplete* message
to the target gNB. The UE releases stored CHO configurations after
successful completion of RRC handover procedure.

8a/b The target gNB sends the HANDOVER SUCCESS message to the source gNB
to inform that the UE has successfully accessed the target cell. In
return, the source gNB sends the SN STATUS TRANSFER message following
the principles described in step 7 of Intra-AMF/UPF Handover in clause
9.2.3.2.1.

NOTE 2: Late data forwarding may be initiated as soon as the source gNB
receives the HANDOVER SUCCESS message.

8c. The source gNB sends the HANDOVER CANCEL message toward the other
signalling connections or other candidate target gNBs, if any, to cancel
CHO for the UE.

\[TS 38.331, clause 5.3.5.1\]

Figure 5.3.5.1-1: RRC reconfiguration, successful

Figure 5.3.5.1-2: RRC reconfiguration, failure

The purpose of this procedure is to modify an RRC connection, e.g. to
establish/modify/release RBs, to perform reconfiguration with sync, to
setup/modify/release measurements, to add/modify/release SCells and cell
groups, to add/modify/release conditional handover configuration, to
add/modify/release conditional PSCell change configuration. As part of
the procedure, NAS dedicated information may be transferred from the
Network to the UE.

\[TS 38.331, clause 5.3.5.13.1\]

The network configures the UE with one or more candidate target SpCells
in the conditional reconfiguration. The UE evaluates the condition of
each configured candidate target SpCell. The UE applies the conditional
reconfiguration associated with one of the target SpCells which fulfils
associated execution condition. The network provides the configuration
parameters for the target SpCell in the *ConditionalReconfiguration* IE.

The UE performs the following actions based on a received
*ConditionalReconfiguration* IE:

1\> if the *ConditionalReconfiguration* contains the
*condReconfigToRemoveList*:

2\> perform conditional reconfiguration removal procedure as specified
in 5.3.5.13.2;

1\> if the *ConditionalReconfiguration* contains the
*condReconfigToAddModList*:

2\> perform conditional reconfiguration addition/modification as
specified in 5.3.5.13.3;

\[TS 38.331, clause 5.3.5.13.4\]

The UE shall:

1\> for each *condReconfigId* within the *VarConditionalReconfig*:

2\> if the *RRCReconfiguration* within *condRRCReconfig* includes the
*masterCellGroup* including the *reconfigurationWithSync*:

3\> consider the cell which has a physical cell identity matching the
value indicated in the *ServingCellConfigCommon* included in the
*reconfigurationWithSync* within the *masterCellGroup* in the received
*condRRCReconfig* to be applicable cell;

2\> else if the *RRCReconfiguration* within *condRRCReconfig* includes
the *secondaryCellGroup* including the *reconfigurationWithSync*:

3\> consider the cell which has a physical cell identity matching the
value indicated in the *ServingCellConfigCommon* included in the
*reconfigurationWithSync* within the *secondaryCellGroup* within the
received *condRRCReconfig* to be applicable cell;

2\> if *condExecutionCondSCG* is configured:

3\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCondSCG* as a *measId* in the *VarMeasConfig*
associated with the SCG *measConfig*;

2\> if *condExecutionCond* is configured:

3\> if it is configured via SRB3 or configured within *nr-SCG* or within
*nr-SecondaryCellGroupConfig* (specified in TS 36.331\[10\]) via SRB1:

4\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCond* as a *measId* in the *VarMeasConfig*
associated with the SCG *measConfig*;

3\> else:

4\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCond* as a *measId* in the *VarMeasConfig*
associated with the MCG *measConfig*;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig* indicated in the *condExecutionCond* or
*condExecutionCondSCG* associated to *condReconfigId:*

3\> if the *condEventId* is associated with *condEventT1*, and if the
entry condition applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell; or

3\> if the *condEventId* is associated with *condEventD1*, and if the
entry conditions applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell during
the corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*; or

3\> if the *condEventId* is associated with *condEventA3*, *condEventA4*
or *condEventA5*, and if the entry condition(s) applicable for this
event associated with the *condReconfigId*, i.e. the event corresponding
with the *condEventId(s)* of the corresponding *condTriggerConfig*
within *VarConditionalReconfig*, is fulfilled for the applicable cells
for all measurements after layer 3 filtering taken during the
corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*:

4\> consider the event associated to that *measId* to be fulfilled;

3\> if the *measId* for this event associated with the *condReconfigId*
has been modified; or

3\> if the *condEventId* is associated with *condEventT1*, and if the
leaving condition applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell; or

3\> if the *condEventId* is associated with *condEventD1*, and if the
leaving condition(s) applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell during
the corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*; or

3\> if the *condEventId* is associated with *condEventA3*, *condEventA4*
or *condEventA5*, and if the leaving condition(s) applicable for this
event associated with the *condReconfigId*, i.e. the event corresponding
with the *condEventId(s)* of the corresponding *condTriggerConfig*
within *VarConditionalReconfig*, is fulfilled for the applicable cells
for all measurements after layer 3 filtering taken during the
corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*:

4\> consider the event associated to that *measId* to be not fulfilled;

2\> if event(s) associated to all *measId*(s) within *condTriggerConfig*
for the applicable cell are fulfilled:

3\> consider the applicable cell, associated to that *condReconfigId*,
as a triggered cell;

3\> initiate the conditional reconfiguration execution, as specified in
5.3.5.13.5;

NOTE 1: Up to 2 *MeasId* can be configured for each *condReconfigId.*
The conditional reconfiguration event of the 2 *MeasId* may have the
same or different event conditions, triggering quantity, time to
trigger, and triggering threshold.

NOTE 2: Void.

\[TS 38.331, Clause 5.5.4.16\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition T1-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition T1-2, as specified below, is fulfilled;

Inequality T1-1 (Entering condition)

$$Mt > Th\text{res}h1$$

Inequality T1-2 (Leaving condition)

$$Mt > Th\text{res}h1 + Duration$$

The variables in the formula are defined as follows:

***Mt*** is the time measured at UE.

***Thresh1*** is the threshold parameter for this event (i.e.
*t1-Threshold* as defined within *reportConfigNR* for this event).

***Duration*** is the duration parameter for this event (i.e. *duration*
as defined within *reportConfigNR* for this event).

***Mt*** is expressed in *ms*.

***Thresh1*** is expressed in the same unit as ***Mt***.

***Duration*** is expressed in the same unit as ***Mt***.

##### 8.1.4.4.6.3 Test description {#test-description-97 .H6}

##### 8.1.4.4.6.3.1 Pre-test conditions {#pre-test-conditions-97 .H6}

##### System Simulator: {#system-simulator-64 .H6}

\- 3 NR cells: NR Cell 1, NR Cell 2 and NR Cell 4 as specified in TS
38.508-1 \[4\] Table 4.4.2.1

\- System information combination NR-29 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-61 .H6}

\- The pre-configured UE location is defined in TS 38.508-1 \[4\] Clause
4.5C.

##### Preamble: {#preamble-62 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.4.4.6.3.2 Test procedure sequence {#test-procedure-sequence-98 .H6}

Table 8.1.4.4.6.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 0         | The SS    | \<\--     | 5GMM:     | \-      | \- |
|           | transmits |           | CONF      |         |    |
|           | a         |           | IGURATION |         |    |
|           | CONF      |           | UPDATE    |         |    |
|           | IGURATION |           | COMMAND   |         |    |
|           |           |           |           |         |    |
|           | UPDATE    |           |           |         |    |
|           | COMMAND   |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           |           |           |           |         |    |
|           | NITZ      |           |           |         |    |
|           | inf       |           |           |         |    |
|           | ormation. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | R         |         |    |
|           | an        |           | RCReconfi |         |    |
|           | *R        |           | guration* |         |    |
|           | RCReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | message   |           |           |         |    |
|           | *         |           |           |         |    |
|           | including |           |           |         |    |
|           | Me        |           |           |         |    |
|           | asConfig* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *         |           |           |         |    |
|           | Condition |           |           |         |    |
|           | alReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | to set NR |           |           |         |    |
|           | Cell 2    |           |           |         |    |
|           | and NR    |           |           |         |    |
|           | Cell 4 as |           |           |         |    |
|           | target    |           |           |         |    |
|           | candidate |           |           |         |    |
|           | cells and |           |           |         |    |
|           | configure |           |           |         |    |
|           | condEvent |           |           |         |    |
|           | T1 as     |           |           |         |    |
|           | trigger   |           |           |         |    |
|           | event in  |           |           |         |    |
|           | NR cell   |           |           |         |    |
|           | 1.        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2A        | The SS    | \-        | *-*       | \-      | \- |
|           | co        |           |           |         |    |
|           | nfigures: |           |           |         |    |
|           |           |           |           |         |    |
|           | \- NR     |           |           |         |    |
|           | Cell 1 as |           |           |         |    |
|           | \"Serving |           |           |         |    |
|           | cell\"    |           |           |         |    |
|           |           |           |           |         |    |
|           | \- NR     |           |           |         |    |
|           | Cell 2 as |           |           |         |    |
|           | \"Serving |           |           |         |    |
|           | cell\"    |           |           |         |    |
|           |           |           |           |         |    |
|           | \- NR     |           |           |         |    |
|           | Cell 4 as |           |           |         |    |
|           | \"Non     |           |           |         |    |
|           | -suitable |           |           |         |    |
|           | \"off\"   |           |           |         |    |
|           | cell\"    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | transmits |           | RRCReconf |         |    |
|           | an        |           | iguration |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCReconf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | Check:    | \--\>     | (PRACH    | 1       | F  |
|           | Does the  |           | Preamble) |         |    |
|           | UE        |           |           |         |    |
|           | initiate  |           |           |         |    |
|           | a random  |           |           |         |    |
|           | access    |           |           |         |    |
|           | procedure |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | Preamble  |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | Cell 2    |           |           |         |    |
|           | within    |           |           |         |    |
|           | 10s?      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | Void      | \-        | *-*       | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | Check:    | \--\>     | (PRACH    | 2       | P  |
|           | Does the  |           | Preamble) |         |    |
|           | UE        |           |           |         |    |
|           | initiate  |           |           |         |    |
|           | a random  |           |           |         |    |
|           | access    |           |           |         |    |
|           | procedure |           |           |         |    |
|           | by        |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | Preamble  |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | Cell 2    |           |           |         |    |
|           | within    |           |           |         |    |
|           | 10s?      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | The SS    | \<\--     | Random    | \-      | \- |
|           | transmits |           | Access    |         |    |
|           | Random    |           | Response  |         |    |
|           | Access    |           |           |         |    |
|           | Response. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | transmits |           | RRCReconf |         |    |
|           | *         |           | iguration |         |    |
|           | RRCReconf |           | Complete* |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | Cell 2.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | Check:    | \-        | *-*       | 2       | \- |
|           | Does the  |           |           |         |    |
|           | test      |           |           |         |    |
|           | result of |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.9.1-1   |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | UE is     |           |           |         |    |
|           | capable   |           |           |         |    |
|           | of        |           |           |         |    |
|           | e         |           |           |         |    |
|           | xchanging |           |           |         |    |
|           | IP data   |           |           |         |    |
|           | on DRB1   |           |           |         |    |
|           | and NR    |           |           |         |    |
|           | Cell 2?   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8A        | The SS    | \-        | *-*       | \-      | \- |
|           | co        |           |           |         |    |
|           | nfigures: |           |           |         |    |
|           |           |           |           |         |    |
|           | \- NR     |           |           |         |    |
|           | Cell 1 as |           |           |         |    |
|           | \"Non     |           |           |         |    |
|           | -suitable |           |           |         |    |
|           | \"off\"   |           |           |         |    |
|           | cell\"    |           |           |         |    |
|           |           |           |           |         |    |
|           | \- NR     |           |           |         |    |
|           | Cell 2 as |           |           |         |    |
|           | \"Serving |           |           |         |    |
|           | cell\"    |           |           |         |    |
|           |           |           |           |         |    |
|           | \- NR     |           |           |         |    |
|           | Cell 4 as |           |           |         |    |
|           | \"Serving |           |           |         |    |
|           | cell\"    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | Void      | \-        | *-*       | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | Check:    | \--\>     | (PRACH    | 3       | F  |
|           | Does the  |           | Preamble) |         |    |
|           | UE        |           |           |         |    |
|           | initiate  |           |           |         |    |
|           | a random  |           |           |         |    |
|           | access    |           |           |         |    |
|           | procedure |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | Preamble  |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | Cell 4    |           |           |         |    |
|           | within    |           |           |         |    |
|           | 10s?      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| Void      |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 2:   |           |           |           |         |    |
| Void      |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.4.4.6.3.3 Specific message contents {#specific-message-contents-89 .H6}

Table 8.1.4.4.6.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.4.4.6.3.2-1)

  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                        
  Information Element                                                                  Value/remark                 Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                             
  measConfig                                                                           MeasConfig                   Table 8.1.4.4.6.3.3-6   
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.4.4.6.3.3-2   
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------

Table 8.1.4.4.6.3.3-2: ConditionalReconfiguration (Table
8.1.4.4.6.3.3-1)

  ---------------------------------------------------- -------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                      
  Information Element                                  Value/remark               Comment                 Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                           
  condReconfigToRemoveList-r16                         Not present                                        
  condReconfigToAddModList-r16                         CondReconfigToAddModList   Table 8.1.4.4.6.3.3-3   
  }                                                                                                       
  ---------------------------------------------------- -------------------------- ----------------------- -----------

Table 8.1.4.4.6.3.3-3: CondReconfigToAddModList (Table 8.1.4.4.6.3.3-2)

  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                       
  Information Element                                                                                         Value/remark                                         Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   2 entries                                                                    
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                         entry 1                 
  condReconfigId-r16                                                                                          1                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR cell 2   Table 8.1.4.4.6.3.3-4   
  }                                                                                                                                                                                        
  CondReconfigToAddMod-r16\[2\] SEQUENCE {                                                                                                                         entry 2                 
  condReconfigId-r16                                                                                          2                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR cell 4   Table 8.1.4.4.6.3.3-4   
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------

Table 8.1.4.4.6.3.3-4: RRCReconfiguration-HO (Table 8.1.4.4.6.3.3-3)

  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                           
  Information Element                                                                    Value/remark                                    Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                                  
  nonCriticalExtension SEQUENCE{                                                                                                                                 
  masterCellGroup                                                                        CellGroupConfig with condition PCI\_NR cell 2   Table 8.1.4.4.6.3.3-5   HO\_NR cell 2
                                                                                         CellGroupConfig with condition PCI\_NR cell 4   Table 8.1.4.4.6.3.3-5   HO\_NR cell 4
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------

Table 8.1.4.4.6.3.3-5: *CellGroupConfig* (Table 8.1.4.4.6.3.3-4)

  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 2             PCI\_NR cell 2
                                                                                             Physical Cell Identity of NR Cell 4             PCI\_NR Cell 4
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------

Table 8.1.4.4.6.3.3-6: *MeasConfig* (Table 8.1.4.4.6.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                 
  Information Element                                                                        Value/remark                   Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                         
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                 
  measObjectId                                                                               1                                                      
  measObject CHOICE {                                                                                                                               
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.4.4.6.3.3-7   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  reportConfigId                                                                             1                                                      
  reportConfig CHOICE {                                                                                                                             
  reportConfigNR                                                                             *ReportConfigNR-condEventT1*   Table 8.1.4.4.6.3.3-8   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                 
  measId                                                                                     1                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             1                                                      
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------

Table 8.1.4.4.6.3.3-7: *MeasObjectNR* (Table 8.1.4.4.6.3.3-6)

  --------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-76                                                  
  Information Element                                 Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                         
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                     Not present                                    
  nrofSS-BlocksToAverage                              Not present                                    
  }                                                                                                  
  --------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.4.4.6.3.3-8: *ReportConfigNR-condEventT1* (Table
8.1.4.4.6.3.3-6)

  Derivation Path: TS 38.508-1\[4\] Table 4.6.63-142                                                                                                                                                                                                                                                
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ------------------------- ---------------
  **Information Element**                                                                                                                                                                                                                              **Value/remark**   **Comment**               **Condition**
  ReportConfigNR ::= SEQUENCE {                                                                                                                                                                                                                                                                     
  reportType CHOICE {                                                                                                                                                                                                                                                                               
  condTriggerConfig-r16 SEQUENCE {                                                                                                                                                                                                                                                                  
  condEventId CHOICE {                                                                                                                                                                                                                                                                              
  condEventT1-r17 SEQUENCE {                                                                                                                                                                                                                                                                        
  t1-Threshold-r17                                                                                                                                                                                                                                     426019194400       31-12-2034 13:39:04 UTC   
  duration-r17                                                                                                                                                                                                                                         300                30s                       
  }                                                                                                                                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                                 
  Note 1: It is 2,208,988,800 seconds from 01-01-1900 00:00:00 to 01:01-1970 00:00:00. The Unix timestamp of 31-12-2034 13:39:04 is 2,051,203,144. So, the total seconds is 4,260,191,944 since 00:00:00 on Gregorian calendar date 1 January, 1900.                                                

Table 8.1.4.4.6.3.3-9: CONFIGURATION UPDATE COMMAND (step 0, Table
8.1.4.4.6.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.7.1-19  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Full name for   | \"              | \"Full          |           |
| network         | C63A9BED0CB7CB3 | Name12345678\", |           |
|                 | 1D98C56B3DD70\" | Note 1          |           |
|                 | O               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Short name for  | \"5             | \"SName123\",   |           |
| network         | 367B85D8EC966\" | Note 1          |           |
|                 | O               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Local time zone | \"00\" O        | \"GMT\", Note   |           |
|                 |                 | 1, Note 2       |           |
+-----------------+-----------------+-----------------+-----------+
| Universal time  | \"4             | \"2034, 31      |           |
| and local time  | 3211331832500\" | December        |           |
| zone            | O               | 13:38:52 GMT\", |           |
|                 |                 | Note 1, Note 2  |           |
+-----------------+-----------------+-----------------+-----------+
| Network         | \"00\" O        | \"no adjustment |           |
| daylight saving |                 | for Daylight    |           |
| time            |                 | Saving Time\",  |           |
|                 |                 | Note 1          |           |
+-----------------+-----------------+-----------------+-----------+
| Note 1: Hard    |                 |                 |           |
| coded values    |                 |                 |           |
| have been       |                 |                 |           |
| chosen to allow |                 |                 |           |
| for             |                 |                 |           |
| consis          |                 |                 |           |
| tent/comparable |                 |                 |           |
| SS behaviour.   |                 |                 |           |
|                 |                 |                 |           |
| Note 2:         |                 |                 |           |
| Daylight Saving |                 |                 |           |
| Time is         |                 |                 |           |
| included in the |                 |                 |           |
| Local Time      |                 |                 |           |
| Zone.           |                 |                 |           |
|                 |                 |                 |           |
| Note 3: Void.   |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

##### 8.1.4.4.7 NR NTN / Conditional handover / Success / CondEventD1

##### 8.1.4.4.7.1 Test Purpose (TP) {#test-purpose-tp-98 .H6}

##### (1) {#section-169 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting location based
conditional handover and receiving an *RRCReconfiguration* message
including *ConditionalReconfiguration* }

**ensure that** {

**when** { conditional handover execution condition is not satisfied }
**then** { UE maintains connection with source gNB and starts evaluating
the CHO execution conditions for the candidate cell(s) }

}

##### (2) {#section-170 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting location based
conditional handover }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message including
*ConditionalReconfiguration* and condEvent D1 is configured as
conditional handover trigger event } **then** { UE starts evaluating the
conditional handover execution condition and performs conditional
handover to the neighbour cell triggered in conditional configuration
execution }

}

##### (3) {#section-171 .H6}

**with** { UE in NR RRC\_CONNECTED state and supporting location based
conditional handover }

**ensure that** {

**when** { UE performs conditional handover procedure successfully }
**then** { UE releases stored CHO configurations }

}

##### 8.1.4.4.7.2 Conformance requirements {#conformance-requirements-98 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.300 clauses 9.2.3.4.1 and 9.2.3.4.2, and TS 38.331
clauses 5.3.5.1, 5.3.5.13.1, 5.3.5.13.4. Unless otherwise stated these
are Rel-17 requirements.

\[TS 38.300, clause 9.2.3.4.1\]

A Conditional Handover (CHO) is defined as a handover that is executed
by the UE when one or more handover execution conditions are met. The UE
starts evaluating the execution condition(s) upon receiving the CHO
configuration, and stops evaluating the execution condition(s) once a
handover is executed.

The following principles apply to CHO:

\- The CHO configuration contains the configuration of CHO candidate
cell(s) generated by the candidate gNB(s) and execution condition(s)
generated by the source gNB.

\- An execution condition may consist of one or two trigger condition(s)
(CHO events A3/A5, as defined in \[12\]). Only single RS type is
supported and at most two different trigger quantities (e.g. RSRP and
RSRQ, RSRP and SINR, etc.) can be configured simultaneously for the
evalution of CHO execution condition of a single candidate cell.

\- Before any CHO execution condition is satisfied, upon reception of HO
command (without CHO configuration), the UE executes the HO procedure as
described in clause 9.2.3.2, regardless of any previously received CHO
configuration.

\- While executing CHO, i.e. from the time when the UE starts
synchronization with target cell, UE does not monitor source cell.

CHO is also supported for the IAB-MT in context of intra- and
inter-donor IAB-node migration and BH RLF recovery.

CHO is not supported for NG-C based handover in this release of the
specification.

\[TS 38.331, clause 5.3.5.1\]

Figure 5.3.5.1-1: RRC reconfiguration, successful

Figure 5.3.5.1-2: RRC reconfiguration, failure

The purpose of this procedure is to modify an RRC connection, e.g. to
establish/modify/release RBs, to perform reconfiguration with sync, to
setup/modify/release measurements, to add/modify/release SCells and cell
groups, to add/modify/release conditional handover configuration, to
add/modify/release conditional PSCell change configuration. As part of
the procedure, NAS dedicated information may be transferred from the
Network to the UE.

\[TS 38.331, clause 5.3.5.13.1\]

The network configures the UE with one or more candidate target SpCells
in the conditional reconfiguration. The UE evaluates the condition of
each configured candidate target SpCell. The UE applies the conditional
reconfiguration associated with one of the target SpCells which fulfils
associated execution condition. The network provides the configuration
parameters for the target SpCell in the *ConditionalReconfiguration* IE.

The UE performs the following actions based on a received
*ConditionalReconfiguration* IE:

1\> if the *ConditionalReconfiguration* contains the
*condReconfigToRemoveList*:

2\> perform conditional reconfiguration removal procedure as specified
in 5.3.5.13.2;

1\> if the *ConditionalReconfiguration* contains the
*condReconfigToAddModList*:

2\> perform conditional reconfiguration addition/modification as
specified in 5.3.5.13.3;

\[TS 38.331, clause 5.3.5.13.4\]

The UE shall:

1\> for each *condReconfigId* within the *VarConditionalReconfig*:

2\> if the *RRCReconfiguration* within *condRRCReconfig* includes the
*masterCellGroup* including the *reconfigurationWithSync*:

3\> consider the cell which has a physical cell identity matching the
value indicated in the *ServingCellConfigCommon* included in the
*reconfigurationWithSync* within the *masterCellGroup* in the received
*condRRCReconfig* to be applicable cell;

2\> else if the *RRCReconfiguration* within *condRRCReconfig* includes
the *secondaryCellGroup* including the *reconfigurationWithSync*:

3\> consider the cell which has a physical cell identity matching the
value indicated in the *ServingCellConfigCommon* included in the
*reconfigurationWithSync* within the *secondaryCellGroup* within the
received *condRRCReconfig* to be applicable cell;

2\> if *condExecutionCondSCG* is configured:

3\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCondSCG* as a *measId* in the *VarMeasConfig*
associated with the SCG *measConfig*;

2\> if *condExecutionCond* is configured:

3\> if it is configured via SRB3 or configured within *nr-SCG* or within
*nr-SecondaryCellGroupConfig* (specified in TS 36.331\[10\]) via SRB1:

4\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCond* as a *measId* in the *VarMeasConfig*
associated with the SCG *measConfig*;

3\> else:

4\> in the remainder of the procedure, consider each *measId* indicated
in the *condExecutionCond* as a *measId* in the *VarMeasConfig*
associated with the MCG *measConfig*;

2\> for each *measId* included in the *measIdList* within
*VarMeasConfig* indicated in the *condExecutionCond* or
*condExecutionCondSCG* associated to *condReconfigId:*

3\> if the *condEventId* is associated with *condEventT1*, and if the
entry condition applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell; or

3\> if the *condEventId* is associated with *condEventD1*, and if the
entry conditions applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell during
the corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*; or

3\> if the *condEventId* is associated with *condEventA3*, *condEventA4*
or *condEventA5*, and if the entry condition(s) applicable for this
event associated with the *condReconfigId*, i.e. the event corresponding
with the *condEventId(s)* of the corresponding *condTriggerConfig*
within *VarConditionalReconfig*, is fulfilled for the applicable cells
for all measurements after layer 3 filtering taken during the
corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*:

4\> consider the event associated to that *measId* to be fulfilled;

3\> if the *measId* for this event associated with the *condReconfigId*
has been modified; or

3\> if the *condEventId* is associated with *condEventT1*, and if the
leaving condition applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell; or

3\> if the *condEventId* is associated with *condEventD1*, and if the
leaving condition(s) applicable for this event associated with the
*condReconfigId*, i.e. the event corresponding with the *condEventId(s)*
of the corresponding *condTriggerConfig* within
*VarConditionalReconfig*, is fulfilled for the applicable cell during
the corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*; or

3\> if the *condEventId* is associated with *condEventA3*, *condEventA4*
or *condEventA5*, and if the leaving condition(s) applicable for this
event associated with the *condReconfigId*, i.e. the event corresponding
with the *condEventId(s)* of the corresponding *condTriggerConfig*
within *VarConditionalReconfig*, is fulfilled for the applicable cells
for all measurements after layer 3 filtering taken during the
corresponding *timeToTrigger* defined for this event within the
*VarConditionalReconfig*:

4\> consider the event associated to that *measId* to be not fulfilled;

2\> if event(s) associated to all *measId*(s) within *condTriggerConfig*
for the applicable cell are fulfilled:

3\> consider the applicable cell, associated to that *condReconfigId*,
as a triggered cell;

3\> initiate the conditional reconfiguration execution, as specified in
5.3.5.13.5;

NOTE 1: Up to 2 *MeasId* can be configured for each *condReconfigId.*
The conditional reconfiguration event of the 2 *MeasId* may have the
same or different event conditions, triggering quantity, time to
trigger, and triggering threshold.

NOTE 2: Void.

\[TS 38.331, Clause 5.5.4.15\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
both condition D1-1 and condition D1-2, as specified below, are
fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition D1-3 or condition D1-4, i.e. at least one of the two, as
specified below, are fulfilled;

Inequality D1-1 (Entering condition 1)

$$Ml1 - Hys > Th\text{res}h1$$

Inequality D1-2 (Entering condition 2)

$$Ml2 + Hys < Th\text{res}h2$$

Inequality D1-3 (Leaving condition 1)

$$Ml1 + Hys < Th\text{res}h1$$

Inequality D1-4 (Leaving condition 2)

$$Ml2 - Hys > Th\text{res}h2$$

The variables in the formula are defined as follows:

***Ml1*** is the distance between UE and a reference location for this
event (i.e. *referenceLocation1* as defined within *reportConfigNR* for
this event), not taking into account any offsets.

***Ml2*** is the distance between UE and a reference location for this
event (i.e. *referenceLocation2* as defined within *reportConfigNR* for
this event), not taking into account any offsets.

***Hys*** is the hysteresis parameter for this event (i.e.
*hysteresisLocation* as defined within *reportConfigNR* for this event).

***Thresh1*** is the threshold for this event defined as a distance,
configured with parameter *distanceThreshFromReference1,* from a
reference location configured with parameter *referenceLocation1* within
*reportConfigNR* for this event.

***Thresh2*** is the threshold for this event defined as a distance,
configured with parameter *distanceThreshFromReference2,* from a
reference location configured with parameter *referenceLocation2* within
*reportConfigNR* for this event.

***Ml1*** is expressed in meters.

***Ml2*** is expressed in the same unit as ***Ml1***.

***Hys*** is expressed in the same unit as ***Ml1.***

***Thresh1*** is expressed in the same unit as ***Ml1***.

***Thresh2*** is expressed in the same unit as ***Ml1***.

NOTE: The definition of Event D1 also applies to CondEvent D1.

##### 8.1.4.4.7.3 Test description {#test-description-98 .H6}

##### 8.1.4.4.7.3.1 Pre-test conditions {#pre-test-conditions-98 .H6}

##### System Simulator: {#system-simulator-65 .H6}

3 NR cells: NR Cell 1, NR Cell2, and NR Cell 4 as specified in TS
38.508-1 \[4\] Table 4.4.2.1.

System information combination NR-29 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-62 .H6}

\- The pre-configured UE location is defined in TS 38.508-1 \[4\] Clause
4.5C.

##### Preamble: {#preamble-63 .H6}

> \- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
> NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table
> 4.4A.2-3.
>
> \- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*)
> with UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\],
> clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.4.4.7.3.2 Test procedure sequence {#test-procedure-sequence-99 .H6}

Table 8.1.4.4.7.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | R         |         |    |
|           | an        |           | RCReconfi |         |    |
|           | *R        |           | guration* |         |    |
|           | RCReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | message   |           |           |         |    |
|           | *         |           |           |         |    |
|           | including |           |           |         |    |
|           | Me        |           |           |         |    |
|           | asConfig* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *         |           |           |         |    |
|           | Condition |           |           |         |    |
|           | alReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | to set NR |           |           |         |    |
|           | Cell 2    |           |           |         |    |
|           | and NR    |           |           |         |    |
|           | Cell 4 as |           |           |         |    |
|           | target    |           |           |         |    |
|           | candidate |           |           |         |    |
|           | cell and  |           |           |         |    |
|           | configure |           |           |         |    |
|           | condEvent |           |           |         |    |
|           | D1 as     |           |           |         |    |
|           | trigger   |           |           |         |    |
|           | event on  |           |           |         |    |
|           | NR cell   |           |           |         |    |
|           | 1.        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | transmits |           | RRCReconf |         |    |
|           | an        |           | iguration |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCReconf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | Check:    | \--\>     | (PRACH    | 1       | F  |
|           | Does the  |           | Preamble) |         |    |
|           | UE        |           |           |         |    |
|           | initiate  |           |           |         |    |
|           | a random  |           |           |         |    |
|           | access    |           |           |         |    |
|           | procedure |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | Preamble  |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 2    |           |           |         |    |
|           | within    |           |           |         |    |
|           | 10s?      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The SS    | \<\--     | UPDATE UE | \-      | \- |
|           | transmits |           | LOCATION  |         |    |
|           | Update UE |           | IN        |         |    |
|           | location  |           | FORMATION |         |    |
|           | in        |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | (Note 1). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | Check:    | \--\>     | (PRACH    | 2       | P  |
|           | Does the  |           | Preamble) |         |    |
|           | UE        |           |           |         |    |
|           | initiate  |           |           |         |    |
|           | a random  |           |           |         |    |
|           | access    |           |           |         |    |
|           | procedure |           |           |         |    |
|           | by        |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | Preamble  |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | Cell 2    |           |           |         |    |
|           | within    |           |           |         |    |
|           | 10s?      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | The SS    | \<\--     | Random    | \-      | \- |
|           | transmits |           | Access    |         |    |
|           | Random    |           | Response  |         |    |
|           | Access    |           |           |         |    |
|           | Response. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | transmits |           | RRCReconf |         |    |
|           | *         |           | iguration |         |    |
|           | RRCReconf |           | Complete* |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | Cell 2.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | Check:    | \-        | *-*       | 2       | \- |
|           | Does the  |           |           |         |    |
|           | test      |           |           |         |    |
|           | result of |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.9.1-1   |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | UE is     |           |           |         |    |
|           | capable   |           |           |         |    |
|           | of        |           |           |         |    |
|           | e         |           |           |         |    |
|           | xchanging |           |           |         |    |
|           | IP data   |           |           |         |    |
|           | on DRB1   |           |           |         |    |
|           | and NR    |           |           |         |    |
|           | Cell 2?   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | The SS    | \<\--     | UPDATE UE | \-      | \- |
|           | transmits |           | LOCATION  |         |    |
|           | Update UE |           | IN        |         |    |
|           | location  |           | FORMATION |         |    |
|           | in        |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | (Note 2). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | Check:    | \--\>     | (PRACH    | 3       | F  |
|           | Does the  |           | Preamble) |         |    |
|           | UE        |           |           |         |    |
|           | initiate  |           |           |         |    |
|           | a random  |           |           |         |    |
|           | access    |           |           |         |    |
|           | procedure |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | Preamble  |           |           |         |    |
|           | in NR     |           |           |         |    |
|           | Cell 4    |           |           |         |    |
|           | within    |           |           |         |    |
|           | 10s?      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| UE        |           |           |           |         |    |
| location  |           |           |           |         |    |
| in        |           |           |           |         |    |
| formation |           |           |           |         |    |
| is        |           |           |           |         |    |
| c         |           |           |           |         |    |
| onfigured |           |           |           |         |    |
| such that |           |           |           |         |    |
| the       |           |           |           |         |    |
| co        |           |           |           |         |    |
| nditional |           |           |           |         |    |
| event D1  |           |           |           |         |    |
| is        |           |           |           |         |    |
| satisfied |           |           |           |         |    |
| for NR    |           |           |           |         |    |
| Cell 2.   |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 2:   |           |           |           |         |    |
| UE        |           |           |           |         |    |
| location  |           |           |           |         |    |
| in        |           |           |           |         |    |
| formation |           |           |           |         |    |
| is        |           |           |           |         |    |
| c         |           |           |           |         |    |
| onfigured |           |           |           |         |    |
| such that |           |           |           |         |    |
| the       |           |           |           |         |    |
| co        |           |           |           |         |    |
| nditional |           |           |           |         |    |
| event D1  |           |           |           |         |    |
| is        |           |           |           |         |    |
| satisfied |           |           |           |         |    |
| for NR    |           |           |           |         |    |
| Cell 4.   |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.4.4.7.3.3 Specific message contents {#specific-message-contents-90 .H6}

Table 8.1.4.4.7.3.3-1: *RRCReconfiguration* (Step 1, Table
8.1.4.4.7.3.2-1)

  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                        
  Information Element                                                                  Value/remark                 Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                             
  measConfig                                                                           MeasConfig                   Table 8.1.4.4.7.3.3-6   
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                           
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.4.4.7.3.3-2   
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ------------------------------------------------------------------------------------ ---------------------------- ----------------------- -----------

Table 8.1.4.4.7.3.3-2: *ConditionalReconfiguration* (Table
8.1.4.4.7.3.3-1)

  ---------------------------------------------------- -------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                      
  Information Element                                  Value/remark               Comment                 Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                           
  condReconfigToAddModList-r16                         CondReconfigToAddModList   Table 8.1.4.4.7.3.3-3   
  }                                                                                                       
  ---------------------------------------------------- -------------------------- ----------------------- -----------

Table 8.1.4.4.7.3.3-3: *CondReconfigToAddModList* (Table
8.1.4.4.7.3.3-2)

  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                                                       
  Information Element                                                                                         Value/remark                                         Comment                 Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   2 entries                                                                    
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                                                         entry 1                 
  condReconfigId-r16                                                                                          1                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR cell 2   Table 8.1.4.4.7.3.3-4   
  }                                                                                                                                                                                        
  CondReconfigToAddMod-r16\[2\] SEQUENCE {                                                                                                                         entry 2                 
  condReconfigId-r16                                                                                          2                                                                            
  condExecutionCond-r16 SEQUENCE {                                                                                                                                                         
  MeasId \[1\]                                                                                                1                                                                            
  }                                                                                                                                                                                        
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO with condition HO\_NR cell 4   Table 8.1.4.4.7.3.3-4   
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  ----------------------------------------------------------------------------------------------------------- ---------------------------------------------------- ----------------------- -----------

Table 8.1.4.4.7.3.3-4: RRCReconfiguration-HO (Table 8.1.4.4.7.3.3-3)

  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                                                           
  Information Element                                                                    Value/remark                                    Comment                 Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                                  
  nonCriticalExtension SEQUENCE{                                                                                                                                 
  masterCellGroup                                                                        CellGroupConfig with condition PCI\_NR cell 2   Table 8.1.4.4.7.3.3-5   HO\_NR cell 2
                                                                                         CellGroupConfig with condition PCI\_NR cell 4   Table 8.1.4.4.7.3.3-5   HO\_NR cell 4
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  -------------------------------------------------------------------------------------- ----------------------------------------------- ----------------------- ---------------

Table 8.1.4.4.7.3.3-5: *CellGroupConfig* (Table 8.1.4.4.7.3.3-4)

  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 2             PCI\_NR cell 2
                                                                                             Physical Cell Identity of NR Cell 4             PCI\_NR Cell 4
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- ----------------

Table 8.1.4.4.7.3.3-6: *MeasConfig* (Table 8.1.4.4.7.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                 
  Information Element                                                                        Value/remark                   Comment                 Condition
  MeasConfig ::= SEQUENCE {                                                                                                                         
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                 
  measObjectId                                                                               1                                                      
  measObject CHOICE {                                                                                                                               
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.4.4.7.3.3-7   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                 
  reportConfigId                                                                             1                                                      
  reportConfig CHOICE {                                                                                                                             
  reportConfigNR                                                                             *ReportConfigNR-condEventD1*   Table 8.1.4.4.7.3.3-8   
  }                                                                                                                                                 
  }                                                                                                                                                 
  }                                                                                                                                                 
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                 
  measId                                                                                     1                                                      
  measObjectId                                                                               1                                                      
  reportConfigId                                                                             1                                                      
  }                                                                                                                                                 
  }                                                                                                                                                 
  ------------------------------------------------------------------------------------------ ------------------------------ ----------------------- -----------

Table 8.1.4.4.7.3.3-7: *MeasObjectNR* (Table 8.1.4.4.7.3.3-6)

  --------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-76                                                                                                                                                                                                                                                                                       
  Information Element                                 Value/remark                                                                                                                                               Comment                                                                                                                  Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                                                                                                                                                                                                                             
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 1The SSB of NR cell 1, NR Cell 2 and NR cell 4 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   The SSB of NR cell 1, NR Cell 2 and NR cell 4 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                     Not present                                                                                                                                                                                                                                                                         
  nrofSS-BlocksToAverage                              Not present                                                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                                                                                                                       
  --------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------ -----------

Table 8.1.4.4.7.3.3-8: *ReportConfigNR-condEventD1* (Table
8.1.4.4.7.3.3-6)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| Table 4.6.3-142 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConfigNR  |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportType      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| condTr          |                 |                 |           |
| iggerConfig-r16 |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| condEventId     |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| condEventD1-r17 |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| di              | 2400            | threshold 1:    |           |
| stanceThreshFro |                 |                 |           |
| mReference1-r17 |                 | 120 km          |           |
+-----------------+-----------------+-----------------+-----------+
| di              | 2400            | threshold 2:    |           |
| stanceThreshFro |                 |                 |           |
| mReference2-r17 |                 | 120 km          |           |
+-----------------+-----------------+-----------------+-----------+
| referen         | \'2240 DC56     | reference       |           |
| ceLocation1-r17 | 7176\'H         | location 1:     |           |
|                 |                 |                 |           |
|                 |                 | \- Latitude:    |           |
|                 |                 | 24.08439333     |           |
|                 |                 |                 |           |
|                 |                 | \- Longitude:   |           |
|                 |                 | 121.56076999    |           |
+-----------------+-----------------+-----------------+-----------+
| referen         | \'2519 0956     | reference       |           |
| ceLocation2-r17 | 7176\'H         | location 2:     |           |
|                 |                 |                 |           |
|                 |                 | \- Latitude:    |           |
|                 |                 | 26.08439333     |           |
|                 |                 |                 |           |
|                 |                 | \- Longitude:   |           |
|                 |                 | 121.56076999    |           |
+-----------------+-----------------+-----------------+-----------+
| hystere         | 0               |                 |           |
| sisLocation-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ti              | ms2560          |                 |           |
| meToTrigger-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.4.4.7.3.3-9: UPDATE UE LOCATION INFORMATION (Steps 4 and 9,
Table 8.1.4.4.7.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS 36.509 |                 |                 |           |
| \[8\] Table     |                 |                 |           |
| 6.12            |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ellipsoidPo     | \'2519 0956     | UE Location:    | Step 4    |
| intWithAltitude | 7176 0000\'H    |                 |           |
|                 |                 | \- Latitude:    |           |
|                 |                 | 26.08439333     |           |
|                 |                 |                 |           |
|                 |                 | \- Longitude:   |           |
|                 |                 | 121.56076999    |           |
|                 |                 |                 |           |
|                 |                 | \- Altitude: 0  |           |
+-----------------+-----------------+-----------------+-----------+
|                 | \'2240 DC56     | UE Location:    | Step 9    |
|                 | 7176 0000\'H    |                 |           |
|                 |                 | \- Latitude:    |           |
|                 |                 | 24.08439333     |           |
|                 |                 |                 |           |
|                 |                 | \- Longitude:   |           |
|                 |                 | 121.56076999    |           |
|                 |                 |                 |           |
|                 |                 | \- Altitude: 0  |           |
+-----------------+-----------------+-----------------+-----------+
| hor             | \'00 0000\'H    | Speed:          |           |
| izontalVelocity |                 |                 |           |
|                 |                 | 0 km/s          |           |
+-----------------+-----------------+-----------------+-----------+
| gnss-TOD-msec   | \'00 0000\'H    |                 |           |
+-----------------+-----------------+-----------------+-----------+
