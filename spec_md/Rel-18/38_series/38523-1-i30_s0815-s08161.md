### 8.1.5 RRC others

#### 8.1.5.1 UE capability transfer

##### 8.1.5.1.1 UE capability transfer / Success

##### 8.1.5.1.1.1 Test Purpose (TP) {#test-purpose-tp .H6}

##### (1) {#section .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an *UECapabilityEnquiry* message }

**then** { UE transmits an *UECapabilityInformation* message including
UE radio access capability information corresponding to the
*ue-CapabilityRequest* variable }

}

##### 8.1.5.1.1.2 Conformance requirements {#conformance-requirements .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clauses 5.6.1.3, 5.6.1.4, 5.7.7.2 and
5.7.7.3. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.6.1.3\]

The UE shall set the contents of *UECapabilityInformation* message as
follows:

1\> if the ue-CapabilityRAT-RequestList contains a
UE-CapabilityRAT-Request with rat-Type set to nr:

2\> include in the ue-CapabilityRAT-ContainerList a
UE-CapabilityRAT-Container of the type UE-NR-Capability and with the
rat-Type set to nr;

2\> include the supportedBandCombinationList, featureSets and
featureSetCombinations as specified in clause 5.6.1.4;

...

> 1\> submit the *UECapabilityInformation* message to lower layers for
> transmission, upon which the procedure ends.

\[TS 38.331, clause 5.6.1.4\]

The UE invokes the procedures in this clause if the NR or E-UTRA network
requests UE capabilities for *nr*, *eutra-nr* or *eutra*. This procedure
is invoked once per requested *rat-Type* (see clause 5.6.1.3 for
capability enquiry by the NR network; see TS 36.331 \[10\], clause
5.6.3.3 for capability enquiry by the E-UTRA network). The UE shall
ensure that the feature set IDs are consistent across feature sets,
feature set combinations and band combinations in all three UE
capability containers that the network queries with the same fields with
the same values, i.e. *UE-CapabilityRequestFilterNR* and fields in
*UECapabilityEnquiry* message (i.e. *requestedFreqBandsNR-MRDC,
requestedCapabilityNR* and *eutra-nr-only* flag) as defined in TS
36.331, where applicable.

NOTE 1: Capability enquiry without *frequencyBandListFilter* is not
supported.

\[TS 38.331, clause 5.7.7.2\]

A UE capable of UL RRC message segmentation in RRC\_CONNECTED will
initiate the procedure when the following conditions are met:

1\> if the RRC message segmentation is enabled based on the field
*rrc-SegAllowed* received, and

1\> if the encoded RRC message is larger than the maximum supported size
of a PDCP SDU specified in TS 38.323 \[5\];

Upon initiating the procedure, the UE shall:

1\> initiate transmission of the *ULDedicatedMessageSegment* message as
specified in 5.7.7.3;

\[TS 38.331, clause 5.7.7.3\]

The UE shall segment the encoded RRC PDU based on the maximum supported
size of a PDCP SDU specified in TS 38.323 \[5\]. UE shall minimize the
number of segments and set the contents of the
*ULDedicatedMessageSegment* messages as follows:

1\> F or each new UL DCCH message, set the *segmentNumber* to 0 for the
first message segment and increment the *segmentNumber* for each
subsequent RRC message segment;

1\> set *rrc-MessageSegmentContainer* to include the segment of the UL
DCCH message corresponding to the *segmentNumber*;

1\> if the segment included in the *rrc-MessageSegmentContainer* is the
last segment of the UL DCCH message:

2\> set the *rrc-MessageSegmentType* to lastSegment;

1\> else:

2\> set the *rrc-MessageSegmentType* to *notLastSegment*;

1\> submit all the *ULDedicatedMessageSegment* messages generated for
the segmented RRC message to lower layers for transmission in ascending
order based on the *segmentNumber*, upon which the procedure ends.

##### 8.1.5.1.1.3 Test Description {#test-description .H6}

##### 8.1.5.1.1.3.1 Pre-test conditions {#pre-test-conditions .H6}

##### System Simulator: {#system-simulator .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell.

##### UE: {#ue .H6}

\- None.

##### Preamble: {#preamble .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A on NR Cell 1.

##### 8.1.5.1.1.3.2 Test procedure sequence {#test-procedure-sequence .H6}

Table 8.1.5.1.1.3.2-1: Main behaviour

+-----+--------------+--------------+--------------+---------+----+
| St  | Procedure    | Message      | TP           | Verdict |    |
|     |              | Sequence     |              |         |    |
+=====+==============+==============+==============+=========+====+
|     |              | U - S        | Message      |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1   | The SS       | \<\--        | *UECapabi    | \-      | \- |
|     | transmits a  |              | lityEnquiry* |         |    |
|     | *UECapabi    |              |              |         |    |
|     | lityEnquiry* |              |              |         |    |
|     | message      |              |              |         |    |
|     | including    |              |              |         |    |
|     | *nr* and     |              |              |         |    |
|     | rrc-se       |              |              |         |    |
|     | gAllowed-r16 |              |              |         |    |
|     | set to       |              |              |         |    |
|     | enabled.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| \-  | EXCEPTION:   | \-           | *-*          | \-      | \- |
|     | The \"lower  |              |              |         |    |
|     | case         |              |              |         |    |
|     | letter\"     |              |              |         |    |
|     | identifies a |              |              |         |    |
|     | step         |              |              |         |    |
|     | sequence     |              |              |         |    |
|     | that takes   |              |              |         |    |
|     | place        |              |              |         |    |
|     | depending on |              |              |         |    |
|     | the size of  |              |              |         |    |
|     | UE           |              |              |         |    |
|     | capability   |              |              |         |    |
|     | message.     |              |              |         |    |
|     |              |              |              |         |    |
|     | IF           |              |              |         |    |
|     | pc\_NR\_UL\_ |              |              |         |    |
|     | Segmentation |              |              |         |    |
|     | and UE's     |              |              |         |    |
|     | encoded      |              |              |         |    |
|     | *            |              |              |         |    |
|     | UECapability |              |              |         |    |
|     | Information* |              |              |         |    |
|     | message \>=  |              |              |         |    |
|     | Max PDCP SDU |              |              |         |    |
|     | size then    |              |              |         |    |
|     | steps 2a1    |              |              |         |    |
|     | and 2a2 will |              |              |         |    |
|     | be performed |              |              |         |    |
|     | else step    |              |              |         |    |
|     | 2b1 will be  |              |              |         |    |
|     | performed.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| \-  | EXCEPTION:   | \-           | *-*          | \-      | \- |
|     | Step 2a1 is  |              |              |         |    |
|     | repeated a   |              |              |         |    |
|     | maximum of   |              |              |         |    |
|     | 16 times or  |              |              |         |    |
|     | till         |              |              |         |    |
|     | r            |              |              |         |    |
|     | rc-MessageSe |              |              |         |    |
|     | gmentType-16 |              |              |         |    |
|     | IE within    |              |              |         |    |
|     | the          |              |              |         |    |
|     | *Ul          |              |              |         |    |
|     | DedicatedMes |              |              |         |    |
|     | sageSegment* |              |              |         |    |
|     | message      |              |              |         |    |
|     | indicates    |              |              |         |    |
|     | rr           |              |              |         |    |
|     | c-MessageSeg |              |              |         |    |
|     | mentType-r16 |              |              |         |    |
|     | =            |              |              |         |    |
|     | lastSegment. |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2a1 | The UE sends | \--\>        | *UL          | \-      | \- |
|     | segments of  |              | DedicatedMes |         |    |
|     | *            |              | sageSegment* |         |    |
|     | UECapability |              |              |         |    |
|     | Information* |              |              |         |    |
|     | message      |              |              |         |    |
|     | contained    |              |              |         |    |
|     | within the   |              |              |         |    |
|     | rrc-Mes      |              |              |         |    |
|     | sageSegmentC |              |              |         |    |
|     | ontainer-r16 |              |              |         |    |
|     | IE of the    |              |              |         |    |
|     | *UL          |              |              |         |    |
|     | DedicatedMes |              |              |         |    |
|     | sageSegment* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2a2 | Check: Is    | \-           | *-*          | 1       | P  |
|     | the received |              |              |         |    |
|     | UE radio     |              |              |         |    |
|     | access       |              |              |         |    |
|     | capability   |              |              |         |    |
|     | information  |              |              |         |    |
|     | as per the   |              |              |         |    |
|     | ue-Capab     |              |              |         |    |
|     | ilityRequest |              |              |         |    |
|     | variable?    |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2b1 | Check: Does  | \--\>        | *            | 1       | P  |
|     | the UE       |              | UECapability |         |    |
|     | transmit a   |              | Information* |         |    |
|     | *            |              |              |         |    |
|     | UECapability |              |              |         |    |
|     | Information* |              |              |         |    |
|     | message      |              |              |         |    |
|     | including UE |              |              |         |    |
|     | radio access |              |              |         |    |
|     | capability   |              |              |         |    |
|     | information  |              |              |         |    |
|     | as per the   |              |              |         |    |
|     | ue-Capab     |              |              |         |    |
|     | ilityRequest |              |              |         |    |
|     | variable?    |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+

##### 8.1.5.1.1.3.3 Specific message contents {#specific-message-contents .H6}

Table 8.1.5.1.1.3.3-1: *UECapabilityEnquiry* (step 1, Table
8.1.5.1.1.3.2-1)

  ----------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-31                                                                                                                                                    
  Information Element                                                                                         Value/remark                                                                    Comment   Condition
  UECapabilityEnquiry ::= SEQUENCE {                                                                                                                                                                    
  rrc-TransactionIdentifier                                                                                   RRC-TransactionIdentifier                                                                 
  criticalExtensions CHOICE {                                                                                                                                                                           
  ueCapabilityEnquiry SEQUENCE {                                                                                                                                                                        
  ue-CapabilityRAT-RequestList SEQUENCE (SIZE (1.. maxRAT-CapabilityContainers)) OF CapabilityRAT-Request {   \-                                                                                        
  UE-CapabilityRAT-Request\[1\] SEQUENCE {                                                                                                                                                    entry 1   
  rat-Type                                                                                                    nr                                                                                        
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  lateNonCriticalExtension                                                                                    Not present                                                                               
  ue-CapabilityEnquiryExt                                                                                     OCTET STRING Containing UECapabilityEnquiry-v1560-IEs (Table 8.1.5.1.1.3.3-4)             
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  ----------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------- --------- -----------

Table 8.1.5.1.1.3.3-2: *UECapabilityInformation* (steps 2a2 and 2b1,
Table 8.1.5.1.1.3.2-1)

  ------------------------------------------------------------------------------------------------------------ --------------------------- ---------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32                                                                                                                                      
  Information Element                                                                                          Value/remark                Comment                                        Condition
  UECapabilityInformation ::= SEQUENCE {                                                                                                                                                  
  rrc-TransactionIdentifier                                                                                    RRC-TransactionIdentifier                                                  
  criticalExtensions CHOICE {                                                                                                                                                             
  ueCapabilityInformation SEQUENCE {                                                                                                                                                      
  ue-CapabilityRAT-ContainerList SEQUENCE (SIZE (0..maxRAT-CapabilityContainers)) OF CapabilityRAT-Request {                                                                              
  UE-CapabilityRAT-Request\[1\] SEQUENCE {                                                                                                 entry 1                                        
  rat-Type                                                                                                     nr                                                                         
  ueCapabilityRAT-Container                                                                                    UE-NR-Capability            Encoded as per TS 38.331 \[12\] clause 5.6.1   
  }                                                                                                                                                                                       
  }                                                                                                                                                                                       
  lateNonCriticalExtension                                                                                     Not checked                                                                
  nonCriticalExtension                                                                                         Not checked                                                                
  }                                                                                                                                                                                       
  }                                                                                                                                                                                       
  }                                                                                                                                                                                       
  ------------------------------------------------------------------------------------------------------------ --------------------------- ---------------------------------------------- -----------

Table 8.1.5.1.1.3.3-3: *UE-NR-Capability* (Table 8.1.5.1.1.3.3-2)

+----------------+----------------+----------------+----------------+
| Derivation     |                |                |                |
| Path: TS       |                |                |                |
| 38.331 \[12\], |                |                |                |
| clause 6.3.3   |                |                |                |
+----------------+----------------+----------------+----------------+
| Information    | Value/remark   | Comment        | Condition      |
| Element        |                |                |                |
+----------------+----------------+----------------+----------------+
| UE             |                |                |                |
| -NR-Capability |                |                |                |
| ::= SEQUENCE { |                |                |                |
+----------------+----------------+----------------+----------------+
| access         | Checked        | \"rel-15\" or  |                |
| StratumRelease |                | higher         |                |
+----------------+----------------+----------------+----------------+
|                | Checked        | \"rel-17\" or  | pc\_suppor     |
|                |                | higher         | tOfRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| p              |                |                |                |
| dcp-Parameters |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| supporte       |                |                |                |
| dROHC-Profiles |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0000  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0001  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0002  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0003  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0004  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0006  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0101  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0102  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0103  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| profile0x0104  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| m              | Not checked    |                |                |
| axNumberROHC-C |                |                |                |
| ontextSessions |                |                |                |
+----------------+----------------+----------------+----------------+
| uplinkOnl      | Not checked    |                |                |
| yROHC-Profiles |                |                |                |
+----------------+----------------+----------------+----------------+
| contin         | Not checked    |                |                |
| ueROHC-Context |                |                |                |
+----------------+----------------+----------------+----------------+
| outO           | Checked        |                | pc\_outO       |
| fOrderDelivery |                |                | fOrderDelivery |
+----------------+----------------+----------------+----------------+
| shortSN        | Checked        |                | pc\_shortSN    |
+----------------+----------------+----------------+----------------+
| pdcp-          | Checked        |                | p              |
| DuplicationSRB |                |                | c\_pdcp\_Dupli |
|                |                |                | cationSplitSRB |
+----------------+----------------+----------------+----------------+
|                | Not Present    |                | pc\_suppor     |
|                |                |                | tOfRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| p              | Checked        |                | pc\_pdcp       |
| dcp-Duplicatio |                |                | \_DuplicationM |
| nMCG-OrSCG-DRB |                |                | CG\_OrSCG\_DRB |
+----------------+----------------+----------------+----------------+
|                | Not Present    |                | pc\_suppor     |
|                |                |                | tOfRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| drb-IAB-r16    | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| n              | Not checked    |                |                |
| on-DRB-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| extendedDi     | Not checked    |                |                |
| scardTimer-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| continueE      | Not checked    |                |                |
| HC-Context-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| ehc-r16        | Checked        |                | pc             |
|                |                |                | \_NR\_ehc\_r16 |
+----------------+----------------+----------------+----------------+
| maxNumberEH    | Not checked    |                |                |
| C-Contexts-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| jointEHC-R     | Not checked    |                |                |
| OHC-Config-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| pdcp-D         | Checked        |                | pc\_pdcp\_Du   |
| uplicationMore |                |                | plicationMoreT |
| ThanTwoRLC-r16 |                |                | hanTwoRLC\_r16 |
+----------------+----------------+----------------+----------------+
| lon            | Checked        |                | pc\_suppor     |
| gSN-RedCap-r17 |                |                | tOfRedCap\_r17 |
|                |                |                |                |
|                |                |                | and pc\_LongSN |
+----------------+----------------+----------------+----------------+
| udc-r17        | Checked        | TS 38.306 cl.  | pc             |
| SEQUENCE {     |                | 4.2.4.         | \_NR\_udc\_r17 |
|                |                | Indicates      |                |
|                |                | whether the UE |                |
|                |                | supports the   |                |
|                |                | uplink data    |                |
|                |                | compression    |                |
|                |                | operation as   |                |
|                |                | specified in   |                |
|                |                | TS 38.323.     |                |
|                |                |                |                |
|                |                | Nested         |                |
|                |                | parameters     |                |
|                |                | apply on       |                |
|                |                | presence of    |                |
|                |                | udc-r17        |                |
+----------------+----------------+----------------+----------------+
| standard       | Checked        |                | pc\_NR\_       |
| Dictionary-r17 |                |                | udc\_standardD |
|                |                |                | ictionary\_r17 |
+----------------+----------------+----------------+----------------+
| operator       | Not checked    |                |                |
| Dictionary-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| c              | Checked        |                | p              |
| ontinueUDC-r17 |                |                | c\_NR\_udc\_co |
|                |                |                | ntinueUDC\_r17 |
+----------------+----------------+----------------+----------------+
| supportOf      | Not checked    |                |                |
| BufferSize-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| rlc-Parameters |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| am-WithShortSN | Checked        |                | pc\_a          |
|                |                |                | m\_WithShortSN |
+----------------+----------------+----------------+----------------+
| um-WithShortSN | Checked        |                | pc\_u          |
|                |                |                | m\_WithShortSN |
+----------------+----------------+----------------+----------------+
| um-WithLongSN  | Checked        |                | pc\_           |
|                |                |                | um\_WIthLongSN |
+----------------+----------------+----------------+----------------+
| am-WithLon     | Checked        |                | pc\_suppor     |
| gSN-RedCap-r17 |                |                | tOfRedCap\_r17 |
|                |                |                | and            |
|                |                |                |                |
|                |                |                | pc\_           |
|                |                |                | am\_WithLongSN |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Parameters |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Pa         |                |                |                |
| rametersCommon |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| l              | Checked        |                | pc\_lc         |
| cp-Restriction |                |                | p\_Restriction |
+----------------+----------------+----------------+----------------+
| dummy          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| lch-ToSC       | Not checked    |                |                |
| ellRestriction |                |                |                |
+----------------+----------------+----------------+----------------+
| reco           | Checked        |                | pc\_reco       |
| mmendedBitRate |                |                | mmendedBitRate |
+----------------+----------------+----------------+----------------+
| recommend      | Checked        |                | pc\_recommend  |
| edBitRateQuery |                |                | edBitRateQuery |
+----------------+----------------+----------------+----------------+
| reco           | Not checked    |                |                |
| mmendedBitRate |                |                |                |
| Multiplier-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| pre            | Not checked    |                |                |
| EmptiveBSR-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| autonomousTr   | Not checked    |                |                |
| ansmission-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| lch-Pri        | Checked        |                | pc\_lch\_Prio  |
| orityBasedPrio |                |                | rityBasedPrior |
| ritization-r16 |                |                | itization\_r16 |
+----------------+----------------+----------------+----------------+
| lch-           | Not checked    |                |                |
| ToConfiguredGr |                |                |                |
| antMapping-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| lch-To         | Checked        |                | pc\_lch\_ToG   |
| GrantPriorityR |                |                | rantPriorityRe |
| estriction-r16 |                |                | striction\_r16 |
+----------------+----------------+----------------+----------------+
| s              | Not checked    |                |                |
| inglePHR-P-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-LBT-        | Checked        |                | pc\_UL\_LBT\_F |
| FailureDetecti |                |                | ailureDetectio |
| onRecovery-r16 |                |                | nRecovery\_r16 |
+----------------+----------------+----------------+----------------+
| tdd-MPE-P-MPR  | Not checked    |                |                |
| -Reporting-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| lcid-Ex        | Not checked    |                |                |
| tensionIAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| spCel          | Not checked    |                |                |
| l-BFR-CBRA-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| srs-Reso       | Not checked    |                |                |
| urceId-Ext-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| e              | Not checked    |                |                |
| nhancedUuDRX-f |                |                |                |
| orSidelink-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| mg-A           | Not checked    |                |                |
| ctivationReque |                |                |                |
| stPRS-Meas-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| m              | Not checked    |                |                |
| g-ActivationCo |                |                |                |
| mmPRS-Meas-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| intraCG-Prio   | Not checked    |                |                |
| ritization-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| jointPri       | Not checked    |                |                |
| oritizationCG- |                |                |                |
| Retx-Timer-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| su             | Checked        |                | pc\_sur        |
| rvivalTime-r17 |                |                | vivalTime\_r17 |
+----------------+----------------+----------------+----------------+
| lcg-Ex         | Not checked    |                |                |
| tensionIAB-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| harq-Feedba    | Checked        |                | pc\            |
| ckDisabled-r17 |                |                | _harq\_Feedbac |
|                |                |                | kDisabled\_r17 |
+----------------+----------------+----------------+----------------+
| uplink-        | Checked        |                | pc\_uplink\_Ha |
| Harq-ModeB-r17 |                |                | rq\_ModeB\_r17 |
+----------------+----------------+----------------+----------------+
| sr-TriggeredBy | Not checked    |                |                |
| -TA-Report-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| e              | Checked        |                | pc\_ext        |
| xtendedDRX-Cyc |                |                | endedDRX\_Cycl |
| leInactive-r17 |                |                | eInactive\_r17 |
+----------------+----------------+----------------+----------------+
| simultaneousS  | Not checked    |                |                |
| R-PUSCH-DiffPU |                |                |                |
| CCH-groups-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| lastTran       | Not checked    |                |                |
| smissionUL-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| harq-RTT-Tim   | Not checked    |                |                |
| erDL-ForNTN-Mu |                |                |                |
| lticastMBS-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| sr             | Not checked    |                |                |
| -TriggeredByTA |                |                |                |
| -ReportATG-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| e              | Checked        |                | pc\_ext        |
| xtendedDRX-Cyc |                |                | endedDRX\_Cycl |
| leInactive-r18 |                |                | eInactive\_r18 |
+----------------+----------------+----------------+----------------+
| addition       | Not checked    |                |                |
| alBS-Table-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| delaySt        | Not checked    |                |                |
| atusReport-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| cg-Retransmi   | Not checked    |                |                |
| ssionMonitorin |                |                |                |
| gDisabling-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| non-           | Not checked    |                |                |
| IntegerDRX-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Para       |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| skipU          | Checked (NOTE  |                | pc\_skipU      |
| plinkTxDynamic | 4)             |                | plinkTxDynamic |
+----------------+----------------+----------------+----------------+
| logicalChanne  | Checked (NOTE  |                | pc\_           |
| lSR-DelayTimer | 5)             |                | logicalChannel |
|                |                |                | SR\_DelayTimer |
+----------------+----------------+----------------+----------------+
| longDRX-Cycle  | Checked (NOTE  |                | pc\_           |
|                | 6)             |                | longDRX\_Cycle |
+----------------+----------------+----------------+----------------+
| shortDRX-Cycle | Checked (NOTE  |                | pc\_s          |
|                | 7)             |                | hortDRX\_Cycle |
+----------------+----------------+----------------+----------------+
| multipleSR-    | Not checked    |                |                |
| Configurations |                |                |                |
+----------------+----------------+----------------+----------------+
| multipleCo     | Checked (NOTE  |                | pc\_multipleCo |
| nfiguredGrants | 12)            |                | nfiguredGrants |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Parameters |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Pa         |                |                |                |
| rametersCommon |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| csi            | Checked        |                | pc\_csi\_R     |
| -RS-CFRA-ForHO |                |                | S\_CFRA\_ForHO |
+----------------+----------------+----------------+----------------+
| dynamic        | Not checked    |                |                |
| PRB-BundlingDL |                |                |                |
+----------------+----------------+----------------+----------------+
| sp-C           | Not checked    |                |                |
| SI-ReportPUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| sp-C           | Not checked    |                |                |
| SI-ReportPUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| nzp-CS         | Not checked    |                |                |
| I-RS-IntefMgmt |                |                |                |
+----------------+----------------+----------------+----------------+
| typ            | Not checked    |                |                |
| e2-SP-CSI-Feed |                |                |                |
| back-LongPUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| precoderGran   | Not checked    |                |                |
| ularityCORESET |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicHAR     | supported      |                |                |
| Q-ACK-Codebook |                |                |                |
+----------------+----------------+----------------+----------------+
| semiStaticHAR  | Not checked    |                |                |
| Q-ACK-Codebook |                |                |                |
+----------------+----------------+----------------+----------------+
| spatialBu      | Checked        |                | pc\_spatialBun |
| ndlingHARQ-ACK |                |                | dlingHARQ\_ACK |
+----------------+----------------+----------------+----------------+
| dynam          | Not checked    |                |                |
| icBetaOffsetIn |                |                |                |
| d-HARQ-ACK-CSI |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-Rep      | Not checked    |                |                |
| etition-F1-3-4 |                |                |                |
+----------------+----------------+----------------+----------------+
| ra-Type0-PUSCH | Checked        |                | pc\_ra         |
|                |                |                | \_Type0\_PUSCH |
+----------------+----------------+----------------+----------------+
| d              | Checked        |                | pc\_dyna       |
| ynamicSwitchRA |                |                | micSwitchRA\_T |
| -Type0-1-PDSCH |                |                | ype0\_1\_PDSCH |
+----------------+----------------+----------------+----------------+
| d              | Checked        |                | pc\_dyna       |
| ynamicSwitchRA |                |                | micSwitchRA\_T |
| -Type0-1-PUSCH |                |                | ype0\_1\_PUSCH |
+----------------+----------------+----------------+----------------+
| pdsc           | supported      |                |                |
| h-MappingTypeA |                |                |                |
+----------------+----------------+----------------+----------------+
| pdsc           | Checked        |                | pc\_pdsch      |
| h-MappingTypeB |                |                | \_MappingTypeB |
+----------------+----------------+----------------+----------------+
| interleavingV  | Checked        |                | pc\_i          |
| RB-ToPRB-PDSCH |                |                | nterleavingVRB |
|                |                |                | \_ToPRB\_PDSCH |
+----------------+----------------+----------------+----------------+
| interSlotFre   | Not checked    |                |                |
| qHopping-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| type           | Not checked    |                |                |
| 1-PUSCH-Repeti |                |                |                |
| tionMultiSlots |                |                |                |
+----------------+----------------+----------------+----------------+
| type           | Not checked    |                |                |
| 2-PUSCH-Repeti |                |                |                |
| tionMultiSlots |                |                |                |
+----------------+----------------+----------------+----------------+
| pusch-Repeti   | Checked        |                | pc\            |
| tionMultiSlots |                |                | _pusch\_Repeti |
|                |                |                | tionMultiSlots |
+----------------+----------------+----------------+----------------+
| pdsch-Repeti   | Checked        |                | pc\            |
| tionMultiSlots |                |                | _pdsch\_Repeti |
|                |                |                | tionMultiSlots |
+----------------+----------------+----------------+----------------+
| downlinkSPS    | Checked        |                | p              |
|                |                |                | c\_downlinkSPS |
+----------------+----------------+----------------+----------------+
| configure      | Checked        |                | pc\_configured |
| dUL-GrantType1 |                |                | UL\_GrantType1 |
+----------------+----------------+----------------+----------------+
| configure      | Checked        |                | pc\_configured |
| dUL-GrantType2 |                |                | UL\_GrantType2 |
+----------------+----------------+----------------+----------------+
| pre-Emp        | Not checked    |                |                |
| tIndication-DL |                |                |                |
+----------------+----------------+----------------+----------------+
| cbg-Tran       | Not checked    |                |                |
| sIndication-DL |                |                |                |
+----------------+----------------+----------------+----------------+
| cbg-Tran       | Not checked    |                |                |
| sIndication-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| cbg-Flus       | Not checked    |                |                |
| hIndication-DL |                |                |                |
+----------------+----------------+----------------+----------------+
| dynam          | Not checked    |                |                |
| icHARQ-ACK-Cod |                |                |                |
| eB-CBG-Retx-DL |                |                |                |
+----------------+----------------+----------------+----------------+
| rat            | Not checked    |                |                |
| eMatchingResrc |                |                |                |
| SetSemi-Static |                |                |                |
+----------------+----------------+----------------+----------------+
| rateMatchingR  | Not checked    |                |                |
| esrcSetDynamic |                |                |                |
+----------------+----------------+----------------+----------------+
| bwp-           | Checked        | ***TS 38.306   | pc             |
| SwitchingDelay |                | \[23\] clause  | \_bwp\_Switchi |
|                |                | 4.2.7.10: It   | ngDelay\_Type1 |
|                |                | is mandatory   |                |
|                |                | to report type | or             |
|                |                | 1 or type 2.   |                |
|                |                | This           | pc             |
|                |                | capability is  | \_bwp\_Switchi |
|                |                | not applicable | ngDelay\_Type2 |
|                |                | to IAB-MT***   |                |
+----------------+----------------+----------------+----------------+
| t              | Checked        |                | pc\_tw         |
| woStepRACH-r16 |                |                | oStepRACH\_r16 |
+----------------+----------------+----------------+----------------+
| dci-Forma      | Checked        |                | pc\            |
| t1-2And0-2-r16 |                |                | _dci\_Format1\ |
|                |                |                | _2And0\_2\_r16 |
+----------------+----------------+----------------+----------------+
| monit          | Not checked    |                |                |
| oringDCI-SameS |                |                |                |
| earchSpace-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| type2-CG-Rele  | Not checked    |                |                |
| aseDCI-0-1-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| type2-CG-Rele  | Not checked    |                |                |
| aseDCI-0-2-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sps-Rele       | Not checked    |                |                |
| aseDCI-1-1-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sps-Rele       | Not checked    |                |                |
| aseDCI-1-2-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-T          | Not checked    |                |                |
| riggerStateNon |                |                |                |
| -ActiveBWP-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| separ          | Not checked    |                |                |
| ateSMTC-InterI |                |                |                |
| AB-Support-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| separateRACH-I | Not checked    |                |                |
| AB-Support-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-flexibleDL- | Not checked    |                |                |
| SlotFormatSemi |                |                |                |
| Static-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-flexibleD   | Not checked    |                |                |
| L-SlotFormatDy |                |                |                |
| namics-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| d              | Not checked    |                |                |
| ft-S-OFDM-Wave |                |                |                |
| formUL-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| dc             | Not checked    |                |                |
| i-25-AI-RNTI-S |                |                |                |
| upport-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| t-D            | Not checked    |                |                |
| eltaReceptionS |                |                |                |
| upport-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| guardS         | Not checked    |                |                |
| ymbolReportRec |                |                |                |
| eption-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| harqACK-CB-Sp  | Not checked    |                |                |
| atialBundlingP |                |                |                |
| UCCH-Group-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| crossSlot      | Not checked    |                |                |
| Scheduling-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumber      | Not checked    |                |                |
| SRS-PosPathLos |                |                |                |
| sEstimateAllSe |                |                |                |
| rvingCells-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| extendedCG-Per | Not checked    |                |                |
| iodicities-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| e              | Not checked    |                |                |
| xtendedSPS-Per |                |                |                |
| iodicities-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| codebookVa     | Not checked    |                |                |
| riantsList-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| pusch-Repet    | Checked        |                | pc\            |
| itionTypeA-r16 |                |                | _pusch\_Repeti |
|                |                |                | tionTypeA\_r16 |
+----------------+----------------+----------------+----------------+
| dci-DL-Priorit | Checked        |                | pc\_dci        |
| yIndicator-r16 |                |                | \_DL\_Priority |
|                |                |                | Indicator\_r16 |
+----------------+----------------+----------------+----------------+
| dci-UL-Priorit | Checked        |                | pc\_dci        |
| yIndicator-r16 |                |                | \_UL\_Priority |
|                |                |                | Indicator\_r16 |
+----------------+----------------+----------------+----------------+
| ma             | Not checked    |                |                |
| xNumberPathlos |                |                |                |
| sRS-Update-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| type2-HARQ-AC  | Not checked    |                |                |
| K-Codebook-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxTotalReso   | Not checked    |                |                |
| urcesForAcross |                |                |                |
| FreqRanges-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| harqACK-s      | Not checked    |                |                |
| eparateMultiDC |                |                |                |
| I-MultiTRP-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| harqAC         | Not checked    |                |                |
| K-jointMultiDC |                |                |                |
| I-MultiTRP-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| bwp-Switchi    | Not checked    |                |                |
| ngMultiCCs-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| guardS         | Not checked    |                |                |
| ymbolReportRec |                |                |                |
| eption-IAB-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| restric        | Not checked    |                |                |
| ted-IAB-DU-Bea |                |                |                |
| mReception-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| recommended    | Not checked    |                |                |
| -IAB-MT-BeamTr |                |                |                |
| ansmission-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| case6-Timi     | Not checked    |                |                |
| ngAlignmentRec |                |                |                |
| eption-IAB-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| case7-Timi     | Not checked    |                |                |
| ngAlignmentRec |                |                |                |
| eption-IAB-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| d              | Not checked    |                |                |
| l-tx-PowerAdju |                |                |                |
| stment-IAB-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| desir          | Not checked    |                |                |
| ed-ul-tx-Power |                |                |                |
| Adjustment-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| fdm-Soft       | Not checked    |                |                |
| ResourceAvaila |                |                |                |
| bility-Dynamic |                |                |                |
| Indication-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| updat          | Not checked    |                |                |
| ed-T-DeltaRang |                |                |                |
| eReception-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| s              | Checked        |                | pc\_p          |
| lotBasedDynami |                |                | ucch\_Repetiti |
| cPUCCH-Rep-r17 |                |                | on\_F0\_1\_2\_ |
|                |                |                | 3\_4\_DynamicI |
|                |                |                | ndication\_r17 |
+----------------+----------------+----------------+----------------+
| sps-HARQ-AC    | Not checked    |                |                |
| K-Deferral-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| unif           | Not checked    |                |                |
| iedJointTCI-co |                |                |                |
| mmonUpdate-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| mTRP-PDCCH-    | Not checked    |                |                |
| singleSpan-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| supportedActiv | Not checked    |                |                |
| atedPRS-Proces |                |                |                |
| singWindow-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| cg-TimeD       | Not checked    |                |                |
| omainAllocatio |                |                |                |
| nExtension-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Para       |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicSFI     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-F0-2  | Not checked    |                |                |
| -ConsecSymbols |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-            | Checked (NOTE  |                | pc\_dl\_Sc     |
| SchedulingOffs | 17)            |                | hedulingOffset |
| et-PDSCH-TypeA |                |                | \_PDSCH\_TypeA |
+----------------+----------------+----------------+----------------+
| dl-            | Not checked    |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeB |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-Sc          | Not checked    |                |                |
| hedulingOffset |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Para       |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicSFI     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy1         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoFL-DMRS     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy2         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy3         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    |                |                |
| tedDMRS-TypeDL |                |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    |                |                |
| tedDMRS-TypeUL |                |                |                |
+----------------+----------------+----------------+----------------+
| s              | Not checked    |                |                |
| emiOpenLoopCSI |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-Re         | Not checked    |                |                |
| portWithoutPMI |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-Re         | Not checked    |                |                |
| portWithoutCQI |                |                |                |
+----------------+----------------+----------------+----------------+
| onePortsPTRS   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-F0-2  | Not checked    |                |                |
| -ConsecSymbols |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | supported      |                |                |
| ucch-F2-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | supported      |                |                |
| ucch-F3-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F4-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch          | Not checked    |                |                |
| -F0-2WithoutFH |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-F        | Not checked    |                |                |
| 1-3-4WithoutFH |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-HAR     | Not checked    |                |                |
| Q-ACK-CSI-PUCC |                |                |                |
| H-MultiPerSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| uci-CodeBlo    | Not checked    |                |                |
| ckSegmentation |                |                |                |
+----------------+----------------+----------------+----------------+
| onePUCCH-Long  | Not checked    |                |                |
| AndShortFormat |                |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-A     | Checked (NOTE  |                | p              |
| nyOthersInSlot | 26)            |                | c\_twoPUCCH\_A |
|                |                |                | nyOthersInSlot |
+----------------+----------------+----------------+----------------+
| intraSlotFre   | Not checked    |                |                |
| qHopping-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| pusch-LBRM     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| pdcch-Bl       | Not checked    |                |                |
| indDetectionCA |                |                |                |
+----------------+----------------+----------------+----------------+
| tpc-PUSCH-RNTI | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tpc-PUCCH-RNTI | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tpc-SRS-RNTI   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| absol          | Not checked    |                |                |
| uteTPC-Command |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| pus            | Not checked    |                |                |
| ch-HalfPi-BPSK |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-F3       | Not checked    |                |                |
| -4-HalfPi-BPSK |                |                |                |
+----------------+----------------+----------------+----------------+
| almostContig   | Not checked    |                |                |
| uousCP-OFDM-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| sp-CSI-RS      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| sp-CSI-IM      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tdd-MultiDL-UL | Not checked    |                |                |
| -SwitchPerSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| m              | Not checked    |                |                |
| ultipleCORESET |                |                |                |
+----------------+----------------+----------------+----------------+
| cs             | Not checked    | CS             |                |
| i-RS-IM-Recept |                | I-RS-IM-Recept |                |
| ionForFeedback |                | ionForFeedback |                |
+----------------+----------------+----------------+----------------+
| csi-RS-ProcF   | Not checked    | CSI-RS-ProcF   |                |
| rameworkForSRS |                | rameworkForSRS |                |
+----------------+----------------+----------------+----------------+
| csi-R          | Not checked    | CSI-R          |                |
| eportFramework |                | eportFramework |                |
+----------------+----------------+----------------+----------------+
| mux-SR-HA      |                |                |                |
| RQ-ACK-CSI-PUC |                |                |                |
| CH-OncePerSlot |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| sameSymbol     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| diffSymbol     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-        | Not checked    |                |                |
| HARQ-ACK-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| mux            | Not checked    |                |                |
| -MultipleGroup |                |                |                |
| CtrlCH-Overlap |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-            | Checked (NOTE  |                | pc\_dl\_Sc     |
| SchedulingOffs | 18)            |                | hedulingOffset |
| et-PDSCH-TypeA |                |                | \_PDSCH\_TypeA |
+----------------+----------------+----------------+----------------+
| dl-            | Not checked    |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeB |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-Sc          | Not checked    |                |                |
| hedulingOffset |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-64QA        | Not checked    |                |                |
| M-MCS-TableAlt |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-64QA        | Not checked    |                |                |
| M-MCS-TableAlt |                |                |                |
+----------------+----------------+----------------+----------------+
| cqi-TableAlt   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| one            | Not checked    |                |                |
| FL-DMRS-TwoAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| two            | Not checked    |                |                |
| FL-DMRS-TwoAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| oneFL          | Not checked    |                |                |
| -DMRS-ThreeAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| phy            |                |                |                |
| -ParametersFR1 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| dcchMonitoring |                |                |                |
| SingleOccasion |                |                |                |
+----------------+----------------+----------------+----------------+
| scs-60kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| pd             | Checked        |                | pc\_pdsc       |
| sch-256QAM-FR1 |                |                | h\_256QAM\_FR1 |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| dsch-RE-Mappin |                |                |                |
| gFR1-PerSymbol |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| phy            |                |                |                |
| -ParametersFR2 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| dsch-RE-Mappin |                |                |                |
| gFR2-PerSymbol |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| rf-Parameters  |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| suppo          |                |                |                |
| rtedBandListNR |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxBands)) |                |                |                |
| OF BandNR {    |                |                |                |
+----------------+----------------+----------------+----------------+
| BandNR\[i\]    |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| bandNR         | Checked        | Checked for    | pc\_nrBandx    |
|                |                | \'maxBands\'   |                |
|                |                | entries of     | (\'x\' being   |
|                |                | FreqBandIn     | the band       |
|                |                | dicatorNR\[i\] | number/type    |
|                |                |                | related PICS   |
|                |                |                | listed in TS   |
|                |                |                | 38.508-2       |
|                |                |                | \[5\])         |
+----------------+----------------+----------------+----------------+
| modifie        | Not checked    |                |                |
| dMPR-Behaviour |                |                |                |
+----------------+----------------+----------------+----------------+
| mimo-Par       | Checked        | MIMO-Paramete  |                |
| ametersPerBand |                | rsPerBand\[i\] |                |
|                |                | (Table         |                |
|                |                | 8.1            |                |
|                |                | .5.1.1.3.3-12) |                |
+----------------+----------------+----------------+----------------+
| extendedCP     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| multipleTCI    | supported      |                |                |
+----------------+----------------+----------------+----------------+
| bwp-With       | Checked        |                | pc\_bwp\_With  |
| outRestriction |                |                | outRestriction |
+----------------+----------------+----------------+----------------+
| bwp-           | Checked (NOTE  |                | pc\_bwp\_Sam   |
| SameNumerology | 21)            |                | eNumerology\_u |
|                |                |                | pto2\_FR1\_FDD |
|                |                |                | or             |
|                |                |                | pc\_bwp\_Sam   |
|                |                |                | eNumerology\_u |
|                |                |                | pto2\_FR1\_TDD |
|                |                |                | or             |
|                |                |                | pc\_bwp        |
|                |                |                | \_SameNumerolo |
|                |                |                | gy\_upto2\_FR2 |
|                |                |                | or             |
|                |                |                | pc\_bwp\_Sam   |
|                |                |                | eNumerology\_u |
|                |                |                | pto4\_FR1\_FDD |
|                |                |                | or             |
|                |                |                | pc\_bwp\_Sam   |
|                |                |                | eNumerology\_u |
|                |                |                | pto4\_FR1\_TDD |
|                |                |                | or             |
|                |                |                | pc\_bwp        |
|                |                |                | \_SameNumerolo |
|                |                |                | gy\_upto4\_FR2 |
+----------------+----------------+----------------+----------------+
| bwp-           | upto4 (NOTE    |                | pc\_b          |
| DiffNumerology | 20)            |                | wp\_DiffNumero |
|                |                |                | logy\_FR1\_FDD |
|                |                |                | or             |
|                |                |                | pc\_b          |
|                |                |                | wp\_DiffNumero |
|                |                |                | logy\_FR1\_TDD |
|                |                |                | or             |
|                |                |                | pc\_bwp\_DiffN |
|                |                |                | umerology\_FR2 |
+----------------+----------------+----------------+----------------+
| cr             | Not checked    |                |                |
| ossCarrierSche |                |                |                |
| duling-SameSCS |                |                |                |
+----------------+----------------+----------------+----------------+
| pd             | Checked (NOTE  |                | pc\_pdsc       |
| sch-256QAM-FR2 | 8)             |                | h\_256QAM\_FR2 |
+----------------+----------------+----------------+----------------+
| pusch-256QAM   | Checked (NOTE  |                | pc\_pusc       |
|                | 9)             |                | h\_256QAM\_FR1 |
|                |                |                | OR             |
|                |                |                | pc\_pusc       |
|                |                |                | h\_256QAM\_FR2 |
+----------------+----------------+----------------+----------------+
| ue-PowerClass  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| rateM          | Not checked    |                |                |
| atchingLTE-CRS |                |                |                |
+----------------+----------------+----------------+----------------+
| channelBWs-DL  |                |                |                |
| CHOICE {       |                |                |                |
+----------------+----------------+----------------+----------------+
| fr1 SEQUENCE { |                |                |                |
+----------------+----------------+----------------+----------------+
| scs-15kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-30kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-60kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fr2 SEQUENCE { |                |                |                |
+----------------+----------------+----------------+----------------+
| scs-60kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-120kHz     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| channelBWs-UL  |                |                |                |
| CHOICE {       |                |                |                |
+----------------+----------------+----------------+----------------+
| fr1 SEQUENCE { |                |                |                |
+----------------+----------------+----------------+----------------+
| scs-15kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-30kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-60kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fr2 SEQUENCE { |                |                |                |
+----------------+----------------+----------------+----------------+
| scs-60kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-120kHz     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Checked        | SharedSpect    |                |
| sharedSpect    |                | rumChAccessPar |                |
| rumChAccessPar |                | amsPerBand-r16 |                |
| amsPerBand-r16 |                | (Table         |                |
|                |                | 8.1            |                |
|                |                | .5.1.1.3.3-13) |                |
+----------------+----------------+----------------+----------------+
| cancelOverla   | Not checked    |                |                |
| ppingPUSCH-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| multi          | Not checked    |                |                |
| pleRateMatchin |                |                |                |
| gEUTRA-CRS-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| over           | Not checked    |                |                |
| lapRateMatchin |                |                |                |
| gEUTRA-CRS-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| pdsch-Mappin   | Not checked    |                |                |
| gTypeB-Alt-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| oneSlotP       | Not checked    |                |                |
| eriodicTRS-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| ol             | Not checked    |                |                |
| pc-SRS-Pos-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| spatialRelati  | Not checked    |                |                |
| onsSRS-Pos-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| simul          | Not checked    |                |                |
| SRS-MIMO-Trans |                |                |                |
| WithinBand-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBW-DL-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBW-UL-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| rasterShif     | Not checked    |                |                |
| t7dot5-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| ue-Po          | Not checked    |                |                |
| werClass-v1610 |                |                |                |
+----------------+----------------+----------------+----------------+
| co             | Checked        |                | pc\_con        |
| ndHandover-r16 |                |                | dHandover\_r16 |
+----------------+----------------+----------------+----------------+
| condHando      | Checked        |                | pc\_condHandov |
| verFailure-r16 |                |                | erFailure\_r16 |
+----------------+----------------+----------------+----------------+
| cond           | Checked        |                | pc\_condH      |
| HandoverTwoTri |                |                | andoverTwoTrig |
| ggerEvents-r16 |                |                | gerEvents\_r16 |
+----------------+----------------+----------------+----------------+
| condPS         | Checked        |                | pc\_condPSC    |
| CellChange-r16 |                |                | ellChange\_r16 |
+----------------+----------------+----------------+----------------+
| condPSCe       | Not checked    |                |                |
| llChangeTwoTri |                |                |                |
| ggerEvents-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| mpr-Powe       | Not checked    |                |                |
| rBoost-FR2-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| activeConfi    | Not checked    |                |                |
| guredGrant-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| jointRel       | Not checked    |                |                |
| easeConfigured |                |                |                |
| GrantType2-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sps-r16        | Checked        |                | pc\_m          |
|                |                |                | ulti\_sps\_r16 |
+----------------+----------------+----------------+----------------+
| joint          | Not checked    |                |                |
| ReleaseSPS-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| simulSRS-Trans | Not checked    |                |                |
| WithinBand-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| trs-Additiona  | Not checked    |                |                |
| lBandwidth-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| handover       | Not checked    |                |                |
| IntraF-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxUplinkD     | Checked        |                | pc\_nrBandx\_  |
| utyCycle-PC1do |                |                | maxUplinkDutyC |
| t5-MPE-FR1-r16 |                |                | ycle\_PC1dot5\ |
|                |                |                | _MPE\_FR1\_r16 |
|                |                |                |                |
|                |                |                | ('x' being the |
|                |                |                | band number    |
|                |                |                | related PICS   |
|                |                |                | listed in      |
|                |                |                | Table          |
|                |                |                | A.4.3.1-4h of  |
|                |                |                | TS 38.508-2    |
|                |                |                | \[2\])         |
+----------------+----------------+----------------+----------------+
| t              | Checked        |                | *pc\_txD       |
| xDiversity-r16 |                |                | iversity\_r16* |
+----------------+----------------+----------------+----------------+
| pdsch-1        | Not checked    |                |                |
| 024QAM-FR1-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ue-Po          | Not checked    |                |                |
| werClass-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| f              | Not checked    |                |                |
| r2-2-AccessPar |                |                |                |
| amsPerBand-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| rlm-           | Not checked    |                |                |
| Relaxation-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| bfd-           | Not checked    |                |                |
| Relaxation-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| cg-SDT-r17     | Checked        |                | pc             |
|                |                |                | \_cg\_SDT\_r17 |
+----------------+----------------+----------------+----------------+
| l              | Checked        |                | pc\_lo         |
| ocationBasedCo |                |                | cationBasedCon |
| ndHandover-r17 |                |                | dHandover\_r17 |
+----------------+----------------+----------------+----------------+
| timeBasedCo    | Checked        |                | pc             |
| ndHandover-r17 |                |                | \_timeBasedCon |
|                |                |                | dHandover\_r17 |
+----------------+----------------+----------------+----------------+
| eventA4BasedCo | Checked        |                | pc\_e          |
| ndHandover-r17 |                |                | ventA4BasedCon |
|                |                |                | dHandover\_r17 |
+----------------+----------------+----------------+----------------+
| mn-Initi       | Not checked    |                |                |
| atedCondPSCell |                |                |                |
| ChangeNRDC-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| sn-Initi       | Checked        |                | pc\_sn\_Initia |
| atedCondPSCell |                |                | tedCondPSCellC |
| ChangeNRDC-r17 |                |                | hangeNRDC\_r17 |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| dcch-SkippingW |                |                |                |
| ithoutSSSG-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| sssg-Switchi   | Not checked    |                |                |
| ng-1BitInd-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| sssg-Switchi   | Not checked    |                |                |
| ng-2BitInd-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| pdcch-Skippi   | Not checked    |                |                |
| ngWithSSSG-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| sear           | Not checked    |                |                |
| chSpaceSetGrp- |                |                |                |
| switchCap2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| uplinkPreCo    | Not checked    |                |                |
| mpensation-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| uplink-TA      | Checked        |                | pc             |
| -Reporting-r17 |                |                | \_uplink\_TA\_ |
|                |                |                | Reporting\_r17 |
+----------------+----------------+----------------+----------------+
| max-HARQ-Pro   | Not checked    |                |                |
| cessNumber-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| type2-HAR      | Not checked    |                |                |
| Q-Codebook-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| type1-HAR      | Not checked    |                |                |
| Q-Codebook-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| type3-HAR      | Not checked    |                |                |
| Q-Codebook-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ue-specifi     | Checked        |                | pc\_           |
| c-K-Offset-r17 |                |                | ue\_specific\_ |
|                |                |                | K\_Offset\_r17 |
+----------------+----------------+----------------+----------------+
| multiPDSCH-Si  | Not checked    |                |                |
| ngleDCI-FR2-1- |                |                |                |
| SCS-120kHz-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| multiPUSCH-Si  | Not checked    |                |                |
| ngleDCI-FR2-1- |                |                |                |
| SCS-120kHz-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| para           | Not checked    |                |                |
| llelPRS-MeasRR |                |                |                |
| C-Inactive-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| n              | Not checked    |                |                |
| r-UE-TxTEG-ID- |                |                |                |
| MaxSupport-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| pr             | Not checked    |                |                |
| s-ProcessingRR |                |                |                |
| C-Inactive-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| pr             | Not checked    |                |                |
| s-ProcessingWi |                |                |                |
| ndowType1A-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| pr             | Not checked    |                |                |
| s-ProcessingWi |                |                |                |
| ndowType1B-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| rs-ProcessingW |                |                |                |
| indowType2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| srs-All        | Not checked    |                |                |
| PosResourcesRR |                |                |                |
| C-Inactive-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| olpc-SRS-PosRR | Not checked    |                |                |
| C-Inactive-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| spatialRela    | Not checked    |                |                |
| tionsSRS-PosRR |                |                |                |
| C-Inactive-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumb        | Checked        |                | pc\_maxNumberP |
| erPUSCH-TypeA- |                |                | USCH\_TypeA\_R |
| Repetition-r17 |                |                | epetition\_r17 |
+----------------+----------------+----------------+----------------+
| puschTy        | Checked        |                | pc\_puschType  |
| peA-Repetition |                |                | A\_Repetitions |
| sAvailSlot-r17 |                |                | AvailSlot\_r17 |
+----------------+----------------+----------------+----------------+
| tb-            | Checked        |                | pc\_tb\_P      |
| ProcessingMult |                |                | rocessingMulti |
| iSlotPUSCH-r17 |                |                | SlotPUSCH\_r17 |
+----------------+----------------+----------------+----------------+
| tb-Pro         | Checked        |                | pc\_tb\_Proc   |
| cessingRepMult |                |                | essingRepMulti |
| iSlotPUSCH-r17 |                |                | SlotPUSCH\_r17 |
+----------------+----------------+----------------+----------------+
| maxDurationDMR | Not checked    |                |                |
| S-Bundling-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| pusch-Repe     | Checked        |                | *pc\           |
| titionMsg3-r17 |                |                | _pusch\_Repeti |
|                |                |                | tionMsg3\_r17* |
+----------------+----------------+----------------+----------------+
| sharedSpectru  | Not checked    |                |                |
| mChAccessParam |                |                |                |
| sPerBand-v1710 |                |                |                |
+----------------+----------------+----------------+----------------+
| parallelMeasu  | Not checked    |                |                |
| rementWithoutR |                |                |                |
| estriction-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumber-NGSO | Not checked    |                |                |
| -SatellitesWit |                |                |                |
| hinOneSMTC-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| k1-Rang        | Not checked    |                |                |
| eExtension-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| aperiodicCS    | Not checked    |                |                |
| I-RS-FastScell |                |                |                |
| Activation-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| aperiodicCS    | Not checked    |                |                |
| I-RS-Additiona |                |                |                |
| lBandwidth-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| bwp-Withou     | Checked        |                | pc\_bw         |
| tCD-SSB-OrNCD- |                |                | p\_WithoutCD\_ |
| SSB-RedCap-r17 |                |                | SSB\_OrNCD\_SS |
|                |                |                | B\_RedCap\_r17 |
+----------------+----------------+----------------+----------------+
| ha             | Checked        |                | pc\_halfD      |
| lfDuplexFDD-Ty |                |                | uplexFDD\_Type |
| peA-RedCap-r17 |                |                | A\_RedCap\_r17 |
+----------------+----------------+----------------+----------------+
| po             | Not checked    |                |                |
| sSRS-RRC-Inact |                |                |                |
| ive-OutsideIni |                |                |                |
| tialUL-BWP-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBWs-DL-SCS-48 |                |                |                |
| 0kHz-FR2-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBWs-UL-SCS-48 |                |                |                |
| 0kHz-FR2-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBWs-DL-SCS-96 |                |                |                |
| 0kHz-FR2-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBWs-UL-SCS-96 |                |                |                |
| 0kHz-FR2-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-GapFR2-r17  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| oneShotHARQ-fe | Not checked    |                |                |
| edbackTriggere |                |                |                |
| dByDCI-1-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| oneShotH       | Not checked    |                |                |
| ARQ-feedbackPh |                |                |                |
| y-Priority-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| enhancedTyp    | Not checked    |                |                |
| e3-HARQ-Codebo |                |                |                |
| okFeedback-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| tr             | Not checked    |                |                |
| iggeredHARQ-Co |                |                |                |
| debookRetx-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ue-OneShotUL   | Not checked    |                |                |
| -TimingAdj-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-Repet    | Not checked    |                |                |
| ition-F0-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| cqi-4          | Not checked    |                |                |
| -BitsSubbandNT |                |                |                |
| N-SharedSpectr |                |                |                |
| umChAccess-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| mux            | Not checked    |                |                |
| -HARQ-ACK-Diff |                |                |                |
| Priorities-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ta-BasedPDC-NT | Not checked    |                |                |
| N-SharedSpectr |                |                |                |
| umChAccess-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ack-NA         | Not checked    |                |                |
| CK-FeedbackFor |                |                |                |
| MulticastWithD |                |                |                |
| CI-Enabler-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNu          | Not checked    |                |                |
| mberG-RNTI-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dynam          | Not checked    |                |                |
| icMulticastDCI |                |                |                |
| -Format4-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxMod         | Not checked    |                |                |
| ulationOrderFo |                |                |                |
| rMulticast-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dynami         | Not checked    |                |                |
| cSlotRepetitio |                |                |                |
| nMulticastTN-N |                |                |                |
| onSharedSpectr |                |                |                |
| umChAccess-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dyna           | Not checked    |                |                |
| micSlotRepetit |                |                |                |
| ionMulticastNT |                |                |                |
| N-SharedSpectr |                |                |                |
| umChAccess-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| nack-O         | Not checked    |                |                |
| nlyFeedbackFor |                |                |                |
| MulticastWithD |                |                |                |
| CI-Enabler-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ack-NACK-F     | Not checked    |                |                |
| eedbackForSPS- |                |                |                |
| MulticastWithD |                |                |                |
| CI-Enabler-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumbe       | Not checked    |                |                |
| rG-CS-RNTI-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| re-Level       | Not checked    |                |                |
| RateMatchingFo |                |                |                |
| rMulticast-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| pdsch-1024QAM  | Not checked    |                |                |
| -2MIMO-FR1-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| prs-Measuremen | Not checked    |                |                |
| tWithoutMG-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumber-N    | Not checked    |                |                |
| GSO-Satellites |                |                |                |
| PerCarrier-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| prs-Processing | Not checked    |                |                |
| CapabilityOuts |                |                |                |
| ideMGinPPW-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| srs-S          | Not checked    |                |                |
| emiPersistent- |                |                |                |
| PosResourcesRR |                |                |                |
| C-Inactive-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBWs-DL-SCS-12 |                |                |                |
| 0kHz-FR2-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBWs-UL-SCS-12 |                |                |                |
| 0kHz-FR2-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dmr            | Not checked    |                |                |
| s-BundlingPUSC |                |                |                |
| H-RepTypeA-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dmr            | Not checked    |                |                |
| s-BundlingPUSC |                |                |                |
| H-RepTypeB-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dmrs           | Not checked    |                |                |
| -BundlingPUSCH |                |                |                |
| -multiSlot-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dmrs-Bundlin   | Not checked    |                |                |
| gPUCCH-Rep-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| interSlotFreqH | Not checked    |                |                |
| opInterSlotBun |                |                |                |
| dlingPUSCH-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| interSlotFr    | Not checked    |                |                |
| eqHopPUCCH-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dmrs-Bundl     | Not checked    |                |                |
| ingRestart-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| dmrs           | Not checked    |                |                |
| -BundlingNonBa |                |                |                |
| ckToBackTX-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ma             | Not checked    |                |                |
| xDynamicSlotRe |                |                |                |
| petitionForSPS |                |                |                |
| -Multicast-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| nack-OnlyF     | Not checked    |                |                |
| eedbackForSPS- |                |                |                |
| MulticastWithD |                |                |                |
| CI-Enabler-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| sp             | Not checked    |                |                |
| s-MulticastDCI |                |                |                |
| -Format4-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| sps-MulticastM | Not checked    |                |                |
| ultiConfig-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| priority       | Not checked    |                |                |
| IndicatorInDCI |                |                |                |
| -Multicast-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| priorityIndi   | Not checked    |                |                |
| catorInDCI-SPS |                |                |                |
| -Multicast-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| twoH           | Not checked    |                |                |
| ARQ-ACK-Codebo |                |                |                |
| okForUnicastAn |                |                |                |
| dMulticast-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| m              | Not checked    |                |                |
| ultiPUCCH-HARQ |                |                |                |
| -ACK-ForMultic |                |                |                |
| astUnicast-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| release        | Not checked    |                |                |
| SPS-MulticastW |                |                |                |
| ithCS-RNTI-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| posUE-TA-Auto  | Not checked    |                |                |
| Adjustment-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| posSRS         | Not checked    |                |                |
| -ValidityAreaR |                |                |                |
| RC-InactiveIni |                |                |                |
| tialUL-BWP-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| posSRS-Validi  | Not checked    |                |                |
| tyAreaRRC-Inac |                |                |                |
| tiveOutsideIni |                |                |                |
| tialUL-BWP-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-PRS-Meas    | Not checked    |                |                |
| urementWithRxF |                |                |                |
| H-RRC-Connecte |                |                |                |
| dForRedCap-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| posSRS-TxF     | Not checked    |                |                |
| H-RRC-Connecte |                |                |                |
| dForRedCap-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| posSRS-Tx      | Not checked    |                |                |
| FH-RRC-Inactiv |                |                |                |
| eForRedCap-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| posSRS-BWA-RR  | Not checked    |                |                |
| C-Inactive-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| po             | Not checked    |                |                |
| sJointTriggerB |                |                |                |
| ySingleDCI-RRC |                |                |                |
| -Connected-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-PRS-Mea     | Not checked    |                |                |
| surementWithRx |                |                |                |
| FH-RRC-Inactiv |                |                |                |
| eforRedCap-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-PRS         | Not checked    |                |                |
| -MeasurementWi |                |                |                |
| thRxFH-RRC-Idl |                |                |                |
| eforRedCap-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| spatia         | Not checked    |                |                |
| lAdaptation-CS |                |                |                |
| I-Feedback-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| spatialAdap    | Not checked    |                |                |
| tation-CSI-Fee |                |                |                |
| dbackPUSCH-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| s              | Not checked    |                |                |
| patialAdaptati |                |                |                |
| on-CSI-Feedbac |                |                |                |
| kAperiodic-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| spatialAdap    | Not checked    |                |                |
| tation-CSI-Fee |                |                |                |
| dbackPUCCH-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| powe           | Not checked    |                |                |
| rAdaptation-CS |                |                |                |
| I-Feedback-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| powerAdap      | Not checked    |                |                |
| tation-CSI-Fee |                |                |                |
| dbackPUSCH-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| powerAdaptati  | Not checked    |                |                |
| on-CSI-Feedbac |                |                |                |
| kAperiodic-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| powerAdap      | Not checked    |                |                |
| tation-CSI-Fee |                |                |                |
| dbackPUCCH-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| nes-C          | Checked        |                | pc\_nes        |
| ellDTX-DRX-r18 |                |                | \_CellDTX\_r18 |
|                |                |                | and/or         |
|                |                |                | pc\_nes        |
|                |                |                | \_CellDRX\_r18 |
+----------------+----------------+----------------+----------------+
| nes-CellDTX-   | Checked        |                | pc\_nes        |
| DRX-DCI2-9-r18 |                |                | \_CellDTX\_DRX |
|                |                |                | \_DCI2\_9\_r18 |
+----------------+----------------+----------------+----------------+
| mixC           | Not checked    |                |                |
| odeBookSpatial |                |                |                |
| Adaptation-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| simulta        | Not checked    |                |                |
| neousCSI-SubRe |                |                |                |
| portsPerCC-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ntn-DMRS-Bu    | Not checked    |                |                |
| ndlingNGSO-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| lt             | Not checked    |                |                |
| m-BeamIndicati |                |                |                |
| onJointTCI-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| d              | Not checked    |                |                |
| ummy-ltm-MAC-C |                |                |                |
| E-JointTCI-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ltm-B          | Not checked    |                |                |
| eamIndicationS |                |                |                |
| eparateTCI-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| dumm           | Not checked    |                |                |
| y-ltm-MAC-CE-S |                |                |                |
| eparateTCI-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| rach-EarlyTA-M | Not checked    |                |                |
| easurement-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ue-TA-M        | Not checked    |                |                |
| easurement-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ta-Indication  | Not checked    |                |                |
| CellSwitch-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| triggered      | Not checked    |                |                |
| HARQ-CodebookR |                |                |                |
| etxDCI-1-3-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| unifiedJoin    | Not checked    |                |                |
| tTCI-MultiMAC- |                |                |                |
| CE-DCI-1-3-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| un             | Not checked    |                |                |
| ifiedSeparateT |                |                |                |
| CI-MultiMAC-CE |                |                |                |
| -IntraCell-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| mul            | Not checked    |                |                |
| tiPUSCH-CG-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| multiPUS       | Not checked    |                |                |
| CH-ActiveConfi |                |                |                |
| guredGrant-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| joint          | Not checked    |                |                |
| ReleaseDCI-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| cg-PUSCH-U     | Not checked    |                |                |
| TO-UCI-Ind-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| pdcch-Monitori | Not checked    |                |                |
| ngResumptionAf |                |                |                |
| terUL-NACK-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| support        | Not checked    |                |                |
| 3MHz-ChannelBW |                |                |                |
| -Symmetric-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| support3       | Not checked    |                |                |
| MHz-ChannelBW- |                |                |                |
| Asymmetric-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| support12PR    | Not checked    |                |                |
| B-CORESET0-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr             | Not checked    |                |                |
| -PDCCH-Overlap |                |                |                |
| LTE-CRS-RE-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr             | Not checked    |                |                |
| -PDCCH-Overlap |                |                |                |
| LTE-CRS-RE-Mul |                |                |                |
| tiPatterns-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-PDCCH-Ov    | Not checked    |                |                |
| erlapLTE-CRS-R |                |                |                |
| E-Span-3-4-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| twoRateMatchi  | Not checked    |                |                |
| ngEUTRA-CRS-pa |                |                |                |
| tterns-3-4-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ov             | Not checked    |                |                |
| erlapRateMatch |                |                |                |
| ingEUTRA-CRS-P |                |                |                |
| atterns-3-4-Di |                |                |                |
| ff-CS-Pool-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ncd-S          | Not checked    |                |                |
| SB-BWP-Wor-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| rlm-BM-BFD     | Not checked    |                |                |
| -CSI-RS-Outsid |                |                |                |
| eActiveBWP-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| prach-C        | Checked        |                | pc\_prach\_Co  |
| overageEnh-r18 |                |                | verageEnh\_r18 |
+----------------+----------------+----------------+----------------+
| prach-         | Not checked    |                |                |
| Repetition-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicWave    | Not checked    |                |                |
| formSwitch-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicWavefor | Not checked    |                |                |
| mSwitchPHR-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| dyna           | Not checked    |                |                |
| micWaveformSwi |                |                |                |
| tchIntraCA-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| multiPUSC      | Not checked    |                |                |
| H-SingleDCI-No |                |                |                |
| nConsSlots-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| pdc            | Not checked    |                |                |
| -maxNumberPRS- |                |                |                |
| ResourceProces |                |                |                |
| sedPerSlot-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| intraSlot      | Not checked    |                |                |
| -PDSCH-Multica |                |                |                |
| stInactive-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| multica        | Not checked    |                |                |
| stInactive-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| thres          | Not checked    |                |                |
| holdBasedMulti |                |                |                |
| castResume-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| lowerMSD-r18   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| low            | Not checked    |                |                |
| erMSD-ENDC-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| enhancedCha    | Not checked    |                |                |
| nnelRaster-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| fastBeamSweep  | Not checked    |                |                |
| ingMultiRx-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| bea            | Not checked    |                |                |
| mSweepingFacto |                |                |                |
| rReduction-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| sim            | Not checked    |                |                |
| ultaneousRecep |                |                |                |
| tionTwoQCL-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| measEnhCAIn    | Not checked    |                |                |
| terFreqFR2-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| tci-Stat       | Not checked    |                |                |
| eSwitchInd-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| antenn         | Not checked    |                |                |
| aArrayType-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| loca           | Not checked    |                |                |
| tionBasedCondH |                |                |                |
| andoverATG-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxOutp        | Not checked    |                |                |
| utPowerATG-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ltm-FastProces | Not checked    |                |                |
| singConfig-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| measValidatio  | Not checked    |                |                |
| nReportEMR-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| measV          | Not checked    |                |                |
| alidationRepor |                |                |                |
| tReselectionMe |                |                |                |
| asurements-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| eve            | Not checked    |                |                |
| ntA4BasedCondH |                |                |                |
| andoverNES-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| nes            | Not checked    |                |                |
| BasedCondHando |                |                |                |
| verWithDCI-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| rach-Less      | Not checked    |                |                |
| HandoverCG-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| rach-Less      | Not checked    |                |                |
| HandoverDG-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| loca           | Not checked    |                |                |
| tionBasedCondH |                |                |                |
| andoverEMC-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| mt-CG-SDT-r18  | Checked        |                | pc\_mt         |
|                |                |                | \_CG\_SDT\_r18 |
+----------------+----------------+----------------+----------------+
| posSRS         | Not checked    |                |                |
| -PreconfigureR |                |                |                |
| RC-InactiveIni |                |                |                |
| tialUL-BWP-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| posSRS-Precon  | Not checked    |                |                |
| figureRRC-Inac |                |                |                |
| tiveOutsideIni |                |                |                |
| tialUL-BWP-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| cg-SDT-Peri    | Checked        |                | pc\_           |
| odicityExt-r18 |                |                | cg\_SDT\_Perio |
|                |                |                | dicityExt\_r18 |
+----------------+----------------+----------------+----------------+
| supp           | Checked        |                | pc\_suppo      |
| ortOf2RxXR-r18 |                |                | rtOf2RxXR\_r18 |
+----------------+----------------+----------------+----------------+
| condHa         | Checked        |                | pc\_condHand   |
| ndoverWithCand |                |                | overWithCandSC |
| SCG-change-r18 |                |                | G\_change\_r18 |
+----------------+----------------+----------------+----------------+
| mac-Paramet    | Not checked    |                |                |
| ersPerBand-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBW-DL-NCR-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| channe         | Not checked    |                |                |
| lBW-UL-NCR-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ncr-PDSCH      | Not checked    |                |                |
| -64QAM-FR2-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ltm-MCG        | Checked        |                | pc\_ltm\_MCG\_ |
| -IntraFreq-r18 |                |                | IntraFreq\_r18 |
+----------------+----------------+----------------+----------------+
| ltm-SCG        | Checked        |                | pc\_ltm\_SCG\_ |
| -IntraFreq-r18 |                |                | IntraFreq\_r18 |
+----------------+----------------+----------------+----------------+
| ltm-MAC-C      | Checked        |                | pc\            |
| E-JointTCI-r18 |                |                | _ltm\_MAC\_CE\ |
|                |                |                | _JointTCI\_r18 |
+----------------+----------------+----------------+----------------+
| ltm-MAC-CE-S   | Checked        |                | pc\_lt         |
| eparateTCI-r18 |                |                | m\_MAC\_CE\_Se |
|                |                |                | parateTCI\_r18 |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| supportedBandC |                |                |                |
| ombinationList |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1.            |                |                |                |
| .maxBandComb)) |                |                |                |
| OF             |                |                |                |
| B              |                |                |                |
| andCombination |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| B              |                |                |                |
| andCombination |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| bandList       |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxSimul   |                |                |                |
| taneousBands)) |                |                |                |
| OF             |                |                |                |
| BandParameters |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| BandParameters |                |                |                |
| CHOICE {       |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra SEQUENCE |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| bandEUTRA      | Not checked    | FreqBand       |                |
|                |                | IndicatorEUTRA |                |
+----------------+----------------+----------------+----------------+
| ca-Bandwidt    | Not checked    | CA-Bandw       |                |
| hClassDL-EUTRA |                | idthClassEUTRA |                |
+----------------+----------------+----------------+----------------+
| ca-Bandwidt    | Not checked    | CA-Bandw       |                |
| hClassUL-EUTRA |                | idthClassEUTRA |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| nr SEQUENCE {  |                |                |                |
+----------------+----------------+----------------+----------------+
| bandNR         | Not checked    | FreqB          |                |
|                |                | andIndicatorNR |                |
+----------------+----------------+----------------+----------------+
| ca-Bandw       | Not checked    | CA-Ba          |                |
| idthClassDL-NR |                | ndwidthClassNR |                |
+----------------+----------------+----------------+----------------+
| ca-Bandw       | Not checked    | CA-Ba          |                |
| idthClassUL-NR |                | ndwidthClassNR |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| feature        | Not checked    | FeatureSe      |                |
| SetCombination |                | tCombinationId |                |
+----------------+----------------+----------------+----------------+
| ca-P           | Not checked    | CA-P           |                |
| arametersEUTRA |                | arametersEUTRA |                |
+----------------+----------------+----------------+----------------+
| c              | Not checked    | C              |                |
| a-ParametersNR |                | A-ParametersNR |                |
+----------------+----------------+----------------+----------------+
| m              | Not checked    | M              |                |
| rdc-Parameters |                | RDC-Parameters |                |
+----------------+----------------+----------------+----------------+
| supp           | Not checked    |                |                |
| ortedBandwidth |                |                |                |
| CombinationSet |                |                |                |
+----------------+----------------+----------------+----------------+
| po             | Not checked    |                |                |
| werClass-v1530 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| appliedFreq    | Not checked    | FreqBandList   |                |
| BandListFilter |                |                |                |
+----------------+----------------+----------------+----------------+
|                |                | BandCombina    |                |
| suppor         |                | tionList-v1610 |                |
| tedBandCombina |                |                |                |
| tionList-v1610 |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1.            |                |                |                |
| .maxBandComb)) |                |                |                |
| OF             |                |                |                |
| BandCom        |                |                |                |
| bination-v1610 |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| BandCom        |                |                |                |
| bination-v1610 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| bandList-v1610 |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxSimul   |                |                |                |
| taneousBands)) |                |                |                |
| OF             |                |                |                |
| BandPa         |                |                |                |
| rameters-v1610 |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| ca-Para        | Checked        | CA-Para        |                |
| metersNR-v1610 |                | metersNR-v1610 |                |
|                |                | (Table         |                |
|                |                | 8              |                |
|                |                | .1.5.1.1.3.3-8 |                |
+----------------+----------------+----------------+----------------+
| ca-Parame      | Not checked    | CA-Parame      |                |
| tersNRDC-v1610 |                | tersNRDC-v1610 |                |
+----------------+----------------+----------------+----------------+
| po             | Not checked    |                |                |
| werClass-v1610 |                |                |                |
+----------------+----------------+----------------+----------------+
| powerC         | Not checked    |                |                |
| lassNRPart-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| f              | Not checked    | FeatureSe      |                |
| eatureSetCombi |                | tCombinationId |                |
| nationDAPS-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| mrdc-Pa        | Not checked    | MRDC-Pa        |                |
| rameters-v1620 |                | rameters-v1620 |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    | BandCombina    |                |
| tedBandCombina |                | tionListSideli |                |
| tionListSideli |                | nkEUTRA-NR-r16 |                |
| nkEUTRA-NR-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| suppo          | Not checked    | BandCombin     |                |
| rtedBandCombin |                | ationList-Upli |                |
| ationList-Upli |                | nkTxSwitch-r16 |                |
| nkTxSwitch-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| extend         | Checked        |                | pc\_extended   |
| edBand-n77-r16 |                |                | Band\_n77\_r16 |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    | BandCombina    |                |
| tedBandCombina |                | tionList-v1700 |                |
| tionList-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| support        | Not checked    | BandCombinat   |                |
| edBandCombinat |                | ionList-Uplink |                |
| ionList-Uplink |                | TxSwitch-v1700 |                |
| TxSwitch-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| support        | Not checked    |                |                |
| edBandCombinat |                |                |                |
| ionListSL-Rela |                |                |                |
| yDiscovery-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| supportedB     | Not checked    |                |                |
| andCombination |                |                |                |
| ListSL-NonRela |                |                |                |
| yDiscovery-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| supporte       | Not checked    | BandCombinati  |                |
| dBandCombinati |                | onListSidelink |                |
| onListSidelink |                | EUTRA-NR-v1710 |                |
| EUTRA-NR-v1710 |                |                |                |
+----------------+----------------+----------------+----------------+
| sidelin        | Not checked    |                |                |
| kRequested-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| extended       | Checked        |                | p              |
| Band-n77-2-r17 |                |                | c\_extendedBan |
|                |                |                | d\_n77\_2\_r17 |
+----------------+----------------+----------------+----------------+
| suppor         |                | BandCombina    |                |
| tedBandCombina |                | tionList-v1800 |                |
| tionList-v1800 |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1.            |                |                |                |
| .maxBandComb)) |                |                |                |
| OF             |                |                |                |
| BandCom        |                |                |                |
| bination-v1800 |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| BandCom        |                |                |                |
| bination-v1800 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ca-Para        | Checked        | CA-Para        |                |
| metersNR-v1800 |                | metersNR-v1800 |                |
|                |                | (Table         |                |
|                |                | 8.1            |                |
|                |                | .5.1.1.3.3-14) |                |
+----------------+----------------+----------------+----------------+
| ca-Parame      | Not checked    |                |                |
| tersNRDC-v1800 |                |                |                |
+----------------+----------------+----------------+----------------+
| supportedB     | Not checked    |                |                |
| andCombListPer |                |                |                |
| BC-SL-U2U-Rela |                |                |                |
| yDiscovery-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| bandList-v1810 | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| support        | Not checked    |                |                |
| edBandCombinat |                |                |                |
| ionList-Uplink |                |                |                |
| TxSwitch-v1800 |                |                |                |
+----------------+----------------+----------------+----------------+
| su             | Not checked    |                |                |
| pportedBandCom |                |                |                |
| binationListSL |                |                |                |
| -U2U-Relay-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measAn         |                |                |                |
| dMobParameters |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPa   |                |                |                |
| rametersCommon |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| suppo          | Checked        | Acc. to TS     | pc\_gp2\_nr,   |
| rtedGapPattern |                | 38.306 \[23\]  | pc\_gp3\_nr,   |
|                |                | clause 4.2.9:  | pc\_gp4\_nr,   |
|                |                | Indicates      | pc\_gp5\_nr,   |
|                |                | measurement    | pc\_gp6\_nr,   |
|                |                | gap pattern(s) | pc\_gp7\_nr,   |
|                |                | optionally     | pc\_gp8\_nr,   |
|                |                | supported by   | pc\_gp9\_nr,   |
|                |                | the UE for NR  | pc\_gp10\_nr,  |
|                |                | SA. The        | pc\_gp11\_nr,  |
|                |                | leading /      | pc\_gp12\_nr,  |
|                |                | leftmost bit   | pc\_gp15\_nr,  |
|                |                | (bit 0)        | pc\_gp16\_nr,  |
|                |                | corresponds to | pc\_gp17\_nr,  |
|                |                | the gap        | pc\_gp18\_nr,  |
|                |                | pattern 2, the | pc\_gp19\_nr,  |
|                |                | next bit       | pc\_gp20\_nr,  |
|                |                | corresponds to | pc\_gp21\_nr,  |
|                |                | the gap        | pc\_gp22\_nr,  |
|                |                | pattern 3, as  | pc\_gp23\_nr   |
|                |                | specified in   |                |
|                |                | TS 38.133      |                |
|                |                | \[10\] and so  |                |
|                |                | on. The UE     |                |
|                |                | shall set the  |                |
|                |                | bits           |                |
|                |                | corresponding  |                |
|                |                | to the         |                |
|                |                | measurement    |                |
|                |                | gap pattern    |                |
|                |                | 13, 14, 17, 18 |                |
|                |                | and 19 to 1 if |                |
|                |                | the UE is an   |                |
|                |                | NR standalone  |                |
|                |                | capable UE     |                |
|                |                | that supports  |                |
|                |                | a band in FR2. |                |
+----------------+----------------+----------------+----------------+
| ssb-RLM        | supported      |                |                |
+----------------+----------------+----------------+----------------+
| ssb            | Not checked    |                |                |
| -AndCSI-RS-RLM |                |                |                |
+----------------+----------------+----------------+----------------+
| eventB         | Checked        |                | pc\_eventB\    |
| -MeasAndReport |                |                | _MeasAndReport |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverFDD-TDD |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra          | Checked        |                | pc\_eutra\_    |
| -CGI-Reporting |                |                | CGI\_Reporting |
+----------------+----------------+----------------+----------------+
| nr             | Checked        |                | pc\_nr\_       |
| -CGI-Reporting |                |                | CGI\_Reporting |
+----------------+----------------+----------------+----------------+
| indepe         | Checked        |                | pc\_indepe     |
| ndentGapConfig |                |                | ndentGapConfig |
+----------------+----------------+----------------+----------------+
| periodicEUTRA  | Checked        |                | pc\_           |
| -MeasAndReport |                |                | periodicEUTRA\ |
|                |                |                | _MeasAndReport |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverFR1-FR2 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumberCSI-  | Not checked    |                |                |
| RS-RRM-RS-SINR |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Not checked    |                |                |
| repor          |                |                |                |
| tAddNeighMeasF |                |                |                |
| orPeriodic-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| cond           | Not checked    |                |                |
| HandoverParame |                |                |                |
| tersCommon-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-NeedForGap  | Not checked    |                |                |
| -Reporting-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| su             | Not checked    |                |                |
| pportedGapPatt |                |                |                |
| ern-NRonly-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| support        | Not checked    |                |                |
| edGapPattern-N |                |                |                |
| Ronly-NEDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumb        | Not checked    |                |                |
| erCLI-RSSI-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumberCL    | Not checked    |                |                |
| I-SRS-RSRP-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| maxN           | Not checked    |                |                |
| umberPerSlotCL |                |                |                |
| I-SRS-RSRP-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| mfbi-IAB-r16   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| nr-CGI-Rep     | Checked        |                | pc\_           |
| orting-NPN-r16 |                |                | nr\_CGI\_Repor |
|                |                |                | ting\_NPN\_r16 |
+----------------+----------------+----------------+----------------+
| idle           | Checked        |                | pc\_i          |
| InactiveEUTRA- |                |                | dleInactiveEUT |
| MeasReport-r16 |                |                | RA\_MeasReport |
+----------------+----------------+----------------+----------------+
| i              | Not checked    |                |                |
| dleInactive-Va |                |                |                |
| lidityArea-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra-Auto     | Not checked    |                |                |
| nomousGaps-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| e              | Not checked    |                |                |
| utra-Autonomou |                |                |                |
| sGaps-NEDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| e              | Not checked    |                |                |
| utra-Autonomou |                |                |                |
| sGaps-NRDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| pcellT312-r16  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| supported      | Not checked    |                |                |
| GapPattern-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| concurr        | Not checked    |                |                |
| entMeasGap-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-            | Not checked    |                |                |
| NeedForGapNCSG |                |                |                |
| -Reporting-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra-         | Not checked    |                |                |
| NeedForGapNCSG |                |                |                |
| -Reporting-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ncsg-Me        | Not checked    |                |                |
| asGapPerFR-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ncsg-MeasG     | Not checked    |                |                |
| apPatterns-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ncsg-MeasGapN  | Not checked    |                |                |
| R-Patterns-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| preconfig      | Not checked    |                |                |
| uredUE-Autonom |                |                |                |
| ousMeasGap-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| preconfig      | Not checked    |                |                |
| uredNW-Control |                |                |                |
| ledMeasGap-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| handove        | Not checked    |                |                |
| rFR1-FR2-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| handoverF      | Not checked    |                |                |
| R2-1-FR2-2-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| independentGa  | Not checked    |                |                |
| pConfigPRS-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| rrm-Relax      | Checked        |                | pc             |
| ationRRC-Conne |                |                | \_rrm\_Relaxat |
| ctedRedCap-r17 |                |                | ionRRC\_Connec |
|                |                |                | tedRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| parallelMeas   | Not checked    |                |                |
| urementGap-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| condHandoverWi | Not checked    |                |                |
| thSCG-NRDC-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| gNB-ID-Lengt   | Not checked    |                |                |
| hReporting-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| gNB            | Not checked    |                |                |
| -ID-LengthRepo |                |                |                |
| rting-ENDC-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| gNB            | Not checked    |                |                |
| -ID-LengthRepo |                |                |                |
| rting-NEDC-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| gNB            | Not checked    |                |                |
| -ID-LengthRepo |                |                |                |
| rting-NRDC-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| gN             | Not checked    |                |                |
| B-ID-LengthRep |                |                |                |
| orting-NPN-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ltm            | Checked        |                | pc\_ltm\_      |
| -InterFreq-r18 |                |                | InterFreq\_r18 |
+----------------+----------------+----------------+----------------+
| lt             | Checked        |                | pc\_ltm\_      |
| m-MCG-NRDC-r18 |                |                | MCG\_NRDC\_r18 |
+----------------+----------------+----------------+----------------+
| ltm-R          | Checked        |                | pc\_ltm\_RAC   |
| ACH-LessDG-r18 |                |                | H\_LessDG\_r18 |
+----------------+----------------+----------------+----------------+
| ltm-R          | Checked        |                | pc\_ltm\_RAC   |
| ACH-LessCG-r18 |                |                | H\_LessCG\_r18 |
+----------------+----------------+----------------+----------------+
| lt             | Checked        |                | pc\_ltm\       |
| m-Recovery-r18 |                |                | _Recovery\_r18 |
+----------------+----------------+----------------+----------------+
| ltm-Refer      | Checked        |                | p              |
| enceConfig-r18 |                |                | c\_ltm\_Refere |
|                |                |                | nceConfig\_r18 |
+----------------+----------------+----------------+----------------+
| ltm-MCG-NR     | Checked        |                | pc\_           |
| DC-Release-r18 |                |                | ltm\_MCG\_NRDC |
|                |                |                | \_Release\_r18 |
+----------------+----------------+----------------+----------------+
| ltm-FastUE-    |                |                |                |
| Processing-r18 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| fr1-r18        | Checked        |                | pc\_ltm\_      |
|                |                |                | FastUE\_Proces |
|                |                |                | sing\_fr1\_r18 |
+----------------+----------------+----------------+----------------+
| fr2-r18        | Checked        |                | pc\_ltm\_      |
|                |                |                | FastUE\_Proces |
|                |                |                | sing\_fr2\_r18 |
+----------------+----------------+----------------+----------------+
| fr1-AndFR2-r18 | Checked        |                | pc\            |
|                |                |                | _ltm\_FastUE\_ |
|                |                |                | Processing\_fr |
|                |                |                | 1\_AndFR2\_r18 |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| ntn-           | Not checked    |                |                |
| NeighbourCellI |                |                |                |
| nfoSupport-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ltm-interFreqL | Checked        |                | pc\_ltm        |
| 1-OnlyInBC-r18 |                |                | \_interFreqL1\ |
|                |                |                | _OnlyInBC\_r18 |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| intraAndInterF | Checked (NOTE  |                | pc\_i          |
| -MeasAndReport | 1)             |                | ntraAndInterF\ |
|                |                |                | _MeasAndReport |
+----------------+----------------+----------------+----------------+
| eventA         | Checked (NOTE  |                | pc\_eventA\    |
| -MeasAndReport | 2)             |                | _MeasAndReport |
+----------------+----------------+----------------+----------------+
| handoverInterF | Checked (NOTE  |                | pc\_           |
|                | 15)            |                | handoverInterF |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-EPC |                |                |                |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-5GC |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Checked (NOTE  |                | pc\_SFTD\_Meas |
| sft            | 13)            |                | NR\_Neigh\_FDD |
| d-MeasNR-Neigh |                |                |                |
|                |                |                | and/or         |
|                |                |                |                |
|                |                |                | pc\_SFTD\_Meas |
|                |                |                | NR\_Neigh\_TDD |
+----------------+----------------+----------------+----------------+
| sftd-Me        | Not checked    |                |                |
| asNR-Neigh-DRX |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ss-SINR-Meas   | Checked (NOTE  |                | pc\_           |
|                | 10)            |                | ss\_SINR\_Meas |
+----------------+----------------+----------------+----------------+
| csi-RSRP-AndRS | Checked (NOTE  |                | pc\_csi        |
| RQ-MeasWithSSB | 3)             |                | \_RSRP\_AndRSR |
|                |                |                | Q\_MeasWithSSB |
+----------------+----------------+----------------+----------------+
| csi            | Checked (NOTE  |                | pc\_csi\_R     |
| -RSRP-AndRSRQ- | 11)            |                | SRP\_AndRSRQ\_ |
| MeasWithoutSSB |                |                | MeasWithoutSSB |
+----------------+----------------+----------------+----------------+
| csi-SINR-Meas  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| csi-RS-RLM     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| handoverInterF | Checked (NOTE  |                | pc\_*h         |
|                | 14)            |                | andoverInterF* |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-EPC |                |                |                |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-5GC |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Not checked    |                |                |
| nr-Auto        |                |                |                |
| nomousGaps-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-ENDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-NEDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-NRDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| cli            | Not checked    |                |                |
| -RSSI-Meas-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| cli-SRS        | Not checked    |                |                |
| -RSRP-Meas-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| interFrequency | Not checked    |                |                |
| Meas-NoGap-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| simu           | Not checked    |                |                |
| ltaneousRxData |                |                |                |
| SSB-DiffNumero |                |                |                |
| logy-Inter-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| i              | Checked (NOTE  |                | pc             |
| dleInactiveNR- | 22)            |                | \_idleInactive |
| MeasReport-r16 |                |                | NR\_MeasReport |
+----------------+----------------+----------------+----------------+
| idleI          | Not checked    |                |                |
| nactiveNR-Meas |                |                |                |
| BeamReport-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fdd-Add-UE-N   |                |                |                |
| R-Capabilities |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Para       |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicSFI     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-F0-2  | Not checked    |                |                |
| -ConsecSymbols |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-            | Checked (NOTE  |                | pc\_dl\_Sc     |
| SchedulingOffs | 17)            |                | hedulingOffset |
| et-PDSCH-TypeA |                |                | \_PDSCH\_TypeA |
+----------------+----------------+----------------+----------------+
| dl-            | Not checked    |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeB |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-Sc          | Not checked    |                |                |
| hedulingOffset |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Para       |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| skipU          | Checked (NOTE  |                | pc\_skipU      |
| plinkTxDynamic | 4)             |                | plinkTxDynamic |
+----------------+----------------+----------------+----------------+
| logicalChanne  | Checked (NOTE  |                | pc\_           |
| lSR-DelayTimer | 5)             |                | logicalChannel |
|                |                |                | SR\_DelayTimer |
+----------------+----------------+----------------+----------------+
| longDRX-Cycle  | Checked (NOTE  |                | pc\_           |
|                | 6)             |                | longDRX\_Cycle |
+----------------+----------------+----------------+----------------+
| shortDRX-Cycle | Checked (NOTE  |                | pc\_s          |
|                | 7)             |                | hortDRX\_Cycle |
+----------------+----------------+----------------+----------------+
| multipleSR-    | Not checked    |                |                |
| Configurations |                |                |                |
+----------------+----------------+----------------+----------------+
| multipleCo     | Checked (NOTE  |                | pc\_multipleCo |
| nfiguredGrants | 12)            |                | nfiguredGrants |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| intraAndInterF | Checked (NOTE  |                | pc\_i          |
| -MeasAndReport | 1)             |                | ntraAndInterF\ |
|                |                |                | _MeasAndReport |
+----------------+----------------+----------------+----------------+
| eventA         | Checked (NOTE  |                | pc\_eventA\    |
| -MeasAndReport | 2)             |                | _MeasAndReport |
+----------------+----------------+----------------+----------------+
| handoverInterF | Checked (NOTE  |                | pc\_           |
|                | 15)            |                | handoverInterF |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-EPC |                |                |                |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-5GC |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Checked (NOTE  |                | pc\_SFTD\_Meas |
| sft            | 13)            |                | NR\_Neigh\_FDD |
| d-MeasNR-Neigh |                |                |                |
+----------------+----------------+----------------+----------------+
| sftd-Me        | Not checked    |                |                |
| asNR-Neigh-DRX |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| tdd-Add-UE-N   |                |                |                |
| R-Capabilities |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Para       |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicSFI     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-F0-2  | Not checked    |                |                |
| -ConsecSymbols |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-            | Checked (NOTE  |                | pc\_dl\_Sc     |
| SchedulingOffs | 17)            |                | hedulingOffset |
| et-PDSCH-TypeA |                |                | \_PDSCH\_TypeA |
+----------------+----------------+----------------+----------------+
| dl-            | Not checked    |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeB |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-Sc          | Not checked    |                |                |
| hedulingOffset |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Para       |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| skipU          | Checked (NOTE  |                | pc\_skipU      |
| plinkTxDynamic | 4)             |                | plinkTxDynamic |
+----------------+----------------+----------------+----------------+
| logicalChanne  | Checked (NOTE  |                | pc\_           |
| lSR-DelayTimer | 5)             |                | logicalChannel |
|                |                |                | SR\_DelayTimer |
+----------------+----------------+----------------+----------------+
| longDRX-Cycle  | Checked (NOTE  |                | pc\_           |
|                | 6)             |                | longDRX\_Cycle |
+----------------+----------------+----------------+----------------+
| shortDRX-Cycle | Checked (NOTE  |                | pc\_s          |
|                | 7)             |                | hortDRX\_Cycle |
+----------------+----------------+----------------+----------------+
| multipleSR-    | Not checked    |                |                |
| Configurations |                |                |                |
+----------------+----------------+----------------+----------------+
| multipleCo     | Checked (NOTE  |                | pc\_multipleCo |
| nfiguredGrants | 12)            |                | nfiguredGrants |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| intraAndInterF | Checked (NOTE  |                | pc\_i          |
| -MeasAndReport | 1)             |                | ntraAndInterF\ |
|                |                |                | _MeasAndReport |
+----------------+----------------+----------------+----------------+
| eventA         | Checked (NOTE  |                | pc\_eventA\    |
| -MeasAndReport | 2)             |                | _MeasAndReport |
+----------------+----------------+----------------+----------------+
| handoverInterF | Checked (NOTE  |                | pc\_           |
|                | 15)            |                | handoverInterF |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-EPC |                |                |                |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-5GC |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Checked (NOTE  |                | pc\_SFTD\_Meas |
| sft            | 13)            |                | NR\_Neigh\_TDD |
| d-MeasNR-Neigh |                |                |                |
+----------------+----------------+----------------+----------------+
| sftd-Me        | Not checked    |                |                |
| asNR-Neigh-DRX |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fr1-Add-UE-N   |                |                |                |
| R-Capabilities |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Para       |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicSFI     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy1         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoFL-DMRS     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy2         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy3         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    |                |                |
| tedDMRS-TypeDL |                |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    |                |                |
| tedDMRS-TypeUL |                |                |                |
+----------------+----------------+----------------+----------------+
| s              | Not checked    |                |                |
| emiOpenLoopCSI |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-Re         | Not checked    |                |                |
| portWithoutPMI |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-Re         | Not checked    |                |                |
| portWithoutCQI |                |                |                |
+----------------+----------------+----------------+----------------+
| onePortsPTRS   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-F0-2  | Not checked    |                |                |
| -ConsecSymbols |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F2-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F3-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F4-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch          | Not checked    |                |                |
| -F0-2WithoutFH |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-F        | Not checked    |                |                |
| 1-3-4WithoutFH |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-HAR     | Not checked    |                |                |
| Q-ACK-CSI-PUCC |                |                |                |
| H-MultiPerSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| uci-CodeBlo    | Not checked    |                |                |
| ckSegmentation |                |                |                |
+----------------+----------------+----------------+----------------+
| onePUCCH-Long  | Not checked    |                |                |
| AndShortFormat |                |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-A     | Checked (NOTE  |                | p              |
| nyOthersInSlot | 26)            |                | c\_twoPUCCH\_A |
|                |                |                | nyOthersInSlot |
+----------------+----------------+----------------+----------------+
| intraSlotFre   | Not checked    |                |                |
| qHopping-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| pusch-LBRM     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| pdcch-Bl       | Not checked    |                |                |
| indDetectionCA |                |                |                |
+----------------+----------------+----------------+----------------+
| tpc-PUSCH-RNTI | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tpc-PUCCH-RNTI | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tpc-SRS-RNTI   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| absol          | Not checked    |                |                |
| uteTPC-Command |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| pus            | Not checked    |                |                |
| ch-HalfPi-BPSK |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-F3       | Not checked    |                |                |
| -4-HalfPi-BPSK |                |                |                |
+----------------+----------------+----------------+----------------+
| almostContig   | Not checked    |                |                |
| uousCP-OFDM-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| sp-CSI-RS      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| sp-CSI-IM      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tdd-MultiDL-UL | Not checked    |                |                |
| -SwitchPerSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| m              | Not checked    |                |                |
| ultipleCORESET |                |                |                |
+----------------+----------------+----------------+----------------+
| cs             | Not checked    |                |                |
| i-RS-IM-Recept |                |                |                |
| ionForFeedback |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-RS-ProcF   | Not checked    |                |                |
| rameworkForSRS |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-R          | Not checked    |                |                |
| eportFramework |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-HA      |                |                |                |
| RQ-ACK-CSI-PUC |                |                |                |
| CH-OncePerSlot |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| sameSymbol     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| diffSymbol     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-        | Not checked    |                |                |
| HARQ-ACK-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| mux            | Not checked    |                |                |
| -MultipleGroup |                |                |                |
| CtrlCH-Overlap |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-            | Checked (NOTE  |                | pc\_dl\_Sc     |
| SchedulingOffs | 18)            |                | hedulingOffset |
| et-PDSCH-TypeA |                |                | \_PDSCH\_TypeA |
+----------------+----------------+----------------+----------------+
| dl-            | Not checked    |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeB |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-Sc          | Not checked    |                |                |
| hedulingOffset |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-64QA        | Not checked    |                |                |
| M-MCS-TableAlt |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-64QA        | Not checked    |                |                |
| M-MCS-TableAlt |                |                |                |
+----------------+----------------+----------------+----------------+
| cqi-TableAlt   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| one            | Not checked    |                |                |
| FL-DMRS-TwoAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| two            | Not checked    |                |                |
| FL-DMRS-TwoAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| oneFL          | Not checked    |                |                |
| -DMRS-ThreeAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ss-SINR-Meas   | Checked (NOTE  |                | pc\_           |
|                | 10)            |                | ss\_SINR\_Meas |
+----------------+----------------+----------------+----------------+
| csi-RSRP-AndRS | Checked (NOTE  |                | pc\_csi        |
| RQ-MeasWithSSB | 3)             |                | \_RSRP\_AndRSR |
|                |                |                | Q\_MeasWithSSB |
+----------------+----------------+----------------+----------------+
| csi            | Checked (NOTE  |                | pc\_csi\_R     |
| -RSRP-AndRSRQ- | 11)            |                | SRP\_AndRSRQ\_ |
| MeasWithoutSSB |                |                | MeasWithoutSSB |
+----------------+----------------+----------------+----------------+
| csi-SINR-Meas  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| csi-RS-RLM     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| handoverInterF | Checked (NOTE  |                | pc\_*h         |
|                | 14)            |                | andoverInterF* |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-EPC |                |                |                |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-5GC |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Not checked    |                |                |
| nr-Auto        |                |                |                |
| nomousGaps-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-ENDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-NEDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-NRDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| cli            | Not checked    |                |                |
| -RSSI-Meas-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| cli-SRS        | Not checked    |                |                |
| -RSRP-Meas-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| interFrequency | Not checked    |                |                |
| Meas-NoGap-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| simu           | Not checked    |                |                |
| ltaneousRxData |                |                |                |
| SSB-DiffNumero |                |                |                |
| logy-Inter-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| i              | Checked (NOTE  |                | pc             |
| dleInactiveNR- | 22)            |                | \_idleInactive |
| MeasReport-r16 |                |                | NR\_MeasReport |
+----------------+----------------+----------------+----------------+
| idleI          | Not checked    |                |                |
| nactiveNR-Meas |                |                |                |
| BeamReport-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fr2-Add-UE-N   |                |                |                |
| R-Capabilities |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Para       | Not checked    |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicSFI     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy1         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoFL-DMRS     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy2         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy3         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    |                |                |
| tedDMRS-TypeDL |                |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    |                |                |
| tedDMRS-TypeUL |                |                |                |
+----------------+----------------+----------------+----------------+
| s              | Not checked    |                |                |
| emiOpenLoopCSI |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-Re         | Not checked    |                |                |
| portWithoutPMI |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-Re         | Not checked    |                |                |
| portWithoutCQI |                |                |                |
+----------------+----------------+----------------+----------------+
| onePortsPTRS   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-F0-2  | Not checked    |                |                |
| -ConsecSymbols |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F2-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F3-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F4-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch          | Not checked    |                |                |
| -F0-2WithoutFH |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-F        | Not checked    |                |                |
| 1-3-4WithoutFH |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-HAR     | Not checked    |                |                |
| Q-ACK-CSI-PUCC |                |                |                |
| H-MultiPerSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| uci-CodeBlo    | Not checked    |                |                |
| ckSegmentation |                |                |                |
+----------------+----------------+----------------+----------------+
| onePUCCH-Long  | Not checked    |                |                |
| AndShortFormat |                |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-A     | Checked (NOTE  |                | p              |
| nyOthersInSlot | 26)            |                | c\_twoPUCCH\_A |
|                |                |                | nyOthersInSlot |
+----------------+----------------+----------------+----------------+
| intraSlotFre   | Not checked    |                |                |
| qHopping-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| pusch-LBRM     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| pdcch-Bl       | Not checked    |                |                |
| indDetectionCA |                |                |                |
+----------------+----------------+----------------+----------------+
| tpc-PUSCH-RNTI | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tpc-PUCCH-RNTI | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tpc-SRS-RNTI   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| absol          | Not checked    |                |                |
| uteTPC-Command |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| pus            | Not checked    |                |                |
| ch-HalfPi-BPSK |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-F3       | Not checked    |                |                |
| -4-HalfPi-BPSK |                |                |                |
+----------------+----------------+----------------+----------------+
| almostContig   | Not checked    |                |                |
| uousCP-OFDM-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| sp-CSI-RS      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| sp-CSI-IM      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tdd-MultiDL-UL | Not checked    |                |                |
| -SwitchPerSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| m              | Not checked    |                |                |
| ultipleCORESET |                |                |                |
+----------------+----------------+----------------+----------------+
| cs             | Not checked    |                |                |
| i-RS-IM-Recept |                |                |                |
| ionForFeedback |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-RS-ProcF   | Not checked    |                |                |
| rameworkForSRS |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-R          | Not checked    |                |                |
| eportFramework |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-HA      |                |                |                |
| RQ-ACK-CSI-PUC |                |                |                |
| CH-OncePerSlot |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| sameSymbol     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| diffSymbol     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-        | Not checked    |                |                |
| HARQ-ACK-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| mux            | Not checked    |                |                |
| -MultipleGroup |                |                |                |
| CtrlCH-Overlap |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-            | Checked (NOTE  |                | pc\_dl\_Sc     |
| SchedulingOffs | 18)            |                | hedulingOffset |
| et-PDSCH-TypeA |                |                | \_PDSCH\_TypeA |
+----------------+----------------+----------------+----------------+
| dl-            | Not checked    |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeB |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-Sc          | Not checked    |                |                |
| hedulingOffset |                |                |                |
+----------------+----------------+----------------+----------------+
| dl-64QA        | Not checked    |                |                |
| M-MCS-TableAlt |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-64QA        | Not checked    |                |                |
| M-MCS-TableAlt |                |                |                |
+----------------+----------------+----------------+----------------+
| cqi-TableAlt   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| one            | Not checked    |                |                |
| FL-DMRS-TwoAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| two            | Not checked    |                |                |
| FL-DMRS-TwoAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| oneFL          | Not checked    |                |                |
| -DMRS-ThreeAdd |                |                |                |
| itionalDMRS-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ss-SINR-Meas   | Checked (NOTE  |                | pc\_           |
|                | 10)            |                | ss\_SINR\_Meas |
+----------------+----------------+----------------+----------------+
| csi-RSRP-AndRS | Checked (NOTE  |                | pc\_csi        |
| RQ-MeasWithSSB | 3)             |                | \_RSRP\_AndRSR |
|                |                |                | Q\_MeasWithSSB |
+----------------+----------------+----------------+----------------+
| csi            | Checked (NOTE  |                | pc\_csi\_R     |
| -RSRP-AndRSRQ- | 11)            |                | SRP\_AndRSRQ\_ |
| MeasWithoutSSB |                |                | MeasWithoutSSB |
+----------------+----------------+----------------+----------------+
| csi-SINR-Meas  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| csi-RS-RLM     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| handoverInterF | Checked (NOTE  |                | pc\_*h         |
|                | 14)            |                | andoverInterF* |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-EPC |                |                |                |
+----------------+----------------+----------------+----------------+
| h              | Not checked    |                |                |
| andoverLTE-5GC |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Not checked    |                |                |
| nr-Auto        |                |                |                |
| nomousGaps-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-ENDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-NEDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nr-Autonomou   | Not checked    |                |                |
| sGaps-NRDC-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| cli            | Not checked    |                |                |
| -RSSI-Meas-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| cli-SRS        | Not checked    |                |                |
| -RSRP-Meas-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| interFrequency | Not checked    |                |                |
| Meas-NoGap-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| simu           | Not checked    |                |                |
| ltaneousRxData |                |                |                |
| SSB-DiffNumero |                |                |                |
| logy-Inter-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| i              | Checked (NOTE  |                | pc             |
| dleInactiveNR- | 22)            |                | \_idleInactive |
| MeasReport-r16 |                |                | NR\_MeasReport |
+----------------+----------------+----------------+----------------+
| idleI          | Not checked    |                |                |
| nactiveNR-Meas |                |                |                |
| BeamReport-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| featureSets    |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| featu          |                |                |                |
| reSetsDownlink |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxDownlin |                |                |                |
| kFeatureSets)) |                |                |                |
| OF             |                |                |                |
| Feat           |                |                |                |
| ureSetDownlink |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| Feat           | Not checked    |                |                |
| ureSetDownlink |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| featureSetLis  | Not checked    |                |                |
| tPerDownlinkCC |                |                |                |
+----------------+----------------+----------------+----------------+
| intraBandFr    | Not checked    |                |                |
| eqSeparationDL |                |                |                |
+----------------+----------------+----------------+----------------+
| scalingFactor  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy8         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| s              | Not checked    |                |                |
| cellWithoutSSB |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-RS-MeasS   | Not checked    |                |                |
| CellWithoutSSB |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy1         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| type1-3-CSS    | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| pdcch-Monitori | Not checked    |                |                |
| ngAnyOccasions |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy2         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| ue-SpecificUL  | Not checked    |                |                |
| -DL-Assignment |                |                |                |
+----------------+----------------+----------------+----------------+
| searchSpa      | Not checked    |                |                |
| ceSharingCA-DL |                |                |                |
+----------------+----------------+----------------+----------------+
| time           |                |                |                |
| DurationForQCL |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| scs-60kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-120kHz     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| pdsch-Process  |                |                |                |
| ingType1-Diffe |                |                |                |
| rentTB-PerSlot |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| scs-15kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-30kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-60kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-120kHz     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy3         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy4         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy5         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy6         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy7         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| featureSet     |                |                |                |
| sDownlinkPerCC |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxPerCC   |                |                |                |
| -FeatureSets)) |                |                |                |
| OF             |                |                |                |
| FeatureSe      |                |                |                |
| tDownlinkPerCC |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| FeatureSe      |                |                |                |
| tDownlinkPerCC |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| supportedSubca | Not checked    | Sub            |                |
| rreirSpacingDL |                | carrierSpacing |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    | Supp           |                |
| tedBandwidthDL |                | ortedBandwidth |                |
+----------------+----------------+----------------+----------------+
| c              | Not checked    |                |                |
| hannelBW-90mhz |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumberMI    | Checked        | MIMO-LayersDL  | p              |
| MO-LayersPDSCH |                |                | c\_maxNumberMI |
|                |                |                | MO\_LayersPDSC |
|                |                |                | H\_eightLayers |
|                |                |                |                |
|                |                |                | or             |
|                |                |                |                |
|                |                |                | pc\_maxNumberM |
|                |                |                | IMO\_LayersPDS |
|                |                |                | CH\_fourLayers |
|                |                |                |                |
|                |                |                | or             |
|                |                |                |                |
|                |                |                | pc\_maxNumber  |
|                |                |                | MIMO\_LayersPD |
|                |                |                | SCH\_twoLayers |
+----------------+----------------+----------------+----------------+
| supportedMod   | Not checked    | M              |                |
| ulationOrderDL |                | odulationOrder |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fea            |                |                |                |
| tureSetsUplink |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxUplin   |                |                |                |
| kFeatureSets)) |                |                |                |
| OF             |                |                |                |
| Fe             |                |                |                |
| atureSetUplink |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| Fe             |                |                |                |
| atureSetUplink |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| featureSetL    | Not checked    |                |                |
| istPerUplinkCC |                |                |                |
+----------------+----------------+----------------+----------------+
| scalingFactor  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy3         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| intraBandFr    | Not checked    |                |                |
| eqSeparationUL |                |                |                |
+----------------+----------------+----------------+----------------+
| searchSpa      | Not checked    |                |                |
| ceSharingCA-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy1         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| supporte       | Not checked    | SRS-Resources  |                |
| dSRS-Resources |                |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-Group | Checked        |                | pc\_t          |
|                |                |                | woPUCCH\_group |
+----------------+----------------+----------------+----------------+
| dy             | Checked        |                | pc\_dyna       |
| namicSwitchSUL |                |                | micSwitch\_SUL |
+----------------+----------------+----------------+----------------+
| simultaneo     | Not checked    |                |                |
| usTxSUL-NonSUL |                |                |                |
+----------------+----------------+----------------+----------------+
| pusch-Process  |                |                |                |
| ingType1-Diffe |                |                |                |
| rentTB-PerSlot |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| scs-15kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-30kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-60kHz      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| scs-120kHz     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy2         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| featureS       |                |                |                |
| etsUplinkPerCC |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxPerCC   |                |                |                |
| -FeatureSets)) |                |                |                |
| OF             |                |                |                |
| Feature        |                |                |                |
| SetUplinkPerCC |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| Feature        |                |                |                |
| SetUplinkPerCC |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| supportedSubca | Not checked    | Sub            |                |
| rrierSpacingUL |                | carrierSpacing |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    | Supp           |                |
| tedBandwidthUL |                | ortedBandwidth |                |
+----------------+----------------+----------------+----------------+
| c              | Not checked    |                |                |
| hannelBW-90mHz |                |                |                |
+----------------+----------------+----------------+----------------+
| mimo-CB-PUSCH  | Checked        |                | pc\_nrM        |
| SEQUENCE {     |                |                | IMO\_CB\_PUSCH |
+----------------+----------------+----------------+----------------+
| maxNumberMIMO- | Not checked    |                |                |
| LayersCB-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| maxNumberSRS-  | Not checked    |                |                |
| ResourcePerSet |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| max            | Not checked    |                |                |
| NumberMIMO-Lay |                |                |                |
| ersNonCB-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| supportedMod   | Not checked    | M              |                |
| ulationOrderUL |                | odulationOrder |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Checked        | FeatureSet     |                |
| featureSets    |                | Downlink-v1610 |                |
| Downlink-v1610 |                | (Table         |                |
| SEQUENCE (SIZE |                | 8.             |                |
| (1..           |                | 1.5.1.1.3.3-6) |                |
| maxDownlin     |                |                |                |
| kFeatureSets)) |                |                |                |
| OF             |                |                |                |
| FeatureSet     |                |                |                |
| Downlink-v1610 |                |                |                |
+----------------+----------------+----------------+----------------+
| featureSe      | Checked        | FeatureS       |                |
| tsUplink-v1610 |                | etUplink-v1610 |                |
| SEQUENCE (SIZE |                | (Table         |                |
| (1..           |                | 8.             |                |
| maxUplin       |                | 1.5.1.1.3.3-7) |                |
| kFeatureSets)) |                |                |                |
| OF             |                |                |                |
| FeatureS       |                |                |                |
| etUplink-v1610 |                |                |                |
+----------------+----------------+----------------+----------------+
| f              | Checked        | F              |                |
| eatureSetDownl |                | eatureSetDownl |                |
| inkPerCC-v1620 |                | inkPerCC-v1620 |                |
| SEQUENCE (SIZE |                | (Table         |                |
| (1..           |                | 8.1            |                |
| maxPerCC       |                | .5.1.1.3.3-7a) |                |
| -FeatureSets)) |                |                |                |
| OF             |                |                |                |
| F              |                |                |                |
| eatureSetDownl |                |                |                |
| inkPerCC-v1620 |                |                |                |
+----------------+----------------+----------------+----------------+
| featureSets    | Not checked    |                |                |
| Downlink-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| fe             | Not checked    |                |                |
| atureSetsDownl |                |                |                |
| inkPerCC-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| featureSe      | Checked        | FeatureS       |                |
| tsUplink-v1710 |                | etUplink-v1710 |                |
| SEQUENCE (SIZE |                | (Table         |                |
| (1..           |                | 8.1            |                |
| maxUplin       |                | .5.1.1.3.3-7b) |                |
| kFeatureSets)) |                |                |                |
| OF             |                |                |                |
| FeatureS       |                |                |                |
| etUplink-v1710 |                |                |                |
+----------------+----------------+----------------+----------------+
| featureSetsUpl | Checked        | FeatureSetUpl  |                |
| inkPerCC-v1700 |                | inkPerCC-v1700 |                |
| SEQUENCE (SIZE |                | (Table         |                |
| (1..           |                | 8.1            |                |
| maxPerCC       |                | .5.1.1.3.3-7c) |                |
| -FeatureSets)) |                |                |                |
| OF             |                |                |                |
| FeatureSetUpl  |                |                |                |
| inkPerCC-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| featureS       |                |                |                |
| etCombinations |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1.            |                |                |                |
| .maxFeatureSet |                |                |                |
| Combinations)) |                |                |                |
| OF             |                |                |                |
| Feature        |                |                |                |
| SetCombination |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| Feature        |                |                |                |
| SetCombination |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxSimul   |                |                |                |
| taneousBands)) |                |                |                |
| OF             |                |                |                |
| Feat           |                |                |                |
| ureSetsPerBand |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| Feat           |                |                |                |
| ureSetsPerBand |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxFeatur  |                |                |                |
| eSetsPerBand)) |                |                |                |
| OF FeatureSet  |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| Fe             |                |                |                |
| atureSetCHOICE |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra SEQUENCE |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| do             | Not checked    | FeatureSetEU   |                |
| wnlinkSetEUTRA |                | TRA-DownlinkId |                |
+----------------+----------------+----------------+----------------+
| uplinkSetEUTRA | Not checked    | FeatureSet     |                |
|                |                | EUTRA-UplinkId |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| nr SEQUENCE {  |                |                |                |
+----------------+----------------+----------------+----------------+
| downlinkSetNR  | Not checked    | Featur         |                |
|                |                | eSetDownlinkId |                |
+----------------+----------------+----------------+----------------+
| uplinkSetNR    | Not checked    | Fea            |                |
|                |                | tureSetUpinkId |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| lateNonCri     | Not checked    |                |                |
| ticalExtension |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                |                |                |
| ticalExtension |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| fdd-           |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1530 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra-Para     |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| rsrqMea        | Not checked    |                |                |
| sWidebandEUTRA |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| tdd-           |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1530 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra-Para     |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| rsrqMea        | Not checked    |                |                |
| sWidebandEUTRA |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| dummy          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
|                |                |                |                |
| inter          |                |                |                |
| RAT-Parameters |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra SEQUENCE |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| supporte       | Not checked    |                |                |
| dBandListEUTRA |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..m          |                |                |                |
| axBandsEUTRA)) |                |                |                |
| OF             |                |                |                |
| FreqBand       |                |                |                |
| IndicatorEUTRA |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra-Pa       |                |                |                |
| rametersCommon |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| mfbi-EUTRA     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| modifiedMRP    | Not checked    |                |                |
| -BehaviorEUTRA |                |                |                |
+----------------+----------------+----------------+----------------+
| mult           | Not checked    |                |                |
| iNS-Pmax-EUTRA |                |                |                |
+----------------+----------------+----------------+----------------+
| rs-            | Checked        |                | pc\_RS\_S      |
| SINR-MeasEUTRA |                |                | INR\_MeasEUTRA |
+----------------+----------------+----------------+----------------+
| ne-DC          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
|                | Not Present    |                | pc\_suppor     |
|                |                |                | tOfRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| nr-            | Checked        |                | pc\_interR     |
| HO-ToEN-DC-r16 |                |                | AT\_NR\_ToENDC |
+----------------+----------------+----------------+----------------+
|                | Not Present    |                | pc\_suppor     |
|                |                |                | tOfRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| eutra-Para     |                |                |                |
| metersXDD-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| rsrqMea        | Not checked    |                |                |
| sWidebandEUTRA |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| inactiveState  | Checked        |                | pc\            |
|                |                |                | _inactiveState |
+----------------+----------------+----------------+----------------+
| delayB         | Not checked    |                |                |
| udgetReporting |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1540 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| s              |                |                |                |
| dap-Parameters |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| as             | Checked        |                | pc\_as\        |
| -ReflectiveQoS |                |                | _ReflectiveQoS |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| overheatingInd | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| ims-Parameters |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ims-Pa         |                |                |                |
| rametersCommon |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| voic           | Not checked    |                |                |
| eOverEUTRA-5GC |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Not checked    |                |                |
| voiceOverSCG-B |                |                |                |
| earerEUTRA-5GC |                |                |                |
+----------------+----------------+----------------+----------------+
| vo             | Checked        |                | pc\_voiceFall  |
| iceFallbackInd |                |                | backIndication |
| icationEPS-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| ims-Para       |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| voiceOverNR    | Checked (NOTE  |                | p              |
|                | 16)            |                | c\_voiceOverNR |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fr1-           |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1540 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ims-Para       |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| voiceOverNR    | Checked (NOTE  |                | p              |
|                | 16)            |                | c\_voiceOverNR |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fr2-           |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1540 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ims-Para       |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| voiceOverNR    | Checked (NOTE  |                | p              |
|                | 16)            |                | c\_voiceOverNR |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fr             |                |                |                |
| 1-fr2-Add-UE-N |                |                |                |
| R-Capabilities |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Para       |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| dynamicSFI     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy1         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoFL-DMRS     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy2         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| dummy3         | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    |                |                |
| tedDMRS-TypeDL |                |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Not checked    |                |                |
| tedDMRS-TypeUL |                |                |                |
+----------------+----------------+----------------+----------------+
| s              | Not checked    |                |                |
| emiOpenLoopCSI |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-Re         | Not checked    |                |                |
| portWithoutPMI |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-Re         | Not checked    |                |                |
| portWithoutCQI |                |                |                |
+----------------+----------------+----------------+----------------+
| onePortsPTRS   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-F0-2  | Not checked    |                |                |
| -ConsecSymbols |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F2-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F3-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| ucch-F4-WithFH |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch          | Not checked    |                |                |
| -F0-2WithoutFH |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-F        | Not checked    |                |                |
| 1-3-4WithoutFH |                |                |                |
+----------------+----------------+----------------+----------------+
| mux-SR-HAR     | Not checked    |                |                |
| Q-ACK-CSI-PUCC |                |                |                |
| H-MultiPerSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| uci-CodeBlo    | Not checked    |                |                |
| ckSegmentation |                |                |                |
+----------------+----------------+----------------+----------------+
| onePUCCH-Long  | Not checked    |                |                |
| AndShortFormat |                |                |                |
+----------------+----------------+----------------+----------------+
| twoPUCCH-A     | Not checked    |                |                |
| nyOthersInSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| intraSlotFre   | Not checked    |                |                |
| qHopping-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| pusch-LBRM     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| pdcch-Bl       | Not checked    |                |                |
| indDetectionCA |                |                |                |
+----------------+----------------+----------------+----------------+
| tpc-PUSCH-RNTI | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tpc-PUCCH-RNTI | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tpc-SRS-RNTI   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| absol          | Not checked    |                |                |
| uteTPC-Command |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUSCH |                |                |                |
+----------------+----------------+----------------+----------------+
| twoDifferent   | Not checked    |                |                |
| TPC-Loop-PUCCH |                |                |                |
+----------------+----------------+----------------+----------------+
| pus            | Not checked    |                |                |
| ch-HalfPi-BPSK |                |                |                |
+----------------+----------------+----------------+----------------+
| pucch-F3       | Not checked    |                |                |
| -4-HalfPi-BPSK |                |                |                |
+----------------+----------------+----------------+----------------+
| almostContig   | Not checked    |                |                |
| uousCP-OFDM-UL |                |                |                |
+----------------+----------------+----------------+----------------+
| sp-CSI-RS      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| sp-CSI-IM      | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| tdd-MultiDL-UL | Not checked    |                |                |
| -SwitchPerSlot |                |                |                |
+----------------+----------------+----------------+----------------+
| m              | Not checked    |                |                |
| ultipleCORESET |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ss-SINR-Meas   | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| csi-RSRP-AndRS | Not checked    |                |                |
| RQ-MeasWithSSB |                |                |                |
+----------------+----------------+----------------+----------------+
| csi            | Not checked    |                |                |
| -RSRP-AndRSRQ- |                |                |                |
| MeasWithoutSSB |                |                |                |
+----------------+----------------+----------------+----------------+
| csi-SINR-Meas  | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| csi-RS-RLM     | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1550 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| red            | Checked        |                | pc\_redu       |
| ucedCP-Latency |                |                | cedCP\_Latency |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1560 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| n              | Not checked    | N              |                |
| rdc-Parameters |                | RDC-Parameters |                |
+----------------+----------------+----------------+----------------+
| r              | Not checked    |                |                |
| eceivedFilters |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1570 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| nrdc-Pa        | Not checked    | NRDC-Pa        |                |
| rameters-v1570 |                | rameters-v1570 |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1610 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| inDev          | Checked        |                | pc\_inDevi     |
| iceCoexInd-r16 |                |                | ceCoexInd\_r16 |
+----------------+----------------+----------------+----------------+
| dl-Dedi        | Checked        |                | pc\_NR\_dl\_   |
| catedMessageSe |                |                | DedicatedMessa |
| gmentation-r16 |                |                | geSegmentation |
+----------------+----------------+----------------+----------------+
| nrdc-Pa        | Not checked    |                |                |
| rameters-v1610 |                |                |                |
+----------------+----------------+----------------+----------------+
| powSav-        | Checked        | PowSav-        |                |
| Parameters-r16 |                | Parameters-r16 |                |
|                |                | (Table         |                |
|                |                | 8.             |                |
|                |                | 1.5.1.1.3.3-9) |                |
+----------------+----------------+----------------+----------------+
| fr1-           |                | UE-NR          |                |
| Add-UE-NR-Capa |                | -CapabilityAdd |                |
| bilities-v1610 |                | FRX-Mode-v1610 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| owSav-Paramete |                |                |                |
| rsFRX-Diff-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Paramete   | Checked (NOTES | MAC-Paramete   |                |
| rsFRX-Diff-r16 | 19, 23, 24,    | rsFRX-Diff-r16 |                |
|                | 25, 27)        | (Table         |                |
|                |                | 8.1            |                |
|                |                | .5.1.1.3.3-11) |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| fr2-           |                | UE-NR          |                |
| Add-UE-NR-Capa |                | -CapabilityAdd |                |
| bilities-v1610 |                | FRX-Mode-v1610 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| p              | Not checked    |                |                |
| owSav-Paramete |                |                |                |
| rsFRX-Diff-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Paramete   | Checked (NOTES | MAC-Paramete   |                |
| rsFRX-Diff-r16 | 19, 23, 24,    | rsFRX-Diff-r16 |                |
|                | 25, 27)        | (Table         |                |
|                |                | 8.1            |                |
|                |                | .5.1.1.3.3-11) |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| bh-RLF-        | Not checked    |                |                |
| Indication-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| direc          | Not checked    |                |                |
| tSN-AdditionFi |                |                |                |
| rstRRC-IAB-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| bap-           | Not checked    |                |                |
| Parameters-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| referenceTim   | Not checked    |                |                |
| eProvision-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sidelink       |                |                |                |
| Parameters-r16 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| sidelinkPa     |                |                |                |
| rametersNR-r16 |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| rlc-Paramete   | Not checked    |                |                |
| rsSidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Paramete   | Not checked    |                |                |
| rsSidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| fdd-Add-       | Not checked    |                |                |
| UE-Sidelink-Ca |                |                |                |
| pabilities-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| tdd-Add-       | Not checked    |                |                |
| UE-Sidelink-Ca |                |                |                |
| pabilities-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| s              |                |                |                |
| upportedBandLi |                |                |                |
| stSidelink-r16 |                |                |                |
| SEQUENCE (SIZE |                |                |                |
| (1..maxBands)) |                |                |                |
| OF             |                |                |                |
| Ba             |                |                |                |
| ndSidelink-r16 |                |                |                |
| {              |                |                |                |
+----------------+----------------+----------------+----------------+
| freqBa         | Not checked    |                |                |
| ndSidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sl             | Not checked    |                |                |
| -Reception-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sl-Transmi     | Checked        |                | pc\_NR         |
| ssionMode1-r16 |                |                | \_sl\_Transmis |
|                |                |                | sionMode1\_r16 |
+----------------+----------------+----------------+----------------+
| syn            | Not checked    |                |                |
| c-Sidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sl             | Not checked    |                |                |
| -Tx-256QAM-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| psfch-FormatZe | Not checked    |                |                |
| roSidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| lowSE          | Not checked    |                |                |
| -64QAM-MCS-Tab |                |                |                |
| leSidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| enb-syn        | Not checked    |                |                |
| c-Sidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sl-Transmi     | Checked        | TS 38.306      | pc\_NR         |
| ssionMode2-r16 |                | \[23\] clause  | \_sl\_Transmis |
|                |                | 4.2.16.1.6:    | sionMode2\_r16 |
|                |                | Support of     |                |
|                |                | this feature   |                |
|                |                | is mandatory   |                |
|                |                | if UE supports |                |
|                |                | NR sidelink    |                |
+----------------+----------------+----------------+----------------+
| c              | Not checked    |                |                |
| ongestionContr |                |                |                |
| olSidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| fewerSymbolSl  | Not checked    |                |                |
| otSidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sl-openLo      | Not checked    |                |                |
| opPC-RSRP-Repo |                |                |                |
| rtSidelink-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| sl             | Not checked    |                |                |
| -Rx-256QAM-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| relay          | Not checked    |                |                |
| Parameters-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| p0\_OLPC\      | Not checked    |                |                |
| _Sidelink\_r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| sidelinkParam  | Not checked    |                |                |
| etersEUTRA-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| highSpeed      | Not checked    |                |                |
| Parameters-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Pa         |                | MAC-Pa         |                |
| rameters-v1610 |                | rameters-v1610 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Paramete   | Checked (NOTES | MAC-Paramete   |                |
| rsFRX-Diff-r16 | 19, 23, 24,    | rsFRX-Diff-r16 |                |
|                | 25, 27)        | (Table         |                |
|                |                | 8.1            |                |
|                |                | .5.1.1.3.3-11) |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| mcgRLF-Reco    | Not checked    |                |                |
| veryViaSCG-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| re             | Not checked    |                |                |
| sumeWithStored |                |                |                |
| MCG-SCells-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| resumeWit      | Not checked    |                |                |
| hStoredSCG-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| resumeWith     | Checked        |                | pc             |
| SCG-Config-r16 |                |                | \_resumeWithSC |
|                |                |                | G\_Config\_r16 |
+----------------+----------------+----------------+----------------+
| ue-            | Checked        | UE-            |                |
| BasedPerfMeas- |                | BasedPerfMeas- |                |
| Parameters-r16 |                | Parameters-r16 |                |
|                |                | (Table         |                |
|                |                | 8.1            |                |
|                |                | .5.1.1.3.3-10) |                |
+----------------+----------------+----------------+----------------+
| son-           |                |                |                |
| Parameters-r16 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| r              | Checked        |                | pc\_r          |
| ach-Report-r16 |                |                | achReport\_r16 |
+----------------+----------------+----------------+----------------+
| rl             | Checked        |                | pc\_rlf        |
| fReportCHO-r17 |                |                | ReportCHO\_r17 |
+----------------+----------------+----------------+----------------+
| rlf            | Checked        |                | pc\_rlfR       |
| ReportDAPS-r17 |                |                | eportDAPS\_r17 |
+----------------+----------------+----------------+----------------+
| success        | Checked        |                | pc\_success\_H |
| -HO-Report-r17 |                |                | O\_Report\_r17 |
+----------------+----------------+----------------+----------------+
| twoStepR       | Checked        |                | pc\_twoStepRAC |
| ACH-Report-r17 |                |                | H\_Report\_r17 |
+----------------+----------------+----------------+----------------+
| pscell-        | Not checked    |                |                |
| MHI-Report-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| onDeman        | Checked        |                | pc\_onDemandS  |
| dSI-Report-r17 |                |                | I\_Report\_r17 |
+----------------+----------------+----------------+----------------+
| cef-Re         | Checked        |                | pc\_cef\_Rep   |
| portRedCap-r17 |                |                | ortRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| rlf-Re         | Checked        |                | pc\_rlf\_Rep   |
| portRedCap-r17 |                |                | ortRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| onDemandSIB    | Not checked    |                |                |
| -Connected-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1640 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| redirectAtR    | Not checked    |                |                |
| esumeByNAS-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| phy-Paramete   | Not checked    |                |                |
| rsSharedSpectr |                |                |                |
| umChAccess-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1650 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| mpsPriority    | Checked        |                | pc\_NR         |
| Indication-r16 |                |                | \_mpsPriorityI |
|                |                |                | ndication\_r16 |
+----------------+----------------+----------------+----------------+
| highSpeedPa    | Not checked    |                |                |
| rameters-v1650 |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1690 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-RRC-Se      | Not checked    |                |                |
| gmentation-r16 |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1700 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| inact          | Not checked    |                |                |
| iveStatePO-Det |                |                |                |
| ermination-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| highSpeedPa    | Not checked    |                |                |
| rameters-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| powSav-Pa      | Not checked    |                |                |
| rameters-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Pa         |                |                |                |
| rameters-v1700 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| mac-Param      |                | MAC-Param      |                |
| etersFR2-2-r17 |                | etersFR2-2-r17 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| d              | Not checked    |                |                |
| irectMCG-SCell |                |                |                |
| Activation-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| directM        | Not checked    |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| d              | Not checked    |                |                |
| irectSCG-SCell |                |                |                |
| Activation-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| directS        | Not checked    |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| drx-           | Not checked    |                |                |
| Adaptation-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| ims-Pa         | Not checked    |                |                |
| rameters-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| measAndMobPa   | Not checked    |                |                |
| rameters-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| appLayerMeas   | Not checked    |                |                |
| Parameters-r17 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| qoe-Streaming- | Not checked    |                |                |
| MeasReport-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| qoe-MTSI-      | Checked        |                | pc             |
| MeasReport-r17 |                |                | \_qoe\_MTSI\_M |
|                |                |                | easReport\_r17 |
+----------------+----------------+----------------+----------------+
| qoe-VR-        | Not checked    |                |                |
| MeasReport-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ran-Visible    | Not checked    |                |                |
| QoE-Streaming- |                |                |                |
| MeasReport-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ran-           | Not checked    |                |                |
| VisibleQoE-VR- |                |                |                |
| MeasReport-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-Measu       | Not checked    |                |                |
| rementReportAp |                |                |                |
| pLayer-Seg-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| redCap         |                |                |                |
| Parameters-r17 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| suppo          | Checked        |                | pc\_suppor     |
| rtOfRedCap-r17 |                |                | tOfRedCap\_r17 |
+----------------+----------------+----------------+----------------+
| supportOf16    | Checked        | Acc. to TS     | pc\            |
| DRB-RedCap-r17 |                | 38.306 \[23\]  | _16DRB\_RedCap |
|                |                | clause         | \_r17          |
|                |                | 4.2.21.2 "This |                |
|                |                | capability is  |                |
|                |                | only           |                |
|                |                | applicable for |                |
|                |                | RedCap UEs."   |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| ra-SDT-r17     | Checked        |                | pc             |
|                |                |                | \_ra\_SDT\_r17 |
+----------------+----------------+----------------+----------------+
| srb-SDT-r17    | Checked        |                | pc\            |
|                |                |                | _srb\_SDT\_r17 |
+----------------+----------------+----------------+----------------+
| gNB-SideRT     | Not checked    |                |                |
| T-BasedPDC-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| bh-RLF-Dete    | Not checked    |                |                |
| ctionRecovery- |                |                |                |
| Indication-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| nrdc-Pa        | Not checked    |                |                |
| rameters-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| bap-Pa         | Not checked    |                |                |
| rameters-v1700 |                |                |                |
+----------------+----------------+----------------+----------------+
| musim-Gap      | Checked        |                | p              |
| Preference-r17 |                |                | c\_musim\_GapP |
|                |                |                | reference\_r17 |
+----------------+----------------+----------------+----------------+
| musimLeav      | Checked        |                | pc\_musimLeave |
| eConnected-r17 |                |                | Connected\_r17 |
+----------------+----------------+----------------+----------------+
| mbs-           | Not checked    |                |                |
| Parameters-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| nonTerrestr    | Checked        |                | pc             |
| ialNetwork-r17 |                |                | \_nonTerrestri |
|                |                |                | alNetwork\_r17 |
+----------------+----------------+----------------+----------------+
| ntn-Scena      | Not checked    |                |                |
| rioSupport-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| sli            | Checked        |                | pc\_slic       |
| ceInfoforCellR |                |                | eInfoforCellRe |
| eselection-r17 |                |                | selection\_r17 |
+----------------+----------------+----------------+----------------+
| ue-Radio       |                |                |                |
| PagingInfo-r17 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| pei-Su         | Checked        | Checked if any | pc\_pei\_Sub   |
| bgroupingSuppo |                | frequency band | groupingSuppor |
| rtBandList-r17 |                | is reported    | tBandList\_r17 |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-GapF        | Not checked    |                |                |
| R2-Pattern-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| ntn-           | Not checked    |                |                |
| Parameters-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1740 |                |
+----------------+----------------+----------------+----------------+
| redCapPa       |                |                |                |
| rameters-v1740 |                |                |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| ncd-SSB        | Checked        |                | p              |
| -ForRedCapInit |                |                | c\_ncd\_SSB\_F |
| ialBWP-SDT-r17 |                |                | orRedCapInitia |
|                |                |                | lBWP\_SDT\_r17 |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1750 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| cros           | Not checked    |                |                |
| sCarrierSchedu |                |                |                |
| lingConfigurat |                |                |                |
| ionRelease-r17 |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                | UE-NR-Ca       |                |
| ticalExtension |                | pability-v1800 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| airToGro       | Not checked    |                |                |
| undNetwork-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| eRedCap        |                | ERedCap        |                |
| Parameters-r18 |                | Parameters-r18 |                |
| SEQUENCE {     |                |                |                |
+----------------+----------------+----------------+----------------+
| suppor         | Checked        |                | pc\_support    |
| tOfERedCap-r18 |                |                | OfERedCap\_r18 |
+----------------+----------------+----------------+----------------+
| eRedCapNotRe   | Not checked    |                |                |
| ducedBB-BW-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| eRedCapI       | Not checked    |                |                |
| gnoreCapabilit |                |                |                |
| yFiltering-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| ncr-           | Not checked    |                |                |
| Parameters-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| soft           | Not checked    |                |                |
| SatelliteSwitc |                |                |                |
| hResyncNTN-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| hard           | Not checked    |                |                |
| SatelliteSwitc |                |                |                |
| hResyncNTN-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| mt-SDT-r18     | Checked        |                | pc             |
|                |                |                | \_mt\_SDT\_r18 |
+----------------+----------------+----------------+----------------+
| mt-SDT-NTN-r18 | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| inDevic        | Not checked    |                |                |
| eCoexIndAutono |                |                |                |
| mousDenial-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| inDevice       | Not checked    |                |                |
| CoexIndFDM-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| inDevice       | Not checked    |                |                |
| CoexIndTDM-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| mus            | Not checked    |                |                |
| im-GapPriority |                |                |                |
| Preference-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| mus            | Checked        |                | pc\_musim      |
| im-CapabilityR |                |                | \_CapabilityRe |
| estriction-r18 |                |                | striction\_r18 |
+----------------+----------------+----------------+----------------+
| dummy          | Not checked    |                |                |
+----------------+----------------+----------------+----------------+
| ra-Ins         | Checked        |                | pc\_ra\_Inste  |
| teadCG-SDT-r18 |                |                | adCG\_SDT\_r18 |
+----------------+----------------+----------------+----------------+
| resumeAfterS   | Not checked    |                |                |
| DT-Release-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ul-T           | Not checked    |                |                |
| rafficInfo-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| aerial         | Not checked    |                |                |
| Parameters-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ntn-VSAT-A     | Not checked    |                |                |
| ntennaType-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ntn-VSAT-Mo    | Not checked    |                |                |
| bilityType-r18 |                |                |                |
+----------------+----------------+----------------+----------------+
| ntn-Pa         | Not checked    |                |                |
| rameters-v1820 |                |                |                |
+----------------+----------------+----------------+----------------+
| nonCri         |                |                |                |
| ticalExtension |                |                |                |
| SEQUENCE {}    |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| Note 1: If the |                |                |                |
| UE is single   |                |                |                |
| mode (FDD or   |                |                |                |
| TDD), or the   |                |                |                |
| UE is dual     |                |                |                |
| mode (FDD and  |                |                |                |
| TDD) and       |                |                |                |
| *i             |                |                |                |
| ntraAndInterF- |                |                |                |
| MeasAndReport* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *i             |                |                |                |
| ntraAndInterF- |                |                |                |
| MeasAndReport* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *i             |                |                |                |
| ntraAndInterF- |                |                |                |
| MeasAndReport* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| *i             |                |                |                |
| ntraAndInterF- |                |                |                |
| MeasAndReport* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| one of         |                |                |                |
| fdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 2: If the |                |                |                |
| UE is single   |                |                |                |
| mode (FDD or   |                |                |                |
| TDD), or the   |                |                |                |
| UE is dual     |                |                |                |
| mode (FDD and  |                |                |                |
| TDD) and       |                |                |                |
| *eventA-       |                |                |                |
| MeasAndReport* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *eventA-       |                |                |                |
| MeasAndReport* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *eventA-       |                |                |                |
| MeasAndReport* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| *eventA-       |                |                |                |
| MeasAndReport* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| one of         |                |                |                |
| fdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 3: If the |                |                |                |
| UE supports    |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| *c             |                |                |                |
| si-RSRP-AndRSR |                |                |                |
| Q-MeasWithSSB* |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| *c             |                |                |                |
| si-RSRP-AndRSR |                |                |                |
| Q-MeasWithSSB* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersFRX-Diff.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| *c             |                |                |                |
| si-RSRP-AndRSR |                |                |                |
| Q-MeasWithSSB* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| *c             |                |                |                |
| si-RSRP-AndRSR |                |                |                |
| Q-MeasWithSSB* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fr1-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| or             |                |                |                |
| fr2-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 4: If the |                |                |                |
| UE is single   |                |                |                |
| mode (FDD or   |                |                |                |
| TDD), or the   |                |                |                |
| UE is dual     |                |                |                |
| mode (FDD and  |                |                |                |
| TDD) and       |                |                |                |
| *skipUp        |                |                |                |
| linkTxDynamic* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *skipUp        |                |                |                |
| linkTxDynamic* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| mac-Paramet    |                |                |                |
| ers/mac-Parame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *skipUp        |                |                |                |
| linkTxDynamic* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| skipU          |                |                |                |
| plinkTxDynamic |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| one of         |                |                |                |
| fdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 5: If the |                |                |                |
| UE is single   |                |                |                |
| mode (FDD or   |                |                |                |
| TDD), or the   |                |                |                |
| UE is dual     |                |                |                |
| mode (FDD and  |                |                |                |
| TDD) and       |                |                |                |
| *              |                |                |                |
| logicalChannel |                |                |                |
| SR-DelayTimer* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *              |                |                |                |
| logicalChannel |                |                |                |
| SR-DelayTimer* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| mac-Paramet    |                |                |                |
| ers/mac-Parame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *              |                |                |                |
| logicalChannel |                |                |                |
| SR-DelayTimer* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| *              |                |                |                |
| logicalChannel |                |                |                |
| SR-DelayTimer* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| one of         |                |                |                |
| fdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 6: If the |                |                |                |
| UE is single   |                |                |                |
| mode (FDD or   |                |                |                |
| TDD), or the   |                |                |                |
| UE is dual     |                |                |                |
| mode (FDD and  |                |                |                |
| TDD) and       |                |                |                |
| *l             |                |                |                |
| ongDRX\_Cycle* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *l             |                |                |                |
| ongDRX\_Cycle* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| mac-Paramet    |                |                |                |
| ers/mac-Parame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *l             |                |                |                |
| ongDRX\_Cycle* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| *l             |                |                |                |
| ongDRX\_Cycle* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| one of         |                |                |                |
| fdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 7: If the |                |                |                |
| UE is single   |                |                |                |
| mode (FDD or   |                |                |                |
| TDD), or the   |                |                |                |
| UE is dual     |                |                |                |
| mode (FDD and  |                |                |                |
| TDD) and       |                |                |                |
| *sh            |                |                |                |
| ortDRX\_Cycle* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *sh            |                |                |                |
| ortDRX\_Cycle* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| mac-Paramet    |                |                |                |
| ers/mac-Parame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *sh            |                |                |                |
| ortDRX\_Cycle* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| *sh            |                |                |                |
| ortDRX\_Cycle* |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| one of         |                |                |                |
| fdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 8: If the |                |                |                |
| UE supports    |                |                |                |
| FR2 and        |                |                |                |
| pc\_pdsc       |                |                |                |
| h\_256QAM\_FR2 |                |                |                |
| is supported,  |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| pdsc           |                |                |                |
| h\_256QAM\_FR2 |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| at least one   |                |                |                |
| entry of       |                |                |                |
| suppo          |                |                |                |
| rtedBandListNR |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 9: If     |                |                |                |
| pc\_pusc       |                |                |                |
| h\_256QAM\_FR1 |                |                |                |
| or             |                |                |                |
| pc\_pusc       |                |                |                |
| h\_256QAM\_FR2 |                |                |                |
| is supported,  |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| pusch-256QAM   |                |                |                |
| will be        |                |                |                |
| signalled in   |                |                |                |
| at least one   |                |                |                |
| entry of       |                |                |                |
| suppo          |                |                |                |
| rtedBandListNR |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 10: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| ss-SINR-Meas   |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| ss-SINR-Meas   |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersFRX-Diff.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| ss-SINR-Meas   |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| ss-SINR-Meas   |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fr1-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| or             |                |                |                |
| fr2-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 11: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| csi            |                |                |                |
| -RSRP-AndRSRQ- |                |                |                |
| MeasWithoutSSB |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| csi            |                |                |                |
| -RSRP-AndRSRQ- |                |                |                |
| MeasWithoutSSB |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersFRX-Diff.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| csi            |                |                |                |
| -RSRP-AndRSRQ- |                |                |                |
| MeasWithoutSSB |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| csi            |                |                |                |
| -RSRP-AndRSRQ- |                |                |                |
| MeasWithoutSSB |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fr1-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| or             |                |                |                |
| fr2-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 12: If    |                |                |                |
| the UE is      |                |                |                |
| single mode    |                |                |                |
| (FDD or TDD),  |                |                |                |
| or the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| and TDD) and   |                |                |                |
| multipleCo     |                |                |                |
| nfiguredGrants |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| multipleCo     |                |                |                |
| nfiguredGrants |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| mac-Paramet    |                |                |                |
| ers/mac-Parame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| multipleCo     |                |                |                |
| nfiguredGrants |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| multipleCo     |                |                |                |
| nfiguredGrants |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/mac-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 13: If    |                |                |                |
| the UE is      |                |                |                |
| single mode    |                |                |                |
| (FDD or TDD),  |                |                |                |
| or the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| and TDD) and   |                |                |                |
| *sftd          |                |                |                |
| -MeasNR-Neigh* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *sftd          |                |                |                |
| -MeasNR-Neigh* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *sftd          |                |                |                |
| -MeasNR-Neigh* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| *sftd          |                |                |                |
| -MeasNR-Neigh* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 14: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| *h             |                |                |                |
| andoverInterF* |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| *h             |                |                |                |
| andoverInterF* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersFRX-Diff.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| *h             |                |                |                |
| andoverInterF* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| *h             |                |                |                |
| andoverInterF* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fr1-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| or             |                |                |                |
| fr2-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 15: If    |                |                |                |
| the UE is      |                |                |                |
| single mode    |                |                |                |
| (FDD or TDD),  |                |                |                |
| or the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| and TDD) and   |                |                |                |
| *h             |                |                |                |
| andoverInterF* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *h             |                |                |                |
| andoverInterF* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *h             |                |                |                |
| andoverInterF* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| *h             |                |                |                |
| andoverInterF* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 16: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| voiceOverNR is |                |                |                |
| supported in   |                |                |                |
| both frequency |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| voiceOverNR    |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| ims-Paramet    |                |                |                |
| ers/ims-Parame |                |                |                |
| tersFRX-Diff.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| voiceOverNR is |                |                |                |
| only supported |                |                |                |
| in one         |                |                |                |
| frequency      |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| voiceOverNR    |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fr1-Add-UE-NR  |                |                |                |
| -Capabilities- |                |                |                |
| v1540/ims-Para |                |                |                |
| metersFRX-Diff |                |                |                |
| or             |                |                |                |
| fr2-Add-UE-NR  |                |                |                |
| -Capabilities- |                |                |                |
| v1540/ims-Para |                |                |                |
| metersFRX-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 17: If    |                |                |                |
| the UE is      |                |                |                |
| single mode    |                |                |                |
| (FDD or TDD),  |                |                |                |
| or the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| and TDD) and   |                |                |                |
| *dl-S          |                |                |                |
| chedulingOffse |                |                |                |
| t-PDSCH-TypeA* |                |                |                |
| is supported   |                |                |                |
| in both modes, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| *dl-S          |                |                |                |
| chedulingOffse |                |                |                |
| t-PDSCH-TypeA* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| phy-Paramet    |                |                |                |
| ers/phy-Parame |                |                |                |
| tersXDD-Diff.\ |                |                |                |
| If the UE is   |                |                |                |
| dual mode (FDD |                |                |                |
| + TDD) and     |                |                |                |
| *dl-S          |                |                |                |
| chedulingOffse |                |                |                |
| t-PDSCH-TypeA* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one mode, then |                |                |                |
| support of     |                |                |                |
| *dl-S          |                |                |                |
| chedulingOffse |                |                |                |
| t-PDSCH-TypeA* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fdd-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| phy-Para       |                |                |                |
| metersXDD-Diff |                |                |                |
| or             |                |                |                |
| tdd-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/phy-Para |                |                |                |
| metersXDD-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 18: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| dl-            |                |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeA |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| dl-            |                |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeA |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| phy-Parame     |                |                |                |
| ters/phy-Param |                |                |                |
| etersFRX-Diff. |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| dl-            |                |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeA |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| dl-            |                |                |                |
| SchedulingOffs |                |                |                |
| et-PDSCH-TypeA |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fr1-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/phy-Para |                |                |                |
| metersFRX-Diff |                |                |                |
| or             |                |                |                |
| fr2-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/phy-Para |                |                |                |
| metersFRX-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 19: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| drx-           |                |                |                |
| Adaptation-r16 |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| drx-           |                |                |                |
| Adaptation-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| UE-            |                |                |                |
| NR-Capability- |                |                |                |
| v1610/mac-Para |                |                |                |
| meters-v1610.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| the support of |                |                |                |
| drx-           |                |                |                |
| Adaptation-r16 |                |                |                |
| in             |                |                |                |
| MAC-Paramete   |                |                |                |
| rsFRX-Diff-r16 |                |                |                |
| are different  |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| drx-           |                |                |                |
| Adaptation-r16 |                |                |                |
| will be        |                |                |                |
| signaled under |                |                |                |
| UE-NR-Capabi   |                |                |                |
| lity-v1610/fr1 |                |                |                |
| -Add-UE-NR-Cap |                |                |                |
| abilities-v161 |                |                |                |
| 0/mac-Paramete |                |                |                |
| rsFRX-Diff-r16 |                |                |                |
| and            |                |                |                |
| UE-NR-Capabili |                |                |                |
| ty-v1610/fr2-A |                |                |                |
| dd-UE-NR-Capab |                |                |                |
| ilities-v1610/ |                |                |                |
| mac-Parameters |                |                |                |
| FRX-Diff-r16,\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| drx-           |                |                |                |
| Adaptation-r16 |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| drx-           |                |                |                |
| Adaptation-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr1- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| or             |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr2- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 20: If UE |                |                |                |
| supports FR1   |                |                |                |
| and            |                |                |                |
| pc\_b          |                |                |                |
| wp\_DiffNumero |                |                |                |
| logy\_FR1\_FDD |                |                |                |
| or             |                |                |                |
| pc\_b          |                |                |                |
| wp\_DiffNumero |                |                |                |
| logy\_FR1\_TDD |                |                |                |
| or supports    |                |                |                |
| FR2 and        |                |                |                |
| p              |                |                |                |
| c\_bwp\_DiffNu |                |                |                |
| merology\_FR2, |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| bwp-           |                |                |                |
| DiffNumerology |                |                |                |
| will be        |                |                |                |
| signaled in at |                |                |                |
| least one      |                |                |                |
| entry of       |                |                |                |
| suppo          |                |                |                |
| rtedBandListNR |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 21: If UE |                |                |                |
| supports FR1   |                |                |                |
| and            |                |                |                |
| pc\_bwp\_Sam   |                |                |                |
| eNumerology\_u |                |                |                |
| pto2\_FR1\_FDD |                |                |                |
| or             |                |                |                |
| pc\_bwp\_Sam   |                |                |                |
| eNumerology\_u |                |                |                |
| pto2\_FR1\_TDD |                |                |                |
| or             |                |                |                |
| pc\_bwp\_Sam   |                |                |                |
| eNumerology\_u |                |                |                |
| pto4\_FR1\_FDD |                |                |                |
| or             |                |                |                |
| pc\_bwp\_Sam   |                |                |                |
| eNumerology\_u |                |                |                |
| pto4\_FR1\_TDD |                |                |                |
| or supports    |                |                |                |
| FR2 and        |                |                |                |
| pc\_bwp        |                |                |                |
| \_SameNumerolo |                |                |                |
| gy\_upto2\_FR2 |                |                |                |
| or             |                |                |                |
| pc\_bwp        |                |                |                |
| \_SameNumerolo |                |                |                |
| gy\_upto4\_FR2 |                |                |                |
| then support   |                |                |                |
| of             |                |                |                |
| bwp\_          |                |                |                |
| SameNumerology |                |                |                |
| will be        |                |                |                |
| signaled in at |                |                |                |
| least one      |                |                |                |
| entry of       |                |                |                |
| suppo          |                |                |                |
| rtedBandListNR |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 22: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| *id            |                |                |                |
| leInactiveNR-M |                |                |                |
| easReport-r16* |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| *id            |                |                |                |
| leInactiveNR-M |                |                |                |
| easReport-r16* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| measAndMo      |                |                |                |
| bParameters/me |                |                |                |
| asAndMobParame |                |                |                |
| tersFRX-Diff.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| *id            |                |                |                |
| leInactiveNR-M |                |                |                |
| easReport-r16* |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| *id            |                |                |                |
| leInactiveNR-M |                |                |                |
| easReport-r16* |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fr1-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| or             |                |                |                |
| fr2-Add-UE-NR  |                |                |                |
| -Capabilities/ |                |                |                |
| measAndMobPara |                |                |                |
| metersFRX-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 23: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| d              |                |                |                |
| irectMCG-SCell |                |                |                |
| Activation-r16 |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| d              |                |                |                |
| irectMCG-SCell |                |                |                |
| Activation-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| UE-            |                |                |                |
| NR-Capability- |                |                |                |
| v1610/mac-Para |                |                |                |
| meters-v1610.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| d              |                |                |                |
| irectMCG-SCell |                |                |                |
| Activation-r16 |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| d              |                |                |                |
| irectMCG-SCell |                |                |                |
| Activation-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr1- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| or             |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr2- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 24: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| directM        |                |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r16 |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| directM        |                |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| UE-            |                |                |                |
| NR-Capability- |                |                |                |
| v1610/mac-Para |                |                |                |
| meters-v1610.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| directM        |                |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r16 |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| directM        |                |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr1- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| or             |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr2- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 25: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| directS        |                |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r16 |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| directS        |                |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| UE-            |                |                |                |
| NR-Capability- |                |                |                |
| v1610/mac-Para |                |                |                |
| meters-v1610.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| directS        |                |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r16 |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| directS        |                |                |                |
| CG-SCellActiva |                |                |                |
| tionResume-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr1- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| or             |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr2- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 26: If    |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| twoPUCCH-A     |                |                |                |
| nyOthersInSlot |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| twoPUCCH-A     |                |                |                |
| nyOthersInSlot |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| phy-Parame     |                |                |                |
| ters/phy-Param |                |                |                |
| etersFRX-Diff. |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| twoPUCCH-A     |                |                |                |
| nyOthersInSlot |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| twoPUCCH-A     |                |                |                |
| nyOthersInSlot |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| fr1-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/phy-Para |                |                |                |
| metersFRX-Diff |                |                |                |
| or             |                |                |                |
| fr2-Add        |                |                |                |
| -UE-NR-Capabil |                |                |                |
| ities/phy-Para |                |                |                |
| metersFRX-Diff |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
|                |                |                |                |
| Note 27:   If  |                |                |                |
| the UE         |                |                |                |
| supports       |                |                |                |
| single         |                |                |                |
| frequency      |                |                |                |
| range (FR1 or  |                |                |                |
| FR2), or the   |                |                |                |
| UE supports    |                |                |                |
| both frequency |                |                |                |
| ranges (FR1    |                |                |                |
| and FR2) and   |                |                |                |
| d              |                |                |                |
| irectSCG-SCell |                |                |                |
| Activation-r16 |                |                |                |
| is supported   |                |                |                |
| in both        |                |                |                |
| frequency      |                |                |                |
| ranges, then   |                |                |                |
| support of     |                |                |                |
| d              |                |                |                |
| irectSCG-SCell |                |                |                |
| Activation-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| UE-            |                |                |                |
| NR-Capability- |                |                |                |
| v1610/mac-Para |                |                |                |
| meters-v1610.\ |                |                |                |
| If the UE      |                |                |                |
| supports both  |                |                |                |
| frequency      |                |                |                |
| ranges (FR1 +  |                |                |                |
| FR2) and       |                |                |                |
| d              |                |                |                |
| irectSCG-SCell |                |                |                |
| Activation-r16 |                |                |                |
| is only        |                |                |                |
| supported in   |                |                |                |
| one frequency  |                |                |                |
| range, then    |                |                |                |
| support of     |                |                |                |
| d              |                |                |                |
| irectSCG-SCell |                |                |                |
| Activation-r16 |                |                |                |
| will be        |                |                |                |
| signaled in    |                |                |                |
| one of         |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr1- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| or             |                |                |                |
| UE-NR-Capabil  |                |                |                |
| ity-v1610/fr2- |                |                |                |
| Add-UE-NR-Capa |                |                |                |
| bilities-v1610 |                |                |                |
| as             |                |                |                |
| appropriate.   |                |                |                |
+----------------+----------------+----------------+----------------+

Table 8.1.5.1.1.3.3-4: *UECapabilityEnquiry-v1560-IEs* (Table
8.1.5.1.1.3.3-1)

  ---------------------------------------------- -------------- --------- -----------
  Information Element                            Value/remark   Comment   Condition
  UECapabilityEnquiry-v1560-IEs ::= SEQUENCE {                            
  capabilityRequestFilterCommon                  Not present              
  nonCriticalExtension SEQUENCE {                                         
  rrc-SegAllowed-r16                             enabled                  
  nonCriticalExtension                           Not present              
  }                                                                       
  }                                                                       
  ---------------------------------------------- -------------- --------- -----------

Table 8.1.5.1.1.3.3-5: ULDedicatedMessageSegment (step 2a1, Table
8.1.5.1.1.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.1-32C |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ULDedicatedMes  |                 |                 |           |
| sageSegment-r16 |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ulDedicatedMes  |                 |                 |           |
| sageSegment-r16 |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| se              | 0 for first     |                 |           |
| gmentNumber-r16 | segment, and    |                 |           |
|                 | incremented by  |                 |           |
|                 | 1 for each      |                 |           |
|                 | subsequent      |                 |           |
|                 | segment         |                 |           |
+-----------------+-----------------+-----------------+-----------+
| r               | Not Checked     | OCTET STRING    |           |
| rc-MessageSegme |                 | including       |           |
| ntContainer-r16 |                 | segmented       |           |
|                 |                 | UECapabi        |           |
|                 |                 | lityInformation |           |
|                 |                 | message         |           |
+-----------------+-----------------+-----------------+-----------+
| rrc-Message     | *               |                 |           |
| SegmentType-r16 | notLastSegment* |                 |           |
|                 | for all         |                 |           |
|                 | segments except |                 |           |
|                 | the last        |                 |           |
|                 | segment.        |                 |           |
|                 |                 |                 |           |
|                 | *lastSegment*   |                 |           |
|                 | for the last    |                 |           |
|                 | segment         |                 |           |
+-----------------+-----------------+-----------------+-----------+
| lateNonCr       | Not present     |                 |           |
| iticalExtension |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| nonCr           | Not present     |                 |           |
| iticalExtension |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.1.1.3.3-6: FeatureSetDownlink-v1610 (Table 8.1.5.1.1.3.3-3)

  -------------------------------------------------- -------------- --------- ------------------------
  Information Element                                Value/remark   Comment   Condition
  FeatureSetDownlink-v1610 ::= SEQUENCE {                                     
  cbgPDSCH-ProcessingType1-DifferentTB-PerSlot-r16   Not checked              
  cbgPDSCH-ProcessingType2-DifferentTB-PerSlot-r16   Not checked              
  intraFreqDAPS-r16                                  Checked                  pc\_intraFreqDAPS\_r16
  intraBandFreqSeparationDL-v1620                    Not checked              
  intraBandFreqSeparationDL-Only-r16                 Not checked              
  pdcch-Monitoring-r16                               Not checked              
  pdcch-MonitoringMixed-r16                          Not checked              
  crossCarrierSchedulingProcessing-DiffSCS-r16       Not checked              
  singleDCI-SDM-scheme-r16                           Not checked              
  }                                                                           
  -------------------------------------------------- -------------- --------- ------------------------

Table 8.1.5.1.1.3.3-7: FeatureSetUplink-v1610 (Table 8.1.5.1.1.3.3-3)

  -------------------------------------------------- -------------- --------- ---------------------------------
  Information Element                                Value/remark   Comment   Condition
  FeatureSetUplink-v1610 ::= SEQUENCE {                                       
  pusch-RepetitionTypeB-r16                          Checked                  pc\_pusch\_RepetitionTypeB\_r16
  ul-CancellationSelfCarrier-r16                     Not checked              
  ul-CancellationCrossCarrier-r16                    Not checked              
  ul-FullPwrMode2-MaxSRS-ResInSet-r16                Not checked              
  cbgPUSCH-ProcessingType1-DifferentTB-PerSlot-r16   Not checked              
  cbgPUSCH-ProcessingType2-DifferentTB-PerSlot-r16   Not checked              
  supportedSRS-PosResources-r16                      Not checked              
  intraFreqDAPS-UL-r16                               Not checked              
  intraBandFreqSeparationUL-v1620                    Not checked              
  multiPUCCH-r16                                     Not checked              
  twoPUCCH-Type1-r16                                 Not checked              
  twoPUCCH-Type2-r16                                 Not checked              
  twoPUCCH-Type3-r16                                 Not checked              
  twoPUCCH-Type4-r16                                 Not checked              
  mux-SR-HARQ-ACK-r16                                Not checked              
  dummy1                                             Not checked              
  dummy2                                             Not checked              
  twoPUCCH-Type5-r16                                 Not checked              
  twoPUCCH-Type6-r16                                 Not checked              
  twoPUCCH-Type7-r16                                 Not checked              
  twoPUCCH-Type8-r16                                 Not checked              
  twoPUCCH-Type9-r16                                 Not checked              
  twoPUCCH-Type10-r16                                Not checked              
  twoPUCCH-Type11-r16                                Not checked              
  ul-IntraUE-Mux-r16                                 Not checked              
  ul-FullPwrMode-r16                                 Checked                  pc\_ul\_FullPwrMode\_r16
  crossCarrierSchedulingProcessing-DiffSCS-r16       Not checked              
  ul-FullPwrMode1-r16                                Checked                  pc\_ul\_FullPwrMode1\_r16
  ul-FullPwrMode2-SRSConfig-diffNumSRSPorts-r16      Not checked              
  ul-FullPwrMode2-TPMIGroup-r16                      Not checked              
  }                                                                           
  -------------------------------------------------- -------------- --------- ---------------------------------

Table 8.1.5.1.1.3.3-7a: FeatureSetDownlinkPerCC-v1620 (Table
8.1.5.1.1.3.3-3)

  ---------------------------------------------- -------------- --------- -----------------------------
  Information Element                            Value/remark   Comment   Condition
  FeatureSetDownlinkPerCC-v1620 ::= SEQUENCE {                            
  multiDCI-MultiTRP-r16                          Checked                  pc\_multiDCI\_MultiTRP\_r16
  supportFDM-SchemeB-r16                         Not checked              
  }                                                                       
  ---------------------------------------------- -------------- --------- -----------------------------

Table 8.1.5.1.1.3.3-7b: FeatureSetUplink-v1710 (Table 8.1.5.1.1.3.3-3)

  --------------------------------------- ------------------ ------------- ---------------------------
  **Information Element**                 **Value/remark**   **Comment**   **Condition**
  FeatureSetUplink-v1710 ::= SEQUENCE {                                    
  mTRP-PUSCH-TypeA-CB-r17                 Checked                          pc\_mtrpPuschTypeACb\_r17
  mTRP-PUSCH-RepetitionTypeA-r17          Not checked                      
  mTRP-PUCCH-IntraSlot-r17                Not checked                      
  srs-AntennaSwitching2SP-1Periodic-r17   Not checked                      
  srs-ExtensionAperiodicSRS-r17           Not checked                      
  srs-OneAP-SRS-r17                       Not checked                      
  ue-PowerClassPerBandPerBC-r17           Not checked                      
  tx-Support-UL-GapFR2-r17                Not checked                      
  }                                                                        
  --------------------------------------- ------------------ ------------- ---------------------------

Table 8.1.5.1.1.3.3-7c: FeatureSetUplinkPerCC-v1700 (Table
8.1.5.1.1.3.3-3)

  -------------------------------------------- ------------------ ------------- ---------------------------
  **Information Element**                      **Value/remark**   **Comment**   **Condition**
  FeatureSetUplinkPerCC-v1700 ::= SEQUENCE {                                    
  supportedMinBandwidthUL-r17                  Not checked                      
  mTRP-PUSCH-RepetitionTypeB-r17               Not checked                      
  mTRP-PUSCH-TypeB-CB-r17                      Checked                          pc\_mtrpPuschTypeBCb\_r17
  supportedBandwidthUL-v1710                   Not checked                      
  }                                                                             
  -------------------------------------------- ------------------ ------------- ---------------------------

Table 8.1.5.1.1.3.3-8: CA-ParametersNR-v1610 (Table 8.1.5.1.1.3.3-3)

  ------------------------------------------ -------------- --------- -----------------------------------------
  Information Element                        Value/remark   Comment   Condition
  CA-ParametersNR-v1610 ::= SEQUENCE {                                
  parallelTxMsgA-SRS-PUCCH-PUSCH-r16         Not checked              
  msgA-SUL-r16                               Not checked              
  jointSearchSpaceSwitchAcrossCells-r16      Not checked              
  half-DuplexTDD-CA-SameSCS-r16              Not checked              
  scellDormancyWithinActiveTime-r16          Not checked              
  scellDormancyOutsideActiveTime-r16         Checked                  pc\_scellDormancyOutsideActiveTime\_r16
  crossCarrierA-CSI-trigDiffSCS-r16          Not checked              
  defaultQCL-CrossCarrierA-CSI-Trig-r16      Not checked              
  interCA-NonAlignedFrame-r16                Not checked              
  simul-SRS-Trans-BC-r16                     Not checked              
  interFreqDAPS-r16                          Checked                  pc\_interFreqDAPS\_r16
  codebookParametersPerBC-r16                Not checked              
  blindDetectFactor-r16                      Not checked              
  pdcch-MonitoringCA-r16                     Not checked              
  pdcch-BlindDetectionCA-Mixed-r16           Not checked              
  pdcch-BlindDetectionMCG-UE-r16             Not checked              
  pdcch-BlindDetectionSCG-UE-r16             Not checked              
  pdcch-BlindDetectionMCG-UE-Mixed-r16       Not checked              
  pdcch-BlindDetectionSCG-UE-Mixed-r16       Not checked              
  crossCarrierSchedulingDL-DiffSCS-r16       Not checked              
  crossCarrierSchedulingDefaultQCL-r16       Not checked              
  crossCarrierSchedulingUL-DiffSCS-r16       Not checked              
  simul-SRS-MIMO-Trans-BC-r16                Not checked              
  codebookParametersAdditionPerBC-r16        Not checked              
  codebookComboParametersAdditionPerBC-r16   Not checked              
  }                                                                   
  ------------------------------------------ -------------- --------- -----------------------------------------

Table 8.1.5.1.1.3.3-9: PowSav-Parameters-r16 (Table 8.1.5.1.1.3.3-3)

  ---------------------------------------- -------------- --------- ----------------------------
  Information Element                      Value/remark   Comment   Condition
  PowSav-Parameters-r16 ::= SEQUENCE {                              
  powSav-ParametersCommon-r16 SEQUENCE {                            
  drx-Preference-r16                       Not checked              
  maxCC-Preference-r16                     Not checked              
  releasePreference-r16                    Checked                  pc\_releasePreference\_r16
  minSchedulingOffsetPreference-r16        Not checked              
  }                                                                 
  powSav-ParametersFRX-Diff-r16            Not checked              
  }                                                                 
  ---------------------------------------- -------------- --------- ----------------------------

Table 8.1.5.1.1.3.3-10: UE-BasedPerfMeas-Parameters-r16 (Table
8.1.5.1.1.3.3-3)

  ------------------------------------------------ -------------- --------- --------------------------------
  Information Element                              Value/remark   Comment   Condition
  UE-BasedPerfMeas-Parameters-r16 ::= SEQUENCE {                            
  barometerMeasReport-r16                          Checked                  pc\_barometer\_r16
  immMeasBT-r16                                    Checked                  pc\_immMeasBT\_r16
  immMeasWLAN-r16                                  Checked                  pc\_immMeasWLAN\_r16
  loggedMeasBT-r16                                 Checked                  pc\_loggedMeasBT\_r16
  loggedMeasurements-r16                           Checked                  pc\_loggedMeasurements\_r16
  loggedMeasWLAN-r16                               Checked                  pc\_loggedMeasWLAN\_r16
  orientationMeasReport-r16                        Checked                  pc\_orientation\_r16
  speedMeasReport-r16                              Checked                  pc\_speed\_r16
  gnss-Location-r16                                Checked                  pc\_GNSS\_location\_r16
  ulPDCP-Delay-r16                                 Checked                  pc\_PDCP\_Delay\_r16
  sigBasedLogMDT-OverrideProtect-r17               Not checked              
  multipleCEF-Report-r17                           Checked                  pc\_multiple\_CEF\_Report\_r17
  excessPacketDelay-r17                            Not checked              
  earlyMeasLog-r17                                 Checked                  pc\_earlyMeasLog\_r17
  }                                                                         
  ------------------------------------------------ -------------- --------- --------------------------------

Table 8.1.5.1.1.3.3-11: MAC-ParametersFRX-Diff-r16 (Table
8.1.5.1.1.3.3-3)

+----------------+----------------+----------------+----------------+
| **Information  | **             | **Comment**    | **Condition**  |
| Element**      | Value/remark** |                |                |
+----------------+----------------+----------------+----------------+
| MAC-Paramete   |                |                |                |
| rsFRX-Diff-r16 |                |                |                |
| ::= SEQUENCE { |                |                |                |
+----------------+----------------+----------------+----------------+
| d              | Checked        |                | pc\_dir        |
| irectMCG-SCell |                |                | ectMCG\_SCellA |
| Activation-r16 |                |                | ctivation\_r16 |
+----------------+----------------+----------------+----------------+
| directM        | Checked        |                | pc\_directMCG  |
| CG-SCellActiva |                |                | \_SCellActivat |
| tionResume-r16 |                |                | ionResume\_r16 |
+----------------+----------------+----------------+----------------+
| d              | Checked        |                | pc\_dir        |
| irectSCG-SCell |                |                | ectSCG\_SCellA |
| Activation-r16 |                |                | ctivation\_r16 |
+----------------+----------------+----------------+----------------+
| directS        | Checked        |                | pc\_directSCG  |
| CG-SCellActiva |                |                | \_SCellActivat |
| tionResume-r16 |                |                | ionResume\_r16 |
+----------------+----------------+----------------+----------------+
| drx-           | Checked        | MinTimeGap-r16 | pc\_D          |
| Adaptation-r16 |                |                | RX\_Adaptation |
|                |                | Acc. to TS     |                |
|                |                | 38.306 \[23\]  |                |
|                |                | clause 4.2.6:  |                |
|                |                | when this      |                |
|                |                | field is       |                |
|                |                | reported,      |                |
|                |                | either of      |                |
|                |                | sharedSpectr   |                |
|                |                | umChAccess-r16 |                |
|                |                | or             |                |
|                |                | no             |                |
|                |                | n-SharedSpectr |                |
|                |                | umChAccess-r16 |                |
|                |                | shall be       |                |
|                |                | reported, at   |                |
|                |                | least.         |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+

Table 8.1.5.1.1.3.3-12: MIMO-ParametersPerBand (Table 8.1.5.1.1.3.3-3)

+----------------+--------------+----------------+----------------+
| Information    | Value/remark | Comment        | Condition      |
| Element        |              |                |                |
+----------------+--------------+----------------+----------------+
| MIMO-Par       | Not checked  |                |                |
| ametersPerBand |              |                |                |
| ::= SEQUENCE { |              |                |                |
+----------------+--------------+----------------+----------------+
| tci-StatePDSCH | Not checked  |                |                |
+----------------+--------------+----------------+----------------+
| ad             | Not checked  |                |                |
| ditionalActive |              |                |                |
| TCI-StatePDCCH |              |                |                |
+----------------+--------------+----------------+----------------+
| pusch-         | Not checked  |                |                |
| TransCoherence |              |                |                |
+----------------+--------------+----------------+----------------+
| beamCorrespo   | Not checked  |                |                |
| ndenceWithoutU |              |                |                |
| L-BeamSweeping |              |                |                |
+----------------+--------------+----------------+----------------+
| peri           | Not checked  |                |                |
| odicBeamReport |              |                |                |
+----------------+--------------+----------------+----------------+
| aperi          | Not checked  |                |                |
| odicBeamReport |              |                |                |
+----------------+--------------+----------------+----------------+
| sp-B           | Not checked  |                |                |
| eamReportPUCCH |              |                |                |
+----------------+--------------+----------------+----------------+
| sp-B           | Not checked  |                |                |
| eamReportPUSCH |              |                |                |
+----------------+--------------+----------------+----------------+
| dummy1         | Not checked  |                |                |
+----------------+--------------+----------------+----------------+
| m              | Not checked  |                |                |
| axNumberRxBeam |              |                |                |
+----------------+--------------+----------------+----------------+
| maxNumberRx    | Not checked  |                |                |
| TxBeamSwitchDL |              |                |                |
+----------------+--------------+----------------+----------------+
| ma             | Not checked  |                |                |
| xNumberNonGrou |              |                |                |
| pBeamReporting |              |                |                |
+----------------+--------------+----------------+----------------+
| grou           | Not checked  |                |                |
| pBeamReporting |              |                |                |
+----------------+--------------+----------------+----------------+
| uplink         | Not checked  |                |                |
| BeamManagement |              |                |                |
+----------------+--------------+----------------+----------------+
| maxNu          | Checked      | Acc. to TS     | pc\_maxNumb    |
| mberCSI-RS-BFD |              | 38.306 \[23\]  | erCSI\_RS\_BFD |
|                |              | clause         |                |
|                |              | 4.2.7.2: ***In |                |
|                |              | this release,  |                |
|                |              | the maximum    |                |
|                |              | value that can |                |
|                |              | be signalled   |                |
|                |              | is 16          |                |
|                |              | \[,,\]***      |                |
|                |              |                |                |
|                |              | ***It is       |                |
|                |              | mandatory***   |                |
|                |              | with           |                |
|                |              | capability     |                |
|                |              | signalling     |                |
|                |              | ***for FR2 and |                |
|                |              | optional for   |                |
|                |              | FR1.***        |                |
+----------------+--------------+----------------+----------------+
| ma             | Not checked  |                |                |
| xNumberSSB-BFD |              |                |                |
+----------------+--------------+----------------+----------------+
| maxNumber      | Checked      | Acc. to TS     | pc             |
| CSI-RS-SSB-CBD |              | 38.306 \[23\]  | \_maxNumberCSI |
|                |              | clause         | \_RS\_SSB\_CBD |
|                |              | 4.2.7.2: ***In |                |
|                |              | this release,  |                |
|                |              | the maximum    |                |
|                |              | value that can |                |
|                |              | be signalled   |                |
|                |              | is 128.        |                |
|                |              | \[,,\]***      |                |
|                |              |                |                |
|                |              | ***It is       |                |
|                |              | mandatory***   |                |
|                |              | with           |                |
|                |              | capability     |                |
|                |              | signalling     |                |
|                |              | ***for FR2 and |                |
|                |              | optional for   |                |
|                |              | FR1. The UE is |                |
|                |              | mandated to    |                |
|                |              | report at      |                |
|                |              | least 32 for   |                |
|                |              | FR2.***        |                |
+----------------+--------------+----------------+----------------+
| dummy2         |              |                |                |
+----------------+--------------+----------------+----------------+
| t              |              |                |                |
| woPortsPTRS-UL |              |                |                |
+----------------+--------------+----------------+----------------+
| dummy5         |              |                |                |
+----------------+--------------+----------------+----------------+
| dummy3         |              |                |                |
+----------------+--------------+----------------+----------------+
| be             |              |                |                |
| amReportTiming |              |                |                |
+----------------+--------------+----------------+----------------+
| ptr            |              |                |                |
| s-DensityRecom |              |                |                |
| mendationSetDL |              |                |                |
+----------------+--------------+----------------+----------------+
| ptr            |              |                |                |
| s-DensityRecom |              |                |                |
| mendationSetUL |              |                |                |
+----------------+--------------+----------------+----------------+
| dummy4         |              |                |                |
+----------------+--------------+----------------+----------------+
| aperiodicTRS   |              |                |                |
+----------------+--------------+----------------+----------------+
| srs-increased  | Not checked  |                |                |
| Repetition-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| srs-           | Not checked  |                |                |
| partialFrequen |              |                |                |
| cySounding-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| srs-startR     | Not checked  |                |                |
| B-locationHopp |              |                |                |
| ingPartial-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| srs            | Not checked  |                |                |
| -combEight-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| c              | Not checked  |                |                |
| odebookParamet |              |                |                |
| ersfetype2-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PUSCH     | Not checked  |                |                |
| -twoCSI-RS-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PUCCH     | Not checked  |                |                |
| -InterSlot-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PUCCH-Cyc | Not checked  |                |                |
| licMapping-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PUCCH     | Not checked  |                |                |
| -SecondTPC-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-BFR-two   | Not checked  |                |                |
| BFD-RS-Set-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-BFR-PUCC  | Not checked  |                |                |
| H-SR-perCG-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-          | Not checked  |                |                |
| BFR-associatio |              |                |                |
| n-PUCCH-SR-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| sfn-S          | Not checked  |                |                |
| imulTwoTCI-Acr |              |                |                |
| ossMultiCC-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| sfn-DefaultDL  | Not checked  |                |                |
| -BeamSetup-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| sfn-DefaultUL  | Not checked  |                |                |
| -BeamSetup-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| srs-Trigge     | Not checked  |                |                |
| ringOffset-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| srs-Tri        | Not checked  |                |                |
| ggeringDCI-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| codeboo        | Not checked  |                |                |
| kComboParamete |              |                |                |
| rMixedType-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifi          | Not checked  |                |                |
| edJointTCI-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| uni            | Not checked  |                |                |
| fiedJointTCI-m |              |                |                |
| ultiMAC-CE-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| u              | Not checked  |                |                |
| nifiedJointTCI |              |                |                |
| -perBWP-CA-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifi          | Not checked  |                |                |
| edJointTCI-Lis |              |                |                |
| tSharingCA-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifi          | Not checked  |                |                |
| edJointTCI-com |              |                |                |
| monMultiCC-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifi          | Not checked  |                |                |
| edJointTCI-Bea |              |                |                |
| mAlignDLRS-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifie         | Not checked  |                |                |
| dJointTCI-PC-a |              |                |                |
| ssociation-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifiedJoint   | Not checked  |                |                |
| TCI-Legacy-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| un             | Not checked  |                |                |
| ifiedJointTCI- |              |                |                |
| Legacy-SRS-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unified        | Not checked  |                |                |
| JointTCI-Legac |              |                |                |
| y-CORESET0-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifiedJointTC | Not checked  |                |                |
| I-SCellBFR-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| u              | Not checked  |                |                |
| nifiedJointTCI |              |                |                |
| -InterCell-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifiedS       | Not checked  |                |                |
| eparateTCI-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifie         | Not checked  |                |                |
| dSeparateTCI-m |              |                |                |
| ultiMAC-CE-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unif           | Not checked  |                |                |
| iedSeparateTCI |              |                |                |
| -perBWP-CA-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifiedS       | Not checked  |                |                |
| eparateTCI-Lis |              |                |                |
| tSharingCA-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifiedS       | Not checked  |                |                |
| eparateTCI-com |              |                |                |
| monMultiCC-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unif           | Not checked  |                |                |
| iedSeparateTCI |              |                |                |
| -InterCell-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| unifiedJo      | Not checked  |                |                |
| intTCI-mTRP-In |              |                |                |
| terCell-BM-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mpe-           | Not checked  |                |                |
| Mitigation-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| srs-           | Not checked  |                |                |
| PortReport-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PDCCH-    | Not checked  |                |                |
| individual-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTR            | Not checked  |                |                |
| P-PDCCH-anySpa |              |                |                |
| n-3Symbols-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PDCCH-Tw  | Not checked  |                |                |
| oQCL-TypeD-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PU        | Not checked  |                |                |
| SCH-CSI-RS-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PUSCH-cyc | Checked      |                | pc\            |
| licMapping-r17 |              |                | _mtrpPuschCycl |
|                |              |                | icMapping\_r17 |
+----------------+--------------+----------------+----------------+
| mTRP-PUSCH     | Not checked  |                |                |
| -secondTPC-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTR            | Not checked  |                |                |
| P-PUSCH-twoPHR |              |                |                |
| -Reporting-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-P         | Not checked  |                |                |
| USCH-A-CSI-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PU        | Not checked  |                |                |
| SCH-SP-CSI-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTR            | Not checked  |                |                |
| P-PUSCH-CG-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PU        | Not checked  |                |                |
| CCH-MAC-CE-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-PUCCH-max | Not checked  |                |                |
| Num-PC-FR1-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-          | Not checked  |                |                |
| inter-Cell-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-GroupBa   | Not checked  |                |                |
| sedL1-RSRP-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-BFD       | Not checked  |                |                |
| -RS-MAC-CE-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTR            | Not checked  |                |                |
| P-CSI-Enhancem |              |                |                |
| entPerBand-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| codebo         | Not checked  |                |                |
| okComboParamet |              |                |                |
| erMultiTRP-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-CSI-add   | Not checked  |                |                |
| itionalCSI-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mTRP-          | Not checked  |                |                |
| CSI-N-Max2-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| mT             | Not checked  |                |                |
| RP-CSI-CMR-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| srs-partialFr  | Not checked  |                |                |
| eqSounding-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| beamSwit       | Not checked  |                |                |
| chTiming-v1710 |              |                |                |
+----------------+--------------+----------------+----------------+
| beamSw         | Not checked  |                |                |
| itchTiming-r17 |              |                |                |
+----------------+--------------+----------------+----------------+
| beamRepo       | Not checked  |                |                |
| rtTiming-v1710 |              |                |                |
+----------------+--------------+----------------+----------------+
| max            | Not checked  |                |                |
| NumberRxTxBeam |              |                |                |
| SwitchDL-v1710 |              |                |                |
+----------------+--------------+----------------+----------------+
| }              |              |                |                |
+----------------+--------------+----------------+----------------+

Table 8.1.5.1.1.3.3-13: SharedSpectrumChAccessParamsPerBand-r16 (Table
8.1.5.1.1.3.3-3)

  -------------------------------------------------------- -------------- --------- ------------------------------------------
  Information Element                                      Value/remark   Comment   Condition
  SharedSpectrumChAccessParamsPerBand-r16 ::= SEQUENCE {                            
  ul-DynamicChAccess-r16                                   Checked                  pc\_ul\_DynamicChAccess\_r16
  ul-Semi-StaticChAccess-r16                               Checked                  pc\_ul\_Semi\_StaticChAccess\_r16
  ssb-RRM-DynamicChAccess-r16                              Not checked              
  ssb-RRM-Semi-StaticChAccess-r16                          Not checked              
  mib-Acquisition-r16                                      Not checked              
  ssb-RLM-DynamicChAccess-r16                              Not checked              
  ssb-RLM-Semi-StaticChAccess-r16                          Not checked              
  sib1-Acquisition-r16                                     Not checked              
  extRA-ResponseWindow-r16                                 Not checked              
  ssb-BFD-CBD-dynamicChannelAccess-r16                     Not checked              
  ssb-BFD-CBD-semi-staticChannelAccess-r16                 Not checked              
  csi-RS-BFD-CBD-r16                                       Not checked              
  ul-ChannelBW-SCell-10mhz-r16                             Not checked              
  rssi-ChannelOccupancyReporting-r16                       Checked                  pc\_rssi\_ChannelOccupancyReporting\_r16
  srs-StartAnyOFDM-Symbol-r16                              Not checked              
  searchSpaceFreqMonitorLocation-r16                       Not checked              
  coreset-RB-Offset-r16                                    Not checked              
  cgi-Acquisition-r16                                      Not checked              
  configuredUL-Tx-r16                                      Not checked              
  prach-Wideband-r16                                       Not checked              
  dci-AvailableRB-Set-r16                                  Not checked              
  dci-ChOccupancyDuration-r16                              Not checked              
  typeB-PDSCH-length-r16                                   Not checked              
  searchSpaceSwitchWithDCI-r16                             Not checked              
  searchSpaceSwitchWithoutDCI-r16                          Not checked              
  searchSpaceSwitchCapability2-r16                         Not checked              
  non-numericalPDSCH-HARQ-timing-r16                       Not checked              
  enhancedDynamicHARQ-codebook-r16                         Not checked              
  oneShotHARQ-feedback-r16                                 Not checked              
  multiPUSCH-UL-grant-r16                                  Not checked              
  csi-RS-RLM-r16                                           Not checked              
  dummy                                                    Not checked              
  periodicAndSemi-PersistentCSI-RS-r16                     Not checked              
  pusch-PRB-interlace-r16                                  Not checked              
  pucch-F0-F1-PRB-Interlace-r16                            Not checked              
  occ-PRB-PF2-PF3-r16                                      Not checked              
  extCP-rangeCG-PUSCH-r16                                  Not checked              
  configuredGrantWithReTx-r16                              Not checked              
  ed-Threshold-r16                                         Not checked              
  ul-DL-COT-Sharing-r16                                    Not checked              
  mux-CG-UCI-HARQ-ACK-r16                                  Not checked              
  cg-resourceConfig-r16                                    Not checked              
  }                                                                                 
  -------------------------------------------------------- -------------- --------- ------------------------------------------

Table 8.1.5.1.1.3.3-14: CA-ParametersNR-v1800 (Table 8.1.5.1.1.3.3-3)

  **Information Element**                             **Value/remark**   **Comment**   **Condition**
  --------------------------------------------------- ------------------ ------------- -------------------------------------------------------------------------------------------------------------------------------
  CA-ParametersNR-v1800 ::= SEQUENCE {                                                 
  codebookParametersetype2DopplerCSI-PerBC-r18        Not checked                      
  codebookParametersfetype2DopplerCSI-PerBC-r18       Not checked                      
  codebookParametersetype2CJT-PerBC-r18               Not checked                      
  codebookParametersfetype2CJT-PerBC-r18              Not checked                      
  codebookComboParametersCJT-PerBC-r18                Not checked                      
  codebookParametersHARQ-ACK-PUSCH-PerBC-r18          Not checked                      
  maxNumberTAG-AcrossCC-r18                           Not checked                      
  tdcp-ReportPerBC-r18                                Not checked                      
  tdcp-ResourcePerBC-r18                              Not checked                      
  timelineRelax-CJT-CSI-CA-r18                        Not checked                      
  spatialAdaptation-CSI-FeedbackPerBC-r18             Not checked                      
  nonCodebook-CSI-RS-SRS-PerBC-r18                    Not checked                      
  spatialAdaptation-CSI-FeedbackPUSCH-PerBC-r18       Not checked                      
  spatialAdaptation-CSI-FeedbackAperiodicPerBC-r18    Not checked                      
  spatialAdaptation-CSI-FeedbackPUCCH-PerBC-r18       Not checked                      
  powerAdaptation-CSI-FeedbackPerBC-r18               Not checked                      
  powerAdaptation-CSI-FeedbackPUSCH-PerBC-r18         Not checked                      
  powerAdaptation-CSI-FeedbackAperiodicPerBC-r18      Not checked                      
  powerAdaptation-CSI-FeedbackPUCCH-PerBC-r18         Not checked                      
  mixCodeBookSpatialAdaptationPerBC-r18               Not checked                      
  simultaneousCSI-SubReportsAllCC-r18                 Not checked                      
  multiCell-PDSCH-DCI-1-3-SameSCS-r18 SEQUENCE {      Checked                          pc\_multiCell\_PDSCH\_DCI\_1\_3\_SameSCS\_r18
  coScheduledCellSCS-r18                              Not checked                      
  maxNumberCoScheduledCell-r18                        Not checked                      
  maxNumberSetsOfCellAcrossPUCCH-Group-r18            Not checked                      
  maxNumberSetsOfCellScheduling-r18                   Not checked                      
  harqFeedbackType-r18                                Checked                          pc\_harqFeedbackType1\_DCI\_1\_3 or pc\_harqFeedbackType2\_DCI\_1\_3
  coScheduledCellIndicationScheme-r18                 Checked                          pc\_coScheduledCellIndicationScheme\_r18\_fdra\_DCI\_1\_3 and/or pc\_coScheduledCellIndicationScheme\_r18\_cellInd\_DCI\_1\_3
  supportOfSearchSpace-r18                            Not checked                      
  licensed-fdd-tdd-fr1-r18                            Not checked                      
  }                                                                                    
  multiCell-PDSCH-DCI-1-3-DiffSCS-r18                 Not checked                      
  multiCell-PUSCH-DCI-0-3-SameSCS-r18 SEQUENCE {      Checked                          pc\_multiCell\_PUSCH\_DCI\_0\_3\_SameSCS\_r18
  coScheduledCellSCS-r18                              Not checked                      
  maxNumberSetsOfCellAcrossPUCCH-Group-r18            Not checked                      
  maxNumberSetsOfCellScheduling-r18                   Not checked                      
  coScheduledCellIndicationScheme-r18                 Checked                          pc\_coScheduledCellIndicationScheme\_r18\_fdra\_DCI\_0\_3 and/or pc\_coScheduledCellIndicationScheme\_r18\_cellInd\_DCI\_0\_3
  supportOfSearchSpace-r18                            Checked                          pc\_supportOfSearchSpace\_r18\_DCI\_0\_3
  licensed-fdd-tdd-fr1-r18                            Not checked                      
  }                                                                                    
  multiCell-PUSCH-DCI-0-3-DiffSCS-r18                 Not checked                      
  advUnicastDCI-DL-r18                                Not checked                      
  advUnicastDCI-UL-r18                                Not checked                      
  type3HARQ-CB-DCI-1-3-r18                            Not checked                      
  type3EnhHARQ-CB-DCI-1-3-r18                         Not checked                      
  scellDormancyWithinActiveTime-DCI-0-3-And-1-3-r18   Not checked                      
  pdcch-MonitoringCA-Ext-r18                          Not checked                      
  pdcch-BlindDetectionCA-MixedExt-r18                 Not checked                      
  pdcch-BlindDetectionMCG-SCG-List-r18                Not checked                      
  intraBandNR-CA-non-collocated-r18                   Not checked                      
  }                                                                                    

#### 8.1.5.2 SI change / On-demand SIB

##### 8.1.5.2.1 Void

##### 8.1.5.2.2 SI change / Notification of BCCH modification / Short message for SI update in NR RRC\_CONNECTED state

##### 8.1.5.2.2.1 Test Purpose (TP) {#test-purpose-tp-1 .H6}

\(1\)

**with { UE in NR RRC\_CONNECTED state }**

**ensure that {**

**when { UE receives a short message transmitted on PDCCH using P-RNTI
indicating a systemInfoModification }**

**then { UE re-acquires the SIB1 }**

**}**

##### 8.1.5.2.2.2 Conformance requirements {#conformance-requirements-1 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clause 5.2.2.2.2, 5.2.2.3.1, 5.2.2.4.2
and 6.5. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.2.2.2.2\]

A modification period is used, i.e. updated SI (other than for ETWS and
CMAS) is broadcasted in the modification period following the one where
SI change indication is transmitted. The modification period boundaries
are defined by SFN values for which SFN mod m= 0, where m is the number
of radio frames comprising the modification period. The modification
period is configured by system information. The UE receives indications
about SI modifications and/or PWS notifications using Short Message
transmitted with P-RNTI over DCI (see clause 6.5). Repetitions of SI
change indication may occur within preceding modification period.

UEs in RRC\_IDLE or in RRC\_INACTIVE shall monitor for SI change
indication in its own paging occasion every DRX cycle. UEs in
RRC\_CONNECTED shall monitor for SI change indication in any paging
occasion at least once per modification period if the UE is provided
with common search space on the active BWP to monitor paging, as
specified in TS 38.213 \[13\], clause 13.

...

If the UE receives a Short Message, the UE shall:

...

1\> if the *systemInfoModification* bit of Short Message is set:

2\> apply the SI acquisition procedure as defined in sub-clause 5.2.2.3
from the start of the next modification.

\[TS 38.331, clause 5.2.2.3.1\]

The UE shall:

1\> apply the specified BCCH configuration defined in 9.1.1.1;

...

1\> if the UE is in RRC\_CONNECTED with an active BWP with common search
space configured by *searchSpaceSIB1* and *pagingSearchSpace* and has
received an indication about change of system information; or

...

NOTE: The UE in RRC\_CONNECTED is only required to acquire broadcasted
*SIB1* if the UE can acquire it without disrupting unicast data
reception, i.e. the broadcast and unicast beams are quasi co-located.

\[TS 38.331, clause 5.2.2.4.2\]

Upon receiving the *SIB1* the UE shall:

...

3\> if the UE has a stored valid version of a SIB, in accordance with
sub-clause 5.2.2.2.1, that the UE requires to operate within the cell in
accordance with sub-clause 5.2.2.1:

4\> use the stored version of the required SIB;

3\> if the UE has not stored a valid version of a SIB, in accordance
with sub-clause 5.2.2.2.1, of one or several required SIB(s), in
accordance with sub-clause 5.2.2.1:

4\> for the SI message(s) that, according to the *si-SchedulingInfo*,
contain at least one required SIB and for which *si-BroadcastStatus* is
set to broadcasting:

5\> acquire the SI message(s) as defined in sub-clause 5.2.2.3.2;

\[TS 38.331, clause 6.5\]

Short messages can be transmitted on PDCCH using P-RNTI with or without
associated *Paging* message using Short Message field in DCI format 1\_0
(see TS 38.212 \[17, 7.3.1.2.1\]).

Table 6.5-1 defines Short Messages. Bit 1 is the most significant bit.

Table 6.5-1: Short messages

+------------+--------------------------------------------------------+
| Bit        | Short message                                          |
+============+========================================================+
| 1          | ***systemInfoModification***                           |
|            |                                                        |
|            | *If set to 1: indication of a BCCH modification other  |
|            | than SIB6, SIB7 and SIB8.*                             |
+------------+--------------------------------------------------------+
| 2          | ***etwsAndCmasIndication***                            |
|            |                                                        |
|            | *If set to 1: indication of an ETWS primary            |
|            | notification and/or an ETWS secondary notification     |
|            | and/or a CMAS notification.*                           |
+------------+--------------------------------------------------------+
| 3 -- \[8\] | Not used in this release of the specification, and     |
|            | shall be ignored by UE if received.                    |
+------------+--------------------------------------------------------+

##### 8.1.5.2.2.3 Test Description {#test-description-1 .H6}

##### 8.1.5.2.2.3.1 Pre-test conditions {#pre-test-conditions-1 .H6}

##### System Simulator: {#system-simulator-1 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell.

##### UE: {#ue-1 .H6}

\- None.

Preamble:

\- The UE is in 5GS state 3N-A and Test Loop Function (ON) with UE test
loop mode B established according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3 with the exception that Short\_DCI condition is applied
in NR Serving cell configuration.

##### 8.1.5.2.2.3.2 Test procedure sequence {#test-procedure-sequence-1 .H6}

Table 8.1.5.2.2.3.2-1: Main behaviour

  St                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Procedure                                                                                                                 Message Sequence   TP                                Verdict   
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- --------- ----
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      U - S              Message                                     
  1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         The SS sends one IP Packet to the UE.                                                                                     \-                 \-                                \-        \-
  1A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        The SS waits 0.5 second and then ignores scheduling requests and does not allocate any uplink grant.                      \-                 \-                                \-        \-
  2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         The SS changes the prach-ConfigurationIndex and ra-ResponseWindow in the system information.                              \-                 \-                                \-        \-
  3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         The SS transmits a Short message on PDCCH using P-RNTI indicating a systemInfoModification.                               \-                 PDCCH (DCI 1\_0): Short Message   \-        \-
  4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Void                                                                                                                      \-                 \-                                \-        \-
  5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Check: Does the UE initiate a random access using prach-ConfigurationIndex given in step 3 to send pending Uplink data?   \-                 \-                                1         P
  6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         The SS transmits Random Access Response with RAPID corresponding to preamble in step 5. (Note 1)                          \-                 \-                                \-        \-
  7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         The UE loop backs the IP packets received in step 1                                                                       \-                 \-                                \-        \-
  8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         The SS starts the UL default grant transmissions.                                                                                                                                        
  Note 1: The resource allocation for Msg3 shall be enough to accommodate all of the DRB data that UE will loop back at step 7. To be more specific, resource allocation shall be no less than: TB size = IP packet (64 bytes) + SDAP header (1 bytes) + PDCP header (3 bytes) + RLC header (3 bytes) + MAC header (2 bytes) + padding or BSR (2 bytes) + C-RNTI MAC CE (3 Bytes) + PHR (3 bytes) = 81 bytes for pc\_supportOfRedCap\_r17 =false, or TB size = IP packet (64 bytes) + SDAP header (1 bytes) + PDCP header (2 bytes) + RLC header (2 bytes) + MAC header (2 bytes) + padding and/or BSR (4 bytes) + C-RNTI MAC CE (3 Bytes) + PHR (3 bytes) = 81 bytes for pc\_supportOfRedCap\_r17 =true.                                                                                                                                                                                            

##### 8.1.5.2.2.3.3 Specific message contents {#specific-message-contents-1 .H6}

Table 8.1.5.2.2.3.3-1: CLOSE UE TEST LOOP (Preamble, Table
8.1.5.2.2.3.2-1)

  Derivation Path: TS 36.508-1 \[7\] table 4.7A-3 condition UE test loop mode B                                 
  ------------------------------------------------------------------------------- ---------------- ------------ -----------
  Information Element                                                             Value/Remark     Comment      Condition
  UE test loop mode B LB setup                                                                                  
  IP PDU delay                                                                    \'0000 1111\'B   15 seconds   

Table 8.1.5.2.2.3.3-2: SIB1 (step 2, Table 8.1.5.2.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28                            
  --------------------------------------------------- -------------- --------- ---------------------
  Information Element                                 Value/Remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                          
  servingCellConfigCommon SEQUENCE {                                           
  uplinkConfigCommon SEQUENCE {                                                
  initialUplinkBWP SEQUENCE {                                                  
  rach-ConfigCommon SEQUENCE {                                                 
  rach-ConfigGeneric SEQUENCE {                                                
  prach-ConfigurationIndex                            119            .         FR1 FDD
                                                      120                      FR1 FDD AND HD\_FDD
                                                      91                       FR1 TDD
                                                      6                        FR2
  ra-ResponseWindow                                   sl20                     
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

  ----------- -----------------------------------------------------------------------------------------
  Condition   Explanation
  HD\_FDD     pc\_halfDuplexFDD\_TypeA\_RedCap\_r17 (i.e. HD\_FDD UE are performing test on FDD band)
  ----------- -----------------------------------------------------------------------------------------

##### 8.1.5.2.3 eDRX / IDLE / Paging for notification of BCCH modification

##### 8.1.5.2.3.1 Test Purpose (TP) {#test-purpose-tp-2 .H6}

\(1\)

with { UE in NR RRC\_IDLE state using eDRX cycle longer than the BCCH
modification period }

ensure that {

when {UE receives a Short Message and the systemInfoModification-eDRX
bit is set to indicate BCCH modification }

then {UE applies the SI acquisition procedure to update the new system
information }

}

\(2\)

with { UE in NR RRC\_IDLE state using eDRX cycle shorter than the BCCH
modification period }

ensure that {

when {UE receives a Short Message and the systemInfoModification bit is
set to indicate BCCH modification }

then {UE applies the SI acquisition procedure to update the new system
information }

}

##### 8.1.5.2.3.2 Conformance requirements {#conformance-requirements-2 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clause 5.2.2.2.2, ,5.2.2.3.1,
5.2.2.3.2, 5.2.2.4.2 and 6.5, 38.304, clause 7.4. Unless otherwise
stated these are Rel-17 requirements.

\[TS 38.304, clause 7.4\]

The UE may be configured by upper layers and/or RRC with an extended DRX
(eDRX) cycle T~eDRX,\ CN~ and/or T~eDRX,\ RAN~. The UE operates in eDRX
for CN paging in RRC\_IDLE or RRC\_INACTIVE states if the UE is
configured for eDRX by upper layers and *eDRX-AllowedIdle* is signalled
in SIB1. The UE operates in eDRX for RAN paging in RRC\_INACTIVE state
if the UE is configured for eDRX by RAN and *eDRX-Allowed*I*nactive* is
signalled in SIB1. If the UE operates in eDRX with an eDRX cycle no
longer than 1024 radio frames, it monitors POs as defined in 7.1 with
configured eDRX cycle. Otherwise, a UE operating in eDRX monitors POs as
defined in 7.1 during a periodic Paging Time Window (PTW) configured for
the UE. The PTW is UE-specific and is determined by a Paging Hyperframe
(PH), a starting position within the PH (PTW\_start) and an ending
position (PTW\_end). PH, PTW\_start and PTW\_end are given by the
following formula:

The PH for CN is the H-SFN satisfying the following equations:

H-SFN mod T~eDRX\_CN~= (UE\_ID\_H mod T~eDRX\_CN~), where

\- UE\_ID\_H: 13 most significant bits of the Hashed ID.

\- T~eDRX\_CN~: UE-specific eDRX cycle in Hyper-frames, (T~eDRX\_CN~ =
2, ..., 1024 Hyper-frames) configured by upper layers.

> PTW\_start denotes the first radio frame of the PH that is part of the
> PTW and has SFN satisfying the following equation:

SFN = 128 \* i~eDRX\_CN~, where

\- i~eDRX\_CN~ = floor(UE\_ID\_H /T~eDRX\_CN~) mod 8

PTW\_end is the last radio frame of the PTW and has SFN satisfying the
following equation:

SFN = (PTW\_start + L\*100 - 1) mod 1024, where

\- L = Paging Time Window (PTW) length (in seconds) configured by upper
layers

Hashed ID is defined as follows:

Hashed\_ID is Frame Check Sequence (FCS) for the bits b31, b30..., b0 of
5G-S-TMSI.

5G-S-TMSI = \<b47, b46, ..., b0\> as defined in TS 23.003 \[23\].

The 32-bit FCS shall be the ones complement of the sum (modulo 2) of Y1
and Y2, where

\- Y1 is the remainder of x^k^ (x^31^ + x^30^ + x^29^ + x^28^ + x^27^ +
x^26^ + x^25^ + x^24^ + x^23^ + x^22^ + x^21^ + x^20^ + x^19^ + x^18^ +
x^17^ + x^16^ + x^15^ + x^14^ + x^13^ + x^12^ + x^11^ + x^10^ + x^9^ +
x^8^ + x^7^ + x^6^ + x^5^ + x^4^ + x^3^ + x^2^ + x^1^ + 1) divided
(modulo 2) by the generator polynomial x^32^ + x^26^ + x^23^ + x^22^ +
x^16^ + x^12^ + x^11^ + x^10^ + x^8^ + x^7^ + x^5^ + x^4^ + x^2^ + x +
1, where k is 32; and

\- Y2 is the remainder of Y3 divided (modulo 2) by the generator
polynomial x^32^ + x^26^ + x^23^ + x^22^ + x^16^ + x^12^ + x^11^ + x^10^
+ x^8^ + x^7^ + x^5^ + x^4^ + x^2^ + x + 1, where Y3 is the product of
x^32^ by \"b31, b30..., b0 of S-TMSI or 5G-S-TMSI\", i.e., Y3 is the
generator polynomial x^32^ (b31\*x^31^ + b30\*x^30^ + ... + b0\*1).

NOTE: The Y1 is 0xC704DD7B for any 5G-S-TMSI value. An example of hashed
ID calculation is in Annex A.

\[TS 38.331, clause 5.2.2.2.2\]

A modification period is used, i.e. updated SI message (other than SI
message for ETWS, CMAS, positioning assistance data, and some
NTN-specific information as specified in the field descriptions ) is
broadcasted in the modification period following the one where SI change
indication is transmitted. The modification period boundaries are
defined by SFN values for which SFN mod m = 0, where m is the number of
radio frames comprising the modification period. The modification period
is configured by system information. If H-SFN is provided in *SIB1*, and
UE is configured with eDRX, modification period boundaries are defined
by SFN values for which (H-SFN \* 1024 + SFN) mod *m* = 0.

For UEs in RRC\_IDLE or RRC\_INACTIVE configured to use an IDLE eDRX
cycle longer than the modification period, an eDRX acquisition period is
defined. The boundaries of the eDRX acquisition period are determined by
H-SFN values for which H-SFN mod 1024 = 0.

The UE receives indications about SI modifications and/or PWS
notifications using Short Message transmitted with P-RNTI over DCI (see
clause 6.5). Repetitions of SI change indication may occur within
preceding modification period or within preceding eDRX acquisition
period. SI change indication is not applicable for SI messages
containing posSIBs.

...

For Short Message reception in a paging occasion, the UE monitors the
PDCCH monitoring occasion(s) for paging as specified in TS 38.304 \[20\]
and TS 38.213 \[13\].

A L2 U2N Remote UE is not required to monitor paging occasion for SI
modifications and/or PWS notifications. It obtains the updated system
information and SIB6/7/8 from the connected L2 U2N Relay UE as defined
in clause 5.8.9.9.3.

If the UE receives a Short Message, the UE shall:

...

1\> if the UE does not operate an IDLE eDRX cycle longer than the
modification period and the *systemInfoModification* bit of Short
Message is set:

2\> apply the SI acquisition procedure as defined in clause 5.2.2.3 from
the start of the next modification period;

1\> if the UE operates an IDLE eDRX cycle longer than the modification
period and the *systemInfoModification-eDRX* bit of Short Message is
set:

2\> apply the SI acquisition procedure as defined in clause 5.2.2.3 from
the start of the next eDRX acquisition period boundary.

\[TS 38.331, clause 5.2.2.3.1\]

The UE shall:

1\> apply the specified BCCH configuration defined in 9.1.1.1;

1\> if the UE is in RRC\_IDLE or in RRC\_INACTIVE; or

1\> if the UE is in RRC\_CONNECTED while T311 is running:

2\> acquire the *MIB,* which is scheduled as specified in TS 38.213
\[13\];

\...

1\> if the UE is in RRC\_IDLE or in RRC\_INACTIVE; or

...

2\> if *ssb-SubcarrierOffset* indicates *SIB1* is transmitted in the
cell (TS 38.213 \[13\]) and if *SIB1* acquisition is required for the
UE:

3\> acquire the *SIB1,* which is scheduled as specified in TS 38.213
\[13\];

3\> if the UE is unable to acquire the *SIB1*:

4\> perform the actions as specified in clause 5.2.2.5;

3\> else:

4\> upon acquiring *SIB1*, perform the actions specified in clause
5.2.2.4.2.

2\> else if *SIB1* acquisition is required for the UE and
*ssb-SubcarrierOffset* indicates that *SIB1* is not scheduled in the
cell:

3\> perform the actions as specified in clause 5.2.2.5.

...

\[TS 38.331, clause 5.2.2.3.2\]

For SI message acquisition PDCCH monitoring occasion(s) are determined
according to *searchSpaceOtherSystemInformation*. If
*searchSpaceOtherSystemInformation* is set to zero, PDCCH monitoring
occasions for SI message reception in SI-window are same as PDCCH
monitoring occasions for *SIB1* where the mapping between PDCCH
monitoring occasions and SSBs is specified in TS 38.213\[13\]. If
*searchSpaceOtherSystemInformation* is not set to zero, PDCCH monitoring
occasions for SI message are determined based on search space indicated
by *searchSpaceOtherSystemInformation*. PDCCH monitoring occasions for
SI message which are not overlapping with UL symbols (determined
according to *tdd-UL-DL-ConfigurationCommon*) are sequentially numbered
from one in the SI window. The \[x×N+K\]^th^ PDCCH monitoring occasion
(s) for SI message in SI-window corresponds to the K^th^ transmitted
SSB, where x = 0, 1, \...X-1, K = 1, 2, ...N, N is the number of actual
transmitted SSBs determined according to *ssb-PositionsInBurst* in
*SIB1* and X is equal to CEIL(number of PDCCH monitoring occasions in
SI-window/N). The actual transmitted SSBs are sequentially numbered from
one in ascending order of their SSB indexes. The UE assumes that, in the
SI window, PDCCH for an SI message is transmitted in at least one PDCCH
monitoring occasion corresponding to each transmitted SSB and thus the
selection of SSB for the reception SI messages is up to UE
implementation.

When acquiring an SI message, the UE shall:

1\> determine the start of the SI-window for the concerned SI message as
follows:

2\> if the concerned SI message is configured in the
*schedulingInfoList*:

3\> for the concerned SI message, determine the number *n* which
corresponds to the order of entry in the list of SI messages configured
by *schedulingInfoList* in *si-SchedulingInfo* in *SIB1*;

3\> determine the integer value *x = (n -- 1) × w*, where *w* is the
*si-WindowLength*;

3\> the SI-window starts at the slot \#*a*, where *a* = *x* mod N, in
the radio frame for which SFN mod *T* = FLOOR(*x*/N), where *T* is the
*si-Periodicity* of the concerned SI message and N is the number of
slots in a radio frame as specified in TS 38.213 \[13\];

2\> else if the concerned SI message is configured in the
*schedulingInfoList2*;

3\> determine the integer value *x = (si-WindowPosition -1) × w*, where
*w* is the *si-WindowLength*;

3\> the SI-window starts at the slot \#*a*, where *a* = *x* mod N, in
the radio frame for which SFN mod *T* = FLOOR(*x*/N), where *T* is the
*si-Periodicity* of the concerned SI message and N is the number of
slots in a radio frame as specified in TS 38.213 \[13\];

2\> else if the concerned SI message is configured in the
*posSchedulingInfoList* and *offsetToSI-Used* is not configured:

3\> create a concatenated list of SI messages by appending the
*posSchedulingInfoList* in *posSI-SchedulingInfo* in *SIB1 to
schedulingInfoList* in *si-SchedulingInfo* in *SIB1;*

3\> for the concerned SI message, determine the number *n* which
corresponds to the order of entry in the concatenated list;

3\> determine the integer value *x = (n -- 1) × w*, where *w* is the
*si-WindowLength*;

3\> the SI-window starts at the slot \#*a*, where *a* = *x* mod N, in
the radio frame for which SFN mod *T* = FLOOR(*x*/N), where *T* is the
*posSI-Periodicity* of the concerned SI message and N is the number of
slots in a radio frame as specified in TS 38.213 \[13\];

2\> else if the concerned SI message is configured by the
*posSchedulingInfoList* and *offsetToSI-Used* is configured:

3\> determine the number *m* which corresponds to the number of SI
messages with an associated *si-Periodicity* of 8 radio frames (80 ms),
configured by *schedulingInfoList* in *SIB1*;

3\> for the concerned SI message, determine the number *n* which
corresponds to the order of entry in the list of SI messages configured
by *posSchedulingInfoList* in *SIB1*;

3\> determine the integer value *x* = *m* *× w +* (*n* -- 1*)* *× w*,
where *w* is the *si-WindowLength;*

3\> the SI-window starts at the slot \#*a*, where *a* = *x* mod N, in
the radio frame for which SFN mod *T* = FLOOR(*x*/N) +8, where *T* is
the *posSI-Periodicity* of the concerned SI message and N is the number
of slots in a radio frame as specified in TS 38.213 \[13\];

1\> receive the PDCCH containing the scheduling RNTI, i.e. SI-RNTI in
the PDCCH monitoring occasion(s) for SI message acquisition, from the
start of the SI-window and continue until the end of the SI-window whose
absolute length in time is given by *si-WindowLength*, or until the SI
message was received;

1\> if the SI message was not received by the end of the SI-window,
repeat reception at the next SI-window occasion for the concerned SI
message in the current modification period;

1\> if all the SIB(s) and/or posSIB(s) requested in
*DedicatedSIBRequest* message have been acquired:

2\> stop timer T350, if running;

NOTE 1: The UE is only required to acquire broadcasted SI message if the
UE can acquire it without disrupting unicast or MBS multicast data
reception, i.e. the broadcast and unicast/MBS multicast beams are quasi
co-located.

NOTE 2: The UE is not required to monitor PDCCH monitoring occasion(s)
corresponding to each transmitted SSB in SI-window.

NOTE 3: If the concerned SI message was not received in the current
modification period, handling of SI message acquisition is left to UE
implementation.

NOTE 4: A UE in RRC\_CONNECTED may stop the PDCCH monitoring during the
SI window for the concerned SI message when the requested SIB(s) are
acquired.

NOTE 5: A UE capable of NR sidelink communication/discovery and
configured by upper layers to perform NR sidelink
communication/discovery on a frequency, may acquire *SIB12* or
*SystemInformationBlockType28* from a cell other than current serving
cell (for RRC\_INACTIVE or RRC\_IDLE) or current PCell (for
RRC\_CONNECTED), if *SIB12* of current serving cell (for RRC\_INACTIVE
or RRC\_IDLE) or current PCell (for RRC\_CONNECTED) does not provide
configuration for NR sidelink communication/discovery for the frequency,
and if the other cell providing configuration for NR sidelink
communication/discovery for the frequency meets the S-criteria as
defined in TS 38.304 \[20\] or TS 36.304 \[27\].

1\> perform the actions for the acquired SI message as specified in
clause 5.2.2.4.

\[TS 38.331, clause 5.2.2.4.2\]

Upon receiving the *SIB1* the UE shall:

1\> store the acquired *SIB1*;

...

2\> if the UE has a stored valid version of a SIB or posSIB, in
accordance with clause 5.2.2.2.1, that the UE requires to operate within
the cell in accordance with clause 5.2.2.1:

3\> use the stored version of the required SIB or posSIB;

2\> else:

3\> acquire the required SIB or posSIB requested by upper layer as
defined in clause 5.2.2.3.5;

...

4\> if the UE has a stored valid version of a SIB, in accordance with
clause 5.2.2.2.1, that the UE requires to operate within the cell in
accordance with clause 5.2.2.1:

5\> use the stored version of the required SIB;

4\> if the UE has not stored a valid version of a SIB, in accordance
with clause 5.2.2.2.1, of one or several required SIB(s), in accordance
with clause 5.2.2.1:

5\> for the SI message(s) that, according to the *si-SchedulingInfo*,
contain at least one required SIB and for which *si-BroadcastStatus* is
set to broadcasting:

6\> acquire the SI message(s) as defined in clause 5.2.2.3.2;

5\> for the SI message(s) that, according to the *si-SchedulingInfo*,
contain at least one required SIB and for which *si-BroadcastStatus* is
set to *notBroadcasting*:

6\> trigger a request to acquire the SI message(s) as defined in clause
5.2.2.3.3;

...

\[TS 38.331, clause 6.5\]

Short Messages can be transmitted on PDCCH using P-RNTI with or without
associated *Paging* message using Short Message field in DCI format 1\_0
(see TS 38.212 \[17\], clause 7.3.1.2.1).

Table 6.5-1 defines Short Messages. Bit 1 is the most significant bit.

Table 6.5-1: Short Messages

+--------+------------------------------------------------------------+
| Bit    | Short Message                                              |
+========+============================================================+
| 1      | ***systemInfoModification***                               |
|        |                                                            |
|        | If set to 1: indication of a BCCH modification other than  |
|        | *SIB6*, *SIB7*, *SIB8* and *posSIBs*.                      |
+--------+------------------------------------------------------------+
| 2      | ***etwsAndCmasIndication***                                |
|        |                                                            |
|        | If set to 1: indication of an ETWS primary notification    |
|        | and/or an ETWS secondary notification and/or a CMAS        |
|        | notification.                                              |
+--------+------------------------------------------------------------+
| 3      | ***stopPagingMonitoring***                                 |
|        |                                                            |
|        | This bit can be used for only operation with shared        |
|        | spectrum channel access and if                             |
|        | *nrofPDCCH-MonitoringOccasionPerSSB-InPO* is present.      |
|        |                                                            |
|        | If set to 1: indication that the UE may stop monitoring    |
|        | PDCCH occasion(s) for paging in this Paging Occasion as    |
|        | specified in TS 38.304 \[20\], clause 7.1.                 |
+--------+------------------------------------------------------------+
| 4      | ***systemInfoModification-eDRX***                          |
|        |                                                            |
|        | If set to 1: indication of a BCCH modification other than  |
|        | *SIB6*, *SIB7*, *SIB8* and *posSIB*s. This indication      |
|        | applies only to UEs using IDLE eDRX cycle longer than the  |
|        | BCCH modification period.                                  |
+--------+------------------------------------------------------------+
| 5 -- 8 | Not used in this release of the specification and shall be |
|        | ignored by UE if received.                                 |
+--------+------------------------------------------------------------+

##### 8.1.5.2.3.3 Test Description {#test-description-2 .H6}

##### 8.1.5.2.3.3.1 Pre-test conditions {#pre-test-conditions-2 .H6}

##### System Simulator: {#system-simulator-2 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell.

##### UE: {#ue-2 .H6}

\- UE supporting extended DRX.

Preamble:

\- UE is in state 0N-B according to TS 38.508-1 \[4\] Table 4.4A.2-0.

##### 8.1.5.2.3.3.2 Test procedure sequence {#test-procedure-sequence-2 .H6}

Table 8.1.5.2.3.3.2-1: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The UE is   | \-          | \-          | \-      | \- |
|       | switched on |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2-3   | Steps 2-3   | \-          | \-          | \-      | \- |
|       | of the      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | for NR      |             |             |         |    |
|       | RRC\_IDLE   |             |             |         |    |
|       | as          |             |             |         |    |
|       | specified   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.2.2-2   |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             | *RRCSet     |         |    |
|       | R           |             | upComplete* |         |    |
|       | EGISTRATION |             |             |         |    |
|       | REQUEST     |             | 5GMM:       |         |    |
|       | message     |             | R           |         |    |
|       | including   |             | EGISTRATION |         |    |
|       | the         |             | REQUEST     |         |    |
|       | Requested   |             |             |         |    |
|       | extended    |             |             |         |    |
|       | DRX         |             |             |         |    |
|       | parameters  |             |             |         |    |
|       | IE.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5-13  | Steps 5-13  | \-          | \-          | \-      | \- |
|       | of Table    |             |             |         |    |
|       | 4.5.2.2-2   |             |             |         |    |
|       | of the      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *           |         |    |
|       | R           |             | DLInformati |         |    |
|       | EGISTRATION |             | onTransfer* |         |    |
|       | ACCEPT      |             |             |         |    |
|       | message     |             | 5GMM:       |         |    |
|       | including   |             | R           |         |    |
|       | the         |             | EGISTRATION |         |    |
|       | Negotiated  |             | ACCEPT      |         |    |
|       | extended    |             |             |         |    |
|       | DRX         |             |             |         |    |
|       | parameters  |             |             |         |    |
|       | IE.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmit a  |             | *           |         |    |
|       | R           |             | ULInformati |         |    |
|       | EGISTRATION |             | onTransfer* |         |    |
|       | COMPLETE    |             |             |         |    |
|       | message     |             | 5GMM:       |         |    |
|       |             |             | R           |         |    |
|       |             |             | EGISTRATION |         |    |
|       |             |             | COMPLETE    |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16-17 | Steps       | \-          | \-          | \-      | \- |
|       | 19Ca1-19Ca2 |             |             |         |    |
|       | of Table    |             |             |         |    |
|       | 4.5.2.2-2   |             |             |         |    |
|       | of the      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 18    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 19    | The SIB1 is | \<\--       | *PDCCH (DCI | \-      | \- |
|       | updated     |             | 1\_0):      |         |    |
|       | according   |             | Short*      |         |    |
|       | to Table    |             |             |         |    |
|       | 8.1.        |             | *Message*   |         |    |
|       | 5.2.3.3.3-2 |             |             |         |    |
|       | and SS      |             |             |         |    |
|       | transmits a |             |             |         |    |
|       | Short       |             |             |         |    |
|       | message on  |             |             |         |    |
|       | PDCCH using |             |             |         |    |
|       | P-RNTI      |             |             |         |    |
|       | indicating  |             |             |         |    |
|       | a           |             |             |         |    |
|       | system      |             |             |         |    |
|       | InfoModific |             |             |         |    |
|       | ation-eDRX. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20    | Wait till   | \-          | \-          | \-      | \- |
|       | the         |             |             |         |    |
|       | beginning   |             |             |         |    |
|       | of next     |             |             |         |    |
|       | eDRX        |             |             |         |    |
|       | acquisition |             |             |         |    |
|       | time (next  |             |             |         |    |
|       | H-SFN for   |             |             |         |    |
|       | which H-SFN |             |             |         |    |
|       | mod 1024    |             |             |         |    |
|       | =0).        |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20A   | After Step  | \-          | \-          | \-      | \- |
|       | 20, wait    |             |             |         |    |
|       | for 10s for |             |             |         |    |
|       | the UE to   |             |             |         |    |
|       | acquire the |             |             |         |    |
|       | new system  |             |             |         |    |
|       | i           |             |             |         |    |
|       | nformation. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 21    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | within a    |             |             |         |    |
|       | paging      |             |             |         |    |
|       | occasion    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 22    | Check: Does | \-          | \-          | 1       | P  |
|       | the UE      |             |             |         |    |
|       | transmit a  |             |             |         |    |
|       | random      |             |             |         |    |
|       | access      |             |             |         |    |
|       | using       |             |             |         |    |
|       | *pra        |             |             |         |    |
|       | ch-Configur |             |             |         |    |
|       | ationIndex* |             |             |         |    |
|       | given in    |             |             |         |    |
|       | step 19?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 23    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 24-29 | Steps 3 to  | \-          | *-*         | \-      | \- |
|       | 8 of the NR |             |             |         |    |
|       | RRC         |             |             |         |    |
|       | \_CONNECTED |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 30    | Switch off  | \-          |             |         |    |
|       | UE in RRC   |             |             |         |    |
|       | CONNECTED   |             |             |         |    |
|       | as          |             |             |         |    |
|       | described   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.6.3     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 31    | Switch on   | \-          |             |         |    |
|       | UE.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 32-33 | Steps 2-3   | \-          | \-          | \-      | \- |
|       | of the      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | for NR      |             |             |         |    |
|       | RRC\_IDLE   |             |             |         |    |
|       | as          |             |             |         |    |
|       | specified   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.2.2-2   |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 34    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             | *RRCSet     |         |    |
|       | R           |             | upComplete* |         |    |
|       | EGISTRATION |             |             |         |    |
|       | REQUEST     |             | 5GMM:       |         |    |
|       | message     |             | R           |         |    |
|       | including   |             | EGISTRATION |         |    |
|       | the         |             | REQUEST     |         |    |
|       | Requested   |             |             |         |    |
|       | extended    |             |             |         |    |
|       | DRX         |             |             |         |    |
|       | parameters  |             |             |         |    |
|       | IE.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 35-43 | Steps 5-13  | \-          | \-          | \-      | \- |
|       | of Table    |             |             |         |    |
|       | 4.5.2.2-2   |             |             |         |    |
|       | of the      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 44    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *           |         |    |
|       | R           |             | DLInformati |         |    |
|       | EGISTRATION |             | onTransfer* |         |    |
|       | ACCEPT      |             |             |         |    |
|       | message     |             | 5GMM:       |         |    |
|       | including   |             | R           |         |    |
|       | the         |             | EGISTRATION |         |    |
|       | Negotiated  |             | ACCEPT      |         |    |
|       | extended    |             |             |         |    |
|       | DRX         |             |             |         |    |
|       | parameters  |             |             |         |    |
|       | IE.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 45    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmit a  |             | *           |         |    |
|       | R           |             | ULInformati |         |    |
|       | EGISTRATION |             | onTransfer* |         |    |
|       | COMPLETE    |             |             |         |    |
|       | message     |             | 5GMM:       |         |    |
|       |             |             | R           |         |    |
|       |             |             | EGISTRATION |         |    |
|       |             |             | COMPLETE    |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 46-47 | Steps       | \-          | \-          | \-      | \- |
|       | 19a1-19a2a1 |             |             |         |    |
|       | of Table    |             |             |         |    |
|       | 4.5.2.2-2   |             |             |         |    |
|       | of the      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] are   |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 48    | IF          | \<\--       | NR RRC:     | \-      | \- |
|       | *connected  |             | *           |         |    |
|       | without     |             | RRCRelease* |         |    |
|       | release* is |             |             |         |    |
|       | not present |             |             |         |    |
|       | THEN, the   |             |             |         |    |
|       | SS          |             |             |         |    |
|       | transmits   |             |             |         |    |
|       | an          |             |             |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 49    | The SIB1 is | \<\--       | *PDCCH (DCI | \-      | \- |
|       | updated     |             | 1\_0):      |         |    |
|       | according   |             | Short*      |         |    |
|       | to Table    |             |             |         |    |
|       | 8.1.        |             | *Message*   |         |    |
|       | 5.2.3.3.3-1 |             |             |         |    |
|       | and SS      |             |             |         |    |
|       | transmits a |             |             |         |    |
|       | Short       |             |             |         |    |
|       | message on  |             |             |         |    |
|       | PDCCH using |             |             |         |    |
|       | P-RNTI      |             |             |         |    |
|       | indicating  |             |             |         |    |
|       | a           |             |             |         |    |
|       | s           |             |             |         |    |
|       | ystemInfoMo |             |             |         |    |
|       | dification. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 50    | Wait for    | \-          | \-          | \-      | \- |
|       | 2.1\*       |             |             |         |    |
|       | m           |             |             |         |    |
|       | odification |             |             |         |    |
|       | period to   |             |             |         |    |
|       | allow the   |             |             |         |    |
|       | new system  |             |             |         |    |
|       | information |             |             |         |    |
|       | to take     |             |             |         |    |
|       | effect.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 51    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message     |             |             |         |    |
|       | within a    |             |             |         |    |
|       | paging      |             |             |         |    |
|       | occasion    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 52    | Check: Does | \-          | \-          | 2       | P  |
|       | the UE      |             |             |         |    |
|       | transmit a  |             |             |         |    |
|       | random      |             |             |         |    |
|       | access      |             |             |         |    |
|       | using       |             |             |         |    |
|       | *pra        |             |             |         |    |
|       | ch-Configur |             |             |         |    |
|       | ationIndex* |             |             |         |    |
|       | given in    |             |             |         |    |
|       | step 49?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 53    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 54-59 | Steps 3 to  | \-          | *-*         | \-      | \- |
|       | 8 of the NR |             |             |         |    |
|       | RRC         |             |             |         |    |
|       | \_CONNECTED |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.5.2.3.3.3 Specific message contents {#specific-message-contents-2 .H6}

Table 8.1.5.2.3.3.3-1: SIB1 (Preamble and Step49, Table 8.1.5.2.3.3.2-1)

  ---------------------------------------------------- --------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                                   
  Information Element                                  Value/remark          Comment   Condition
  SIB1 ::= SEQUENCE {                                                                  
  nonCriticalExtension SEQUENCE {                                                      
  nonCriticalExtension SEQUENCE {                                                      
  nonCriticalExtension SEQUENCE {                                                      
  hyperSFN-r17                                         Current H-SFN Value             
  eDRX-AllowedIdle-r17                                 true                            
  eDRX-AllowedInactive-r17                             true                            
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  ---------------------------------------------------- --------------------- --------- -----------

Table 8.1.5.2.3.3.3-2: SIB1 (Step19, Table 8.1.5.2.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28                                   
  --------------------------------------------------- --------------------- --------- ---------------------
  Information Element                                 Value/Remark          Comment   Condition
  SIB1 ::= SEQUENCE {                                                                 
  nonCriticalExtension SEQUENCE {                                                     
  nonCriticalExtension SEQUENCE {                                                     
  nonCriticalExtension SEQUENCE {                                                     
  hyperSFN-r17                                        Current H-SFN Value             
  eDRX-AllowedIdle-r17                                true                            
  eDRX-AllowedInactive-r17                            true                            
  }                                                                                   
  }                                                                                   
  }                                                                                   
  servingCellConfigCommon SEQUENCE {                                                  
  uplinkConfigCommon SEQUENCE {                                                       
  initialUplinkBWP SEQUENCE {                                                         
  rach-ConfigCommon SEQUENCE {                                                        
  rach-ConfigGeneric SEQUENCE {                                                       
  prach-ConfigurationIndex                            119                             FR1 FDD
                                                      120                             FR1 FDD AND HD\_FDD
                                                      91                              FR1 TDD
                                                      6                               FR2
  ra-ResponseWindow                                   sl20                            
  }                                                                                   
  }                                                                                   
  }                                                                                   
  }                                                                                   
  }                                                                                   
  }                                                                                   

  ----------- ----------------------------------------------------------------------------------------
  Condition   Explanation
  HD\_FDD     pc\_halfDuplexFDD\_TypeA\_RedCap\_r17 (i.e HD\_FDD UE are performing test on FDD band)
  ----------- ----------------------------------------------------------------------------------------

Table 8.1.5.2.3.3.3-3: REGISTRATION ACCEPT (Step 14, Table
8.1.5.2.3.3.2-1)

  Derivation path: TS 38.508-1 \[4\], table 4.7.1-7                                                                                                                                      
  -------------------------------------------------------------------------------------------------------------------------------------------------- ------------------- --------------- -----------
  Information Element                                                                                                                                Value/Remark        Comment         Condition
  Negotiated extended DRX parameters                                                                                                                                                     
  Paging Time Window                                                                                                                                 Any allowed value   Note            
  eDRX value                                                                                                                                         '0100'B             40,96 seconds   
  Extended Paging Time Window                                                                                                                        '00000001'B         2,56 seconds    
  Note 1: In NR connected to 5GCN, the Paging Time Window field is ignored and the PTW value is included in the Extended Paging Time Window field.                                       

Table 8.1.5.2.3.3.3-4: REGISTRATION ACCEPT (Step 44, Table
8.1.5.2.3.3.2-1)

  Derivation path: TS 38.508-1 \[4\], table 4.7.1-7                                                                                                                                     
  -------------------------------------------------------------------------------------------------------------------------------------------------- ------------------- -------------- -----------
  Information Element                                                                                                                                Value/Remark        Comment        Condition
  Negotiated extended DRX parameters                                                                                                                                                    
  Paging Time Window                                                                                                                                 Any allowed value   Note 1         
  eDRX value                                                                                                                                         '0000'B             2,56 seconds   
  Extended Paging Time Window                                                                                                                        '00000011'B         5,12 seconds   
  Note 1: In NR connected to 5GCN, the Paging Time Window field is ignored and the PTW value is included in the Extended Paging Time Window field.                                      

Table 8.1.5.2.3.3.3-5: REGISTRATION REQUEST (Step 4 and Step 52 Table
8.1.5.2.3.3.2-1)

  Derivation path: TS 38.508-1 \[4\], table 4.7.1-6                                                                                                                                                     
  -------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------- --------- -----------
  Information Element                                                                                                                                      Value/Remark                       Comment   Condition
  Requested extended DRX parameters                                                                                                                                                                     
  Paging Time Window                                                                                                                                       Present but contents not checked             
  eDRX value                                                                                                                                               Present but contents not checked             
  Extended Paging Time Window                                                                                                                              Not Checked                        Note 1    
  Note 1: Extended Paging Time Window is an optional IE. If UE request eDRX cycle larger than 10,24 seconds, UE may include Extended Paging Time Window.                                                

#### 8.1.5.3 PWS notification

##### 8.1.5.3.1 PWS notification / PWS reception in NR RRC\_IDLE state

##### 8.1.5.3.1.1 Test Purpose (TP) {#test-purpose-tp-3 .H6}

##### (1) {#section-1 .H6}

**with** { UE in NR RRC\_IDLE state }

**ensure that** {

**when** { an ETWS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB6 }

**then** { the UE is able to retrieve the PWS message from SIB6 and
alert the user }

}

##### (2) {#section-2 .H6}

**with** { UE in NR RRC\_IDLE state }

**ensure that** {

**when** { an ETWS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB7 }

**then** { the UE is able to retrieve all the PWS message segments from
SIB7, reassemble the message and alert the user }

}

##### (3) {#section-3 .H6}

**with** { UE in NR RRC\_IDLE state }

**ensure that** {

**when** { a CMAS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB8 }

**then** { the UE is able to retrieve all the PWS message segments from
SIB8, reassemble the message and alert the user }

}

##### 8.1.5.3.1.2 Conformance requirements {#conformance-requirements-3 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clause 5.2.2.2.2.

\[TS 38.331 clause 5.2.2.2.2\]

...

ETWS or CMAS capable UEs in RRC\_IDLE or in RRC\_INACTIVE shall monitor
for indications about PWS notification in its own paging occasion every
DRX cycle. ETWS or CMAS capable UEs in RRC\_CONNECTED shall monitor for
indication about PWS notification in any paging occasion at least once
every *defaultPagingCycle* if the UE is provided with common search
space on the active BWP to monitor paging.

For Short Message reception in a paging occasion, the UE monitors the
PDCCH monitoring occasion(s) for paging as specified in TS 38.304 \[20\]
and TS 38.213 \[13\].

If the UE receives a Short Message, the UE shall:

1\> if the UE is ETWS capable or CMAS capable, the
*etwsAndCmasIndication* bit of Short Message is set, and the UE is
provided with *searchSpaceOtherSystemInformation* on the active BWP:

2\> immediately re-acquire the *SIB1*;

2\> if the UE is ETWS capable and *si-SchedulingInfo* includes
scheduling information for *SIB6*:

3\> acquire *SIB6*, as specified in sub-clause 5.2.2.3.2, immediately;

2\> if the UE is ETWS capable and *si-SchedulingInfo* includes
scheduling information for *SIB7*:

3\> acquire *SIB7*, as specified in sub-clause 5.2.2.3.2, immediately;

2\> if the UE is CMAS capable and *si-SchedulingInfo* includes
scheduling information for *SIB8*:

3\> acquire *SIB8*, as specified in sub-clause 5.2.2.3.2, immediately;

1\> if the *systemInfoModification* bit of Short Message is set:

2\> apply the SI acquisition procedure as defined in sub-clause 5.2.2.3
from the start of the next modification period.

##### 8.1.5.3.1.3 Test description {#test-description-3 .H6}

##### 8.1.5.3.1.3.1 Pre-test conditions {#pre-test-conditions-3 .H6}

##### System Simulator: {#system-simulator-3 .H6}

> \- NR Cell 1.

##### UE: {#ue-3 .H6}

\- None.

##### Preamble: {#preamble-1 .H6}

\- The UE is in test state 1N-A according to TS 38.508-1 \[4\].

##### 8.1.5.3.1.3.2 Test procedure sequence {#test-procedure-sequence-3 .H6}

Table 8.1.5.3.1.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | If        | \-        | *-*       | \-      | \- |
|           | pc\       |           |           |         |    |
|           | _ETWS\_NR |           |           |         |    |
|           | is true,  |           |           |         |    |
|           | step1-8   |           |           |         |    |
|           | will be   |           |           |         |    |
|           | excuted.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | PDCCH     | \-      | \- |
|           | indicates |           | (DCI      |         |    |
|           | an        |           | 1\_0):    |         |    |
|           | etw       |           | Short     |         |    |
|           | sAndCmasI |           | Message   |         |    |
|           | ndication |           |           |         |    |
|           | by Short  |           |           |         |    |
|           | Message   |           |           |         |    |
|           | field in  |           |           |         |    |
|           | DCI       |           |           |         |    |
|           | format    |           |           |         |    |
|           | 1\_0 and  |           |           |         |    |
|           | tr        |           |           |         |    |
|           | ansmitted |           |           |         |    |
|           | on PDCCH  |           |           |         |    |
|           | using     |           |           |         |    |
|           | P-RNTI.   |           |           |         |    |
|           | The SS    |           |           |         |    |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | SIB1 with |           |           |         |    |
|           | the       |           |           |         |    |
|           | si-Sched  |           |           |         |    |
|           | ulingInfo |           |           |         |    |
|           | including |           |           |         |    |
|           | s         |           |           |         |    |
|           | cheduling |           |           |         |    |
|           | in        |           |           |         |    |
|           | formation |           |           |         |    |
|           | for SIB6  |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The SS    | \-        | *-*       | \-      | \- |
|           | includes  |           |           |         |    |
|           | an ETWS   |           |           |         |    |
|           | message   |           |           |         |    |
|           | with new  |           |           |         |    |
|           | *         |           |           |         |    |
|           | messageId |           |           |         |    |
|           | entifier* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *seri     |           |           |         |    |
|           | alNumber* |           |           |         |    |
|           | in        |           |           |         |    |
|           | *SIB6*.   |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | Check:    | \-        | \-        | 1       | P  |
|           | Does the  |           |           |         |    |
|           | UE alert  |           |           |         |    |
|           | or        |           |           |         |    |
|           | activate  |           |           |         |    |
|           | alerting  |           |           |         |    |
|           | the user  |           |           |         |    |
|           | (NOTE 2)? |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The SS    | \-        | *-*       | \-      | \- |
|           | waits for |           |           |         |    |
|           | 10s.      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | The SS    | \<\--     | PDCCH     | \-      | \- |
|           | indicates |           | (DCI      |         |    |
|           | an        |           | 1\_0):    |         |    |
|           | etw       |           | Short     |         |    |
|           | sAndCmasI |           | Message   |         |    |
|           | ndication |           |           |         |    |
|           | by Short  |           |           |         |    |
|           | Message   |           |           |         |    |
|           | field in  |           |           |         |    |
|           | DCI       |           |           |         |    |
|           | format    |           |           |         |    |
|           | 1\_0 and  |           |           |         |    |
|           | tr        |           |           |         |    |
|           | ansmitted |           |           |         |    |
|           | on PDCCH  |           |           |         |    |
|           | using     |           |           |         |    |
|           | P-RNTI.   |           |           |         |    |
|           | The SS    |           |           |         |    |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | SIB1 with |           |           |         |    |
|           | the       |           |           |         |    |
|           | si-Sched  |           |           |         |    |
|           | ulingInfo |           |           |         |    |
|           | including |           |           |         |    |
|           | s         |           |           |         |    |
|           | cheduling |           |           |         |    |
|           | in        |           |           |         |    |
|           | formation |           |           |         |    |
|           | for SIB7  |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | The SS    | \-        | *-*       | \-      | \- |
|           | includes  |           |           |         |    |
|           | an ETWS   |           |           |         |    |
|           | message   |           |           |         |    |
|           | with new  |           |           |         |    |
|           | *         |           |           |         |    |
|           | messageId |           |           |         |    |
|           | entifier* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *seri     |           |           |         |    |
|           | alNumber* |           |           |         |    |
|           | in        |           |           |         |    |
|           | *SIB7*.   |           |           |         |    |
|           | (NOTE 3). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | Check:    | \-        | \-        | 2       | P  |
|           | Does the  |           |           |         |    |
|           | UE        |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | the       |           |           |         |    |
|           | contents  |           |           |         |    |
|           | of the    |           |           |         |    |
|           | \"warning |           |           |         |    |
|           | message\" |           |           |         |    |
|           | to the    |           |           |         |    |
|           | user, and |           |           |         |    |
|           | alert or  |           |           |         |    |
|           | activate  |           |           |         |    |
|           | alerting  |           |           |         |    |
|           | the user  |           |           |         |    |
|           | (NOTE 2)? |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | The SS    | \-        | *-*       | \-      | \- |
|           | waits for |           |           |         |    |
|           | 10s.      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | If        | \-        | *-*       | \-      | \- |
|           | pc\       |           |           |         |    |
|           | _CMAS\_NR |           |           |         |    |
|           | is true,  |           |           |         |    |
|           | step9-11  |           |           |         |    |
|           | will be   |           |           |         |    |
|           | excuted.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | The SS    | \<\--     | PDCCH     | \-      | \- |
|           | indicates |           | (DCI      |         |    |
|           | an        |           | 1\_0):    |         |    |
|           | etw       |           | Short     |         |    |
|           | sAndCmasI |           | Message   |         |    |
|           | ndication |           |           |         |    |
|           | by Short  |           |           |         |    |
|           | Message   |           |           |         |    |
|           | field in  |           |           |         |    |
|           | DCI       |           |           |         |    |
|           | format    |           |           |         |    |
|           | 1\_0 and  |           |           |         |    |
|           | tr        |           |           |         |    |
|           | ansmitted |           |           |         |    |
|           | on PDCCH  |           |           |         |    |
|           | using     |           |           |         |    |
|           | P-RNTI.   |           |           |         |    |
|           | The SS    |           |           |         |    |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | SIB1 with |           |           |         |    |
|           | the       |           |           |         |    |
|           | si-Sched  |           |           |         |    |
|           | ulingInfo |           |           |         |    |
|           | including |           |           |         |    |
|           | s         |           |           |         |    |
|           | cheduling |           |           |         |    |
|           | in        |           |           |         |    |
|           | formation |           |           |         |    |
|           | for SIB8  |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | The SS    | \-        | *-*       | \-      | \- |
|           | includes  |           |           |         |    |
|           | a CMAS    |           |           |         |    |
|           | message   |           |           |         |    |
|           | with new  |           |           |         |    |
|           | *         |           |           |         |    |
|           | messageId |           |           |         |    |
|           | entifier* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *seri     |           |           |         |    |
|           | alNumber* |           |           |         |    |
|           | in        |           |           |         |    |
|           | *SIB8*.   |           |           |         |    |
|           | (NOTE 4). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11        | Check:    | \-        | \-        | 3       | P  |
|           | Does the  |           |           |         |    |
|           | UE        |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | the       |           |           |         |    |
|           | contents  |           |           |         |    |
|           | of the    |           |           |         |    |
|           | \"warning |           |           |         |    |
|           | message\" |           |           |         |    |
|           | to the    |           |           |         |    |
|           | user, and |           |           |         |    |
|           | alert or  |           |           |         |    |
|           | activate  |           |           |         |    |
|           | alerting  |           |           |         |    |
|           | the user  |           |           |         |    |
|           | (NOTE 2)? |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| NOTE 1:   |           |           |           |         |    |
| The NR-10 |           |           |           |         |    |
| in Table  |           |           |           |         |    |
| 4.        |           |           |           |         |    |
| 4.3.1.2-1 |           |           |           |         |    |
| Com       |           |           |           |         |    |
| binations |           |           |           |         |    |
| of system |           |           |           |         |    |
| in        |           |           |           |         |    |
| formation |           |           |           |         |    |
| blocks of |           |           |           |         |    |
| TS        |           |           |           |         |    |
| 38.508-1  |           |           |           |         |    |
| \[4\] is  |           |           |           |         |    |
| used.     |           |           |           |         |    |
|           |           |           |           |         |    |
| NOTE 2:   |           |           |           |         |    |
| The data  |           |           |           |         |    |
| i         |           |           |           |         |    |
| ndication |           |           |           |         |    |
| and user  |           |           |           |         |    |
| alerting  |           |           |           |         |    |
| are the   |           |           |           |         |    |
| UE        |           |           |           |         |    |
| imple     |           |           |           |         |    |
| mentation |           |           |           |         |    |
| issues.   |           |           |           |         |    |
|           |           |           |           |         |    |
| NOTE 3:   |           |           |           |         |    |
| The NR-11 |           |           |           |         |    |
| in Table  |           |           |           |         |    |
| 4.        |           |           |           |         |    |
| 4.3.1.2-1 |           |           |           |         |    |
| Com       |           |           |           |         |    |
| binations |           |           |           |         |    |
| of system |           |           |           |         |    |
| in        |           |           |           |         |    |
| formation |           |           |           |         |    |
| blocks of |           |           |           |         |    |
| TS        |           |           |           |         |    |
| 38.508-1  |           |           |           |         |    |
| \[4\] is  |           |           |           |         |    |
| used.     |           |           |           |         |    |
|           |           |           |           |         |    |
| NOTE 4:   |           |           |           |         |    |
| The NR-9  |           |           |           |         |    |
| in Table  |           |           |           |         |    |
| 4.        |           |           |           |         |    |
| 4.3.1.2-1 |           |           |           |         |    |
| Com       |           |           |           |         |    |
| binations |           |           |           |         |    |
| of system |           |           |           |         |    |
| in        |           |           |           |         |    |
| formation |           |           |           |         |    |
| blocks of |           |           |           |         |    |
| TS        |           |           |           |         |    |
| 38.508-1  |           |           |           |         |    |
| \[4\] is  |           |           |           |         |    |
| used.     |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.5.3.1.3.3 Specific message contents {#specific-message-contents-3 .H6}

None

##### 8.1.5.3.2 PWS notification / PWS reception in NR RRC\_INACTIVE state

##### 8.1.5.3.2.1 Test Purpose (TP) {#test-purpose-tp-4 .H6}

##### (1) {#section-4 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { an ETWS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB6 }

**then** { the UE is able to retrieve the PWS message from SIB6 and
alert the user }

}

##### (2) {#section-5 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { an ETWS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB7 }

**then** { the UE is able to retrieve all the PWS message segments from
SIB7, reassemble the message and alert the user }

}

##### (3) {#section-6 .H6}

**with** { UE in NR RRC\_INACTIVE state }

**ensure that** {

**when** { a CMAS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB8 }

**then** { the UE is able to retrieve all the PWS message segments from
SIB8, reassemble the message and alert the user }

}

##### 8.1.5.3.2.2 Conformance requirements {#conformance-requirements-4 .H6}

Same as test case 8.1.5.3.1.

##### 8.1.5.3.2.3 Test description {#test-description-4 .H6}

##### 8.1.5.3.2.3.1 Pre-test conditions {#pre-test-conditions-4 .H6}

##### System Simulator: {#system-simulator-4 .H6}

\- NR Cell 1.

##### UE: {#ue-4 .H6}

None.

##### Preamble: {#preamble-2 .H6}

\- The UE is in state Registered, Inactive mode (state 2N-A) according
to TS 38.508-1 \[4\].

##### 8.1.5.3.2.3.2 Test procedure sequence {#test-procedure-sequence-4 .H6}

Same as test case 8.1.5.3.1

##### 8.1.5.3.2.3.3 Specific message contents {#specific-message-contents-4 .H6}

Same as test case 8.1.5.3.1.

##### 8.1.5.3.3 PWS notification / PWS reception in NR RRC\_CONNECTED state

##### 8.1.5.3.3.1 Test Purpose (TP) {#test-purpose-tp-5 .H6}

##### (1) {#section-7 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { an ETWS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB6 }

**then** { the UE is able to retrieve all the PWS message segments from
SIB6, reassemble the message and alert the user }

}

##### (2) {#section-8 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { an ETWS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB7 }

**then** { the UE is able to retrieve all the PWS message segments from
SIB7, reassemble the message and alert the user }

}

##### (3) {#section-9 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { a CMAS capable UE receives a short message transmitted on
PDCCH using P-RNTI indicating an etwsAndCmasIndication and the
si-SchedulingInfo includes scheduling information for SIB8 }

**then** { the UE is able to retrieve all the PWS message segments from
SIB8, reassemble the message and alert the user }

}

##### 8.1.5.3.3.2 Conformance requirements {#conformance-requirements-5 .H6}

Same as test case 8.1.5.3.1.

##### 8.1.5.3.3.3 Test description {#test-description-5 .H6}

##### 8.1.5.3.3.3.1 Pre-test conditions {#pre-test-conditions-5 .H6}

##### System Simulator: {#system-simulator-5 .H6}

> \- NR Cell 1.

##### UE: {#ue-5 .H6}

None.

##### Preamble: {#preamble-3 .H6}

\- The UE is in test state 3N-A according to TS 38.508-1 \[4\].

##### 8.1.5.3.3.3.2 Test procedure sequence {#test-procedure-sequence-5 .H6}

Same as test case 8.1.5.3.1 except PDCCH (DCI 1\_0): Short Message is
sent on active BWP.

##### 8.1.5.3.3.3.3 Specific message contents {#specific-message-contents-5 .H6}

Same as test case 8.1.5.3.1.

##### 8.1.5.3.4 PWS notification / PWS reception using dedicatedSystemInformationDelivery

##### 8.1.5.3.4.1 Test Purpose (TP) {#test-purpose-tp-6 .H6}

##### (1) {#section-10 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including
dedicatedSystemInformationDelivery containing SIB6 }

**then** { UE reads the SIB6 to alert the user and sends an
RRCReconfigurationComplete message }

}

##### (2) {#section-11 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including
dedicatedSystemInformationDelivery containing SIB7 }

**then** { UE reads the SIB7 to alert the user and sends an
RRCReconfigurationComplete message }

}

##### (3) {#section-12 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCReconfiguration message including
dedicatedSystemInformationDelivery containing SIB8 }

**then** { UE reads the SIB8 to alert the user and sends an
RRCReconfigurationComplete message }

}

##### 8.1.5.3.4.2 Conformance requirements {#conformance-requirements-6 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.2.2.4.7, 5.2.2.4.8, 5.2.2.4.9,
5.3.5.3. Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

1\> if the *RRCReconfiguration* message includes the
*dedicatedSIB1-Delivery*:

2\> perform the action upon reception of *SIB1* as specified in
5.2.2.4.2;

1\> if the *RRCReconfiguration* message includes the
*dedicatedSystemInformationDelivery*:

2\> perform the action upon reception of System Information as specified
in 5.2.2.4;

\[TS 38.331, clause 5.2.2.4.7\]

Upon receiving the *SIB6* the UE shall:

1\> forward the received *warningType*, *messageIdentifier* and
*serialNumber* to upper layers;

\[TS 38.331, clause 5.2.2.4.8\]

Upon receiving the *SIB7* the UE shall:

1\> if there is no current value for *messageIdentifier* and
*serialNumber* for *SIB7*; or

1\> if either the received value of *messageIdentifier* or of
s*erialNumber* or of both are different from the current values of
*messageIdentifier* and *serialNumber* for *SIB7*:

2\> use the received values of *messageIdentifier* and *serialNumber*
for *SIB7* as the current values of *messageIdentifier* and
*serialNumber* for *SIB7*;

2\> discard any previously buffered *warningMessageSegment*;

2\> if all segments of a warning message have been received:

3\> assemble the warning message from the received
*warningMessageSegment*;

3\> forward the received warning message, *messageIdentifier*,
*serialNumber* and *dataCodingScheme* to upper layers;

3\> stop reception of *SIB7*;

3\> discard the current values of *messageIdentifier* and *serialNumber*
for *SIB7*;

2\> else:

3\> store the received *warningMessageSegment*;

3\> continue reception of *SIB7*;

1\> else if all segments of a warning message have been received:

2\> assemble the warning message from the received
*warningMessageSegment*;

2\> forward the received complete warning message, *messageIdentifier*,
*serialNumber* and *dataCodingScheme* to upper layers;

2\> stop reception of *SIB7*;

2\> discard the current values of *messageIdentifier* and *serialNumber*
for *SIB7*;

1\> else:

2\> store the received *warningMessageSegment*;

2\> continue reception of *SIB7*;

The UE should discard any stored *warningMessageSegment* and the current
value of *messageIdentifier* and *serialNumber* for *SIB7* if the
complete warning message has not been assembled within a period of 3
hours.

\[TS 38.331, clause 5.2.2.4.9\]

Upon receiving the *SIB8* the UE shall:

1\> if the *SIB8* contains a complete warning message and the complete
geographical area coordinates (if any):

2\> forward the received warning message, *messageIdentifier*,
*serialNumber*, *dataCodingScheme* and the geographical area coordinates
(if any) to upper layers;

2\> continue reception of *SIB8*;

1\> else:

2\> if the received values of *messageIdentifier* and *serialNumber* are
the same (each value is the same) as a pair for which a warning message
and the geographical area coordinates (if any) are currently being
assembled:

3\> store the received *warningMessageSegment*;

3\> store the received *warningAreaCoordinatesSegment* (if any);

3\> if all segments of a warning message and geographical area
coordinates (if any) have been received:

4\> assemble the warning message from the received
*warningMessageSegment*;

4\> assemble the geographical area coordinates from the received
*warningAreaCoordinatesSegment* (if any);

4\> forward the received warning message, *messageIdentifier*,
*serialNumber*, *dataCodingScheme* and geographical area coordinates (if
any) to upper layers;

4\> stop assembling a warning message and geographical area coordinates
(if any) for this *messageIdentifier* and *serialNumber* and delete all
stored information held for it;

3\> continue reception of *SIB8*;

2\> else if the received values of *messageIdentifier* and/or
*serialNumber* are not the same as any of the pairs for which a warning
message is currently being assembled:

3\> start assembling a warning message for this *messageIdentifier* and
*serialNumber* pair;

3\> start assembling the geographical area coordinates (if any) for this
*messageIdentifier* and *serialNumber* pair;

3\> store the received *warningMessageSegment*;

3\> store the received *warningAreaCoordinatesSegment* (if any);

3\> continue reception of *SIB8*;

The UE should discard *warningMessageSegment* and
*warningAreaCoordinatesSegment* (if any) and the associated values of
*messageIdentifier* and *serialNumber* for *SIB8* if the complete
warning message and the geographical area coordinates (if any) have not
been assembled within a period of 3 hours.

NOTE: The number of warning messages that a UE can re-assemble
simultaneously is a function of UE implementation.

##### 8.1.5.3.4.3 Test description {#test-description-6 .H6}

##### 8.1.5.3.4.3.1 Pre-test conditions {#pre-test-conditions-6 .H6}

##### System Simulator: {#system-simulator-6 .H6}

\- NR Cell 1.

##### UE: {#ue-6 .H6}

\- None

##### Preamble: {#preamble-4 .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-1

##### 8.1.5.3.4.3.2 Test procedure sequence {#test-procedure-sequence-6 .H6}

Table 8.1.5.3.4.3.2-1: Main behaviour

  St                                                                                Procedure                                                                                                            Message Sequence   TP                                     Verdict   
  --------------------------------------------------------------------------------- -------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                         U - S              Message                                          
  \-                                                                                If pc\_ETWS\_NR is true, steps 1-6 will be excuted.                                                                  \-                 *-*                                    \-        \-
  1                                                                                 The SS transmits an *RRCReconfiguration* message *containing* dedicatedSystemInformationDelivery containing SIB6.    \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  2                                                                                 Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                 \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  3                                                                                 Check: Does the UE alert or activate alerting the user (NOTE 1)?                                                     \-                 \-                                     1         P
  4                                                                                 The SS transmits an *RRCReconfiguration* message *containing* dedicatedSystemInformationDelivery containing SIB7.    \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  5                                                                                 Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                 \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  6                                                                                 Check: Does the UE indicate the \"warning message\" to the user, and alert or activate alerting the user (NOTE 1)?   \-                 \-                                     2         P
  \-                                                                                If pc\_CMAS\_NR is true, steps 7-9 will be excuted.                                                                  \-                 *-*                                    \-        \-
  7                                                                                 The SS transmits an *RRCReconfiguration* message *containing* dedicatedSystemInformationDelivery containing SIB8.    \<\--              NR RRC: *RRCReconfiguration*           \-        \-
  8                                                                                 Check: Does the UE transmit an *RRCReconfigurationComplete* message?                                                 \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  9                                                                                 Check: Does the UE alert or activate alerting the user (NOTE 1)?                                                     \-                 \-                                     3         P
  NOTE 1: The data indication and user alerting are the UE implementation issues.                                                                                                                                                                                            

##### 8.1.5.3.4.3.3 Specific message contents {#specific-message-contents-6 .H6}

Table 8.1.5.3.4.3.3-1: RRCReconfiguration (Steps 1, 4 and 7 Table
8.1.5.3.4.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13                                                                     
  ---------------------------------------------------- ------------------- --------------------------------------------- -----------
  Information Element                                  Value/remark        Comment                                       Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                      
  criticalExtensions CHOICE {                                                                                            
  rrcReconfiguration SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                        
  masterCellGroup                                      Not present                                                       
  dedicatedNAS-MessageList                             Not present                                                       
  dedicatedSystemInformationDelivery                   SystemInformation   OCTET STRING (CONTAINING SystemInformation)   
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      

Table 8.1.5.3.4.3.3-2: SystemInformation (Steps 1, 4 and 7 Table
8.1.5.3.4.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-29                                                                     
  --------------------------------------------------------- -------------- --------------------------------------------- -----------
  Information Element                                       Value/remark   Comment                                       Condition
  SystemInformation ::= SEQUENCE {                                                                                       
  criticalExtensions CHOICE {                                                                                            
  systemInformation-r15 SEQUENCE {                                                                                       
  sib-TypeAndInfo SEQUENCE (SIZE (1..maxSIB)) OF CHOICE {   1 entry                                                      
  sib6                                                      SIB6           Acc to 38.508-1 \[4\] Table 4.6.2-5: *SIB6*   Step 1
  sib7                                                      SIB7                                                         Step 4
  sib8                                                      SIB8                                                         Step 7
  }                                                                                                                      
  lateNonCriticalExtension                                  Not present                                                  
  nonCriticalExtension SEQUENCE {}                          Not present                                                  
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      

Table 8.1.5.3.4.3.3-3: *SIB7* (Step 4 in Table 8.1.5.3.4.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS 38.331 |                 |                 |           |
| \[6\], clause   |                 |                 |           |
| 6.3.1           |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| SIB7 ::=        |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| me              | \'0001 0001     | ETWS message    |           |
| ssageIdentifier | 0000 0010\'B    | identifier for  |           |
|                 |                 | earthquake and  |           |
|                 |                 | tsunami message |           |
|                 |                 | (see TS 23.041  |           |
|                 |                 | \[25\])         |           |
+-----------------+-----------------+-----------------+-----------+
| serialNumber    | \'0011 0000     | Note 1.         |           |
|                 | 0000 0000\'B    |                 |           |
+-----------------+-----------------+-----------------+-----------+
| warningMes      | lastSegment     |                 |           |
| sageSegmentType |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| warningMessa    | 0               |                 |           |
| geSegmentNumber |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| warnin          | Octetstring of  | Containing the  |           |
| gMessageSegment | N               | complete ETWS   |           |
|                 |                 | message         |           |
+-----------------+-----------------+-----------------+-----------+
| d               | Bitstring (8)   | see TS 23.041   |           |
| ataCodingScheme | ID of the       | \[25\].         |           |
|                 | alphabet/coding |                 |           |
|                 | and the applied |                 |           |
|                 | language        |                 |           |
+-----------------+-----------------+-----------------+-----------+
| lateNonCr       | Not present     |                 |           |
| iticalExtension |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Note 1:         |                 |                 |           |
| Geographical    |                 |                 |           |
| Scope (Octet 1  |                 |                 |           |
| bit 7 \~ 6) set |                 |                 |           |
| to \'Cell       |                 |                 |           |
| wide\',         |                 |                 |           |
|                 |                 |                 |           |
| Emergency User  |                 |                 |           |
| Alert (Octet 1  |                 |                 |           |
| bit 5) set to   |                 |                 |           |
| \'Activate      |                 |                 |           |
| emergency user  |                 |                 |           |
| alert\',        |                 |                 |           |
|                 |                 |                 |           |
| Popup (Octet 1  |                 |                 |           |
| bit 4) set to   |                 |                 |           |
| \'Activate      |                 |                 |           |
| popup\',        |                 |                 |           |
|                 |                 |                 |           |
| Update Number   |                 |                 |           |
| (Octet 2 bits   |                 |                 |           |
| 3\~0) for each  |                 |                 |           |
| update,         |                 |                 |           |
| incremented by  |                 |                 |           |
| one, See TS     |                 |                 |           |
| 23.041 \[25\].  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.3.4.3.3-4: *SIB8* (Step 7 in Table 8.1.5.3.4.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS 38.331 |                 |                 |           |
| \[6\], clause   |                 |                 |           |
| 6.3.1           |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| SIB8 ::=        |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| me              | \'0001 0001     | CMAS CBS        |           |
| ssageIdentifier | 0001 0010\'B    | Message         |           |
|                 |                 | Identifier for  |           |
|                 |                 | CMAS            |           |
|                 |                 | Presidential    |           |
|                 |                 | Level Alerts    |           |
|                 |                 | (see TS 23.041  |           |
|                 |                 | \[25\])         |           |
+-----------------+-----------------+-----------------+-----------+
| serialNumber    | \'0011 0000     | Note 1          |           |
|                 | 0000 0000\'B    |                 |           |
+-----------------+-----------------+-----------------+-----------+
| warningMes      | lastSegment     |                 |           |
| sageSegmentType |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| warningMessa    | 0               |                 |           |
| geSegmentNumber |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| warnin          | Octetstring of  |                 |           |
| gMessageSegment | N               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| d               | Bitstring (8)   | Containing the  |           |
| ataCodingScheme | ID of the       | complete CMAS   |           |
|                 | alphabet/coding | message         |           |
|                 | and the applied |                 |           |
|                 | language        |                 |           |
+-----------------+-----------------+-----------------+-----------+
| warningAreaCoo  | Not present     |                 |           |
| rdinatesSegment |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| lateNonCr       | Not present     |                 |           |
| iticalExtension |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Note 1:         |                 |                 |           |
| Geographical    |                 |                 |           |
| Scope (Octet 1  |                 |                 |           |
| bit 7 \~ 6) set |                 |                 |           |
| to \'Cell       |                 |                 |           |
| wide\',         |                 |                 |           |
|                 |                 |                 |           |
| Emergency User  |                 |                 |           |
| Alert (Octet 1  |                 |                 |           |
| bit 5) set to   |                 |                 |           |
| \'Activate      |                 |                 |           |
| emergency user  |                 |                 |           |
| alert\',        |                 |                 |           |
|                 |                 |                 |           |
| Popup (Octet 1  |                 |                 |           |
| bit 4) set to   |                 |                 |           |
| \'Activate      |                 |                 |           |
| popup\',        |                 |                 |           |
|                 |                 |                 |           |
| Update Number   |                 |                 |           |
| (Octet 2 bits   |                 |                 |           |
| 3\~0) for each  |                 |                 |           |
| update,         |                 |                 |           |
| incremented by  |                 |                 |           |
| one, See TS     |                 |                 |           |
| 23.041 \[25\].  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

#### 8.1.5.4 Counter check

##### 8.1.5.4.1 Counter check / Reception of CounterCheck message by the UE

##### 8.1.5.4.1.1 Test Purpose (TP) {#test-purpose-tp-7 .H6}

##### (1) {#section-13 .H6}

with { UE in NR RRC\_CONNECTED state with two DRBs established and
having received 10 data packets on each DRB }

ensure that {

when { UE receives CounterCheck message with drb-CountMSB-InfoList
included for DRB3(not established) and DRB1 (with the most significant
bits of the count different from the actual COUNT)}

then { UE sends CounterCheckResponse message by including the
drb-Identity, the count-Uplink and the count-Downlink set to the value
of TX\_NEXT -- 1 and RX\_NEXT -- 1 in drb-CountInfoList IE for each DRB
established, and by including the drb-Identity, the count-Uplink and the
count-Downlink with the most significant bits set identical to the
corresponding values in the drb-CountMSB-InfoList and the least
significant bits set to zero for the DRB that is not established }

}

##### 8.1.5.4.1.2 Conformance requirements {#conformance-requirements-7 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.3.6.3. Unless otherwise stated these
are Rel-15 requirements.

\[TS 38.331, clause 5.3.6.3\]

Upon receiving the *CounterCheck* message, the UE shall:

1\> for each DRB that is established:

2\> if no COUNT exists for a given direction (uplink or downlink)
because it is a uni-directional bearer configured only for the other
direction:

3\> assume the COUNT value to be 0 for the unused direction;

2\> if the *drb-Identity* is not included in the
*drb-CountMSB-InfoList*:

3\> include the DRB in the *drb-CountInfoList* in the
*CounterCheckResponse* message by including the *drb-Identity*, the
*count-Uplink* and the *count-Downlink* set to the value of TX\_NEXT --
1 and RX\_NEXT -- 1 (specified in TS 38.323 \[5\]), respectively;

2\> else if, for at least one direction, the most significant bits of
the COUNT are different from the value indicated in the
*drb-CountMSB-InfoList*:

3\> include the DRB in the *drb-CountInfoList* in the
*CounterCheckResponse* message by including the *drb-Identity*, the
*count-Uplink* and the *count-Downlink* set to the value of TX\_NEXT --
1 and RX\_NEXT -- 1 (specified in TS 38.323 \[5\]), respectively;

1\> for each DRB that is included in the *drb-CountMSB-InfoList* in the
*CounterCheck* message that is not established:

2\> include the DRB in the *drb-CountInfoList* in the
*CounterCheckResponse* message by including the *drb-Identity*, the
*count-Uplink* and the *count-Downlink* with the most significant bits
set identical to the corresponding values in the *drb-CountMSB-InfoList*
and the least significant bits set to zero;

> 1\> submit the *CounterCheckResponse* message to lower layers for
> transmission upon which the procedure ends.

##### 8.1.5.4.1.3 Test description {#test-description-7 .H6}

##### 8.1.5.4.1.3.1 Pre-test conditions {#pre-test-conditions-7 .H6}

##### System Simulator: {#system-simulator-7 .H6}

\- NR Cell 1.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in the NR cell.

##### UE: {#ue-7 .H6}

\- None.

##### Preamble: {#preamble-5 .H6}

\- The UE is in 5GS state 3N-A on NR Cell 1 with atleast one PDU session
active according to TS 38.508-1 \[4\], clause 4.4A.3 Table 4.4A.3-1 and
Test Loop Function (On) with UE test loop mode B is established. 2 DRBs
are configured where DRB1 is defined as default DRB.

##### 8.1.5.4.1.3.2 Test procedure sequence {#test-procedure-sequence-7 .H6}

Table 8.1.5.4.1.3.2-1: Main behaviour

  St                                                                                             Procedure                                                                                                                                                                                                                           Message Sequence   TP                                   Verdict   
  ---------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ------------------------------------ --------- ----
                                                                                                                                                                                                                                                                                                                                     U - S              Message                                        
  1                                                                                              The SS transmits 10 IP packets on each DRB (using QFI2 for DRB1 and QFI5 for DRB2)                                                                                                                                                  \-                 \-                                   \-        \-
  2                                                                                              The UE loops back the IP packets received in step 1 (Note 1)                                                                                                                                                                        \-                 \-                                   \-        \-
  3                                                                                              The SS transmits CounterCheck message with drb-Identity not included in the drb-CountMSB-InfoList                                                                                                                                   \<\--              NR RRC: ***CounterCheck***           \-        \-
  4                                                                                              Check: Does the UE send CounterCheckResponse message by including the drb-Identity, the count-Uplink and the count-Downlink set to the value of TX\_NEXT -- 1 and RX\_NEXT -- 1 in drb-CountInfoList IE for each DRB established?   \--\>              NR RRC: ***CounterCheckResponse***   1         P
  Note 1: IP packets at step 2 may be received by the SS in the same slot or in multiple slots                                                                                                                                                                                                                                                                                                         

##### 8.1.5.4.1.3.3 Specific message contents {#specific-message-contents-7 .H6}

Table 8.1.5.4.1.3.3-1: RRCReconfiguration (Preamble, Table
8.1.5.4.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-13 with condition NR                                                                         
  ---------------------------------------------------------------------- ------------------------- ------------------------------------------- -----------
  Information Element                                                    Value/remark              Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                            
  criticalExtensions CHOICE {                                                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                                                
  radioBearerConfig                                                      RadioBearerConfig-2DRBs                                               
  nonCriticalExtension SEQUENCE {                                                                                                              
  masterCellGroup                                                        CellGroupConfig-2DRBs     OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            

Table 8.1.5.4.1.3.3-2: RadioBearerConfig-2DRBs (Preamble, Table
8.1.5.4.1.3.3-1)

  --------------------------------------------------------------------------------- ---------------------------------- ----------------------------------------------------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-132 and condition SRB2 and DRB1                                                                                                        
  **Information Element**                                                           **Value/remark**                   **Comment**                                                       **Condition**
  RadioBearerConfig ::= SEQUENCE {                                                                                                                                                       
  drb-ToAddModList SEQUENCE (SIZE (1..maxDRB)) OF DRB-ToAddMod {                    2 entries                                                                                            
  DRB-ToAddMod\[1\] SEQUENCE {                                                                                         entry 1                                                           
  cnAssociation CHOICE {                                                                                                                                                                 
  sdap-Config::= SEQUENCE {                                                                                                                                                              
  pdu-Session                                                                       PDU session ID                     Same as the PDU session ID in PDU SESSION ESTABLISHMENT REQUEST   
  defaultDRB                                                                        true                                                                                                 
  mappedQoS-FlowsToAdd SEQUENCE {                                                                                                                                                        
  QFI                                                                               2                                                                                                    
  }                                                                                                                                                                                      
  }                                                                                                                                                                                      
  }                                                                                                                                                                                      
  drb-Identity                                                                      DRB-Identity with Condition DRB1                                                                     
  }                                                                                                                                                                                      
  }                                                                                                                                                                                      
  DRB-ToAddMod\[2\] SEQUENCE                                                                                           entry 2                                                           
  cnAssociation CHOICE {                                                                                                                                                                 
  sdap-Config SEQUENCE {                                                                                                                                                                 
  pdu-Session                                                                       PDU session ID                     Same as the PDU session ID in PDU SESSION ESTABLISHMENT REQUEST   
  defaultDRB                                                                        false                                                                                                
  mappedQoS-FlowsToAdd SEQUENCE {                                                                                                                                                        
  QFI                                                                               5                                                                                                    
  }                                                                                                                                                                                      
  }                                                                                                                                                                                      
  }                                                                                                                                                                                      
  drb-Identity                                                                      DRB-Identity with Condition DRB2                                                                     
  }                                                                                                                                                                                      
  }                                                                                                                                                                                      
  }                                                                                                                                                                                      
  }                                                                                                                                                                                      
  --------------------------------------------------------------------------------- ---------------------------------- ----------------------------------------------------------------- ---------------

Table 8.1.5.4.1.3.3-3: CellGroupConfig-2DRBs (Preamble, Table
8.1.5.4.1.3.3-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-19 and condition SRB2\_DRB1                                                            
  ----------------------------------------------------------------------------- ---------------------------------------------- --------- -----------
  Information Element                                                           Value/remark                                   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                         
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLC-ID)) OF RLC-BearerConfig {     3 entries                                                
  RLC-BearerConfig\[1\]                                                         RLC-BearerConfig with condition SRB2           entry 1   
  RLC-BearerConfig\[2\]                                                         RLC-BearerConfig with conditions AM and DRB1   entry 2   
  RLC-BearerConfig\[3\]                                                         RLC-BearerConfig with conditions AM and DRB2   entry 3   
  }                                                                                                                                      
  }                                                                                                                                      

Table 8.1.5.4.1.3.3-4: PDU SESSION ESTABLISHMENT ACCEPT (Preamble)
(Table 8.1.5.4.1.3.2-1)

  Derivation Path: TS 38.508-1, table 4.7.2-2                                                                                                
  --------------------------------------------- ---------------------------------------------------------------------------------- --------- -----------
  Information Element                           Value/remark                                                                       Comment   Condition
  PDU session ID                                The same as the PDU session ID in PDU SESSION ESTABLISHMENT REQUEST                          
  Authorized QoS rules                          3 entries                                                                                    
  QoS rule \[1\]                                Reference QoS rule \#1 as defined in Table 4.8.2.1-1.                              QFI=1     
  QoS rule \[2\]                                Reference QoS rule \#4 as defined in Table 4.8.2.1-4 except DQR bit set to '0'B.   QFI=2     
  QoS rule \[3\]                                Reference QoS rule \#5 as defined in Table 4.8.2.1-5.                              QFI=5     
  Mapped EPS Bearer contexts                    Not Present                                                                                  
  Authorized QoS flow descriptions              3 entries                                                                                    
  QoS flow \[1\]                                Reference QoS flow \#1 as defined in Table8.1.5.4.1.3.3-7.                         QFI=1     
  QoS flow \[2\]                                Reference QoS flow \#2 as defined in Table8.1.5.4.1.3.3-8.                         QFI=2     
  QoS flow \[3\]                                Reference QoS flow \#3 as defined in Table 4.8.2.3-3.                              QFI=5     

Table 8.1.5.4.1.3.3-5: CounterCheck (step 3, Table 8.1.5.4.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-1                                                                                    
  -------------------------------------------------------------------------- ---------------------------------- --------------------- -----------
  Information Element                                                        Value/Remark                       Comment               Condition
  CounterCheck ::= SEQUENCE {                                                                                                         
  criticalExtensions CHOICE {                                                                                                         
  counterCheck SEQUENCE {                                                                                                             
  drb-CountMSB-InfoList SEQUENCE (SIZE (1..maxDRB)) OF DRB-CountMSB-Info {   2 entries                                                
  DRB-CountMSB-Info\[1\] SEQUENCE {                                                                             entry 1               
  drb-Identity                                                               DRB-Identity with Condition DRB1   DRB established       
  countMSB-Uplink                                                            1                                                        
  countMSB-Downlink                                                          1                                                        
  }                                                                                                                                   
  DRB-CountMSB-Info\[2\] SEQUENCE {                                                                             entry 2               
  drb-Identity                                                               DRB-Identity with Condition DRB3   DRB not established   
  countMSB-Uplink                                                            3                                                        
  countMSB-Downlink                                                          3                                                        
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   

Table 8.1.5.4.1.3.3-6: CounterCheckResponse (step 4, Table
8.1.5.4.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-2                                                                                          
  ------------------------------------------------------------------ ---------------------------------- ----------------------------------- -----------
  Information Element                                                Value/Remark                       Comment                             Condition
  CounterCheckResponse ::= SEQUENCE {                                                                                                       
  criticalExtensions CHOICE {                                                                                                               
  counterCheckResponse SEQUENCE {                                                                                                           
  drb-CountInfoList SEQUENCE (SIZE (0..maxDRB)) OF DRB-CountInfo {   3 entries                                                              
  DRB-CountInfo\[1\] SEQUENCE {                                                                         entry 1                             
  drb-Identity                                                       DRB-Identity with Condition DRB1   DRB established                     
  count-Uplink                                                       9                                                                      
  count-Downlink                                                     9                                                                      
  }                                                                                                                                         
  DRB-CountInfo\[2\] SEQUENCE {                                                                         entry 2                             
  drb-Identity                                                       DRB-Identity with Condition DRB2   DRB established but not requested   
  count-Uplink                                                       9                                                                      
  count-Downlink                                                     9                                                                      
  }                                                                                                                                         
  DRB-CountInfo\[3\] SEQUENCE {                                                                         entry 3                             
  drb-Identity                                                       DRB-Identity with Condition DRB3   DRB not established                 
  count-Uplink\]                                                     384                                MSB 3 and LSB 0                     
  count-Downlink                                                     384                                MSB 3 and LSB 0                     
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         

Table 8.1.5.4.1.3.3-7: Reference QoS flow \#1 (Preamble)

  Derivation Path: TS 38.508-1, table 4.8.2.3-1                                                    
  ----------------------------------------------- -------------- --------------------------------- -----------
  Information Element                             Value/remark   Comment                           Condition
  QoS flow descriptions                                                                            
  QFI                                             '00 0001'B     QFI 1                             
  Operation code                                  '001'B         Create new QoS flow description   
  E bit                                           '1'B           Parameters list is included       
  Number of parameters                            '00 0001'B     1 parameter                       
  5QI                                             '0000 1001'B   5QI 9                             

Table 8.1.5.4.1.3.3-8: Reference QoS flow \#2 (Preamble)

  Derivation Path: TS 38.508-1, table 4.8.2.3-2                                                    
  ----------------------------------------------- -------------- --------------------------------- -----------
  Information Element                             Value/remark   Comment                           Condition
  QoS flow descriptions                                                                            
  QoS flow description                                                                             
  QFI                                             '00 0010'B     QFI 2                             
  Operation code                                  '001'B         Create new QoS flow description   
  E bit                                           '1'B           Parameters list is included       
  Number of parameters                            '00 0001'B     1 parameter                       
  5QI                                             '0000 0101'B   5QI 5                             

#### 8.1.5.5 Redirection to NR

##### 8.1.5.5.1 Redirection to NR / From E-UTRA / Success

##### 8.1.5.5.1.1 Test Purpose (TP) {#test-purpose-tp-8 .H6}

##### (1) {#section-14 .H6}

**with** { UE in E-UTRA RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCConnectionRelease message including a
redirectedCarrierInfo for redirection to an NR cell }

**then** { UE enters E-UTRA RRC\_IDLE state and performs redirection to
NR cell }

}

##### 8.1.5.5.1.2 Conformance requirements {#conformance-requirements-8 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 36.331 clause 5.3.8.3. Unless otherwise stated these
are Rel-15 requirements.

\[TS 36.331, clause 5.3.8.3\]

The UE shall:

1\> except for NB-IoT, BL UEs or UEs in CE, delay the following actions
defined in this sub-clause 60 ms from the moment the
*RRCConnectionRelease* message was received or optionally when lower
layers indicate that the receipt of the *RRCConnectionRelease* message
has been successfully acknowledged, whichever is earlier;

1\> for BL UEs or UEs in CE, delay the following actions defined in this
sub-clause 1.25 seconds from the moment the *RRCConnectionRelease*
message was received or optionally when lower layers indicate that the
receipt of the *RRCConnectionRelease* message has been successfully
acknowledged, whichever is earlier;

1\> for NB-IoT, delay the following actions defined in this sub-clause
10 seconds from the moment the *RRCConnectionRelease* message was
received or optionally when lower layers indicate that the receipt of
the *RRCConnectionRelease* message has been successfully acknowledged,
whichever is earlier.

NOTE: For BL UEs, UEs in CE and NB-IoT, when STATUS reporting, as
defined in TS 36.322 \[7\], has not been triggered and the UE has sent
positive HARQ feedback (ACK), as defined in TS 36.321 \[6\], the lower
layers can be considered to have indicated that the receipt of the
*RRCConnectionRelease* message has been successfully acknowledged.

1\> stop T380, if running;

1\> if T309 is running:

2\> stop timer T309 for all access categories;

2\> perform the actions as specified in 5.3.16.4.

1\> if the *RRCConnectionRelease* message is received in response to an
*RRCConnectionResumeRequest* for EDT:

2\> indicate to upper layers that the suspended RRC connection has been
resumed;

2\> discard the stored UE AS context and *resumeIdentity*;

2\> stop timer T300;

2\> stop timer T302, if running;

2\> stop timer T303, if running;

2\> stop timer T305, if running;

2\> stop timer T306, if running;

2\> stop timer T308, if running;

2\> perform the actions as specified in 5.3.3.7;

2\> stop timer T320, if running;

2\> stop timer T322, if running;

1\> if the security is not activated and if UE is connected to 5GC:

2\> perform the actions upon leaving RRC\_CONNECTED or RRC\_INACTIVE as
specified in 5.3.12 with the release cause \'*other\'* upon which the
procedure ends;

1\> if the *RRCConnectionRelease* message includes
*redirectedCarrierInfo* indicating redirection to *geran*; or

1\> if the *RRCConnectionRelease* message includes
*idleModeMobilityControlInfo* including *freqPriorityListGERAN*:

2\> if AS security has not been activated; and

2\> if upper layers indicate that redirect to GERAN without AS security
is not allowed:

3\> ignore the content of the *RRCConnectionRelease*;

3\> perform the actions upon leaving RRC\_CONNECTED or RRC\_INACTIVE as
specified in 5.3.12, with release cause \'other\', upon which the
procedure ends;

1\> if AS security has not been activated:

2\> ignore the content of *redirectedCarrierInfo*, if included and
indicating redirection to *nr*;

2\> ignore the content of *idleModeMobilityControlInfo*, if included and
including *freqPriorityListNR*;

2\> if the UE ignores the content of *redirectedCarrierInfo* or of
*idleModeMobilityControlInfo*:

3\> perform the actions upon leaving RRC\_CONNECTED as specified in
5.3.12, with release cause \'other\', upon which the procedure ends;

1\> if the *RRCConnectionRelease* message includes
*redirectedCarrierInfo* indicating redirection to *eutra* and if UE is
connected to 5GC:

2\> if *cn-Type* is included:

3\> after the cell selection, indicate the available CN Type(s) and the
received *cn-Type* to upper layers;

NOTE 1: Handling the case if the E-UTRA cell selected after the
redirection does not support the core network type specified by the
*cn-Type,* is up to UE implementation.

1\> if the *RRCConnectionRelease* message includes the
*idleModeMobilityControlInfo*:

2\> store the cell reselection priority information provided by the
*idleModeMobilityControlInfo*;

2\> if the *t320* is included:

3\> start timer T320, with the timer value set according to the value of
*t320*;

1\> else:

2\> apply the cell reselection priority information broadcast in the
system information;

1\> if the *RRCConnectionRelease* message includes the *measIdleConfig*:

2\> clear *VarMeasIdleConfig* and *VarMeasIdleReport*;

2\> store the received *measIdleDuration* in *VarMeasIdleConfig*;

2\> start T331 with the value of *measIdleDuration*;

2\> if the *measIdleConfig* contains *measIdleCarrierListEUTRA*:

3\> store the received *measIdleCarrierListEUTRA* in
*VarMeasIdleConfig*;

3\> start performing idle mode measurements as specified in 5.6.20;

NOTE 2: If the *measIdleConfig* does not contain
*measIdleCarrierListEUTRA*, UE may receive *measIdleCarrierListEUTRA* as
specified in 5.2.2.12.

1\> for NB-IoT, if the *RRCConnectionRelease* message includes the
*redirectedCarrierInfo*:

2\> if the *redirectedCarrierOffsetDedicated is* included in the
*redirectedCarrierInfo*:

3\> store the dedicated offset for the frequency in
*redirectedCarrierInfo*;

3\> start timer T322, with the timer value set according to the value of
*T322* in *redirectedCarrierInfo*;

1\> if the *releaseCause* received in the *RRCConnectionRelease* message
indicates *loadBalancingTAURequired*:

2\> perform the actions upon leaving RRC\_CONNECTED as specified in
5.3.12, with release cause \'load balancing TAU required\';

1\> else if the *releaseCause* received in the *RRCConnectionRelease*
message indicates *cs-FallbackHighPriority*:

2\> perform the actions upon leaving RRC\_CONNECTED as specified in
5.3.12, with release cause \'CS Fallback High Priority\';

1\> else:

2\> if the *waitTime* is present:

3\> start timer T302, with the timer value set according to the
*waitTime*;

3\> inform the upper layer that access barring is applicable for all
access categories except categories \'0\' and \'2\';

2\> if the *extendedWaitTime* is present; and

2\> if the UE supports delay tolerant access or the UE is a NB-IoT UE:

3\> forward the *extendedWaitTime* to upper layers;

2\> if the *extendedWaitTime-CPdata* is present and the NB-IoT UE only
supports the Control Plane CIoT EPS optimisation:

3\> forward the *extendedWaitTime-CPdata* to upper layers;

2\> if the *releaseCause* received in the *RRCConnectionRelease* message
indicates *rrc-Suspend*:

3\> perform the actions upon leaving RRC\_CONNECTED as specified in
5.3.12, with release cause \'RRC suspension\';

2\> else if *rrc-InactiveConfig* is included:

3\> perform the actions upon entering RRC\_INACTIVE as specified in
5.3.8.7;

2\> else:

> 3\> perform the actions upon leaving RRC\_CONNECTED or RRC\_INACTIVE
> as specified in 5.3.12, with release cause \'other\';

##### 8.1.5.5.1.3 Test Description {#test-description-8 .H6}

##### 8.1.5.5.1.3.1 Pre-test conditions {#pre-test-conditions-8 .H6}

##### System Simulator: {#system-simulator-8 .H6}

\- E-UTRA Cell 1 is the serving cell and NR Cell 1 is the suitable
neighbour cell.

\- System information combination 31 as defined in TS 36.508 \[7\]
clause 4.4.3.1 is used in the E-UTRA cell.

\- System information combination NR-6 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in the NR cell.

##### UE: {#ue-8 .H6}

\- In E-UTRA RRC\_CONNECTED state using generic procedure parameters
Connectivity (E-UTRA/EPC) and Unrestricted nr PDN (*On*)in accordance
with the procedure described in TS 38.508-1 \[4\], clause 4.5.4.

##### Preamble: {#preamble-6 .H6}

\- With NR Cell 1 \"Serving cell\" and E-UTRA Cell 1 \"Non-suitable
\"Off\" cell\", the UE is brought to state 1N-A, RRC\_IDLE Connectivity
(NR), in accordance with the procedure described in TS 38.508-1 \[4\],
Table 4.5.2.2-2. 5G-GUTI and ngKSI are assigned and security context
established.

\- the UE is switched-off

\- With E-UTRA Cell 1 and NR Cell 1 power levels set according to T0,
the UE is brought to state Generic RB Established (state 3) according to
TS 36.508 \[7\] clause 4.5.3. 4G GUTI and eKSI are assigned and security
context established

##### 8.1.5.5.1.3.2 Test procedure sequence {#test-procedure-sequence-8 .H6}

Tables 8.1.5.5.1.3.2-0/ 8.1.5.5.1.3.2-0A illustrates the downlink power
levels to be applied for NR Cell 1, E-UTRA Cell 1 for the test
execution.

Table 8.1.5.5.1.3.2-0: Time instances of cell power level and parameter
changes for FR1

+----+-----------------------+-----------+-----------+---------------+--------+
|    | Parameter             | Unit      | NR Cell 1 | E-UTRA Cell 1 | Remark |
+====+=======================+===========+===========+===============+========+
| T0 | Cell-specific RS EPRE | dBm/15kHz |           | -85           |        |
+----+-----------------------+-----------+-----------+---------------+--------+
|    | SS/PBCH               | dBm/SCS   | "Off"     | \-            |        |
|    |                       |           |           |               |        |
|    | SSS EPRE              |           |           |               |        |
+----+-----------------------+-----------+-----------+---------------+--------+
| T1 | Cell-specific RS EPRE | dBm/15kHz |           | -85           |        |
+----+-----------------------+-----------+-----------+---------------+--------+
|    | SS/PBCH               | dBm/SCS   | -91       | \-            |        |
|    |                       |           |           |               |        |
|    | SSS EPRE              |           |           |               |        |
+----+-----------------------+-----------+-----------+---------------+--------+

Table 8.1.5.5.1.3.2-0A: Time instances of cell power level and parameter
changes for FR2

+----+-----------------------+-----------+-----------+---------------+--------+
|    | Parameter             | Unit      | NR Cell 1 | E-UTRA Cell 1 | Remark |
+====+=======================+===========+===========+===============+========+
| T0 | Cell-specific RS EPRE | dBm/15kHz |           | -85           |        |
+----+-----------------------+-----------+-----------+---------------+--------+
|    | SS/PBCH               | dBm/SCS   | "Off"     | \-            |        |
|    |                       |           |           |               |        |
|    | SSS EPRE              |           |           |               |        |
+----+-----------------------+-----------+-----------+---------------+--------+
| T1 | Cell-specific RS EPRE | dBm/15kHz |           | -96           |        |
+----+-----------------------+-----------+-----------+---------------+--------+
|    | SS/PBCH               | dBm/SCS   | -91       | \-            |        |
|    |                       |           |           |               |        |
|    | SSS EPRE              |           |           |               |        |
+----+-----------------------+-----------+-----------+---------------+--------+

Table 8.1.5.5.1.3.2-1: Main behaviour

  St       Procedure                                                                                                                                                                            Message Sequence   TP                                   Verdict   
  -------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ ------------------------------------ --------- ----
                                                                                                                                                                                                U - S              Message                                        
  0        The SS changes Cell parameters according to the row "T1" in table 8.1.5.5.1.3.2-0/0A.                                                                                                \-                 \-                                   \-        \-
  1        The SS transmits an *RRCConnectionRelease* message indicating redirection to NR Cell 1.                                                                                              \-                 E-UTRA RRC: *RRCConnectionRelease*   \-        \-
  2-14a1   Check: Does the test result of generic test procedure in TS 38.508-1 subclause 4.9.9 indicate that the UE has performed mobility registration updating when it camps on NR Cell 1?   \-                 \-                                   1         P

##### 8.1.5.5.1.3.3 Specific message contents {#specific-message-contents-8 .H6}

Table 8.1.5.5.1.3.3-1: RRCConnectionRelease (step 1, Table
8.1.5.5.1.3.2-1)

  ------------------------------------------- -------------------- --------- -----------
  Derivation Path: TS 36.508 table 4.6.1-15                                  
  Information Element                         Value/remark         Comment   Condition
  RRCConnectionRelease ::= SEQUENCE {                                        
  criticalExtensions CHOICE {                                                
  c1 CHOICE {                                                                
  rrcConnectionRelease-r8 SEQUENCE {                                         
  redirectedCarrierInfo CHOICE {                                             
  nr-r15 SEQUENCE {                                                          
  carrierFreq-r15                             ARFCN of NR Cell 1             
  subcarrierSpacingSSB-r15                    kHz15                          FR1\_FDD
                                              kHz30                          FR1\_TDD
                                              kHz120                         FR2\_TDD
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  ------------------------------------------- -------------------- --------- -----------

##### 8.1.5.5.2 Redirection to NR / From E-UTRA / MPS Priority Indication / Success

##### 8.1.5.5.2.1 Test Purpose (TP) {#test-purpose-tp-9 .H6}

##### (1) {#section-15 .H6}

**with** { UE in E-UTRA RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCConnectionRelease message including MPS
priority indication and a redirectedCarrierInfo for redirection to an NR
cell }

**then** { UE enters E-UTRA RRC\_IDLE state and performs redirection to
NR cell }

}

##### 8.1.5.5.2.2 Conformance requirements {#conformance-requirements-9 .H6}

References: The conformance requirements covered in the current TC are
specified in TS 36.331 clause 5.3.3.3, TS 38.331 clause 5.3.8.3, and TS
38.304 clause 5.2.6. Unless otherwise stated these are Rel-16
requirements.

\[TS 36.331, clause 5.3.3.3\]

The UE shall set the contents of *RRCConnectionRequest* message as
follows:

1\> if the UE is connected to EPC:

2\> set the *ue-Identity* as follows:

3\> if upper layers provide an S-TMSI:

4\> set the *ue-Identity* to the value received from upper layers;

3\> else:

4\> draw a random value in the range 0 .. 2^40^-1 and set the
*ue-Identity* to this value;

NOTE 1: Upper layers provide the S-TMSI if the UE is registered in the
TA of the current cell.

2\> if the establishment of the RRC connection is the result of release
with redirect with *mpsPriorityIndication* (either in NR or E-UTRAN):

3\> set the establishmentCause to *highPriorityAccess*;

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> delay the following actions defined in this clause 60ms from the
moment the *RRCRelease* message was received or optionally when lower
layers indicate that the receipt of the *RRCRelease* message has been
successfully acknowledged, whichever is earlier;

1\> stop timer T320, if running;

1\> if the *RRCRelease* message includes *redirectedCarrierInfo*
indicating redirection to *eutra*:

2\> if *cnType* is included:

3\> after the cell selection, indicate the available CN Type(s) and the
received *cnType* to upper layers;

NOTE: Handling the case if the E-UTRA cell selected after the
redirection does not support the core network type specified by the
*cnType,* is up to UE implementation.

\[TS 38.304, clause 5.2.6\]

At reception of *RRCRelease* message to transition the UE to RRC\_IDLE
or RRC\_INACTIVE, UE shall attempt to camp on a suitable cell according
to *redirectedCarrierInfo* if included in the *RRCRelease* message used
for this transition. If the UE cannot find a suitable cell, the UE is
allowed to camp on any suitable cell of the indicated RAT. If the
*RRCRelease* message does not contain the *redirectedCarrierInfo,* UE
shall attempt to select a suitable cell on an NR carrier. If no suitable
cell is found according to the above, the UE shall perform cell
selection using stored information in order to find a suitable cell to
camp on.

When returning to RRC\_IDLE state after UE moved to RRC\_CONNECTED state
from *camped on any cell* state, UE shall attempt to camp on an
acceptable cell according to *redirectedCarrierInfo*, if included in the
*RRCRelease* message. If the UE cannot find an acceptable cell, the UE
is allowed to camp on any acceptable cell of the indicated RAT. If the
*RRCRelease* message does not contain *redirectedCarrierInfo* UE shall
attempt to select an acceptable cell on an NR frequency. If no
acceptable cell is found according to the above, the UE shall continue
to search for an acceptable cell of any PLMN in state *any cell
selection*.

##### 8.1.5.5.2.3 Test Description {#test-description-9 .H6}

##### 8.1.5.5.2.3.1 Pre-test conditions {#pre-test-conditions-9 .H6}

##### System Simulator: {#system-simulator-9 .H6}

\- E-UTRA Cell 1 is the serving cell and NR Cell 1 is the suitable
neighbour cell.

\- System information combination 31 as defined in TS 36.508 \[7\]
clause 4.4.3.1 is used in the E-UTRA cell.

\- System information combination NR-6 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in the NR cell.

##### UE: {#ue-9 .H6}

\- In E-UTRA RRC\_CONNECTED state using generic procedure parameters
Connectivity (E-UTRA/EPC) and Unrestricted nr PDN (*On*)in accordance
with the procedure described in TS 38.508-1 \[4\], clause 4.5.4.

##### Preamble: {#preamble-7 .H6}

\- With NR Cell 1 \"Serving cell\" and E-UTRA Cell 1 \"Non-suitable
\"Off\" cell\", the UE is brought to state 1N-A, RRC\_IDLE Connectivity
(NR), in accordance with the procedure described in TS 38.508-1 \[4\],
Table 4.5.2.2-2. 5G-GUTI and ngKSI are assigned and security context
established.

\- the UE is switched-off

\- With E-UTRA Cell 1 and NR Cell 1 power levels set according to T0,
the UE is brought to state Generic RB Established (state 3) according to
TS 36.508 \[7\] clause 4.5.3. 4G GUTI and eKSI are assigned and security
context established

##### 8.1.5.5.2.3.2 Test procedure sequence {#test-procedure-sequence-9 .H6}

Tables 8.1.5.5.2.3.2-1/ 8.1.5.5.2.3.2-2 illustrates the downlink power
levels to be applied for NR Cell 1, E-UTRA Cell 1 for the test
execution.

Table 8.1.5.5.2.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-----------------------+-----------+-----------+---------------+--------+
|    | Parameter             | Unit      | NR Cell 1 | E-UTRA Cell 1 | Remark |
+====+=======================+===========+===========+===============+========+
| T0 | Cell-specific RS EPRE | dBm/15kHz |           | -85           |        |
+----+-----------------------+-----------+-----------+---------------+--------+
|    | SS/PBCH               | dBm/SCS   | "Off"     | \-            |        |
|    |                       |           |           |               |        |
|    | SSS EPRE              |           |           |               |        |
+----+-----------------------+-----------+-----------+---------------+--------+
| T1 | Cell-specific RS EPRE | dBm/15kHz |           | -85           |        |
+----+-----------------------+-----------+-----------+---------------+--------+
|    | SS/PBCH               | dBm/SCS   | -91       | \-            |        |
|    |                       |           |           |               |        |
|    | SSS EPRE              |           |           |               |        |
+----+-----------------------+-----------+-----------+---------------+--------+

Table 8.1.5.5.2.3.2-2: Time instances of cell power level and parameter
changes for FR2

+----+-----------------------+-----------+-----------+---------------+--------+
|    | Parameter             | Unit      | NR Cell 1 | E-UTRA Cell 1 | Remark |
+====+=======================+===========+===========+===============+========+
| T0 | Cell-specific RS EPRE | dBm/15kHz |           | -85           |        |
+----+-----------------------+-----------+-----------+---------------+--------+
|    | SS/PBCH               | dBm/SCS   | "Off"     | \-            |        |
|    |                       |           |           |               |        |
|    | SSS EPRE              |           |           |               |        |
+----+-----------------------+-----------+-----------+---------------+--------+
| T1 | Cell-specific RS EPRE | dBm/15kHz |           | -96           |        |
+----+-----------------------+-----------+-----------+---------------+--------+
|    | SS/PBCH               | dBm/SCS   | -91       | \-            |        |
|    |                       |           |           |               |        |
|    | SSS EPRE              |           |           |               |        |
+----+-----------------------+-----------+-----------+---------------+--------+

Table 8.1.5.5.2.3.2-3: Main behaviour

  St    Procedure                                                                                                               Message Sequence   TP                                   Verdict   
  ----- ----------------------------------------------------------------------------------------------------------------------- ------------------ ------------------------------------ --------- ----
                                                                                                                                U - S              Message                                        
  1     The SS changes Cell parameters according to the row "T1" in table 8.1.5.5.2.3.2-1/2.                                    \-                 \-                                   \-        \-
  2     The SS transmits an *RRCConnectionRelease* message indicating mpsPriorityIndication-r16 and redirection to NR Cell 1.   \<\--              E-UTRA RRC: *RRCConnectionRelease*   \-        \-
  3     Check: Does the UE transmit an RRCSetupRequest Message with establishmentCause to highPriorityAccess.                   \--\>              NR RRC: RRCSetupRequest              1         P
  4-8   Steps 2 to 14b2b1 of the generic test procedure in TS 38.508-1 \[4\] subclause 4.9.9.2.2 are performed on NR Cell 1.    \-                 \-                                   \-        \-

##### 8.1.5.5.2.3.3 Specific message contents {#specific-message-contents-9 .H6}

Table 8.1.5.5.2.3.3-1: RRCConnectionRelease (step 2, Table
8.1.5.5.2.3.2-3)

  ------------------------------------------- -------------------- --------- -----------
  Derivation Path: TS 36.508 table 4.6.1-15                                  
  Information Element                         Value/remark         Comment   Condition
  RRCConnectionRelease ::= SEQUENCE {                                        
  criticalExtensions CHOICE {                                                
  c1 CHOICE {                                                                
  rrcConnectionRelease-r8 SEQUENCE {                                         
  redirectedCarrierInfo CHOICE {                                             
  nr-r15 SEQUENCE {                                                          
  carrierFreq-r15                             ARFCN of NR Cell 1             
  subcarrierSpacingSSB-r15                    kHz15                          FR1\_FDD
                                              kHz30                          FR1\_TDD
                                              kHz120                         FR2\_TDD
  }                                                                          
  }                                                                          
  nonCriticalExtension SEQUENCE {                                            
  nonCriticalExtension SEQUENCE {                                            
  nonCriticalExtension SEQUENCE {                                            
  nonCriticalExtension SEQUENCE {                                            
  nonCriticalExtension SEQUENCE {                                            
  nonCriticalExtension SEQUENCE {                                            
  nonCriticalExtension SEQUENCE {                                            
  nonCriticalExtension SEQUENCE {                                            
  nonCriticalExtension SEQUENCE {                                            
  mpsPriorityIndication-r16                   true                           
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  }                                                                          
  ------------------------------------------- -------------------- --------- -----------

  ----------- -----------------------------
  Condition   Explanation
  FR1\_FDD    FDD frequency range \< 6GHz
  FR1\_TDD    TDD frequency range \< 6GHz
  FR2\_TDD    TDD frequency range \> 6GHz
  ----------- -----------------------------

Table 8.1.5.5.2.3.3-2: *RRCSetupRequest* (step 3, Table 8.1.5.5.2.3.2-3)

  ---------------------------------------------------- ---------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-23                                    
  Information Element                                  Value/remark           Comment   Condition
  RRCSetupRequest ::= SEQUENCE {                                                        
  rrcSetupRequest SEQUENCE {                                                            
  establishmentCause                                   *highPriorityAccess*             
  }                                                                                     
  }                                                                                     
  ---------------------------------------------------- ---------------------- --------- -----------

#### 8.1.5.6 Radio link failure

##### 8.1.5.6.1 Radio link failure / RRC connection re-establishment success

##### 8.1.5.6.1.1 Test Purpose (TP) {#test-purpose-tp-10 .H6}

##### (1) {#section-16 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE detecting physical layer recovery while T310 was running }

**then** { UE resumes the RRC connection without explicit signalling }

}

##### (2) {#section-17 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE detecting physical layer problems }

**then** { UE shall start timer T310 and UE does not initiate any RRC
connection re-establishment procedure before expiring of timer T310 }

}

##### (3) {#section-18 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE detecting radio link failure on expiring of timer T310 }

**then** { UE starts timer T311 and UE initiates the RRC connection
re-establishment procedure }

}

##### (4) {#section-19 .H6}

**with** { UE having initiated RRC connection re-establishment procedure
and timer T311 running }

**ensure that** {

**when** { UE successfully completes the RRC connection re-establishment
procedure }

**then** { UE is in NR RRC\_CONNECTED state }

}

##### (5) {#section-20 .H6}

**with** { UE in NR RRC\_CONNECTED state and upon detecting radio link
failure UE sends RRCReestablishmentRequest message }

**ensure that** {

**when** { UE receives a RRCSetup message }

**then** { UE completes RRC setup procedure by sending RRCSetupComplete
message }

}

##### 8.1.5.6.1.2 Conformance requirements {#conformance-requirements-10 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.3.4, 5.3.7.2, 5.3.7.8, 5.3.10.1,
5.3.10.2 and 5.3.10.3.

\[TS 38.331 clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

1\> if the *RRCSetup* is received in response to an
*RRCReestablishmentRequest*; or

1\> if the *RRCSetup* is received in response to an *RRCResumeRequest*
or *RRCResumeRequest1*:

2\> discard any stored UE Inactive AS context and *suspendConfig*;

2\> discard any current AS security context including the K~RRCenc~ key,
the K~RRCint~ key, the K~UPint~ key and the K~UPenc~ key;

2\> release radio resources for all established RBs except SRB0,
including release of the RLC entities, of the associated PDCP entities
and of SDAP;

2\> release the RRC configuration except for the default L1 parameter
values, default MAC Cell Group configuration and CCCH configuration;

2\> indicate to upper layers fallback of the RRC connection;

2\> stop timer T380, if running;

1\> perform the cell group configuration procedure in accordance with
the received *masterCellGroup* and as specified in 5.3.5.5;

1\> perform the radio bearer configuration procedure in accordance with
the received *radioBearerConfig* and as specified in 5.3.5.6;

1\> if stored, discard the cell reselection priority information
provided by the *cellReselectionPriorities* or inherited from another
RAT;

1\> stop timer T300, T301 or T319 if running;

1\> if T390 is running:

2\> stop timer T390 for all access categories;

2\> perform the actions as specified in 5.3.14.4;

1\> if T302 is running:

2\> stop timer T302;

2\> perform the actions as specified in 5.3.14.4;

1\> stop timer T320, if running;

1\> if the *RRCSetup* is received in response to an *RRCResumeRequest*,
*RRCResumeRequest1* or *RRCSetupRequest*:

2\> enter RRC\_CONNECTED;

2\> stop the cell re-selection procedure;

1\> consider the current cell to be the PCell;

1\> set the content of *RRCSetupComplete* message as follows:

2\> if upper layers provide a 5G-S-TMSI:

3\> if the *RRCSetup* is received in response to an *RRCSetupRequest*:

4\> set the *ng-5G-S-TMSI-Value* to *ng-5G-S-TMSI-Part2*;

3\> else:

4\> set the *ng-5G-S-TMSI-Value* to *ng-5G-S-TMSI*;

2\> set the *selectedPLMN-Identity* to the PLMN selected by upper layers
(TS 24.501 \[23\]) from the PLMN(s) included in the *plmn-IdentityList*
in *SIB1*;

2\> if upper layers provide the \'Registered AMF\':

3\> include and set the *registeredAMF* as follows:

4\> if the PLMN identity of the \'Registered AMF\' is different from the
PLMN selected by the upper layers:

5\> include the *plmnIdentity* in the *registeredAMF* and set it to the
value of the PLMN identity in the \'Registered AMF\' received from upper
layers;

4\> set the *amf-Identifier* to the value received from upper layers;

3\> include and set the *guami-Type* to the value provided by the upper
layers;

2\> if upper layers provide one or more S-NSSAI (see TS 23.003 \[21\]):

3\> include the *s-NSSAI-List* and set the content to the values
provided by the upper layers;

2\> set the *dedicatedNAS-Message* to include the information received
from upper layers;

1\> submit the *RRCSetupComplete* message to lower layers for
transmission, upon which the procedure ends

\[TS 38.331 clause 5.3.7.2\]

The UE initiates the procedure when one of the following conditions is
met:

1\> upon detecting radio link failure of the MCG, in accordance with
5.3.10; or

1\> upon re-configuration with sync failure of the MCG, in accordance
with sub-clause 5.3.5.8.3; or

1\> upon mobility from NR failure, in accordance with sub-clause
5.4.3.5; or

1\> upon integrity check failure indication from lower layers concerning
SRB1 or SRB2, except if the integrity check failure is detected on the
*RRCReestablishment* message; or

1\> upon an RRC connection reconfiguration failure, in accordance with
sub-clause 5.3.5.8.2.

Upon initiation of the procedure, the UE shall:

1\> stop timer T310, if running;

1\> stop timer T304, if running;

1\> start timer T311;

1\> suspend all RBs, except SRB0;

1\> reset MAC;

1\> release the MCG SCell(s), if configured;

1\> release *spCellConfig*;

1\> release *delayBudgetReportingConfig*, if configured, and stop timer
T342, if running;

1\> release *overheatingAssistanceConfig*, if configured, and stop timer
T345, if running;

1\> perform cell selection in accordance with the cell selection process
as specified in TS 38.304 \[20\], clause 5.2.6.

\[TS 38.331 clause 5.3.7.8\]

The UE shall:

1\> perform the RRC connection establishment procedure as specified in
5.3.3.4.

\[TS 38.331 clause 5.3.10.1\]

The UE shall:

1\> upon receiving N310 consecutive \"out-of-sync\" indications for the
SpCell from lower layers while neither T300, T301, T304, T311 nor T319
are running:

2\> start timer T310 for the corresponding SpCell.

\[TS 38.331 clause 5.3.10.2\]

Upon receiving N311 consecutive \"in-sync\" indications for the SpCell
from lower layers while T310 is running, the UE shall:

1\> stop timer T310 for the corresponding SpCell.

NOTE 1: In this case, the UE maintains the RRC connection without
explicit signalling, i.e. the UE maintains the entire radio resource
configuration.

NOTE 2: Periods in time where neither \"in-sync\" nor \"out-of-sync\" is
reported by L1 do not affect the evaluation of the number of consecutive
\"in-sync\" or \"out-of-sync\" indications.

\[TS 38.331 clause 5.3.10.3\]

The UE shall:

1\> upon T310 expiry in PCell; or

1\> upon random access problem indication from MCG MAC while neither
T300, T301, T304, T311 nor T319 are running; or

1\> upon indication from MCG RLC that the maximum number of
retransmissions has been reached:

2\> if the indication is from MCG RLC and CA duplication is configured
and activated, and for the corresponding logical channel
*allowedServingCells* only includes SCell(s):

3\> initiate the failure information procedure as specified in 5.7.5 to
report RLC failure.

2\> else:

3\> consider radio link failure to be detected for the MCG i.e. RLF;

3\> if AS security has not been activated:

4\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'other\';-

3\> else if AS security has been activated but SRB2 and at least one DRB
have not been setup:

4\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\';

3\> else:

4\> initiate the connection re-establishment procedure as specified in
5.3.7.

##### 8.1.5.6.1.3 Test description {#test-description-10 .H6}

##### 8.1.5.6.1.3.1 Pre-test conditions {#pre-test-conditions-10 .H6}

##### System Simulator: {#system-simulator-10 .H6}

> \- 3 NR Cells. NR Cell 1 is the serving cell, NR Cell 2 and NR Cell 4
> are the intra-frequency neighbour cell.

None.

##### Preamble: {#preamble-8 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.5.6.1.3.2 Test procedure sequence {#test-procedure-sequence-10 .H6}

Table 8.1.5.6.1.3.2-1: Time instances of cell power level and parameter
changes for FR1

+-------------+-----------+---------+--------+--------+--------+
|             | Parameter | Unit    | NR     | NR     | NR     |
|             |           |         |        |        |        |
|             |           |         | Cell 1 | Cell 2 | Cell 4 |
+=============+===========+=========+========+========+========+
| T0          | SS/PBCH   | dBm/SCS | "Off"  | "Off"  | "Off"  |
|             |           |         |        |        |        |
|             | SSS EPRE  |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+
| T0A         | SS/PBCH   | dBm/SCS | -88    | "Off"  | "Off"  |
|             |           |         |        |        |        |
|             | SSS EPRE  |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+
| T1          | SS/PBCH   | dBm/SCS | "Off"  | -88    | -94    |
|             |           |         |        |        |        |
|             | SSS EPRE  |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+
| T2          | SS/PBCH   | dBm/SCS | "Off"  | "Off"  | -88    |
|             |           |         |        |        |        |
|             | SSS EPRE  |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+
| Power level |           |         |        |        |        |
| "Off" is    |           |         |        |        |        |
| defined in  |           |         |        |        |        |
| TS 38.508-1 |           |         |        |        |        |
| \[4\] Table |           |         |        |        |        |
| 6.2.2.1-3.  |           |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+

Table 8.1.5.6.1.3.2-2: Time instances of cell power level and parameter
changes for FR2

+-------------+-----------+---------+--------+--------+--------+
|             | Parameter | Unit    | NR     | NR     | NR     |
|             |           |         |        |        |        |
|             |           |         | Cell 1 | Cell 2 | Cell 4 |
+=============+===========+=========+========+========+========+
| T0          | SS/PBCH   | dBm/SCS | "Off"  | "Off"  | "Off"  |
|             |           |         |        |        |        |
|             | SSS EPRE  |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+
| T0A         | SS/PBCH   | dBm/SCS | -82    | "Off"  | "Off"  |
|             |           |         |        |        |        |
|             | SSS EPRE  |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+
| T1          | SS/PBCH   | dBm/SCS | "Off"  | -82    | -91    |
|             |           |         |        |        |        |
|             | SSS EPRE  |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+
| T2          | SS/PBCH   | dBm/SCS | "Off"  | "Off"  | -82    |
|             |           |         |        |        |        |
|             | SSS EPRE  |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+
| Power level |           |         |        |        |        |
| "Off" is    |           |         |        |        |        |
| defined in  |           |         |        |        |        |
| TS 38.508-1 |           |         |        |        |        |
| \[4\] Table |           |         |        |        |        |
| 6.2.2.2-2.  |           |         |        |        |        |
+-------------+-----------+---------+--------+--------+--------+

Table 8.1.5.6.1.3.2-3: Main behaviour

+-----+--------------+--------------+--------------+---------+----+
| St  | Procedure    | Message      | TP           | Verdict |    |
|     |              | Sequence     |              |         |    |
+=====+==============+==============+==============+=========+====+
|     |              | U - S        | Message      |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 0A  | The SS       | \-           | \-           | \-      | \- |
|     | changes NR   |              |              |         |    |
|     | Cell 1       |              |              |         |    |
|     | parameters   |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T0\" in    |              |              |         |    |
|     | table Table  |              |              |         |    |
|     | 8.1.5        |              |              |         |    |
|     | .6.1.3.2-1/2 |              |              |         |    |
|     | to set NR    |              |              |         |    |
|     | Cell 1 to    |              |              |         |    |
|     | Non-suitable |              |              |         |    |
|     | "Off".       |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 0B  | The SS wait  | \-           | \-           | \-      | \- |
|     | for 1,5 s    |              |              |         |    |
|     | (T310 (2s)   |              |              |         |    |
|     | is           |              |              |         |    |
|     | transmitted  |              |              |         |    |
|     | in SIB1).    |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 0C  | The SS       | \-           | \-           | \-      | \- |
|     | changes NR   |              |              |         |    |
|     | Cell 1       |              |              |         |    |
|     | parameters   |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T0A\" in   |              |              |         |    |
|     | table        |              |              |         |    |
|     | 8.1.5        |              |              |         |    |
|     | .6.1.3.2-1/2 |              |              |         |    |
|     | making NR    |              |              |         |    |
|     | Cell 1       |              |              |         |    |
|     | serving      |              |              |         |    |
|     | cell.        |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 0D  | Check: For   | \-           | \-           | 1       | F  |
|     | the next 5 s |              |              |         |    |
|     | does the UE  |              |              |         |    |
|     | transmit any |              |              |         |    |
|     | signalling   |              |              |         |    |
|     | message?     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 0E  | Check: Does  | \-           | \-           | 1       | P  |
|     | the test     |              |              |         |    |
|     | result of    |              |              |         |    |
|     | generic test |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | \[4\]        |              |              |         |    |
|     | subclause    |              |              |         |    |
|     | 4.9.10       |              |              |         |    |
|     | indicate     |              |              |         |    |
|     | that the UE  |              |              |         |    |
|     | is in NR     |              |              |         |    |
|     | RR           |              |              |         |    |
|     | C\_CONNECTED |              |              |         |    |
|     | state on NR  |              |              |         |    |
|     | Cell 1?      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1   | The SS       | \-           | \-           | \-      | \- |
|     | changes NR   |              |              |         |    |
|     | Cell 1, NR   |              |              |         |    |
|     | Cell 2 and   |              |              |         |    |
|     | NR Cell 4    |              |              |         |    |
|     | parameters   |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T1\" in    |              |              |         |    |
|     | table        |              |              |         |    |
|     | 8.1.5        |              |              |         |    |
|     | .6.1.3.2-1/2 |              |              |         |    |
|     | in order     |              |              |         |    |
|     | that the     |              |              |         |    |
|     | radio link   |              |              |         |    |
|     | quality of   |              |              |         |    |
|     | NR Cell 1 is |              |              |         |    |
|     | degraded,    |              |              |         |    |
|     | and NR Cell  |              |              |         |    |
|     | 2 is         |              |              |         |    |
|     | suitable for |              |              |         |    |
|     | camping.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2   | Check: Does  | \-           | \-           | 2       | F  |
|     | the UE       |              |              |         |    |
|     | initiate an  |              |              |         |    |
|     | RRC          |              |              |         |    |
|     | connection   |              |              |         |    |
|     | re-e         |              |              |         |    |
|     | stablishment |              |              |         |    |
|     | procedure on |              |              |         |    |
|     | Cell 1 or    |              |              |         |    |
|     | Cell 2. This |              |              |         |    |
|     | is checked   |              |              |         |    |
|     | during the   |              |              |         |    |
|     | time T=T310? |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 3   | Check: Does  | \--\>        | *NR RRC:     | 3       | P  |
|     | the UE send  |              | RR           |         |    |
|     | *RR          |              | CReestablish |         |    |
|     | CReestablish |              | mentRequest* |         |    |
|     | mentRequest* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 2?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 4   | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits    |              | RRCRees      |         |    |
|     | *RRCRees     |              | tablishment* |         |    |
|     | tablishment* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 5   | The UE       | \--\>        | *NR RRC:*    | \-      | \- |
|     | transmits    |              |              |         |    |
|     | *RRC         |              | *RRC         |         |    |
|     | Reestablishm |              | Reestablishm |         |    |
|     | entComplete* |              | entComplete* |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6   | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCReco      |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message to   |              |              |         |    |
|     | resume       |              |              |         |    |
|     | existing     |              |              |         |    |
|     | radio        |              |              |         |    |
|     | bearer.      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 7   | Check: Does  | \--\>        | *NR RRC:     | 4       | P  |
|     | the UE       |              | RRCR         |         |    |
|     | transmit an  |              | econfigurati |         |    |
|     | *RRC         |              | ontComplete* |         |    |
|     | Reconfigurat |              |              |         |    |
|     | ionComplete* |              |              |         |    |
|     | message?     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 8   | The SS       | \-           | \-           | \-      | \- |
|     | changes NR   |              |              |         |    |
|     | Cell 2 and   |              |              |         |    |
|     | NR Cell 4    |              |              |         |    |
|     | parameters   |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T2\" in    |              |              |         |    |
|     | table        |              |              |         |    |
|     | 8.1.5        |              |              |         |    |
|     | .6.1.3.2-1/2 |              |              |         |    |
|     | in order     |              |              |         |    |
|     | that the     |              |              |         |    |
|     | radio link   |              |              |         |    |
|     | quality of   |              |              |         |    |
|     | NR Cell 2 is |              |              |         |    |
|     | degraded and |              |              |         |    |
|     | cell 4 is    |              |              |         |    |
|     | suitable for |              |              |         |    |
|     | camping.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 9   | Check: Does  | \--\>        | *NR RRC:     | \-      | \- |
|     | the UE send  |              | RR           |         |    |
|     | *RR          |              | CReestablish |         |    |
|     | CReestablish |              | mentRequest* |         |    |
|     | mentRequest* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 4?   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 10  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits    |              | RRCSetup*    |         |    |
|     | *RRCSetup*   |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11  | Check: Does  | \--\>        | *NR RRC:     | 5       | P  |
|     | the UE       |              | RRCSe        |         |    |
|     | transmit a   |              | tupComplete* |         |    |
|     | *RRCSe       |              |              |         |    |
|     | tupComplete* |              | *5GMM:       |         |    |
|     | message and  |              | REGISTRATION |         |    |
|     | a            |              | REQUEST*     |         |    |
|     | REGISTRATION |              |              |         |    |
|     | REQUEST      |              |              |         |    |
|     | message      |              |              |         |    |
|     | indicating   |              |              |         |    |
|     | \"mobility   |              |              |         |    |
|     | registration |              |              |         |    |
|     | updating\"?  |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11A | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *DLInformat  |         |    |
|     | *DLInformat  |              | ionTransfer* |         |    |
|     | ionTransfer* |              |              |         |    |
|     | message and  |              | NAS:         |         |    |
|     | an           |              | AU           |         |    |
|     | AU           |              | THENTICATION |         |    |
|     | THENTICATION |              | REQUEST      |         |    |
|     | REQUEST      |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11B | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits an |              | *ULInformat  |         |    |
|     | *ULInformat  |              | ionTransfer* |         |    |
|     | ionTransfer* |              |              |         |    |
|     | message and  |              | 5GMM:        |         |    |
|     | an           |              | AU           |         |    |
|     | AU           |              | THENTICATION |         |    |
|     | THENTICATION |              | RESPONSE     |         |    |
|     | RESPONSE     |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11C | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *DLInformat  |         |    |
|     | NAS SECURITY |              | ionTransfer* |         |    |
|     | MODE COMMAND |              |              |         |    |
|     | message to   |              | 5            |         |    |
|     | activate NAS |              | GMM:SECURITY |         |    |
|     | security.    |              | MODE COMMAND |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11D | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *ULInformat  |         |    |
|     | NAS SECURITY |              | ionTransfer* |         |    |
|     | MODE         |              |              |         |    |
|     | COMPLETE     |              | 5            |         |    |
|     | message and  |              | GMM:SECURITY |         |    |
|     | establishes  |              | MODE         |         |    |
|     | the initial  |              | COMPLETE     |         |    |
|     | security     |              |              |         |    |
|     | co           |              |              |         |    |
|     | nfiguration. |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 12  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *Security    |         |    |
|     | *Security    |              | ModeCommand* |         |    |
|     | ModeCommand* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 13  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *SecurityM   |         |    |
|     | *SecurityM   |              | odeComplete* |         |    |
|     | odeComplete* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 14  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCReco      |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message to   |              | 5GMM:        |         |    |
|     | establish    |              | REGISTRATION |         |    |
|     | SRB2 and DRB |              | ACCEPT       |         |    |
|     | and a        |              |              |         |    |
|     | REGISTRATION |              |              |         |    |
|     | ACCEPT       |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| \-  | EXCEPTION:   | \-           | *-*          | \-      | \- |
|     | Depending    |              |              |         |    |
|     | upon UE      |              |              |         |    |
|     | imp          |              |              |         |    |
|     | lementation, |              |              |         |    |
|     | steps 15 and |              |              |         |    |
|     | 16 can occur |              |              |         |    |
|     | in any order |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 15  | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCR         |         |    |
|     | *RRCR        |              | econfigurati |         |    |
|     | econfigurati |              | ontComplete* |         |    |
|     | ontComplete* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 16  | The UE sends | \--\>        | NR RRC:      | \-      | \- |
|     | a            |              | *ULInformat  |         |    |
|     | REGISTRATION |              | ionTransfer* |         |    |
|     | COMPLETE.    |              |              |         |    |
|     |              |              | 5GMM:        |         |    |
|     |              |              | REGISTRATION |         |    |
|     |              |              | COMPLETE     |         |    |
+-----+--------------+--------------+--------------+---------+----+

##### 8.1.5.6.1.3.3 Specific message contents {#specific-message-contents-10 .H6}

Table 8.1.5.6.1.3.3-0: *SIB1* for Cell 1 (all steps)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/Remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                          
  ue-TimersAndConstants SEQUENCE {                                             
  t310                                                ms2000                   
  }                                                                            
  }                                                                            

Table 8.1.5.6.1.3.3-0A: *RLF-TimersAndConstants*(preamble)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-150                            
  Information Element                                  Value/remark   Comment   Condition
  RLF-TimersAndConstants ::= SEQUENCE {                                         
  t310                                                 ms2000                   
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.5.6.1.3.3-0B: RRCSetup (preamble)

  ---------------------------------------------------- ------------------------------------------------------------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-21                                                                                                      
  Information Element                                  Value/remark                                                              Comment                  Condition
  RRCSetup ::= SEQUENCE {                                                                                                                                 
  criticalExtensions CHOICE {                                                                                                                             
  rrcSetup SEQUENCE {                                                                                                                                     
  masterCellGroup SEQUENCE {                                                                                                                              
  spCellConfig SEQUENCE {                                                                                                                                 
  rlf-TimersAndConstants CHOICE {                                                                                                                         
  setup                                                RLF-TimersAndConstants                                                    Table 8.1.5.6.1.3.3-0A   
  }                                                                                                                                                       
  spCellConfigDedicated SEQUENCE {                                                                                                                        
  initialDownlinkBWP SEQUENCE {                                                                                                                           
  radioLinkMonitoringConfig CHOICE {                                                                                                                      
  setup                                                RadioLinkMonitoringConfig specified in TS 38.508-1\[4\] Table 4.6.3-133                            
  }                                                                                                                                                       
  }                                                                                                                                                       
  }                                                                                                                                                       
  }                                                                                                                                                       
  }                                                                                                                                                       
  }                                                                                                                                                       
  }                                                                                                                                                       
  }                                                                                                                                                       
  ---------------------------------------------------- ------------------------------------------------------------------------- ------------------------ -----------

Table 8.1.5.6.1.3.3-1: *RRCReestablishmentRequest* (step 3, Table
8.1.5.6.1.3.2-3)

  --------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-12                                                                                                    
  Information Element                                 Value/remark                                                                           Comment   Condition
  RRCReestablishmentRequest ::= SEQUENCE {                                                                                                             
  ue-Identity SEQUENCE {                                                                                                                               
  c-RNTI                                              the value of the C-RNTI of the UE                                                                
  physCellId                                          PhysicalCellIdentity of NR Cell 1                                                                
  shortMAC-I                                          The same value as the 16 least significant bits of the XMAC-I value calculated by SS             
  }                                                                                                                                                    
  reestablishmentCause                                otherFailure                                                                                     
  }                                                                                                                                                    
  --------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------

Table 8.1.5.6.1.3.3-1A: RRCReconfiguration (step 6, Table
8.1.5.6.1.3.2-3)

  ------------------------------------------------------------------------ ------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1\[4\], table 4.6.1-13 with condition REEST                                                                                       
  Information Element                                                      Value/remark                                                              Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                                                                
  nonCriticalExtension SEQUENCE {                                                                                                                              
  masterCellGroup SEQUENCE {                                                                                                                                   
  spCellConfig SEQUENCE {                                                                                                                                      
  spCellConfigDedicated SEQUENCE {                                                                                                                             
  initialDownlinkBWP SEQUENCE {                                                                                                                                
  radioLinkMonitoringConfig CHOICE {                                                                                                                           
  setup                                                                    RadioLinkMonitoringConfig specified in TS 38.508-1\[4\] Table 4.6.3-133             
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  }                                                                                                                                                            
  ------------------------------------------------------------------------ ------------------------------------------------------------------------- --------- -----------

Table 8.1.5.6.1.3.3-2: *RRCReestablishmentRequest* (step 9, Table
8.1.5.6.1.3.2-3)

  --------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-12                                                                                                    
  Information Element                                 Value/remark                                                                           Comment   Condition
  RRCReestablishmentRequest ::= SEQUENCE {                                                                                                             
  ue-Identity SEQUENCE {                                                                                                                               
  c-RNTI                                              the value of the C-RNTI of the UE                                                                
  physCellId                                          PhysicalCellIdentity of NR Cell 2                                                                
  shortMAC-I                                          The same value as the 16 least significant bits of the XMAC-I value calculated by SS             
  }                                                                                                                                                    
  reestablishmentCause                                otherFailure                                                                                     
  }                                                                                                                                                    
  --------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------

Table 8.1.5.6.1.3.3-3: RRCReconfiguration (step 14, Table
8.1.5.6.1.3.2-3)

  ---------------------------------------------------------------------
  Derivation Path: TS 38.508-1\[4\], table 4.6.1-13 with condition NR
  ---------------------------------------------------------------------

##### 8.1.5.6.2 Void

##### 8.1.5.6.3 Radio link failure / T311 expiry

##### 8.1.5.6.3.1 Test Purpose (TP) {#test-purpose-tp-11 .H6}

##### (1) {#section-21 .H6}

**with** { UE in NR RRC\_CONNECTED state and radio link failure was
detected and UE attempts to select a suitable NR cell to re-establish
the RRC connection }

**ensure that** {

**when** { UE cannot find a suitable NR cell within T311 }

**then** { UE does not try to re-establish the RRC connection and goes
to NR RRC\_IDLE state after T311 expired }

}

##### 8.1.5.6.3.2 Conformance requirements {#conformance-requirements-11 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331 clauses 5.3.7.2, 5.3.7.6, 5.3.7.8, 5.3.10.1,
5.3.10.3 and 5.3.5.5.7.

\[TS 38.331 clause 5.3.7.2\]

The UE initiates the procedure when one of the following conditions is
met:

1\> upon detecting radio link failure of the MCG, in accordance with
5.3.10; or

1\> upon re-configuration with sync failure of the MCG, in accordance
with sub-clause 5.3.5.8.3; or

1\> upon mobility from NR failure, in accordance with sub-clause
5.4.3.5; or

1\> upon integrity check failure indication from lower layers concerning
SRB1 or SRB2, except if the integrity check failure is detected on the
*RRCReestablishment* message; or

1\> upon an RRC connection reconfiguration failure, in accordance with
sub-clause 5.3.5.8.2.

Upon initiation of the procedure, the UE shall:

1\> stop timer T310, if running;

1\> stop timer T304, if running;

1\> start timer T311;

1\> suspend all RBs, except SRB0;

1\> reset MAC;

1\> release the MCG SCell(s), if configured;

1\> release *spCellConfig*;

1\> release *delayBudgetReportingConfig*, if configured, and stop timer
T342, if running;

1\> release *overheatingAssistanceConfig*, if configured, and stop timer
T345, if running;

1\> perform cell selection in accordance with the cell selection process
as specified in TS 38.304 \[20\], clause 5.2.6.

\[TS 38.331 clause 5.3.7.7\]

Upon T311 expiry, the UE shall:

1\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\'.

\[TS 38.331 clause 5.3.7.8\]

The UE shall:

1\> perform the RRC connection establishment procedure as specified in
5.3.3.4.

\[TS 38.331 clause 5.3.10.1\]

The UE shall:

1\> upon receiving N310 consecutive \"out-of-sync\" indications for the
SpCell from lower layers while neither T300, T301, T304, T311 nor T319
are running:

2\> start timer T310 for the corresponding SpCell.

\[TS 38.331 clause 5.3.10.3\]

The UE shall:

1\> upon T310 expiry in PCell; or

1\> upon random access problem indication from MCG MAC while neither
T300, T301, T304, T311 nor T319 are running; or

1\> upon indication from MCG RLC that the maximum number of
retransmissions has been reached:

2\> if the indication is from MCG RLC and CA duplication is configured
and activated, and for the corresponding logical channel
*allowedServingCells* only includes SCell(s):

3\> initiate the failure information procedure as specified in 5.7.5 to
report RLC failure.

2\> else:

3\> consider radio link failure to be detected for the MCG i.e. RLF;

3\> if AS security has not been activated:

4\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'other\';-

3\> else if AS security has been activated but SRB2 and at least one DRB
have not been setup:

4\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\';

3\> else:

4\> initiate the connection re-establishment procedure as specified in
5.3.7.

\[TS 38.331, 5.3.5.5.7\]

The UE shall:

1\> if the *SpCellConfig* contains the *rlf-TimersAndConstants*:

2\> configure the RLF timers and constants for this cell group as
specified in 5.3.5.5.6;

1\> else if *rlf-TimersAndConstants* is not configured for this cell
group:

2\> use values for timers T301, T310, T311 and constants N310, N311, as
included in *ue-TimersAndConstants* received in *SIB1*;

##### 8.1.5.6.3.3 Test description {#test-description-11 .H6}

##### 8.1.5.6.3.3.1 Pre-test conditions {#pre-test-conditions-11 .H6}

##### System Simulator: {#system-simulator-11 .H6}

> \- NR Cell 1

None.

##### Preamble: {#preamble-9 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.5.6.3.3.2 Test procedure sequence {#test-procedure-sequence-11 .H6}

Table 8.1.5.6.3.3.2-1: Time instances of cell power level and parameter
changes for FR1

+------------------------------------+-----------+---------+--------+
|                                    | Parameter | Unit    | NR     |
|                                    |           |         |        |
|                                    |           |         | Cell 1 |
+====================================+===========+=========+========+
| T1                                 | SS/PBCH   | dBm/SCS | "Off"  |
|                                    |           |         |        |
|                                    | SSS EPRE  |         |        |
+------------------------------------+-----------+---------+--------+
| T2                                 | SS/PBCH   | dBm/SCS | -88    |
|                                    |           |         |        |
|                                    | SSS EPRE  |         |        |
+------------------------------------+-----------+---------+--------+
| Power level "Off" is defined in TS |           |         |        |
| 38.508-1 \[4\] Table 6.2.2.1-3.    |           |         |        |
+------------------------------------+-----------+---------+--------+

Table 8.1.5.6.3.3.2-2: Time instances of cell power level and parameter
changes for FR2

+------------------------------------+-----------+---------+--------+
|                                    | Parameter | Unit    | NR     |
|                                    |           |         |        |
|                                    |           |         | Cell 1 |
+====================================+===========+=========+========+
| T1                                 | SS/PBCH   | dBm/SCS | "Off"  |
|                                    |           |         |        |
|                                    | SSS EPRE  |         |        |
+------------------------------------+-----------+---------+--------+
| T2                                 | SS/PBCH   | dBm/SCS | -82    |
|                                    |           |         |        |
|                                    | SSS EPRE  |         |        |
+------------------------------------+-----------+---------+--------+
| Power level "Off" is defined in TS |           |         |        |
| 38.508-1 \[4\] Table 6.2.2.2-2.    |           |         |        |
+------------------------------------+-----------+---------+--------+

Table 8.1.5.6.3.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                 Message Sequence   TP        Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------- --------- ----
                                                                                                                                                                 U - S              Message             
  1    The SS changes NR Cell 1 parameters according to the row \"T1\" in table 8.1.5.6.3.3.2-1 in order that the radio link quality of NR Cell 1 is degraded.   \-                 \-        \-        \-
  2    Wait for 12s (T311 (10s) is transmitted in RRCSetup).                                                                                                     \-                 *-*       \-        \-
  3    The SS changes NR Cell 1 parameters according to the row \"T2\" in table 8.1.5.6.3.3.2-1 making NR Cell 1 is suitable for camping.                        \-                 *-*       \-        \-
  4    Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.5 indicate that the UE is camped on NR Cell 1?                   \-                 *-*       1         P

##### 8.1.5.6.3.3.3 Specific message contents {#specific-message-contents-11 .H6}

Table 8.1.5.6.3.3.3-1: *RRCSetup(Preamble)*

  --------------------------------------------------- ------------------------------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-21                                                                                     
  Information Element                                 Value/remark                          Comment                                     Condition
  RRCSetup ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                           
  rrcSetup SEQUENCE {                                                                                                                   
  masterCellGroup                                     CellGroupConfig with condition SRB1   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                     
  }                                                                                                                                     
  }                                                                                                                                     
  --------------------------------------------------- ------------------------------------- ------------------------------------------- -----------

Table 8.1.5.6.3.3.3-2: *CellGroupConfig* (Table 8.1.5.6.3.3.3-1)

  ---------------------------------------------------- ------------------- ------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19                                     
  **Information Element**                              **Value/remark**    **Comment**   **Condition**
  CellGroupConfig ::= SEQUENCE {                                                         
  rlf-TimersAndConstants SEQUENCE {                                                      
  t311-v1530                                           ms10000                           
  }                                                                                      
  spCellConfigDedicated                                ServingCellConfig                 
  }                                                                                      
  ---------------------------------------------------- ------------------- ------------- ---------------

Table 8.1.5.6.3.3.3-3: *ServingCellConfig* (Table 8.1.5.6.3.3.3-2:
*CellGroupConfig*)

  ----------------------------------------------------- ----------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-167                                     
  Information Element                                   Value/remark            Comment   Condition
  ServingCellConfig ::= SEQUENCE {                                                        
  initialDownlinkBWP                                    BWP-DownlinkDedicated             
  }                                                                                       
  ----------------------------------------------------- ----------------------- --------- -----------

Table 8.1.5.6.3.3.3-4: *BWP-DownlinkDedicated* (Table 8.1.5.6.3.3.3-3:
*ServingCellConfig*)

  ---------------------------------------------------- --------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-11                                         
  Information Element                                  Value/remark                Comment   Condition
  BWP-DownlinkDedicated ::= SEQUENCE {                                                       
  radioLinkMonitoringConfig                            RadioLinkMonitoringConfig             
  }                                                                                          
  ---------------------------------------------------- --------------------------- --------- -----------

##### 8.1.5.6.4 Void

##### 8.1.5.6.5 NR CA / No Radio Link Failure on SCell / RRC Connection Continues on PCell

###### 8.1.5.6.5.1 NR CA / No Radio Link Failure on SCell / RRC Connection Continues on PCell / Intra-band Contiguous CA

##### 8.1.5.6.5.1.1 Test Purpose (TP) {#test-purpose-tp-12 .H6}

##### (1) {#section-22 .H6}

with { UE in NR RRC\_CONNECTED, security activated and SCell configured
}

ensure that {

when { the SCell becomes out of coverage for the UE }

then { UE does not consider radio link failure to be detected and stay
in NR RRC\_CONNECTED state }

}

##### 8.1.5.6.5.1.2 Conformance requirements {#conformance-requirements-12 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.5.5.6, 5.3.10.1 and 5.3.10.3.
Unless otherwise stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.5.5.6\]

The UE shall:

1\> if the received *rlf-TimersAndConstants* is set to *release*:

2\> use values for timers T301, T310, T311 and constants N310, N311, as
included in *ue-TimersAndConstants* received in *SIB1*;

1\> else:

2\> (re-)configure the value of timers and constants in accordance with
received *rlf-TimersAndConstants*;

2\> stop timer T310 for this cell group, if running;

2\> reset the counters N310 and N311.

\[TS 38.331, clause 5.3.10.1\]

The UE shall:

1\> upon receiving N310 consecutive \"out-of-sync\" indications for the
SpCell from lower layers while neither T300, T301, T304, T311 nor T319
are running:

2\> start timer T310 for the corresponding SpCell.

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

1\> upon T310 expiry in PCell; or

1\> upon random access problem indication from MCG MAC while neither
T300, T301, T304, T311 nor T319 are running; or

1\> upon indication from MCG RLC that the maximum number of
retransmissions has been reached:

2\> if the indication is from MCG RLC and CA duplication is configured
and activated, and for the corresponding logical channel
*allowedServingCells* only includes SCell(s):

3\> initiate the failure information procedure as specified in 5.7.5 to
report RLC failure.

2\> else:

3\> consider radio link failure to be detected for the MCG, i.e. MCG
RLF;

3\> if AS security has not been activated:

4\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'other\';-

3\> else if AS security has been activated but SRB2 and at least one DRB
have not been setup:

4\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\';

3\> else:

4\> initiate the connection re-establishment procedure as specified in
5.3.7.

The UE shall:

1\> upon T310 expiry in PSCell; or

1\> upon random access problem indication from SCG MAC; or

1\> upon indication from SCG RLC that the maximum number of
retransmissions has been reached:

2\> if the indication is from SCG RLC and CA duplication is configured
and activated, and for the corresponding logical channel
*allowedServingCells* only includes SCell(s):

3\> initiate the failure information procedure as specified in 5.7.5 to
report RLC failure.

2\> else:

3\> consider radio link failure to be detected for the SCG, i.e. SCG
RLF;

3\> initiate the SCG failure information procedure as specified in 5.7.3
to report SCG radio link failure.

##### 8.1.5.6.5.1.3 Test description {#test-description-12 .H6}

##### 8.1.5.6.5.1.3.1 Pre-test conditions {#pre-test-conditions-12 .H6}

##### System Simulator: {#system-simulator-12 .H6}

\- NR Cell 1, and NR Cell 3

\- NR Cell 1 is PCell

\- NR Cell 3 is SCell

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-10 .H6}

None.

##### Preamble: {#preamble-10 .H6}

\- The UE is in 5GS state 3N-A with UE test loop mode B active if
pc\_IP\_Ping is set to FALSE according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3 on NR Cell 1.

##### 8.1.5.6.5.1.3.2 Test procedure sequence {#test-procedure-sequence-12 .H6}

Table 8.5.1.7.1.3.2-1 illustrates the downlink power levels and other
changing parameters to be applied for the cells at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions
after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.5.6.5.1.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+--------+--------+--------------------------------------+
|    | Parameter | Unit    | NR     | NR     | Remark                               |
|    |           |         |        |        |                                      |
|    |           |         | Cell 1 | Cell 3 |                                      |
+====+===========+=========+========+========+======================================+
| T0 | SS/PBCH   | dBm/SCS | -88    | -88    | NR Cell1 and NR Cell 3 are available |
|    |           |         |        |        |                                      |
|    | SSS EPRE  |         |        |        |                                      |
+----+-----------+---------+--------+--------+--------------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -88    | "Off"  | Only NR Cell 1 is available.         |
|    |           |         |        |        |                                      |
|    | SSS EPRE  |         |        |        |                                      |
+----+-----------+---------+--------+--------+--------------------------------------+

Table 8.1.5.6.5.1.3.2-1A: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+--------+--------+--------------------------------------+
|    | Parameter | Unit    | NR     | NR     | Remark                               |
|    |           |         |        |        |                                      |
|    |           |         | Cell 1 | Cell 3 |                                      |
+====+===========+=========+========+========+======================================+
| T0 | SS/PBCH   | dBm/SCS | -95    | -95    | NR Cell1 and NR Cell 3 are available |
|    |           |         |        |        |                                      |
|    | SSS EPRE  |         |        |        |                                      |
+----+-----------+---------+--------+--------+--------------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -95    | "Off"  | Only NR Cell 1 is available.         |
|    |           |         |        |        |                                      |
|    | SSS EPRE  |         |        |        |                                      |
+----+-----------+---------+--------+--------+--------------------------------------+

Table 8.1.5.6.5.1.3.2-2: Main behaviour

  St   Procedure                                                                                                                                                  Message Sequence   TP                                                                     Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ---------------------------------------------------------------------- --------- ----
                                                                                                                                                                  U - S              Message                                                                          
  1    The SS transmits an *RRCReconfiguration* message on NR Cell 1 to configure NR Cell 3 as SCell.                                                             \<\--              NR RRC: *RRCReconfiguration*                                           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message on NR Cell 1.                                                                                     \--\>              NR RRC: *RRCReconfigurationComplete*                                   \-        \-
  2A   The SS transmits an Activation MAC control element to activate SCell.                                                                                      \<\--              MAC PDU (SCell Activation/Deactivation MAC CE of one octet (C~1~=1))   \-        \-
  3    Wait for 1s.                                                                                                                                               \-                 \-                                                                     \-        \-
  4    The SS changes power levels according to row \"T1\" in Table 8.1.5.6.5.1.3.2-1/1A.                                                                         \-                 \-                                                                     \-        \-
  5    Wait for 1s.                                                                                                                                               \-                 \-                                                                     \-        \-
  6    Check: Does the UE transmit an *RRCReestablishmentRequest* message on NR Cell 1 within next 2 seconds?                                                     \--\>              NR RRC: *RRCReestablishmentRequest*                                    1         F
  7    The SS changes power levels according to row \"T0\" in Table 8.1.5.6.5.1.3.2-1/1A.                                                                         \-                 *-*                                                                    \-        \-
  8    Check: Does the test result of generic test procedure in TS 38.508-1 subclause 4.9.1 indicate that the UE is capable of exchanging IP data on NR Cell 3?   \-                 *-*                                                                    1         \-
  9    The SS transmits an *RRCReconfiguration* message containing an sCellToReleaseList with SCell NR Cell 3.                                                    \<\--              *NR RRC: RRCReconfiguration*                                           \-        \-
  10   The UE transmits an *RRCReconfigurationComplete* message.                                                                                                  \--\>              *NR RRC: RRCReconfigurationtComplete*                                  \-        \-

##### 8.1.5.6.5.1.3.3 Specific message contents {#specific-message-contents-12 .H6}

Table 8.1.5.6.5.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.5.6.5.1.3.2-2)

  -----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add
  -----------------------------------------------------------------------------

Table 8.1.5.6.5.1.3.3-2: Void

Table 8.1.5.6.5.1.3.3-3: Void

Table 8.1.5.6.5.1.3.3-4: *RRCReconfiguration* (Step 9, *Table*
8.1.5.6.5.1.3.2-2)

  ------------------------------------------------------------------------------ ---------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with Condition SCell\_add                                    
  Information Element                                                            Value/remark           Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                               
  criticalExtensions CHOICE {                                                                                     
  rrcReconfiguration SEQUENCE {                                                                                   
  nonCriticalExtension SEQUENCE {                                                                                 
  masterCellGroup SEQUENCE {                                                                                      
  sCellToAddModList                                                              Not present                      
  sCellToReleaseList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellIndex {          1 entry                          
  SCellIndex\[1\]                                                                SCellIndex of Cell 3   entry 1   
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  ------------------------------------------------------------------------------ ---------------------- --------- -----------

###### 8.1.5.6.5.2 NR CA / No Radio Link Failure on SCell / RRC Connection Continues on PCell / Inter-band CA

##### 8.1.5.6.5.2.1 Test Purpose (TP) {#test-purpose-tp-13 .H6}

Same as TC 8.1.5.6.5.1 but applied to Inter-band CA Test Case.

##### 8.1.5.6.5.2.2 Conformance Requirements {#conformance-requirements-13 .H6}

Same as TC 8.1.5.6.5.1 but applied to Inter-band CA Test Case.

##### 8.1.5.6.5.2.3 Test Description {#test-description-13 .H6}

##### 8.1.5.6.5.2.3.1 Pre-test conditions {#pre-test-conditions-13 .H6}

Same as TC 8.1.5.6.5.1 but with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: Cell 10 replaces Cell 3.

\- Cell 10 is an Inactive SCell according to TS 38.508-1 \[4\] clause
6.3.1.

##### 8.1.5.6.5.2.3.2 Test procedure sequence {#test-procedure-sequence-13 .H6}

Same as TC 8.1.5.6.5.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: Cell 10 replaces Cell 3.

##### 8.1.5.6.5.2.3.3 Specific message contents {#specific-message-contents-13 .H6}

Same as TC 8.1.5.6.5.1 but applied to Inter-band CA Test Case.

###### 8.1.5.6.5.3 NR CA / No Radio Link Failure on SCell / RRC Connection Continues on PCell / Intra-band non-Contiguous CA

##### 8.1.5.6.5.3.1 Test Purpose (TP) {#test-purpose-tp-14 .H6}

Same as TC 8.1.5.6.5.1 but applied to Intra-band non-Contiguous CA Test
Case.

##### 8.1.5.6.5.3.2 Conformance Requirements {#conformance-requirements-14 .H6}

Same as TC 8.1.5.6.5.1 but applied to Intra-band non-Contiguous CA Test
Case.

##### 8.1.5.6.5.3.3 Test Description {#test-description-14 .H6}

##### 8.1.5.6.5.3.3.1 Pre-test conditions {#pre-test-conditions-14 .H6}

Same as TC 8.1.5.6.5.1 but with the following differences:

> \- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
> Contiguous CA.

##### 8.1.5.6.5.3.3.2 Test procedure sequence {#test-procedure-sequence-14 .H6}

Same as TC 8.1.5.6.5.1 with the following differences:

> \- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
> Contiguous CA.

##### 8.1.5.6.5.3.3.3 Specific message contents {#specific-message-contents-14 .H6}

Same as TC 8.1.5.6.5.1 but applied to Intra-band non-Contiguous CA Test
Case.

##### 8.1.5.6.6 Radio link failure / Shared spectrum / LBT Failure

##### 8.1.5.6.6.1 Radio link failure / LBT Failure {#radio-link-failure-lbt-failure .H6}

##### 8.1.5.6.6.1.1 Test Purpose (TP) {#test-purpose-tp-15 .H6}

##### (1) {#section-23 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure** that {

**when** { a UE detects consistent uplink LBT failures }

**then** { the UE detects radio link failure and performs connection
re-establishment procedure }

}

##### 8.1.5.6.6.1.2 Conformance requirements {#conformance-requirements-15 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.321, clauses 5.21.1, 5.21.2, and TS 38.331, clauses
5.3.7.1, 5.3.7.2, 5.3.10.3 and 5.3.10.4. Unless otherwise stated these
are Rel-16 requirements.

\[TS 38.321, clause 5.21.1\]

The lower layer may perform an LBT procedure, see TS 37.213 \[18\],
according to which a transmission is not performed by lower layers if
the channel is identified as being occupied. When lower layer performs
an LBT procedure before a transmission and the transmission is not
performed, an LBT failure indication is sent to the MAC entity from
lower layers.

\[TS 38.321, clause 5.21.2\]

The MAC entity may be configured by RRC with a consistent LBT failure
recovery procedure. Consistent LBT failure is detected per UL BWP by
counting LBT failure indications, for all UL transmissions, from the
lower layers to the MAC entity.

RRC configures the following parameters in the
*lbt-FailureRecoveryConfig*:

\- *lbt-FailureInstanceMaxCount* for the consistent LBT failure
detection;

\- *lbt-FailureDetectionTimer* for the consistent LBT failure detection;

The following UE variable is used for the consistent LBT failure
detection procedure:

\- *LBT\_COUNTER (per Serving Cell)*: counter for LBT failure indication
which is initially set to 0.

For each activated Serving Cell configured with
*lbt-FailureRecoveryConfig*, the MAC entity shall:

1\> if LBT failure indication has been received from lower layers:

2\> start or restart the *lbt-FailureDetectionTimer*;

2\> increment *LBT\_COUNTER* by 1;

2\> if *LBT\_COUNTER* \>= *lbt-FailureInstanceMaxCount*:

3\> trigger consistent LBT failure for the active UL BWP in this Serving
Cell;

3\> if this Serving Cell is the SpCell:

4\> if consistent LBT failure has been triggered in all UL BWPs
configured with PRACH occasions on same carrier in this Serving Cell:

5\> indicate consistent LBT failure to upper layers.

\[TS 38.331, clause 5.3.7.1\]

The purpose of this procedure is to re-establish the RRC connection. A
UE in RRC\_CONNECTED, for which AS security has been activated with SRB2
and at least one DRB setup or, for IAB, SRB2, may initiate the procedure
in order to continue the RRC connection. The connection re-establishment
succeeds if the network is able to find and verify a valid UE context
or, if the UE context cannot be retrieved, and the network responds with
an RRCSetup according to clause 5.3.3.4.

\[TS 38.331, clause 5.3.7.2\]

The UE initiates the procedure when one of the following conditions is
met:

1\> upon detecting radio link failure of the MCG and *t316* is not
configured, in accordance with 5.3.10; or

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

> ...

1\> else:

...

2\> upon consistent uplink LBT failure indication from MCG MAC while
T304 is not running:

> ...

3\> else:

4\> consider radio link failure to be detected for the MCG, i.e. MCG
RLF;

4\> discard any segments of segmented RRC messages stored according to
5.7.6.3;

> ...

4\> else:

5\> store the radio link failure information in the *VarRLF-Report* as
described in clause 5.3.10.5;

> ...

5\> else:

6\> initiate the connection re-establishment procedure as specified in
clause 5.3.7.

\[TS 38.331, clause 5.3.10.4\]

The UE shall set the *rlf-Cause* in the *VarRLF-Report* as follows:

...

1\> else if the UE declares radio link failure due to consistent uplink
LBT failures:

2\> set the *rlf-Cause* as *lbtFailure*;

##### 8.1.5.6.6.1.3 Test description {#test-description-15 .H6}

##### 8.1.5.6.6.1.3.1 Pre-test conditions {#pre-test-conditions-15 .H6}

System Simulator:

> \- NR Cell 1
>
> \- NR Cell 1 is configured to operate in shared spectrum.

UE:

> \- None.

Preamble:

> \- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
> 4.4A.2 Table 4.4A.2-3 and Test Loop Function (On) with UE test loop
> mode B is established.

##### 8.1.5.6.6.1.3.2 Test procedure sequence {#test-procedure-sequence-15 .H6}

Table 8.1.5.6.6.1.3.2-0 illustrates the downlink power levels and other
changing parameters to be applied for the cells at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions
after preamble.

Table 8.1.5.6.6.1.3.2-0: Cell configuration power level changes over
time for conducted test environment

+----+-----------+---------+-----------+
|    | Parameter | Unit    | NR Cell 1 |
+====+===========+=========+===========+
| T0 | SS/PBCH   | dBm/SCS | -88       |
|    |           |         |           |
|    | SSS EPRE  |         |           |
+----+-----------+---------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -75       |
|    |           |         |           |
|    | SSS EPRE  |         |           |
+----+-----------+---------+-----------+
|    | Noc       | dBm/SCS | -82       |
+----+-----------+---------+-----------+

Table 8.1.5.6.6.1.3.2-1: Main behaviour

  St                                                                                                                                           Procedure                                                                                                                 Message Sequence   TP                                      Verdict   
  -------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                                                                                                                         U - S              Message                                           
  1                                                                                                                                            The SS transmits one IP packet to the UE on the DRB associated with the first PDU session on NR Cell 1.                   \-                 *-*                                     \-        \-
  1A                                                                                                                                           The SS adjusts the SS/PBCH EPRE and Noc levels according to row \"T1\" in table 8.1.5.6.6.1.3.2-0.                        \-                 *-*                                     \-        \-
  2                                                                                                                                            UE detects consistent LBT failures while attempting to loop back the data received at step 1.                             \-                 \-                                      \-        \-
  2A                                                                                                                                           80ms after step 1A, SS adjusts the SS/PBCH EPRE and levels according to row \"T0\" in table 8.1.5.6.6.1.3.2-0. (Note 1)   \-                 \-                                      \-        \-
  3                                                                                                                                            Check: Does the UE send *RRCReestablishmentRequest* message on NR Cell 1?                                                 \--\>              *NR RRC: RRCReestablishmentRequest*     1         P
  4                                                                                                                                            The SS transmits *RRCReestablishment* message.                                                                            \<\--              *NR RRC: RRCReestablishment*            \-        \-
  5                                                                                                                                            The UE transmits an *RRCReestablishmentComplete* message.                                                                 \--\>              *NR RRC: RRCReestablishmentComplete*    \-        \-
  6                                                                                                                                            The SS transmits an *RRCReconfiguration* message to establish SRB2 and DRB.                                               \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  7                                                                                                                                            The UE transmits an *RRCReconfigurationtComplete* message.                                                                \--\>              *NR RRC: RRCReconfigurationtComplete*   \-        \-
  Note 1: 80ms is sufficient for UE to detect consistent uplink LBT failures as IE lbt-FailureDetectionTimer-r16 is set to ms80 in preamble.                                                                                                                                                                                                  

##### 8.1.5.6.6.1.3.3 Specific message contents {#specific-message-contents-15 .H6}

Table 8.1.5.6.6.1.3.3-1: *RRCSetup* (preamble, Table 8.1.5.6.6.1.3.2-1)

  ------------------------------------------------- ----------------- --------- -----------
  Derivation Path: 38.508-1 \[4\], Table 4.6.1-13                               
  Information Element                               Value/remark      Comment   Condition
  RRCSetup ::= SEQUENCE {                                                       
  criticalExtensions CHOICE {                                                   
  rrcSetup SEQUENCE {                                                           
  masterCellGroup                                   CellGroupConfig             
  }                                                                             
  }                                                                             
  }                                                                             
  ------------------------------------------------- ----------------- --------- -----------

Table 8.1.5.6.6.1.3.3-2: CellGroupConfig (Table 8.1.5.6.6.1.3.3-1:
*RRCSetup*)

  ------------------------------------------------- --------------------- --------- -----------
  Derivation Path: 38.508-1 \[4\], Table 4.6.3-19                                   
  Information Element                               Value/remark          Comment   Condition
  cellGroupConfig::= SEQUENCE {                                                     
  cellGroupId                                       0                               
  spCellConfig SEQUENCE {                                                           
  spCellConfigDedicated SEQUENCE {                                                  
  servingCellConfig                                 *ServingCellConfig*             
  }                                                                                 
  }                                                                                 
  }                                                                                 
  ------------------------------------------------- --------------------- --------- -----------

Table 8.1.5.6.6.1.3.3-3: *ServingCellConfig* (Table 8.1.5.6.6.1.3.3-2:
*CellGroupConfig*)

  ----------------------------------------------------- --------------------------------------------------- ------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-167                                                                     
  **Information Element**                               **Value/remark**                                    **Comment**   **Condition**
  ServingCellConfig ::= SEQUENCE {                                                                                        
  uplinkConfig SEQUENCE {                                                                                                 
  initialUplinkBWP                                      BWP-UplinkDedicated with condition SharedSpectrum                 
  }                                                                                                                       
  }                                                                                                                       
  ----------------------------------------------------- --------------------------------------------------- ------------- ---------------

Table 8.1.5.6.6.1.3.3-4: Void

Table 8.1.5.6.6.1.3.3-5: Void

Table 8.1.5.6.6.1.3.3-6: *RRCReestablishmentRequest* (step 3, Table
8.1.5.6.6.1.3.2-1)

  --------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-12                                                                                                    
  Information Element                                 Value/remark                                                                           Comment   Condition
  RRCReestablishmentRequest ::= SEQUENCE {                                                                                                             
  ue-Identity SEQUENCE {                                                                                                                               
  c-RNTI                                              the value of the C-RNTI of the UE                                                                
  physCellId                                          PhysicalCellIdentity of NR Cell 1                                                                
  shortMAC-I                                          The same value as the 16 least significant bits of the XMAC-I value calculated by SS             
  }                                                                                                                                                    
  reestablishmentCause                                otherFailure                                                                                     
  }                                                                                                                                                    
  --------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------

Table 8.1.5.6.6.1.3.3-7: *RRCReconfiguration* (step 6, Table
8.1.5.6.6.1.3.2-1)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition REEST
  ------------------------------------------------------------------------

Table 8.1.5.6.6.1.3.3-8: SIB1 for NR Cell 1 (All steps, Table
8.1.5.6.6.1.3.2-1)

  Derivation path: TS 38.508-1 \[4\] table 4.6.1-28                                                                        
  --------------------------------------------------- ---------------------------------------------------------- --------- -----------
  Information Element                                 Value/remark                                               Comment   Condition
  SIB1 ::= SEQUENCE {                                                                                                      
  servingCellConfigCommon                             ServingCellConfigCommonSIB with condition SharedSpectrum             
  }                                                                                                                        

#### 8.1.5.7 Failure information

##### 8.1.5.7.1 Failure information / RLC failure / MCG

###### 8.1.5.7.1.1 Failure information / RLC failure / MCG / Intra-band Contiguous CA

##### 8.1.5.7.1.1.1 Test Purpose (TP) {#test-purpose-tp-16 .H6}

##### (1) {#section-24 .H6}

**with { UE in NR RRC\_CONNECTED state }**

**ensure that {**

**when { an indication from MCG RLC that the maximum number of
retransmissions has been reached and when CA duplication is configured
and activated and for the corresponding logical channel
allowedServingCells only includes SCell(s) }**

**then { UE initiates the failure information procedure to report RLC
failure via SRB1 }**

**}**

##### 8.1.5.7.1.1.2 Conformance requirements {#conformance-requirements-16 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.7.5.2 and 5.7.5.3. Unless otherwise
stated these are Rel-15 requirements.

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

...

1\> upon indication from MCG RLC that the maximum number of
retransmissions has been reached:

2\> if the indication is from MCG RLC and CA duplication is configured
and activated, and for the corresponding logical channel
*allowedServingCells* only includes SCell(s):

3\> initiate the failure information procedure as specified in 5.7.5 to
report RLC failure.

...

\[TS 38.331, clause 5.7.5.2\]

A UE initiates the procedure when there is a need inform the network
about a failure detected by the UE. In particular, the UE initiates the
procedure when the following condition is met:

1\> upon detecting failure for an RLC bearer, in accordance with
5.3.10.3;

Upon initiating the procedure, the UE shall:

1\> initiate transmission of the *FailureInformation* message as
specified in 5.7.5.3;

\[TS 38.331, clause 5.7.5.3\]

The UE shall:

1\> if initiated to provide RLC failure information, set
*FailureInfoRLC-Bearer* as follows:

2\> set *logicalChannelIdentity* to the logical channel identity of the
failing RLC bearer;

2\> set *cellGroupId* to the cell group identity of the failing RLC
bearer;

2\> set the *failureType* as *rlc-failure*;

1\> if used to inform the network about a failure for an MCG RLC bearer:

2\> submit the *FailureInformation* message to lower layers for
transmission via SRB1;

...

##### 8.1.5.7.1.1.3 Test description {#test-description-16 .H6}

##### 8.1.5.7.1.1.3.1 Pre-test conditions {#pre-test-conditions-16 .H6}

System Simulator:

\- NR Cell 1 is the PCell, NR Cell 3 is the SCell.

UE:

> \- None.

Preamble:

Same Pre-Test conditions as in clause 7.1.3.0 except the following:

\- 2 NR cells (NR Cell 1 as Pcell and NR Cell 3 as Scell)

\- NR Cell 1 is configured with DRBs in RLC AM mode

##### 8.1.5.7.1.1.3.2 Test procedure sequence {#test-procedure-sequence-16 .H6}

Table 8.1.5.7.1.1.3.2-1: Main behaviour

  St    Procedure                                                                                                                                  Message Sequence   TP                                                                     Verdict   
  ----- ------------------------------------------------------------------------------------------------------------------------------------------ ------------------ ---------------------------------------------------------------------- --------- ----
                                                                                                                                                   U - S              Message                                                                          
  1     The SS transmits an *RRCReconfiguration* message to add SCell (NR Cell 3) for the UE.                                                      \<\--              *NR RRC: RRCReconfiguration*                                           \-        \-
  2     The UE transmits an RRCReconfigurationComplete message                                                                                     \--\>              *NR RRC: RRCReconfigurationComplete*                                   \-        \-
  2A    The SS transmits a SCell Activation/Deactivation MAC-CE to activate SCell (NR Cell 3).                                                     \<\--              MAC PDU (SCell Activation/Deactivation MAC CE of one octet (C~1~=1))   \-        \-
  3     The SS transmits an *RRCReconfiguration* message to reconfigure DRB \#j for the UE                                                         \<\--              *NR RRC: RRCReconfiguration*                                           \-        \-
  4     The UE transmits an RRCReconfigurationComplete message                                                                                     \--\>              *NR RRC: RRCReconfigurationComplete*                                   \-        \-
  5     Void                                                                                                                                       \-                 \-                                                                     \-        \-
  6     Void                                                                                                                                       \-                 *-*                                                                    \-        \-
  7     The SS stops sending MCG RLC acknowledgmentson PCell (NR Cell 1) and SCell (NR Cell 3)                                                     \-                 *-*                                                                    \-        \-
  8     SS transmits a periodic UL Grant on SCell (as PUCCH is not configured in the SCell), allowing the UE to loop back the PDCP PDU on SCell.   \-                                                                                        \-        \-
  8A    The SS transmits one PDCP PDU to the UE on DRB \#j.                                                                                        \<-                PDCP PDU                                                               \-        \-
  \-    EXCEPTION: Steps 9-9A occur in any sequence.                                                                                               \-                 *-*                                                                    \-        \-
  9     The UE loops back the PDCP PDU on PCell (NR Cell 1) on DRB \#j                                                                             \--\>              PDCP PDU                                                               \-        \-
  9A    The UE loops back the PDCP PDU on SCell (NR Cell 3) on DRB \#j                                                                             \--\>              PDCP PDU                                                               \-        \-
  10    Check: Does the UE transmit a *FailureInformation message with failureType set to '*rlc-failure'?                                          \--\>              NR RRC: *FailureInformation*                                           1         P
  10A   SS resumes sending MCG RLC acknowledgments                                                                                                 \-                 \-                                                                     \-        \-
  11    The SS transmits an *RRCReconfiguration* message containing an *sCellToReleaseList* with SCell NR Cell 3.                                  \<\--              NR RRC: *RRCReconfiguration*                                           \-        \-
  12    The UE transmits an *RRCReconfigurationComplete* message.                                                                                  \--\>              NR RRC: *RRCReconfigurationComplete*                                   \-        \-

##### 8.1.5.7.1.1.3.3 Specific message contents {#specific-message-contents-16 .H6}

Table 8.1.5.7.1.1.3.3-1: *RRCReconfiguration* (Step 1, Table
8.1.5.7.1.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition SCell\_add                                        
  ------------------------------------------------------------------------------ -------------------------- --------- -----------
  Information Element                                                            Value/remark               Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                   
  criticalExtensions CHOICE {                                                                                         
  rrcReconfiguration SEQUENCE {                                                                                       
  nonCriticalExtension SEQUENCE {                                                                                     
  masterCellGroup SEQUENCE {                                                                                          
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {          1 entry                              
  SCellConfig\[1\] SEQUENCE {                                                                               entry 1   
  sCellIndex                                                                     SCellIndex for NR Cell 3             
  sCellConfigCommon                                                              ServingCellConfigCommon              
  sCellConfigDedicated                                                           ServingCellConfig                    
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   

Table 8.1.5.7.1.1.3.3-1A: *ServingCellConfig* (Table 8.1.5.7.1.1.3.3-1)

  Derivation Path: TS 38.508-1 \[4\]**,** Table 4.6.3-167.                                       
  ---------------------------------------------------------- --------------------- ------------- ---------------
  **Information Element**                                    **Value/remark**      **Comment**   **Condition**
  ServingCellConfig ::= SEQUENCE {                                                               
  uplinkConfig SEQUENCE {                                                                        
  initialUplinkBWP                                           BWP-UplinkDedicated                 
  }                                                                                              
  }                                                                                              

Table 8.1.5.7.1.1.3.3-1B: *BWP-UplinkDedicated* (Table
8.1.5.7.1.1.3.3-1A)

  Derivation Path: TS 38.508-1 \[4\]**,** Table 4.6.3-15                                    
  -------------------------------------------------------- ------------------ ------------- ---------------
  **Information Element**                                  **Value/remark**   **Comment**   **Condition**
  BWP-UplinkDedicated ::= SEQUENCE {                                                        
  pucch-Config                                             Not present                      
  }                                                                                         

Table 8.1.5.7.1.1.3.3-1C: *ServingCellConfigCommon* (Table
8.1.5.7.1.1.3.3-1)

  Derivation Path: TS 38.508-1 \[4\]**,** Table 4.6.3-168.                                                       
  ---------------------------------------------------------- ------------------------------------- ------------- ---------------
  **Information Element**                                    **Value/remark**                      **Comment**   **Condition**
  ServingCellConfigCommon ::= SEQUENCE {                                                                         
  physCellId                                                 Physical Cell Identity of NR Cell 3                 
  uplinkConfigCommon                                         UplinkConfigCommon                                  
  }                                                                                                              

Table 8.1.5.7.1.1.3.3-1D: *UplinkConfigCommon* (Table
8.1.5.7.1.1.3.3-1C)

  Derivation Path: TS 38.331 \[6\], clause 6.3.2                                    
  ------------------------------------------------ ------------------ ------------- ---------------
  **Information Element**                          **Value/remark**   **Comment**   **Condition**
  UplinkConfigCommon ::= SEQUENCE {                                                 
  initialUplinkBWP                                 BWP-UplinkCommon                 
  }                                                                                 

Table 8.1.5.7.1.1.3.3-1E: *BWP-UplinkCommon* (Table 8.1.5.7.1.1.3.3-1D)

  Derivation Path: TS 38.331 \[6\], clause 6.3.2                                    
  ------------------------------------------------ ------------------ ------------- ---------------
  **Information Element**                          **Value/remark**   **Comment**   **Condition**
  BWP-UplinkCommon ::= SEQUENCE {                                                   
  pucch-ConfigCommon                               Not present                      
  }                                                                                 

Table 8.1.5.7.1.1.3.3-2: *RRCReconfiguration* (Step 3, Table
8.1.5.7.1.1.3.2-1)

  Derivation Path: TS 38.508-1\[4\], Table 4.6.1-13 with condition NR                                                     
  --------------------------------------------------------------------- ----------------------- ------------------------- -----------
  Information Element                                                   Value/remark            Comment                   Condition
  RRCReconfiguration::= SEQUENCE {                                                                                        
  criticalExtensions CHOICE {                                                                                             
  rrcReconfiguration SEQUENCE {                                                                                           
  radioBearerConfig                                                     RadioBearerConfig-DRB   Table 8.1.5.7.1.1.3.3-3   
  nonCriticalExtension SEQUENCE {                                                                                         
  masterCellGroup                                                       CellGroupConfig-DRB     Table 8.1.5.7.1.1.3.3-4   
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       

Table 8.1.5.7.1.1.3.3-3: *RadioBearerConfig-DRB* (Table
8.1.5.7.1.1.3.3-2)

  Derivation Path: TS 508-1 \[4\], Table 4.6.3-132 with condition DRB2                                                                                                                                                      
  ---------------------------------------------------------------------- ----------------------------------- -------------------------------------------------------------------------------------------------------------- -----------
  Information Element                                                    Value/remark                        Comment                                                                                                        Condition
  RadioBearerConfig ::= SEQUENCE {                                                                                                                                                                                          
  drb-ToAddModList SEQUENCE (SIZE (1..maxDRB)) OF DRB-ToAddMod {         1 entry                                                                                                                                            
  DRB-ToAddMod\[1\] SEQUENCE {                                                                               entry 1                                                                                                        
  drb-Identity                                                           DRB-Identity with condition DRB j   j is the ID of the DRB established during the preamble which is allocated according to internal TTCN mapping   
  pdcp-Config                                                            PDCP-Config                                                                                                                                        
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         

Table 8.1.5.7.1.1.3.3-4: *PDCP-Config* (Table 8.1.5.7.1.1.3.3-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-99 with condition Split                                                           
  ------------------------------------------------------------------------- --------------------------------------------- --------- -----------
  Information Element                                                       Value/remark                                  Comment   Condition
  PDCP-Config ::= SEQUENCE {                                                                                                        
  moreThanOneRLC SEQUENCE {                                                                                                         
  primaryPath SEQUENCE {                                                                                                            
  logicalChannel                                                            LogicalChannelIdentity with Condition DRB j             
  }                                                                                                                                 
  pdcp-Duplication                                                          True                                                    
  }                                                                                                                                 
  }                                                                                                                                 

Table 8.1.5.7.1.1.3.3-5: CellGroupConfig-DRB

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.3-19  |                 |                 |           |
| with Condition  |                 |                 |           |
| DRB j           |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| CellGroupConfig |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rlc-Bea         | 2 entries       |                 |           |
| rerToAddModList |                 |                 |           |
| SEQUENCE        |                 |                 |           |
| (SIZ            |                 |                 |           |
| E(1..maxLC-ID)) |                 |                 |           |
| OF              |                 |                 |           |
| R               |                 |                 |           |
| LC-BearerConfig |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| RLC-Be          | RLC             | entry 1         |           |
| arerConfig\[1\] | -BearerConfig-1 |                 |           |
|                 |                 | Table           |           |
|                 |                 | 8.              |           |
|                 |                 | 1.5.7.1.1.3.3-6 |           |
|                 |                 |                 |           |
|                 |                 | Primary RLC     |           |
+-----------------+-----------------+-----------------+-----------+
| RLC-Be          | RLC             | entry 1         |           |
| arerConfig\[2\] | -BearerConfig-2 |                 |           |
|                 |                 | Table           |           |
|                 |                 | 8.              |           |
|                 |                 | 1.5.7.1.1.3.3-7 |           |
|                 |                 |                 |           |
|                 |                 | Secondary RLC   |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| spCellConfig    | Not present     |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.7.1.1.3.3-6: *RLC-BearerConfig-1* (Table 8.1.5.7.1.1.3.3-5)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-148 with Condition AM                                                                                                        
  ----------------------------------------------------------------------------------- --------------------------------------------- ------------------------------------------ -----------
  Information Element                                                                 Value/remark                                  Comment                                    Condition
  RLC-BearerConfig ::= SEQUENCE {                                                                                                                                              
  logicalChannelIdentity                                                              LogicalChannelIdentity with condition DRB j   ID of primary logical channel              
  servedRadioBearer CHOICE {                                                                                                                                                   
  drb-Identity                                                                        DRB-Identity with condition DRB j                                                        
  }                                                                                                                                                                            
  rlc-Config CHOICE {                                                                                                                                                          
  am SEQUENCE {                                                                                                                                                                
  ul-AM-RLC SEQUENCE {                                                                                                                                                         
  maxRetxThreshold                                                                    t32                                           To ensure RLC failure happens before RLF   
  }                                                                                                                                                                            
  }                                                                                                                                                                            
  }                                                                                                                                                                            
  mac-LogicalChannelConfig SEQUENCE {                                                                                                                                          
  ul-SpecificParameters SEQUENCE {                                                                                                                                             
  allowedServingCells SEQUENCE (SIZE (1..maxNrofServingCells-1)) OF ServCellIndex {   1 entry                                                                                  
  ServCellIndex\[1\]                                                                  ServCellIndex of NR Cell 1                    entry 1                                    
  }                                                                                                                                                                            
  }                                                                                                                                                                            
  }                                                                                                                                                                            
  }                                                                                                                                                                            

Table 8.1.5.7.1.1.3.3-7: *RLC-BearerConfig-2* (Table 8.1.5.7.1.1.3.3-5)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-148 with Condition AM                                                                                                                                                                                                                            
  ----------------------------------------------------------------------------------- ----------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------ -----------
  Information Element                                                                 Value/remark                                    Comment                                                                                                                                                      Condition
  RLC-BearerConfig ::= SEQUENCE {                                                                                                                                                                                                                                                                  
  logicalChannelIdentity                                                              LogicalChannelIdentity with condition DRB j+1   To ensure ID of secondary logical channel ID is different with existing logical channel and the primary logical channel defined in Table 8.1.5.7.1.1.3.3-6   
  servedRadioBearer CHOICE {                                                                                                                                                                                                                                                                       
  drb-Identity                                                                        DRB-Identity with condition DRB j                                                                                                                                                                            
  }                                                                                                                                                                                                                                                                                                
  rlc-Config CHOICE {                                                                                                                                                                                                                                                                              
  am SEQUENCE {                                                                                                                                                                                                                                                                                    
  ul-AM-RLC SEQUENCE {                                                                                                                                                                                                                                                                             
  maxRetxThreshold                                                                    t1                                              To ensure RLC failure happens before RLF                                                                                                                     
  }                                                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                                                
  mac-LogicalChannelConfig SEQUENCE {                                                                                                                                                                                                                                                              
  ul-SpecificParameters SEQUENCE {                                                                                                                                                                                                                                                                 
  allowedServingCells SEQUENCE (SIZE (1..maxNrofServingCells-1)) OF ServCellIndex {   1 entry                                                                                                                                                                                                      
  ServCellIndex\[1\]                                                                  ServCellIndex of NR Cell 3                      entry 1                                                                                                                                                      
  }                                                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                                                

Table 8.1.5.7.1.1.3.3-8: *FailureInformation* (Step 10, Table
8.1.5.7.1.1.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-4                                                                       
  --------------------------------------------------- ----------------------------------------------------- ------------- ---------------
  **Information Element**                             **Value/remark**                                      **Comment**   **Condition**
  FailureInformation ::= SEQUENCE {                                                                                       
  criticalExtensions CHOICE {                                                                                             
  failureInformation SEQUENCE {                                                                                           
  failureInfoRLC-Bearer SEQUENCE {                                                                                        
  cellGroupId                                         CellGroupId as per TS 38.508-1 \[4\] Table 4.6.3-20                 
  logicalChannelIdentity                              LogicalChannelIdentity with condition DRB j+1                       
  failureType                                         rlc-failure                                                         
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       
  }                                                                                                                       

Table 8.1.5.7.1.1.3.3-9: *RRCReconfiguration* (step 11, Table
8.1.5.7.1.1.3.2-1)

  ----------------------------------------------------------------------------- ----------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13 with condition SCell\_add                               
  Information Element                                                           Value/remark      Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                         
  criticalExtensions CHOICE {                                                                               
  rrcReconfiguration SEQUENCE {                                                                             
  nonCriticalExtension SEQUENCE{                                                                            
  masterCellGroup                                                               CellGroupConfig             
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  }                                                                                                         
  ----------------------------------------------------------------------------- ----------------- --------- -----------

Table 8.1.5.7.1.1.3.3-10: *CellGroupConfig* (Table 8.1.5.7.1.1.3.3-9)

  ----------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-19 with condition SCell\_add                            
  Information Element                                                           Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                         
  sCellToAddModList                                                             Not present              
  sCellToReleaseList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellIndex {         1 entry                  
  SCellIndex\[1\]                                                               1              entry 1   
  }                                                                                                      
  }                                                                                                      
  ----------------------------------------------------------------------------- -------------- --------- -----------

###### 8.1.5.7.1.2 Failure information / RLC failure / MCG / Inter-band CA

##### 8.1.5.7.1.2.1 Test Purpose (TP) {#test-purpose-tp-17 .H6}

Same as TC 8.1.5.7.1.1 but applied to Inter-band CA case.

##### 8.1.5.7.1.2.2 Conformance requirements {#conformance-requirements-17 .H6}

Same as TC 8.1.5.7.1.1 but applied to Inter-band CA case.

##### 8.1.5.7.1.2.3 Test description {#test-description-17 .H6}

##### 8.1.5.7.1.2.3.1 Pre-test conditions {#pre-test-conditions-17 .H6}

Same as test case 8.1.5.7.1.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3.

##### 8.1.5.7.1.2.3.2 Test procedure sequence {#test-procedure-sequence-17 .H6}

Same as test case 8.1.5.7.1.1 with the following differences:

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3.

##### 8.1.5.7.1.2.3.3 Specific message contents {#specific-message-contents-17 .H6}

Same as test case 8.1.5.7.1.1 with the following differences.

\- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.

\- Cells configuration: NR Cell 10 replaces NR Cell 3.

###### 8.1.5.7.1.3 Failure information / RLC failure / MCG / Intra-band non Contiguous CA

##### 8.1.5.7.1.3.1 Test Purpose (TP) {#test-purpose-tp-18 .H6}

Same as TC 8.1.5.7.1.1 but applied to Intra-band non Contiguous CA case.

##### 8.1.5.7.1.3.2 Conformance requirements {#conformance-requirements-18 .H6}

Same as TC 8.1.5.7.1.1 but applied to Intra-band non Contiguous CA case.

##### 8.1.5.7.1.3.3 Test description {#test-description-18 .H6}

##### 8.1.5.7.1.3.3.1 Pre-test conditions {#pre-test-conditions-18 .H6}

Same as test case 8.1.5.7.1.1 with the following differences:

\- CA configuration: Intra-band non Contiguous CA replaces Intra-band
Contiguous CA.

##### 8.1.5.7.1.3.3.2 Test procedure sequence {#test-procedure-sequence-18 .H6}

Same as test case 8.1.5.7.1.1 with the following differences:

\- CA configuration: Intra-band non Contiguous CA replaces Intra-band
Contiguous CA.

##### 8.1.5.7.1.3.3.3 Specific message contents {#specific-message-contents-18 .H6}

Same as test case 8.1.5.7.1.1 but applied to Intra-band non Contiguous
CA case.

#### 8.1.5.8 Processing delay

##### 8.1.5.8.1 Processing delay / RRC\_Idle to RRC\_Connected / RRC\_Inactive to RRC\_Connected / Success / Latency check

##### 8.1.5.8.1.1 Test Purpose (TP) {#test-purpose-tp-19 .H6}

##### (1) {#section-25 .H6}

**with** { UE in NR RRC\_IDLE state and has sent an RRCSetupRequest
message }

**ensure that** {

**when** { UE receives RRCSetup message and after 10ms receives an UL
grant }

**then** { UE successfully transmits RRCSetupComplete message }

}

##### (2) {#section-26 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives a SecurityModeCommand message and after 5ms
receives an UL grant }

**then** { UE successfully transmits SecurityModeComplete }

}

##### (3) {#section-27 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives a RRCReconfiguration message to establish DRB
that is not part of the current UE configuration and after 10ms receives
an UL grant }

**then** { UE successfully transmits RRCReconfigurationComplete message
}

}

##### (4) {#section-28 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an UECapabilityEnquiry message and after 80ms
receives an UL grant }

**then** { UE successfully transmits an UECapabilityInformation message
}

}

##### (5) {#section-29 .H6}

**with** { UE in NR RRC\_INACTIVE state and has sent an RRCResumeRequest
message }

**ensure that** {

**when** { UE receives RRCResume message and after 6 or 10ms receives an
UL grant depending on UE capability }

**then** { UE successfully transmits RRCResumeComplete message }

}

##### (6) {#section-30 .H6}

**Void**

##### (7) {#section-31 .H6}

**with** { UE in NR RRC\_CONNECTED state and has sent an
RRCReestablishmentRequest message after detecting radio link failure on
expiring of timer T310 }

**ensure that** {

**when** { UE receives RRCReestablishment message and after 10ms
receives an UL grant }

**then** { UE successfully transmits RRCReestablishmentComplete message
}

}

##### (8) {#section-32 .H6}

**Void**

##### (9) {#section-33 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives CounterCheck message and after 5ms receives an UL
grant }

**then** { UE successfully transmits an CounterCheckResponse message }

}

##### 8.1.5.8.1.2 Conformance requirements {#conformance-requirements-19 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.3.4, 5.3.4.3, 5.3.5.3, 5.3.6.3,
5.3.7.4, 5.3.13.4, 5.6.1.3 and 12. Unless otherwise stated these are
Rel-15 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1\> submit the *RRCSetupComplete* message to lower layers for
transmission, upon which the procedure ends.

\[TS 38.331, clause 5.3.4.3\]

The UE shall:

...

1\> if the *SecurityModeCommand* message passes the integrity protection
check:

...

2\> submit the *SecurityModeComplete* message to lower layers for
transmission, upon which the procedure ends;

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> if the *RRCReconfiguration* message includes the
*radioBearerConfig*:

2\> perform the radio bearer configuration according to 5.3.5.6;

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

...

\[38.331, clause 5.3.6.3\]

Upon receiving the *CounterCheck* message, the UE shall:

...

1\> submit the *CounterCheckResponse* message to lower layers for
transmission upon which the procedure ends.

\[38.331, clause 5.3.7.4\]

The UE shall set the contents of *RRCReestablishmentRequest* message as
follows:

...

1\> submit the *RRCReestablishmentRequest* message to lower layers for
transmission.

\[38.331, clause 5.3.13.4\]

The UE shall:

...

1\> if the *RRCResume* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> submit the RRCResumeComplete message to lower layers for
transmission;

> ...

\[38.331, clause 5.6.1.3\]

The UE shall set the contents of *UECapabilityInformation* message as
follows:

1\> if the *ue-CapabilityRAT-RequestList* contains a
*UE-CapabilityRAT-Request* with *rat-Type* set to *nr*:

2\> include in the *ue-CapabilityRAT-ContainerList* a
*UE-CapabilityRAT-Container* of the type *UE-NR-Capability* and with the
*rat-Type* set to *nr*;

2\> include the *supportedBandCombinationList, featureSets* and
*featureSetCombinations* as specified in clause 5.6.1.4;

...

1\> submit the *UECapabilityInformation* message to lower layers for
transmission, upon which the procedure ends.

\[TS 38.331, clause 12\]

The UE performance requirements for RRC procedures are specified in the
following tables. The performance requirement is expressed as the time
in \[ms\] from the end of reception of the network -\> UE message on the
UE physical layer up to when the UE shall be ready for the reception of
uplink grant for the UE -\> network response message with no access
delay other than the TTI-alignment (e.g. excluding delays caused by
scheduling, the random access procedure or physical layer
synchronisation). In case the RRC procedure triggers BWP switching, the
RRC procedure delay is the value defined in the following table plus the
BWP switching delay defined in TS 38.133 \[14\], clause 8.6.3.

Figure 12.1-1: Illustration of RRC procedure delay

Table 12.1-1: UE performance requirements for RRC procedures for UEs

+-------------+-------------+-------------+-------------+-------------+
| Procedure   | Network -\> | UE -\>      | Value       | Notes       |
| title:      | UE          | Network     | \[ms\]      |             |
+=============+=============+=============+=============+=============+
| **RRC       |             |             |             |             |
| Connection  |             |             |             |             |
| Control     |             |             |             |             |
| P           |             |             |             |             |
| rocedures** |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| RRC         | *RRCRecon   | *RRCRe      | 10          |             |
| reco        | figuration* | configurati |             |             |
| nfiguration |             | onComplete* |             |             |
+-------------+-------------+-------------+-------------+-------------+
| RRC         | *RRCRecon   | *RRCRe      | 16          |             |
| reco        | figuration* | configurati |             |             |
| nfiguration |             | onComplete* |             |             |
| (scell      |             |             |             |             |
| additi      |             |             |             |             |
| on/release) |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| RRC setup   | *RRCSetup*  | *RRCSet     | 10          |             |
|             |             | upComplete* |             |             |
+-------------+-------------+-------------+-------------+-------------+
| RRC         | *RRCReest   | *RRCRe      | 10          |             |
| re-es       | ablishment* | establishme |             |             |
| tablishment |             | ntComplete* |             |             |
+-------------+-------------+-------------+-------------+-------------+
| RRC resume  | *RRCResume* | *RRCResu    | 6 or 10     | Value=6     |
|             |             | meComplete* |             | applies for |
|             |             |             |             | a UE        |
|             |             |             |             | supporting  |
|             |             |             |             | reduced CP  |
|             |             |             |             | latency for |
|             |             |             |             | the case of |
|             |             |             |             | RRCResume   |
|             |             |             |             | message     |
|             |             |             |             | only        |
|             |             |             |             | including   |
|             |             |             |             | MAC and PHY |
|             |             |             |             | con         |
|             |             |             |             | figuration, |
|             |             |             |             | rees        |
|             |             |             |             | tablishPDCP |
|             |             |             |             | and         |
|             |             |             |             | ree         |
|             |             |             |             | stablishRLC |
|             |             |             |             | for SRB2    |
|             |             |             |             | and DRB(s), |
|             |             |             |             | and no DRX, |
|             |             |             |             | SPS,        |
|             |             |             |             | configured  |
|             |             |             |             | grant, CA   |
|             |             |             |             | or MIMO     |
|             |             |             |             | re-co       |
|             |             |             |             | nfiguration |
|             |             |             |             | will be     |
|             |             |             |             | triggered   |
|             |             |             |             | by this     |
|             |             |             |             | message.    |
|             |             |             |             | Further,    |
|             |             |             |             | the UL      |
|             |             |             |             | grant for   |
|             |             |             |             | t           |
|             |             |             |             | ransmission |
|             |             |             |             | of          |
|             |             |             |             | *RRCResu    |
|             |             |             |             | meComplete* |
|             |             |             |             | and the     |
|             |             |             |             | data is     |
|             |             |             |             | transmitted |
|             |             |             |             | over common |
|             |             |             |             | search      |
|             |             |             |             | space with  |
|             |             |             |             | DCI format  |
|             |             |             |             | 0\_0.       |
|             |             |             |             |             |
|             |             |             |             | In this     |
|             |             |             |             | scenario,   |
|             |             |             |             | the RRC     |
|             |             |             |             | procedure   |
|             |             |             |             | delay       |
|             |             |             |             | \[ms\] can  |
|             |             |             |             | extend      |
|             |             |             |             | beyond the  |
|             |             |             |             | reception   |
|             |             |             |             | of the UL   |
|             |             |             |             | grant, up   |
|             |             |             |             | to 7 ms.    |
|             |             |             |             |             |
|             |             |             |             | For other   |
|             |             |             |             | cases,      |
|             |             |             |             | Value = 10  |
|             |             |             |             | applies.    |
+-------------+-------------+-------------+-------------+-------------+
| RRC resume  | *RRCResume* | *RRCResu    | 16          |             |
| (scell      |             | meComplete* |             |             |
| addition)   |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| Initial AS  | *SecurityM  | *Security   | 5           |             |
| security    | odeCommand* | ModeComplet |             |             |
| activation  |             | e/SecurityM |             |             |
|             |             | odeFailure* |             |             |
+-------------+-------------+-------------+-------------+-------------+
| **Other     |             |             |             |             |
| p           |             |             |             |             |
| rocedures** |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| UE          | *UECapabil  | *UE         | 80          |             |
| capability  | ityEnquiry* | CapabilityI |             |             |
| transfer    |             | nformation* |             |             |
+-------------+-------------+-------------+-------------+-------------+
| Counter     | *Co         | *CounterChe | 5           |             |
| check       | unterCheck* | ckResponse* |             |             |
+-------------+-------------+-------------+-------------+-------------+

##### 8.1.5.8.1.3 Test description {#test-description-19 .H6}

##### 8.1.5.8.1.3.1 Pre-test conditions {#pre-test-conditions-19 .H6}

##### System Simulator: {#system-simulator-13 .H6}

\- NR Cell 1 and NR Cell 2.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cells with RACH-ConfigGeneric in SIB1 set
as per Table 8.1.5.8.1.3.3-0.

\- Test frequency NRf1 is as specified in TS 38.508-1 \[4\] clause 4.3.1
using the common highest UL and DL channel bandwidth and using the
default subcarrier spacing specified in TS 38.508-1 \[4\] clause
6.2.3.1.

##### UE: {#ue-11 .H6}

\- None.

##### Preamble: {#preamble-11 .H6}

\- The UE is in state RRC\_IDLE using generic procedure parameter
Connectivity (*NR*) according to TS 38.508-1 \[4\], clause 4.5.2.

##### 8.1.5.8.1.3.2 Test procedure sequence {#test-procedure-sequence-19 .H6}

Table 8.1.5.8.1.3.2-1/2 illustrates the downlink power levels and other
changing parameters to be applied for the cells at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions
after preamble, while column marked \"T1\", is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.5.8.1.3.2-1: Time instances of cell power level and parameter
changes in FR1

+----+-----------+---------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 |
+====+===========+=========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -88       | -96       |
|    |           |         |           |           |
|    | SSS EPRE  |         |           |           |
+----+-----------+---------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | "Off"     | -88       |
|    |           |         |           |           |
|    | SSS EPRE  |         |           |           |
+----+-----------+---------+-----------+-----------+

Table 8.1.5.8.1.3.2-2: Time instances of cell power level and parameter
changes in FR2

+----+-----------+---------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 |
+====+===========+=========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -82       | -91       |
|    |           |         |           |           |
|    | SSS EPRE  |         |           |           |
+----+-----------+---------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | "Off"     | -82       |
|    |           |         |           |           |
|    | SSS EPRE  |         |           |           |
+----+-----------+---------+-----------+-----------+

Table 8.1.5.8.1.3.2-3: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | a matched |           |           |         |    |
|           | ng-5      |           |           |         |    |
|           | G-S-TMSI. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *RRCSetu  |         |    |
|           | an        |           | pRequest* |         |    |
|           | *RRCSetu  |           |           |         |    |
|           | pRequest* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCSetup* |         |    |
|           | *         |           |           |         |    |
|           | RRCSetup* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3A        | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (10∙2^μ^  |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 3 to |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH.    |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | Check:    | \--\>     | NR RRC:   | 1       | P  |
|           | Does the  |           | *RRCSetup |         |    |
|           | UE        |           | Complete* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           | *NR       |         |    |
|           | *RRCSetup |           | 5GMM:*    |         |    |
|           | Complete* |           | SERVICE   |         |    |
|           | message   |           | REQUEST   |         |    |
|           | pi        |           |           |         |    |
|           | ggybacked |           |           |         |    |
|           | with      |           |           |         |    |
|           | SERVICE   |           |           |         |    |
|           | REQUEST   |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (10∙      |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 3?        |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2,   |           |           |         |    |
|           | Note 3)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Se       |         |    |
|           | a         |           | curityMod |         |    |
|           | *Se       |           | eCommand* |         |    |
|           | curityMod |           |           |         |    |
|           | eCommand* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5A        | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (5∙2^μ^   |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 5 to |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH.    |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | Check:    | \--\>     | NR RRC:   | 2       | P  |
|           | Does the  |           | *Sec      |         |    |
|           | UE        |           | urityMode |         |    |
|           | transmit  |           | Complete* |         |    |
|           | a         |           |           |         |    |
|           | *Sec      |           |           |         |    |
|           | urityMode |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (5∙       |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 5? (Note  |           |           |         |    |
|           | 1, Note   |           |           |         |    |
|           | 2, Note   |           |           |         |    |
|           | 3)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *UE       |         |    |
|           | a         |           | Capabilit |         |    |
|           | *UE       |           | yEnquiry* |         |    |
|           | Capabilit |           |           |         |    |
|           | yEnquiry* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7A        | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI with  |           |           |         |    |
|           | the       |           |           |         |    |
|           | maximum   |           |           |         |    |
|           | grant     |           |           |         |    |
|           | allowed   |           |           |         |    |
|           | by the    |           |           |         |    |
|           | carrier   |           |           |         |    |
|           | bandwidth |           |           |         |    |
|           | with      |           |           |         |    |
|           | MCS=24    |           |           |         |    |
|           | from      |           |           |         |    |
|           | (80∙2^μ^  |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 7 to |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH.    |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | Check:    | \--\>     | NR RRC:   | 4       | P  |
|           | Does the  |           | *UECapa   |         |    |
|           | UE        |           | bilityInf |         |    |
|           | transmit  |           | ormation* |         |    |
|           | a         |           |           |         |    |
|           | *UECapa   |           |           |         |    |
|           | bilityInf |           |           |         |    |
|           | ormation* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (80∙      |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 7? (Note  |           |           |         |    |
|           | 1, Note   |           |           |         |    |
|           | 2, Note   |           |           |         |    |
|           | 3)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCReconfi |         |    |
|           | *R        |           | guration* |         |    |
|           | RCReconfi |           |           |         |    |
|           | guration* |           | *NR 5GMM: |         |    |
|           | message   |           | SERVICE   |         |    |
|           | to        |           | ACCEPT*   |         |    |
|           | establish |           |           |         |    |
|           | SRB2 and  |           |           |         |    |
|           | DRB \#n   |           |           |         |    |
|           | for the   |           |           |         |    |
|           | UE        |           |           |         |    |
|           | pi        |           |           |         |    |
|           | ggybacked |           |           |         |    |
|           | with      |           |           |         |    |
|           | SERVICE   |           |           |         |    |
|           | ACCEPT    |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9A        | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (10∙2^μ^  |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 9 to |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH.    |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | Check:    | \--\>     | NR RRC:   | 3       | P  |
|           | Does the  |           | *         |         |    |
|           | UE        |           | RRCReconf |         |    |
|           | transmit  |           | iguration |         |    |
|           | an        |           | Complete* |         |    |
|           | *         |           |           |         |    |
|           | RRCReconf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (10∙      |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 9? (Note  |           |           |         |    |
|           | 1, Note   |           |           |         |    |
|           | 2, Note   |           |           |         |    |
|           | 3)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Coun     |         |    |
|           | a         |           | terCheck* |         |    |
|           | *Coun     |           |           |         |    |
|           | terCheck* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11A       | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (5∙2^μ^   |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 11   |           |           |         |    |
|           | to        |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH.    |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12        | Check:    | \--\>     | NR RRC:   | 9       | P  |
|           | Does the  |           | *Cou      |         |    |
|           | UE        |           | nterCheck |         |    |
|           | transmit  |           | Response* |         |    |
|           | a         |           |           |         |    |
|           | *Cou      |           |           |         |    |
|           | nterCheck |           |           |         |    |
|           | Response* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (5∙       |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 11? (Note |           |           |         |    |
|           | 1, Note   |           |           |         |    |
|           | 2, Note   |           |           |         |    |
|           | 3)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 13        | Void      | \-        | \-        | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | E         | \-        | \-        | \-      | \- |
|           | XCEPTION: |           |           |         |    |
|           | Steps     |           |           |         |    |
|           | 14a1 to   |           |           |         |    |
|           | 14a7      |           |           |         |    |
|           | describe  |           |           |         |    |
|           | behaviour |           |           |         |    |
|           | that      |           |           |         |    |
|           | depends   |           |           |         |    |
|           | on the UE |           |           |         |    |
|           | ca        |           |           |         |    |
|           | pability; |           |           |         |    |
|           | the       |           |           |         |    |
|           | \"lower   |           |           |         |    |
|           | case      |           |           |         |    |
|           | letter\"  |           |           |         |    |
|           | i         |           |           |         |    |
|           | dentifies |           |           |         |    |
|           | a step    |           |           |         |    |
|           | sequence  |           |           |         |    |
|           | that take |           |           |         |    |
|           | place if  |           |           |         |    |
|           | a         |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | is        |           |           |         |    |
|           | s         |           |           |         |    |
|           | upported. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a1      | IF        | \<\--     | NR RRC:   | \-      | \- |
|           | pc\_inac  |           | *RR       |         |    |
|           | tiveState |           | CRelease* |         |    |
|           | THEN the  |           |           |         |    |
|           | SS        |           |           |         |    |
|           | transmits |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with      |           |           |         |    |
|           | *suspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a2      | Wait 1s   | \-        | *-*       | \-      | \- |
|           | to let UE |           |           |         |    |
|           | enter     |           |           |         |    |
|           | RRC\      |           |           |         |    |
|           | _INACTIVE |           |           |         |    |
|           | state.    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a3      | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | a matched |           |           |         |    |
|           | ng-5      |           |           |         |    |
|           | G-S-TMSI. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a4      | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *RRCResum |         |    |
|           | an        |           | eRequest* |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a5      | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCResume* |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message   |           |           |         |    |
|           | for the   |           |           |         |    |
|           | UE on     |           |           |         |    |
|           | slot \#i  |           |           |         |    |
|           | in the    |           |           |         |    |
|           | radio     |           |           |         |    |
|           | frame:    |           |           |         |    |
|           |           |           |           |         |    |
|           | For μ =   |           |           |         |    |
|           | 0, if     |           |           |         |    |
|           | FD-FDD    |           |           |         |    |
|           | and       |           |           |         |    |
|           | pc\_      |           |           |         |    |
|           | reducedCP |           |           |         |    |
|           | \_Latency |           |           |         |    |
|           | then i =  |           |           |         |    |
|           | 5 else i  |           |           |         |    |
|           | = 0.      |           |           |         |    |
|           |           |           |           |         |    |
|           | For μ =   |           |           |         |    |
|           | 1, i = 1  |           |           |         |    |
|           |           |           |           |         |    |
|           | For μ =   |           |           |         |    |
|           | 3, if     |           |           |         |    |
|           | pc\_      |           |           |         |    |
|           | reducedCP |           |           |         |    |
|           | \_Latency |           |           |         |    |
|           | then I =  |           |           |         |    |
|           | 41 else i |           |           |         |    |
|           | = 21      |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 2)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | E         | \-        | \-        | \-      | \- |
|           | XCEPTION: |           |           |         |    |
|           | Steps     |           |           |         |    |
|           | 14a5Aa1   |           |           |         |    |
|           | to        |           |           |         |    |
|           | 14a5Ab2   |           |           |         |    |
|           | describe  |           |           |         |    |
|           | behaviour |           |           |         |    |
|           | that      |           |           |         |    |
|           | depends   |           |           |         |    |
|           | on the UE |           |           |         |    |
|           | ca        |           |           |         |    |
|           | pability; |           |           |         |    |
|           | the       |           |           |         |    |
|           | \"lower   |           |           |         |    |
|           | case      |           |           |         |    |
|           | letter\"  |           |           |         |    |
|           | i         |           |           |         |    |
|           | dentifies |           |           |         |    |
|           | a step    |           |           |         |    |
|           | sequence  |           |           |         |    |
|           | that take |           |           |         |    |
|           | place if  |           |           |         |    |
|           | a         |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | is        |           |           |         |    |
|           | s         |           |           |         |    |
|           | upported. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a5Aa1   | IF        | \-        | \-        | \-      | \- |
|           | pc\_      |           |           |         |    |
|           | reducedCP |           |           |         |    |
|           | \_Latency |           |           |         |    |
|           | THEN the  |           |           |         |    |
|           | SS starts |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (6∙2^μ^   |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 14a5 |           |           |         |    |
|           | to        |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH. IF |           |           |         |    |
|           | UE        |           |           |         |    |
|           | transmits |           |           |         |    |
|           | a Random  |           |           |         |    |
|           | Access    |           |           |         |    |
|           | Preamble, |           |           |         |    |
|           | then SS   |           |           |         |    |
|           | sends     |           |           |         |    |
|           | RAR.      |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a5Aa2   | Check:    | \--\>     | NR RRC:   | 5       | P  |
|           | Does the  |           | *         |         |    |
|           | UE        |           | RRCResume |         |    |
|           | transmit  |           | Complete* |         |    |
|           | an        |           |           |         |    |
|           | *         |           |           |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (6∙       |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 14a5?     |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2,   |           |           |         |    |
|           | Note 3)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a5Ab1   | ELSE the  | \-        | \-        | \-      | \- |
|           | SS starts |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (10∙2^μ^  |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 14a5 |           |           |         |    |
|           | to        |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH. IF |           |           |         |    |
|           | UE        |           |           |         |    |
|           | transmits |           |           |         |    |
|           | a Random  |           |           |         |    |
|           | Access    |           |           |         |    |
|           | Preamble, |           |           |         |    |
|           | then SS   |           |           |         |    |
|           | sends     |           |           |         |    |
|           | RAR.      |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a5Ab2   | Check:    | \--\>     | NR RRC:   | 5       | P  |
|           | Does the  |           | *         |         |    |
|           | UE        |           | RRCResume |         |    |
|           | transmit  |           | Complete* |         |    |
|           | an        |           |           |         |    |
|           | *         |           |           |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (10∙      |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 14a5?     |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2,   |           |           |         |    |
|           | Note 3)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14a6-14a7 | Void      | \-        | \-        | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 14-21     | Void      | \-        | \-        | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 22        | The SS    | \-        | *-*       | \-      | \- |
|           | r         |           |           |         |    |
|           | e-adjusts |           |           |         |    |
|           | the SS    |           |           |         |    |
|           | levels    |           |           |         |    |
|           | according |           |           |         |    |
|           | to row    |           |           |         |    |
|           | \"T1\" in |           |           |         |    |
|           | table     |           |           |         |    |
|           | 8.1.5.8.  |           |           |         |    |
|           | 1.3.2-1/2 |           |           |         |    |
|           | in order  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | radio     |           |           |         |    |
|           | link      |           |           |         |    |
|           | quality   |           |           |         |    |
|           | of NR     |           |           |         |    |
|           | Cell 1 is |           |           |         |    |
|           | degraded, |           |           |         |    |
|           | and NR    |           |           |         |    |
|           | Cell 2 is |           |           |         |    |
|           | suitable  |           |           |         |    |
|           | for       |           |           |         |    |
|           | camping.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 23        | Wait 1s   | \-        | *-*       | \-      | \- |
|           | to let    |           |           |         |    |
|           | T310      |           |           |         |    |
|           | expire.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 24        | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | transmits |           | RRCReest  |         |    |
|           | an        |           | ablishmen |         |    |
|           | *RRCReest |           | tRequest* |         |    |
|           | ablishmen |           |           |         |    |
|           | tRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on Cell   |           |           |         |    |
|           | 2.        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 25        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCReestab |         |    |
|           | *R        |           | lishment* |         |    |
|           | RCReestab |           |           |         |    |
|           | lishment* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on slot   |           |           |         |    |
|           | \#i in    |           |           |         |    |
|           | the radio |           |           |         |    |
|           | frame,    |           |           |         |    |
|           | where:    |           |           |         |    |
|           |           |           |           |         |    |
|           | i = 1 for |           |           |         |    |
|           | μ=0,1     |           |           |         |    |
|           |           |           |           |         |    |
|           | i = 21    |           |           |         |    |
|           | for μ=3   |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 2)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 25A       | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (10∙2^μ^  |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 25   |           |           |         |    |
|           | to        |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH.    |           |           |         |    |
|           |           |           |           |         |    |
|           | IF UE     |           |           |         |    |
|           | transmits |           |           |         |    |
|           | a Random  |           |           |         |    |
|           | Access    |           |           |         |    |
|           | Preamble, |           |           |         |    |
|           | then SS   |           |           |         |    |
|           | sends     |           |           |         |    |
|           | RAR.      |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 26        | Check:    | \--\>     | *NR RRC:  | 7       | P  |
|           | Does the  |           | RRCReesta |         |    |
|           | UE        |           | blishment |         |    |
|           | transmit  |           | Complete* |         |    |
|           | an        |           |           |         |    |
|           | *         |           |           |         |    |
|           | RRCReesta |           |           |         |    |
|           | blishment |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (10∙      |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 25? (Note |           |           |         |    |
|           | 1, Note   |           |           |         |    |
|           | 2, Note   |           |           |         |    |
|           | 3)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 26A       | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | R         |         |    |
|           | an        |           | RCReconfi |         |    |
|           | RRCReconf |           | guration* |         |    |
|           | iguration |           |           |         |    |
|           | message   |           |           |         |    |
|           | to resume |           |           |         |    |
|           | existing  |           |           |         |    |
|           | radio     |           |           |         |    |
|           | bearer.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 26B       | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | transmits |           | R         |         |    |
|           | an        |           | RCReconfi |         |    |
|           | RRCRecon  |           | gurationt |         |    |
|           | figuratio |           | Complete* |         |    |
|           | nComplete |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 27-35     | Void      | \-        | *-*       | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| T~DL~ is  |           |           |           |         |    |
| the delay |           |           |           |         |    |
| in slots  |           |           |           |         |    |
| to the    |           |           |           |         |    |
| next      |           |           |           |         |    |
| available |           |           |           |         |    |
| DL slot   |           |           |           |         |    |
| suitable  |           |           |           |         |    |
| for the   |           |           |           |         |    |
| tra       |           |           |           |         |    |
| nsmission |           |           |           |         |    |
| of a DCI. |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 2: μ |           |           |           |         |    |
| is the    |           |           |           |         |    |
| SCS       |           |           |           |         |    |
| index. μ  |           |           |           |         |    |
| = 0/1/2/3 |           |           |           |         |    |
| for SCS = |           |           |           |         |    |
| 15kHz/    |           |           |           |         |    |
| 30kHz/60k |           |           |           |         |    |
| Hz/120kHz |           |           |           |         |    |
| resp      |           |           |           |         |    |
| ectively. |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 3:   |           |           |           |         |    |
| K~2~ is   |           |           |           |         |    |
| the       |           |           |           |         |    |
| offset    |           |           |           |         |    |
| (in       |           |           |           |         |    |
| slots)    |           |           |           |         |    |
| between   |           |           |           |         |    |
| UL grant  |           |           |           |         |    |
| and the   |           |           |           |         |    |
| PUSCH it  |           |           |           |         |    |
| s         |           |           |           |         |    |
| cheduled. |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.5.8.1.3.3 Specific message contents {#specific-message-contents-19 .H6}

Table 8.1.5.8.1.3.3-0: *RACH-ConfigGeneric (*Preamble and all steps)

  ----------------------------------------------------- -------------- --------- ------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-130                            
  Information Element                                   Value/remark   Comment   Condition
  RACH-ConfigGeneric ::= SEQUENCE {                                              
  ra-ResponseWindow                                     sl20                     
                                                        sl4                      FR1 AND FDD AND NOT(pc\_halfDuplexFDD\_TypeA\_RedCap\_r17)
                                                        sl10                     FR1 AND (TDD OR pc\_halfDuplexFDD\_TypeA\_RedCap\_r17) AND SCS15
  }                                                                              
  ----------------------------------------------------- -------------- --------- ------------------------------------------------------------------

Table 8.1.5.8.1.3.3-1: RRCReconfiguration (Step 9, Table
8.1.5.8.1.3.2-3)

  ---------------------------------------------------------------------- --------------------------------- ---------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-13 with condition NR                                                                        
  Information Element                                                    Value/remark                      Comment                            Condition
  RRCReconfiguration::= SEQUENCE {                                                                                                            
  criticalExtensions CHOICE {                                                                                                                 
  rrcReconfiguration SEQUENCE {                                                                                                               
  radioBearerConfig                                                      RadioBearerConfig-SRB2-DRB(1,0)   TS 38.508-1 \[4\] Table 4.8.1-4    
  nonCriticalExtension SEQUENCE {                                                                                                             
  masterCellGroup                                                        CellGroupConfig-SRB2-DRB(1,0)     TS 38.508-1 \[4\] Table 4.8.1-2B   
  dedicatedNAS-MessageList                                               Not present                                                          
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  ---------------------------------------------------------------------- --------------------------------- ---------------------------------- -----------

Table 8.1.5.8.1.3.3-2: CounterCheck *(*Step 11, Table 8.1.5.8.1.3.2-3*)*

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.1-1   |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| CounterCheck    |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| counterCheck    |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| drb-Co          | 1 entry         |                 |           |
| untMSB-InfoList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..maxDRB)) OF |                 |                 |           |
| DR              |                 |                 |           |
| B-CountMSB-Info |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| DR              |                 |                 |           |
| B-CountMSB-Info |                 |                 |           |
| \[1\] SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| drb-Identity    | DRB-Identity    | entry 1         |           |
|                 | with Condition  |                 |           |
|                 | DRBn            | n is the index  |           |
|                 |                 | of the DRB      |           |
|                 |                 | established in  |           |
|                 |                 | step 9 of Table |           |
|                 |                 | 8               |           |
|                 |                 | .1.5.8.1.3.2-3, |           |
|                 |                 | which is        |           |
|                 |                 | allocated       |           |
|                 |                 | according to    |           |
|                 |                 | internal TTCN   |           |
|                 |                 | mapping         |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.8.1.3.3-3: CounterCheckResponse *(Step 12, Table*
8.1.5.8.1.3.2-3*)*

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.1-2   |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Count           |                 |                 |           |
| erCheckResponse |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| count           |                 |                 |           |
| erCheckResponse |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| dr              | 1 entry         |                 |           |
| b-CountInfoList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (0..maxDRB)) OF |                 |                 |           |
| DRB-CountInfo { |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| DRB             |                 |                 |           |
| -CountInfo\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| drb-Identity    | DRB-Identity    | entry 1         |           |
|                 | with Condition  |                 |           |
|                 | DRBn            | n is the index  |           |
|                 |                 | of the DRB      |           |
|                 |                 | established in  |           |
|                 |                 | step 9 of Table |           |
|                 |                 | 8               |           |
|                 |                 | .1.5.8.1.3.2-3, |           |
|                 |                 | which is        |           |
|                 |                 | allocated       |           |
|                 |                 | according to    |           |
|                 |                 | internal TTCN   |           |
|                 |                 | mapping         |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.8.1.3.3-4: *RRCRelease* (Step 14a1, *Table* 8.1.5.8.1.3.2-3)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with Condition NR\_RRC\_INACTIVE
  -------------------------------------------------------------------------------------

Table 8.1.5.8.1.3.3-5 to Table 8.1.5.8.1.3.3-10: Void

Table 8.1.5.8.1.3.3-11: Physical layer parameters for DCI format 1\_0
*(Steps 3, 14a5 and* 25, Table 8.1.5.8.1.3.2-3*)*

  --------------------------------------------------------- ----------------------------------------------- ----------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.3.6.1.2.1-1                                                                     
  Parameter                                                 Value                                           Value in binary   Condition
  PDSCH-to-HARQ\_feedback timing indicator                  K~1~ slots as specified in 9.2.3 in TS 38.213                     
                                                            µ=0 (SCS=15kHz): K~1~=3                         \'010\'B          
                                                            µ=1 (SCS=30kHz): K~1~=7                         \'110\'B          
                                                            µ=3 (SCS=120kHz): K~1~=3                        \'010\'B          
  --------------------------------------------------------- ----------------------------------------------- ----------------- -----------

Table 8.1.5.8.1.3.3-12: SIB1 (Preamble, and all steps of Table
8.1.5.8.1.3.2-3)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                            
  Information Element                                  Value/remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                           
  servingCellConfigCommon SEQUENCE {                                            
  uplinkConfigCommon SEQUENCE {                                                 
  initialUplinkBWP SEQUENCE {                                                   
  rach-ConfigCommon CHOICE {                                                    
  setup SEQUENCE {                                                              
  rach-ConfigGeneric SEQUENCE {                                                 
  prach-ConfigurationIndex                             159                      FR2
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.5.8.1.3.3-13: RRCReconfiguration (Step 26A, Table
8.1.5.8.1.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

##### 8.1.5.8.2 Processing delay / RRC\_Inactive to RRC\_Connected / Success / Latency check / SCell addition

###### 8.1.5.8.2.1 Processing delay / RRC\_Inactive to RRC\_Connected / Success / Latency check / SCell addition / Intra-band Contiguous CA

##### 8.1.5.8.2.1.1 Test Purpose (TP) {#test-purpose-tp-20 .H6}

##### (1) {#section-34 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an *RRCReconfiguration* message containing
*sCellToAddModList* with a SCell addition and after 16ms receives an UL
grant }

**then** { UE successfully transmits *RRCReconfigurationComplete*
message }

}

##### (2) {#section-35 .H6}

**with** { UE in NR RRC\_INACTIVE state and has sent an
*RRCResumeRequest* message }

**ensure that** {

**when** { UE receives *RRCResume* message containing
*sCellToAddModList* with a SCell addition and after 16ms receives an UL
grant }

**then** { UE successfully transmits *RRCResumeComplete* message }

}

##### 8.1.5.8.2.1.2 Conformance requirements {#conformance-requirements-20 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.3.4, 5.3.4.3, 5.3.5.3, 5.3.6.3,
5.3.7.4, 5.3.13.4, 5.6.1.3 and 12. Unless otherwise stated these are
Rel-15 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration*:

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> if the *RRCReconfiguration* message includes the
*radioBearerConfig*:

2\> perform the radio bearer configuration according to 5.3.5.6;

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

...

\[38.331, clause 5.3.13.4\]

The UE shall:

...

1\> if the *RRCResume* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> submit the RRCResumeComplete message to lower layers for
transmission;

> ...

\[TS 38.331, clause 12\]

The UE performance requirements for RRC procedures are specified in the
following tables. The performance requirement is expressed as the time
in \[ms\] from the end of reception of the network -\> UE message on the
UE physical layer up to when the UE shall be ready for the reception of
uplink grant for the UE -\> network response message with no access
delay other than the TTI-alignment (e.g. excluding delays caused by
scheduling, the random access procedure or physical layer
synchronisation). In case the RRC procedure triggers BWP switching, the
RRC procedure delay is the value defined in the following table plus the
BWP switching delay defined in TS 38.133 \[14\], clause 8.6.3.

Figure 12.1-1: Illustration of RRC procedure delay

Table 12.1-1: UE performance requirements for RRC procedures for UEs

  Procedure title:                               Network -\> UE         UE -\> Network                 Value \[ms\]   Notes
  ---------------------------------------------- ---------------------- ------------------------------ -------------- -------
  **RRC Connection Control Procedures**                                                                               
  RRC reconfiguration (scell addition/release)   *RRCReconfiguration*   *RRCReconfigurationComplete*   16             
  RRC resume (scell addition)                    *RRCResume*            *RRCResumeComplete*            16             

##### 8.1.5.8.2.1.3 Test description {#test-description-20 .H6}

##### 8.1.5.8.2.1.3.1 Pre-test conditions {#pre-test-conditions-20 .H6}

##### System Simulator: {#system-simulator-14 .H6}

\- NR Cell 1 is the PCell and NR Cell 3 is the SCell.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cells.

##### UE: {#ue-12 .H6}

\- None.

##### Preamble: {#preamble-12 .H6}

\- The UE is in 5GS state 3N-A on NR Cell 1 according to TS 38.508-1
\[4\], clause 4.5.4.

##### 8.1.5.8.2.1.3.2 Test procedure sequence {#test-procedure-sequence-20 .H6}

Table 8.1.5.8.2.1.3.2-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble.

Table 8.1.5.8.2.1.3.2-1: Time instances of cell power level and
parameter changes in FR1

+----+-----------+---------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 3 |
+====+===========+=========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -88       | -88       |
|    |           |         |           |           |
|    | SSS EPRE  |         |           |           |
+----+-----------+---------+-----------+-----------+

Table 8.1.5.8.2.1.3.2-2: Time instances of cell power level and
parameter changes in FR2

+----+-----------+---------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 3 |
+====+===========+=========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -82       | -82       |
|    |           |         |           |           |
|    | SSS EPRE  |         |           |           |
+----+-----------+---------+-----------+-----------+

Table 8.1.5.8.2.1.3.2-3: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCReconfi |         |    |
|           | *R        |           | guration* |         |    |
|           | RCReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with      |           |           |         |    |
|           | *         |           |           |         |    |
|           | sCellToAd |           |           |         |    |
|           | dModList* |           |           |         |    |
|           | to add    |           |           |         |    |
|           | SCell     |           |           |         |    |
|           | (Cell 3). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (16∙2^μ^  |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 1 to |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH.    |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | Check:    | \--\>     | NR RRC:   | 1       | P  |
|           | Does the  |           | *         |         |    |
|           | UE        |           | RRCReconf |         |    |
|           | transmit  |           | iguration |         |    |
|           | an        |           | Complete* |         |    |
|           | *         |           |           |         |    |
|           | RRCReconf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (16∙      |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 1? (Note  |           |           |         |    |
|           | 1, Note   |           |           |         |    |
|           | 2, Note   |           |           |         |    |
|           | 3)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCReconfi |         |    |
|           | *R        |           | guration* |         |    |
|           | RCReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | message   |           |           |         |    |
|           | to        |           |           |         |    |
|           | release   |           |           |         |    |
|           | SCell     |           |           |         |    |
|           | (Cell 3). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | UE        | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCReconf |         |    |
|           | *         |           | iguration |         |    |
|           | RRCReconf |           | Complete* |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | E         | \-        | \-        | \-      | \- |
|           | XCEPTION: |           |           |         |    |
|           | Steps 6a1 |           |           |         |    |
|           | to 6a9    |           |           |         |    |
|           | describe  |           |           |         |    |
|           | behaviour |           |           |         |    |
|           | that      |           |           |         |    |
|           | depends   |           |           |         |    |
|           | on UE     |           |           |         |    |
|           | confi     |           |           |         |    |
|           | guration; |           |           |         |    |
|           | the       |           |           |         |    |
|           | \"lower   |           |           |         |    |
|           | case      |           |           |         |    |
|           | letter\"  |           |           |         |    |
|           | i         |           |           |         |    |
|           | dentifies |           |           |         |    |
|           | a step    |           |           |         |    |
|           | sequence  |           |           |         |    |
|           | that      |           |           |         |    |
|           | takes     |           |           |         |    |
|           | place if  |           |           |         |    |
|           | a         |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | is        |           |           |         |    |
|           | co        |           |           |         |    |
|           | nfigured. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a1       | IF        | \<\--     | NR RRC:   | \-      | \- |
|           | pc\_inac  |           | *RR       |         |    |
|           | tiveState |           | CRelease* |         |    |
|           | THEN the  |           |           |         |    |
|           | SS        |           |           |         |    |
|           | transmits |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with      |           |           |         |    |
|           | *suspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a2       | Wait 1s   | \-        | *-*       | \-      | \- |
|           | to let UE |           |           |         |    |
|           | enter     |           |           |         |    |
|           | RRC\      |           |           |         |    |
|           | _INACTIVE |           |           |         |    |
|           | state.    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a3       | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | a matched |           |           |         |    |
|           | ng-5      |           |           |         |    |
|           | G-S-TMSI. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a4       | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *RRCResum |         |    |
|           | an        |           | eRequest* |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a5       | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCResume* |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with      |           |           |         |    |
|           | *         |           |           |         |    |
|           | sCellToAd |           |           |         |    |
|           | dModList* |           |           |         |    |
|           | to add    |           |           |         |    |
|           | SCell     |           |           |         |    |
|           | (Cell 3)  |           |           |         |    |
|           | on slot   |           |           |         |    |
|           | \#i in    |           |           |         |    |
|           | the radio |           |           |         |    |
|           | frame,    |           |           |         |    |
|           | where:    |           |           |         |    |
|           |           |           |           |         |    |
|           | i = 1 for |           |           |         |    |
|           | μ=0,1     |           |           |         |    |
|           |           |           |           |         |    |
|           | i = 21    |           |           |         |    |
|           | for μ=3   |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 2)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a6       | The SS    | \-        | \-        | \-      | \- |
|           | starts    |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmitting |           |           |         |    |
|           | a         |           |           |         |    |
|           | periodic  |           |           |         |    |
|           | DCI from  |           |           |         |    |
|           | (16∙2^μ^  |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 6a5  |           |           |         |    |
|           | to        |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH.    |           |           |         |    |
|           |           |           |           |         |    |
|           | IF UE     |           |           |         |    |
|           | transmits |           |           |         |    |
|           | a Random  |           |           |         |    |
|           | Access    |           |           |         |    |
|           | Preamble, |           |           |         |    |
|           | then SS   |           |           |         |    |
|           | sends     |           |           |         |    |
|           | RAR.(Note |           |           |         |    |
|           | 1, Note   |           |           |         |    |
|           | 2)        |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a7       | Check:    | \--\>     | NR RRC:   | 2       | P  |
|           | Does the  |           | *         |         |    |
|           | UE        |           | RRCResume |         |    |
|           | transmit  |           | Complete* |         |    |
|           | an        |           |           |         |    |
|           | *         |           |           |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           |           |         |    |
|           | within    |           |           |         |    |
|           | (16∙      |           |           |         |    |
|           | 2^μ^+1+T~ |           |           |         |    |
|           | DL~+K~2~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of step   |           |           |         |    |
|           | 6a5?      |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2,   |           |           |         |    |
|           | Note 3)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a8       | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | R         |         |    |
|           | an        |           | RCReconfi |         |    |
|           | *R        |           | guration* |         |    |
|           | RCReconfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | message   |           |           |         |    |
|           | c         |           |           |         |    |
|           | ontaining |           |           |         |    |
|           | an        |           |           |         |    |
|           | *s        |           |           |         |    |
|           | CellToRel |           |           |         |    |
|           | easeList* |           |           |         |    |
|           | with      |           |           |         |    |
|           | SCell NR  |           |           |         |    |
|           | Cell 3.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6a9       | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | transmits |           | R         |         |    |
|           | an        |           | RCReconfi |         |    |
|           | *         |           | gurationt |         |    |
|           | RRCReconf |           | Complete* |         |    |
|           | iguration |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| T~DL~ is  |           |           |           |         |    |
| the delay |           |           |           |         |    |
| in slots  |           |           |           |         |    |
| to the    |           |           |           |         |    |
| next      |           |           |           |         |    |
| available |           |           |           |         |    |
| DL slot   |           |           |           |         |    |
| suitable  |           |           |           |         |    |
| for the   |           |           |           |         |    |
| tra       |           |           |           |         |    |
| nsmission |           |           |           |         |    |
| of a DCI. |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 2: μ |           |           |           |         |    |
| is the    |           |           |           |         |    |
| SCS       |           |           |           |         |    |
| index. μ  |           |           |           |         |    |
| = 0/1/2/3 |           |           |           |         |    |
| for SCS = |           |           |           |         |    |
| 15kHz/    |           |           |           |         |    |
| 30kHz/60k |           |           |           |         |    |
| Hz/120kHz |           |           |           |         |    |
| resp      |           |           |           |         |    |
| ectively. |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 3:   |           |           |           |         |    |
| K~2~ is   |           |           |           |         |    |
| the       |           |           |           |         |    |
| offset    |           |           |           |         |    |
| (in       |           |           |           |         |    |
| slots)    |           |           |           |         |    |
| between   |           |           |           |         |    |
| DCI and   |           |           |           |         |    |
| the PUSCH |           |           |           |         |    |
| it        |           |           |           |         |    |
| s         |           |           |           |         |    |
| cheduled. |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.5.8.2.1.3.3 Specific message contents {#specific-message-contents-20 .H6}

Table 8.1.5.8.2.1.3.3-1: *RRCReconfiguration* (Step 1, *Table*
8.1.5.8.2.1.3.2-3)

  ------------------------------------------------------------------------------ ----------------- ------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with Condition SCell\_add                                               
  Information Element                                                            Value/remark      Comment                   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                          
  criticalExtensions CHOICE {                                                                                                
  rrcReconfiguration SEQUENCE {                                                                                              
  nonCriticalExtension SEQUENCE {                                                                                            
  masterCellGroup                                                                CellGroupConfig   Table 8.1.5.8.2.1.3.3-2   
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  ------------------------------------------------------------------------------ ----------------- ------------------------- -----------

Table 8.1.5.8.2.1.3.3-2: *CellGroupConfig* (Table 8.1.5.8.2.1.3.3-1)

  ------------------------------------------------------------------------------ ---------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition SCell\_add                                    
  Information Element                                                            Value/remark           Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                  
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {          1 entry                          
  SCellConfig\[1\] SEQUENCE {                                                                           entry 1   
  sCellConfigCommon SEQUENCE {                                                                                    
  physCellId                                                                     physCellId of Cell 3             
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  ------------------------------------------------------------------------------ ---------------------- --------- -----------

Table 8.1.5.8.2.1.3.3-3: *RRCReconfiguration* (Steps 4 and 6a8, *Table*
8.1.5.8.2.1.3.2-3)

  ------------------------------------------------------------------------------ ---------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with Condition SCell\_add                                    
  Information Element                                                            Value/remark           Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                               
  criticalExtensions CHOICE {                                                                                     
  rrcReconfiguration SEQUENCE {                                                                                   
  nonCriticalExtension SEQUENCE {                                                                                 
  masterCellGroup SEQUENCE {                                                                                      
  sCellToAddModList                                                              Not present                      
  sCellToReleaseList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellIndex {          1 entry                          
  SCellIndex\[1\]                                                                SCellIndex of Cell 3   entry 1   
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  ------------------------------------------------------------------------------ ---------------------- --------- -----------

Table 8.1.5.8.2.1.3.3-4: *RRCRelease* (Step 6a1, *Table*
8.1.5.8.2.1.3.2-3)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with Condition NR\_RRC\_INACTIVE
  -------------------------------------------------------------------------------------

Table 8.1.5.8.2.1.3.3-5: *RRCResume* (Step 6a5, *Table*
8.1.5.8.2.1.3.2-3)

  -------------------------------------------------- ----------------- ------------------------- -----------
  Derivation Path: TS 38.508-1\[4\],Table 4.6.1-17                                               
  Information Element                                Value/remark      Comment                   Condition
  RRCResume ::= SEQUENCE {                                                                       
  criticalExtensions CHOICE {                                                                    
  rrcResume SEQUENCE {                                                                           
  masterCellGroup                                    CellGroupConfig   Table 8.1.5.8.2.1.3.3-6   
  }                                                                                              
  }                                                                                              
  }                                                                                              
  -------------------------------------------------- ----------------- ------------------------- -----------

Table 8.1.5.8.2.1.3.3-6: *CellGroupConfig* (Table 8.1.5.8.2.1.3.3-5)

  ----------------------------------------------------------------------------------------- ---------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition SCell\_add and RESUME                                    
  Information Element                                                                       Value/remark           Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                             
  sCellToAddModList SEQUENCE (SIZE (1..maxNrofSCells)) OF SCellConfig {                     1 entry                          
  SCellConfig\[1\] SEQUENCE {                                                                                      entry 1   
  sCellConfigCommon SEQUENCE {                                                                                               
  physCellId                                                                                physCellId of Cell 3             
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  }                                                                                                                          
  ----------------------------------------------------------------------------------------- ---------------------- --------- -----------

Table 8.1.5.8.2.1.3.3-7: Physical layer parameters for DCI format 1\_0
*(Steps 6a5*, Table 8.1.5.8.2.1.3.3-5*)*

  --------------------------------------------------------- ----------------------------------------------- ----------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.3.6.1.2.1-1                                                                     
  Parameter                                                 Value                                           Value in binary   Condition
  PDSCH-to-HARQ\_feedback timing indicator                  K~1~ slots as specified in 9.2.3 in TS 38.213                     
                                                            µ=0 (SCS=15kHz): K~1~=3                         \'010\'B          
                                                            µ=1 (SCS=30kHz): K~1~=7                         \'110\'B          
                                                            µ=3 (SCS=120kHz): K~1~=3                        \'010\'B          
  --------------------------------------------------------- ----------------------------------------------- ----------------- -----------

###### 8.1.5.8.2.2 Processing delay / RRC\_Inactive to RRC\_Connected / Success / Latency check / SCell addition / Inter-band CA

##### 8.1.5.8.2.2.1 Test Purpose (TP) {#test-purpose-tp-21 .H6}

Same as TC 8.1.5.8.2.1 but applied to Inter-band CA Test Case

##### 8.1.5.8.2.2.2 Conformance requirements {#conformance-requirements-21 .H6}

Same as TC 8.1.5.8.2.1 but applied to Inter-band CA Test Case

##### 8.1.5.8.2.2.3 Test description {#test-description-21 .H6}

##### 8.1.5.8.2.2.3.1 Pre-test conditions {#pre-test-conditions-21 .H6}

Same as TC 8.1.5.8.2.1 but with the following differences：

> \- CA configuration: Inter-band CA replaces Intra-band Contiguous CA.
>
> \- Cells configuration: Cell 10 replaces Cell 3.

##### 8.1.5.8.2.2.3.2 Test procedure sequence {#test-procedure-sequence-21 .H6}

Same as TC 8.1.5.8.2.1 but with the following differences：

> \- Cells configuration: Cell 10 replaces Cell 3.

##### 8.1.5.8.2.2.3.3 Specific message contents {#specific-message-contents-21 .H6}

Same as TC 8.1.5.8.2.1 but with the following differences：

> \- Cells configuration: Cell 10 replaces Cell 3.

###### 8.1.5.8.2.3 Processing delay / RRC\_Inactive to RRC\_Connected / Success / Latency check / SCell addition / Intra-band non-Contiguous CA

##### 8.1.5.8.2.3.1 Test Purpose (TP) {#test-purpose-tp-22 .H6}

Same as TC 8.1.5.8.2.1 but applied to Intra-band non-Contiguous CA Test
Case

##### 8.1.5.8.2.3.2 Conformance requirements {#conformance-requirements-22 .H6}

Same as TC 8.1.5.8.2.1 but applied to Intra-band non-Contiguous CA Test
Case

##### 8.1.5.8.2.3.3 Test description {#test-description-22 .H6}

##### 8.1.5.8.2.3.3.1 Pre-test conditions {#pre-test-conditions-22 .H6}

Same as TC 8.1.5.8.2.1 but with the following differences:

\- CA configuration: Intra-band non-Contiguous CA replaces Intra-band
Contiguous CA.

##### 8.1.5.8.2.3.3.2 Test procedure sequence {#test-procedure-sequence-22 .H6}

Same as TC 8.1.5.8.2.1.

##### 8.1.5.8.2.3.3.3 Specific message contents {#specific-message-contents-22 .H6}

Same as TC 8.1.5.8.2.1.

#### 8.1.5.9 Message Segment transfer

##### 8.1.5.9.1 UECapabilityInformation / UL segment transfer

##### 8.1.5.9.1.1 Test Purpose (TP) {#test-purpose-tp-23 .H6}

##### (1) {#section-36 .H6}

with { UE in NR RRC\_CONNECTED state }

ensure that {

when { UE receives UECapabilityEnquiry message with rrc-segAllowed-r16
enabled }

then { UE successfully segments UECapabilityInformation message at RRC
layer and sends UlDedicatedMessageSegment messages with
rrc-MessageSegmentType set accordingly for the first and last segment
and rrc-MessageSegmentContainer containing the segments of
UECapabilityInformation message }

}

##### (2) {#section-37 .H6}

with { UE in NR RRC\_CONNECTED state and UE having received
UECapabilityEnquiry message with rrc-segAllowed-r16 enabled and having
transmitted the firstSegment of UECapabilityInformation message within
the ULDedicatedMessageSegment message }

ensure that {

when { UE detects radio link failure on expiry of timer T310 }

then { UE successfully completes RRC re-establishment procedure and
discards the remaining segments of UECapabilityInformation message }

}

##### 8.1.5.9.1.2 Conformance requirements {#conformance-requirements-23 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331 clause 5.6.1.3, 5.7.7.2, 5.7.7.3 and 5.3.7.2.
Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.6.1.3\]

The UE shall set the contents of *UECapabilityInformation* message as
follows:

1\> if the RRC message segmentation is enabled based on the field
*rrc-SegAllowed* received, and the encoded RRC message is larger than
the maximum supported size of a PDCP SDU specified in TS 38.323 \[5\]:

2\> initiate the *UL message segment transfer procedure as specified in
clause 5.7.7;*

1\> else:

2\> submit the *UECapabilityInformation* message to lower layers for
transmission, upon which the procedure ends.

\[TS 38.331, clause 5.7.7.2\]

A UE capable of UL RRC message segmentation in RRC\_CONNECTED will
initiate the procedure when the following conditions are met:

1\> if the RRC message segmentation is enabled based on the field
*rrc-SegAllowed* received, and

1\> if the encoded RRC message is larger than the maximum supported size
of a PDCP SDU specified in TS 38.323 \[5\];

Upon initiating the procedure, the UE shall:

1\> initiate transmission of the *ULDedicatedMessageSegment* message as
specified in 5.7.7.3;

\[TS 38.331, clause 5.7.7.3\]

The UE shall segment the encoded RRC PDU based on the maximum supported
size of a PDCP SDU specified in TS 38.323 \[5\]. UE shall minimize the
number of segments and set the contents of the
*ULDedicatedMessageSegment* messages as follows:

1\> F or each new UL DCCH message, set the *segmentNumber* to 0 for the
first message segment and increment the *segmentNumber* for each
subsequent RRC message segment;

1\> set *rrc-MessageSegmentContainer* to include the segment of the UL
DCCH message corresponding to the *segmentNumber*;

1\> if the segment included in the *rrc-MessageSegmentContainer* is the
last segment of the UL DCCH message:

2\> set the *rrc-MessageSegmentType* to lastSegment;

1\> else:

2\> set the *rrc-MessageSegmentType* to *notLastSegment*;

1\> submit all the *ULDedicatedMessageSegment* messages generated for
the segmented RRC message to lower layers for transmission in ascending
order based on the *segmentNumber*, upon which the procedure ends.

\[TS 38.331, clause 5.3.7.2\]

Upon initiation of the procedure, the UE shall:

...

1\> if UE is not configured with *conditionalReconfiguration*:

2\> reset MAC;

2\> release *spCellConfig*, if configured;

2\> suspend all RBs, except SRB0;

##### 8.1.5.9.1.3 Test description {#test-description-23 .H6}

##### 8.1.5.9.1.3.1 Pre-test conditions {#pre-test-conditions-23 .H6}

##### System Simulator: {#system-simulator-15 .H6}

> \- NR Cell 1

UE:

\- None.

##### Preamble: {#preamble-13 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.5.9.1.3.2 Test procedure sequence {#test-procedure-sequence-23 .H6}

Table 8.1.5.9.1.3.2-1: Time instances of cell power level and parameter
changes for FR1

+------------------------------------+-----------+---------+--------+
|                                    | Parameter | Unit    | NR     |
|                                    |           |         |        |
|                                    |           |         | Cell 1 |
+====================================+===========+=========+========+
| T1                                 | SS/PBCH   | dBm/SCS | "Off"  |
|                                    |           |         |        |
|                                    | SSS EPRE  |         |        |
+------------------------------------+-----------+---------+--------+
| T2                                 | SS/PBCH   | dBm/SCS | -88    |
|                                    |           |         |        |
|                                    | SSS EPRE  |         |        |
+------------------------------------+-----------+---------+--------+
| Power level "Off" is defined in TS |           |         |        |
| 38.508-1 \[4\] Table 6.2.2.1-3.    |           |         |        |
+------------------------------------+-----------+---------+--------+

Table 8.1.5.9.1.3.2-2: Time instances of cell power level and parameter
changes for FR2

+------------------------------------+-----------+---------+--------+
|                                    | Parameter | Unit    | NR     |
|                                    |           |         |        |
|                                    |           |         | Cell 1 |
+====================================+===========+=========+========+
| T1                                 | SS/PBCH   | dBm/SCS | "Off"  |
|                                    |           |         |        |
|                                    | SSS EPRE  |         |        |
+------------------------------------+-----------+---------+--------+
| T2                                 | SS/PBCH   | dBm/SCS | -82    |
|                                    |           |         |        |
|                                    | SSS EPRE  |         |        |
+------------------------------------+-----------+---------+--------+
| Power level "Off" is defined in TS |           |         |        |
| 38.508-1 \[4\] Table 6.2.2.2-2.    |           |         |        |
+------------------------------------+-----------+---------+--------+

Table 8.1.5.9.1.3.2-3: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | UE        |         |    |
|           | a         |           | Capabilit |         |    |
|           | *UE       |           | yEnquiry* |         |    |
|           | Capabilit |           |           |         |    |
|           | yEnquiry* |           |           |         |    |
|           | message   |           |           |         |    |
|           | to        |           |           |         |    |
|           | enquire   |           |           |         |    |
|           | max       |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | and with  |           |           |         |    |
|           | rrc-segAl |           |           |         |    |
|           | lowed-r16 |           |           |         |    |
|           | set to    |           |           |         |    |
|           | enabled.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | E         | \-        | *-*       | \-      | \- |
|           | XCEPTION: |           |           |         |    |
|           | Steps 2a1 |           |           |         |    |
|           | to 2b7    |           |           |         |    |
|           | describe  |           |           |         |    |
|           | behaviour |           |           |         |    |
|           | that      |           |           |         |    |
|           | depends   |           |           |         |    |
|           | on the    |           |           |         |    |
|           | size of   |           |           |         |    |
|           | UEs       |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | c         |           |           |         |    |
|           | ontainer; |           |           |         |    |
|           | the       |           |           |         |    |
|           | \"lower   |           |           |         |    |
|           | case      |           |           |         |    |
|           | letter\"  |           |           |         |    |
|           | i         |           |           |         |    |
|           | dentifies |           |           |         |    |
|           | a step    |           |           |         |    |
|           | sequence  |           |           |         |    |
|           | that      |           |           |         |    |
|           | takes     |           |           |         |    |
|           | place     |           |           |         |    |
|           | depending |           |           |         |    |
|           | on the    |           |           |         |    |
|           | size of   |           |           |         |    |
|           | UE        |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | message.  |           |           |         |    |
|           |           |           |           |         |    |
|           | IF UE's   |           |           |         |    |
|           | encoded   |           |           |         |    |
|           | UECap     |           |           |         |    |
|           | abilityIn |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | \>= Max   |           |           |         |    |
|           | PDCP SDU  |           |           |         |    |
|           | size then |           |           |         |    |
|           | step 2a1  |           |           |         |    |
|           | will be   |           |           |         |    |
|           | performed |           |           |         |    |
|           | else step |           |           |         |    |
|           | 2b1 to    |           |           |         |    |
|           | 2b7 will  |           |           |         |    |
|           | be        |           |           |         |    |
|           | p         |           |           |         |    |
|           | erformed. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | E         | \-        | *-*       | \-      | \- |
|           | XCEPTION: |           |           |         |    |
|           | Step 2a1  |           |           |         |    |
|           | is        |           |           |         |    |
|           | repeated  |           |           |         |    |
|           | a maximum |           |           |         |    |
|           | of 16     |           |           |         |    |
|           | times or  |           |           |         |    |
|           | till      |           |           |         |    |
|           | rrc-Mes   |           |           |         |    |
|           | sageSegme |           |           |         |    |
|           | ntType-16 |           |           |         |    |
|           | IE within |           |           |         |    |
|           | the       |           |           |         |    |
|           | ULDedic   |           |           |         |    |
|           | atedMessa |           |           |         |    |
|           | geSegment |           |           |         |    |
|           | message   |           |           |         |    |
|           | indicates |           |           |         |    |
|           | rrc-Mess  |           |           |         |    |
|           | ageSegmen |           |           |         |    |
|           | tType-r16 |           |           |         |    |
|           | =         |           |           |         |    |
|           | las       |           |           |         |    |
|           | tSegment. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2a1       | Check:    | \--\>     | *NR RRC:  | 1       | P  |
|           | Does the  |           | ULDedica  |         |    |
|           | UE send   |           | tedMessag |         |    |
|           | segments  |           | eSegment* |         |    |
|           | of        |           |           |         |    |
|           | UECap     |           |           |         |    |
|           | abilityIn |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | contained |           |           |         |    |
|           | within    |           |           |         |    |
|           | the       |           |           |         |    |
|           | rrc-      |           |           |         |    |
|           | MessageSe |           |           |         |    |
|           | gmentCont |           |           |         |    |
|           | ainer-r16 |           |           |         |    |
|           | IE of the |           |           |         |    |
|           | ULDedic   |           |           |         |    |
|           | atedMessa |           |           |         |    |
|           | geSegment |           |           |         |    |
|           | message?  |           |           |         |    |
|           |           |           |           |         |    |
|           | NOTE: The |           |           |         |    |
|           | SS shall  |           |           |         |    |
|           | ensure    |           |           |         |    |
|           | that the  |           |           |         |    |
|           | con       |           |           |         |    |
|           | catenated |           |           |         |    |
|           | segments  |           |           |         |    |
|           | decode    |           |           |         |    |
|           | into a    |           |           |         |    |
|           | valid     |           |           |         |    |
|           | UECap     |           |           |         |    |
|           | abilityIn |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | (specific |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | content   |           |           |         |    |
|           | is not    |           |           |         |    |
|           | checked). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2b1       | Check:    | \--\>     | *NR RRC:  | \-      | \- |
|           | Does the  |           | UECapa    |         |    |
|           | UE send   |           | bilityInf |         |    |
|           | UECap     |           | ormation* |         |    |
|           | abilityIn |           |           |         |    |
|           | formation |           |           |         |    |
|           | Message?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3a1-4a13  | Void      | \-        | *-*       | \-      | \- |
+-----------+-----------+-----------+-----------+---------+----+
| 2b2       | The SS    | \<\--     | SET UL    | \-      | \- |
|           | transmits |           | MESSAGE   |         |    |
|           | a SET UL  |           | REQUEST   |         |    |
|           | MESSAGE   |           |           |         |    |
|           | REQUEST   |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2b3       | The UE    | \--\>     | SET UL    | \-      | \- |
|           | transmits |           | MESSAGE   |         |    |
|           | a SET UL  |           | RESPONSE  |         |    |
|           | MESSAGE   |           |           |         |    |
|           | RESPONSE  |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2b4       | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | UE        |         |    |
|           | a         |           | Capabilit |         |    |
|           | *UE       |           | yEnquiry* |         |    |
|           | Capabilit |           |           |         |    |
|           | yEnquiry* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with      |           |           |         |    |
|           | rrc-segAl |           |           |         |    |
|           | lowed-r16 |           |           |         |    |
|           | set to    |           |           |         |    |
|           | enabled.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| \-        | E         | \-        | *-*       | \-      | \- |
|           | XCEPTION: |           |           |         |    |
|           | Step 2b5  |           |           |         |    |
|           | is        |           |           |         |    |
|           | repeated  |           |           |         |    |
|           | a maximum |           |           |         |    |
|           | of 2      |           |           |         |    |
|           | times.    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2b5       | Check:    | \--\>     | *NR RRC:  | 1       | P  |
|           | Does the  |           | ULDedica  |         |    |
|           | UE send   |           | tedMessag |         |    |
|           | segments  |           | eSegment* |         |    |
|           | of        |           |           |         |    |
|           | UECap     |           |           |         |    |
|           | abilityIn |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | contained |           |           |         |    |
|           | within    |           |           |         |    |
|           | the       |           |           |         |    |
|           | rrc-      |           |           |         |    |
|           | MessageSe |           |           |         |    |
|           | gmentCont |           |           |         |    |
|           | ainer-r16 |           |           |         |    |
|           | IE of the |           |           |         |    |
|           | ULDedic   |           |           |         |    |
|           | atedMessa |           |           |         |    |
|           | geSegment |           |           |         |    |
|           | message?  |           |           |         |    |
|           |           |           |           |         |    |
|           | NOTE: The |           |           |         |    |
|           | SS shall  |           |           |         |    |
|           | ensure    |           |           |         |    |
|           | that the  |           |           |         |    |
|           | con       |           |           |         |    |
|           | catenated |           |           |         |    |
|           | segments  |           |           |         |    |
|           | decode    |           |           |         |    |
|           | into a    |           |           |         |    |
|           | valid     |           |           |         |    |
|           | UECap     |           |           |         |    |
|           | abilityIn |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | (specific |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | content   |           |           |         |    |
|           | is not    |           |           |         |    |
|           | checked). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2b6       | The SS    | \<\--     | SET UL    | \-      | \- |
|           | transmits |           | MESSAGE   |         |    |
|           | a SET UL  |           | REQUEST   |         |    |
|           | MESSAGE   |           |           |         |    |
|           | REQUEST   |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2b7       | The UE    | \--\>     | SET UL    | \-      | \- |
|           | transmits |           | MESSAGE   |         |    |
|           | a SET UL  |           | RESPONSE  |         |    |
|           | MESSAGE   |           |           |         |    |
|           | RESPONSE  |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | SS stops  | \-        | *-*       | \-      | \- |
|           | regular   |           |           |         |    |
|           | grant     |           |           |         |    |
|           | tra       |           |           |         |    |
|           | nsmission |           |           |         |    |
|           | upon      |           |           |         |    |
|           | s         |           |           |         |    |
|           | cheduling |           |           |         |    |
|           | request.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | UE        |         |    |
|           | a         |           | Capabilit |         |    |
|           | *UE       |           | yEnquiry* |         |    |
|           | Capabilit |           |           |         |    |
|           | yEnquiry* |           |           |         |    |
|           | message   |           |           |         |    |
|           | to        |           |           |         |    |
|           | enquire   |           |           |         |    |
|           | max       |           |           |         |    |
|           | c         |           |           |         |    |
|           | apability |           |           |         |    |
|           | and with  |           |           |         |    |
|           | rrc-segAl |           |           |         |    |
|           | lowed-r16 |           |           |         |    |
|           | set to    |           |           |         |    |
|           | enabled.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | The SS    | \-        | *-*       | \-      | \- |
|           | allocates |           |           |         |    |
|           | 15 UL     |           |           |         |    |
|           | grants    |           |           |         |    |
|           | from      |           |           |         |    |
|           | (80∙2^μ^  |           |           |         |    |
|           | +1+T~DL~) |           |           |         |    |
|           | slots     |           |           |         |    |
|           | after     |           |           |         |    |
|           | step 4 at |           |           |         |    |
|           | an        |           |           |         |    |
|           | interval  |           |           |         |    |
|           | of 10ms   |           |           |         |    |
|           | to        |           |           |         |    |
|           | schedule  |           |           |         |    |
|           | PUSCH     |           |           |         |    |
|           | till the  |           |           |         |    |
|           | ULDedic   |           |           |         |    |
|           | atedMessa |           |           |         |    |
|           | geSegment |           |           |         |    |
|           | at step 6 |           |           |         |    |
|           | is        |           |           |         |    |
|           | received. |           |           |         |    |
|           | (Note 1,  |           |           |         |    |
|           | Note 2,   |           |           |         |    |
|           | Note 3)   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | sends 1st |           | ULDedica  |         |    |
|           | segment   |           | tedMessag |         |    |
|           | of        |           | eSegment* |         |    |
|           | UECap     |           |           |         |    |
|           | abilityIn |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | contained |           |           |         |    |
|           | within    |           |           |         |    |
|           | the       |           |           |         |    |
|           | rrc-      |           |           |         |    |
|           | MessageSe |           |           |         |    |
|           | gmentCont |           |           |         |    |
|           | ainer-r16 |           |           |         |    |
|           | IE of the |           |           |         |    |
|           | ULDedic   |           |           |         |    |
|           | atedMessa |           |           |         |    |
|           | geSegment |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | The SS    | \-        | \-        | \-      | \- |
|           | changes   |           |           |         |    |
|           | NR Cell 1 |           |           |         |    |
|           | p         |           |           |         |    |
|           | arameters |           |           |         |    |
|           | according |           |           |         |    |
|           | to the    |           |           |         |    |
|           | row       |           |           |         |    |
|           | \"T1\" in |           |           |         |    |
|           | table     |           |           |         |    |
|           | 8.1.5.9.  |           |           |         |    |
|           | 1.3.2-1/2 |           |           |         |    |
|           | in order  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | radio     |           |           |         |    |
|           | link      |           |           |         |    |
|           | quality   |           |           |         |    |
|           | of NR     |           |           |         |    |
|           | Cell 1 is |           |           |         |    |
|           | degraded. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | Wait for  | \-        | \-        | \-      | \- |
|           | T310 to   |           |           |         |    |
|           | expire    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | The SS    | \-        | \-        | \-      | \- |
|           | changes   |           |           |         |    |
|           | NR Cell 1 |           |           |         |    |
|           | p         |           |           |         |    |
|           | arameters |           |           |         |    |
|           | according |           |           |         |    |
|           | to the    |           |           |         |    |
|           | row       |           |           |         |    |
|           | \"T2\" in |           |           |         |    |
|           | table     |           |           |         |    |
|           | 8.1.5.9.1 |           |           |         |    |
|           | .3.2-1/2. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | sends an  |           | RRCReest  |         |    |
|           | *RRCReest |           | ablishmen |         |    |
|           | ablishmen |           | tRequest* |         |    |
|           | tRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11        | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | R         |         |    |
|           | an        |           | RCReestab |         |    |
|           | RRCReesta |           | lishment* |         |    |
|           | blishment |           |           |         |    |
|           | message   |           |           |         |    |
|           | to resume |           |           |         |    |
|           | SRB1      |           |           |         |    |
|           | operation |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12        | The UE    | \--\>     | *NR RRC:  | \-      | \- |
|           | transmits |           | RRCReesta |         |    |
|           | an        |           | blishment |         |    |
|           |           |           | Complete* |         |    |
|           | RRCReest  |           |           |         |    |
|           | ablishmen |           |           |         |    |
|           | tComplete |           |           |         |    |
|           | message   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12A       | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCReconfi |         |    |
|           | RRCReconf |           | guration* |         |    |
|           | iguration |           |           |         |    |
|           | message   |           |           |         |    |
|           | to resume |           |           |         |    |
|           | existing  |           |           |         |    |
|           | radio     |           |           |         |    |
|           | bearer.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12B       | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmit  |           | *R        |         |    |
|           | an        |           | RCReconfi |         |    |
|           | RRCRecon  |           | gurationt |         |    |
|           | figuratio |           | Complete* |         |    |
|           | nComplete |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 13        | SS        | \-        | *-*       | \-      | \- |
|           | resumes   |           |           |         |    |
|           | regular   |           |           |         |    |
|           | UL grant  |           |           |         |    |
|           | tran      |           |           |         |    |
|           | smission. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14        | Check:    | \-        | *-*       | 2       | P  |
|           | Upon      |           |           |         |    |
|           | s         |           |           |         |    |
|           | uccessful |           |           |         |    |
|           | c         |           |           |         |    |
|           | ompletion |           |           |         |    |
|           | of RRC    |           |           |         |    |
|           | re-esta   |           |           |         |    |
|           | blishment |           |           |         |    |
|           | p         |           |           |         |    |
|           | rocedure, |           |           |         |    |
|           | does the  |           |           |         |    |
|           | UE        |           |           |         |    |
|           | discards  |           |           |         |    |
|           | remaining |           |           |         |    |
|           | segments  |           |           |         |    |
|           | of        |           |           |         |    |
|           | UECap     |           |           |         |    |
|           | abilityIn |           |           |         |    |
|           | formation |           |           |         |    |
|           | message   |           |           |         |    |
|           | and does  |           |           |         |    |
|           | not send  |           |           |         |    |
|           | any       |           |           |         |    |
|           | ULDedic   |           |           |         |    |
|           | atedMessa |           |           |         |    |
|           | geSegment |           |           |         |    |
|           | message   |           |           |         |    |
|           | in the    |           |           |         |    |
|           | next 5    |           |           |         |    |
|           | seconds?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| T~DL~ is  |           |           |           |         |    |
| the delay |           |           |           |         |    |
| in slots  |           |           |           |         |    |
| to the    |           |           |           |         |    |
| next      |           |           |           |         |    |
| available |           |           |           |         |    |
| DL slot   |           |           |           |         |    |
| suitable  |           |           |           |         |    |
| for the   |           |           |           |         |    |
| tra       |           |           |           |         |    |
| nsmission |           |           |           |         |    |
| of a DCI. |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 2: μ |           |           |           |         |    |
| is the    |           |           |           |         |    |
| SCS       |           |           |           |         |    |
| index. μ  |           |           |           |         |    |
| = 0/1/2/3 |           |           |           |         |    |
| for SCS = |           |           |           |         |    |
| 15kHz/    |           |           |           |         |    |
| 30kHz/60k |           |           |           |         |    |
| Hz/120kHz |           |           |           |         |    |
| resp      |           |           |           |         |    |
| ectively. |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 3:   |           |           |           |         |    |
| 15 UL     |           |           |           |         |    |
| grants of |           |           |           |         |    |
| default   |           |           |           |         |    |
| size (624 |           |           |           |         |    |
| bytes,    |           |           |           |         |    |
| using     |           |           |           |         |    |
| L~RBs~ &  |           |           |           |         |    |
| I~MCS~ as |           |           |           |         |    |
| per       |           |           |           |         |    |
| 38.5      |           |           |           |         |    |
| 23-3\[3\] |           |           |           |         |    |
| Table     |           |           |           |         |    |
| 7.1       |           |           |           |         |    |
| .2.3.3-1) |           |           |           |         |    |
| are       |           |           |           |         |    |
| chosen to |           |           |           |         |    |
| enable UE |           |           |           |         |    |
| to        |           |           |           |         |    |
| transmit  |           |           |           |         |    |
| only one  |           |           |           |         |    |
| ulDedic   |           |           |           |         |    |
| atedMessa |           |           |           |         |    |
| geSegment |           |           |           |         |    |
| as        |           |           |           |         |    |
| maximum   |           |           |           |         |    |
| PDCP SDU  |           |           |           |         |    |
| size 9000 |           |           |           |         |    |
| bytes.    |           |           |           |         |    |
| PDCP is   |           |           |           |         |    |
| segmented |           |           |           |         |    |
| into      |           |           |           |         |    |
| several   |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| Segments. |           |           |           |         |    |
| Each MAC  |           |           |           |         |    |
| TB        |           |           |           |         |    |
| contains  |           |           |           |         |    |
| 3 bytes   |           |           |           |         |    |
| of MAC    |           |           |           |         |    |
| header +  |           |           |           |         |    |
| 2 bytes   |           |           |           |         |    |
| of Short  |           |           |           |         |    |
| BSR + 3   |           |           |           |         |    |
| bytes of  |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| Header +  |           |           |           |         |    |
| Payload   |           |           |           |         |    |
| of        |           |           |           |         |    |
| Segmented |           |           |           |         |    |
| RLC SDU.  |           |           |           |         |    |
| A         |           |           |           |         |    |
| dditional |           |           |           |         |    |
| 8 bytes   |           |           |           |         |    |
| are       |           |           |           |         |    |
| required  |           |           |           |         |    |
| in each   |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| segment.  |           |           |           |         |    |
| 15 grants |           |           |           |         |    |
| provide   |           |           |           |         |    |
| (15\*     |           |           |           |         |    |
| 624=9360) |           |           |           |         |    |
| which is  |           |           |           |         |    |
| s         |           |           |           |         |    |
| ufficient |           |           |           |         |    |
| to        |           |           |           |         |    |
| ac        |           |           |           |         |    |
| commodate |           |           |           |         |    |
| 9000      |           |           |           |         |    |
| bytes and |           |           |           |         |    |
| RLC/MAC   |           |           |           |         |    |
| header    |           |           |           |         |    |
| and MAC   |           |           |           |         |    |
| CE.       |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.5.9.1.3.3 Specific message contents {#specific-message-contents-23 .H6}

Table 8.1.5.9.1.3.3-0: *CellGroupConfig* (preamble)

  ---------------------------------------------------- ------------------ ------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19                                    
  **Information Element**                              **Value/remark**   **Comment**   **Condition**
  CellGroupConfig ::= SEQUENCE {                                                        
  rlf-TimersAndConstants SEQUENCE {                                                     
  t311-v1530                                           ms10000                          
  }                                                                                     
  }                                                                                     
  ---------------------------------------------------- ------------------ ------------- ---------------

Table 8.1.5.9.1.3.3-1: *UECapabilityEnquiry* (step 1, 2b4 and step 4,
Table 8.1.5.9.1.3.2-3)

  -------------------------------------------------------------------------------------------------------------- ------------------------------------------------------- -------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-31                                                                                                                                                                              
  Information Element                                                                                            Value/remark                                            Comment                                                  Condition
  UECapabilityEnquiry ::= SEQUENCE {                                                                                                                                                                                              
  rrc-TransactionIdentifier                                                                                      RRC-TransactionIdentifier                                                                                        
  criticalExtensions CHOICE {                                                                                                                                                                                                     
  ueCapabilityEnquiry SEQUENCE {                                                                                                                                                                                                  
  ue-CapabilityRAT-RequestList SEQUENCE (SIZE (1.. maxRAT-CapabilityContainers)) OF UE-CapabilityRAT-Request {   2 entries                                                                                                        
  UE-CapabilityRAT-Request\[1\] SEQUENCE {                                                                                                                               entry 1                                                  
  rat-Type                                                                                                       nr                                                                                                               
  capabilityRequestFilter                                                                                        UE-CapabilityRequestFilterNR                            OCTET STRING (CONTAINING UE-CapabilityRequestFilterNR)   
  }                                                                                                                                                                                                                               
  UE-CapabilityRAT-Request\[2\] SEQUENCE {                                                                                                                               entry 2                                                  
  rat-Type                                                                                                       eutra-nr                                                                                                         
  capabilityRequestFilter                                                                                        UE-CapabilityRequestFilterNR                            OCTET STRING (CONTAINING UE-CapabilityRequestFilterNR)   
  }                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                               
  lateNonCriticalExtension                                                                                       Not present                                                                                                      
  ue-CapabilityEnquiryExt                                                                                        OCTET STRING Containing UECapabilityEnquiry-v1560-IEs                                                            
  }                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                               
  -------------------------------------------------------------------------------------------------------------- ------------------------------------------------------- -------------------------------------------------------- -----------

Table 8.1.5.9.1.3.3-2: *UE-CapabilityRequestFilterNR* (Table
8.1.5.9.1.3.3-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.4-47                            
  Information Element                                  Value/remark   Comment   Condition
  UE-CapabilityRequestFilterNR ::= SEQUENCE {                                   
  frequencyBandListFilter                              FreqBandList             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.5.9.1.3.3-3: ***FreqBandList*** (Table 8.1.5.9.1.3.3-2)

  ---------------------------------------------------------------------------- --------------------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.4-21                                                                                                                                                                                                                                                                                              
  Information Element                                                          Value/remark          Comment                                                                                                                                                                                                                                      Condition
  FreqBandList::= SEQUENCE (SIZE (1..maxBandsMRDC)) OF FreqBandInformation {   43 entries            FreqBandIndicatorNR = n1, n2, n3, n5, n7, n8, n12, n14, n20, n25, n26, n28, n29, n30, n34, n38, n39, n40, n41, n48, n50, n51, n53, n65, n66, n70, n71, n74, n75, n76, n77, n78, n79, n80, n81, n82, n83, n84, n86, n257, n258, n260, n261.   
  FreqBandInformation\[n\] CHOICE {                                                                  entry n                                                                                                                                                                                                                                      
  bandInformationNR SEQUENCE {                                                                                                                                                                                                                                                                                                                    
  bandNR                                                                       FreqBandIndicatorNR                                                                                                                                                                                                                                                
  maxBandwidthRequestedDL                                                      Not present                                                                                                                                                                                                                                                        
  maxBandwidthRequestedUL                                                      Not present                                                                                                                                                                                                                                                        
  maxCarriersRequestedDL                                                       Not present                                                                                                                                                                                                                                                        
  maxCarriersRequestedUL                                                       Not present                                                                                                                                                                                                                                                        
  }                                                                                                                                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                                                                                                                                               
  ---------------------------------------------------------------------------- --------------------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -----------

Table 8.1.5.9.1.3.3-4: *UECapabilityEnquiry-v1560-IEs* (Table
8.1.5.9.1.3.3-1)

  ---------------------------------------------- -------------- --------- -----------
  Information Element                            Value/remark   Comment   Condition
  UECapabilityEnquiry-v1560-IEs ::= SEQUENCE {                            
  capabilityRequestFilterCommon                  Not present              
  nonCriticalExtension SEQUENCE {                                         
  rrc-SegAllowed-r16                             enabled                  
  nonCriticalExtension                           Not present              
  }                                                                       
  }                                                                       
  ---------------------------------------------- -------------- --------- -----------

Table 8.1.5.9.1.3.3-5: ULDedicatedMessageSegment (step 2a1, 2b5 and step
6, Table 8.1.5.9.1.3.2-3)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.1-32C |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ULDedicatedMes  |                 |                 |           |
| sageSegment-r16 |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| se              | 0 for first     |                 |           |
| gmentNumber-r16 | segment, and    |                 |           |
|                 | incremented by  |                 |           |
|                 | 1 for each      |                 |           |
|                 | subsequent      |                 |           |
|                 | segment         |                 |           |
+-----------------+-----------------+-----------------+-----------+
| r               | Not Checked     | OCTET STRING    |           |
| rc-MessageSegme |                 | Includes a      |           |
| ntContainer-r16 |                 | segment of the  |           |
|                 |                 | encoded UL DCCH |           |
|                 |                 | message. The    |           |
|                 |                 | size of the     |           |
|                 |                 | included        |           |
|                 |                 | segment in this |           |
|                 |                 | container       |           |
|                 |                 | should be small |           |
|                 |                 | enough so the   |           |
|                 |                 | resulting       |           |
|                 |                 | encoded RRC     |           |
|                 |                 | message PDU is  |           |
|                 |                 | less than or    |           |
|                 |                 | equal to the    |           |
|                 |                 | PDCP SDU size   |           |
|                 |                 | limit           |           |
+-----------------+-----------------+-----------------+-----------+
| rrc-Message     | *               |                 |           |
| SegmentType-r16 | notLastSegment* |                 |           |
|                 | for all         |                 |           |
|                 | segments except |                 |           |
|                 | the last        |                 |           |
|                 | segment.        |                 |           |
|                 |                 |                 |           |
|                 | *lastSegment*   |                 |           |
|                 | for the last    |                 |           |
|                 | segment         |                 |           |
+-----------------+-----------------+-----------------+-----------+
| lateNonCr       | Not present     |                 |           |
| iticalExtension |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| nonCr           | Not present     |                 |           |
| iticalExtension |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.9.1.3.3-6: *UECapabilityInformation* (step 2b1, Table
8.1.5.9.1.3.2-3)

  --------------------------------------------------------------------------------------------------------- ---------------------- ------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32                                                                                                                                       
  Information Element                                                                                       Value/remark           Comment                                                 Condition
  UECapabilityInformation ::= SEQUENCE {                                                                                                                                                   
  criticalExtensions CHOICE {                                                                                                                                                              
  ueCapabilityInformation SEQUENCE {                                                                                                                                                       
  ue-CapabilityRAT-ContainerList SEQUENCE (SIZE (1..maxRAT-Capabilities)) OF UE-CapabilityRAT-Container {   1 entry or 2 entries   1 entry if EN-DC is not supported otherwise 2 entries   
  UE-CapabilityRAT- Container\[1\] SEQUENCE {                                                                                      entry 1                                                 
  rat-Type                                                                                                  nr                                                                             
  ueCapabilityRAT-Container                                                                                 UE-NR-Capability       Encoded as per TS 38.331 \[12\] clause 5.6.1            
  }                                                                                                                                                                                        
  UE-CapabilityRAT- Container\[2\] SEQUENCE {                                                                                      entry 2                                                 EN-DC
  rat-Type                                                                                                  eutra-nr                                                                       
  ueCapabilityRAT-Container                                                                                 UE-MRDC-Capability     Encoded as per TS 38.331 \[12\] clause 5.6.1            
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  }                                                                                                                                                                                        
  --------------------------------------------------------------------------------------------------------- ---------------------- ------------------------------------------------------- -----------

Table 8.1.5.9.1.3.3-7: *RRCReconfiguration* (step 12A, Table
8.1.5.9.1.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

##### 8.1.5.9.2 RRC reconfiguration / DL segment transfer

##### 8.1.5.9.2.1 Test Purpose (TP) {#test-purpose-tp-24 .H6}

##### (1) {#section-38 .H6}

**with** { UE having completed the RRC connection establishment
procedure}

**ensure that** {

**when** { SS initiates the DL Dedicated Message Segment transfer
procedure to send an *RRCReconfiguration* message to establish a DRB and
SRB2}

**then** { UE successfully completes the reconfiguration }

}

##### (2) {#section-39 .H6}

**with** { UE in NR RRC\_CONNECTED state with SRB2 and has previously
received the first and second segment of an *RRCReconfiguration* message
including SRB2 configuration }

**ensure that** {

**when** { SS releases the RRC connection }

**then** { UE discards all segments }

}

##### 8.1.5.9.2.2 Conformance requirements {#conformance-requirements-24 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.11 and 5.7.6.3. Unless otherwise
stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.11\]

The UE shall:

\...

1\> discard any segments of segmented RRC messages stored according to
5.7.6.3;

\[TS 38.331, clause 5.7.6.3\]

Upon receiving *DLDedicatedMessageSegment* message, the UE shall:

1\> store the segment included in *rrc-MessageSegmentContainer*;

1\> if all segments of the message have been received:

2\> assemble the message from the received segments and process the
message according to 5.3.5.3 for the *RRCReconfiguration* message or
5.3.13.4 for the *RRCResume* message;

2\> discard all segments.

##### 8.1.5.9.2.3 Test description {#test-description-24 .H6}

##### 8.1.5.9.2.3.1 Pre-test conditions {#pre-test-conditions-24 .H6}

##### System Simulator: {#system-simulator-16 .H6}

\- NR Cell 1

##### UE: {#ue-13 .H6}

\- None

##### Preamble: {#preamble-14 .H6}

\- If pc\_IP\_Ping is set to TRUE then the UE is in 5GS state 1N-A, PDU
SESSION ACTIVE according to TS 38.508-1 \[4\], clause 4.4A.2 Table
4.4A.2-1

\- Else, the UE is in 5GS state 1N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.5.9.2.3.2 Test procedure sequence {#test-procedure-sequence-24 .H6}

Table 8.1.5.9.2.3.2-1: Main behaviour

  St                                                                                      Procedure                                                                                                                                                                                                                                                        Message Sequence   TP                                     Verdict   
  --------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                                                                                                                                                                                           U - S              Message                                          
  1                                                                                       SS transmits a *Paging* message to the UE on the appropriate paging block, and including the UE identity in one entry of the IE *pagingRecordList*.                                                                                                              \<\--              NR RRC: *Paging*                       \-        \-
  2                                                                                       UE transmits an *RRCSetupRequest* message.                                                                                                                                                                                                                       \--\>              NR RRC: *RRCSetupRequest*              \-        \-
  3                                                                                       SS transmits an *RRCSetup* message                                                                                                                                                                                                                               \<\--              NR RRC: *RRCSetup*                     \-        \-
  4                                                                                       The UE transmits an *RRCSetupComplete* to confirm the successful completion of the connection establishment.                                                                                                                                                     \--\>              NR RRC: *RRCSetupComplete*             \-        \-
  5                                                                                       SS transmits a *SecurityModeCommand* message to activate AS security.                                                                                                                                                                                            \<\--              NR RRC: *SecurityModeCommand*          \-        \-
  6                                                                                       Using the same slot as the *SecurityModeCommand* message in step 5, the SS transmits an *DLDedicatedMessageSegment* containing the first segment of the *RRCReconfiguration* message to establish a data radio bearer, DRB1 and signalling radio bearer, SRB2.   \<\--              NR RRC: *DLDedicatedMessageSegment*    \-        \-
  7                                                                                       The UE transmits a *SecurityModeComplete* message.                                                                                                                                                                                                               \--\>              NR RRC: *SecurityModeComplete*         \-        \-
  8                                                                                       The SS transmits a *DLDedicatedMessageSegment* containing the second(last) segment of the *RRCReconfiguration* message.                                                                                                                                          \<\--              NR RRC: *DLDedicatedMessageSegment*    \-        \-
  9                                                                                       Check: Does the UE transmit an *RRCReconfigurationComplete* message to confirm the establishment of data radio bearer, DRB1 and signalling radio bearer, SRB2?                                                                                                   \--\>              NR RRC: *RRCReconfigurationComplete*   1         P
  10                                                                                      Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB\#1 established in Step 8?                                                                                \-                 *-*                                    1         \-
  11                                                                                      The SS transmits a *DLDedicatedMessageSegment* containing the first segment of the *RRCReconfiguration* message *to modify* SRB and DRB configuration.                                                                                                           \<\--              NR RRC: DLDedicatedMessageSegment                
  12                                                                                      The SS transmits the second segment of the *RRCReconfiguration* message *to modify* SRB and DRB configuration.                                                                                                                                                   \<\--              NR RRC: DLDedicatedMessageSegment      \-        \-
  13                                                                                      The SS releases the RRC connection.                                                                                                                                                                                                                              \-                 \-                                     \-        \-
  14                                                                                      Step 1-8 of generic test procedure in TS 38.508-1 \[4\] subclause 4.5.4 to bring the UE in RRC\_CONNECTED mode.                                                                                                                                                  \-                 \-                                     \-        \-
  15                                                                                      The SS transmits the third(last) segment of the *RRCReconfiguration* message *to modify* SRB2 and DRB configuration.                                                                                                                                             \<\--              NR RRC: DLDedicatedMessageSegment      \-        \-
  16                                                                                      Check: Does the UE transmit an *RRCReconfigurationComplete* message in the next 3s?                                                                                                                                                                              \--\>              NR RRC: *RRCReconfigurationComplete*   2         F
  17                                                                                      The SS releases the RRC connection.                                                                                                                                                                                                                              \-                 \-                                     \-        \-
  18                                                                                      Step 1-8 of generic test procedure in TS 38.508-1 \[4\] subclause 4.5.4 to bring the UE in RRC\_CONNECTED mode.                                                                                                                                                  \-                 \-                                     \-        \-
  19                                                                                      The SS transmits a *DLDedicatedMessageSegment* containing the first segment of the *RRCReconfiguration* message *to modify* SRB and DRB configuration.                                                                                                                              NR RRC: DLDedicatedMessageSegment                
  20                                                                                      The SS transmits the second segment of the *RRCReconfiguration* message *to modify* SRB and DRB configuration.                                                                                                                                                   \<\--              NR RRC: DLDedicatedMessageSegment      \-        \-
  21                                                                                      The SS transmits the third(last) segment of the *RRCReconfiguration* message *to modify* SRB2 and DRB configuration.                                                                                                                                             \<\--              NR RRC: DLDedicatedMessageSegment      \-        \-
  22                                                                                      Check: Does the UE transmit an *RRCReconfigurationComplete* message in the next 3s?                                                                                                                                                                              \--\>              NR RRC: *RRCReconfigurationComplete*   1         P
  23                                                                                      Check: Does the test result of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.1 indicate that the UE is capable of exchanging IP data on DRB\#1 established in Steps 12-21?                                                                           \-                 *-*                                    1         
  24-27                                                                                   Void                                                                                                                                                                                                                                                                                                                                 
  NOTE 1: The request to establish a PDU session may be performed by MMI or AT Command.                                                                                                                                                                                                                                                                                                                                        

##### 8.1.5.9.2.3.3 Specific message contents {#specific-message-contents-24 .H6}

Table 8.1.5.9.2.3.3-1: DLDedicatedMessageSegment (Step 6, 8, 11, 12, 15,
19, 20 and 21, Table 8.1.5.9.2.3.2-1)

  --------------------------------------------------- ---------------------------------------------------------------------------------- ----------------------- --------------------------------------------
  Derivation Path: TS 38.508-1\[4\], table 4.6.1-2B                                                                                                              
  Information Element                                 Value/remark                                                                       Comment                 Condition
  DLDedicatedMessageSegment-r16 ::= SEQUENCE {                                                                                                                   
  criticalExtensions CHOICE {                                                                                                                                    
  dlDedicatedMessageSegment-r16 SEQUENCE {                                                                                                                       
  segmentNumber-r16                                   0                                                                                                          Step 6, Step 11, Step 19
  segmentNumber-r16                                   1                                                                                                          Step 8, Step 12, Step 20
  segmentNumber-r16                                   2                                                                                                          Step 15, Step 21
  rrc-MessageSegmentContainer-r16                     OCTET STRING (CONTAINING First segment of the RRCReconfiguration message)          Table 8.1.5.9.2.3.3-2   Step 6
  rrc-MessageSegmentContainer-r16                     OCTET STRING (CONTAINING Last segment of the RRCReconfiguration message)           Table 8.1.5.9.2.3.3-2   Step 8
  rrc-MessageSegmentContainer-r16                     OCTET STRING (CONTAINING First segment of the RRCReconfiguration message)          Table 8.1.5.9.2.3.3-4   Step 11, Step 19
  rrc-MessageSegmentContainer-r16                     OCTET STRING (CONTAINING Second segment of the RRCReconfiguration message)         Table 8.1.5.9.2.3.3-4   Step 12, Step 20
  rrc-MessageSegmentContainer-r16                     OCTET STRING (CONTAINING Last (third) segment of the RRCReconfiguration message)   Table 8.1.5.9.2.3.3-4   Step 15, Step 21
  rrc-MessageSegmentType-r16                          notLastSegment                                                                                             Step 6, Step 11, Step 19, Step 12, Step 20
  rrc-MessageSegmentType-r16                          LastSegment                                                                                                Step 8, Step 15, Step 21
  }                                                                                                                                                              
  }                                                                                                                                                              
  }                                                                                                                                                              
  --------------------------------------------------- ---------------------------------------------------------------------------------- ----------------------- --------------------------------------------

Table 8.1.5.9.2.3.3-2: RRCReconfiguration (Step 6 and 8, Table
8.1.5.9.2.3.3-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1\[4\],  |                 |                 |           |
| table 4.6.1-13  |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| RRC             |                 |                 |           |
| Reconfiguration |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rrc             |                 |                 |           |
| Reconfiguration |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ra              | Ra              |                 |           |
| dioBearerConfig | dioBearerConfig |                 |           |
|                 | with conditions |                 |           |
|                 | SRB2 and DRB1   |                 |           |
+-----------------+-----------------+-----------------+-----------+
| nonCr           |                 |                 |           |
| iticalExtension |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| masterCellGroup | CellGroupConfig | OCTET STRING    |           |
|                 |                 | (CONTAINING     |           |
|                 |                 | CellGroupConfig |           |
|                 |                 | Table           |           |
|                 |                 | 8               |           |
|                 |                 | .1.5.9.2.3.3-3) |           |
+-----------------+-----------------+-----------------+-----------+
| lateNonCr       | \'00,,,00\'O    | Add enough      |           |
| iticalExtension |                 | padding so      |           |
|                 |                 | that:           |           |
|                 |                 |                 |           |
|                 |                 | maximum PDCP    |           |
|                 |                 | SDU size \<     |           |
|                 |                 |                 |           |
|                 |                 | encoded         |           |
|                 |                 | DLDedicate      |           |
|                 |                 | dMessageSegment |           |
|                 |                 | size \< 2 x     |           |
|                 |                 | maximum PDCP    |           |
|                 |                 | SDU size        |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.9.2.3.3-3: CellGroupConfig (Table 8.1.5.9.2.3.3-2)

  --------------------------------------------------------------------------- --------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1\[4\], table 4.6.3-19                                                                                                                 
  Information Element                                                         Value/remark                                                                Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                                    
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLC-ID)) OF RLC-BearerConfig {   2 entries                                                                             
  RLC-Bearer-Config\[1\] SEQUENCE {                                                                                                                       entry 1   
  logicalChannelIdentity                                                      LogicalChannelIdentity                                                                
  servedRadioBearer CHOICE {                                                                                                                                        
  drb-Identity                                                                DRB-Identity with condition DRB1                                                      
  }                                                                                                                                                                 
  reestablishRLC                                                              Not present                                                                           
  RLC-Config                                                                  RLC-Config with condition AM according to 38.508-1 \[4\], table 4.6.3-149             
  mac-LogicalChannelConfig                                                    LogicalChannelConfig according to 38.508-1 \[4\], table 4.6.3-66                      
  }                                                                                                                                                                 
  RLC-Bearer-Config\[2\] SEQUENCE {                                                                                                                       entry 2   
  logicalChannelIdentity                                                      LogicalChannelIdentity                                                                
  servedRadioBearer CHOICE {                                                                                                                                        
  srb-Identity                                                                SRB-Identity with condition SRB2                                                      
  }                                                                                                                                                                 
  reestablishRLC                                                              Not present                                                                           
  RLC-Config                                                                  Not present                                                                           
  mac-LogicalChannelConfig                                                    LogicalChannelConfig according to 38.508-1 \[4\], table 4.6.3-66                      
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  mac-CellGroupConfig                                                         Not present                                                                           
  physicalCellGroupConfig                                                     Not present                                                                           
  spCellConfig SEQUENCE                                                       Not present                                                                           
  }                                                                                                                                                                 
  --------------------------------------------------------------------------- --------------------------------------------------------------------------- --------- -----------

Table 8.1.5.9.2.3.3-4: RRCReconfiguration (Step 11, 12, 15, 19, 20 and
21, Table 8.1.5.9.2.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1\[4\],  |                 |                 |           |
| table 4.6.1-13  |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| RRC             |                 |                 |           |
| Reconfiguration |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rrc             |                 |                 |           |
| Reconfiguration |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| nonCr           |                 |                 |           |
| iticalExtension |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| masterCellGroup | CellGroupConfig | OCTET STRING    |           |
|                 |                 | (CONTAINING     |           |
|                 |                 | CellGroupConfig |           |
|                 |                 | Table           |           |
|                 |                 | 8               |           |
|                 |                 | .1.5.9.2.3.3-5) |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| lateNonCr       | \'00,,,00\'O    | Add enough      |           |
| iticalExtension |                 | padding so that |           |
|                 |                 | the size of the |           |
|                 |                 |                 |           |
|                 |                 | encoded         |           |
|                 |                 | DLDedicate      |           |
|                 |                 | dMessageSegment |           |
|                 |                 | = 3 x maximum   |           |
|                 |                 | PDCP SDU size   |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.9.2.3.3-5: CellGroupConfig (Table 8.1.5.9.2.3.3-3)

  Derivation Path: TS 38.508-1, table 4.6.3-19                                                                                                                      
  --------------------------------------------------------------------------- --------------------------------------------------------------------------- --------- -----------
  Information Element                                                         Value/remark                                                                Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                                    
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLC-ID)) OF RLC-BearerConfig {   2 entries                                                                             
  RLC-Bearer-Config\[1\] SEQUENCE {                                                                                                                       entry 1   
  logicalChannelIdentity                                                      LogicalChannelIdentity                                                                
  servedRadioBearer CHOICE {                                                                                                                                        
  srb-Identity                                                                SRB-Identity with condition SRB2                                                      
  }                                                                                                                                                                 
  reestablishRLC                                                              true                                                                                  
  RLC-Config                                                                  RLC-Config with condition AM according to 38.508-1 \[4\], table 4.6.3-149             
  mac-LogicalChannelConfig                                                    LogicalChannelConfig according to 38.508-1 \[4\], table 4.6.3-66                      
  }                                                                                                                                                                 
  RLC-Bearer-Config\[2\] SEQUENCE {                                                                                                                       entry 2   
  logicalChannelIdentity                                                      LogicalChannelIdentity                                                                
  servedRadioBearer CHOICE {                                                                                                                                        
  drb-Identity                                                                DRB-Identity with condition DRB1                                                      
  }                                                                                                                                                                 
  reestablishRLC                                                              true                                                                                  
  RLC-Config                                                                  Not present                                                                           
  mac-LogicalChannelConfig                                                    LogicalChannelConfig according to 38.508-1 \[4\], table 4.6.3-66                      
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  mac-CellGroupConfig                                                         Not present                                                                           
  physicalCellGroupConfig                                                     Not present                                                                           
  spCellConfig SEQUENCE                                                       Not present                                                                           
  }                                                                                                                                                                 

##### 8.1.5.9.3 RRC resume / DL segment transfer

##### 8.1.5.9.3.1 Test Purpose (TP) {#test-purpose-tp-25 .H6}

##### (1) {#section-40 .H6}

**with** { UE in NR RRC\_INACTIVE state, having sent an RRCResumeRequest
message with resumeIdentity set to the stored shortI-RNTI value }

**ensure that** {

**when** { SS initiates the DL Dedicated Message Segment transfer
procedure to send an *RRCResume* message }

**then** { UE successfully re-establishes the DRB and SRB}

}

##### (2) {#section-41 .H6}

**with** { UE in NR RRC\_INACTIVE state, having sent an RRCResumeRequest
message with resumeIdentity set to the stored fullI-RNTI value }

**ensure that** {

**when** { SS initiates the DL Dedicated Message Segment transfer
procedure to send an *RRCResume* message }

**then** { UE successfully re-establishes the DRB and SRB}

}

##### 8.1.5.9.3.2 Conformance requirements {#conformance-requirements-25 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.7.6.3. Unless otherwise stated these
are Rel-15 requirements.

\[TS 38.331, clause 5.7.6.3\]

Upon receiving *DLDedicatedMessageSegment* message, the UE shall:

1\> store the segment included in *rrc-MessageSegmentContainer*;

1\> if all segments of the message have been received:

2\> assemble the message from the received segments and process the
message according to 5.3.5.3 for the *RRCReconfiguration* message or
5.3.13.4 for the *RRCResume* message;

2\> discard all segments.

##### 8.1.5.9.3.3 Test Description {#test-description-25 .H6}

##### 8.1.5.9.3.3.1 Pre-test conditions {#pre-test-conditions-25 .H6}

##### System Simulator: {#system-simulator-17 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used.

##### UE: {#ue-14 .H6}

\- None.

##### Preamble: {#preamble-15 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 2N-A
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 2N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.5.9.3.3.2 Test procedure sequence {#test-procedure-sequence-25 .H6}

Table 8.1.5.9.3.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | a matched |           |           |         |    |
|           | identity  |           |           |         |    |
|           | (correct  |           |           |         |    |
|           | *full     |           |           |         |    |
|           | I-RNTI*). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmit  |           | *RRCResum |         |    |
|           | an        |           | eRequest* |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | by        |           |           |         |    |
|           | setting   |           |           |         |    |
|           | *resume   |           |           |         |    |
|           | Identity* |           |           |         |    |
|           | to the    |           |           |         |    |
|           | stored    |           |           |         |    |
|           | *sho      |           |           |         |    |
|           | rtI-RNTI* |           |           |         |    |
|           | value.    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *DLDedica |         |    |
|           | a         |           | tedMessag |         |    |
|           | *DLDedica |           | eSegment* |         |    |
|           | tedMessag |           |           |         |    |
|           | eSegment* |           |           |         |    |
|           | c         |           |           |         |    |
|           | ontaining |           |           |         |    |
|           | the first |           |           |         |    |
|           | segment   |           |           |         |    |
|           | of the 3  |           |           |         |    |
|           | segment   |           |           |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *DLDedica |         |    |
|           | a         |           | tedMessag |         |    |
|           | *DLDedica |           | eSegment* |         |    |
|           | tedMessag |           |           |         |    |
|           | eSegment* |           |           |         |    |
|           | c         |           |           |         |    |
|           | ontaining |           |           |         |    |
|           | the       |           |           |         |    |
|           | second    |           |           |         |    |
|           | segment   |           |           |         |    |
|           | of the 3  |           |           |         |    |
|           | segment   |           |           |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *DLDedica |         |    |
|           | a         |           | tedMessag |         |    |
|           | *DLDedica |           | eSegment* |         |    |
|           | tedMessag |           |           |         |    |
|           | eSegment* |           |           |         |    |
|           | c         |           |           |         |    |
|           | ontaining |           |           |         |    |
|           | the third |           |           |         |    |
|           | (last)    |           |           |         |    |
|           | segment   |           |           |         |    |
|           | of the 3  |           |           |         |    |
|           | segment   |           |           |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | Check:    | \-        | *-*       | 1       | \- |
|           | Does the  |           |           |         |    |
|           | test      |           |           |         |    |
|           | result of |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | subclause |           |           |         |    |
|           | 4.9.1     |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | UE is     |           |           |         |    |
|           | capable   |           |           |         |    |
|           | of        |           |           |         |    |
|           | e         |           |           |         |    |
|           | xchanging |           |           |         |    |
|           | IP data   |           |           |         |    |
|           | on DRB\#n |           |           |         |    |
|           | a         |           |           |         |    |
|           | ssociated |           |           |         |    |
|           | with the  |           |           |         |    |
|           | first PDU |           |           |         |    |
|           | session?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | both      |           |           |         |    |
|           | *fu       |           |           |         |    |
|           | llI-RNTI* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *sho      |           |           |         |    |
|           | rtI-RNTI* |           |           |         |    |
|           | in        |           |           |         |    |
|           | s*uspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | The SS    | \-        | *-*       | \-      | \- |
|           | changes   |           |           |         |    |
|           | the SIB1  |           |           |         |    |
|           | of NR     |           |           |         |    |
|           | Cell 1 to |           |           |         |    |
|           | set the   |           |           |         |    |
|           | *useFull  |           |           |         |    |
|           | ResumeID* |           |           |         |    |
|           | to True.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | The SS    | \<\--     | PDCCH     | \-      | \- |
|           | transmits |           | (DCI      |         |    |
|           | a Short   |           | 1\_0):    |         |    |
|           | message   |           | Short     |         |    |
|           | on PDCCH  |           | Message   |         |    |
|           | using     |           |           |         |    |
|           | P-RNTI    |           |           |         |    |
|           | i         |           |           |         |    |
|           | ndicating |           |           |         |    |
|           | a         |           |           |         |    |
|           | *system   |           |           |         |    |
|           | InfoModif |           |           |         |    |
|           | ication*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11        | Wait for  | \-        | \-        | \-      | \- |
|           | 2.1\*     |           |           |         |    |
|           | mod       |           |           |         |    |
|           | ification |           |           |         |    |
|           | period    |           |           |         |    |
|           | second    |           |           |         |    |
|           | for the   |           |           |         |    |
|           | UE to     |           |           |         |    |
|           | receive   |           |           |         |    |
|           | new       |           |           |         |    |
|           | system    |           |           |         |    |
|           | inf       |           |           |         |    |
|           | ormation. |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Paging*  |         |    |
|           | a         |           |           |         |    |
|           | *Paging*  |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | a matched |           |           |         |    |
|           | identity  |           |           |         |    |
|           | (correct  |           |           |         |    |
|           | *full     |           |           |         |    |
|           | I-RNTI*). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmit  |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Request1* |         |    |
|           | RRCResume |           |           |         |    |
|           | Request1* |           |           |         |    |
|           | message   |           |           |         |    |
|           | by        |           |           |         |    |
|           | setting   |           |           |         |    |
|           | *resume   |           |           |         |    |
|           | Identity* |           |           |         |    |
|           | to the    |           |           |         |    |
|           | stored    |           |           |         |    |
|           | *fu       |           |           |         |    |
|           | llI-RNTI* |           |           |         |    |
|           | value?    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 13        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *DLDedica |         |    |
|           | a         |           | tedMessag |         |    |
|           | *DLDedica |           | eSegment* |         |    |
|           | tedMessag |           |           |         |    |
|           | eSegment* |           |           |         |    |
|           | c         |           |           |         |    |
|           | ontaining |           |           |         |    |
|           | the first |           |           |         |    |
|           | segment   |           |           |         |    |
|           | of the 2  |           |           |         |    |
|           | segment   |           |           |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 14        | The SS    | \<\--     | NR RRC:   |         |    |
|           | transmits |           | *DLDedica |         |    |
|           | a         |           | tedMessag |         |    |
|           | *DLDedica |           | eSegment* |         |    |
|           | tedMessag |           |           |         |    |
|           | eSegment* |           |           |         |    |
|           | c         |           |           |         |    |
|           | ontaining |           |           |         |    |
|           | the       |           |           |         |    |
|           | se        |           |           |         |    |
|           | cond/last |           |           |         |    |
|           | segment   |           |           |         |    |
|           | of the 2  |           |           |         |    |
|           | segment   |           |           |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 16        | Check:    |           |           | 2       |    |
|           | Does the  |           |           |         |    |
|           | test      |           |           |         |    |
|           | result of |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | subclause |           |           |         |    |
|           | 4.9.1     |           |           |         |    |
|           | indicate  |           |           |         |    |
|           | that the  |           |           |         |    |
|           | UE is     |           |           |         |    |
|           | capable   |           |           |         |    |
|           | of        |           |           |         |    |
|           | e         |           |           |         |    |
|           | xchanging |           |           |         |    |
|           | IP data   |           |           |         |    |
|           | on DRB\#n |           |           |         |    |
|           | a         |           |           |         |    |
|           | ssociated |           |           |         |    |
|           | with the  |           |           |         |    |
|           | first PDU |           |           |         |    |
|           | session?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 17        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| The       |           |           |           |         |    |
| mod       |           |           |           |         |    |
| ification |           |           |           |         |    |
| period,   |           |           |           |         |    |
| expressed |           |           |           |         |    |
| in number |           |           |           |         |    |
| of radio  |           |           |           |         |    |
| frames =  |           |           |           |         |    |
| modif     |           |           |           |         |    |
| icationPe |           |           |           |         |    |
| riodCoeff |           |           |           |         |    |
| \*        |           |           |           |         |    |
| d         |           |           |           |         |    |
| efaultPag |           |           |           |         |    |
| ingCycle. |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.5.9.3.3.3 Specific message contents {#specific-message-contents-25 .H6}

Table 8.1.5.9.3.3.3-1: Paging (step 1, Table 8.1.5.9.3.3.2-1)

  ----------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9 with condition NR\_RRC\_RESUME
  ----------------------------------------------------------------------------------

Table 8.1.5.9.3.3.3-2: DLDedicatedMessageSegment (Step 3, 4, 5, 13 and
14, Table 8.1.5.9.3.3.2-1)

  --------------------------------------------------- ----------------------------------------------------------------------- ----------------------- -------------------------
  Derivation Path: TS 38.508-1\[4\], table 4.6.1-2B                                                                                                   
  Information Element                                 Value/remark                                                            Comment                 Condition
  DLDedicatedMessageSegment-r16 ::= SEQUENCE {                                                                                                        
  criticalExtensions CHOICE {                                                                                                                         
  dlDedicatedMessageSegment-r16 SEQUENCE {                                                                                                            
  segmentNumber-r16                                   0                                                                                               Step 3, Step 13
  segmentNumber-r16                                   1                                                                                               Step 4, Step 14
  segmentNumber-r16                                   2                                                                                               Step 5
  rrc-MessageSegmentContainer-r16                     OCTET STRING (CONTAINING First segment of the RRCResume message)        Table 8.1.5.9.3.3.3-3   Step 3, Step 13
  rrc-MessageSegmentContainer-r16                     OCTET STRING (CONTAINING Second segment of the RRCResume message)       Table 8.1.5.9.3.3.3-3   Step 4, Step 14
  rrc-MessageSegmentContainer-r16                     OCTET STRING (CONTAINING Third/Last segment of the RRCResume message)   Table 8.1.5.9.3.3.3-3   Step 5
  rrc-MessageSegmentType-r16                          notLastSegment                                                                                  Step 3, Step 4, Step 13
  rrc-MessageSegmentType-r16                          LastSegment                                                                                     Step 5, Step 14
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  --------------------------------------------------- ----------------------------------------------------------------------- ----------------------- -------------------------

Table 8.1.5.9.3.3.3-3: RRCResume (Table 8.1.5.9.3.3.3-2)

+----------------+--------------+----------------+----------------+
| Derivation     |              |                |                |
| Path: TS       |              |                |                |
| 38.508-1       |              |                |                |
| \[4\], Table   |              |                |                |
| 4.6.1-17       |              |                |                |
+----------------+--------------+----------------+----------------+
| Information    | Value/remark | Comment        | Condition      |
| Element        |              |                |                |
+----------------+--------------+----------------+----------------+
| RRCResume ::=  |              |                |                |
| SEQUENCE {     |              |                |                |
+----------------+--------------+----------------+----------------+
| crit           |              |                |                |
| icalExtensions |              |                |                |
| CHOICE {       |              |                |                |
+----------------+--------------+----------------+----------------+
| rrcResume      |              |                |                |
| SEQUENCE {     |              |                |                |
+----------------+--------------+----------------+----------------+
| lateNonCri     | \'00,,,00\'O | Add enough     | Step 3, Step   |
| ticalExtension |              | padding so     | 4, Step 5      |
|                |              | that:          |                |
|                |              |                |                |
|                |              | 2 x maximum    |                |
|                |              | PDCP SDU size  |                |
|                |              | \<             |                |
|                |              |                |                |
|                |              | encoded        |                |
|                |              | DLDedicated    |                |
|                |              | MessageSegment |                |
|                |              | size \< 3 x    |                |
|                |              | maximum PDCP   |                |
|                |              | SDU size       |                |
+----------------+--------------+----------------+----------------+
| lateNonCri     | \'00,,,00\'O | Add enough     | Step 13, Step  |
| ticalExtension |              | padding so     | 14             |
|                |              | that:          |                |
|                |              |                |                |
|                |              | maximum PDCP   |                |
|                |              | SDU size \<    |                |
|                |              |                |                |
|                |              | encoded        |                |
|                |              | DLDedicated    |                |
|                |              | MessageSegment |                |
|                |              | size \< 2 x    |                |
|                |              | maximum PDCP   |                |
|                |              | SDU size       |                |
+----------------+--------------+----------------+----------------+
| }              |              |                |                |
+----------------+--------------+----------------+----------------+
| }              |              |                |                |
+----------------+--------------+----------------+----------------+
| }              |              |                |                |
+----------------+--------------+----------------+----------------+

Table 8.1.5.9.3.3.3-4: RRCRelease (step 8, Table 8.1.5.9.3.3.2-1)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE
  -------------------------------------------------------------------------------------

Table 8.1.5.9.3.3.3-5: SIB1 (step 9, Table 8.1.5.9.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-28                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                           
  useFullResumeID                                      true                     
  }                                                                             

Table 8.1.5.9.3.3.3-6: Paging (step 12, Table 8.1.5.9.3.3.2-1)

  ----------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-9 with condition NR\_RRC\_RESUME
  ----------------------------------------------------------------------------------

#### 8.1.5.10 UE Assistance Information

##### 8.1.5.10.1 UE Assistance Information/ Release Preference

##### 8.1.5.10.1.1 Test Purpose (TP) {#test-purpose-tp-26 .H6}

##### (1) {#section-42 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE configured to provide its release preference and a
Preferred RRC State is provided (UE determines that it would prefer to
transition out of RRC\_CONNECTED) and timer T346f is not running }

**then** { the UE transmits a *UEAssistanceInformation mess*age }

}

##### (2) {#section-43 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE configured to provide its release preference and a
Preferred RRC State is provided (UE determines that it would prefer to
transition out of RRC\_CONNECTED) and timer T346f is running }

**then** { the UE does not transmit a *UEAssistanceInformation mess*age
}

}

##### (3) {#section-44 .H6}

**with** { UE in NR RRC\_CONNECTED state and is configured with
*connectedReporting* and having transmitted a *UEAssistanceInformation
mess*age to indicate preference to transition out of RRC\_CONNECTED
state }

**ensure that** {

**when** { UE determines that it would prefer to remain in
RRC\_CONNECTED state and timer T346f is not running }

**then** { the UE transmits a *UEAssistanceInformation mess*age }

}

##### 8.1.5.10.1.2 Conformance requirements {#conformance-requirements-26 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.5.9, 5.7.4.2 and 5.7.4.3. Unless
state explicitly these are Rel-16 requirements.

\[TS 38.331, clause 5.3.5.9\]

The UE shall:

...

1\> if the received *otherConfig* includes the
*releasePreferenceConfig*:

2\> if *releasePreferenceConfig* is set to *setup*:

3\> consider itself to be configured to provide assistance information
to transition out of RRC\_CONNECTED in accordance with 5.7.4;

2\> else:

3\> consider itself not to be configured to provide assistance
information to transition out of RRC\_CONNECTED and stop timer T346f, if
running.

\[TS 38.331, clause 5.7.4.2\]

A UE capable of providing assistance information to transition out of
RRC\_CONNECTED state may initiate the procedure if it was configured to
do so, upon determining that it prefers to transition out of
RRC\_CONNECTED state, or upon change of its preferred RRC state.

...

Upon initiating the procedure, the UE shall:

1\> if configured to provide its release preference and timer T346f is
not running:

2\> if the UE determines that it would prefer to transition out of
RRC\_CONNECTED state; or

2\> if the UE is configured with *connectedReporting* and the UE
determines that it would prefer to revert an earlier indication to
transition out of RRC\_CONNECTED state:

3\> start timer T346f with the timer value set to the
*releasePreferenceProhibitTimer*;

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide the release preference;

\[TS 38.331, clause 5.7.4.3\]

The UE shall set the contents of the *UEAssistanceInformation* message
as follows:

...

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide a release preference according to 5.7.4.2 or
5.3.5.3:

2\> include *releasePreference* in the *UEAssistanceInformation*
message;

2\> set *preferredRRC-State* to the desired RRC state on transmission of
the *UEAssistanceInformation* message;

##### 8.1.5.10.1.3 Test Description {#test-description-26 .H6}

##### 8.1.5.10.1.3.1 Pre-test conditions {#pre-test-conditions-26 .H6}

##### System Simulator: {#system-simulator-18 .H6}

\- NR Cell 1.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used for NR cell 1.

##### UE: {#ue-15 .H6}

\- None.

##### Preamble: {#preamble-16 .H6}

\- The UE is in 5GS state 3N-A on NR Cell 1 according to TS 38.508-1
\[4\], clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.5.10.1.3.2 Test procedure sequence {#test-procedure-sequence-26 .H6}

Table 8.1.5.10.1.3.2-1: Main behaviour

  St    Procedure                                                                                                                                                   Message Sequence   TP                                      Verdict   
  ----- ----------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                    U - S              Message                                           
  1     The SS transmits an RRCReconfiguration message *to configure releasePreferenceConfig with releasePreferenceProhibitTimer IE*.                               \<\--              NR RRC: *RRCReconfiguration*            \-        \-
  2     The UE transmits an RRCReconfigurationComplete message.                                                                                                     \--\>              NR RRC: *RRCReconfigurationComplete*    \-        \-
  3     The SS transmits an SET UAI REQUEST message *indicating* Preferred RRC State = 'idle'.                                                                      \<\--              **SET UAI REQUEST**                     \-        \-
  \-    EXCEPTION: Step 4 and 5 can be performed in any order.                                                                                                      \-                 **-**                                   \-        \-
  4     The UE transmits an SET UAI RESPONSE message.                                                                                                               \--\>              SET UAI RESPONSE                        \-        \-
  5     Check: Does the UE transmit an *UEAssistanceInformation* message to indicate IE preferredRRC-State-r16 = 'idle' within the ReleasePreference-r16 IE?        \--\>              **NR RRC: *UEAssistanceInformation***   1         P
  6     SS starts timer T346f = 30s.                                                                                                                                \-                 **-**                                   \-        \-
  7     The SS transmits an SET UAI REQUEST message *indicating* Preferred RRC State = 'inactive'.                                                                  \<\--              **SET UAI REQUEST**                     \-        \-
  8     The UE transmits an SET UAI RESPONSE message.                                                                                                               \--\>              SET UAI RESPONSE                        \-        \-
  9     Check: Does the UE transmit an *UEAssistanceInformation* message to indicate IE preferredRRC-State-r16 = 'inactive' within the ReleasePreference-r16 IE?    \--\>              **NR RRC: *UEAssistanceInformation***   2         F
  10    SS waits for timer T346f expiry.                                                                                                                            \-                 **-**                                   \-        \-
  \-    EXCEPTION: Step 10a may be performed if the UE cached the preferredRRC-State indication from upper layers.                                                                                                                       
  10a   The UE transmit an *UEAssistanceInformation* message to indicate IE preferredRRC-State-r16 = 'inactive' within the ReleasePreference-r16 IE.                \--\>              **NR RRC: *UEAssistanceInformation***   \-        \-
  11    The SS transmits an SET UAI REQUEST message *indicating* Preferred RRC State = connected.                                                                   \<\--              **SET UAI REQUEST**                     \-        \-
  12    The UE transmits an SET UAI RESPONSE message.                                                                                                               \--\>              SET UAI RESPONSE                        \-        \-
  13    Check: Does the UE transmit an *UEAssistanceInformation* message to indicate IE preferredRRC-State-r16 = 'connected' within the ReleasePreference-r16 IE?   \--\>              **NR RRC: *UEAssistanceInformation***   3         F
  14    The SS transmits an RRCReconfiguration message *to configure releasePreferenceConfig with connectedReporting*.                                              \<\--              NR RRC: *RRCReconfiguration*            \-        \-
  15    The UE transmits an RRCReconfigurationComplete message.                                                                                                     \--\>              NR RRC: *RRCReconfigurationComplete*    \-        \-
  16    The SS transmits an SET UAI REQUEST message *indicating* Preferred RRC State = 'connected'.                                                                 \<\--              **SET UAI REQUEST**                     \-        \-
  \-    EXCEPTION: Step 18 and 19 can be performed in any order.                                                                                                    \-                 **-**                                   \-        \-
  17    The UE transmits an SET UAI RESPONSE message.                                                                                                               \--\>              SET UAI RESPONSE                        \-        \-
  18    Check: Does the UE transmit an *UEAssistanceInformation* message to indicate IE preferredRRC-State-r16 = 'connected' within the ReleasePreference-r16?      \--\>              **NR RRC: *UEAssistanceInformation***   3         P

##### 8.1.5.10.1.3.3 Specific message contents {#specific-message-contents-26 .H6}

Table 8.1.5.10.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.5.10.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                  
  rrcReconfiguration SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  otherConfig-v1610 SEQUENCE {                                                 
  releasePreferenceConfig-r16 CHOICE {                                         
  setup SEQUENCE {                                                             
  releasePreferenceProhibitTimer-r16                  s30                      
  connectedReporting                                  Not present              
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.5.10.1.3.3-2: *UEAssistanceInformation* (Step 5, step 10a and
step 18, Table 8.1.5.10.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                  
  ueAssistanceInformation SEQUENCE {                                           
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  releasePreference-r16 SEQUENCE {                                             
  preferredRRC-State-r16                              idle                     Step 5
                                                      inactive                 Step 10a
                                                      connected                Step 18
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.5.10.1.3.3-3: *RRCReconfiguration* (step 14, Table
8.1.5.10.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                  
  rrcReconfiguration SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  otherConfig-v1610 SEQUENCE {                                                 
  releasePreferenceConfig-r16 CHOICE {                                         
  setup SEQUENCE {                                                             
  releasePreferenceProhibitTimer-r16                  s30                      
  connectedReporting                                  true                     
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

##### 8.1.5.10.2 UE Assistance Information / MUSIM

##### 8.1.5.10.2.1 Test Purpose (TP) {#test-purpose-tp-27 .H6}

##### (1) {#section-45 .H6}

**with** { UE in NR RRC\_CONNECTED state}

**ensure that** {

**when** { UE configured to provide MUSIM assistance information for
leaving RRC\_CONNECTED and timer T346g is not running }

**then** { The UE transmits a UEAssistanceInformation message }

}

##### (2) {#section-46 .H6}

**with** { UE in NR RRC\_CONNECTED state}

**ensure that** {

**when** { UE configured to provide MUSIM assistance information for
leaving RRC\_CONNECTED and timer T346g is running }

**then** { the UE Dose NOT transmit a UEAssistanceInformation message }

}

##### (3) {#section-47 .H6}

**with** { UE in NR RRC\_CONNECTED state}

**ensure that** {

**when** { UE configured to provide MUSIM assistance information without
leaving RRC\_CONNECTED and the current musim-GapPreferenceList is
different from the one indicated in the last transmission of the
UEAssistanceInformation message including musim-GapPreferenceList }

**then** { The UE transmits a UEAssistanceInformation message }

}

##### 8.1.5.10.2.2 Conformance requirements {#conformance-requirements-27 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.7.4.1, 5.7.4.2, 5.7.4.3.

\[TS 38.331, clause 5.3.5.9\]

The UE shall:

...

1\> if the received *otherConfig* includes the
*musim-GapAssistanceConfig*:

2\> if *musim-GapAssistanceConfig* is set to *setup*:

3\> consider itself to be configured to provide MUSIM assistance
information for gap preference in accordance with 5.7.4*;*

2\> else:

3\> consider itself not to be configured to provide MUSIM assistance
information for gap preference and stop timer T346h, if running*;*

1\> if the received *otherConfig* includes the
*musim-LeaveAssistanceConfig:*

2\> if *musim-LeaveAssistanceConfig* is set to *setup*:

3\> consider itself to be configured to provide MUSIM assistance
information for leaving RRC\_CONNECTED in accordance with 5.7.4*;*

2\> else:

3\> consider itself not to be configured to provide MUSIM assistance
information for leaving RRC\_CONNECTED and stop timer T346g, if running.

\[TS 38.331, clause 5.7.4.1\]

![文本
低可信度描述已自动生成](./media/image2.png){width="2.798611111111111in"
height="1.4583333333333333in"}

Figure 5.7.4.1-1: UE Assistance Information

The purpose of this procedure is for the UE to inform the network of:

...

\- its preference to transition out of RRC\_CONNECTED state for MUSIM
operation, or;

\- its preference on the MUSIM gaps, or;

\[TS 38.331, clause 5.7.4.2\]

...

A UE capable of providing MUSIM assistance information for gap
preference may initiate the procedure if it was configured to do so,
upon determining it needs the gaps, or upon change of the gap preference
information.

A UE capable of providing MUSIM assistance information for leave
indication may initiate the procedure if it was configured to do so upon
determining that it needs to leave RRC\_CONNECTED state.

...

1\> if configured to provide MUSIM assistance information for leaving
RRC\_CONNECTED:

2\> if the UE needs to leave RRC\_CONNECTED state and the timer T346g is
not running:

3\> initiate transmission of the UEAssistanceInformation message in
accordance with 5.7.4.3 to provide MUSIM assistance information for
leaving RRC\_CONNECTED;

3\> start the timer T346g with the timer value set to the
*musim-LeaveWithoutResponseTimer*;

1\> if configured to provide MUSIM assistance information for gap
preference:

2\> if the UE has a preference on the MUSIM gap(s) and the UE did not
transmit a *UEAssistanceInformation* message with
*musim-GapPreferenceList* since it was configured to provide MUSIM
assistance information for gap preference; or

2\> if the current *musim-GapPreferenceList* is different from the one
indicated in the last transmission of the *UEAssistanceInformation*
message including *musim-GapPreferenceList* and the timer T346h is not
running:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide the current
*musim-GapPreferenceList*;

3\> start or restart the timer T346h with the timer value set to the
*musim-GapProhibitTimer*.

NOTE 3: The UE does not need to initiate transmission of the UAI message
if the difference between the current *musim-GapPreferenceList* and the
last transmission of the *UEAssistanceInformation* message including
*musim-GapPreferenceList* is only due to removal of an ended aperiodic
gap.

\[TS 38.331, clause 5.7.4.3\]

...

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide MUSIM assistance information according to 5.7.4.2
or 5.3.5.3:

2\> if the UE has a preference for MUSIM periodic gap(s):

3\> include *musim-GapPreferenceList* with an entry for each periodic
gap the UE prefers to be configured;

4\> set *musim-GapLength* and *musim-GapRepetitionAndOffset* *in the
musim-GapInfo IE* to the values of the length and the repetition/offset
of the gap(s), respectively, the UE prefers to be configured with;

2\> if the UE has a preference for MUSIM aperiodic gap:

3\> include the field *musim-GapPreferenceList*, with one entry for the
aperiodic gap the UE prefers to be configured;

4\> include *musim-GapLength* *in the musim-GapInfo IE and set it* to
the values of the length of the gap the UE prefers to be configured
with;

4\> optionally include *musim-Starting-SFN-AndSubframe in the
musim-GapInfo IE and set it to* the starting SFN/subframe of the gap the
UE prefers to be configured with;

2\> if the UE has no longer preference for the periodic/aperiodic gaps:

3\> do not include *musim-GapPreferenceList* in the *musim-Assistance*
IE;

2\> if UE has a preference to leave RRC\_CONNECTED state:

3\> set *musim-PreferredRRC-State* to the preferred RRC state.

##### 8.1.5.10.2.3 Test description {#test-description-27 .H6}

##### 8.1.5.10.2.3.1 Pre-test conditions {#pre-test-conditions-27 .H6}

##### System Simulator: {#system-simulator-19 .H6}

\- NR Cell 1(home PLMN1) and NR Cell 12 (home PLMN2) are configured
according to table 4.4.2-3 in TS 38.508-1 \[18\] and belong to the
different frequency.

\- NR Cell 1 (belongs to TAI-1, home PLMN1, MCC=001,MNC=01) is set to
\'\'Serving cell\'\'.

\- NR Cell 12 (belongs to TAI-3, home PLMN2, MCC=001,MNC=02) is set to
\'\' Serving cell\'\'.

##### UE: {#ue-16 .H6}

\- The UE is a MUSIM UE;

\- The UE is equipped with two USIMs with configuration as defined in TS
38.508-1 \[4\] Tables 6.4.1-27 and 6.4.1-28.

##### Preamble: {#preamble-17 .H6}

\- The UE performs a successful registration for MUSIM according to
Table 4.9.36.2.2-1 of TS 38.508-1 \[4\].

##### 8.1.5.10.2.3.2 Test procedure sequence {#test-procedure-sequence-27 .H6}

Table 8.1.5.10.2.3.2-1: Main behaviour

  St                                                                                                                                                          Procedure                                                                                                                                                                                                 Message Sequence   TP                                   Verdict   
  ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ------------------------------------ --------- -------
                                                                                                                                                                                                                                                                                                                                                                        U - S              Message                                        
                                                                                                                                                              The following messages are to be observed on NR Cell 1 unless explicitly stated otherwise                                                                                                                                                                                   
  1-8                                                                                                                                                         The UE performs the generic procedure by executing steps 1 to 8 to enter the NR RRC\_CONNECTED state as described in TS 38.508-1 \[4\] table 4.5.4.2-3                                                    **-**              **-**                                **-**     **-**
  9                                                                                                                                                           The SS transmits an RRCReconfiguration message to configure musim-LeaveAssistanceConfig-r17 with musim-LeaveWithoutResponseTimer-r17 IE                                                                   \<\--              NR RRC: RRCReconfiguration           \-        \-
  10                                                                                                                                                          The UE transmits an RRCReconfigurationComplete message.                                                                                                                                                   \--\>              NR RRC: RRCReconfigurationComplete   \-        \-
                                                                                                                                                              EXCEPTION: Steps 11a1 and 11a2 are executed if UE supports test function specified in TS 38.509 \[9\] (pc\_Set\_MUSIM\_UAI\_Info\_NR specified in TS 38.508-2\[5\]) ELSE Step 11b1 is executed(Note 1).                                                                     
  11a1                                                                                                                                                        The SS transmits an SET MUSIM UAI REQUEST message indicating musim-PreferredRRC-State-r17 = 'idle                                                                                                         \<\--              SET MUSIM UAI REQUEST                \-        \-
  11a2                                                                                                                                                        The UE transmits an SET MUSIM UAI RESPONSE message.                                                                                                                                                       \--\>              SET MUSIM UAI RESPONSE               \-        \-
  11b1                                                                                                                                                        Make the UE send UE Assistance information                                                                                                                                                                                                                                  
  12                                                                                                                                                          Check: Does the UE transmits an UEAssistanceInformation message to indicate IE musim-PreferredRRC-State-r17 = 'idle' within musim-LeaveAssistanceConfig-r17 IE?                                           \--\>              NR RRC: UEAssistanceInformation      1         P
  13                                                                                                                                                          SS starts timer T346g = 100ms.                                                                                                                                                                            \-                 \-                                   \-        \-
                                                                                                                                                              EXCEPTION: Steps 14a1 and 14a2 are executed if UE supports test function specified in TS 38.509 \[9\] (pc\_Set\_MUSIM\_UAI\_Info\_NR specified in TS 38.508-2\[5\]) ELSE Step 14b1 is executed(Note 1).                                                                     
  14a1                                                                                                                                                        The SS transmits an SET MUSIM UAI REQUEST message indicating musim-PreferredRRC-State-r17 = 'inactive'                                                                                                    \<\--              SET MUSIM UAI REQUEST                \-        \-
  14a2                                                                                                                                                        The UE transmits an SET MUSIM UAI RESPONSE message.                                                                                                                                                       \--\>              SET MUSIM UAI RESPONSE               \-        \-
  14b1                                                                                                                                                        Make the UE send UE Assistance information                                                                                                                                                                                                                                  
  15                                                                                                                                                          Check: Does the UE transmit an UEAssistanceInformation message to indicate musim-PreferredRRC-State-r17 = 'inactive' within musim-LeaveAssistanceConfig-r17 IE?                                           \--\>              NR RRC: UEAssistanceInformation      2         F
  16                                                                                                                                                          SS waits for timer T346g expiry.                                                                                                                                                                          \-                 \-                                   \-        \-
  17-24                                                                                                                                                       The UE performs the generic procedure by executing steps 1 to 8 to enter the NR RRC\_CONNECTED state as described in TS 38.508-1 \[4\] table 4.5.4.2-3                                                    \-                 \-                                   \-        \-
  25                                                                                                                                                          The SS transmits an RRCReconfiguration message to configure musim-GapProhibitTimer-r17 with musim-GapAssistanceConfig-r17 IE.                                                                             \<\--              NR RRC: RRCReconfiguration           \-        \-
  26                                                                                                                                                          The UE transmits an RRCReconfigurationComplete message.                                                                                                                                                   \--\>              NR RRC: RRCReconfigurationComplete   \-        \-
                                                                                                                                                              EXCEPTION: Steps 27a1 and 27a2 are executed if UE supports test function specified in TS 38.509 \[9\] (pc\_Set\_MUSIM\_UAI\_Info\_NR specified in TS 38.508-2\[5\]) ELSE Step 27b1 is executed(Note 1).                                                                     
  27a1                                                                                                                                                        The SS transmits an SET MUSIM UAI REQUEST message indicating musim-GapLength-r17 = 'ms6'.                                                                                                                 \<\--              SET MUSIM UAI REQUEST                \-        \-
  27a2                                                                                                                                                        The UE transmits an SET MUSIM UAI RESPONSE message.                                                                                                                                                       \--\>              SET MUSIM UAI RESPONSE               \-        \-
  27b1                                                                                                                                                        Make the UE send UE Assistance information                                                                                                                                                                                                                                  
  28                                                                                                                                                          The UE transmit an UEAssistanceInformation message to indicate musim-GapLength-r17 = 'ms6' within MUSIM-GapPreferenceList-r17.                                                                            \--\>              NR RRC: UEAssistanceInformation      \-        \-
                                                                                                                                                              EXCEPTION: Steps 29a1 and 29a2 are executed if UE supports test function specified in TS 38.509 \[9\] (pc\_Set\_MUSIM\_UAI\_Info\_NR specified in TS 38.508-2\[5\]) ELSE Step 29b1 is executed(Note 1).                                                                     
  29a1                                                                                                                                                        The SS transmits an SET MUSIM UAI REQUEST message indicating musim-GapLength-r17 = 'ms10' after 1s.                                                                                                       \<\--              SET MUSIM UAI REQUEST                \-        \-
  29a2                                                                                                                                                        The UE transmits an SET MUSIM UAI RESPONSE message.                                                                                                                                                       \--\>              SET MUSIM UAI RESPONSE               \-        \-
  29b1                                                                                                                                                        Make the UE send UE Assistance information                                                                                                                                                                                                                                  
  30                                                                                                                                                          Check: Does the UE transmit an UEAssistanceInformation message to indicate musim-GapLength-r17 = 'ms10' within MUSIM-GapPreferenceList-r17 IE?                                                            \--\>              NR RRC: UEAssistanceInformation      3         P
  Note1: The test function is optional, it can be replaced by alternative solutions (For Ex- AT command or MMI) due to UE implementation specific behavior.                                                                                                                                                                                                                                                                               

##### 8.1.5.10.2.3.3 Specific message contents {#specific-message-contents-27 .H6}

Table 8.1.5.10.2.3.3-1: *RRCReconfiguration* (step 9, Table
8.1.5.10.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                  
  rrcReconfiguration SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  otherConfig-v1700 SEQUENCE {                                                 
  musim-LeaveAssistanceConfig-r17 CHOICE {                                     
  setup SEQUENCE {                                                             
  musim-LeaveWithoutResponseTimer-r17                 ms40                     
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.5.10.2.3.3-2: *RRCReconfiguration* (step 25, Table
8.1.5.10.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                  
  rrcReconfiguration SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  otherConfig-v1700 SEQUENCE {                                                 
  musim-GapAssistanceConfig-r17 CHOICE {                                       
  setup SEQUENCE {                                                             
  musim-GapProhibitTimer-r17                          s1                       
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.5.10.2.3.3-3: *UEAssistanceInformation* (Step 12, Step 28,
Step 30, Table 8.1.5.10.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                                                   
  -------------------------------------------------------------------------- -------------- --------- ----------------
  Information Element                                                        Value/remark   Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                              
  criticalExtensions CHOICE {                                                                         
  ueAssistanceInformation SEQUENCE {                                                                  
  nonCriticalExtension SEQUENCE {                                                                     
  nonCriticalExtension SEQUENCE {                                                                     
  nonCriticalExtension SEQUENCE {                                                                     
  musim-Assistance-r17 SEQUENCE {                                                                     
  musim-PreferredRRC-State-r17                                               idle                     Step 12
  musim-GapPreferenceList-r17 SEQUENCE (SIZE (1..4)) OF MUSIM-GapInfo-r17{                            
  MUSIM-GapInfo-r17 \[1\] SEQUENCE {                                                                  
  musim-Starting-SFN-AndSubframe-r17                                         Not Present              
  musim-GapLength-r17                                                        ms6                      Step 28
                                                                             ms10                     Step 30
  musim-GapRepetitionAndOffset-r17 CHOICE {                                                           
  ms80-r17                                                                   0                        Step 28Step 30
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   
  }                                                                                                   

##### 8.1.5.10.3 UE Assistance Information / MUSIM / Leaving RRC\_CONNECTED / T346g expires

##### 8.1.5.10.3.1 Test Purpose (TP) {#test-purpose-tp-28 .H6}

##### (1) {#section-48 .H6}

with { UE has transmitted the UEAssistanceInformation message with
"musim-PreferredRRC-State" in MUSIM-Assistance-r17 IE that it prefers to
idle state }

ensure that {

when { UE did not receive a response from the network until t346g
expires }

then { UE autonomously leaves RRC\_CONNECTED state and enters RRC\_IDLE
with release cause \'other\' }

}

##### 8.1.5.10.3.2 Conformance requirements {#conformance-requirements-28 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.9, 5.7.4.2 and 5.7.4.3. Unless
otherwise stated these are Rel-17 requirements.

\[TS 38.331, clause 5.3.5.9\]

...

1\> if the received *otherConfig* includes the
*musim-LeaveAssistanceConfig:*

2\> if *musim-LeaveAssistanceConfig* is set to *setup*:

3\> consider itself to be configured to provide MUSIM assistance
information for leaving RRC\_CONNECTED in accordance with 5.7.4*;*

2\> else:

3\> consider itself not to be configured to provide MUSIM assistance
information for leaving RRC\_CONNECTED and stop timer T346g, if running.

...

\[TS 38.331, clause 5.7.4.2\]

...

1\> if configured to provide MUSIM assistance information for leaving
RRC\_CONNECTED:

2\> if the UE needs to leave RRC\_CONNECTED state and the timer T346g is
not running:

3\> initiate transmission of the UEAssistanceInformation message in
accordance with 5.7.4.3 to provide MUSIM assistance information for
leaving RRC\_CONNECTED;

3\> start the timer T346g with the timer value set to the
*musim-LeaveWithoutResponseTimer*;

...

\[TS 38.331, clause 5.7.4.3\]

The UE shall set the contents of the *UEAssistanceInformation* message
as follow

...

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide MUSIM assistance information according to 5.7.4.2
or 5.3.5.3:

2\> if the UE has a preference for MUSIM periodic gap(s):

3\> include *musim-GapPreferenceList* with an entry for each periodic
gap the UE prefers to be configured;

4\> set *musim-GapLength* and *musim-GapRepetitionAndOffset* *in the
musim-GapInfo IE* to the values of the length and the repetition/offset
of the gap(s), respectively, the UE prefers to be configured with;

2\> if the UE has a preference for MUSIM aperiodic gap:

3\> include the field *musim-GapPreferenceList*, with one entry for the
aperiodic gap the UE prefers to be configured;

4\> include *musim-GapLength* *in the musim-GapInfo IE and set it* to
the values of the length of the gap the UE prefers to be configured
with;

4\> optionally include *musim-Starting-SFN-AndSubframe in the
musim-GapInfo IE and set it to* the starting SFN/subframe of the gap the
UE prefers to be configured with;

2\> if the UE has no longer preference for the periodic/aperiodic gaps:

3\> do not include *musim-GapPreferenceList* in the *musim-Assistance*
IE;

2\> if UE has a preference to leave RRC\_CONNECTED state:

3\> set *musim-PreferredRRC-State* to the preferred RRC state.

...

##### 8.1.5.10.3.3 Test description {#test-description-28 .H6}

##### 8.1.5.10.3.3.1 Pre-test conditions {#pre-test-conditions-28 .H6}

##### System Simulator: {#system-simulator-20 .H6}

\- NR Cell 1(home PLMN1) and NR Cell 12 (home PLMN2) are configured
according to table 4.4.2-3 in TS 38.508-1 \[18\] and belong to the
different frequency.- NR Cell 1 (belongs to TAI-1, home PLMN1, MCC=001,
MNC=01) is set to \'\'Serving cell\'\'.

\- NR Cell 12 (belongs to TAI-3, home PLMN2, MCC=001, MNC=02) is set to
\'\' Serving cell\'\'.

##### UE: {#ue-17 .H6}

\- The UE is a MUSIM UE;

\- The UE is equipped with two USIMs with configuration as defined in TS
38.508-1 \[4\] tables 6.4.1-27 and 6.4.1-28.

##### Preamble: {#preamble-18 .H6}

\- The UE performs a successful registration for MUSIM according to
Table 4.9.36.2.2-1 of TS 38.508-1 \[4\].

\- The UE is brought to state 3N-A, RRC\_CONNECTED Connectivity (NR), in
accordance with the procedure described in TS 38.508-1 \[4\], clause
4.5.4 need to be performed on NR Cell 12.

##### 8.1.5.10.3.3.2 Test procedure sequence {#test-procedure-sequence-28 .H6}

Table 8.1.5.10.3.3.2-1: Main behaviour

  **St**                                                                                                                                                      **Procedure**                                                                                                                                                             **Message Sequence**   **TP**                                   **Verdict**   
  ----------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------- ---------------------------------------- ------------- ----
                                                                                                                                                                                                                                                                                                                                        **U - S**              **Message**                                            
                                                                                                                                                              The following messages are to be observed on NR Cell 12 unless explicitly stated otherwise                                                                                                                                                              
  1                                                                                                                                                           The SS transmits an RRCReconfiguration message to configure musim-LeaveAssistanceConfig with musim-LeaveWithoutResponseTimer-r17 IE.                                      \--\>                  **NR RRC: *RRCReconfiguration***         \-            \-
  2                                                                                                                                                           The UE transmits an RRCReconfigurationComplete message.                                                                                                                   \<\--                  **NR RRC: RRCReconfigurationComplete**   \-            \-
                                                                                                                                                              EXCEPTION: Steps 3a1 and 3a2 are executed if UE supports test function specified in TS 38.509 \[9\] (pc\_Set\_MUSIM\_UAI\_Info\_NR) ELSE Step 3b1 is executed. (Note 1)                                                                                 
  3a1                                                                                                                                                         The SS transmits an SET UAI REQUEST message indicating Preferred RRC State = 'idle'.                                                                                      \<\--                  **SET MUSIM UAI REQUEST**                \-            \-
  3a2                                                                                                                                                         The UE transmits an SET UAI RESPONSE message.                                                                                                                             \--\>                  SET MUSIM UAI RESPONSE                   \-            \-
  3b1                                                                                                                                                         Make the UE send UE Assistance information                                                                                                                                \-                     **-**                                    \-            \-
  4                                                                                                                                                           Void                                                                                                                                                                                                                                                    
  5                                                                                                                                                           The UE transmits an UEAssistanceInformation message to indicate IE musim-PreferredRRC-State = 'idle' within the MUSIM-Assistance-r17 IE.                                  \--\>                  NR RRC: UEAssistanceInformation                        
  6                                                                                                                                                           SS waits for timer T346g expiry.                                                                                                                                          \-                     \-                                       \-            \-
  7                                                                                                                                                           Check: Does the test result of generic test procedure step 1-8 in TS 38.508-1 \[4\] Table 4.9.4.2.2-1 indicate that the UE is in RRC\_IDLE?                               \-                     \-                                       1             P
  Note1: The test function is optional, it can be replaced by alternative solutions (For Ex- AT command or MMI) due to UE implementation specific behavior.                                                                                                                                                                                                                                                           

##### 8.1.5.10.3.3.3 Specific message contents {#specific-message-contents-28 .H6}

Table 8.1.5.10.3.3.3-1: RRCReconfiguration (step 1, Table
8.1.5.10.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                  
  rrcReconfiguration SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  otherConfig-v1700 CHOICE {                                                   
  musim-LeaveAssistanceConfig-r17 SEQUENCE {                                   
  setup SEQUENCE {                                                             
  musim-LeaveWithoutResponseTimer-r17                 ms100                    
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

**Table 8.1.5.10.3.3.3-2: *UEAssistanceInformation* (Step 5, Table
8.1.5.10.3.3.2-1)**

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                                    
  --------------------------------------------------- ------------------ ------------- ---------------
  **Information Element**                             **Value/remark**   **Comment**   **Condition**
  UEAssistanceInformation ::= SEQUENCE {                                               
  criticalExtensions CHOICE {                                                          
  ueAssistanceInformation SEQUENCE {                                                   
  nonCriticalExtension SEQUENCE {                                                      
  nonCriticalExtension SEQUENCE {                                                      
  nonCriticalExtension SEQUENCE {                                                      
  musim-Assistance-r17                                                                 
  musim-PreferredRRC-State-r17                        idle                             
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    

##### 8.1.5.10.4 UE Assistance Information / RRM measurement relaxation / RedCap

Note: This test case is only applicable to certain specific UE
implementation of RRM Relaxation.

##### 8.1.5.10.4.1 Test Purpose (TP) {#test-purpose-tp-29 .H6}

##### (1) {#section-49 .H6}

**with** { UE supporting RedCap and in NR RRC\_Connected state and
configured RRM measurement relaxation Stationary criterion }

**ensure that** {

**when** { *the criterion is fulfilled and the UE did not transmit a
UEAssistanceInformation message with rrm-MeasRelaxationFulfilment as
true since it was configured to provide indications of RRM measurement
relaxation criterion fulfilment* }

**then** { the UE initiates transmission of the UEAssistanceInformation
message to indicate that the criterion for RRM measurement relaxation
for connected mode is fulfilled }

}

##### (2) {#section-50 .H6}

**with** { UE supporting RedCap and in NR RRC\_Connected state and
configured RRM measurement relaxation Stationary criterion }

**ensure that** {

**when** { the criterion is not fulfilled and the last
UEAssistanceInformation message indicated fulfilment of the criterion
with rrm-MeasRelaxationFulfilment as true}

**then** { the UE initiates transmission of the UEAssistanceInformation
message to indicate that the criterion for RRM measurement relaxation
for connected mode is not fulfilled }

}

##### (3) {#section-51 .H6}

**with** { UE supporting RedCap and in NR RRC\_Connected state and
configured RRM measurement relaxation Stationary criterion }

**ensure that** {

**when** { the criterion is fulfilled and the last
UEAssistanceInformation message indicated the criterion is not fulfilled
with rrm-MeasRelaxationFulfilment as false}

**then** { the UE initiates transmission of the UEAssistanceInformation
message to indicate that the criterion for RRM measurement relaxation
for connected mode is fulfilled}

}

##### 8.1.5.10.4.2 Conformance requirements {#conformance-requirements-29 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.304 clause 5.2.4.9 and TS 38.331 clause 5.7.4

\[TS 38.304 clause 5.2.4.9\]

The relaxed measurement criterion for a stationary RedCap UE is
fulfilled when:

\- (Srxlev~RefStationary~ -- Srxlev) \< S~SearchDeltaP-Stationary~,

Where:

\- Srxlev = current Srxlev value of the serving cell (dB).

\- Srxlev~RefStationary~ = reference Srxlev value of the serving cell
(dB), set as follows:

\- After selecting or reselecting a new cell, or

\- If (Srxlev - Srxlev~RefStationary~) \> 0, or

\- If the relaxed measurement criterion has not been met for
T~SearchDeltaP-Stationary~:

\- The UE shall set the value of Srxlev~RefStationary~ to the current
Srxlev value of the serving cell.

...

The relaxed measurement criterion for a stationary RedCap UE not at cell
edge is fulfilled when:

\- the relaxed measurement criterion in clause 5.2.4.9.3 is fulfilled
for a period of T~SearchDeltaP-Stationary~,

\- Srxlev \> S~SearchThresholdP2~, and,

\- Squal \> S~SearchThresholdQ2~, if S~SearchThresholdQ2~ is configured.

Where:

\- Srxlev = current Srxlev value of the serving cell (dB).

\- Squal = current Squal value of the serving cell (dB).

\[TS 38.331 clause 5.7.4\]

...

A UE capable of providing an indication of fulfilment of the RRM
measurement relaxation criterion in connected mode may initiate the
procedure if it was configured to do so, upon change of its fulfilment
status for RRM measurement relaxation criterion for connected mode.

...

Upon initiating the procedure, the UE shall:

...

1\> if configured to send indications of RRM measurement relaxation
criterion fulfilment:

2\> if the criterion in 5.7.4.4 is met for a period of
T~SearchDeltaP-StationaryConnected~:

3\> if the UE did not transmit a *UEAssistanceInformation* message with
*rrm-MeasRelaxationFulfilment* as *true* since it was configured to
provide indications of RRM measurement relaxation criterion fulfilment;
or

3\> the last *UEAssistanceInformation* message indicated the criterion
in 5.7.4.4 is not fulfilled with *rrm-MeasRelaxationFulfilment* as
*false*:

4\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to indicate that the criterion for RRM
measurement relaxation for connected mode is fulfilled;

2\> else:

3\> if the last *UEAssistanceInformation* message indicated fulfilment
of the criterion in 5.7.4.4 with *rrm-MeasRelaxationFulfilment* as
*true*:

4\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to indicate that the criterion for RRM
measurement relaxation for connected mode is not fulfilled.

...

The UE shall set the contents of the *UEAssistanceInformation* message
as follows:

...

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide an indication about whether the criterion for RRM
relaxation for connected mode is fulfilled or not fulfilled:

2\> if the criterion for RRM measurement relaxation for connected mode
is fulfilled:

3\> set the *rrm-MeasRelaxationFulfilment* to *true*;

2\> else:

3\> set the *rrm-MeasRelaxationFulfilment* to *false*.

...

The relaxed measurement criterion for a stationary UE is met when:

\- (SS-RSRP~RefStationaryConnected~ -- SS-RSRP) \<
S~SearchDeltaP-StationaryConnected~,

Where:

\- SS-RSRP = current L3 RSRP measurement of the PCell based on SSB (dB).

\- SS-RSRP~RefStationaryConnected~ = reference SS-RSRP value of the
PCell cell (dB), set as follows:

\- At the end of RRC reconfiguration procedure as specified in 5.3.5.3,
when *rrm-MeasRelaxationReportingConfig* is included in the
*RRCReconfiguration* message; or

\- If (SS-RSRP -- SS-RSRP~RefStationaryConnected~) \> 0; or

\- If the relaxed measurement criterion has not been met for
T~SearchDeltaP-StationaryConnected~:

\- The UE shall set the value of SS-RSRP~RefStationaryConnected~ to the
current SS-RSRP value of the serving cell.

##### 8.1.5.10.4.3 Test description {#test-description-29 .H6}

##### 8.1.5.10.4.3.1 Pre-test conditions {#pre-test-conditions-29 .H6}

##### System Simulator: {#system-simulator-21 .H6}

\- NR Cell 1

##### UE: {#ue-18 .H6}

\- UE supporting RedCap

\- UE supporting RRM measurement relaxation

\- UE supporting initiation of UE Assistance Information procedure
immediately upon change of its fulfilment status for RRM measurement
relaxation criterion for connected mode.

##### Preamble: {#preamble-19 .H6}

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.5.10.4.3.2 Test procedure sequence {#test-procedure-sequence-29 .H6}

Table 8.1.5.10.4.3.2-1-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble, while columns marked \"T1\", "T2" and \"T3\",
are to be applied subsequently. The exact instants on which these values
shall be applied are described in the texts in this clause.

Table 8.1.5.10.4.3.2-1: Time instances of cell power level and parameter
changes in FR1

+----+-----------+---------+-----------+------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                       |
+====+===========+=========+===========+==============================+
| T0 | SS/PBCH   | dBm/SCS | -94       |                              |
|    |           |         |           |                              |
|    | SSS EPRE  |         |           |                              |
+----+-----------+---------+-----------+------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -88       | Power level is such that     |
|    |           |         |           | measurement relaxation       |
|    | SSS EPRE  |         |           | Stationary criterion is      |
|    |           |         |           | fulfilled                    |
+----+-----------+---------+-----------+------------------------------+
| T2 | SS/PBCH   | dBm/SCS | -94       | Power level is such that     |
|    |           |         |           | measurement relaxation       |
|    | SSS EPRE  |         |           | Stationary criterion is not  |
|    |           |         |           | fulfilled                    |
+----+-----------+---------+-----------+------------------------------+
| T3 | SS/PBCH   | dBm/SCS | -88       | Power level is such that     |
|    |           |         |           | measurement relaxation       |
|    | SSS EPRE  |         |           | Stationary criterion is      |
|    |           |         |           | fulfilled                    |
+----+-----------+---------+-----------+------------------------------+

Table 8.1.5.10.4.3.2-2: Time instances of cell power level and parameter
changes in FR2

+----+-----------+---------+-----------+------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                       |
+====+===========+=========+===========+==============================+
| T0 | SS/PBCH   | dBm/SCS | -91       |                              |
|    |           |         |           |                              |
|    | SSS EPRE  |         |           |                              |
+----+-----------+---------+-----------+------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -82       | Power level is such that     |
|    |           |         |           | measurement relaxation       |
|    | SSS EPRE  |         |           | Stationary criterion is      |
|    |           |         |           | fulfilled                    |
+----+-----------+---------+-----------+------------------------------+
| T2 | SS/PBCH   | dBm/SCS | -91       | Power level is such that     |
|    |           |         |           | measurement relaxation       |
|    | SSS EPRE  |         |           | Stationary criterion is not  |
|    |           |         |           | fulfilled                    |
+----+-----------+---------+-----------+------------------------------+
| T3 | SS/PBCH   | dBm/SCS | -82       | Power level is such that     |
|    |           |         |           | measurement relaxation       |
|    | SSS EPRE  |         |           | Stationary criterion is      |
|    |           |         |           | fulfilled                    |
+----+-----------+---------+-----------+------------------------------+

Table 8.1.5.10.4.3.2-3: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+----+--------------+--------------+--------------+---------+----+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | **NR RRC:**  | \-      | \- |
|    | transmits an |              |              |         |    |
|    | RRCRec       |              | *RRCReco     |         |    |
|    | onfiguration |              | nfiguration* |         |    |
|    | message to   |              |              |         |    |
|    | setup RRM    |              |              |         |    |
|    | measurement  |              |              |         |    |
|    | relaxation   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | The UE       | \--\>        | **NR RRC:**  | \-      | \- |
|    | transmits an |              |              |         |    |
|    | RR           |              | *RRC         |         |    |
|    | CReconfigura |              | Reconfigurat |         |    |
|    | tionComplete |              | ionComplete* |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the          |              |              |         |    |
|    | c            |              |              |         |    |
|    | ell-specific |              |              |         |    |
|    | reference    |              |              |         |    |
|    | signal level |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T1\".  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | The SS waits | \-           | *-*          | \-      | \- |
|    | for 5s (for  |              |              |         |    |
|    | t-Sea        |              |              |         |    |
|    | rchDeltaP-St |              |              |         |    |
|    | ationary-r17 |              |              |         |    |
|    | to expire).  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | Check: Does  | \--\>        | **NR RRC:**  | 1       | P  |
|    | the UE       |              | *            |         |    |
|    | transmit an  |              | UEAssistance |         |    |
|    | *            |              | Information* |         |    |
|    | UEAssistance |              |              |         |    |
|    | Information* |              |              |         |    |
|    | message      |              |              |         |    |
|    | containing   |              |              |         |    |
|    | *rrm-MeasR   |              |              |         |    |
|    | elaxationFul |              |              |         |    |
|    | filment-r17* |              |              |         |    |
|    | set to       |              |              |         |    |
|    | "true"?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the          |              |              |         |    |
|    | c            |              |              |         |    |
|    | ell-specific |              |              |         |    |
|    | reference    |              |              |         |    |
|    | signal level |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T2\".  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | Check: Does  | \--\>        | **NR RRC:**  | 2       | P  |
|    | the UE       |              | *            |         |    |
|    | transmit an  |              | UEAssistance |         |    |
|    | *            |              | Information* |         |    |
|    | UEAssistance |              |              |         |    |
|    | Information* |              |              |         |    |
|    | message      |              |              |         |    |
|    | containing   |              |              |         |    |
|    | *rrm-MeasR   |              |              |         |    |
|    | elaxationFul |              |              |         |    |
|    | filment-r17* |              |              |         |    |
|    | set to       |              |              |         |    |
|    | "false"?     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8  | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the          |              |              |         |    |
|    | c            |              |              |         |    |
|    | ell-specific |              |              |         |    |
|    | reference    |              |              |         |    |
|    | signal level |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T3\".  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | The SS waits | \-           | *-*          | \-      | \- |
|    | for 5s (for  |              |              |         |    |
|    | t-Sea        |              |              |         |    |
|    | rchDeltaP-St |              |              |         |    |
|    | ationary-r17 |              |              |         |    |
|    | to expire).  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 10 | Check: Does  | \--\>        | **NR RRC:**  | 3       | P  |
|    | the UE       |              | *            |         |    |
|    | transmit an  |              | UEAssistance |         |    |
|    | *            |              | Information* |         |    |
|    | UEAssistance |              |              |         |    |
|    | Information* |              |              |         |    |
|    | message      |              |              |         |    |
|    | containing   |              |              |         |    |
|    | *rrm-MeasR   |              |              |         |    |
|    | elaxationFul |              |              |         |    |
|    | filment-r17* |              |              |         |    |
|    | set to       |              |              |         |    |
|    | "true"?      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.5.10.4.3.3 Specific message contents {#specific-message-contents-29 .H6}

Table 8.1.5.10.4.3.3-1: *RRCReconfiguration* (Step 1, Table
8.1.5.10.4.3.2-3*)*

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                  
  rrcReconfiguration SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  otherConfig-v1700 SEQUENCE {                                                 
  ul-GapFR2-PreferenceConfig-r17                      Not present              
  musim-GapAssistanceConfig-r17                       Not present              
  musim-LeaveAssistanceConfig-r17                     Not present              
  successHO-Config-r17                                Not present              
  maxBW-PreferenceConfigFR2-2-r17                     Not present              
  maxMIMO-LayerPreferenceConfigFR2-2-r17              Not present              
  minSchedulingOffsetPreferenceConfigExt-r17          Not present              
  rlm-RelaxationReportingConfig-r17                   Not present              
  bfd-RelaxationReportingConfig-r17                   Not present              
  scg-DeactivationPreferenceConfig-r17                Not present              
  rrm-MeasRelaxationReportingConfig-r17 CHOICE {                               
  setup SEQUENCE {                                                             
  s-SearchDeltaP-Stationary-r17                       dB3                      
  t-SearchDeltaP-Stationary-r17                       s5                       
  }                                                                            
  }                                                                            
  propDelayDiffReportConfig-r17                       Not present              
  }                                                                            
  sl-L2RelayUE-Config-r17                             Not present              
  sl-L2RemoteUE-Config-r17                            Not present              
  dedicatedPagingDelivery-r17                         Not present              
  needForGapNCSG-ConfigNR-r17                         Not present              
  needForGapNCSG-ConfigEUTRA-r17                      Not present              
  musim-GapConfig-r17                                 Not present              
  ul-GapFR2-Config-r17                                Not present              
  scg-State-r17                                       Not present              
  appLayerMeasConfig-r17                              Not present              
  ue-TxTEG-RequestUL-TDOA-Config-r17                  Not present              
  nonCriticalExtension                                Not present              
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.5.10.4.3.3-2: *UEAssistanceInformation* (Steps 5 and 10,Table
8.1.5.10.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                  
  ueAssistanceInformation SEQUENCE {                                           
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  rrm-MeasRelaxationFulfilment-r17                    true                     
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.5.10.4.3.3-3: *UEAssistanceInformation* (Step 7,Table
8.1.5.10.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                  
  ueAssistanceInformation SEQUENCE {                                           
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  rrm-MeasRelaxationFulfilment-r17                    false                    
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

##### 8.1.5.10.5 UE Assistance Information / MUSIM / musim-cellToAffectList

##### 8.1.5.10.5.1 Test Purpose (TP) {#test-purpose-tp-30 .H6}

##### (1) {#section-52 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE is configured to provide MUSIM assistance information for
temporary capability restriction and it has temporary capability
restriction on the current configuration with timer T348 is not running
}

**then** { UE transmits a UEAssistanceInformation message including
musim-CellToAffectList and starts timer T348 with the timer value set to
the musim-WaitTimer }

}

##### (2) {#section-53 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE is configured to provide MUSIM assistance information for
temporary capability restriction and it has temporary capability
restriction on the current configuration with timer T348 is running }

**then** { UE Does NOT transmit a UEAssistanceInformation message
including musim-CellToAffectList }

}

##### 8.1.5.10.5.2 Conformance requirements {#conformance-requirements-30 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.7.4.2, and TS 38.300, clause 20.4.
Unless otherwise stated these are Rel-18 requirements.

\[TS 38.331, clause 5.7.4.2\]

...

A UE capable of providing MUSIM assistance information for temporary
capability restriction may initiate the procedure if it was configured
to do so, upon determining it has temporary capability restriction or
upon determining the removal of the capability restriction.

...

Upon initiating the procedure, the UE shall:

...

1\> if configured to provide MUSIM assistance information for temporary
capability restriction:

2\> if the UE has temporary capability restriction on the current
configuration and *timer T348 is not running*:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide the current *musim-Cell-SCG-ToRelease
and/or musim-CellToAffectList*;

3\> start the timer T348 with the timer value set to the
*musim-WaitTimer*.

\[TS 38.300, clause 20.4\]

**For MUSIM operation, a MUSIM** device in RRC\_CONNECTED state in
Network A may **indicate its preference on temporary UE capability
restriction or removal of restriction with Network A when the MUSIM
device needs transmission or reception in Network B (e.g., including
start/stop connection to Network B). Network A is NR and Network B can
either be E-UTRA or NR. The MUSIM device may request a temporary
capability restriction only after the Network signals via RRC that this
is allowed.**

**When configured to do so, a MUSIM device can indicate** one or more of
the following temporary capability restriction or removal of restriction
to the Network A:

\- A MUSIM device can explicitly request SCell(s) or SCG to be released;

\- A MUSIM device can indicate its preference on temporary maximum MIMO
layers and/or supported channel bandwidth for specific serving cells for
both UL/DL;

\- A MUSIM device can indicate its preference on the temporary maximum
number of CCs per UL/DL;

\- A MUSIM device can indicate its preference on the concerned band(s)
or band combination(s) (e.g. forbidden and/or affected band(s) or band
combination(s)) based on a band-filter list configured by network. For
affected band(s) and band combination(s), this preference can include
temporary maximum MIMO layers and/or supported channel bandwidth for
both UL/DL;

\- A MUSIM device can indicate the measurement gap requirement changes.

**When it is allowed by Network A in SIB1, a MUSIM device can indicate
to the Network A that its capabilities are temporarily restricted in
*RRCSetupComplete/RRCResumeComplete* message while the MUSIM device is
already in RRC\_CONNECTED state in Network B.**

**When a MUSIM device is in RRC\_CONNECTED state in both Network A and
Network B, if Network B is NR, it is up to UE implementation to select
which network to request temporary UE capability restriction; if Network
B is E-UTRA, the request for temporary UE capability restriction can
only be performed on Network A.**

**...**

##### 8.1.5.10.5.3 Test description {#test-description-30 .H6}

##### 8.1.5.10.5.3.1 Pre-test conditions {#pre-test-conditions-30 .H6}

##### System Simulator: {#system-simulator-22 .H6}

\- NR Cell 1(home PLMN1) and NR Cell 12 (home PLMN2) are configured
according to table 4.4.2-3 in TS 38.508-1 \[18\] and belong to the
different frequency.

\- NR Cell 1 (belongs to TAI-1, home PLMN1, MCC=001,MNC=01) is set to
\'\'Serving cell\'\'.

\- NR Cell 12 (belongs to TAI-3, home PLMN2, MCC=001,MNC=02) is set to
\'\'Serving cell \'\'.

##### UE: {#ue-19 .H6}

\- The UE is a Rel-18 MUSIM UE;

\- The UE is equipped with two USIMs with configuration as defined in TS
38.508-1 \[4\] Tables 6.4.1-27 and 6.4.1-28.

Preamble:

\- The UE is in 5GS state 3N-A on NR Cell 1 and on NR Cell 12 according
to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- The SIB1 of NR Cell 12 and NR Cell 1 are defined in TS 38.508-1
\[4\], clause 4.6.1-28 with condition MUSIM\_r18 for all steps.

##### 8.1.5.10.5.3.2 Test procedure sequence {#test-procedure-sequence-30 .H6}

Table 8.1.5.10.5.3.2-1: Main behaviour

  St    Procedure                                                                                                        Message Sequence   TP                                     Verdict   
  ----- ---------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- -------
                                                                                                                         U - S              Message                                          
  \-    The following messages are to be observed on NR Cell 12 unless explicitly stated otherwise.                      **-**              **-**                                  **-**     **-**
  1-6   Void                                                                                                             **-**              **-**                                  **-**     **-**
  7     The SS transmits an *RRCReconfiguration* message to trigger UE transmitting *UEAssistanceInformation* message.   **\<\--**          NR RRC: *RRCReconfiguration*           **-**     **-**
  8     The UE transmits an *RRCReconfigurationComplete* message.                                                        \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  9     Check: Does UE transmit *UEAssistanceInformation* message?                                                       \--\>              NR RRC: *UEAssistanceInformation*      **1**     **P**
  10    The SS transmits an *RRCReconfiguration* message to trigger UE transmitting *UEAssistanceInformation*.           **\<\--**          NR RRC: *RRCReconfiguration*           \-        \-
  11    The UE transmits an *RRCReconfigurationComplete* message.                                                        \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  12    Check: Does UE transmit *UEAssistanceInformation* message in 1s?                                                 \--\>              NR RRC: *UEAssistanceInformation*      **2**     **F**

##### 8.1.5.10.5.3.3 Specific message contents {#specific-message-contents-30 .H6}

Table 8.1.5.10.5.3.3-1: *RRCConnectionReconfiguration* (step 7 and 10,
Table 8.1.5.10.5.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-13                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                  
  rrcReconfiguration SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  nonCriticalExtension SEQUENCE {                                              
  otherConfig-v1800 SEQUENCE {                                                 
  musim-CapabilityRestrictionConfig-r18 CHOICE {                               
  setup SEQUENCE {                                                             
  musim-WaitTimer-r18                                 ms100                    
  musim-ProhibitTimer-r18                             s10                      
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.5.10.5.3.3-2: *UEAssistanceInformation* (step 9, Table
8.1.5.10.5.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                                 
  --------------------------------------------------- ------------------- --------- -----------
  Information Element                                 Value/remark        Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                       
  ueAssistanceInformation SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                                   
  nonCriticalExtension SEQUENCE {                                                   
  nonCriticalExtension SEQUENCE {                                                   
  nonCriticalExtension SEQUENCE {                                                   
  musim-Assistance-v1800 SEQUENCE {                                                 
  musim-CapRestriction-r18 SEQUENCE {                                               
  musim-CellToAffectList-r18                          Any allowed value             
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 
  }                                                                                 

##### 8.1.5.10.6 UE Assistance Information / MUSIM / musim-AffectedBandsList / musim-AvoidedBandsList / musim-MaxCC

##### 8.1.5.10.6.1 Test Purpose (TP) {#test-purpose-tp-31 .H6}

##### (1) {#section-54 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE is configured to provide MUSIM assistance information for
temporary capability restriction and it has temporary capability
restriction on the combination(s) of bands comprising of band(s)
included in musim-CandidateBandList and it did not transmit a
UEAssistanceInformation message with musim-AffectedBandsList and/or
musim-AvoidedBandsList and/or musim-MaxCC since it was configured to
provide MUSIM assistance information for temporary capability
restriction and the timer T346n is not running }

**then** { UE transmits a UEAssistanceInformation message including
current musim-AffectedBandsList and/or musim-AvoidedBandsList and/or
musim-MaxCC and start or restart the timer 346n with the timer value set
to the musim-ProhibitTimer }

}

##### (2) {#section-55 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE is configured to provide MUSIM assistance information for
temporary capability restriction and the current musim-AffectedBandsList
and/or musim-AvoidedBandsList and/or musim-MaxCC is different from the
one indicated in the last transmission of the UEAssistanceInformation
message including musim-CapRestriction and the timer T346n is not
running }

**then** { UE transmits a UEAssistanceInformation message including
current musim-AffectedBandsList and/or musim-AvoidedBandsList and/or
musim-MaxCC and start or restart the timer T346n with the timer value
set to the musim-ProhibitTimer }

}

##### (3) {#section-56 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE is configured to provide MUSIM assistance information for
temporary capability restriction and it has temporary capability
restriction on the current configuration and timer T346n is running }

**then** { UE Does NOT transmit a UEAssistanceInformation message
including musim-AffectedBandsList and/or musim-AvoidedBandsList and/or
musim-MaxCC }

}

##### 8.1.5.10.6.2 Conformance requirements {#conformance-requirements-31 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clause 5.7.4.2, and TS 38.300, clause 20.4.
Unless otherwise stated these are Rel-18 requirements.

\[TS 38.331, clause 5.7.4.2\]

...

A UE capable of providing MUSIM assistance information for temporary
capability restriction may initiate the procedure if it was configured
to do so, upon determining it has temporary capability restriction or
upon determining the removal of the capability restriction.

...

Upon initiating the procedure, the UE shall:

...

1\> if configured to provide MUSIM assistance information for temporary
capability restriction:

2\> if the UE has temporary capability restriction on the current
configuration and *timer T348 is not running*:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide the current *musim-Cell-SCG-ToRelease
and/or musim-CellToAffectList*;

3\> start the timer T348 with the timer value set to the
*musim-WaitTimer*.

2\> if the UE has temporary capability restriction on the combination(s)
of bands comprising of band(s) included in *musim-CandidateBandList* or
if the UE has temporary capability restriction on the maximum CC number,
and the UE did not transmit a *UEAssistanceInformation* message with
*musim-AffectedBandsList and/or musim-AvoidedBandsList* and/or
*musim-MaxCC* since it was configured to provide MUSIM assistance
information for temporary capability restriction *and timer T346n is not
running*; or

2\> if the current *musim-AffectedBandsList and/or
musim-AvoidedBandsList* and/or *musim-MaxCC* is different from the one
indicated in the last transmission of the *UEAssistanceInformation*
message including *musim-CapRestriction and timer T346n is not running*:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide the current *musim-AffectedBandsList
and/or musim-AvoidedBandsList* and/or *musim-MaxCC*;

3\> start the timer T346n with the timer value set to the
*musim-ProhibitTimer*.

\[TS 38.300, clause 20.4\]

**For MUSIM operation, a MUSIM** device in RRC\_CONNECTED state in
Network A may **indicate its preference on temporary UE capability
restriction or removal of restriction with Network A when the MUSIM
device needs transmission or reception in Network B (e.g., including
start/stop connection to Network B).** **Network A is NR and Network B
can either be E-UTRA or NR. The MUSIM device may request a temporary
capability restriction only after the Network signals via RRC that this
is allowed.**

**When configured to do so, a MUSIM device can indicate** one or more of
the following temporary capability restriction or removal of restriction
to the Network A:

\- A MUSIM device can explicitly request SCell(s) or SCG to be released;

\- A MUSIM device can indicate its preference on temporary maximum MIMO
layers and/or supported channel bandwidth for specific serving cells for
both UL/DL;

\- A MUSIM device can indicate its preference on the temporary maximum
number of CCs per UL/DL;

\- A MUSIM device can indicate its preference on the concerned band(s)
or band combination(s) (e.g. forbidden and/or affected band(s) or band
combination(s)) based on a band-filter list configured by network. For
affected band(s) and band combination(s), this preference can include
temporary maximum MIMO layers and/or supported channel bandwidth for
both UL/DL;

\- A MUSIM device can indicate the measurement gap requirement changes.

**When it is allowed by Network A in SIB1, a MUSIM device can indicate
to the Network A that its capabilities are temporarily restricted in
*RRCSetupComplete/RRCResumeComplete* message while the MUSIM device is
already in RRC\_CONNECTED state in Network B.**

**When a MUSIM device is in RRC\_CONNECTED state in both Network A and
Network B, if Network B is NR, it is up to UE implementation to select
which network to request temporary UE capability restriction; if Network
B is E-UTRA, the request for temporary UE capability restriction can
only be performed on Network A.**

**...**

##### 8.1.5.10.6.3 Test description {#test-description-31 .H6}

##### 8.1.5.10.6.3.1 Pre-test conditions {#pre-test-conditions-31 .H6}

##### System Simulator: {#system-simulator-23 .H6}

\- NR Cell 1(home PLMN1), NR Cell 10 (home PLMN1) and NR Cell 12 (home
PLMN2) are configured according to table 4.4.2-3 in TS 38.508-1 \[18\]
and belong to the different frequencies.

\- NR Cell 1 and NR Cell 10 belong to TAI-1, home PLMN1, MCC=001,
MNC=01.

\- NR Cell 12 belongs to TAI-3, home PLMN2, MCC=001, MNC=02.

\- The SIB1 of NR Cell 12 and NR Cell 1 are defined in TS 38.508-1
\[4\], clause 4.6.1-28 with condition MUSIM\_r18 for all steps.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 with NR Cell 10 replaces NR Cell 3 is used to NR cell1.

##### UE: {#ue-20 .H6}

\- The UE is a Rel-18 MUSIM UE;

\- The UE is equipped with two USIMs with configuration as defined in TS
38.508-1 \[4\] Tables 6.4.1-27 and 6.4.1-28.

Preamble:

\- The UE is in 5GS state 3N-A on NR Cell 12 and on NR Cell 1 according
to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.5.10.6.3.2 Test procedure sequence {#test-procedure-sequence-31 .H6}

Tables 8.1.5.10.6.3.2-1 illustrates the downlink power levels to be
applied for NR Cell 1, NR Cell 1, and NR Cell 12 at various time
instants of the test execution. Row marked \"T0\" denotes the conditions
after the preamble.

Table 8.1.5.10.6.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-----------+---------+-----------+------------+---------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 10 | NR      | Remark |
|    |           |         |           |            |         |        |
|    |           |         |           |            | Cell 12 |        |
+====+===========+=========+===========+============+=========+========+
| T0 | SS/PBCH   | dBm/SCS | -88       | "Off"      | -88     |        |
|    |           |         |           |            |         |        |
|    | SSS EPRE  |         |           |            |         |        |
+----+-----------+---------+-----------+------------+---------+--------+
| T1 | SS/PBCH   | dBm/SCS | -88       | -88        | -88     |        |
|    |           |         |           |            |         |        |
|    | SSS EPRE  |         |           |            |         |        |
+----+-----------+---------+-----------+------------+---------+--------+

Table 8.1.5.10.6.3.2-2: Main behaviour

  St    Procedure                                                                                                                            Message Sequence   TP                                     Verdict   
  ----- ------------------------------------------------------------------------------------------------------------------------------------ ------------------ -------------------------------------- --------- -------
                                                                                                                                             U - S              Message                                          
  \-    The following messages are to be observed on NR Cell 1 unless explicitly stated otherwise.                                           **-**              **-**                                  **-**     **-**
  1-6   Void                                                                                                                                 **-**              **-**                                  **-**     **-**
  7     The SS transmits an *RRCReconfiguration* message to trigger UE transmitting *UEAssistanceInformation* message.                       **\<\--**          NR RRC: *RRCReconfiguration*           **-**     **-**
  8     The UE transmits an *RRCReconfigurationComplete* message.                                                                            \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  9     Check: Does the UE transmit *UEAssistanceInformation* message?                                                                       \--\>              NR RRC: *UEAssistanceInformation*      **1**     **P**
  10    The SS adjusts the cell power levels according to row \"T1\" in table 8.1.5.10.6.3.2-1.                                              \-                                                        **-**     **-**
  11    The SS transmits an *RRCReconfiguration* message for handover to NR Cell 10 and trigger UE transmitting *UEAssistanceInformation*.   **\<\--**          NR RRC: *RRCReconfiguration*           \-        \-
  \-    The following messages are to be observed on NR Cell 10 unless explicitly stated otherwise.                                          **-**              **-**                                  **-**     **-**
  12    The UE transmits an *RRCReconfigurationComplete* message.                                                                            \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  13    Check: Does UE transmit *UEAssistanceInformation* message?                                                                           \--\>              NR RRC: *UEAssistanceInformation*      **3**     **F**
  14    Wait 5s to ensure T346n expire.                                                                                                                                                                          
  15    The SS transmits an *RRCReconfiguration* message to trigger UE transmitting *UEAssistanceInformation* message.                       **\<\--**          NR RRC: *RRCReconfiguration*           **-**     **-**
  16    The UE transmits an *RRCReconfigurationComplete* message.                                                                            \--\>              NR RRC: *RRCReconfigurationComplete*   \-        \-
  17    Check: Does UE transmit *UEAssistanceInformation* message?                                                                           \--\>              NR RRC: *UEAssistanceInformation*      **2**     **P**

##### 8.1.5.10.6.3.3 Specific message contents {#specific-message-contents-31 .H6}

Table 8.1.5.10.6.3.3-1: *RRCConnectionReconfiguration* (step 7 and step
15, Table 8.1.5.10.6.3.2-2)

+------------------+------------------+---------+------------------+
| Derivation Path: |                  |         |                  |
| TS 38.508-1      |                  |         |                  |
| \[4\] Table      |                  |         |                  |
| 4.6.1-13         |                  |         |                  |
+==================+==================+=========+==================+
| Information      | Value/remark     | Comment | Condition        |
| Element          |                  |         |                  |
+------------------+------------------+---------+------------------+
| RR               |                  |         |                  |
| CReconfiguration |                  |         |                  |
| ::= SEQUENCE {   |                  |         |                  |
+------------------+------------------+---------+------------------+
| cr               |                  |         |                  |
| iticalExtensions |                  |         |                  |
| CHOICE {         |                  |         |                  |
+------------------+------------------+---------+------------------+
| rr               |                  |         |                  |
| cReconfiguration |                  |         |                  |
| SEQUENCE {       |                  |         |                  |
+------------------+------------------+---------+------------------+
| nonC             |                  |         |                  |
| riticalExtension |                  |         |                  |
| SEQUENCE {       |                  |         |                  |
+------------------+------------------+---------+------------------+
| nonC             |                  |         |                  |
| riticalExtension |                  |         |                  |
| SEQUENCE {       |                  |         |                  |
+------------------+------------------+---------+------------------+
| nonC             |                  |         |                  |
| riticalExtension |                  |         |                  |
| SEQUENCE {       |                  |         |                  |
+------------------+------------------+---------+------------------+
| nonC             |                  |         |                  |
| riticalExtension |                  |         |                  |
| SEQUENCE {       |                  |         |                  |
+------------------+------------------+---------+------------------+
| nonC             |                  |         |                  |
| riticalExtension |                  |         |                  |
| SEQUENCE {       |                  |         |                  |
+------------------+------------------+---------+------------------+
| nonC             |                  |         |                  |
| riticalExtension |                  |         |                  |
| SEQUENCE {       |                  |         |                  |
+------------------+------------------+---------+------------------+
| o                |                  |         |                  |
| therConfig-v1800 |                  |         |                  |
| SEQUENCE {       |                  |         |                  |
+------------------+------------------+---------+------------------+
| musim            |                  |         |                  |
| -CapabilityRestr |                  |         |                  |
| ictionConfig-r18 |                  |         |                  |
| CHOICE {         |                  |         |                  |
+------------------+------------------+---------+------------------+
| setup SEQUENCE { |                  |         |                  |
+------------------+------------------+---------+------------------+
| musim-Candi      | 2 entries        |         |                  |
| dateBandList-r18 |                  |         |                  |
| (SIZE(1..        |                  |         |                  |
| maxCandidat      |                  |         |                  |
| eBandIndex-r18)) |                  |         |                  |
| OF               |                  |         |                  |
| Fre              |                  |         |                  |
| qBandIndicatorNR |                  |         |                  |
| {                |                  |         |                  |
+------------------+------------------+---------+------------------+
|                  | Fre              |         | pc\_nrBandx      |
|                  | qBandIndicatorNR |         |                  |
|                  | of the band of   |         | (\'x\' being the |
|                  | NR Cell1         |         | band number/type |
|                  |                  |         | related PICS     |
|                  |                  |         | listed in TS     |
|                  |                  |         | 38.508-2 \[5\])  |
+------------------+------------------+---------+------------------+
|                  | Fre              |         |                  |
|                  | qBandIndicatorNR |         |                  |
|                  | of the band of   |         |                  |
|                  | NR Cell10        |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| mus              | ms100            |         |                  |
| im-WaitTimer-r18 |                  |         |                  |
+------------------+------------------+---------+------------------+
| musim-P          | s5               |         |                  |
| rohibitTimer-r18 |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+
| }                |                  |         |                  |
+------------------+------------------+---------+------------------+

Table 8.1.5.10.6.3.3-2: *UEAssistanceInformation* (step 9 and step 17,
Table 8.1.5.10.6.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                                                
  --------------------------------------------------- ---------------------------------- --------- -----------------------------------------------
  Information Element                                 Value/remark                       Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                           
  criticalExtensions CHOICE {                                                                      
  ueAssistanceInformation SEQUENCE {                                                               
  nonCriticalExtension SEQUENCE {                                                                  
  nonCriticalExtension SEQUENCE {                                                                  
  nonCriticalExtension SEQUENCE {                                                                  
  nonCriticalExtension SEQUENCE {                                                                  
  musim-Assistance-v1800 SEQUENCE {                                                                
  musim-CapRestriction-r18 SEQUENCE {                                                              
  musim-AffectedBandsList-r18                         Not present or any allowed value             
  musim-AvoidedBandsList-r18                          Any allowed value                            If musim-AffectedBandsList-r18 is not present
  musim-AvoidedBandsList-r18                          Not present or any allowed value             If musim-AffectedBandsList-r18 is present
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                

Table 8.1.5.10.6.3.3-3: *RRCConnectionReconfiguration* (step 11, Table
8.1.5.10.6.3.2-2)

+-----------------+-----------------+-------------+-----------------+
| Derivation      |                 |             |                 |
| Path: TS        |                 |             |                 |
| 38.508-1 \[4\]  |                 |             |                 |
| Table 4.8.1-1A  |                 |             |                 |
| with condition  |                 |             |                 |
| RBConf          |                 |             |                 |
| ig\_NoKeyChange |                 |             |                 |
+=================+=================+=============+=================+
| **Information   | *               | **Comment** | **Condition**   |
| Element**       | *Value/remark** |             |                 |
+-----------------+-----------------+-------------+-----------------+
| RRC             |                 |             |                 |
| Reconfiguration |                 |             |                 |
| ::= SEQUENCE {  |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| cri             |                 |             |                 |
| ticalExtensions |                 |             |                 |
| CHOICE {        |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| rrc             |                 |             |                 |
| Reconfiguration |                 |             |                 |
| SEQUENCE {      |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| nonCr           |                 |             |                 |
| iticalExtension |                 |             |                 |
| SEQUENCE {      |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| nonCr           |                 |             |                 |
| iticalExtension |                 |             |                 |
| SEQUENCE {      |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| nonCr           |                 |             |                 |
| iticalExtension |                 |             |                 |
| SEQUENCE {      |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| nonCr           |                 |             |                 |
| iticalExtension |                 |             |                 |
| SEQUENCE {      |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| nonCr           |                 |             |                 |
| iticalExtension |                 |             |                 |
| SEQUENCE {      |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| nonCr           |                 |             |                 |
| iticalExtension |                 |             |                 |
| SEQUENCE {      |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| ot              |                 |             |                 |
| herConfig-v1800 |                 |             |                 |
| SEQUENCE {      |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| musim-C         |                 |             |                 |
| apabilityRestri |                 |             |                 |
| ctionConfig-r18 |                 |             |                 |
| CHOICE {        |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| setup SEQUENCE  |                 |             |                 |
| {               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| musim-Candid    | 2 entries       |             |                 |
| ateBandList-r18 |                 |             |                 |
| (SIZE(1..       |                 |             |                 |
| maxCandidate    |                 |             |                 |
| BandIndex-r18)) |                 |             |                 |
| OF              |                 |             |                 |
| Freq            |                 |             |                 |
| BandIndicatorNR |                 |             |                 |
| {               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
|                 | Freq            |             | pc\_nrBandx     |
|                 | BandIndicatorNR |             |                 |
|                 | of the band of  |             | (\'x\' being    |
|                 | NR Cell1        |             | the band        |
|                 |                 |             | number/type     |
|                 |                 |             | related PICS    |
|                 |                 |             | listed in TS    |
|                 |                 |             | 38.508-2 \[5\]) |
+-----------------+-----------------+-------------+-----------------+
|                 | Freq            |             |                 |
|                 | BandIndicatorNR |             |                 |
|                 | of the band of  |             |                 |
|                 | NR Cell10       |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| musi            | ms100           |             |                 |
| m-WaitTimer-r18 |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| musim-Pr        | s5              |             |                 |
| ohibitTimer-r18 |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+
| }               |                 |             |                 |
+-----------------+-----------------+-------------+-----------------+

##### 8.1.5.10.7 UE Assistance Information / UL Traffic Information

##### 8.1.5.10.7.1 Test Purpose (TP) {#test-purpose-tp-32 .H6}

##### (1) {#section-57 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE configured to provide UL traffic information and the UL
traffic information is available, and UE did not transmit a
*UEAssistanceInformation* message with *ul-TrafficInfo* since it was
configured to provide UL traffic information }

**then** { the UE transmits a UEAssistanceInformation message }

}

##### (2) {#section-58 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE configured to provide UL traffic information and the UL
traffic information has changed with respect to the last reporting (UE
determines that the information has been updated) and timer T346l is
running }

**then** { the UE does not transmit a UEAssistanceInformation message }

}

##### (3) {#section-59 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE configured to provide UL traffic information and the UL
traffic information has changed with respect to the last reporting (UE
determines that the information has been updated) and timer T346l is not
running }

**then** { the UE transmits a UEAssistanceInformation message }

}

##### 8.1.5.10.7.2 Conformance requirements {#conformance-requirements-32 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clause 5.3.1. Unless otherwise stated
these are Rel-18 requirements.

\[TS 38.331, clause 5.7.4.1\]

The purpose of this procedure is for the UE to inform the network of:

...

\- UL traffic information; or

...

\[TS 38.331, clause 5.7.4.2\]

A UE capable of providing UL traffic information shall initiate the
procedure when this information is available upon being configured to do
so, and upon change of UL traffic information.

...

Upon initiating the procedure, the UE shall:

...

1\> if configured to provide UL traffic information:

2\> if the UE did not transmit a *UEAssistanceInformation* message with
*ul-TrafficInfo* since it was configured to provide UL traffic
information; or

2\> if UL traffic information included in the previous
*UEAssistanceInformation* has changed since the last transmission of the
*UEAssistanceInformation* message containing *ul-TrafficInfo* for at
least one QoS flow for which timer T346l is not running:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide UL traffic information.

NOTE 5: The UE only considers *burstArrivalTime* to have changed when it
changes relative to the periodicity of the Data Burst arrival.

\[TS 38.331, clause 5.7.4.3\]

The UE shall set the contents of the *UEAssistanceInformation* message
as follows:

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide UL traffic information according to 5.7.4.2 or
5.3.5.3:

2\> for each PDU session for which the UE intends to provide UL traffic
information in this *UEAssistanceInformation* message:

3\> set *pdu-SessionID* to the value of the concerned PDU session ID;

3\> if transmission of the *UEAssistanceInformation* message is
initiated to provide UL traffic information according to 5.3.5.3:

4\> stop timer T346l for each QoS flow of this PDU session for which the
UE intends to provide UL traffic information in this
*UEAssistanceInformation* message;

3\> for each QoS flow of this PDU session for which timer T346l is not
running and for which the UE intends to provide UL traffic information
in this *UEAssistanceInformation* message:

4\> start timer T346l associated to this QoS flow with the timer value
set to the value of *ul-TrafficInfoProhibitTimer*;

4\> set *qfi* to the value of the concerned QFI;

4\> if the jitter range measurement is available; and

4\> if the UE did not provide jitter range since it was configured to
provide UL traffic information, or if the measured jitter range has
changed since the last transmission of the *UEAssistanceInformation*
message containing *jitterRange*:

5\> set *jitterRange* to the latest measured value of the jitter range;

4\> if the burst arrival time measurement is available; and

4\> if the UE did not provide burst arrival time since it was configured
to provide UL traffic information, or if the measured burst arrival time
has changed since the last transmission of the *UEAssistanceInformation*
message containing *burstArrivalTime*:

5\> set *burstArrivalTime* to the latest measured value of the burst
arrival time;

4\> if the traffic periodicity measurement is available; and

4\> if the UE did not provide traffic periodicity since it was
configured to provide UL traffic information, or if the measured traffic
periodicity has changed since the last transmission of the
*UEAssistanceInformation* message containing *trafficPeriodicity*:

5\> set *trafficPeriodicity* to the latest measured value of the traffic
periodicity;

4\> if the UE did not provide *pdu-SetIdentification* since it was
configured to provide UL traffic information, or if the information
previously provided in *pdu-SetIdentification* has changed since the
last transmission of the *UEAssistanceInformation* message containing
*pdu-SetIdentification*:

5\> if the UE is able to identify PDU Set(s) for the QoS flow:

6\> set *pdu-SetIdentification* to *true*;

5\> else:

6\> set *pdu-SetIdentification* to *false*.

4\> if the UE did not provide *psi-Identification* since it was
configured to provide UL traffic information, or if the information
previously provided in *psi-Identification* has changed since the last
transmission of the *UEAssistanceInformation* message containing
*psi-Identification*:

5\> if the UE is able to identify PSI(s) for the QoS flow:

6\> set *psi-Identification* to true;

5\> else:

6\> set *psi-Identification* to *false*.

\[TS 38.331, clause 5.3.5.9\]

1\> if the received *otherConfig* includes the
*ul-TrafficInfoReportingConfig*:

2\> if *ul-TrafficInfoReportingConfig* is set to *setup*:

3\> consider itself to be configured to provide UL traffic information
in accordance with 5.7.4;

2\> else:

3\> consider itself not to be configured to provide UL traffic
information and stop all instances of timer T346l, if running;

\[TS 38.331, clause 7.1.1\]

+-----------------+-----------------+-----------------+------------+
| Timer           | Start           | Stop            | At expiry  |
+=================+=================+=================+============+
| T346l           | Upon            | Upon releasing  | No action. |
|                 | transmitting    | *               |            |
| (The UE         | *UEAssista      | ul-TrafficInfoR |            |
| maintains one   | nceInformation* | eportingConfig* |            |
| instance of     | message with    | during the      |            |
| this timer per  | *               | connection      |            |
| QoS flow)       | ul-TrafficInfo* | re-estab        |            |
|                 | for the         | lishment/resume |            |
|                 | concerned QoS   | procedures, or  |            |
|                 | flow.           | upon receiving  |            |
|                 |                 | *               |            |
|                 |                 | ul-TrafficInfoR |            |
|                 |                 | eportingConfig* |            |
|                 |                 | set to          |            |
|                 |                 | *release.*      |            |
+-----------------+-----------------+-----------------+------------+

##### 8.1.5.10.7.3 Test description {#test-description-32 .H6}

##### 8.1.5.10.7.3.1 Pre-test conditions {#pre-test-conditions-32 .H6}

##### System Simulator: {#system-simulator-24 .H6}

\- NR Cell 1.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cell 1.

##### UE: {#ue-21 .H6}

> \- None

##### Preamble: {#preamble-20 .H6}

\- The UE is in 5GS state 3N-A with one PDU session active on NR Cell 1
according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.5.10.7.3.2 Test procedure sequence {#test-procedure-sequence-32 .H6}

Table 8.1.5.10.7.3.2-1: Main behaviour

  **St**                                                                                                                                                                                                                                        **Procedure**                                                                                      **Message Sequence**   **TP**                                     **Verdict**   
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------------------------- ---------------------- ------------------------------------------ ------------- ----
                                                                                                                                                                                                                                                                                                                                                   **U - S**              **Message**                                              
  1                                                                                                                                                                                                                                             The SS transmits an *RRCReconfiguration* message to configure *ul-TrafficInfoReportingConfig*.     \--\>                  **NR RRC: *RRCReconfiguration***           \-            \-
  2                                                                                                                                                                                                                                             The UE transmits an *RRCReconfigurationComplete* message.                                          \<\--                  **NR RRC: *RRCReconfigurationComplete***   \-            \-
  3                                                                                                                                                                                                                                             Set UL Traffic information for QFI 1. (Note 1)                                                     \-                     **-**                                      \-            \-
  4                                                                                                                                                                                                                                             Check: Does the UE transmit an *UEAssistanceInformation* message including *UL-TrafficInfo-r18*?   \--\>                  NR RRC: *UEAssistanceInformation*          1             P
  5                                                                                                                                                                                                                                             Change UL Traffic information for QFI 1. (Note 1)                                                  \-                     **-**                                      \-            \-
  6                                                                                                                                                                                                                                             Check: Does the UE transmit an *UEAssistanceInformation* message before T346l expiry?              \-                     \-                                         3             F
  7                                                                                                                                                                                                                                             SS waits for timer T346l expiry.                                                                   \-                     \-                                         \-            \-
  8                                                                                                                                                                                                                                             Check: Does the UE transmit an *UEAssistanceInformation* message including *UL-TrafficInfo-r18*?   \--\>                  NR RRC: *UEAssistanceInformation*          2             P
  Note 1: The request to set or change UL Traffic information is performed by MMI or AT Command. UL Traffic information includes at least one of jitter range, burst arrival time, data burst periodicity and PDU Set and PSI identification.                                                                                                                                                                                      

##### 8.1.5.10.7.3.3 Specific message contents {#specific-message-contents-32 .H6}

Table 8.1.5.10.7.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.5.10.7.3.2-1)

+----------------------+----------------------+---------+-----------+
| Derivation Path: TS  |                      |         |           |
| 38.508-1 \[4\] Table |                      |         |           |
| 4.6.1-13             |                      |         |           |
+======================+======================+=========+===========+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| RRCReconfiguration   |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| criticalExtensions   |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| rrcReconfiguration   |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| nonCriticalExtension |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| nonCriticalExtension |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| nonCriticalExtension |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| nonCriticalExtension |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| nonCriticalExtension |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| nonCriticalExtension |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| otherConfig-v1800    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ul-TrafficInf        |                      |         |           |
| oReportingConfig-r18 |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| setup SEQUENCE {     |                      |         |           |
+----------------------+----------------------+---------+-----------+
| pd                   | 1 entry              |         |           |
| u-SessionsToReportUL |                      |         |           |
| -TrafficInfoList-r18 |                      |         |           |
| SEQUENCE (SIZE (1..  |                      |         |           |
| maxNr                |                      |         |           |
| ofPDU-Sessions-r17)) |                      |         |           |
| OF                   |                      |         |           |
| PDU-SessionToRepo    |                      |         |           |
| rtUL-TrafficInfo-r18 |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| PDU-SessionToRepo    |                      | entry 1 |           |
| rtUL-TrafficInfo-r18 |                      |         |           |
| \[1\] SEQUENCE {     |                      |         |           |
+----------------------+----------------------+---------+-----------+
| pdu-SessionID        | The same value as    |         |           |
|                      | the value set in     |         |           |
|                      | internet PDU session |         |           |
+----------------------+----------------------+---------+-----------+
| qfi-ToReportUL       | 1 entry              |         |           |
| -TrafficInfoList-r18 |                      |         |           |
| SEQUENCE (SIZE       |                      |         |           |
| (1..maxNrofQFIs)) OF |                      |         |           |
| QFI {                |                      |         |           |
+----------------------+----------------------+---------+-----------+
| QFI\[1\]             | '00 0001'B           | entry 1 |           |
|                      |                      |         |           |
|                      |                      | QFI 1   |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ul-TrafficI          | s30                  |         |           |
| nfoProhibitTimer-r18 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

Table 8.1.5.10.7.3.3-2: *UEAssistanceInformation* (step 4 and step 8,
Table 8.1.5.10.7.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30                                                                                                                                                                    
  ------------------------------------------------------------------------------------------------------------------------------------------------ --------------------------------------------------------- --------- -----------
  Information Element                                                                                                                              Value/remark                                              Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                                                                                                                                               
  criticalExtensions CHOICE {                                                                                                                                                                                          
  ueAssistanceInformation SEQUENCE {                                                                                                                                                                                   
  nonCriticalExtension SEQUENCE {                                                                                                                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                                                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                                                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                                                                                                                      
  ul-TrafficInfo-r18 SEQUENCE (SIZE (1..maxNrofPDU-Sessions-r17)) OF PDU-SessionUL-TrafficInfo-r18 {                                               1 entry                                                             
  PDU-SessionUL-TrafficInfo-r18\[1\] SEQUENCE {                                                                                                                                                              entry 1   
  pdu-SessionID-r18                                                                                                                                The same value as the value set in internet PDU session             
  qos-FlowUL-TrafficInfoList-r18 SEQUENCE (SIZE (1..maxNrofQFIs)) OF QOS-FlowUL-TrafficInfo-r18 {                                                  1 entry                                                             
  qos-FlowUL-TrafficInfoList-r18\[1\] SEQUENCE {                                                                                                                                                             entry 1   
  qfi-r18                                                                                                                                          '00 0001'B                                                QFI 1     
  jitterRange-r18                                                                                                                                  Not checked                                                         
  burstArrivalTime-r18                                                                                                                             Not checked                                                         
  trafficPeriodicity-r18                                                                                                                           Not checked                                                         
  pdu-SetIdentification-r18                                                                                                                        Present but contents not checked                                    Step 4
                                                                                                                                                   Not checked                                                         Step 8
  psi-Identification-r18                                                                                                                           Present but contents not checked                                    Step 4
                                                                                                                                                   Not checked                                                         Step 8
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                    
  Note 1: ul-TrafficInfo-r18 in step8 is different from the ul-TrafficInfo-r18 in step4 because the UL Traffic information is changed in step 5.                                                                       

##### 8.1.5.10.8 UE Assistance Information / IDC mechanism

##### 8.1.5.10.8.1 Test Purpose (TP) {#test-purpose-tp-33 .H6}

##### (1) {#section-60 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE configured to provide IDC assistance information and the
UE is experiencing IDC problems that it cannot solve by itself and UE
did not transmit a *UEAssistanceInformation* message with
*idc-Assistance* }

**then** { UE transmits a UEAssistanceInformation message to provide IDC
assistance information including IDC-Assistance-r16 }

}

##### (2) {#section-61 .H6}

**with** { UE in NR RRC\_CONNECTED state and UE already transmits a
*UEAssistanceInformation* message with *idc-Assistance* }

**ensure that** {

**when** { UE configured to provide IDC assistance information and the
UE is experiencing IDC problems that it cannot solve by itself and the
current *idc-Assistance* information is different from the one indicated
in the last *UEAssistanceInformation* message }

**then** { UE transmits a UEAssistanceInformation message to provide IDC
assistance information including IDC-Assistance-r16 }

}

##### 8.1.5.10.8.2 Conformance requirements {#conformance-requirements-33 .H6}

References: The conformance requirements covered in the present test
case are specified in TS 38.331, clause 5.3.5.9, 5.7.4.2 and 5.4.7.3.
Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.5.9\]

...

1\> if the received *otherConfig* includes the *idc-AssistanceConfig*:

2\> if *idc-AssistanceConfig* is set to *setup*:

3\> consider itself to be configured to provide IDC assistance
information in accordance with 5.7.4;

2\> else:

3\> consider itself not to be configured to provide IDC assistance
information;

...

\[TS 38.331, clause 5.7.4.2\]

Upon initiating the procedure, the UE shall:

1\> if configured to provide delay budget report:

...

1\> if configured to provide IDC assistance information based on
*candidateServingFreqListNR* included in *idc-AssistanceConfig* of a
cell group:

2\> if the UE did not transmit a *UEAssistanceInformation* message with
*idc-Assistance* since it was configured to provide IDC assistance
information:

> 3\> if on one or more frequencies included in
> *candidateServingFreqListNR*, the UE is experiencing IDC problems that
> it cannot solve by itself; or
>
> 3\> if on one or more supported UL CA or NR-DC combination comprising
> of carrier frequencies included in *candidateServingFreqListNR*, the
> UE is experiencing IDC problems that it cannot solve by itself:

4\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide IDC assistance information;

2\> else if the current *idc-Assistance* information for the cell group
is different from the one indicated in the last transmission of the
*UEAssistanceInformation* message:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide IDC assistance information;

...

\[TS 38.331, clause 5.7.4.3\]

The UE shall set the contents of the *UEAssistanceInformation* message
as follows:

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide a delay budget report according to 5.7.4.2 or
5.3.5.3;

\...

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide IDC assistance information according to 5.7.4.2 or
5.3.5.3:

2\> if there is at least one carrier frequency included in
*candidateServingFreqListNR*, the UE is experiencing IDC problems that
it cannot solve by itself:

3\> include the field *affectedCarrierFreqList* with an entry for each
affected carrier frequency included in *candidateServingFreqListNR*;

3\> for each carrier frequency included in the field
*affectedCarrierFreqList*, include *interferenceDirection* and set it
accordingly;

2\> if there is at least one supported UL CA or NR-DC combination
comprising of carrier frequencies included in
*candidateServingFreqListNR*, the UE is experiencing IDC problems that
it cannot solve by itself:

3\> include *victimSystemType* for each UL CA or NR-DC combination
included in *affectedCarrierFreqCombList*;

3\> if the UE sets *victimSystemType* to *wlan* or *bluetooth*:

4\> include *affectedCarrierFreqCombList* with an entry for each
supported UL CA combination comprising of carrier frequencies included
in *candidateServingFreqListNR*, that is affected by IDC problems;

3\> else:

4\> optionally include *affectedCarrierFreqCombList* with an entry for
each supported UL CA or NR-DC combination comprising of carrier
frequencies included in *candidateServingFreqListNR*, that is affected
by IDC problems;

\...

##### 8.1.5.10.8.3 Test description {#test-description-33 .H6}

##### 8.1.5.10.8.3.1 Pre-test conditions {#pre-test-conditions-33 .H6}

##### System Simulator: {#system-simulator-25 .H6}

\- NR Cell 14/NRf4 (2390-2400MHz for band n40) and WLAN AP 1 (Cell 27)
as specified in TS 38.508-1\[4\] clause 4.13.

\- NR Cell 1/NRf1 **(**2496-2556MHz for band n41**)** and WLAN AP 2
(Cell 27b) as specified in TS 38.508-1\[4\] clause 4.13.

##### UE: {#ue-22 .H6}

> \- UE's WLAN is on.

##### Preamble: {#preamble-21 .H6}

\- The UE is in state 3N-A on NR Cell 14 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.5.10.8.3.2 Test procedure sequence {#test-procedure-sequence-33 .H6}

Table 8.1.5.10.8.3.2-1 for FR1 illustrate the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. The exact instants on which these values
shall be applied are described in the texts in this clause. The
configuration \"T0\" indicates the initial conditions. Subsequent
configurations marked \"T1\", \"T2\" and \"T3\" are applied at the
points indicated in the Main behaviour description in Table
8.1.5.10.8.3.2-2.

Table 8.1.5.10.8.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-------+-------+-------+-------+-------+-------+-------+
|    | Para  | Unit  | NR    | WLAN  | NR    | WLAN  | R     |
|    | meter |       | Cell  | AP 1  | Cell  | AP 2  | emark |
|    |       |       | 14    | (Cell | 1     | (Cell |       |
|    |       |       |       | 27)   |       | 27b)  |       |
+====+=======+=======+=======+=======+=======+=======+=======+
| T0 | SS    | dB    | -88   |       | Off   |       | Cell  |
|    | /PBCH | m/SCS |       |       |       |       | con   |
|    |       |       |       |       |       |       | figur |
|    | SSS   |       |       |       |       |       | ation |
|    | EPRE  |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | non   |
|    |       |       |       |       |       |       | -IDC. |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Beaco | dBm   |       | Off   |       | Off   |       |
|    | nRSSI |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T1 | SS    | dB    | -88   |       | Off   |       | Cell  |
|    | /PBCH | m/SCS |       |       |       |       | con   |
|    |       |       |       |       |       |       | figur |
|    | SSS   |       |       |       |       |       | ation |
|    | EPRE  |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | IDC   |
|    |       |       |       |       |       |       | in NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 14.   |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Beaco | dBm   |       | -80   |       | Off   |       |
|    | nRSSI |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T2 | SS    | dB    | -88   |       | -79   |       | Cell  |
|    | /PBCH | m/SCS |       |       |       |       | con   |
|    |       |       |       |       |       |       | figur |
|    | SSS   |       |       |       |       |       | ation |
|    | EPRE  |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | no    |
|    |       |       |       |       |       |       | n-IDC |
|    |       |       |       |       |       |       | in NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 1.    |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Beaco | dBm   |       | Off   |       | Off   |       |
|    | nRSSI |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T3 | SS    | dB    | -88   |       | -79   |       | Cell  |
|    | /PBCH | m/SCS |       |       |       |       | con   |
|    |       |       |       |       |       |       | figur |
|    | SSS   |       |       |       |       |       | ation |
|    | EPRE  |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | IDC   |
|    |       |       |       |       |       |       | in NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 1.    |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Beaco | dBm   |       | Off   |       | -80   |       |
|    | nRSSI |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+

Table 8.1.5.10.8.3.2-2: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits a  |              | *RRCReco     |         |    |
|    | RRCRec       |              | nfiguration* |         |    |
|    | onfiguration |              |              |         |    |
|    | message      |              |              |         |    |
|    | including    |              |              |         |    |
|    | OtherConfig  |              |              |         |    |
|    | with         |              |              |         |    |
|    | idc-Assistan |              |              |         |    |
|    | ceConfig-r16 |              |              |         |    |
|    | including    |              |              |         |    |
|    | Candid       |              |              |         |    |
|    | ateServingFr |              |              |         |    |
|    | eqListNR-r16 |              |              |         |    |
|    | including    |              |              |         |    |
|    | center       |              |              |         |    |
|    | frequency    |              |              |         |    |
|    | for NR Cell  |              |              |         |    |
|    | 14 and NR    |              |              |         |    |
|    | Cell 1.      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRC         |         |    |
|    | RR           |              | Reconfigurat |         |    |
|    | CReconfigura |              | ionComplete* |         |    |
|    | tionComplete |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the power    |              |              |         |    |
|    | levels       |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T1\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.5        |              |              |         |    |
|    | .10.8.3.2-1. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | Void         | \-           | \-           | \-      | \- |
+----+--------------+--------------+--------------+---------+----+
| 5  | The UE       |              |              |         |    |
|    | associates   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | WLAN AP1 and |              |              |         |    |
|    | obtains the  |              |              |         |    |
|    | local IP     |              |              |         |    |
|    | address of   |              |              |         |    |
|    | WLAN AP1.    |              |              |         |    |
|    |              |              |              |         |    |
|    | Note: The UL |              |              |         |    |
|    | signal to    |              |              |         |    |
|    | WLAN AP      |              |              |         |    |
|    | shall        |              |              |         |    |
|    | generate IDC |              |              |         |    |
|    | problem. The |              |              |         |    |
|    | UE shall     |              |              |         |    |
|    | detect IDC   |              |              |         |    |
|    | problem with |              |              |         |    |
|    | "T1" in      |              |              |         |    |
|    | RR           |              |              |         |    |
|    | C\_CONNECTED |              |              |         |    |
|    | in NR Cell   |              |              |         |    |
|    | 14.          |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | Check: Does  | \--\>        | NR RRC:      | 1       | P  |
|    | the UE       |              | *            |         |    |
|    | transmit an  |              | UEAssistance |         |    |
|    | *an          |              | Information* |         |    |
|    | UEAssistanc  |              |              |         |    |
|    | eInformation |              |              |         |    |
|    | message      |              |              |         |    |
|    | including    |              |              |         |    |
|    | IDC-Ass      |              |              |         |    |
|    | istance-r16* |              |              |         |    |
|    | with at      |              |              |         |    |
|    | least one    |              |              |         |    |
|    | affected     |              |              |         |    |
|    | carrier      |              |              |         |    |
|    | frequency    |              |              |         |    |
|    | including    |              |              |         |    |
|    | the carrier  |              |              |         |    |
|    | frequency of |              |              |         |    |
|    | NR Cell 14   |              |              |         |    |
|    | in           |              |              |         |    |
|    | *a           |              |              |         |    |
|    | ffectedCarri |              |              |         |    |
|    | erFreqList*? |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | Void         | \-           | \-           | \-      | \- |
+----+--------------+--------------+--------------+---------+----+
| 8  | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the power    |              |              |         |    |
|    | levels       |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T2\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.5        |              |              |         |    |
|    | .10.8.3.2-1. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | Void         | \-           | \-           | \-      | \- |
+----+--------------+--------------+--------------+---------+----+
| 10 | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRCReco     |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    | *including   |              |              |         |    |
|    | to order the |              |              |         |    |
|    | UE to        |              |              |         |    |
|    | perform      |              |              |         |    |
|    | int          |              |              |         |    |
|    | er-frequency |              |              |         |    |
|    | handover to  |              |              |         |    |
|    | NR Cell 1*   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 11 | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmit     |              | *RRC         |         |    |
|    | RR           |              | Reconfigurat |         |    |
|    | CReconfigura |              | ionComplete* |         |    |
|    | tionComplete |              |              |         |    |
|    | message in   |              |              |         |    |
|    | NR Cell 1.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 12 | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the power    |              |              |         |    |
|    | levels       |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T3\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.5        |              |              |         |    |
|    | .10.8.3.2-1. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 13 | The UE       |              |              |         |    |
|    | associates   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | WLAN AP2 and |              |              |         |    |
|    | obtains the  |              |              |         |    |
|    | local IP     |              |              |         |    |
|    | address of   |              |              |         |    |
|    | WLAN AP2.    |              |              |         |    |
|    |              |              |              |         |    |
|    | Note: The UL |              |              |         |    |
|    | signal to    |              |              |         |    |
|    | WLAN AP      |              |              |         |    |
|    | shall        |              |              |         |    |
|    | generate IDC |              |              |         |    |
|    | problem. The |              |              |         |    |
|    | UE shall     |              |              |         |    |
|    | detect IDC   |              |              |         |    |
|    | problem with |              |              |         |    |
|    | "T3" in      |              |              |         |    |
|    | RR           |              |              |         |    |
|    | C\_CONNECTED |              |              |         |    |
|    | in NR Cell   |              |              |         |    |
|    | 1.           |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 14 | Check: Does  | \--\>        | NR RRC:      | 2       | P  |
|    | the UE       |              | *            |         |    |
|    | transmit an  |              | UEAssistance |         |    |
|    | *an          |              | Information* |         |    |
|    | UEAssistanc  |              |              |         |    |
|    | eInformation |              |              |         |    |
|    | message      |              |              |         |    |
|    | including    |              |              |         |    |
|    | IDC-Ass      |              |              |         |    |
|    | istance-r16* |              |              |         |    |
|    | with at      |              |              |         |    |
|    | least one    |              |              |         |    |
|    | affected     |              |              |         |    |
|    | carrier      |              |              |         |    |
|    | frequency    |              |              |         |    |
|    | including    |              |              |         |    |
|    | the carrier  |              |              |         |    |
|    | frequency of |              |              |         |    |
|    | NR Cell 1 in |              |              |         |    |
|    | *            |              |              |         |    |
|    | affectedCarr |              |              |         |    |
|    | ierFreqList, |              |              |         |    |
|    | which is     |              |              |         |    |
|    | different    |              |              |         |    |
|    | from the one |              |              |         |    |
|    | in Step 6*?  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.5.10.8.3.3 Specific message contents {#specific-message-contents-33 .H6}

Table 8.1.5.10.8.3.3-1: RRCReconfiguration (step 1, Table
8.1.5.10.8.3.2-2)

  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-13                                                                              
  --------------------------------------------------------------------------------------- ----------------------------- --------- -----------
  Information Element                                                                     Value/remark                  Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                               
  criticalExtensions CHOICE {                                                                                                     
  rrcReconfiguration SEQUENCE {                                                                                                   
  nonCriticalExtension SEQUENCE {                                                                                                 
  nonCriticalExtension SEQUENCE {                                                                                                 
  nonCriticalExtension SEQUENCE {                                                                                                 
  nonCriticalExtension SEQUENCE {                                                                                                 
  otherConfig-v1610 SEQUENCE {                                                                                                    
  idc-AssistanceConfig-r16 **CHOICE {**                                                                                           
  setup SEQUENCE {                                                                                                                
  candidateServingFreqListNR-r16 SEQUENCE (SIZE (1..maxFreqIDC-r16)) OF ARFCN-ValueNR {   2 entries                               
  ARFCN-ValueNR\[1\]                                                                      ARFCN-ValueNR of NR Cell 14             
  ARFCN-ValueNR\[2\]                                                                      ARFCN-ValueNR of NR Cell 1              
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               
  }                                                                                                                               

Table 8.1.5.10.8.3.3-2: Void

Table 8.1.5.10.8.3.3-3: Void

Table 8.1.5.10.8.3.3-4: UEAssistanceInformation (step 6, Table
8.1.5.10.8.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-30                                           
  ---------------------------------------------------- ----------------------------- --------- -----------
  Information Element                                  Value/remark                  Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                       
  criticalExtensions CHOICE {                                                                  
  ueAssistanceInformation SEQUENCE {                                                           
  nonCriticalExtension SEQUENCE {                                                              
  overheatingAssistance                                Not checked                             
  nonCriticalExtension SEQUENCE {                                                              
  idc-Assistance-r16 SEQUENCE {                                                                
  affectedCarrierFreqList-r16 SEQUENCE {               1 enrty                                 
  AffectedCarrierFreq-r16 SEQUENCE {                                                           
  carrierFreq-r16                                      ARFCN-ValueNR of NR Cell 14             
  interferenceDirection-r16                            nr                                      
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            

Table 8.1.5.10.8.3.3-5: Void

Table 8.1.5.10.8.3.3-6: RRCReconfiguration (step 10, Table
8.1.5.10.8.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] 4.8.1-1A with condition RBConfig\_KeyChange                                                                 
  -------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------
  Information Element                                                              Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                              
  criticalExtensions CHOICE {                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                  
  nonCriticalExtension SEQUENCE{                                                                                                                 
  masterCellGroup                                                                  CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

Table 8.1.5.10.8.3.3-7: CellGroupConfig (Table 8.1.5.10.8.3.3-6)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change and CFRA                                             
  ------------------------------------------------------------------------------------------ ------------------------------- --------- -----------
  Information Element                                                                        Value/remark                    Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                       
  spCellConfig SEQUENCE {                                                                                                              
  reconfigurationWithSync SEQUENCE {                                                                                                   
  spCellConfigCommon SEQUENCE {                                                                                                        
  physCellId                                                                                 Physical cell Id of NR Cell 1             
  }                                                                                                                                    
  }                                                                                                                                    
  }                                                                                                                                    
  }                                                                                                                                    

Table 8.1.5.10.8.3.3-8: UEAssistanceInformation (step 14, Table
8.1.5.10.8.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-30                                          
  ---------------------------------------------------- ---------------------------- --------- -----------
  Information Element                                  Value/remark                 Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                      
  criticalExtensions CHOICE {                                                                 
  ueAssistanceInformation SEQUENCE {                                                          
  nonCriticalExtension SEQUENCE {                                                             
  overheatingAssistance                                Not checked                            
  nonCriticalExtension SEQUENCE {                                                             
  idc-Assistance-r16 SEQUENCE {                                                               
  affectedCarrierFreqList-r16 SEQUENCE {               1 entry                                
  AffectedCarrierFreq-r16 SEQUENCE {                                                          
  carrierFreq-r16                                      ARFCN-ValueNR of NR Cell 1             
  interferenceDirection-r16                            nr                                     
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           

##### 8.1.5.10.9 UE Assistance Information / IDC / FDM assistance configuration

##### 8.1.5.10.9.1 Test Purpose (TP) {#test-purpose-tp-34 .H6}

##### (1) {#section-62 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE configured to provide IDC assistance information based on
idc-FDM-AssistanceConfig and UE did not transmit a
UEAssistanceInformation message with *idc-FDM-Assistance* and UE is
experiencing IDC problems that it cannot solve by itself }

**then** { The UE transmits a UEAssistanceInformation message to provide
IDC assistance information }

}

##### (2) {#section-63 .H6}

**with** { UE in NR RRC\_CONNECTED state and UE already transmits a
*UEAssistanceInformation* message with *idc-FDM-Assistance* }

**ensure that** {

**when** { UE configured to provide IDC assistance information based on
idc-FDM-AssistanceConfig and the current idc-FDM-Assistance information
for the cell group is different from the one indicated in the last
transmission of the UEAssistanceInformation message and UE is
experiencing IDC problems that it cannot solve by itself }

**then** { The UE transmits a UEAssistanceInformation message to provide
IDC assistance information }

}

##### 8.1.5.10.9.2 Conformance requirements {#conformance-requirements-34 .H6}

References: The conformance requirements covered in the present test
case are specified in TS 38.331, clause 5.3.5.9, 5.7.4.2 and 5.4.7.3.
Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.5.9\]

......

1\> if the received *otherConfig* includes the *idc-AssistanceConfig*:

2\> if *idc-AssistanceConfig* is set to *setup*:

3\> consider itself to be configured to provide IDC assistance
information in accordance with 5.7.4;

2\> else:

3\> consider itself not to be configured to provide IDC assistance
information;

...

\[TS 38.331, clause 5.7.4.2\]

Upon initiating the procedure, the UE shall:

1\> if configured to provide delay budget report:

...

> 1\> if configured to provide IDC assistance information based on
> *idc-FDM-AssistanceConfig* included in *idc-AssistanceConfig* of a
> cell group:
>
> 2\> if the UE did not transmit a *UEAssistanceInformation* message
> with *idc-FDM-Assistance* since it was configured to provide IDC
> assistance information:
>
> 3\> if on one or more frequency ranges included in
> *candidateServingFreqRangeListNR*, the UE is experiencing IDC problems
> that it cannot solve by itself; or
>
> 3\> if on one or more supported UL CA or NR-DC combination comprising
> of frequency ranges included in *candidateServingFreqRangeListNR*, the
> UE is experiencing IDC problems that it cannot solve by itself:
>
> 4\> initiate transmission of the *UEAssistanceInformation* message in
> accordance with 5.7.4.3 to provide IDC assistance information;
>
> 2\> else if the current *idc-FDM-Assistance* information for the cell
> group is different from the one indicated in the last transmission of
> the *UEAssistanceInformation* message:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide IDC assistance information;

......

\[TS 38.331, clause 5.7.4.3\]

The UE shall set the contents of the *UEAssistanceInformation* message
as follows:

......

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide IDC assistance information according to 5.7.4.2 or
5.3.5.3:

......

> 2\> if there is at least one affected frequency range overlapping with
> one candidate frequency range included in
> *candidateServingFreqRangeListNR, and the center frequency of the
> affected* frequency range is within the candidate frequency range
> included in *candidateServingFreqRangeListNR,* the UE is experiencing
> IDC problems that it cannot solve by itself:
>
> 3\> include the field *affectedCarrierFreqRangeList* with an entry for
> each affected frequency range;
>
> 3\> for each affected frequency range included in the field
> *affectedCarrierFreqRangeList*, include *centerFreq* and
> *affectedBandwidth*;
>
> 3\> for each affected frequency range included in the field
> *affectedCarrierFreqRangeList*, include *interferenceDirection* and
> optionally *victimSystemType*, and set it accordingly;
>
> 2\> if there is at least one supported UL CA or NR-DC combinations
> comprising of candidate frequency ranges included in
> *candidateServingFreqRangeListNR*, and each affected frequency range
> in the UL CA or NR-DC combination overlapping with one candidate
> frequency range included in *candidateServingFreqRangeListNR, and the
> center frequency of the* affected frequency range is within the
> candidate frequency range included in
> *candidateServingFreqRangeListNR,* the UE is experiencing IDC problems
> that it cannot solve by itself:
>
> 3\> include the field *affectedCarrierFreqRangeCombList* with an entry
> for each supported UL CA or NR-DC combination comprising of frequency
> ranges that is affected by IDC problems;
>
> 3\> for each affected frequency range included in the field
> *affectedCarrierFreqRangeCombList*, include *centerFreq* and
> *affectedBandwidth*;
>
> 3\> for each UL CA or NR-DC combination included in the field
> *affectedCarrierFreqRangeCombList*, include *interferenceDirection*
> and optionally *victimSystemType*, and set it accordingly;

...

##### 8.1.5.10.9.3 Test description {#test-description-34 .H6}

##### 8.1.5.10.9.3.1 Pre-test conditions {#pre-test-conditions-34 .H6}

##### System Simulator: {#system-simulator-26 .H6}

\- NR Cell 14/NRf4 (2390-2400MHz for band n40) and WLAN AP 1 (Cell 27)
as specified in TS 38.508-1\[4\] clause 4.13.

\- NR Cell 1/NRf1 **(**2496-2556MHz for band n41**)** and WLAN AP 2
(Cell 27b) as specified in TS 38.508-1\[4\] clause 4.13.

##### UE: {#ue-23 .H6}

> \- UE's WLAN is on.

##### Preamble: {#preamble-22 .H6}

\- The UE is in state 3N-A on NR Cell 14 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.5.10.9.3.2 Test procedure sequence {#test-procedure-sequence-34 .H6}

Table 8.1.5.10.9.3.2-1 for FR1 illustrate the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. The exact instants on which these values
shall be applied are described in the texts in this clause. The
configuration \"T0\" indicates the initial conditions. Subsequent
configurations marked \"T1\", \"T2\" and \"T3\" are applied at the
points indicated in the Main behaviour description in Table
8.1.5.10.9.3.2-2.

Table 8.1.5.10.9.3.2-1: Time instances of cell power level and parameter
changes for FR1

+----+-------+-------+-------+-------+-------+-------+-------+
|    | Para  | Unit  | NR    | WLAN  | NR    | WLAN  | R     |
|    | meter |       | Cell  | AP 1  | Cell  | AP 2  | emark |
|    |       |       | 14    | (Cell | 1     | (Cell |       |
|    |       |       |       | 27)   |       | 27b)  |       |
+====+=======+=======+=======+=======+=======+=======+=======+
| T0 | SS    | dB    | -88   |       | Off   |       | Cell  |
|    | /PBCH | m/SCS |       |       |       |       | con   |
|    |       |       |       |       |       |       | figur |
|    | SSS   |       |       |       |       |       | ation |
|    | EPRE  |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | non   |
|    |       |       |       |       |       |       | -IDC. |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Beaco | dBm   |       | Off   |       | Off   |       |
|    | nRSSI |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T1 | SS    | dB    | -88   |       | Off   |       | Cell  |
|    | /PBCH | m/SCS |       |       |       |       | con   |
|    |       |       |       |       |       |       | figur |
|    | SSS   |       |       |       |       |       | ation |
|    | EPRE  |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | IDC   |
|    |       |       |       |       |       |       | in NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 14.   |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Beaco | dBm   |       | -80   |       | Off   |       |
|    | nRSSI |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T2 | SS    | dB    | -88   |       | -79   |       | Cell  |
|    | /PBCH | m/SCS |       |       |       |       | con   |
|    |       |       |       |       |       |       | figur |
|    | SSS   |       |       |       |       |       | ation |
|    | EPRE  |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | no    |
|    |       |       |       |       |       |       | n-IDC |
|    |       |       |       |       |       |       | in NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 1.    |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Beaco | dBm   |       | Off   |       | Off   |       |
|    | nRSSI |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+
| T3 | SS    | dB    | -88   |       | -79   |       | Cell  |
|    | /PBCH | m/SCS |       |       |       |       | con   |
|    |       |       |       |       |       |       | figur |
|    | SSS   |       |       |       |       |       | ation |
|    | EPRE  |       |       |       |       |       | for   |
|    |       |       |       |       |       |       | IDC   |
|    |       |       |       |       |       |       | in NR |
|    |       |       |       |       |       |       | Cell  |
|    |       |       |       |       |       |       | 1.    |
+----+-------+-------+-------+-------+-------+-------+-------+
|    | Beaco | dBm   |       | Off   |       | -80   |       |
|    | nRSSI |       |       |       |       |       |       |
+----+-------+-------+-------+-------+-------+-------+-------+

Table 8.1.5.10.9.3.2-2: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits a  |              | *RRCReco     |         |    |
|    | RRCRec       |              | nfiguration* |         |    |
|    | onfiguration |              |              |         |    |
|    | message      |              |              |         |    |
|    | including    |              |              |         |    |
|    | OtherConfig  |              |              |         |    |
|    | with         |              |              |         |    |
|    | idc-         |              |              |         |    |
|    | FDM-Assistan |              |              |         |    |
|    | ceConfig-r18 |              |              |         |    |
|    | including    |              |              |         |    |
|    | CandidateSe  |              |              |         |    |
|    | rvingFreqRan |              |              |         |    |
|    | geListNR-r18 |              |              |         |    |
|    | including    |              |              |         |    |
|    | center       |              |              |         |    |
|    | frequency    |              |              |         |    |
|    | and          |              |              |         |    |
|    | bandwidth    |              |              |         |    |
|    | for NR Cell  |              |              |         |    |
|    | 14 and NR    |              |              |         |    |
|    | Cell 1.      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRC         |         |    |
|    | RR           |              | Reconfigurat |         |    |
|    | CReconfigura |              | ionComplete* |         |    |
|    | tionComplete |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the power    |              |              |         |    |
|    | levels       |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T1\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.5        |              |              |         |    |
|    | .10.9.3.2-1. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | The UE       | \-           | \-           | \-      | \- |
|    | associates   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | WLAN AP1 and |              |              |         |    |
|    | obtains the  |              |              |         |    |
|    | local IP     |              |              |         |    |
|    | address of   |              |              |         |    |
|    | WLAN AP1.    |              |              |         |    |
|    |              |              |              |         |    |
|    | Note: The UL |              |              |         |    |
|    | signal to    |              |              |         |    |
|    | WLAN AP      |              |              |         |    |
|    | shall        |              |              |         |    |
|    | generate IDC |              |              |         |    |
|    | problem. The |              |              |         |    |
|    | UE shall     |              |              |         |    |
|    | detect IDC   |              |              |         |    |
|    | problem with |              |              |         |    |
|    | "T1" in      |              |              |         |    |
|    | RR           |              |              |         |    |
|    | C\_CONNECTED |              |              |         |    |
|    | in NR Cell   |              |              |         |    |
|    | 14.          |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | Check: Does  | \--\>        | NR RRC:      | 1       | P  |
|    | the UE       |              | *            |         |    |
|    | transmit an  |              | UEAssistance |         |    |
|    | *UEAssistanc |              | Information* |         |    |
|    | eInformation |              |              |         |    |
|    | message      |              |              |         |    |
|    | including    |              |              |         |    |
|    | idc-FDM-Ass  |              |              |         |    |
|    | istance-r18* |              |              |         |    |
|    | with at      |              |              |         |    |
|    | least one    |              |              |         |    |
|    | Affe         |              |              |         |    |
|    | ctedCarrierF |              |              |         |    |
|    | reqRange-r18 |              |              |         |    |
|    | entry with   |              |              |         |    |
|    | ce           |              |              |         |    |
|    | nterFreq-r18 |              |              |         |    |
|    | and          |              |              |         |    |
|    | affectedB    |              |              |         |    |
|    | andwidth-r18 |              |              |         |    |
|    | information? |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the power    |              |              |         |    |
|    | levels       |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T2\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.5        |              |              |         |    |
|    | .10.9.3.2-1. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRCReco     |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    | *including   |              |              |         |    |
|    | to order the |              |              |         |    |
|    | UE to        |              |              |         |    |
|    | perform      |              |              |         |    |
|    | int          |              |              |         |    |
|    | er-frequency |              |              |         |    |
|    | handover to  |              |              |         |    |
|    | NR Cell 1.*  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmit     |              | *RRC         |         |    |
|    | RR           |              | Reconfigurat |         |    |
|    | CReconfigura |              | ionComplete* |         |    |
|    | tionComplete |              |              |         |    |
|    | message in   |              |              |         |    |
|    | NR Cell 1.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8A | The SS       | \-           | \-           | \-      | \- |
|    | re-adjusts   |              |              |         |    |
|    | the power    |              |              |         |    |
|    | levels       |              |              |         |    |
|    | according to |              |              |         |    |
|    | row \"T3\"   |              |              |         |    |
|    | in Table     |              |              |         |    |
|    | 8.1.5        |              |              |         |    |
|    | .10.9.3.2-1. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | The UE       | \-           | \-           | \-      | \- |
|    | associates   |              |              |         |    |
|    | with the     |              |              |         |    |
|    | WLAN AP2 and |              |              |         |    |
|    | obtains the  |              |              |         |    |
|    | local IP     |              |              |         |    |
|    | address of   |              |              |         |    |
|    | WLAN AP2.    |              |              |         |    |
|    |              |              |              |         |    |
|    | Note: The UL |              |              |         |    |
|    | signal to    |              |              |         |    |
|    | WLAN AP      |              |              |         |    |
|    | shall        |              |              |         |    |
|    | generate IDC |              |              |         |    |
|    | problem. The |              |              |         |    |
|    | UE shall     |              |              |         |    |
|    | detect IDC   |              |              |         |    |
|    | problem with |              |              |         |    |
|    | "T3" in      |              |              |         |    |
|    | RR           |              |              |         |    |
|    | C\_CONNECTED |              |              |         |    |
|    | in NR Cell   |              |              |         |    |
|    | 1.           |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 10 | Check: Does  | \--\>        | NR RRC:      | 2       | P  |
|    | the UE       |              | *            |         |    |
|    | transmit an  |              | UEAssistance |         |    |
|    | *UEAssistanc |              | Information* |         |    |
|    | eInformation |              |              |         |    |
|    | message      |              |              |         |    |
|    | including    |              |              |         |    |
|    | idc-FDM-Ass  |              |              |         |    |
|    | istance-r18* |              |              |         |    |
|    | with at      |              |              |         |    |
|    | least one    |              |              |         |    |
|    | Affe         |              |              |         |    |
|    | ctedCarrierF |              |              |         |    |
|    | reqRange-r18 |              |              |         |    |
|    | entry with   |              |              |         |    |
|    | ce           |              |              |         |    |
|    | nterFreq-r18 |              |              |         |    |
|    | and          |              |              |         |    |
|    | affectedB    |              |              |         |    |
|    | andwidth-r18 |              |              |         |    |
|    | information  |              |              |         |    |
|    | different    |              |              |         |    |
|    | from the     |              |              |         |    |
|    | information  |              |              |         |    |
|    | in Step 5?   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.5.10.9.3.3 Specific message contents {#specific-message-contents-34 .H6}

Table 8.1.5.10.9.3.3-1: RRCReconfiguration (step 1, Table
8.1.5.10.9.3.2-2)

  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-13                                                                                                     
  -------------------------------------------------------------------------------------------------------------- ----------------------------- --------- -----------
  Information Element                                                                                            Value/remark                  Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                      
  criticalExtensions CHOICE {                                                                                                                            
  rrcReconfiguration SEQUENCE {                                                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                                                        
  nonCriticalExtension SEQUENCE {                                                                                                                        
  nonCriticalExtension SEQUENCE {                                                                                                                        
  nonCriticalExtension SEQUENCE {                                                                                                                        
  nonCriticalExtensionotherConfig-v1610 SEQUENCE {                                                                                                       
  nonCriticalExtension SEQUENCE {                                                                                                                        
  otherConfig-v1800 SEQUENCE {                                                                                                                           
  idc-AssistanceConfig-v1800 **CHOICE {**                                                                                                                
  setup SEQUENCE {                                                                                                                                       
  idc-FDM-AssistanceConfig-r18 **CHOICE {**                                                                                                              
  setup SEQUENCE {                                                                                                                                       
  candidateServingFreqRangeListNR-r18 SEQUENCE (SIZE (1..maxFreqIDC-r16)) OF CandidateServingFreqRangeNR-r18 {   2 entries                               
  CandidateServingFreqRangeNR-r18\[1\] SEQUENCE {                                                                                                        
  candidateCenterFreq-r18                                                                                        ARFCN-ValueNR of NR Cell 14             
  candidateBandwidth-r18                                                                                         mhz10                                   
  }                                                                                                                                                      
  CandidateServingFreqRangeNR-r18\[2\] SEQUENCE {                                                                                                        
  candidateCenterFreq-r18                                                                                        ARFCN-ValueNR of NR Cell 1              
  candidateBandwidth-r18                                                                                         mhz60                                   
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      
  }                                                                                                                                                      

Table 8.1.5.10.9.3.3-2: UEAssistanceInformation (step 5, Table
8.1.5.10.9.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-30                                                                                
  -------------------------------------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                                                      Value/remark   Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                                                            
  criticalExtensions CHOICE {                                                                                                       
  ueAssistanceInformation SEQUENCE {                                                                                                
  nonCriticalExtension SEQUENCE {                                                                                                   
  overheatingAssistance                                                                                    Not checked              
  nonCriticalExtension SEQUENCE {                                                                                                   
  nonCriticalExtension SEQUENCE {                                                                                                   
  nonCriticalExtension SEQUENCE {                                                                                                   
  idc-FDM-Assistance-r18 SEQUENCE {                                                                                                 
  affectedCarrierFreqRangeList-r18 SEQUENCE (SIZE (1..maxFreqIDC-r16)) OF AffectedCarrierFreqRange-r18 {   1 entry                  
  AffectedCarrierFreqRange-r18 SEQUENCE {                                                                                           
  affectedFreqRange-r18 SEQUENCE {                                                                                                  
  centerFreq-r18                                                                                           Present                  
  affectedBandwidth-r18                                                                                    Present                  
  }                                                                                                                                 
  interferenceDirection-r18                                                                                nr                       
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 

Table 8.1.5.10.9.3.3-3: RRCReconfiguration (step 7, Table
8.1.5.10.9.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] 4.8.1-1A with condition RBConfig\_KeyChange                                                                 
  -------------------------------------------------------------------------------- ----------------- ------------------------------------------- -----------
  Information Element                                                              Value/remark      Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                              
  criticalExtensions CHOICE {                                                                                                                    
  rrcReconfiguration SEQUENCE {                                                                                                                  
  nonCriticalExtension SEQUENCE{                                                                                                                 
  masterCellGroup                                                                  CellGroupConfig   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              
  }                                                                                                                                              

Table 8.1.5.10.9.3.3-4: CellGroupConfig (Table 8.1.5.10.9.3.3-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change and CFRA                                             
  ------------------------------------------------------------------------------------------ ------------------------------- --------- -----------
  Information Element                                                                        Value/remark                    Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                       
  spCellConfig SEQUENCE {                                                                                                              
  reconfigurationWithSync SEQUENCE {                                                                                                   
  spCellConfigCommon SEQUENCE {                                                                                                        
  physCellId                                                                                 Physical cell Id of NR Cell 1             
  }                                                                                                                                    
  }                                                                                                                                    
  }                                                                                                                                    
  }                                                                                                                                    

Table 8.1.5.10.9.3.3-5: UEAssistanceInformation (step 10, Table
8.1.5.10.9.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-30                                                                                
  -------------------------------------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                                                      Value/remark   Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                                                            
  criticalExtensions CHOICE {                                                                                                       
  ueAssistanceInformation SEQUENCE {                                                                                                
  nonCriticalExtension SEQUENCE {                                                                                                   
  overheatingAssistance                                                                                    Not checked              
  nonCriticalExtension SEQUENCE {                                                                                                   
  nonCriticalExtension SEQUENCE {                                                                                                   
  nonCriticalExtension SEQUENCE {                                                                                                   
  idc-FDM-Assistance-r18 SEQUENCE {                                                                                                 
  affectedCarrierFreqRangeList-r18 SEQUENCE (SIZE (1..maxFreqIDC-r16)) OF AffectedCarrierFreqRange-r18 {   1 entry                  
  AffectedCarrierFreqRange-r18 SEQUENCE {                                                                                           
  affectedFreqRange-r18 SEQUENCE {                                                                                                  
  centerFreq-r18                                                                                           Present                  
  affectedBandwidth-r18                                                                                    Present                  
  }                                                                                                                                 
  interferenceDirection-r18                                                                                nr                       
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 

##### 8.1.5.10.10 UE Assistance Information / IDC / TDM assistance configuration

##### 8.1.5.10.10.1 Test Purpose (TP) {#test-purpose-tp-35 .H6}

##### (1) {#section-64 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE configured to provide IDC assistance information based on
idc-TDM-AssistanceConfig and UE did not transmit a
UEAssistanceInformation message with idc-TDM-Assistance and UE is
experiencing IDC problems that it cannot solve by itself }

**then** { The UE transmits a UEAssistanceInformation message to provide
IDC assistance information }

}

##### (2) {#section-65 .H6}

**with** { UE in NR RRC\_CONNECTED state and UE already transmits a
*UEAssistanceInformation* message with *idc-TDM-Assistance* }

**ensure that** {

**when** { UE configured to provide IDC assistance information based on
idc-TDM-AssistanceConfig and the current idc-TDM-Assistance information
for the cell group is different from the one indicated in the last
transmission of the UEAssistanceInformation message and UE is
experiencing IDC problems that it cannot solve by itself }

**then** { The UE transmits a UEAssistanceInformation message to provide
IDC assistance information }

}

##### 8.1.5.10.10.2 Conformance requirements {#conformance-requirements-35 .H6}

References: The conformance requirements covered in the present test
case are specified in TS 38.331, clause 5.7.4.2 and 5.4.7.3. Unless
otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.7.4.2\]

Upon initiating the procedure, the UE shall:

1\> if configured to provide delay budget report:

...

1\> if configured to provide IDC assistance information based on
*idc-FDM-AssistanceConfig* included in *idc-AssistanceConfig* of a cell
group:

2\> if the UE did not transmit a *UEAssistanceInformation* message with
*idc-FDM-Assistance* since it was configured to provide IDC assistance
information:

3\> if on one or more frequency ranges included in
*candidateServingFreqRangeListNR*, the UE is experiencing IDC problems
that it cannot solve by itself; or

3\> if on one or more supported UL CA or NR-DC combination comprising of
frequency ranges included in *candidateServingFreqRangeListNR*, the UE
is experiencing IDC problems that it cannot solve by itself:

4\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide IDC assistance information;

2\> else if the current *idc-FDM-Assistance* information for the cell
group is different from the one indicated in the last transmission of
the *UEAssistanceInformation* message:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide IDC assistance information;

1\> if configured to provide IDC assistance information based on
*idc-TDM-AssistanceConfig* included in *idc-AssistanceConfig* of a cell
group:

2\> if the UE did not transmit a *UEAssistanceInformation* message with
*idc-TDM-Assistance* since it was configured to provide IDC assistance
information:

3\> if on one or more frequencies included in
*candidateServingFreqListNR* or frequency ranges included in
*candidateServingFreqRangeListNR*, the UE is experiencing IDC problems
that it cannot solve by itself; or

3\> if on one or more supported UL CA or NR-DC combination comprising of
carrier frequencies included in *candidateServingFreqListNR* or
frequency ranges included in *candidateServingFreqRangeListNR*, the UE
is experiencing IDC problems that it cannot solve by itself:

4\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide IDC assistance information;

2\> else if the current *idc-TDM-Assistance* information for the cell
group is different from the one indicated in the last transmission of
the *UEAssistanceInformation* message:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide IDC assistance information;

...

\[TS 38.331, clause 5.7.4.3\]

The UE shall set the contents of the *UEAssistanceInformation* message
as follows:

...

1\> if transmission of the *UEAssistanceInformation* message is
initiated to provide IDC assistance information according to 5.7.4.2 or
5.3.5.3:

...

2\> if there is at least one affected frequency range overlapping with
one candidate frequency range included in
*candidateServingFreqRangeListNR, and the center frequency of the
affected* frequency range is within the candidate frequency range
included in *candidateServingFreqRangeListNR,* the UE is experiencing
IDC problems that it cannot solve by itself:

3\> include the field *affectedCarrierFreqRangeList* with an entry for
each affected frequency range;

3\> for each affected frequency range included in the field
*affectedCarrierFreqRangeList*, include *centerFreq* and
*affectedBandwidth*;

3\> for each affected frequency range included in the field
*affectedCarrierFreqRangeList*, include *interferenceDirection* and
optionally *victimSystemType*, and set it accordingly;

2\> if there is at least one supported UL CA or NR-DC combinations
comprising of candidate frequency ranges included in
*candidateServingFreqRangeListNR*, and each affected frequency range in
the UL CA or NR-DC combination overlapping with one candidate frequency
range included in *candidateServingFreqRangeListNR, and the center
frequency of the* affected frequency range is within the candidate
frequency range included in *candidateServingFreqRangeListNR,* the UE is
experiencing IDC problems that it cannot solve by itself:

3\> include the field *affectedCarrierFreqRangeCombList* with an entry
for each supported UL CA or NR-DC combination comprising of frequency
ranges that is affected by IDC problems;

3\> for each affected frequency range included in the field
*affectedCarrierFreqRangeCombList*, include *centerFreq* and
*affectedBandwidth*;

3\> for each UL CA or NR-DC combination included in the field
*affectedCarrierFreqRangeCombList*, include *interferenceDirection* and
optionally *victimSystemType*, and set it accordingly;

2\> if there is at least one candidate carrier frequency included in
*candidateServingFreqListNR* or candidate frequency range included in
*candidateServingFreqRangeListNR* or one supported UL CA or NR-DC
combination comprising of candidate carrier frequencies included in
*candidateServingFreqListNR* or candidate frequency ranges included in
*candidateServingFreqRangeListNR*, the UE is experiencing IDC problems
that it cannot solve by itself, and *affectedCarrierFreqList* or
*affectedCarrierFreqCombList* or *affectedCarrierFreqRangeList* or
*affectedCarrierFreqRangeCombList* is included, and
*idc-TDM-AssistanceConfig* is set to *setup*:

3\> include Time Domain Multiplexing (TDM) based assistance information
as indicated by *idc-TDM-Assistance* that could be used to resolve the
IDC problems;

...

##### 8.1.5.10.10.3 Test description {#test-description-35 .H6}

##### 8.1.5.10.10.3.1 Pre-test conditions {#pre-test-conditions-35 .H6}

##### System Simulator: {#system-simulator-27 .H6}

\- NR Cell 14/NRf4 (2390-2400MHz for band n40) and WLAN AP 1 (Cell 27)
as specified in TS 38.508-1\[4\] clause 4.13.

\- NR Cell 1/NRf1 **(**2496-2556MHz for band n41**)** and WLAN AP 2
(Cell 27b) as specified in TS 38.508-1\[4\] clause 4.13.

##### UE: {#ue-24 .H6}

\- UE's WLAN is on.

##### Preamble: {#preamble-23 .H6}

\- The UE is in state 3N-A on NR Cell 14 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.5.10.10.3.2 Test procedure sequence {#test-procedure-sequence-35 .H6}

Table 8.1.5.10.10.3.2-1 for FR1 illustrate the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. The exact instants on which these values
shall be applied are described in the texts in this clause. The
configuration \"T0\" indicates the initial conditions. Subsequent
configurations marked \"T1\", "T2" and \"T3\" are applied at the points
indicated in the Main behaviour description in Table 8.1.5.10.10.3.2-2.

Table 8.1.5.10.10.3.2-1: Time instances of cell power level and
parameter changes for FR1

+-------+-------+-------+-------+-------+-------+-------+-------+
|       | **P   | **U   | **NR  | *     | **NR  | *     | **Rem |
|       | arame | nit** | Cell  | *WLAN | Cell  | *WLAN | ark** |
|       | ter** |       | 14**  | AP 1  | 1**   | AP 2  |       |
|       |       |       |       | (Cell |       | (Cell |       |
|       |       |       |       | 27)** |       | 2     |       |
|       |       |       |       |       |       | 7b)** |       |
+=======+=======+=======+=======+=======+=======+=======+=======+
| *     | SS    | dB    | -88   |       | Off   |       | Cell  |
| *T0** | /PBCH | m/SCS |       |       |       |       | con   |
|       |       |       |       |       |       |       | figur |
|       | SSS   |       |       |       |       |       | ation |
|       | EPRE  |       |       |       |       |       | for   |
|       |       |       |       |       |       |       | non   |
|       |       |       |       |       |       |       | -IDC. |
+-------+-------+-------+-------+-------+-------+-------+-------+
|       | Beaco | dBm   |       | Off   |       | Off   |       |
|       | nRSSI |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+
| *     | SS    | dB    | -88   |       | Off   |       | Cell  |
| *T1** | /PBCH | m/SCS |       |       |       |       | con   |
|       |       |       |       |       |       |       | figur |
|       | SSS   |       |       |       |       |       | ation |
|       | EPRE  |       |       |       |       |       | for   |
|       |       |       |       |       |       |       | IDC   |
|       |       |       |       |       |       |       | in NR |
|       |       |       |       |       |       |       | Cell  |
|       |       |       |       |       |       |       | 14.   |
+-------+-------+-------+-------+-------+-------+-------+-------+
|       | Beaco | dBm   |       | -80   |       | Off   |       |
|       | nRSSI |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+
| *     | SS    | dB    | -88   |       | -79   |       | Cell  |
| *T2** | /PBCH | m/SCS |       |       |       |       | con   |
|       |       |       |       |       |       |       | figur |
|       | SSS   |       |       |       |       |       | ation |
|       | EPRE  |       |       |       |       |       | for   |
|       |       |       |       |       |       |       | no    |
|       |       |       |       |       |       |       | n-IDC |
|       |       |       |       |       |       |       | in NR |
|       |       |       |       |       |       |       | Cell  |
|       |       |       |       |       |       |       | 1.    |
+-------+-------+-------+-------+-------+-------+-------+-------+
|       | Beaco | dBm   |       | Off   |       | Off   |       |
|       | nRSSI |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+
| *     | SS    | dB    | -88   |       | -79   |       | Cell  |
| *T3** | /PBCH | m/SCS |       |       |       |       | con   |
|       |       |       |       |       |       |       | figur |
|       | SSS   |       |       |       |       |       | ation |
|       | EPRE  |       |       |       |       |       | for   |
|       |       |       |       |       |       |       | IDC   |
|       |       |       |       |       |       |       | in NR |
|       |       |       |       |       |       |       | Cell  |
|       |       |       |       |       |       |       | 1.    |
+-------+-------+-------+-------+-------+-------+-------+-------+
|       | Beaco | dBm   |       | Off   |       | -80   |       |
|       | nRSSI |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+

Table 8.1.5.10.10.3.2-2: Main behaviour

+--------+------------+------------+------------+------------+----+
| **St** | **P        | **Message  | **TP**     | *          |    |
|        | rocedure** | Sequence** |            | *Verdict** |    |
+========+============+============+============+============+====+
|        |            | **U - S**  | *          |            |    |
|        |            |            | *Message** |            |    |
+--------+------------+------------+------------+------------+----+
| 1      | The SS     | \<\--      | NR RRC:    | \-         | \- |
|        | transmits  |            | *RRCReconf |            |    |
|        | a          |            | iguration* |            |    |
|        | RRCRecon   |            |            |            |    |
|        | figuration |            |            |            |    |
|        | message    |            |            |            |    |
|        | including  |            |            |            |    |
|        | O          |            |            |            |    |
|        | therConfig |            |            |            |    |
|        | with       |            |            |            |    |
|        | idc-FDM-   |            |            |            |    |
|        | Assistance |            |            |            |    |
|        | Config-r18 |            |            |            |    |
|        | including  |            |            |            |    |
|        | Candi      |            |            |            |    |
|        | dateServin |            |            |            |    |
|        | gFreqRange |            |            |            |    |
|        | ListNR-r18 |            |            |            |    |
|        | including  |            |            |            |    |
|        | center     |            |            |            |    |
|        | frequency  |            |            |            |    |
|        | and        |            |            |            |    |
|        | bandwidth  |            |            |            |    |
|        | for NR     |            |            |            |    |
|        | Cell 14    |            |            |            |    |
|        | and NR     |            |            |            |    |
|        | Cell 1,    |            |            |            |    |
|        | and        |            |            |            |    |
|        | idc-TDM-A  |            |            |            |    |
|        | ssistanceC |            |            |            |    |
|        | onfig-r18. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 2      | The UE     | \--\>      | NR RRC:    | \-         | \- |
|        | transmits  |            | *RRCReco   |            |    |
|        | an         |            | nfiguratio |            |    |
|        | RRCRec     |            | nComplete* |            |    |
|        | onfigurati |            |            |            |    |
|        | onComplete |            |            |            |    |
|        | message.   |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 3      | The SS     | \-         | \-         | \-         | \- |
|        | re-adjusts |            |            |            |    |
|        | the power  |            |            |            |    |
|        | levels     |            |            |            |    |
|        | according  |            |            |            |    |
|        | to row     |            |            |            |    |
|        | \"T1\" in  |            |            |            |    |
|        | Table      |            |            |            |    |
|        | 8.1.5.10   |            |            |            |    |
|        | .10.3.2-1. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 4      | The UE     | \-         | \-         | \-         | \- |
|        | associates |            |            |            |    |
|        | with the   |            |            |            |    |
|        | WLAN AP1   |            |            |            |    |
|        | and        |            |            |            |    |
|        | obtains    |            |            |            |    |
|        | the local  |            |            |            |    |
|        | IP address |            |            |            |    |
|        | of WLAN    |            |            |            |    |
|        | AP1.       |            |            |            |    |
|        |            |            |            |            |    |
|        | Note: The  |            |            |            |    |
|        | UL signal  |            |            |            |    |
|        | to WLAN AP |            |            |            |    |
|        | shall      |            |            |            |    |
|        | generate   |            |            |            |    |
|        | IDC        |            |            |            |    |
|        | problem.   |            |            |            |    |
|        | The UE     |            |            |            |    |
|        | shall      |            |            |            |    |
|        | detect IDC |            |            |            |    |
|        | problem    |            |            |            |    |
|        | with "T1"  |            |            |            |    |
|        | in         |            |            |            |    |
|        | RRC\       |            |            |            |    |
|        | _CONNECTED |            |            |            |    |
|        | in NR Cell |            |            |            |    |
|        | 14.        |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 5      | Check:     | \--\>      | NR RRC:    | 1          | P  |
|        | Does the   |            | *UEAs      |            |    |
|        | UE         |            | sistanceIn |            |    |
|        | transmit   |            | formation* |            |    |
|        | an         |            |            |            |    |
|        | *UEA       |            |            |            |    |
|        | ssistanceI |            |            |            |    |
|        | nformation |            |            |            |    |
|        | message    |            |            |            |    |
|        | including  |            |            |            |    |
|        | idc-       |            |            |            |    |
|        | TDM-Assist |            |            |            |    |
|        | ance-r18*? |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 6      | The SS     | \-         | \-         | \-         | \- |
|        | re-adjusts |            |            |            |    |
|        | the power  |            |            |            |    |
|        | levels     |            |            |            |    |
|        | according  |            |            |            |    |
|        | to row     |            |            |            |    |
|        | \"T2\" in  |            |            |            |    |
|        | Table      |            |            |            |    |
|        | 8.1.5.10   |            |            |            |    |
|        | .10.3.2-1. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 7      | The SS     | \<\--      | NR RRC:    | \-         | \- |
|        | transmits  |            | *RRCReconf |            |    |
|        | an         |            | iguration* |            |    |
|        | *RRCReconf |            |            |            |    |
|        | iguration* |            |            |            |    |
|        | message    |            |            |            |    |
|        | *including |            |            |            |    |
|        | to order   |            |            |            |    |
|        | the UE to  |            |            |            |    |
|        | perform    |            |            |            |    |
|        | inter      |            |            |            |    |
|        | -frequency |            |            |            |    |
|        | handover   |            |            |            |    |
|        | to NR Cell |            |            |            |    |
|        | 1.*        |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 8      | The UE     | \--\>      | NR RRC:    | \-         | \- |
|        | transmit   |            | *RRCReco   |            |    |
|        | RRCRec     |            | nfiguratio |            |    |
|        | onfigurati |            | nComplete* |            |    |
|        | onComplete |            |            |            |    |
|        | message in |            |            |            |    |
|        | NR Cell 1. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 9      | The SS     | \-         | \-         | \-         | \- |
|        | re-adjusts |            |            |            |    |
|        | the power  |            |            |            |    |
|        | levels     |            |            |            |    |
|        | according  |            |            |            |    |
|        | to row     |            |            |            |    |
|        | \"T3\" in  |            |            |            |    |
|        | Table      |            |            |            |    |
|        | 8.1.5.10   |            |            |            |    |
|        | .10.3.2-1. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 10     | The UE     | \-         | \-         | \-         | \- |
|        | associates |            |            |            |    |
|        | with the   |            |            |            |    |
|        | WLAN AP2   |            |            |            |    |
|        | and        |            |            |            |    |
|        | obtains    |            |            |            |    |
|        | the local  |            |            |            |    |
|        | IP address |            |            |            |    |
|        | of WLAN    |            |            |            |    |
|        | AP2.       |            |            |            |    |
|        |            |            |            |            |    |
|        | Note: The  |            |            |            |    |
|        | UL signal  |            |            |            |    |
|        | to WLAN AP |            |            |            |    |
|        | shall      |            |            |            |    |
|        | generate   |            |            |            |    |
|        | IDC        |            |            |            |    |
|        | problem.   |            |            |            |    |
|        | The UE     |            |            |            |    |
|        | shall      |            |            |            |    |
|        | detect IDC |            |            |            |    |
|        | problem    |            |            |            |    |
|        | with "T3"  |            |            |            |    |
|        | in         |            |            |            |    |
|        | RRC\       |            |            |            |    |
|        | _CONNECTED |            |            |            |    |
|        | in NR Cell |            |            |            |    |
|        | 1.         |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 11     | Check:     | \--\>      | NR RRC:    | 2          | P  |
|        | Does the   |            | *UEAs      |            |    |
|        | UE         |            | sistanceIn |            |    |
|        | transmit   |            | formation* |            |    |
|        | an         |            |            |            |    |
|        | *UEA       |            |            |            |    |
|        | ssistanceI |            |            |            |    |
|        | nformation |            |            |            |    |
|        | message    |            |            |            |    |
|        | including  |            |            |            |    |
|        | idc-       |            |            |            |    |
|        | TDM-Assist |            |            |            |    |
|        | ance-r18*, |            |            |            |    |
|        | which      |            |            |            |    |
|        | i          |            |            |            |    |
|        | nformation |            |            |            |    |
|        | is         |            |            |            |    |
|        | different  |            |            |            |    |
|        | from the   |            |            |            |    |
|        | i          |            |            |            |    |
|        | nformation |            |            |            |    |
|        | in Step 5? |            |            |            |    |
+--------+------------+------------+------------+------------+----+

##### 8.1.5.10.10.3.3 Specific message contents {#specific-message-contents-35 .H6}

Table 8.1.5.10.10.3.3-1: RRCReconfiguration (step 1, Table
8.1.5.10.10.3.2-2)

  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-13                                                                                                         
  -------------------------------------------------------------------------------------------------------------- ----------------------------- ------------- ---------------
  **Information Element**                                                                                        **Value/remark**              **Comment**   **Condition**
  RRCReconfiguration ::= SEQUENCE {                                                                                                                          
  criticalExtensions CHOICE {                                                                                                                                
  rrcReconfiguration SEQUENCE {                                                                                                                              
  nonCriticalExtension SEQUENCE {                                                                                                                            
  nonCriticalExtension SEQUENCE {                                                                                                                            
  nonCriticalExtension SEQUENCE {                                                                                                                            
  nonCriticalExtension SEQUENCE {                                                                                                                            
  nonCriticalExtensionotherConfig-v1610 SEQUENCE {                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                                            
  otherConfig-v1800 SEQUENCE {                                                                                                                               
  idc-AssistanceConfig-v1800 **CHOICE {**                                                                                                                    
  setup SEQUENCE {                                                                                                                                           
  idc-FDM-AssistanceConfig-r18 **CHOICE {**                                                                                                                  
  setup SEQUENCE {                                                                                                                                           
  candidateServingFreqRangeListNR-r18 SEQUENCE (SIZE (1..maxFreqIDC-r16)) OF CandidateServingFreqRangeNR-r18 {   2 entries                                   
  CandidateServingFreqRangeNR-r18\[1\] SEQUENCE {                                                                                                            
  candidateCenterFreq-r18                                                                                        ARFCN-ValueNR of NR Cell 14                 
  candidateBandwidth-r18                                                                                         mhz10                                       
  }                                                                                                                                                          
  CandidateServingFreqRangeNR-r18\[2\] SEQUENCE {                                                                                                            
  candidateCenterFreq-r18                                                                                        ARFCN-ValueNR of NR Cell 1                  
  candidateBandwidth-r18                                                                                         mhz60                                       
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  idc-TDM-AssistanceConfig-r18                                                                                   setup                                       
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          

Table 8.1.5.10.10.3.3-2: UEAssistanceInformation (step 5, Table
8.1.5.10.10.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-30                                                                                                                        
  -------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------------- ---------------
  **Information Element**                                                                                  **Value/remark**   **Comment**                                   **Condition**
  UEAssistanceInformation ::= SEQUENCE {                                                                                                                                    
  criticalExtensions CHOICE {                                                                                                                                               
  ueAssistanceInformation SEQUENCE {                                                                                                                                        
  nonCriticalExtension SEQUENCE {                                                                                                                                           
  overheatingAssistance                                                                                    Not checked                                                      
  nonCriticalExtension SEQUENCE {                                                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                                                                           
  idc-FDM-Assistance-r18 SEQUENCE {                                                                                                                                         
  affectedCarrierFreqRangeList-r18 SEQUENCE (SIZE (1..maxFreqIDC-r16)) OF AffectedCarrierFreqRange-r18 {   1 entry                                                          
  AffectedCarrierFreqRange-r18 SEQUENCE {                                                                                                                                   
  affectedFreqRange-r18 SEQUENCE {                                                                                                                                          
  centerFreq-r18                                                                                           Present                                                          
  affectedBandwidth-r18                                                                                    Present                                                          
  }                                                                                                                                                                         
  interferenceDirection-r18                                                                                nr                                                               
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  idc-TDM-Assistance-r18 SEQUENCE {                                                                                           The actual IE values depend on UE reporting   
  cycleLength-r18                                                                                          Present                                                          
  startOffset-r18                                                                                          Present                                                          
  slotOffset-r18                                                                                           Present                                                          
  activeDuration-r18                                                                                       Present                                                          
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         
  }                                                                                                                                                                         

Table 8.1.5.10.10.3.3-3: RRCReconfiguration (step 7, Table
8.1.5.10.10.3.2-2)

  Derivation Path: TS 38.508-1 \[4\] 4.8.1-1A with condition RBConfig\_KeyChange                                                                  
  -------------------------------------------------------------------------------- ------------------ ------------------------------------------- ---------------
  **Information Element**                                                          **Value/remark**   **Comment**                                 **Condition**
  RRCReconfiguration ::= SEQUENCE {                                                                                                               
  criticalExtensions CHOICE {                                                                                                                     
  rrcReconfiguration SEQUENCE {                                                                                                                   
  nonCriticalExtension SEQUENCE{                                                                                                                  
  masterCellGroup                                                                  CellGroupConfig    OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                               
  }                                                                                                                                               
  }                                                                                                                                               
  }                                                                                                                                               

Table 8.1.5.10.10.3.3-4: CellGroupConfig (Table 8.1.5.10.10.3.3-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change and CFRA                                                 
  ------------------------------------------------------------------------------------------ ------------------------------- ------------- ---------------
  **Information Element**                                                                    **Value/remark**                **Comment**   **Condition**
  CellGroupConfig ::= SEQUENCE {                                                                                                           
  spCellConfig SEQUENCE {                                                                                                                  
  reconfigurationWithSync SEQUENCE {                                                                                                       
  spCellConfigCommon SEQUENCE {                                                                                                            
  physCellId                                                                                 Physical cell Id of NR Cell 1                 
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        
  }                                                                                                                                        

Table 8.1.5.10.10.3.3-5: UEAssistanceInformation (step 11, Table
8.1.5.10.10.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-30                                                                                                                                                                                                               
  -------------------------------------------------------------------------------------------------------- ------------------ ------------------------------------------------------------------------------------------------------------------------------------ ---------------
  **Information Element**                                                                                  **Value/remark**   **Comment**                                                                                                                          **Condition**
  UEAssistanceInformation ::= SEQUENCE {                                                                                                                                                                                                                           
  criticalExtensions CHOICE {                                                                                                                                                                                                                                      
  ueAssistanceInformation SEQUENCE {                                                                                                                                                                                                                               
  nonCriticalExtension SEQUENCE {                                                                                                                                                                                                                                  
  overheatingAssistance                                                                                    Not checked                                                                                                                                             
  nonCriticalExtension SEQUENCE {                                                                                                                                                                                                                                  
  nonCriticalExtension SEQUENCE {                                                                                                                                                                                                                                  
  nonCriticalExtension SEQUENCE {                                                                                                                                                                                                                                  
  idc-FDM-Assistance-r18 SEQUENCE {                                                                                                                                                                                                                                
  affectedCarrierFreqRangeList-r18 SEQUENCE (SIZE (1..maxFreqIDC-r16)) OF AffectedCarrierFreqRange-r18 {   1 entry                                                                                                                                                 
  AffectedCarrierFreqRange-r18 SEQUENCE {                                                                                                                                                                                                                          
  affectedFreqRange-r18 SEQUENCE {                                                                                                                                                                                                                                 
  centerFreq-r18                                                                                           Present                                                                                                                                                 
  affectedBandwidth-r18                                                                                    Present                                                                                                                                                 
  }                                                                                                                                                                                                                                                                
  interferenceDirection-r18                                                                                nr                                                                                                                                                      
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                
  idc-TDM-Assistance-r18 SEQUENCE {                                                                                           This entry only exists when at least one IE value is different from the IE values in step 5. Otherwise, this entry will not exist.   
  cycleLength-r18                                                                                          Present                                                                                                                                                 
  startOffset-r18                                                                                          Present                                                                                                                                                 
  slotOffset-r18                                                                                           Present                                                                                                                                                 
  activeDuration-r18                                                                                       Present                                                                                                                                                 
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                
  }                                                                                                                                                                                                                                                                

#### 8.1.5.11 Idle/Inactive measurements

##### 8.1.5.11.1 Idle/Inactive measurements / Idle mode / SIB11 configuration / Measurement of NR cells

##### 8.1.5.11.1.1 Test Purpose (TP) {#test-purpose-tp-36 .H6}

##### (1) {#section-66 .H6}

**with** { UE in NR RRC\_IDLE state after receiving *RRCRelease* message
with *measIdleConfig* not including *measIdleCarrierListNR* while being
connected to serving cell in which *SIB1* includes
*idleModeMeasurementsNR* and *SIB11* is configured with
*measIdleCarrierListNR* with *ssb-MeasConfig* and UE supporting
idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after successful measurement procedure and RRC
connection re-establishment }

**then** { UE reports measurement results in *UEInformationResponse
message* }

}

##### (2) {#section-67 .H6}

**with** { UE in NR RRC\_IDLE state after receiving *RRCRelease* message
with *measIdleConfig* not including *measIdleCarrierListNR* while being
connected to serving cell in which *SIB1* includes
*idleModeMeasurementsNR* and *SIB11* is configured with
*measIdleCarrierListNR* without *ssb-MeasConfig* and *SIB4* is
configured with *ssb-MeasConfig* parameters and UE supporting
idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after successful measurement procedure and RRC
connection re-establishment }

**then** { UE reports measurement results in *UEInformationResponse
message* }

}

##### (3) {#section-68 .H6}

**with** { UE in NR RRC\_IDLE state after UE has received *RRCRelease*
message with *measIdleConfig* not including *measIdleCarrierListNR*
while being connected to serving cell in which SIB1 includes
*idleModeMeasurementsNR* and *SIB11* is not configured and UE supporting
idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after unsuccessful measurement procedure and
RRC connection re-establishment }

**then** { UE does not report measurement results in
*UEInformationResponse message* }

}

##### 8.1.5.11.1.2 Conformance requirements {#conformance-requirements-36 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clauses 5.7.8.1, 5.7.8.1a, 5.7.8.2a, 5.3.8.3,
5.7.8.3 and 5.7.10.3. Unless otherwise stated, these are Rel-16
requirements.

\[TS 38.331, clause 5.7.8.1\]

This procedure specifies the measurements to be performed and stored by
a UE in RRC\_IDLE and RRC\_INACTIVE when it has an idle/inactive
measurement configuration.

\[TS 38.331, clause 5.7.8.1a\]

The purpose of this procedure is to update the idle/inactive measurement
configuration.

The UE initiates this procedure while T331 is running and one of the
following conditions is met:

1\> upon selecting a cell when entering RRC\_IDLE or RRC-INACTIVE from
RRC\_CONNECTED or RRC\_INACTIVE; or

1\> upon update of system information (*SIB4*, or *SIB11*), e.g. due to
intra-RAT cell (re)selection;

While in RRC\_IDLE or RRC\_INACTIVE, and T331 is running, the UE shall:

1\> if *VarMeasIdleConfig* includes neither a *measIdleCarrierListEUTRA*
nor a *measIdleCarrierListNR* received from the *RRCRelease* message:

2\> if the UE supports *idleInactiveNR-MeasReport*:

3\> if *SIB11* includes the *measIdleConfigSIB* and contains
*measIdleCarrierListNR*:

4\> store or replace the *measIdleCarrierListNR* of *measIdleConfigSIB*
of *SIB11* within *VarMeasIdleConfig*;

3\> else:

4\> remove the *measIdleCarrierListNR* in *VarMeasIdleConfig*, if
stored;

1\> for each entry in the *measIdleCarrierListNR* within
*VarMeasIdleConfig* that does not contain an *ssb-MeasConfig* received
from the *RRCRelease* message:

2\> if there is an entry in *measIdleCarrierListNR* in
*measIdleConfigSIB* of *SIB11* that has the same carrier frequency and
subcarrier spacing as the entry in the *measIdleCarrierListNR* within
*VarMeasIdleConfig* and that contains *ssb-MeasConfig*:

3\> delete the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

3\> store the SSB measurement configuration from *SIB11* into
*nrofSS-BlocksToAverage*, *absThreshSS-BlocksConsolidation*, *smtc*,
*ssb-ToMeasure*, *deriveSSB-IndexFromCell*, and *ss-RSSI-Measurement*
within *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

2\> else if there is an entry in *interFreqCarrierFreqList* *of SIB4*
with the same carrier frequency and subcarrier spacing as the entry in
*measIdleCarrierListNR* within *VarMeasIdleConfig*:

3\> delete the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

3\> store the SSB measurement configuration from *SIB4* into
*nrofSS-BlocksToAverage*, *absThreshSS-BlocksConsolidation*, *smtc*,
*ssb-ToMeasure*, *deriveSSB-IndexFromCell*, and *ss-RSSI-Measurement*
within *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

2\> else:

3\> remove the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*, if stored;

1\> perform measurements according to 5.7.8.2a.

\[TS 38.331, clause 5.7.8.2a\]

When performing measurements on NR carriers according to this clause,
the UE shall derive the cell quality as specified in 5.5.3.3 and
consider the beam quality to be the value of the measurement results of
the concerned beam, where each result is averaged as described in TS
38.215 \[9\].

While in RRC\_IDLE or RRC\_INACTIVE, and T331 is running, the UE shall:

1\> perform the measurements in accordance with the following:

2\> if the *VarMeasIdleConfig* includes the *measIdleCarrierListNR* and
the SIB1 contains *idleModeMeasurementsNR*:

3\> for each entry in *measIdleCarrierListNR* within *VarMeasIdleConfig
that contains ssb-MeasConfig*:

4\> if UE supports carrier aggregation or NR-DC between serving carrier
and the carrier frequency and subcarrier spacing indicated by
*carrierFreq* and *ssbSubCarrierSpacing* within the corresponding entry:

5\> perform measurements in the carrier frequency and subcarrier spacing
indicated by *carrierFreq* and *ssbSubCarrierSpacing* within the
corresponding entry;

5\> if the *reportQuantities* is set to rsrq:

6\> consider RSRQ as the cell sorting quantity;

5\> else:

6\> consider RSRP as the cell sorting quantity;

5\> if the *measCellListNR* is included:

6\> consider cells identified by each entry within the *measCellListNR*
to be applicable for idle/inactive measurement reporting;

5\> else:

6\> consider up to *maxCellMeasIdle* strongest identified cells,
according to the sorting quantity, to be applicable for idle/inactive
measurement reporting;

5\> for all cells applicable for idle/inactive measurement reporting,
derive cell measurement results for the measurement quantities indicated
by *reportQuantities;*

5\> store the derived cell measurement results as indicated by
reportQuantities for cells applicable for idle/inactive measurement
reporting within measResultsPerCarrierListIdleNR in the
*measReportIdleNR* in *VarMeasIdleReport* in decreasing order of the
cell sorting quantity, i.e. the best cell is included first, as follows:

6\> if *qualityThreshold* is configured:

7\> include the measurement results from the cells applicable for
idle/inactive measurement reporting whose RSRP/RSRQ measurement results
are above the value(s) provided in *qualityThreshold;*

6\> else:

7\> include the measurement results from all cells applicable for
idle/inactive measurement reporting;

5\> if *beamMeasConfigIdle* is included in the associated entry in
*measIdleCarrierListNR and if UE supports idleInactiveNR-MeasBeamReport
for the FR of the carrier frequency indicated by carrierFreq within the
associated entry, for each cell in the measurement results:*

6\> derive beam measurements based on SS/PBCH block for each measurement
quantity indicated in *reportQuantityRS-Indexes*, as described in TS
38.215 \[9\];

6\> if the *reportQuantityRS-Indexes* is set to rsrq:

7\> consider RSRQ as the beam sorting quantity;

6\> else:

7\> consider RSRP as the beam sorting quantity;

6\> set *resultsSSB-Indexes* to include up to
*maxNrofRS-IndexesToReport* SS/PBCH block indexes in order of decreasing
beam sorting quantity as follows:

7\> include the index associated to the best beam for the sorting
quantity and if *absThreshSS-BlocksConsolidation* is included, the
remaining beams whose sorting quantity is above
*absThreshSS-BlocksConsolidation*;

6\> if the *includeBeamMeasurements* is set to *true*:

7\> include the beam measurement results as indicated by
*reportQuantityRS*-*Indexes*;

2\> if, as a result of the procedure in this subclause, the UE performs
measurements in one or more carrier frequency indicated by
*measIdleCarrierListNR* or *measIdleCarrierListEUTRA*:

3\> store the cell measurement results for RSRP and RSRQ for the serving
cell within *measResultServingCell* in the measReportIdleNR in
*VarMeasIdleReport*.

3\> if the *VarMeasIdleConfig* includes the *measIdleCarrierListNR* and
it contains an entry with *carrierFreq* set to the value of the serving
frequency:

4\> if *beamMeasConfigIdle* is included in that entry, and if the UE
supports *idleInactiveNR- MeasBeamReport* for the FR of the serving
cell:

5\> derive beam measurements based on SS/PBCH block for each measurement
quantity indicated in *reportQuantityRS-Indexes*, as described in TS
38.215 \[9\];

5\> if the *reportQuantityRS-Indexes* is set to rsrq:

6\> consider RSRQ as the beam sorting quantity;

5\> else:

6\> consider RSRP as the beam sorting quantity;

5\> set *resultsSSB-Indexes* to include up to
*maxNrofRS-IndexesToReport* SS/PBCH block indexes in order of decreasing
beam sorting quantity as follows:

6\> include the index associated to the best beam for the sorting
quantity and if *absThreshSS-BlocksConsolidation* is included in *SIB2*
of serving cell, the remaining beams whose sorting quantity is above
*absThreshSS-BlocksConsolidation*;

5\> if the *includeBeamMeasurements* is set to true:

6\> include the beam measurement results as indicated by
*reportQuantityRS-Indexes*;

NOTE 1: How the UE performs idle/inactive measurements is up to UE
implementation as long as the requirements in TS 38.133 \[14\] are met
for measurement reporting.

NOTE 2: The UE is not required to perform idle/inactive measurements on
a given carrier if the SSB configuration of that carrier provided via
dedicated signalling is different from the SSB configuration broadcasted
in the serving cell, if any.

> NOTE 3: How the UE prioritizes which frequencies to measure or report
> (in case it is configured with more frequencies than it can measure or
> report) is left to UE implementation.

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> if the *RRCRelease* includes the *measIdleConfig*:

2\> if T331 is running:

3\> stop timer T331;

3\> perform the actions as specified in 5.7.8.3;

2\> if the *measIdleConfig* is set to *setup*:

3\> store the received *measIdleDuration* in *VarMeasIdleConfig*;

3\> start timer T331 with the value set to *measIdleDuration*;

\[TS 38.331, clause 5.7.8.3\]

The UE shall:

1\> if T331 expires or is stopped:

2\> release the *VarMeasIdleConfig*.

NOTE: It is up to UE implementation whether to continue idle/inactive
measurements according to SIB11 and SIB4 configurations or according to
E-UTRA SIB5 and E-UTRA SIB24 configurations as specified in TS 36.331
\[10\] upon inter-RAT cell reselection to E-UTRA, after T331 has expired
or stopped.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

1\> if the *idleModeMeasurementReq* is included in the
*UEInformationRequest and the UE has stored VarMeasIdleReport* that
contains measurement information concerning cells other than the PCell:

2\> set the *measResultIdleNR* in the *UEInformationResponse* message to
the value of *measReportIdleNR* in the *VarMeasIdleReport*, if
available*;*

##### 8.1.5.11.1.3 Test Description {#test-description-36 .H6}

##### 8.1.5.11.1.3.1 Pre-test conditions {#pre-test-conditions-36 .H6}

##### System Simulator: {#system-simulator-28 .H6}

\- NR Cell 1, serving cell. System information combination NR-19 defined
in TS 38.508-1 \[4\] clause 4.4.3.1.2 is used. Condition EMR\_NR used
for SIB1 and condition EMR\_NR\_SIB11 used for SIB11.

\- NR Cell 3, suitable for inter-frequency measurements. System
information combination NR-1 defined in TS 38.508-1 \[4\] clause
4.4.3.1.2.

##### UE: {#ue-25 .H6}

\- None.

##### Preamble: {#preamble-24 .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3 on NR Cell 1.

##### 8.1.5.11.1.3.2 Test procedure sequence {#test-procedure-sequence-36 .H6}

Table 8.1.5.11.1.3.2-1: Main behaviour

  St      Procedure                                                                                                                                                                        Message Sequence   TP                                Verdict   
  ------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- --------- ----
                                                                                                                                                                                           U - S              Message                                     
  1       The SS transmits *RRCRelease* message including *measIdleConfig* without *measIdleCarrierListNR* to the UE.                                                                      \<\--              NR RRC: *RRCRelease*              \-        \-
  2       Wait for 15 s for UE to enter RRC\_IDLE mode and to perform measurements.                                                                                                        \-                 *-*                               \-        \-
  3-10    Steps 1 to 8 of procedure described in TS 38.508-1 \[4\] table 4.5.4.2-3: NR RRC\_CONNECTED are performed.                                                                       \-                 *-*                               \-        \-
  11      The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                    \<\--              NR RRC: *UEInformationRequest*    \-        \-
  12      Check: Does the UE transmit *UEInformationResponse including measResultIdleNR?*                                                                                                  \--\>              NR RRC: *UEInformationResponse*   1         P
  13      The SS changes system information combination of NR Cell 1 to NR-18 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1 and EMR\_NR\_SIB4 for SIB11.   \-                 *-*                               \-        \-
  14      The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                    \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  15      Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                           \-                 *-*                               \-        \-
  16      The SS transmits *RRCRelease* message including *measIdleConfig* without *measIdleCarrierListNR* to the UE*.*                                                                    \<\--              *NR RRC: RRCRelease*              \-        \-
  17      Wait for 15 s for UE to enter RRC\_IDLE mode and to perform measurements.                                                                                                        \-                 \-                                \-        \-
  18-25   Steps 1 to 8 of procedure described in TS 38.508-1 \[4\] table 4.5.4.2-3: NR RRC\_CONNECTED are performed.                                                                       \-                 \-                                \-        \-
  26      The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                    \<\--              NR RRC: *UEInformationRequest*    \-        \-
  27      Check: Does the UE transmit *UEInformationResponse including measResultIdleNR?*                                                                                                  \--\>              NR RRC: *UEInformationResponse*   2         P
  28      The SS changes system information combination of NR Cell 1 to NR-1 to have no configuration for measurement procedure.                                                           \-                 *-*                               \-        \-
  29      The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                    \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  30      Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                           \-                 *-*                               \-        \-
  31      The SS transmits *RRCRelease* message including *measIdleConfig* without *measIdleCarrierListNR* to the UE.                                                                      \<\--              *NR RRC: RRCRelease*              \-        \-
  32      Wait for 15 s for UE to enter RRC\_IDLE mode and to perform measurements.                                                                                                        \-                 *-*                               \-        \-
  33-40   Steps 1 to 8 of procedure described in TS 38.508-1 \[4\] table 4.5.4.2-3: NR RRC\_CONNECTED are performed.                                                                       \-                 *-*                               \-        \-
  41      The SS transmits *UEInformationRequest* message *with idleModeMeasurementReq* to the UE.                                                                                         \<\--              NR RRC: *UEInformationRequest*    \-        \-
  42      Check: Does the UE transmit *UEInformationResponse not including measResultIdleNR?*                                                                                              \--\>              NR RRC: *UEInformationResponse*   3         P

##### 8.1.5.11.1.3.3 Specific message contents {#specific-message-contents-36 .H6}

Table 8.1.5.11.1.3.3-1: *RRCRelease* (steps 1, 16 and 31, Table
8.1.5.11.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16                                           
  --------------------------------------------------- ----------------------------- --------- -----------
  Information Element                                 Value/remark                  Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                   
  criticalExtensions CHOICE {                                                                 
  rrcRelease SEQUENCE {                                                                       
  nonCriticalExtensions SEQUENCE {                                                            
  nonCriticalExtensions SEQUENCE {                                                            
  measIdleConfig-r16 CHOICE {                                                                 
  setup                                               MeasIdleConfigDedicated-r16             
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           
  }                                                                                           

Table 8.1.5.11.1.3.3-2: *MeasIdleConfigDedicated* (all steps, Table
8.1.5.11.1.3.3-1)

  Derivation Path: TS 38.331 \[12\] Chapter 6.3.2                             
  ------------------------------------------------- --------------- --------- -----------
  Information Element                               Value/remark    Comment   Condition
  MeasIdleConfigDedicated-r16 ::= SEQUENCE {                                  
  measIdleCarrierListNR-r16                         *Not present*             
  measIdleCarrierListEUTRA-r16                      *Not present*             
  measIdleDuration-r16                              sec120                    
  validityAreaList-r16                              Not present               
  }                                                                           

Table 8.1.5.11.1.3.3-3: *UEInformationRequest* (steps 11, 26, and 41,
Table 8.1.5.11.1.3.2-1)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32A with condition IDLE
  -------------------------------------------------------------------------

Table 8.1.5.11.1.3.3-4: *UEInformationResponse* (steps 12 and 27, Table
8.1.5.11.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                                                                                                                 
  ---------------------------------------------------------------------------------------------------------------- ---------------------------------------- --------- -----------
  Information Element                                                                                              Value/remark                             Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                
  measResultIdleNR-r16 SEQUENCE {                                                                                                                                     
  measResultServingCell-r16 SEQUENCE {                                                                                                                                
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1.. maxNrofIndexesToReport)) OF ResultsPerSSB-IndexIdle-r16 {             1 entry                                            
  ResultsPerSSB-IndexIdle-r16\[1\] SEQUENCE {                                                                                                               entry 1   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measResultsPerCarrierListIdleNR-r16 SEQUENCE (SIZE (1.. maxFreqIdle-r16)) OF MeasResultsPerCarrierIdleNR-r16 {   1 entry                                            
  MeasResultsPerCarrierIdleNR-r16\[1\] SEQUENCE {                                                                                                           entry 1   
  carrierFreq-r16                                                                                                  ARFCN value corresponding to NR cell 3             
  measResultsPerCellListIdleNR-r16 SEQUENCE (SIZE (1..maxCellMeasIdle-r16)) OF MeasResultsPerCellIdleNR-r16 {      1 entry                                            
  MeasResultsPerCellIdleNR-r16\[1\] SEQUENCE {                                                                                                              entry 1   
  physCellId-r16                                                                                                   PhysCellId corresponding to NR cell 3              
  measIdleResultNR-r16 SEQUENCE {                                                                                                                                     
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1.. maxNrofIndexesToReport)) OF ResultsPerSSB-IndexIdle-r16 {             1 entry                                            
  ResultsPerSSB-IndexIdle-r16\[1\] SEQUENCE {                                                                                                               entry 1   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   

Table 8.1.5.11.1.3.3-5: *UEInformationResponse* (step 42, Table
8.1.5.11.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                            
  ----------------------------------------------------- -------------- --------- -----------
  Information Element                                   Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                    
  ueInformationResponse-r16 SEQUENCE {                                           
  measResultIdleNR-r16                                  Not present              
  }                                                                              
  }                                                                              
  }                                                                              

##### 8.1.5.11.2 Idle/Inactive measurements / Idle mode / RRCRelease configuration / Measurement of NR cells

##### 8.1.5.11.2.1 Test Purpose (TP) {#test-purpose-tp-37 .H6}

##### (1) {#section-69 .H6}

**with** { UE in NR RRC\_IDLE state after receiving *RRCRelease* message
including *measIdleCarrierListNR* with *ssb-MeasConfig* while being
connected to serving cell in which *SIB1* includes
*idleModeMeasurementsNR* and UE supporting idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after successful measurement procedure and RRC
connection establishment }

**then** { UE reports measurement results in *UEInformationResponse
message* }

}

##### (2) {#section-70 .H6}

**with** { UE in NR RRC\_IDLE state after receiving *RRCRelease* message
including *measIdleCarrierListNR* without *ssb-MeasConfig* while being
connected to serving cell in which SIB1 includes
*idleModeMeasurementsNR* and *SIB11* is configured with
*measIdleCarrierListNR* with *ssb-MeasConfig* and UE supporting
idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after successful measurement procedure and RRC
connection establishment }

**then** { UE reports measurement results in *UEInformationResponse
message* }

}

##### (3) {#section-71 .H6}

**with** { UE in NR RRC\_IDLE state after receiving *RRCRelease* message
including *measIdleCarrierListNR* without *ssb-MeasConfig* while being
connected to serving cell in which SIB1 includes
*idleModeMeasurementsNR* and SIB11 is configured with
measIdleCarrierListNR without ssb-MeasConfig and *SIB4* is configured
with interFreqCarrierFreqList parameters and UE supporting
idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after successful measurement procedure and RRC
connection establishment }

**then** { UE reports measurement results in *UEInformationResponse
message* }

}

##### (4) {#section-72 .H6}

**with** { UE in NR RRC\_IDLE state after receiving *RRCRelease* message
including *measIdleCarrierListNR* without *ssb-MeasConfig* while being
connected to serving cell in which SIB1 includes *idleModeMeasurementsNR
and SIB11 is not configured* and UE supporting idleInactiveNR-MeasReport
}

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after unsuccessful measurement procedure and
RRC connection establishment }

**then** { UE does not report measurement results in
*UEInformationResponse message* }

}

##### 8.1.5.11.2.2 Conformance requirements {#conformance-requirements-37 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.8.3, 5.7.8 and 5.7.10.3. Unless
otherwise stated, these are Rel-16 requirements.

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> if the *RRCRelease* includes the *measIdleConfig*:

2\> if T331 is running:

3\> stop timer T331;

3\> perform the actions as specified in 5.7.8.3;

2\> if the *measIdleConfig* is set to *setup*:

3\> store the received *measIdleDuration* in *VarMeasIdleConfig*;

3\> start timer T331 with the value set to *measIdleDuration*;

3\> if the *measIdleConfig* contains *measIdleCarrierListNR*:

4\> store the received *measIdleCarrierListNR* in *VarMeasIdleConfig*;

\[TS 38.331, clause 5.7.8.1\]

This procedure specifies the measurements to be performed and stored by
a UE in RRC\_IDLE and RRC\_INACTIVE when it has an idle/inactive
measurement configuration.

\[TS 38.331, clause 5.7.8.1a\]

The purpose of this procedure is to update the idle/inactive measurement
configuration.

The UE initiates this procedure while T331 is running and one of the
following conditions is met:

1\> upon selecting a cell when entering RRC\_IDLE or RRC-INACTIVE from
RRC\_CONNECTED or RRC\_INACTIVE; or

1\> upon update of system information (*SIB4*, or *SIB11*), e.g. due to
intra-RAT cell (re)selection;

While in RRC\_IDLE or RRC\_INACTIVE, and T331 is running, the UE shall:

1\> for each entry in the *measIdleCarrierListNR* within
*VarMeasIdleConfig* that does not contain an *ssb-MeasConfig* received
from the *RRCRelease* message:

2\> if there is an entry in *measIdleCarrierListNR* in
*measIdleConfigSIB* of *SIB11* that has the same carrier frequency and
subcarrier spacing as the entry in the *measIdleCarrierListNR* within
*VarMeasIdleConfig* and that contains *ssb-MeasConfig*:

3\> delete the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

3\> store the SSB measurement configuration from *SIB11* into
*nrofSS-BlocksToAverage*, *absThreshSS-BlocksConsolidation*, *smtc*,
*ssb-ToMeasure*, *deriveSSB-IndexFromCell*, and *ss-RSSI-Measurement*
within *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

2\> else if there is an entry in *interFreqCarrierFreqList* *of SIB4*
with the same carrier frequency and subcarrier spacing as the entry in
*measIdleCarrierListNR* within *VarMeasIdleConfig*:

3\> delete the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

3\> store the SSB measurement configuration from *SIB4* into
*nrofSS-BlocksToAverage*, *absThreshSS-BlocksConsolidation*, *smtc*,
*ssb-ToMeasure*, *deriveSSB-IndexFromCell*, and *ss-RSSI-Measurement*
within *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

2\> else:

3\> remove the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*, if stored;

1\> perform measurements according to 5.7.8.2a.

\[TS 38.331, clause 5.7.8.2a\]

When performing measurements on NR carriers according to this clause,
the UE shall derive the cell quality as specified in 5.5.3.3 and
consider the beam quality to be the value of the measurement results of
the concerned beam, where each result is averaged as described in TS
38.215 \[9\].

While in RRC\_IDLE or RRC\_INACTIVE, and T331 is running, the UE shall:

1\> perform the measurements in accordance with the following:

2\> if the *VarMeasIdleConfig* includes the *measIdleCarrierListNR* and
the SIB1 contains *idleModeMeasurementsNR*:

3\> for each entry in *measIdleCarrierListNR* within *VarMeasIdleConfig
that contains ssb-MeasConfig*:

4\> if UE supports carrier aggregation or NR-DC between serving carrier
and the carrier frequency and subcarrier spacing indicated by
*carrierFreq* and *ssbSubCarrierSpacing* within the corresponding entry:

5\> perform measurements in the carrier frequency and subcarrier spacing
indicated by *carrierFreq* and *ssbSubCarrierSpacing* within the
corresponding entry;

5\> if the *reportQuantities* is set to rsrq:

6\> consider RSRQ as the cell sorting quantity;

5\> else:

6\> consider RSRP as the cell sorting quantity;

5\> if the *measCellListNR* is included:

6\> consider cells identified by each entry within the *measCellListNR*
to be applicable for idle/inactive measurement reporting;

5\> else:

6\> consider up to *maxCellMeasIdle* strongest identified cells,
according to the sorting quantity, to be applicable for idle/inactive
measurement reporting;

5\> for all cells applicable for idle/inactive measurement reporting,
derive cell measurement results for the measurement quantities indicated
by *reportQuantities;*

5\> store the derived cell measurement results as indicated by
reportQuantities for cells applicable for idle/inactive measurement
reporting within measResultsPerCarrierListIdleNR in the
*measReportIdleNR* in *VarMeasIdleReport* in decreasing order of the
cell sorting quantity, i.e. the best cell is included first, as follows:

6\> if *qualityThreshold* is configured:

7\> include the measurement results from the cells applicable for
idle/inactive measurement reporting whose RSRP/RSRQ measurement results
are above the value(s) provided in *qualityThreshold;*

6\> else:

7\> include the measurement results from all cells applicable for
idle/inactive measurement reporting;

5\> if *beamMeasConfigIdle* is included in the associated entry in
*measIdleCarrierListNR and if UE supports idleInactiveNR-MeasBeamReport
for the FR of the carrier frequency indicated by carrierFreq within the
associated entry, for each cell in the measurement results:*

6\> derive beam measurements based on SS/PBCH block for each measurement
quantity indicated in *reportQuantityRS-Indexes*, as described in TS
38.215 \[9\];

6\> if the *reportQuantityRS-Indexes* is set to rsrq:

7\> consider RSRQ as the beam sorting quantity;

6\> else:

7\> consider RSRP as the beam sorting quantity;

6\> set *resultsSSB-Indexes* to include up to
*maxNrofRS-IndexesToReport* SS/PBCH block indexes in order of decreasing
beam sorting quantity as follows:

7\> include the index associated to the best beam for the sorting
quantity and if *absThreshSS-BlocksConsolidation* is included, the
remaining beams whose sorting quantity is above
*absThreshSS-BlocksConsolidation*;

6\> if the *includeBeamMeasurements* is set to *true*:

7\> include the beam measurement results as indicated by
*reportQuantityRS*-*Indexes*;

2\> if, as a result of the procedure in this subclause, the UE performs
measurements in one or more carrier frequency indicated by
*measIdleCarrierListNR* or *measIdleCarrierListEUTRA*:

3\> store the cell measurement results for RSRP and RSRQ for the serving
cell within *measResultServingCell* in the measReportIdleNR in
*VarMeasIdleReport*.

3\> if the *VarMeasIdleConfig* includes the *measIdleCarrierListNR* and
it contains an entry with *carrierFreq* set to the value of the serving
frequency:

4\> if *beamMeasConfigIdle* is included in that entry, and if the UE
supports *idleInactiveNR- MeasBeamReport* for the FR of the serving
cell:

5\> derive beam measurements based on SS/PBCH block for each measurement
quantity indicated in *reportQuantityRS-Indexes*, as described in TS
38.215 \[9\];

5\> if the *reportQuantityRS-Indexes* is set to rsrq:

6\> consider RSRQ as the beam sorting quantity;

5\> else:

6\> consider RSRP as the beam sorting quantity;

5\> set *resultsSSB-Indexes* to include up to
*maxNrofRS-IndexesToReport* SS/PBCH block indexes in order of decreasing
beam sorting quantity as follows:

6\> include the index associated to the best beam for the sorting
quantity and if *absThreshSS-BlocksConsolidation* is included in *SIB2*
of serving cell, the remaining beams whose sorting quantity is above
*absThreshSS-BlocksConsolidation*;

5\> if the *includeBeamMeasurements* is set to true:

6\> include the beam measurement results as indicated by
*reportQuantityRS-Indexes*;

NOTE 1: How the UE performs idle/inactive measurements is up to UE
implementation as long as the requirements in TS 38.133 \[14\] are met
for measurement reporting.

NOTE 2: The UE is not required to perform idle/inactive measurements on
a given carrier if the SSB configuration of that carrier provided via
dedicated signalling is different from the SSB configuration broadcasted
in the serving cell, if any.

NOTE 3: How the UE prioritizes which frequencies to measure or report
(in case it is configured with more frequencies than it can measure or
report) is left to UE implementation.

\[TS 38.331, clause 5.7.8.3\]

The UE shall:

1\> if T331 expires or is stopped:

2\> release the *VarMeasIdleConfig*.

NOTE: It is up to UE implementation whether to continue idle/inactive
measurements according to SIB11 and SIB4 configurations or according to
E-UTRA SIB5 and E-UTRA SIB24 configurations as specified in TS 36.331
\[10\] upon inter-RAT cell reselection to E-UTRA, after T331 has expired
or stopped.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

1\> if the *idleModeMeasurementReq* is included in the
*UEInformationRequest and the UE has stored VarMeasIdleReport* that
contains measurement information concerning cells other than the PCell:

2\> set the *measResultIdleNR* in the *UEInformationResponse* message to
the value of *measReportIdleNR* in the *VarMeasIdleReport*, if
available*;*

##### 8.1.5.11.2.3 Test Description {#test-description-37 .H6}

##### 8.1.5.11.2.3.1 Pre-test conditions {#pre-test-conditions-37 .H6}

##### System Simulator: {#system-simulator-29 .H6}

\- NR Cell 1, serving cell. System information combination NR-1 defined
in TS 38.508-1 \[4\] clause 4.4.3.1.2 is used. Condition EMR\_NR used
for SIB1.

\- NR Cell 3, suitable for inter-frequency measurements. System
information combination NR-1 defined in TS 38.508-1 \[4\] clause
4.4.3.1.2 is used.

##### UE: {#ue-26 .H6}

\- None.

##### Preamble: {#preamble-25 .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3 on NR Cell 1.

##### 8.1.5.11.2.3.2 Test procedure sequence {#test-procedure-sequence-37 .H6}

Table 8.1.5.11.2.3.2-1: Main behaviour

  St      Procedure                                                                                                                                                                         Message Sequence   TP                                Verdict   
  ------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- --------- ----
                                                                                                                                                                                            U - S              Message                                     
  1       The SS transmits *RRCRelease* message with *measIdleConfig* including *measIdleCarrierListNR* with *ssb-MeasConfig* to the UE.                                                    \<\--              NR RRC: *RRCRelease*              \-        \-
  2       Wait for 15 s for UE to enter RRC\_IDLE mode and to perform measurements.                                                                                                         \-                 *-*                               \-        \-
  3-10    Steps 1 to 8 of procedure described in TS 38.508-1 \[4\] table 4.5.4.2-3: NR RRC\_CONNECTED are performed.                                                                        \-                 *-*                               \-        \-
  11      The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                     \<\--              NR RRC: *UEInformationRequest*    \-        \-
  12      Check: Does the UE transmit *UEInformationResponse including measResultIdleNR?*                                                                                                   \--\>              NR RRC: *UEInformationResponse*   1         P
  13      The SS changes system information combination of NR Cell 1 to NR-19 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1 and EMR\_NR\_SIB11 for SIB11.   \-                 \-                                \-        \-
  14      The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                     \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  15      Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                            \-                 \-                                \-        \-
  16      The SS transmits *RRCRelease* message with *measIdleConfig* including *measIdleCarrierListNR* without *ssb-MeasConfig* to the UE.                                                 \<\--              *NR RRC: RRCRelease*              \-        \-
  17      Wait for 15 s for UE to enter RRC\_IDLE mode and to perform measurements.                                                                                                         \-                 \-                                \-        \-
  18-25   Steps 1 to 8 of procedure described in TS 38.508-1 \[4\] table 4.5.4.2-3: NR RRC\_CONNECTED are performed.                                                                        \-                 \-                                \-        \-
  26      The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                     \<\--              NR RRC: *UEInformationRequest*    \-        \-
  27      Check: Does the UE transmit *UEInformationResponse including measResultIdleNR?*                                                                                                   \--\>              NR RRC: *UEInformationResponse*   2         P
  28      The SS changes system information combination of NR Cell 1 to NR-18 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1 and EMR\_NR\_SIB4 for SIB11.    \-                 *-*                               \-        \-
  29      The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                     \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  30      Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                            \-                 *-*                               \-        \-
  31      The SS transmits *RRCRelease* message with *measIdleConfig* including *measIdleCarrierListNR* without *ssb-MeasConfig* to the UE.                                                 \<\--              *NR RRC: RRCRelease*              \-        \-
  32      Wait for 15 s for UE to enter RRC\_IDLE mode and to perform measurements.                                                                                                         \-                 \-                                \-        \-
  33-40   Steps 1 to 8 of procedure described in TS 38.508-1 \[4\] table 4.5.4.2-3: NR RRC\_CONNECTED are performed.                                                                        \-                 \-                                \-        \-
  41      The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                     \<\--              NR RRC: *UEInformationRequest*    \-        \-
  42      Check: Does the UE transmit *UEInformationResponse including measResultIdleNR?*                                                                                                   \--\>              NR RRC: *UEInformationResponse*   3         P
  43      The SS changes system information combination of NR Cell 1 to NR-1 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1.                                 \-                 \-                                \-        \-
  44      The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                     \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  45      Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                            \-                 \-                                \-        \-
  46      The SS transmits *RRCRelease* message with *measIdleConfig* including *measIdleCarrierListNR* without *ssb-MeasConfig* to the UE.                                                 \<\--              *NR RRC: RRCRelease*              \-        \-
  47      Wait for 15 s for UE to enter RRC\_IDLE mode and to perform measurements.                                                                                                         \-                 \-                                \-        \-
  48-55   Steps 1 to 8 of procedure described in TS 38.508-1 \[4\] table 4.5.4.2-3: NR RRC\_CONNECTED are performed.                                                                        \-                 \-                                \-        \-
  56      The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                     \<\--              NR RRC: *UEInformationRequest*    \-        \-
  57      Check: Does the UE transmit *UEInformationResponse without measResultIdleNR?*                                                                                                     \--\>              NR RRC: *UEInformationResponse*   4         P

##### 8.1.5.11.2.3.3 Specific message contents {#specific-message-contents-37 .H6}

Table 8.1.5.11.2.3.3-1: *RRCRelease* (steps 1, 16, 31 and 46, Table
8.1.5.11.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-16                                           
  ---------------------------------------------------- ----------------------------- --------- -----------
  Information Element                                  Value/remark                  Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                    
  rrc-TransactionIdentifier                            RRC-TransactionIdentifier               
  criticalExtensions CHOICE {                                                                  
  rrcRelease SEQUENCE {                                                                        
  nonCriticalExtensions SEQUENCE {                                                             
  nonCriticalExtensions SEQUENCE {                                                             
  measIdleConfig-r16 CHOICE {                                                                  
  setup                                                MeasIdleConfigDedicated-r16             
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            
  }                                                                                            

Table 8.1.5.11.2.3.3-2: *MeasIdleConfigDedicated* (step 1, Table
8.1.5.11.2.3.2-1)

  Derivation Path: TS 38.331 \[12\], clause 6.3.2                                                                                                                       
  ------------------------------------------------------------------------------------------- ------------------------------------- ----------------------------------- --------------------
  Information Element                                                                         Value/remark                          Comment                             Condition
  MeasIdleConfigDedicated-r16 ::= SEQUENCE {                                                                                                                            
  measIdleCarrierListNR-r16 SEQUENCE (SIZE (1..maxFreqIdle-r16)) OF MeasIdleCarrierNR-r16 {   1 entry                                                                   
  MeasIdleCarrierNR-r16\[1\] SEQUENCE {                                                                                             entry 1                             
  carrierFreq-r16                                                                             ARFCN value of configured NR cell 3                                       
  ssbSubcarrierSpacing-r16                                                                    SubcarrierSpacing                     TS 38.508-1 \[4\] Table 4.6.3-188   
  frequencyBandList                                                                           Not present                                                               
  measCellListNR-r16                                                                          Not present                                                               
  reportQuantities-r16                                                                        both                                                                      
  qualityThreshold-r16                                                                        Not present                                                               
  ssb-MeasConfig-r16 SEQUENCE {                                                                                                                                         
  nrofSS-BlocksToAverage-r16                                                                  2                                                                         
  absThreshSS-BlocksConsolidation-r16 SEQUENCE {                                                                                                                        
  thresholdRSRP                                                                               RSRP-Range                            TS 38.508-1 \[4\] Table 4.6.3-152   
  thresholdRSRQ                                                                               Not present                                                               
  thresholdSINR                                                                               Not present                                                               
  }                                                                                                                                                                     
  smtc-r16                                                                                    SSB-MTC                               TS 38.508-1 \[4\] Table 4.6.3-185   
  ssb-ToMeasure-r16                                                                           SSB-ToMeasure                         TS 38.508-1 \[4\] Table 4.6.3-187   
  deriveSSB-IndexFromCell-r16                                                                 false                                                                     
                                                                                              true                                                                      FR1\_TDD, FR2\_TDD
  ss-RSSI-Measurement-r16                                                                     Not present                                                               
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  measIdleCarrierListEUTRA-r16                                                                *Not present*                                                             
  measIdleDuration-r16                                                                        sec120                                                                    
  validityAreaList-r16                                                                        Not present                                                               
  }                                                                                                                                                                     

Table 8.1.5.11.2.3.3-3: *MeasIdleConfigDedicated* (steps 16, 31 and 46,
Table 8.1.5.11.2.3.2-1)

  Derivation Path: TS 38.331 \[12\], clause 6.3.2                                                                                                                       
  ------------------------------------------------------------------------------------------- ------------------------------------- ----------------------------------- -----------
  Information Element                                                                         Value/remark                          Comment                             Condition
  MeasIdleConfigDedicated-r16 ::= SEQUENCE {                                                                                                                            
  measIdleCarrierListNR-r16 SEQUENCE (SIZE (1..maxFreqIdle-r16)) OF MeasIdleCarrierNR-r16 {   1 entry                                                                   
  MeasIdleCarrierNR-r16\[1\] SEQUENCE {                                                                                             entry 1                             
  carrierFreq-r16                                                                             ARFCN value of configured NR cell 3                                       
  ssbSubcarrierSpacing-r16                                                                    SubcarrierSpacing                     TS 38.508-1 \[4\] Table 4.6.3-188   
  frequencyBandList                                                                           Not present                                                               
  measCellListNR-r16                                                                          Not present                                                               
  reportQuantities-r16                                                                        both                                                                      
  qualityThreshold-r16                                                                        Not present                                                               
  ssb-MeasConfig-r16                                                                          Not present                                                               
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  measIdleCarrierListEUTRA-r16                                                                *Not present*                                                             
  measIdleDuration-r16                                                                        sec120                                                                    
  validityAreaList-r16                                                                        Not present                                                               
  }                                                                                                                                                                     

Table 8.1.5.11.2.3.3-4: *UEInformationRequest* (steps 11, 26, 41 and 56,
Table 8.1.5.11.2.3.2-1)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32A with condition IDLE
  -------------------------------------------------------------------------

Table 8.1.5.11.2.3.3-5: *UEInformationResponse* (steps 12, 27 and 42,
Table 8.1.5.11.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                                                                                                                 
  ---------------------------------------------------------------------------------------------------------------- ---------------------------------------- --------- -----------
  Information Element                                                                                              Value/remark                             Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                
  measResultIdleNR-r16 SEQUENCE {                                                                                                                                     
  measResultServingCell-r16 SEQUENCE {                                                                                                                                
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1.. maxNrofIndexesToReport)) OF ResultsPerSSB-IndexIdle-r16 {             1 entry                                            
  ResultsPerSSB-IndexIdle-r16\[1\] SEQUENCE {                                                                                                               entry 1   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measResultsPerCarrierListIdleNR-r16 SEQUENCE (SIZE (1.. maxFreqIdle-r16)) OF MeasResultsPerCarrierIdleNR-r16 {   1 entry                                            
  MeasResultsPerCarrierIdleNR-r16\[1\] SEQUENCE {                                                                                                           entry 1   
  carrierFreq-r16                                                                                                  ARFCN value corresponding to NR cell 3             
  measResultsPerCellListIdleNR-r16 SEQUENCE (SIZE (1..maxCellMeasIdle-r16)) OF MeasResultsPerCellIdleNR-r16 {      1 entry                                            
  MeasResultsPerCellIdleNR-r16\[1\] SEQUENCE {                                                                                                              entry 1   
  physCellId-r16                                                                                                   PhysCellId corresponding to NR cell 3              
  measIdleResultNR-r16 SEQUENCE {                                                                                                                                     
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1.. maxNrofIndexesToReport)) OF ResultsPerSSB-IndexIdle-r16 {             1 entry                                            
  ResultsPerSSB-IndexIdle-r16\[1\] SEQUENCE {                                                                                                               entry 1   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   

Table 8.1.5.11.2.3.3-6: *UEInformationResponse* (step 57, Table
8.1.5.11.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                            
  ----------------------------------------------------- -------------- --------- -----------
  Information Element                                   Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                    
  ueInformationResponse-r16 SEQUENCE {                                           
  measResultIdleNR-r16                                  Not present              
  }                                                                              
  }                                                                              
  }                                                                              

##### 8.1.5.11.3 Idle/Inactive measurements / Inactive mode / SIB11 configuration / Measurement of NR cells

##### 8.1.5.11.3.1 Test Purpose (TP) {#test-purpose-tp-38 .H6}

##### (1) {#section-73 .H6}

**with** { UE in NR RRC\_INACTIVE state after receiving *RRCRelease*
message with *suspendConfig* and *measIdleConfig* not including
*measIdleCarrierListNR* while being connected to serving cell in which
*SIB1* includes *idleModeMeasurementsNR* and *SIB11* is configured with
*measIdleCarrierListNR* with *ssb-MeasConfig* and UE supporting
idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after successful measurement procedure and
receiving *RRCResume* message without *idleModeMeasurementReq* }

**then** { UE reports measurement results in *UEInformationResponse
message* }

}

##### (2) {#section-74 .H6}

**with** { UE in NR RRC\_INACTIVE state after receiving *RRCRelease*
message with *suspendConfig* and *measIdleConfig* not including
*measIdleCarrierListNR* while being connected to serving cell in which
*SIB1* includes *idleModeMeasurementsNR*, *SIB11* is configured with
*measIdleCarrierListNR* without *ssb-MeasConfig* and *SIB4* is
configured with *interFreqCarrierFreqList* parameters and UE supporting
idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *RRCResume* message with *idleModeMeasurementReq*
after successful measurement procedure }

**then** { UE reports measurement results in *RRCResumeComplete message*
}

}

##### (3) {#section-75 .H6}

**with** { UE in NR RRC\_INACTIVE state after receiving *RRCRelease*
message with *suspendConfig* and *measIdleConfig* not including
*measIdleCarrierListNR* while being connected to serving cell in which
*SIB1* includes *idleModeMeasurementsNR* and *SIB11* is not configured
and UE supporting idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after unsuccessful measurement procedure and
receiving *RRCResume* message without *idleModeMeasurementReq* }

**then** { UE does not report measurement results in
*UEInformationResponse message* }

}

##### 8.1.5.11.3.2 Conformance requirements {#conformance-requirements-38 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.8.3, 5.7.8, 5.3.13.4 and 5.7.10.3.
Unless otherwise stated, these are Rel-16 requirements.

\[TS 38.331, clause 5.3.8.3\]

1\> if the *RRCRelease* includes the *measIdleConfig*:

2\> if T331 is running:

3\> stop timer T331;

3\> perform the actions as specified in 5.7.8.3;

2\> if the *measIdleConfig* is set to *setup*:

3\> store the received *measIdleDuration* in *VarMeasIdleConfig*;

3\> start timer T331 with the value set to *measIdleDuration*;

\[TS 38.331, clause 5.7.8.1a\]

While in RRC\_IDLE or RRC\_INACTIVE, and T331 is running, the UE shall:

1\> if *VarMeasIdleConfig* includes neither a *measIdleCarrierListEUTRA*
nor a *measIdleCarrierListNR* received from the *RRCRelease* message:

2\> if the UE supports *idleInactiveNR-MeasReport*:

3\> if *SIB11* includes the *measIdleConfigSIB* and contains
*measIdleCarrierListNR*:

4\> store or replace the *measIdleCarrierListNR* of *measIdleConfigSIB*
of *SIB11* within *VarMeasIdleConfig*;

3\> else:

4\> remove the *measIdleCarrierListNR* in *VarMeasIdleConfig*, if
stored;

1\> for each entry in the *measIdleCarrierListNR* within
*VarMeasIdleConfig* that does not contain an *ssb-MeasConfig* received
from the *RRCRelease* message:

2\> if there is an entry in *measIdleCarrierListNR* in
*measIdleConfigSIB* of *SIB11* that has the same carrier frequency and
subcarrier spacing as the entry in the *measIdleCarrierListNR* within
*VarMeasIdleConfig* and that contains *ssb-MeasConfig*:

3\> delete the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

3\> store the SSB measurement configuration from *SIB11* into
*nrofSS-BlocksToAverage*, *absThreshSS-BlocksConsolidation*, *smtc*,
*ssb-ToMeasure*, *deriveSSB-IndexFromCell*, and *ss-RSSI-Measurement*
within *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

2\> else if there is an entry in *interFreqCarrierFreqList* *of SIB4*
with the same carrier frequency and subcarrier spacing as the entry in
*measIdleCarrierListNR* within *VarMeasIdleConfig*:

3\> delete the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

3\> store the SSB measurement configuration from *SIB4* into
*nrofSS-BlocksToAverage*, *absThreshSS-BlocksConsolidation*, *smtc*,
*ssb-ToMeasure*, *deriveSSB-IndexFromCell*, and *ss-RSSI-Measurement*
within *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

2\> else:

3\> remove the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*, if stored;

1\> perform measurements according to 5.7.8.2a.

\[TS 38.331, clause 5.7.8.2a\]

While in RRC\_IDLE or RRC\_INACTIVE, and T331 is running, the UE shall:

1\> perform the measurements in accordance with the following:

2\> if the *VarMeasIdleConfig* includes the *measIdleCarrierListNR* and
the SIB1 contains *idleModeMeasurementsNR*:

3\> for each entry in *measIdleCarrierListNR* within *VarMeasIdleConfig
that contains ssb-MeasConfig*:

4\> if UE supports carrier aggregation or NR-DC between serving carrier
and the carrier frequency and subcarrier spacing indicated by
*carrierFreq* and *ssbSubCarrierSpacing* within the corresponding entry:

5\> perform measurements in the carrier frequency and subcarrier spacing
indicated by *carrierFreq* and *ssbSubCarrierSpacing* within the
corresponding entry;

5\> if the *reportQuantities* is set to rsrq:

6\> consider RSRQ as the cell sorting quantity;

5\> else:

6\> consider RSRP as the cell sorting quantity;

5\> if the *measCellListNR* is included:

6\> consider cells identified by each entry within the *measCellListNR*
to be applicable for idle/inactive measurement reporting;

5\> else:

6\> consider up to *maxCellMeasIdle* strongest identified cells,
according to the sorting quantity, to be applicable for idle/inactive
measurement reporting;

5\> for all cells applicable for idle/inactive measurement reporting,
derive cell measurement results for the measurement quantities indicated
by *reportQuantities;*

5\> store the derived cell measurement results as indicated by
*reportQuantities* for cells applicable for idle/inactive measurement
reporting within *measResultsPerCarrierListIdleNR* in the
*measReportIdleNR* in *VarMeasIdleReport* in decreasing order of the
cell sorting quantity, i.e. the best cell is included first, as follows:

6\> if *qualityThreshold* is configured:

7\> include the measurement results from the cells applicable for
idle/inactive measurement reporting whose RSRP/RSRQ measurement results
are above the value(s) provided in *qualityThreshold;*

6\> else:

7\> include the measurement results from all cells applicable for
idle/inactive measurement reporting;

2\> if, as a result of the procedure in this subclause, the UE performs
measurements in one or more carrier frequency indicated by
*measIdleCarrierListNR* or *measIdleCarrierListEUTRA*:

3\> store the cell measurement results for RSRP and RSRQ for the serving
cell within *measResultServingCell* in the measReportIdleNR in
*VarMeasIdleReport*.

NOTE 1: How the UE performs idle/inactive measurements is up to UE
implementation as long as the requirements in TS 38.133 \[14\] are met
for measurement reporting.

NOTE 2: The UE is not required to perform idle/inactive measurements on
a given carrier if the SSB configuration of that carrier provided via
dedicated signalling is different from the SSB configuration broadcasted
in the serving cell, if any.

> NOTE 3: How the UE prioritizes which frequencies to measure or report
> (in case it is configured with more frequencies than it can measure or
> report) is left to UE implementation.

\[TS 38.331, clause 5.7.8.3\]

1\> if T331 expires or is stopped:

2\> release the *VarMeasIdleConfig*.

NOTE: It is up to UE implementation whether to continue idle/inactive
measurements according to SIB11 and SIB4 configurations or according to
E-UTRA SIB5 and E-UTRA SIB24 configurations as specified in TS 36.331
\[10\] upon inter-RAT cell reselection to E-UTRA, after T331 has expired
or stopped.

\[TS 38.331, clause 5.3.13.4\]

The UE shall:

1\> set the content of the of *RRCResumeComplete* message as follows:

2\> if the UE has idle/inactive measurement information concerning cells
other than the PCell available in *VarMeasIdleReport*:

3\> if the *idleModeMeasurementReq* is included in the *RRCResume*
message:

4\> set the *measResultIdleNR* in the *RRCResumeComplete* message to the
value of *measReportIdleNR* in the *VarMeasIdleReport*, if available;

4\> discard the *VarMeasIdleReport* upon successful delivery of the
*RRCResumeComplete* message is confirmed by lower layers;

3\> else:

4\> if the SIB1 contains *idleModeMeasurementsNR* and the UE has NR
idle/inactive measurement information concerning cells other than the
PCell available in *VarMeasIdleReport*; or

5\> include the *idleMeasAvailable*;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

1\> if the *idleModeMeasurementReq* is included in the
*UEInformationRequest and the UE has stored VarMeasIdleReport* that
contains measurement information concerning cells other than the PCell:

2\> set the *measResultIdleNR* in the *UEInformationResponse* message to
the value of *measReportIdleNR* in the *VarMeasIdleReport*, if
available*;*

> 2\> discard the *VarMeasIdleReport* upon successful delivery of the
> *UEInformationResponse* message confirmed by lower layers;

##### 8.1.5.11.3.3 Test Description {#test-description-38 .H6}

##### 8.1.5.11.3.3.1 Pre-test conditions {#pre-test-conditions-38 .H6}

##### System Simulator: {#system-simulator-30 .H6}

\- NR Cell 1, serving cell. System information combination NR-19 defined
in TS 38.508-1 \[4\] clause 4.4.3.1.2 is used. Condition EMR\_NR used
for SIB1 and condition EMR\_NR\_SIB11 used for SIB11.

\- NR Cell 3, suitable for inter-frequency measurements. System
information combination NR-1 defined in TS 38.508-1 \[4\] clause
4.4.3.1.2.

##### UE: {#ue-27 .H6}

\- None.

##### Preamble: {#preamble-26 .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3 on NR Cell 1.

##### 8.1.5.11.3.3.2 Test procedure sequence {#test-procedure-sequence-38 .H6}

Table 8.1.5.11.3.3.2-1: Main behaviour

  St   Procedure                                                                                                                                                                        Message Sequence   TP                                Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- --------- ----
                                                                                                                                                                                        U - S              Message                                     
  1    The SS transmits *RRCRelease* message including *suspendConfig* and *measIdleConfig* without *measIdleCarrierListNR* to the UE.                                                  \<\--              NR RRC: *RRCRelease*              \-        \-
  2    Wait for 15 s for UE to enter RRC\_INACTIVE mode and to perform measurements.                                                                                                    \-                 *-*                               \-        \-
  3    SS transmits *Paging* message to UE.                                                                                                                                             \<\--              NR RRC: *Paging*                  \-        \-
  4    UE transmits *RRCResumeRequest* message to SS.                                                                                                                                   \--\>              NR RRC: *RRCResumeRequest*        \-        \-
  5    SS transmits *RRCResume* message without *idleModeMeasurementReq* to UE.                                                                                                         \<\--              NR RRC: *RRCResume*               \-        \-
  6    UE transmits *RRCResumeComplete* message with *idleMeasAvailable* to SS.                                                                                                         \--\>              NR RRC: *RRCResumeComplete*       \-        \-
  7    The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                    \<\--              NR RRC: *UEInformationRequest*    \-        \-
  8    Check: Does the UE transmit *UEInformationResponse including measResultIdleNR?*                                                                                                  \--\>              NR RRC: *UEInformationResponse*   1         P
  9    The SS changes system information combination of NR Cell 1 to NR-18 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1 and EMR\_NR\_SIB4 for SIB11.   \-                 *-*                               \-        \-
  10   The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                    \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  11   Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                           \-                 *-*                               \-        \-
  12   The SS transmits *RRCRelease* message including *suspendConfig and* *measIdleConfig* without *measIdleCarrierListNR* to the UE*.*                                                \<\--              *NR RRC: RRCRelease*              \-        \-
  13   Wait for 15 s for UE to enter RRC\_INACTIVE mode and to perform measurements.                                                                                                    \-                 \-                                \-        \-
  14   SS transmits *Paging* message to UE.                                                                                                                                             \<\--              NR RRC: *Paging*                  \-        \-
  15   UE transmits *RRCResumeRequest* message to SS.                                                                                                                                   \--\>              NR RRC: *RRCResumeRequest*        \-        \-
  16   SS transmits *RRCResume* message with *idleModeMeasurementReq* to UE.                                                                                                            \<\--              NR RRC: *RRCResume*               \-        \-
  17   Check: Does UE transmit *RRCResumeComplete* message with *measResultIdleNR* to SS?                                                                                               \--\>              NR RRC: *RRCResumeComplete*       2         P
  18   The SS changes system information combination of NR Cell 1 to NR-1 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1.                                \-                 *-*                               \-        \-
  19   The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                    \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  20   Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                           \-                 *-*                               \-        \-
  21   The SS transmits *RRCRelease* message including *suspendConfig* and *measIdleConfig* without *measIdleCarrierListNR* to the UE.                                                  \<\--              *NR RRC: RRCRelease*              \-        \-
  22   Wait for 15 s for UE to enter RRC\_INACTIVE mode and to perform measurements.                                                                                                    \-                 *-*                               \-        \-
  23   SS transmits *Paging* message to UE.                                                                                                                                             \<\--              NR RRC: *Paging*                  \-        \-
  24   UE transmits *RRCResumeRequest* message to SS.                                                                                                                                   \--\>              NR RRC: *RRCResumeRequest*        \-        \-
  25   SS transmits *RRCResume* message without *idleModeMeasurementReq* to UE.                                                                                                         \<\--              NR RRC: *RRCResume*               \-        \-
  26   UE transmits *RRCResumeComplete* without *idleMeasAvailable* message to SS.                                                                                                      \--\>              NR RRC: *RRCResumeComplete*       \-        \-
  27   The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                    \<\--              NR RRC: *UEInformationRequest*    \-        \-
  28   Check: Does the UE transmit *UEInformationResponse without measResultIdleNR?*                                                                                                    \--\>              NR RRC: *UEInformationResponse*   3         P

##### 8.1.5.11.3.3.3 Specific message contents {#specific-message-contents-38 .H6}

Table 8.1.5.11.3.3.3-1: *RRCRelease* (steps 1, 12 and 21, Table
8.1.5.11.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16 with condition NR\_RRC\_INACTIVE                             
  ------------------------------------------------------------------------------------ --------------- --------- -----------
  Information Element                                                                  Value/remark    Comment   Condition
  RRCRelease ::= SEQUENCE {                                                                                      
  criticalExtensions CHOICE {                                                                                    
  rrcRelease SEQUENCE {                                                                                          
  nonCriticalExtensions SEQUENCE {                                                                               
  nonCriticalExtensions SEQUENCE {                                                                               
  measIdleConfig-r16 CHOICE {                                                                                    
  setup SEQUENCE {                                                                                               
  measIdleCarrierListNR-r16                                                            *Not present*             
  measIdleCarrierListEUTRA-r16                                                         *Not present*             
  measIdleDuration-r16                                                                 sec120                    
  validityAreaList-r16                                                                 Not present               
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              
  }                                                                                                              

Table 8.1.5.11.3.3.3-2: Void

Table 8.1.5.11.3.3.3-3: *RRCResume* (step 16, Table 8.1.5.11.3.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-17                            
  Information Element                                  Value/remark   Comment   Condition
  RRCResume ::= SEQUENCE {                                                      
  criticalExtensions CHOICE {                                                   
  rrcResume SEQUENCE {                                                          
  nonCriticalExtension SEQUENCE {                                               
  nonCriticalExtension SEQUENCE {                                               
  idleModeMeasurementReq-r16                           true                     
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.5.11.3.3.3-4: *RRCResumeComplete* (step 6, Table
8.1.5.11.3.3.2-1)

  Derivation Path: TS 38.508 \[4\], table 4.6.1-18                            
  -------------------------------------------------- -------------- --------- -----------
  Information Element                                Value/remark   Comment   Condition
  RRCResumeComplete ::= SEQUENCE {                                            
  criticalExtensions CHOICE {                                                 
  rrcResumeComplete SEQUENCE {                                                
  nonCriticalExtension SEQUENCE {                                             
  idleMeasAvailable-r16                              true                     
  }                                                                           
  }                                                                           
  }                                                                           
  }                                                                           

Table 8.1.5.11.3.3.3-5: *RRCResumeComplete* (step 17, Table
8.1.5.11.3.3.2-1)

  Derivation Path: TS 38.508 \[4\], table 4.6.1-18                                               
  -------------------------------------------------- ------------------ ------------------------ -----------
  Information Element                                Value/remark       Comment                  Condition
  RRCResumeComplete ::= SEQUENCE {                                                               
  criticalExtensions CHOICE {                                                                    
  rrcResumeComplete SEQUENCE {                                                                   
  nonCriticalExtension SEQUENCE {                                                                
  measResultIdleNR-r16                               MeasResultIdleNR   Table 8.1.5.11.3.3.3-9   
  }                                                                                              
  }                                                                                              
  }                                                                                              
  }                                                                                              

Table 8.1.5.11.3.3.3-6: *UEInformationRequest* (steps 7 and 27, Table
8.1.5.11.3.3.2-1)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32A with condition IDLE
  -------------------------------------------------------------------------

Table 8.1.5.11.3.3.3-7: *UEInformationResponse* (step 8, Table
8.1.5.11.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                                               
  ----------------------------------------------------- ------------------ ------------------------ -----------
  Information Element                                   Value/remark       Comment                  Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                          
  criticalExtensions CHOICE {                                                                       
  ueInformationResponse-r16 SEQUENCE {                                                              
  measResultIdleNR-r16                                  MeasResultIdleNR   Table 8.1.5.11.3.3.3-9   
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 

Table 8.1.5.11.3.3.3-8: *UEInformationResponse* (step 28, Table
8.1.5.11.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                            
  ----------------------------------------------------- -------------- --------- -----------
  Information Element                                   Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                    
  ueInformationResponse-r16 SEQUENCE {                                           
  measResultIdleNR-r16                                  Not present              
  }                                                                              
  }                                                                              
  }                                                                              

Table 8.1.5.11.3.3.3-9: *MeasResultIdleNR* (Table 8.1.5.11.3.3.3-5 and
Table 8.1.5.11.3.3.3-7)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-79D                                                                                                                 
  ---------------------------------------------------------------------------------------------------------------- ---------------------------------------- --------- -----------
  Information Element                                                                                              Value/remark                             Comment   Condition
  MeasResultIdleNR-r16 ::= SEQUENCE {                                                                                                                                 
  measResultServingCell-r16 SEQUENCE {                                                                                                                                
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1.. maxNrofIndexesToReport)) OF ResultsPerSSB-IndexIdle-r16 {             1 entry                                            
  ResultsPerSSB-IndexIdle-r16\[1\] SEQUENCE {                                                                                                               entry 1   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measResultsPerCarrierListIdleNR-r16 SEQUENCE (SIZE (1.. maxFreqIdle-r16)) OF MeasResultsPerCarrierIdleNR-r16 {   1 entry                                            
  MeasResultsPerCarrierIdleNR-r16\[1\] SEQUENCE {                                                                                                           entry 1   
  carrierFreq-r16                                                                                                  ARFCN value corresponding to NR cell 3             
  measResultsPerCellListIdleNR-r16 SEQUENCE (SIZE (1..maxCellMeasIdle-r16)) OF MeasResultsPerCellIdleNR-r16 {      1 entry                                            
  MeasResultsPerCellIdleNR-r16\[1\] SEQUENCE {                                                                                                              entry 1   
  physCellId-r16                                                                                                   PhysCellId corresponding to NR cell 3              
  measIdleResultNR-r16 SEQUENCE {                                                                                                                                     
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1.. maxNrofIndexesToReport)) OF ResultsPerSSB-IndexIdle-r16 {             1 entry                                            
  ResultsPerSSB-IndexIdle-r16\[1\] SEQUENCE {                                                                                                               entry 1   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   

##### 8.1.5.11.4 Idle/Inactive measurements / Inactive mode / RRCRelease configuration / Measurement of NR cells

##### 8.1.5.11.4.1 Test Purpose (TP) {#test-purpose-tp-39 .H6}

##### (1) {#section-76 .H6}

**with** { UE in NR RRC\_INACTIVE state after receiving *RRCRelease*
message with *suspendConfig* and *measIdleConfig* configured with
*measIdleCarrierListNR* with *ssb-MeasConfig* while being connected to
serving cell in which *SIB1* includes *idleModeMeasurementsNR* and UE
supporting idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after successful measurement procedure and
receiving *RRCResume* message without *idleModeMeasurementReq* }

**then** { UE reports measurement results in *UEInformationResponse
message* }

}

##### (2) {#section-77 .H6}

**with** { UE in NR RRC\_INACTIVE state after receiving *RRCRelease*
message with *suspendConfig* and *measIdleConfig* configured with
*measIdleCarrierListNR* without *ssb-MeasConfig* while being connected
to serving cell in which in which *SIB1* includes
*idleModeMeasurementsNR* and *SIB11* is configured with
*measIdleCarrierListNR* with *ssb-MeasConfig* and UE supporting
idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *RRCResume* message with *idleModeMeasurementReq*
after successful measurement procedure }

**then** { UE reports measurement results in *RRCResumeComplete message*
}

}

##### (3) {#section-78 .H6}

**with** { UE in NR RRC\_INACTIVE state after receiving *RRCRelease*
message with *suspendConfig* and *measIdleConfig* configured with
*measIdleCarrierListNR* without *ssb-MeasConfig* while being connected
to serving cell in which *SIB1* includes idleModeMeasurementsNR and
*SIB11* is configured with *measIdleCarrierListNR* without
*ssb-MeasConfig and SIB4* is configured with *interFreqCarrierFreqList*
parameters and UE supporting idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *RRCResume* message with *idleModeMeasurementReq*
after successful measurement procedure }

**then** { UE reports measurement results in *RRCResumeComplete message*
}

}

##### (4) {#section-79 .H6}

**with** { UE in NR RRC\_INACTIVE state after receiving *RRCRelease*
message with *suspendConfig* and *measIdleConfig* including
*measIdleCarrierListNR* without *ssb-MeasConfig* while being connected
to serving cell in which *SIB1* includes *idleModeMeasurementsNR* and UE
supporting idleInactiveNR-MeasReport }

**ensure that** {

**when** { UE receives *UEInformationRequest* message with
*idleModeMeasurementReq* after unsuccessful measurement procedure and
receiving *RRCResume* message without *idleModeMeasurementReq* }

**then** { UE does not report measurement results in
*UEInformationResponse message* }

}

##### 8.1.5.11.4.2 Conformance requirements {#conformance-requirements-39 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.8.3, 5.7.8, 5.3.13.4 and 5.7.10.3.
Unless otherwise stated, these are Rel-16 requirements.

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> if the *RRCRelease* includes the *measIdleConfig*:

2\> if T331 is running:

3\> stop timer T331;

3\> perform the actions as specified in 5.7.8.3;

2\> if the *measIdleConfig* is set to *setup*:

3\> store the received *measIdleDuration* in *VarMeasIdleConfig*;

3\> start timer T331 with the value set to *measIdleDuration*;

3\> if the *measIdleConfig* contains *measIdleCarrierListNR*:

4\> store the received *measIdleCarrierListNR* in *VarMeasIdleConfig*;

\[TS 38.331, clause 5.7.8.1\]

This procedure specifies the measurements to be performed and stored by
a UE in RRC\_IDLE and RRC\_INACTIVE when it has an idle/inactive
measurement configuration.

\[TS 38.331, clause 5.7.8.1a\]

The purpose of this procedure is to update the idle/inactive measurement
configuration.

The UE initiates this procedure while T331 is running and one of the
following conditions is met:

1\> upon selecting a cell when entering RRC\_IDLE or RRC-INACTIVE from
RRC\_CONNECTED or RRC\_INACTIVE; or

1\> upon update of system information (*SIB4*, or *SIB11*), e.g. due to
intra-RAT cell (re)selection;

While in RRC\_IDLE or RRC\_INACTIVE, and T331 is running, the UE shall:

1\> for each entry in the *measIdleCarrierListNR* within
*VarMeasIdleConfig* that does not contain an *ssb-MeasConfig* received
from the *RRCRelease* message:

2\> if there is an entry in *measIdleCarrierListNR* in
*measIdleConfigSIB* of *SIB11* that has the same carrier frequency and
subcarrier spacing as the entry in the *measIdleCarrierListNR* within
*VarMeasIdleConfig* and that contains *ssb-MeasConfig*:

3\> delete the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

3\> store the SSB measurement configuration from *SIB11* into
*nrofSS-BlocksToAverage*, *absThreshSS-BlocksConsolidation*, *smtc*,
*ssb-ToMeasure*, *deriveSSB-IndexFromCell*, and *ss-RSSI-Measurement*
within *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

2\> else if there is an entry in *interFreqCarrierFreqList* *of SIB4*
with the same carrier frequency and subcarrier spacing as the entry in
*measIdleCarrierListNR* within *VarMeasIdleConfig*:

3\> delete the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

3\> store the SSB measurement configuration from *SIB4* into
*nrofSS-BlocksToAverage*, *absThreshSS-BlocksConsolidation*, *smtc*,
*ssb-ToMeasure*, *deriveSSB-IndexFromCell*, and *ss-RSSI-Measurement*
within *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*;

2\> else:

3\> remove the *ssb-MeasConfig* of the corresponding entry in the
*measIdleCarrierListNR* within *VarMeasIdleConfig*, if stored;

1\> perform measurements according to 5.7.8.2a.

\[TS 38.331, clause 5.7.8.2a\]

When performing measurements on NR carriers according to this clause,
the UE shall derive the cell quality as specified in 5.5.3.3 and
consider the beam quality to be the value of the measurement results of
the concerned beam, where each result is averaged as described in TS
38.215 \[9\].

While in RRC\_IDLE or RRC\_INACTIVE, and T331 is running, the UE shall:

1\> perform the measurements in accordance with the following:

2\> if the *VarMeasIdleConfig* includes the *measIdleCarrierListNR* and
the SIB1 contains *idleModeMeasurementsNR*:

3\> for each entry in *measIdleCarrierListNR* within *VarMeasIdleConfig
that contains ssb-MeasConfig*:

4\> if UE supports carrier aggregation or NR-DC between serving carrier
and the carrier frequency and subcarrier spacing indicated by
*carrierFreq* and *ssbSubCarrierSpacing* within the corresponding entry:

5\> perform measurements in the carrier frequency and subcarrier spacing
indicated by *carrierFreq* and *ssbSubCarrierSpacing* within the
corresponding entry;

5\> if the *reportQuantities* is set to rsrq:

6\> consider RSRQ as the cell sorting quantity;

5\> else:

6\> consider RSRP as the cell sorting quantity;

5\> if the *measCellListNR* is included:

6\> consider cells identified by each entry within the *measCellListNR*
to be applicable for idle/inactive measurement reporting;

5\> else:

6\> consider up to *maxCellMeasIdle* strongest identified cells,
according to the sorting quantity, to be applicable for idle/inactive
measurement reporting;

5\> for all cells applicable for idle/inactive measurement reporting,
derive cell measurement results for the measurement quantities indicated
by *reportQuantities;*

5\> store the derived cell measurement results as indicated by
reportQuantities for cells applicable for idle/inactive measurement
reporting within measResultsPerCarrierListIdleNR in the
*measReportIdleNR* in *VarMeasIdleReport* in decreasing order of the
cell sorting quantity, i.e. the best cell is included first, as follows:

6\> if *qualityThreshold* is configured:

7\> include the measurement results from the cells applicable for
idle/inactive measurement reporting whose RSRP/RSRQ measurement results
are above the value(s) provided in *qualityThreshold;*

6\> else:

7\> include the measurement results from all cells applicable for
idle/inactive measurement reporting;

5\> if *beamMeasConfigIdle* is included in the associated entry in
*measIdleCarrierListNR and if UE supports idleInactiveNR-MeasBeamReport
for the FR of the carrier frequency indicated by carrierFreq within the
associated entry, for each cell in the measurement results:*

6\> derive beam measurements based on SS/PBCH block for each measurement
quantity indicated in *reportQuantityRS-Indexes*, as described in TS
38.215 \[9\];

6\> if the *reportQuantityRS-Indexes* is set to rsrq:

7\> consider RSRQ as the beam sorting quantity;

6\> else:

7\> consider RSRP as the beam sorting quantity;

6\> set *resultsSSB-Indexes* to include up to
*maxNrofRS-IndexesToReport* SS/PBCH block indexes in order of decreasing
beam sorting quantity as follows:

7\> include the index associated to the best beam for the sorting
quantity and if *absThreshSS-BlocksConsolidation* is included, the
remaining beams whose sorting quantity is above
*absThreshSS-BlocksConsolidation*;

6\> if the *includeBeamMeasurements* is set to *true*:

7\> include the beam measurement results as indicated by
*reportQuantityRS*-*Indexes*;

2\> if, as a result of the procedure in this subclause, the UE performs
measurements in one or more carrier frequency indicated by
*measIdleCarrierListNR* or *measIdleCarrierListEUTRA*:

3\> store the cell measurement results for RSRP and RSRQ for the serving
cell within *measResultServingCell* in the measReportIdleNR in
*VarMeasIdleReport*.

3\> if the *VarMeasIdleConfig* includes the *measIdleCarrierListNR* and
it contains an entry with *carrierFreq* set to the value of the serving
frequency:

4\> if *beamMeasConfigIdle* is included in that entry, and if the UE
supports *idleInactiveNR- MeasBeamReport* for the FR of the serving
cell:

5\> derive beam measurements based on SS/PBCH block for each measurement
quantity indicated in *reportQuantityRS-Indexes*, as described in TS
38.215 \[9\];

5\> if the *reportQuantityRS-Indexes* is set to rsrq:

6\> consider RSRQ as the beam sorting quantity;

5\> else:

6\> consider RSRP as the beam sorting quantity;

5\> set *resultsSSB-Indexes* to include up to
*maxNrofRS-IndexesToReport* SS/PBCH block indexes in order of decreasing
beam sorting quantity as follows:

6\> include the index associated to the best beam for the sorting
quantity and if *absThreshSS-BlocksConsolidation* is included in *SIB2*
of serving cell, the remaining beams whose sorting quantity is above
*absThreshSS-BlocksConsolidation*;

5\> if the *includeBeamMeasurements* is set to true:

6\> include the beam measurement results as indicated by
*reportQuantityRS-Indexes*;

NOTE 1: How the UE performs idle/inactive measurements is up to UE
implementation as long as the requirements in TS 38.133 \[14\] are met
for measurement reporting.

NOTE 2: The UE is not required to perform idle/inactive measurements on
a given carrier if the SSB configuration of that carrier provided via
dedicated signalling is different from the SSB configuration broadcasted
in the serving cell, if any.

> NOTE 3: How the UE prioritizes which frequencies to measure or report
> (in case it is configured with more frequencies than it can measure or
> report) is left to UE implementation.

\[TS 38.331, clause 5.7.8.3\]

The UE shall:

1\> if T331 expires or is stopped:

2\> release the *VarMeasIdleConfig*.

NOTE: It is up to UE implementation whether to continue idle/inactive
measurements according to SIB11 and SIB4 configurations or according to
E-UTRA SIB5 and E-UTRA SIB24 configurations as specified in TS 36.331
\[10\] upon inter-RAT cell reselection to E-UTRA, after T331 has expired
or stopped.

\[TS 38.331, clause 5.3.13.4\]

The UE shall:

1\> set the content of the of *RRCResumeComplete* message as follows:

2\> if the UE has idle/inactive measurement information concerning cells
other than the PCell available in *VarMeasIdleReport*:

3\> if the *idleModeMeasurementReq* is included in the *RRCResume*
message:

4\> set the *measResultIdleEUTRA* in the *RRCResumeComplete* message to
the value of *measReportIdleEUTRA* in the *VarMeasIdleReport,* if
available;

4\> set the *measResultIdleNR* in the *RRCResumeComplete* message to the
value of *measReportIdleNR* in the *VarMeasIdleReport*, if available;

4\> discard the *VarMeasIdleReport* upon successful delivery of the
*RRCResumeComplete* message is confirmed by lower layers;

3\> else:

4\> if the SIB1 contains *idleModeMeasurementsNR* and the UE has NR
idle/inactive measurement information concerning cells other than the
PCell available in *VarMeasIdleReport*; or

4\> if the SIB1 contains *idleModeMeasurementsEUTRA* and the UE has
E-UTRA idle/inactive measurement information available in
*VarMeasIdleReport*:

5\> include the *idleMeasAvailable*;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

1\> if the *idleModeMeasurementReq* is included in the
*UEInformationRequest and the UE has stored VarMeasIdleReport* that
contains measurement information concerning cells other than the PCell:

2\> set the *measResultIdleNR* in the *UEInformationResponse* message to
the value of *measReportIdleNR* in the *VarMeasIdleReport*, if
available*;*

> 2\> discard the *VarMeasIdleReport* upon successful delivery of the
> *UEInformationResponse* message confirmed by lower layers;

##### 8.1.5.11.4.3 Test Description {#test-description-39 .H6}

##### 8.1.5.11.4.3.1 Pre-test conditions {#pre-test-conditions-39 .H6}

##### System Simulator: {#system-simulator-31 .H6}

\- NR Cell 1, serving cell. System information combination NR-1 defined
in TS 38.508-1 \[4\] clause 4.4.3.1.2. Condition EMR\_NR used for SIB1.

\- NR Cell 3, suitable for inter-frequency measurements. System
information combination NR-1 defined in TS 38.508-1 \[4\] clause
4.4.3.1.2.

##### UE: {#ue-28 .H6}

\- None.

##### Preamble: {#preamble-27 .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3 on NR Cell 1.

##### 8.1.5.11.4.3.2 Test procedure sequence {#test-procedure-sequence-39 .H6}

Table 8.1.5.11.4.3.2-1: Main behaviour

  St   Procedure                                                                                                                                                                         Message Sequence   TP                                Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- --------- ----
                                                                                                                                                                                         U - S              Message                                     
  1    The SS transmits *RRCRelease* message with *suspendConfig* and *measIdleConfig* including *measIdleCarrierListNR* with *ssb-MeasConfig* to the UE*.*                              \<\--              NR RRC: *RRCRelease*              \-        \-
  2    Wait for 15 s for UE to enter RRC\_INACTIVE mode and to perform measurements.                                                                                                     \-                 *-*                               \-        \-
  3    SS transmits *Paging* message to UE.                                                                                                                                              \<\--              NR RRC: *Paging*                  \-        \-
  4    UE transmits *RRCResumeRequest* message to SS.                                                                                                                                    \--\>              NR RRC: *RRCResumeRequest*        \-        \-
  5    SS transmits *RRCResume* message without *idleModeMeasurementReq* to UE.                                                                                                          \<\--              NR RRC: *RRCResume*               \-        \-
  6    UE transmits *RRCResumeComplete* message with *idleMeasAvailable* to SS.                                                                                                          \--\>              NR RRC: *RRCResumeComplete*       \-        \-
  7    The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                     \<\--              NR RRC: *UEInformationRequest*    \-        \-
  8    Check: Does the UE transmit *UEInformationResponse including measResultIdleNR?*                                                                                                   \--\>              NR RRC: *UEInformationResponse*   1         P
  9    The SS changes system information combination of NR Cell 1 to NR-19 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1 and EMR\_NR\_SIB11 for SIB11.   \-                 \-                                \-        \-
  10   The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                     \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  11   Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                            \-                 *-*                               \-        \-
  12   The SS transmits *RRCRelease* message with *suspendConfig* and *measIdleConfig* including *measIdleCarrierListNR* without *ssb-MeasConfig* to the UE.                             \<\--              *NR RRC: RRCRelease*              \-        \-
  13   Wait for 15 s for UE to enter RRC\_INACTIVE mode and to perform measurements.                                                                                                     \-                 \-                                \-        \-
  14   SS transmits *Paging* message to UE.                                                                                                                                              \<\--              NR RRC: *Paging*                  \-        \-
  15   UE transmits *RRCResumeRequest* message to SS.                                                                                                                                    \--\>              NR RRC: *RRCResumeRequest*        \-        \-
  16   SS transmits *RRCResume* message with *idleModeMeasurementReq* to UE.                                                                                                             \<\--              NR RRC: *RRCResume*               \-        \-
  17   Check: Does UE transmit *RRCResumeComplete* message including *measResultIdleNR* to SS?                                                                                           \--\>              NR RRC: *RRCResumeComplete*       2         P
  18   The SS changes system information combination of NR Cell 1 to NR-18 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1 and EMR\_NR\_SIB4 for SIB11.    \-                 *-*                               \-        \-
  19   The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                     \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  20   Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                            \-                 *-*                               \-        \-
  21   The SS transmits *RRCRelease* message with *suspendConfig* and *measIdleConfig* including *measIdleCarrierListNR* without *ssb-MeasConfig* to the UE.                             \<\--              *NR RRC: RRCRelease*              \-        \-
  22   Wait for 15 s for UE to enter RRC\_INACTIVE mode and to perform measurements.                                                                                                     \-                 \-                                \-        \-
  23   SS transmits *Paging* message to UE.                                                                                                                                              \<\--              NR RRC: *Paging*                  \-        \-
  24   UE transmits *RRCResumeRequest* message to SS.                                                                                                                                    \--\>              NR RRC: *RRCResumeRequest*        \-        \-
  25   SS transmits *RRCResume* message with *idleModeMeasurementReq* to UE.                                                                                                             \<\--              NR RRC: *RRCResume*               \-        \-
  26   Check: Does UE transmit *RRCResumeComplete* message including *measResultIdleNR* to SS?                                                                                           \--\>              NR RRC: *RRCResumeComplete*       3         P
  27   The SS changes system information combination of NR Cell 1 to NR-1 defined in TS 38.508-1 \[4\] clause 4.4.3.1.2 with condition EMR\_NR for SIB1.                                 \-                 \-                                \-        \-
  28   The SS transmits a Short message on PDCCH using P-RNTI indicating a *systemInfoModification*.                                                                                     \<\--              PDCCH (DCI 1\_0): Short Message   \-        \-
  29   Wait for 2.1\* modification period to allow the new system information to take effect.                                                                                            \-                 \-                                \-        \-
  30   The SS transmits *RRCRelease* message with *suspendConfig* and *measIdleConfig* including *measIdleCarrierListNR* without *ssb-MeasConfig* to the UE.                             \<\--              *NR RRC: RRCRelease*              \-        \-
  31   Wait for 15 s for UE to enter RRC\_INACTIVE mode and to perform measurements.                                                                                                     \-                 \-                                \-        \-
  32   SS transmits *Paging* message to UE.                                                                                                                                              \<\--              NR RRC: *Paging*                  \-        \-
  33   UE transmits *RRCResumeRequest* message to SS.                                                                                                                                    \--\>              NR RRC: *RRCResumeRequest*        \-        \-
  34   SS transmits *RRCResume* message without *idleModeMeasurementReq* to UE.                                                                                                          \<\--              NR RRC: *RRCResume*               \-        \-
  35   UE transmits *RRCResumeComplete* message without *idleMeasAvailable* to SS.                                                                                                       \--\>              NR RRC: *RRCResumeComplete*       \-        \-
  36   The SS transmits *UEInformationRequest* message including *idleModeMeasurementReq* to the UE.                                                                                     \<\--              NR RRC: *UEInformationRequest*    \-        \-
  37   Check: Does the UE transmit *UEInformationResponse without measResultIdleNR?*                                                                                                     \--\>              NR RRC: *UEInformationResponse*   4         P

##### 8.1.5.11.4.3.3 Specific message contents {#specific-message-contents-39 .H6}

Table 8.1.5.11.4.3.3-1: *RRCRelease* (steps 1, 12, 21 and 30, Table
8.1.5.11.4.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-16 with condition NR\_RRC\_INACTIVE                                                                                    
  ------------------------------------------------------------------------------------------- ------------------------------------- ----------------------------------- ---------------------
  Information Element                                                                         Value/remark                          Comment                             Condition
  RRCRelease ::= SEQUENCE {                                                                                                                                             
  criticalExtensions CHOICE {                                                                                                                                           
  rrcRelease SEQUENCE {                                                                                                                                                 
  nonCriticalExtensions SEQUENCE {                                                                                                                                      
  nonCriticalExtensions SEQUENCE {                                                                                                                                      
  measIdleConfig-r16 CHOICE {                                                                                                                                           
  setup SEQUENCE {                                                                                                                                                      
  measIdleCarrierListNR-r16 SEQUENCE (SIZE (1..maxFreqIdle-r16)) OF MeasIdleCarrierNR-r16 {   1 entry                                                                   
  MeasIdleCarrierNR-r16\[1\] SEQUENCE {                                                                                             entry 1                             
  carrierFreq-r16                                                                             ARFCN value of configured NR cell 3                                       
  ssbSubcarrierSpacing-r16                                                                    SubcarrierSpacing                     TS 38.508-1 \[4\] Table 4.6.3-188   
  frequencyBandList                                                                           Not present                                                               
  measCellListNR-r16                                                                          Not present                                                               
  reportQuantities-r16                                                                        both                                                                      
  qualityThreshold-r16                                                                        Not present                                                               
  ssb-MeasConfig-r16                                                                          Not present                                                               steps 12, 21 and 30
  ssb-MeasConfig-r16 SEQUENCE {                                                                                                                                         step 1
  nrofSS-BlocksToAverage-r16                                                                  2                                                                         
  absThreshSS-BlocksConsolidation-r16 SEQUENCE {                                                                                                                        
  thresholdRSRP                                                                               RSRP-Range                            TS 38.508-1 \[4\] Table 4.6.3-152   
  thresholdRSRQ                                                                               Not present                                                               
  thresholdSINR                                                                               Not present                                                               
  }                                                                                                                                                                     
  smtc-r16                                                                                    SSB-MTC                               TS 38.508-1 \[4\] Table 4.6.3-185   
  ssb-ToMeasure-r16                                                                           SSB-ToMeasure                         TS 38.508-1 \[4\] Table 4.6.3-187   
  deriveSSB-IndexFromCell-r16                                                                 false                                                                     
                                                                                              true                                                                      FR1\_TDD, FR2\_TDD
  ss-RSSI-Measurement-r16                                                                     Not present                                                               
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  measIdleCarrierListEUTRA-r16                                                                *Not present*                                                             
  measIdleDuration-r16                                                                        sec120                                                                    
  validityAreaList-r16                                                                        Not present                                                               
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     

Table 8.1.5.11.4.3.3-2: Void

Table 8.1.5.11.4.3.3-3: Void

Table 8.1.5.11.4.3.3-4: *RRCResume* (steps 16 and 25, Table
8.1.5.11.4.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-17                            
  Information Element                                  Value/remark   Comment   Condition
  RRCResume ::= SEQUENCE {                                                      
  criticalExtensions CHOICE {                                                   
  rrcResume SEQUENCE {                                                          
  nonCriticalExtension SEQUENCE {                                               
  nonCriticalExtension SEQUENCE {                                               
  idleModeMeasurementReq-r16                           true                     
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.5.11.4.3.3-5: *RRCResumeComplete* (step 6, Table
8.1.5.11.4.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-18                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeComplete ::= SEQUENCE {                                              
  criticalExtensions CHOICE {                                                   
  rrcResumeComplete SEQUENCE {                                                  
  nonCriticalExtension SEQUENCE {                                               
  idleMeasAvailable-r16                                true                     
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             

Table 8.1.5.11.4.3.3-6: *RRCResumeComplete* (steps 17 and 26, Table
8.1.5.11.4.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-18                                               
  ---------------------------------------------------- ------------------ ------------------------ -----------
  Information Element                                  Value/remark       Comment                  Condition
  RRCResumeComplete ::= SEQUENCE {                                                                 
  criticalExtensions CHOICE {                                                                      
  rrcResumeComplete SEQUENCE {                                                                     
  nonCriticalExtension SEQUENCE {                                                                  
  measResultIdleNR-r16                                 MeasResultIdleNR   Table 8.1.5.11.4.3.3-9   
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                

Table 8.1.5.11.4.3.3-7: *UEInformationResponse* (step 8, Table
8.1.5.11.4.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                                               
  ----------------------------------------------------- ------------------ ------------------------ -----------
  Information Element                                   Value/remark       Comment                  Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                          
  criticalExtensions CHOICE {                                                                       
  ueInformationResponse-r16 SEQUENCE {                                                              
  measResultIdleNR-r16                                  MeasResultIdleNR   Table 8.1.5.11.4.3.3-9   
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 

Table 8.1.5.11.4.3.3-8: *UEInformationResponse* (step 37, Table
8.1.5.11.4.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                            
  ----------------------------------------------------- -------------- --------- -----------
  Information Element                                   Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                    
  ueInformationResponse-r16 SEQUENCE {                                           
  measResultIdleNR-r16                                  Not present              
  }                                                                              
  }                                                                              
  }                                                                              

Table 8.1.5.11.4.3.3-9: *MeasResultIdleNR* (Tables 8.1.5.11.4.3.3-6 and
8.1.5.11.4.3.3-7)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-79D                                                                                                                 
  ---------------------------------------------------------------------------------------------------------------- ---------------------------------------- --------- -----------
  Information Element                                                                                              Value/remark                             Comment   Condition
  measResultIdleNR-r16 ::= SEQUENCE {                                                                                                                                 
  measResultServingCell-r16 SEQUENCE {                                                                                                                                
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1.. maxNrofIndexesToReport)) OF ResultsPerSSB-IndexIdle-r16 {             1 entry                                            
  ResultsPerSSB-IndexIdle-r16\[1\] SEQUENCE {                                                                                                               entry 1   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measResultsPerCarrierListIdleNR-r16 SEQUENCE (SIZE (1.. maxFreqIdle-r16)) OF MeasResultsPerCarrierIdleNR-r16 {   1 entry                                            
  MeasResultsPerCarrierIdleNR-r16\[1\] SEQUENCE {                                                                                                           entry 1   
  carrierFreq-r16                                                                                                  ARFCN value corresponding to NR cell 3             
  measResultsPerCellListIdleNR-r16 SEQUENCE (SIZE (1..maxCellMeasIdle-r16)) OF MeasResultsPerCellIdleNR-r16 {      1 entry                                            
  MeasResultsPerCellIdleNR-r16\[1\] SEQUENCE {                                                                                                              entry 1   
  physCellId-r16                                                                                                   PhysCellId corresponding to NR cell 3              
  measIdleResultNR-r16 SEQUENCE {                                                                                                                                     
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1.. maxNrofIndexesToReport)) OF ResultsPerSSB-IndexIdle-r16 {             1 entry                                            
  ResultsPerSSB-IndexIdle-r16\[1\] SEQUENCE {                                                                                                               entry 1   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   

#### 8.1.5.12 Partial Sounding

##### 8.1.5.12.1 Partial Sounding / RRC\_CONNECTED / RRCReconfiguration

##### 8.1.5.12.1.1 Test Purpose (TP) {#test-purpose-tp-40 .H6}

##### (1) {#section-80 .H6}

**with** { UE in NR RRC\_CONNECTED state }

**ensure that** {

**when** { UE receives an RRCReconfiguration message with
partialFreqSounding-r17 configured }

**then** { UE performs SRS transmission using the resource on UL
subframe configured by partialFreqSounding-r17 }

}

##### 8.1.5.12.1.2 Conformance requirements {#conformance-requirements-40 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.214, clause 6.2.1. Unless otherwise stated these are
Rel-17 requirements.

\[TS 38.214 clause 6.2.1\]

The following SRS parameters are semi-statically configurable by higher
layer parameter *SRS-Resource* or *SRS-PosResource*.

*- srs-ResourceId* or *SRS-PosResourceId determines SRS resource
configuration identity.*

*-* Number of SRS ports, as defined by the higher layer parameter
*nrofSRS-Ports* and described in clause 6.4.1.4 of \[4, TS 38.211\]. If
not configured, *nrofSRS-Ports* is 1.

*-* Time domain behaviour of SRS resource configuration as indicated by
the higher layer parameter *resourceType*, which may be periodic,
semi-persistent, aperiodic SRS transmission as defined in clause 6.4.1.4
of \[4, TS 38.211\].

\- Slot level periodicity and slot level offset as defined by the higher
layer parameters *periodicityAndOffset-p* or *periodicityAndOffset-sp*
for an SRS resource of type periodic or semi-persistent. The UE is not
expected to be configured with SRS resources in the same SRS resource
set *SRS-ResourceSet* or *SRS-PosResourceSet* with different slot level
periodicities. For an *SRS-ResourceSet* configured with higher layer
parameter *resourceType* set to \'aperiodic\', a slot level offset is
defined by the higher layer parameter *slotOffset.* For an
*SRS-ResourceSet* configured with higher layer parameter *resourceType*
set to \'aperiodic\', a list of up to four different available slot
offset values from the reference slot *n* + *k* to the slot where the
aperiodic SRS resource set is transmitted where *n* is the slot with
triggering DCI and *k* is *slotOffset,* can be configured by the higher
layer parameter *availableSlotOffsetList. The parameter
availableSlotOffsetList can be configured up to 4 different values.* For
an *SRS-PosResourceSet configured w*ith higher layer parameter
r*esourceType* set to \'aperiodic\', the slot level offset is defined by
the higher layer parameter *slotOffset for each S*RS resource.

\- Number of OFDM symbols in the SRS resource, starting OFDM symbol of
the SRS resource within a slot including repetition factor R as defined
by the higher layer parameter *resourceMapping* and described in clause
6.4.1.4 of \[4, TS 38.211\]. If *R* is not configured, then *R* is equal
to the number of OFDM symbols in the SRS resource.

\- SRS bandwidth and , as defined by the higher layer parameter
*freqHopping* and described in clause 6.4.1.4 of \[4, TS 38.211\]. If
not configured, then= 0.

\- Frequency hopping bandwidth , as defined by the higher layer
parameter *freqHopping* and described in clause 6.4.1.4 of \[4, TS
38.211\]. If not configured, then = 0.

\- Defining partial frequency sounding factor and start RB index for
partial frequency sounding as defined by the higher layer parameters
*FreqScalingFactor* P~F~ and *StartRBIndex k*~F~*, respectively,* and
described in Clause 6.4.1.4 of \[4, TS 38.211\]. If not configured, then
*P*~F~ = 1 and *k*~F~*,= 0*.

\- Defining start RB index hopping for partial frequency sounding in
different SRS frequency hopping periods for
aperiodic/periodic/semi-persistent SRS based on the hopping pattern
*k*~hop~ as described in clause 6.4.1.4.3 in \[4, TS 38.211. If not
configured, then start RB hopping is not enabled and *k*~hop~ is fixed
to be 0 for all SRS symbols.

\[TS 38.211 clause 6.4.1.4.3\]

When SRS is transmitted on a given SRS resource, the sequence
$r^{\left( p_{i} \right)}(n,l')$ for each OFDM symbol $l'$ and for each
of the antenna ports of the SRS resource shall be multiplied with the
amplitude scaling factor in order to conform to the transmit power
specified in \[5, 38.213\] and mapped in sequence starting with to
resource elements in a slot for each of the antenna ports according to

The length of the sounding reference signal sequence is given by

$$M_{\text{sc},b}^{\text{SRS}} = \frac{m_{\text{SRS},b}N_{\text{sc}}^{\text{RB}}}{\left( K_{\text{TC}}P_{\text{F}}\  \right)}$$

where $m_{\text{SRS},b}$ is given by a selected row of Table 6.4.1.4.3-1
with where is given by the field *b-SRS* contained in the higher-layer
parameter *freqHopping* if configured, otherwise $B_{\text{SRS}} = 0$.
The row of the table is selected according to the index given by the
field *c-SRS* contained in the higher-layer parameter *freqHopping*. The
quantity $P_{\text{F}}$ $\in \left\{ 2,\ 4 \right\}$ is given by the
higher-layer parameter *FreqScalingFactor* if configured, otherwise
$P_{\text{F}} = 1$. When *FreqScalingFactor* is configured, the UE
expects the length of the SRS sequence to be a multiple of 6.

The frequency-domain starting position $k_{0}^{(p_{i})}$ is defined by

$$k_{0}^{(p_{i})} = {\overline{k}}_{0}^{(p_{i})} + n_{\text{offset}}^{\text{FH}} + n_{\text{offset}}^{\text{RPFS}}$$

where

$${{\overline{k}}_{0}^{(p_{i})} = n_{\text{shift}}N_{\text{sc}}^{\text{RB}} + \left( k_{\text{TC}}^{(p_{i})} + k_{\text{offset}}^{l^{'}} \right)\text{\ mod\ }K_{\text{TC}}
}{k_{\text{TC}}^{\left( p_{i} \right)} = \left\{ \begin{matrix}
\left( {\overline{k}}_{\text{TC}} + \frac{K_{\text{TC}}}{2} \right)\ \text{mod}\text{\ }K_{\text{TC}} & \text{if}\text{\ }N_{\text{ap}}^{\text{SRS}} = 4,\text{\ }p_{i} \in \left\{ 1001,\ 1003 \right\}\text{,\ and\ }n_{\text{SRS}}^{\text{cs,max}} = 6\text{\ } \\
\left( {\overline{k}}_{\text{TC}} + \frac{K_{\text{TC}}}{2} \right)\text{\ mod\ }K_{\text{TC}}\  & \text{if\ }N_{\text{ap}}^{\text{SRS}} = 4,\text{\ }p_{i} \in \left\{ 1001,\ 1003 \right\}\text{,\ and\ }n_{\text{SRS}}^{\text{cs}} \in \left\{ \frac{n_{\text{SRS}}^{\text{cs,max}}}{2},\ \ldots,\ n_{\text{SRS}}^{\text{cs,max}} - 1 \right\} \\
{\overline{k}}_{\text{TC}} & \text{otherwise} \\
\end{matrix} \right.\ 
}{n_{\text{offset}}^{\text{FH}} = \sum_{b = 0}^{B_{\text{SRS}}}{m_{\text{SRS},b}N_{\text{sc}}^{\text{RB}}n_{b}}
}{n_{\text{offset}}^{\text{RPFS}} = N_{\text{sc}}^{\text{RB}}\frac{m_{\text{SRS},B_{\text{SRS}}}\left( \left( k_{\text{F}} + k_{\text{hop}} \right)\text{mod}\ P_{\text{F}} \right)}{P_{\text{F}}}}$$

and

\- $k_{\text{F}} \in \left\{ 0,1,\ldots,P_{\text{F}} - 1 \right\}$ is
given by the higher-layer parameter *StartRBIndex* if configured,
otherwise $k_{\text{F}} = 0$;

*-* $k_{\text{hop}}$ *is given by Table 6.4.1.4.3-3 with*

$${{\overline{k}}_{\text{hop}} = \left\lfloor \frac{n_{\text{SRS}}}{\prod_{b' = b_{\text{hop}}}^{B_{\text{SRS}}}N_{b'}} \right\rfloor\ \text{mod}\ P_{\text{F}}
}{N_{b_{\text{hop}}} = 1}$$

*if the higher-layer parameter EnableStartRBHopping is configured,
otherwise* $k_{\text{hop}} = 0$*.*

##### 8.1.5.12.1.3 Test description {#test-description-40 .H6}

##### 8.1.5.12.1.3.1 Pre-test conditions {#pre-test-conditions-40 .H6}

##### System Simulator: {#system-simulator-32 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell.

##### UE: {#ue-29 .H6}

\- None.

##### Preamble: {#preamble-28 .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.5.12.1.3.2 Test procedure sequence {#test-procedure-sequence-40 .H6}

Table 8.1.5.12.1.3.2-1: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRCReco     |         |    |
|    | *RRCReco     |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message to   |              |              |         |    |
|    | configure    |              |              |         |    |
|    | the partial  |              |              |         |    |
|    | sounding     |              |              |         |    |
|    | with RB      |              |              |         |    |
|    | location     |              |              |         |    |
|    | hopping      |              |              |         |    |
|    | enabled.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | UE transmits | \--\>        | NR RRC:      | \-      | \- |
|    | an           |              | *RRC         |         |    |
|    | *RRC         |              | Reconfigurat |         |    |
|    | Reconfigurat |              | ionComplete* |         |    |
|    | ionComplete* |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | Check: Does  | \--\>        | SRS          | 1       | P  |
|    | the UE       |              |              |         |    |
|    | transmit SRS |              |              |         |    |
|    | on the last  |              |              |         |    |
|    | symbol every |              |              |         |    |
|    | 2 slot, and  |              |              |         |    |
|    | SRS          |              |              |         |    |
|    | bandwidth of |              |              |         |    |
|    | each         |              |              |         |    |
|    | transmission |              |              |         |    |
|    | is 2RB, and  |              |              |         |    |
|    | the          |              |              |         |    |
|    | frequency    |              |              |         |    |
|    | location of  |              |              |         |    |
|    | each SRS     |              |              |         |    |
|    | transmission |              |              |         |    |
|    | complies     |              |              |         |    |
|    | with the     |              |              |         |    |
|    | configured   |              |              |         |    |
|    | hopping      |              |              |         |    |
|    | pattern?     |              |              |         |    |
|    |              |              |              |         |    |
|    | NOTE: the    |              |              |         |    |
|    | verdict is   |              |              |         |    |
|    | assigned     |              |              |         |    |
|    | when two     |              |              |         |    |
|    | full         |              |              |         |    |
|    | periodicity  |              |              |         |    |
|    | of SRS       |              |              |         |    |
|    | t            |              |              |         |    |
|    | ransmissions |              |              |         |    |
|    | are          |              |              |         |    |
|    | observed,    |              |              |         |    |
|    | i.e. 6 SRS   |              |              |         |    |
|    | transmission |              |              |         |    |
|    | if           |              |              |         |    |
|    | enableStartR |              |              |         |    |
|    | BHopping-r17 |              |              |         |    |
|    | is 'Not      |              |              |         |    |
|    | Present', or |              |              |         |    |
|    | 12 SRS       |              |              |         |    |
|    | t            |              |              |         |    |
|    | ransmissions |              |              |         |    |
|    | if           |              |              |         |    |
|    | enableStartR |              |              |         |    |
|    | BHopping-r17 |              |              |         |    |
|    | is 'Enable'. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.5.12.1.3.3 Specific message contents {#specific-message-contents-40 .H6}

Table 8.1.5.12.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.5.12.1.3.2-1)

  Derivation path: TS 38.508-1 \[4\] table 4.6.1-13                                              
  --------------------------------------------------- ----------------- ------------------------ -----------
  Information Element                                 Value/Remark      Comment                  Condition
                                                                                                 
  RRCReconfiguration ::= SEQUENCE {                                                              
  criticalExtensions ::= CHOICE {                                                                
  rrcReconfiguration ::= SEQUENCE {                                                              
  nonCriticalExtension::= SEQUENCE {                                                             
  masterCellGroup::= SEQUENCE {                       CellGroupConfig   Table 8.1.5.12.1.3.3-2   
  }                                                                                              
  }                                                                                              
  }                                                                                              
  }                                                                                              
  }                                                                                              

Table 8.1.5.12.1.3.3-2: *CellGroupConfig* (Table 8.1.5.12.1.3.3-1)

  ---------------------------------------------------- ------------------- ------------------------ ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19                                                
  **Information Element**                              **Value/remark**    **Comment**              **Condition**
  CellGroupConfig ::= SEQUENCE {                                                                    
  mac-CellGroupConfig                                  Not present                                  
  physicalCellGroupConfig                              Not present                                  
  spCellConfig SEQUENCE {                                                                           
  rlf-TimersAndConstants                               Not present                                  
  spCellConfigDedicated                                ServingCellConfig   Table 8.1.5.12.1.3.3-3   
  }                                                                                                 
  }                                                                                                 
  ---------------------------------------------------- ------------------- ------------------------ ---------------

Table 8.1.5.12.1.3.3-3: *ServingCellConfig* (Table 8.1.5.12.1.3.3-2:
ServingCellConfig)

  ----------------------------------------------------- --------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-167                                                  
  Information Element                                   Value/remark          Comment                  Condition
  ServingCellConfig ::= SEQUENCE {                                                                     
  uplinkConfig SEQUENCE {                                                                              
  initialUplinkBWP                                      BWP-UplinkDedicated   Table 8.1.5.12.1.3.3-4   
  uplinkBWP-ToReleaseList                               Not present                                    
  uplinkBWP-ToAddModList                                Not present                                    
  firstActiveUplinkBWP-Id                               BWP-Id                                         
  pusch-ServingCellConfig                               Not present                                    
  carrierSwitching                                      Not present                                    
  }                                                                                                    
  }                                                                                                    
  ----------------------------------------------------- --------------------- ------------------------ -----------

Table 8.1.5.12.1.3.3-4: *BWP-UplinkDedicated* (Table 8.1.5.12.1.3.3-3)

  Derivation Path: TS 38.508-1 \[4\]**,** Table 4.6.3-15                                               
  -------------------------------------------------------- ------------------ ------------------------ ---------------
  **Information Element**                                  **Value/remark**   **Comment**              **Condition**
  BWP-UplinkDedicated ::= SEQUENCE {                                                                   
  pucch-Config                                             Not present                                 
  pusch-Config                                             Not present                                 
  srs-Config                                               SRS-Config         Table 8.1.5.12.1.3.3-5   
  }                                                                                                    

Table 8.1.5.12.1.3.3-5: *SRS-Config* (Table 8.1.5.12.1.3.3-4)

  Derivation path: TS 38.508-1 \[4\] table 4.6.3-182                                                                               
  ---------------------------------------------------------------------------------------------- ----------------------- --------- -----------------------------------------------
  Information Element                                                                            Value/Remark            Comment   Condition
  SRS-Config ::= SEQUENCE {                                                                                                        
  srs-ResourceSetToAddModList SEQUENCE (SIZE(0..maxNrofSRS-ResourceSets)) OF SRS-ResourceSet {   1 entry                           
  SRS-ResourceSet\[1\] SEQUENCE {                                                                                        entry 1   
  resourceType CHOICE {                                                                                                            
  periodic SEQUENCE {                                                                                                              
  associatedCSI-RS                                                                               NZP-CSI-RS-ResourceId             
  }                                                                                                                                
  }                                                                                                                                
  }                                                                                                                                
  }                                                                                                                                
  srs-ResourceToAddModList SEQUENCE (SIZE(1..maxNrofSRS-Resources)) OF SRS-Resource {            1 entry                           
  SRS-Resource\[1\] SEQUENCE {                                                                                           entry 1   
  freqHopping SEQUENCE {                                                                                                           
  c-SRS                                                                                          2                                 
  b-SRS                                                                                          1                                 
  b-hop                                                                                          0                                 
  }                                                                                                                                
  resourceType CHOICE {                                                                                                            
  periodic SEQUENCE {                                                                                                              
  periodicityAndOffset-p CHOICE {                                                                                                  
  sl2                                                                                            0                                 
  }                                                                                                                                
  }                                                                                                                                
  }                                                                                                                                
  partialFreqSounding-r17 SEQUENCE {                                                                                               
  startRBIndexFScaling-r17 CHOICE {                                                                                                
  startRBIndexAndFreqScalingFactor2-r17                                                          1                                 
  }                                                                                                                                
  enableStartRBHopping-r17                                                                       Not present                       
                                                                                                 Enable                            pc\_srs\_startRB\_locationHoppingPartial\_r17
  }                                                                                                                                
  }                                                                                                                                
  }                                                                                                                                
  }                                                                                                                                

#### 8.1.5.13 Small Data Transmission

##### 8.1.5.13.1 RRC SDT/CG based SDT/Success

##### 8.1.5.13.1.1 Test Purpose (TP) {#test-purpose-tp-41 .H6}

##### (1) {#section-81 .H6}

**with** { UE in NR RRC\_INACTIVE state and SDT-CG-Config-r17 is
configured }

**ensure that** {

**when** { UE has small data to transmit and the data volume of the
pending UL data across all RBs configured for SDT is less than or equal
to sdt-DataVolumeThreshold and RSRP is above the configured
sdt-RSRP-Threshold and at least one SSB configured for CG-SDT with
SS-RSRP above cg-SDT-RSRP-ThresholdSSB }

**then** { UE shall initiate CG based SDT procedure and starts RRC
Resume procedure and UE is successfully able to send and receive SDT
data}

}

##### (2) {#section-82 .H6}

**with** { UE in NR RRC\_INACTIVE state and SDT-CG-Config-r17 is
configured }

**ensure that** {

**when** { UE has small data to transmit and the data volume of the
pending UL data across all RBs configured for SDT is greater than
sdt-DataVolumeThreshold }

**then** { UE shall not initiate CG based SDT procedure and starts
normal RRC Resume procedure }

##### (3) {#section-83 .H6}

**with** { UE in NR RRC\_INACTIVE state and SDT-CG-Config-r17 is
configured }

**ensure that** {

**when** { UE has small data to transmit and the data volume of the
pending UL data across all RBs configured for SDT is less than or equal
to sdt-DataVolumeThreshold and RSRP is above the configured
sdt-RSRP-Threshold and none of SSB configured for CG-SDT with SS-RSRP
above cg-SDT-RSRP-ThresholdSSB are available }

**then** { UE shall not initiate CG based SDT procedure and starts
normal RRC Resume procedure }

##### 8.1.5.13.1.2 Conformance requirements {#conformance-requirements-41 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.1.1, 5.3.8.3, 5.3.13.1, 5.3.13.1b,
5.3.13.2 and 5.3.13.3. Unless otherwise stated these are Rel-17
requirements.

\[TS 38.331 clause 5.3.1.1\]

Upon initiating the resume procedure for SDT, AS security (both
ciphering and integrity protection) is re-activated for SRB2 (if
configured for SDT) and for SRB1. In addition, AS security is also
re-activated (if security is configured) for all the DRBs configured for
SDT. Further, the PDCP entities of SRB1 and PDCP entities of the radio
bearers configured for SDT are re-established and resumed whilst the UE
remains in RRC\_INACTIVE state. Transmission and reception of data
and/or signalling messages over radio bearers configured for SDT can
happen whilst the UE is in RRC\_INACTIVE state and SDT procedure is
ongoing.

In response to a request to resume the RRC connection or in response to
a resume procedure initiated for SDT, the network may resume the
suspended RRC connection and send UE to RRC\_CONNECTED, or reject the
request to resume and send UE to RRC\_INACTIVE (with a wait timer), or
directly re-suspend the RRC connection and send UE to RRC\_INACTIVE, or
directly release the RRC connection and send UE to RRC\_IDLE, or
instruct the UE to initiate NAS level recovery (in this case the network
sends an RRC setup message).

\[TS 38.331 clause 5.3.8.3\]

1\> if the *RRCRelease* includes *suspendConfig*:

2\> reset MAC and release the default MAC Cell Group configuration, if
any;

2\> apply the received *suspendConfig except the received
nextHopChainingCount*;

2\> if the *sdt-Config* is configured:

3\> for each of the DRB in the *sdt-DRB-List*:

4\> consider the DRB to be configured for SDT;

3\> if *sdt-SRB2-Indication* is configured:

4\> consider the SRB2 to be configured for SDT;

3\> for each RLC bearer that is not suspended:

4\> re-establish the RLC entity as specified in TS 38.322 \[4\];

3\> for SRB2 (if it is resumed) and for SRB1:

4\> trigger the PDCP entity to perform SDU discard as specified in TS
38.323 \[5\];

3\> if *sdt-MAC-PHY-CG-Config* is configured:

4\> configure the PCell with the configured grant resources for SDT and
instruct the MAC entity to start the *cg-SDT-TimeAlignmentTimer*;

...

2\> re-establish RLC entities for SRB1;

2\> if the *RRCRelease* message with *suspendConfig* was received in
response to an *RRCResumeRequest* or an *RRCResumeRequest1*:

3\> stop the timer T319 if running;

3\> in the stored UE Inactive AS context:

4\> replace the K~gNB~ and K~RRCint~ keys with the current K~gNB~ and
K~RRCint~ keys;

4\> replace the *nextHopChainingCount* with the value of
*nextHopChainingCount* received in the *RRCRelease message;*

4\> replace the *cellIdentity* with the *cellIdentity* of the cell the
UE has received the *RRCRelease* message;

4\> if the *suspendConfig* contains the *sl-UEIdentityRemote* (i.e. the
UE is a L2 U2N Remote UE):

...

4\> else:

5\> replace the C-RNTI with the C-RNTI used in the cell (see TS 38.321
\[3\]) the UE has received the *RRCRelease* message;

5\> replace the physical cell identity with the physical cell identity
of the cell the UE has received the *RRCRelease* message;

3\> replace the *nextHopChainingCount* with the value associated with
the current K~gNB~;

3\> stop the timer T319a if running and consider SDT procedure is not
ongoing;

2\> else:

3\> store in the UE Inactive AS Context the *nextHopChainingCount*
received in the *RRCRelease message,* the current K~gNB~ and K~RRCint~
keys, the ROHC state, the EHC context(s), the UDC state, the stored QoS
flow to DRB mapping rules, the application layer measurement
configuration, the C-RNTI used in the source PCell, the *cellIdentity*
and the physical cell identity of the source PCell, the
*spCellConfigCommon* within *ReconfigurationWithSync* of the NR PSCell
(if configured) and all other parameters configured except for:

\- parameters within *ReconfigurationWithSync* of the PCell;

\- parameters within *ReconfigurationWithSync* of the NR PSCell, if
configured;

\- parameters within *MobilityControlInfoSCG* of the E-UTRA PSCell, if
configured;

\- *servingCellConfigCommonSIB*;

..

3\> store any previously or subsequently received application layer
measurement reports for which no segment, or full message, has been
submitted to lower layers for transmission;

NOTE 2: NR sidelink communication/discovery related configurations and
logged measurement configuration are not stored as UE Inactive AS
Context, when UE enters RRC\_INACTIVE.

2\> suspend all SRB(s) and DRB(s) and multicast MRB(s), except SRB0 and
broadcast MRBs;

2\> indicate PDCP suspend to lower layers of all DRBs and multicast
MRBs;

2\> release the SRAP entity, if configured;

...

2\> indicate the suspension of the RRC connection to upper layers;

2\> enter RRC\_INACTIVE and perform cell selection as specified in TS
38.304 \[20\];

...

\[TS 38.331 clause 5.3.13.1\]

The purpose of this procedure is to resume a suspended RRC connection,
including resuming SRB(s), DRB(s) and multicast MRB(s) or perform an RNA
update. This procedure is also used to initiate SDT in RRC\_INACTIVE.

\[TS 38.331 clause 5.3.13.1b\]

A UE in RRC\_INACTIVE initiates the resume procedure for SDT when all of
the following conditions are fulfilled:

1\> the upper layers request resumption of RRC connection; and

1\> *SIB1* includes *sdt-ConfigCommon*; and

1\> *sdt-Config* is configured; and

1\> all the pending data in UL is mapped to the radio bearers configured
for SDT; and

1\> lower layers indicate that conditions for initiating SDT as
specified in TS 38.321 \[3\] are fulfilled.

NOTE: How the UE determines that all pending data in UL is mapped to
radio bearers configured for SDT is left to UE implementation.

\[TS 38.331 clause 5.3.13.2\]

The UE initiates the procedure when upper layers or AS (when responding
to RAN paging, upon triggering RNA updates while the UE is in
RRC\_INACTIVE, for NR sidelink communication/discovery/V2X sidelink
communication as specified in clause 5.3.13.1a) requests the resume of a
suspended RRC connection or requests the resume for initiating SDT as
specified in clause 5.3.13.1b.

...

1\> if *sdt-MAC-PHY-CG-Config* is configured:

2\> if the resume procedure is initiated in a cell that is different to
the PCell in which the UE received the stored *sdt-MAC-PHY-CG-Config*:

3\> release the stored *sdt-MAC-PHY-CG-Config*;

3\> instruct the MAC entity to stop the *cg-SDT-TimeAlignmentTimer*, if
it is running;

1\> if conditions for initiating SDT in accordance with 5.3.13.1b are
fulfilled:

2\> consider the resume procedure is initiated for SDT;

2\> start timer T319a when the lower layers first transmit the CCCH
message;

2\> consider SDT procedure is ongoing;

1\> else:

2\> start timer T319;

2\> instruct the MAC entity to stop the *cg*-*SDT*-*TimeAlignmentTimer*,
if it is running;

...

\[TS 38.331 clause 5.3.13.3\]

1\> if the resume procedure is initiated for SDT:

2\> for each radio bearer that is configured for SDT and for SRB1:

3\> restore the *RLC-BearerConfig* associated with the RLC bearers of
*masterCellGroup* and *pdcp-Config* from the UE Inactive AS context;

...

3\> re-establish PDCP entity for the radio bearer that is configured for
SDT without triggering PDCP status report;

2\> resume all the radio bearers that are configured for SDT;

1.  submit the selected message *RRCResumeRequest* or
    *RRCResumeRequest1* for transmission to lower layers.

##### 8.1.5.13.1.3 Test description {#test-description-41 .H6}

##### 8.1.5.13.1.3.1 Pre-test conditions {#pre-test-conditions-41 .H6}

##### System Simulator: {#system-simulator-33 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell.

##### UE: {#ue-30 .H6}

\- None.

##### Preamble: {#preamble-29 .H6}

\- The UE is in 5GS state 3N-A according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3 and Test Loop Function (On) with UE test loop mode
B is established.

##### 8.1.5.13.1.3.2 Test procedure sequence {#test-procedure-sequence-41 .H6}

Table 8.1.5.13.1.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \-        | \-        | \-      | \- |
|           | sends one |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | to the    |           |           |         |    |
|           | UE. The   |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | is less   |           |           |         |    |
|           | than      |           |           |         |    |
|           | sdt-Da    |           |           |         |    |
|           | taVolumeT |           |           |         |    |
|           | hreshold. |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | *         |           |           |         |    |
|           | SDT-CG-Co |           |           |         |    |
|           | nfig-r17* |           |           |         |    |
|           | in        |           |           |         |    |
|           | s*uspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | Ch        | \--\>     | NR RRC:   | 1       | P  |
|           | eck: Does |           | *RRCResum |         |    |
|           | the UE    |           | eRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | and the   |           |           |         |    |
|           | loop      |           |           |         |    |
|           | backed IP |           |           |         |    |
|           | Packet    |           |           |         |    |
|           | received  |           |           |         |    |
|           | in step 1 |           |           |         |    |
|           | in a CG   |           |           |         |    |
|           | PUSCH     |           |           |         |    |
|           | occasion? |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The SS    | \-        | \-        | \-      | \- |
|           | sends one |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | to the    |           |           |         |    |
|           | UE. The   |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | is less   |           |           |         |    |
|           | than      |           |           |         |    |
|           | sdt-Da    |           |           |         |    |
|           | taVolumeT |           |           |         |    |
|           | hreshold. |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | Check:    | \-        | \-        | 1       | P  |
|           | Does the  |           |           |         |    |
|           | UE loop   |           |           |         |    |
|           | back the  |           |           |         |    |
|           | IP packet |           |           |         |    |
|           | received  |           |           |         |    |
|           | in step 4 |           |           |         |    |
|           | in a CG   |           |           |         |    |
|           | PUSCH     |           |           |         |    |
|           | occasion? |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7-14      | The test  | \-        | \-        | \-      | \- |
|           | steps 1   |           |           |         |    |
|           | to 8 of   |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\]     |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.5.4.2-3 |           |           |         |    |
|           | are       |           |           |         |    |
|           | performed |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 15        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *DLIn     |         |    |
|           | an OPEN   |           | formation |         |    |
|           | UE TEST   |           | Transfer* |         |    |
|           | LOOP      |           |           |         |    |
|           | message.  |           | TC: OPEN  |         |    |
|           |           |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 16        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *ULIn     |         |    |
|           | an OPEN   |           | formation |         |    |
|           | UE TEST   |           | Transfer* |         |    |
|           | LOOP      |           |           |         |    |
|           | COMPLETE  |           | TC: OPEN  |         |    |
|           | message.  |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
|           |           |           | COMPLETE  |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 17        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *DLIn     |         |    |
|           | a CLOSE   |           | formation |         |    |
|           | UE TEST   |           | Transfer* |         |    |
|           | LOOP      |           |           |         |    |
|           | message.  |           | TC: CLOSE |         |    |
|           |           |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 18        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *ULIn     |         |    |
|           | a CLOSE   |           | formation |         |    |
|           | UE TEST   |           | Transfer* |         |    |
|           | LOOP      |           |           |         |    |
|           | COMPLETE  |           | TC: CLOSE |         |    |
|           | message.  |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
|           |           |           | COMPLETE  |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 19        | The SS    | \-        | \-        | \-      | \- |
|           | sends one |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | to the    |           |           |         |    |
|           | UE. The   |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | is        |           |           |         |    |
|           | greater   |           |           |         |    |
|           | than      |           |           |         |    |
|           | sdt-Da    |           |           |         |    |
|           | taVolumeT |           |           |         |    |
|           | hreshold. |           |           |         |    |
|           | (Note 2)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 20        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | *         |           |           |         |    |
|           | SDT-CG-Co |           |           |         |    |
|           | nfig-r17* |           |           |         |    |
|           | in        |           |           |         |    |
|           | s*uspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 21        | Ch        | \--\>     | NR RRC:   | 2       | P  |
|           | eck: Does |           | *RRCResum |         |    |
|           | the UE    |           | eRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | based on  |           |           |         |    |
|           | random    |           |           |         |    |
|           | access?   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 22        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCResume* |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 23        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 24        | Check:    | \-        | \-        | 2       | P  |
|           | Does the  |           |           |         |    |
|           | UE loop   |           |           |         |    |
|           | back the  |           |           |         |    |
|           | IP packet |           |           |         |    |
|           | received  |           |           |         |    |
|           | in step   |           |           |         |    |
|           | 19?       |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 25        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *DLIn     |         |    |
|           | an OPEN   |           | formation |         |    |
|           | UE TEST   |           | Transfer* |         |    |
|           | LOOP      |           |           |         |    |
|           | message.  |           | TC: OPEN  |         |    |
|           |           |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 26        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *ULIn     |         |    |
|           | an OPEN   |           | formation |         |    |
|           | UE TEST   |           | Transfer* |         |    |
|           | LOOP      |           |           |         |    |
|           | COMPLETE  |           | TC: OPEN  |         |    |
|           | message.  |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
|           |           |           | COMPLETE  |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 27        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *DLIn     |         |    |
|           | a CLOSE   |           | formation |         |    |
|           | UE TEST   |           | Transfer* |         |    |
|           | LOOP      |           |           |         |    |
|           | message.  |           | TC: CLOSE |         |    |
|           |           |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 28        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *ULIn     |         |    |
|           | a CLOSE   |           | formation |         |    |
|           | UE TEST   |           | Transfer* |         |    |
|           | LOOP      |           |           |         |    |
|           | COMPLETE  |           | TC: CLOSE |         |    |
|           | message.  |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
|           |           |           | COMPLETE  |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 29        | The SS    | \-        | \-        | \-      | \- |
|           | sends one |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | to the    |           |           |         |    |
|           | UE. The   |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | is less   |           |           |         |    |
|           | than      |           |           |         |    |
|           | sdt-Da    |           |           |         |    |
|           | taVolumeT |           |           |         |    |
|           | hreshold. |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 30        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | including |           |           |         |    |
|           | *         |           |           |         |    |
|           | SDT-CG-Co |           |           |         |    |
|           | nfig-r17* |           |           |         |    |
|           | in        |           |           |         |    |
|           | s*uspen   |           |           |         |    |
|           | dConfig*. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 31        | Ch        | \--\>     | NR RRC:   | 3       | P  |
|           | eck: Does |           | *RRCResum |         |    |
|           | the UE    |           | eRequest* |         |    |
|           | transmit  |           |           |         |    |
|           | an        |           |           |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | based on  |           |           |         |    |
|           | random    |           |           |         |    |
|           | access?   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 32        | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *R        |         |    |
|           | an        |           | RCResume* |         |    |
|           | *R        |           |           |         |    |
|           | RCResume* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 33        | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *         |           | Complete* |         |    |
|           | RRCResume |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 34        | Check:    | \-        | \-        | 3       | P  |
|           | Does the  |           |           |         |    |
|           | UE loop   |           |           |         |    |
|           | back the  |           |           |         |    |
|           | IP packet |           |           |         |    |
|           | received  |           |           |         |    |
|           | in step   |           |           |         |    |
|           | 27?       |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| RLC PDU   |           |           |           |         |    |
| for IP    |           |           |           |         |    |
| packet is |           |           |           |         |    |
| 97 bytes  |           |           |           |         |    |
| (RLC SDU  |           |           |           |         |    |
| is 94     |           |           |           |         |    |
| bytes for |           |           |           |         |    |
| 3 bytes   |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| header    |           |           |           |         |    |
| and 95    |           |           |           |         |    |
| bytes for |           |           |           |         |    |
| 2 bytes   |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| header)   |           |           |           |         |    |
| and       |           |           |           |         |    |
| sdt-D     |           |           |           |         |    |
| ataVolume |           |           |           |         |    |
| Threshold |           |           |           |         |    |
| is 100    |           |           |           |         |    |
| bytes.    |           |           |           |         |    |
| Therefore |           |           |           |         |    |
| the size  |           |           |           |         |    |
| of RLC    |           |           |           |         |    |
| SDU is    |           |           |           |         |    |
| less than |           |           |           |         |    |
| the       |           |           |           |         |    |
| sdt-Da    |           |           |           |         |    |
| taVolumeT |           |           |           |         |    |
| hreshold. |           |           |           |         |    |
|           |           |           |           |         |    |
| Note 2:   |           |           |           |         |    |
| RLC PDU   |           |           |           |         |    |
| for IP    |           |           |           |         |    |
| packet is |           |           |           |         |    |
| 104 bytes |           |           |           |         |    |
| (RLC SDU  |           |           |           |         |    |
| is 101    |           |           |           |         |    |
| bytes for |           |           |           |         |    |
| 3 bytes   |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| header    |           |           |           |         |    |
| and 102   |           |           |           |         |    |
| bytes for |           |           |           |         |    |
| 2 bytes   |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| header)   |           |           |           |         |    |
| and       |           |           |           |         |    |
| sdt-D     |           |           |           |         |    |
| ataVolume |           |           |           |         |    |
| Threshold |           |           |           |         |    |
| is 100    |           |           |           |         |    |
| bytes.    |           |           |           |         |    |
| Therefore |           |           |           |         |    |
| the size  |           |           |           |         |    |
| of RLC    |           |           |           |         |    |
| SDU is    |           |           |           |         |    |
| greater   |           |           |           |         |    |
| than the  |           |           |           |         |    |
| sdt-Da    |           |           |           |         |    |
| taVolumeT |           |           |           |         |    |
| hreshold. |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.5.13.1.3.3 Specific message contents {#specific-message-contents-41 .H6}

Table 8.1.5.13.1.3.3-1: CLOSE UE TEST LOOP (Preamble and all steps,
Table 8.1.5.13.1.3.2-1)

  Derivation path: 36.508-1 \[7\] table 4.7A-3 condition UE test loop mode B                                
  ---------------------------------------------------------------------------- ---------------- ----------- -----------
  Information Element                                                          Value/Remark     Comment     Condition
  UE test loop mode B LB setup                                                                              
  IP PDU delay                                                                 \'0000 0010\'B   2 seconds   

Table 8.1.5.13.1.3.3-2: *SIB1* (Preamble and all steps, Table
8.1.5.13.1.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28 with condition SDT                                                     
  ---------------------------------------------------------------------- -------------- ---------------------------------- -----------
  Information Element                                                    Value/Remark   Comment                            Condition
  SIB1 ::= SEQUENCE {                                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                          
  sdt-ConfigCommon-r17 SEQUENCE {                                                                                          
  sdt-RSRP-Threshold-r17                                                 60             (IE value -- 156) dBm = - 96 dBm   
  sdt-LogicalChannelSR-DelayTimer-r17                                    Not present                                       
  sdt-DataVolumeThreshold-r17                                            byte100                                           
  t319a-r17                                                              ms4000                                            
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        

Table 8.1.5.13.1.3.3-3: *RRCRelease* (steps 2, 20 and 30, Table
8.1.5.13.1.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.1-16  |                 |                 |           |
| with condition  |                 |                 |           |
| NR              |                 |                 |           |
| \_RRC\_INACTIVE |                 |                 |           |
| and SDT         |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/Remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| RRCRelease ::=  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rrc-Transa      | RRC-Transa      |                 |           |
| ctionIdentifier | ctionIdentifier |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rrcRelease      |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| suspendConfig   |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sdt-Config-r17  |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| s               | 1 entry         |                 |           |
| dt-DRB-List-r17 |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (0..maxDRB)) OF |                 |                 |           |
| DRB-Identity {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| DR              | DRB-Identity    | Entry 1         |           |
| B-Identity\[1\] | using condition |                 |           |
|                 | DRBj            | j is the ID of  |           |
|                 |                 | the DRB         |           |
|                 |                 | established     |           |
|                 |                 | during the      |           |
|                 |                 | preamble which  |           |
|                 |                 | is allocated    |           |
|                 |                 | according to    |           |
|                 |                 | internal TTCN   |           |
|                 |                 | mapping         |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sdt-MAC-PH      |                 |                 |           |
| Y-CG-Config-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| c               |                 |                 |           |
| g-SDT-ConfigIni |                 |                 |           |
| tialBWP-NUL-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| p               |                 |                 |           |
| usch-Config-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup           | PUSCH-Config    | TS              |           |
|                 |                 | 38.508-1\[4\]   |           |
|                 |                 | Table           |           |
|                 |                 | 4.6.3-118:      |           |
|                 |                 | *PUSCH-Config*  |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| configu         |                 |                 |           |
| redGrantConfigT |                 |                 |           |
| oAddModList-r17 |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..maxN        |                 |                 |           |
| rofConfiguredGr |                 |                 |           |
| antConfig-r16)) |                 |                 |           |
| OF              |                 |                 |           |
| Config          |                 |                 |           |
| uredGrantConfig |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ConfiguredG     | Config          | Table           |           |
| rantConfig\[1\] | uredGrantConfig | 8               |           |
|                 |                 | .1.5.13.1.3.3-4 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| c               | Not present     |                 |           |
| g-SDT-ConfigIni |                 |                 |           |
| tialBWP-SUL-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cg-SDT-ConfigIn |                 |                 |           |
| itialBWP-DL-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| p               | Not present     |                 |           |
| dcch-Config-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
|                 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| p               |                 |                 |           |
| dsch-Config-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup           | PDSCH-Config    | TS              |           |
|                 |                 | 38.508-1\[4\]   |           |
|                 |                 | Table           |           |
|                 |                 | 4.6.3-100:      |           |
|                 |                 | *PDSCH-Config*  |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cg-SDT-TimeAli  | ms5120          | TimeAlignm      |           |
| gnmentTimer-r17 |                 | entTimer(5.12s) |           |
|                 |                 | is larger than  |           |
|                 |                 | IP PDU delay    |           |
|                 |                 | timer(2s) for   |           |
|                 |                 | Loop mode B.    |           |
+-----------------+-----------------+-----------------+-----------+
| cg-SDT-RSRP-T   | 60              | (IE value --    | Step 2,20 |
| hresholdSSB-r17 |                 | 156) dBm = - 96 |           |
|                 |                 | dBm             |           |
+-----------------+-----------------+-----------------+-----------+
|                 | 76              | (IE value --    | Step 30   |
|                 |                 | 156) dBm = - 80 |           |
|                 |                 | dBm             |           |
+-----------------+-----------------+-----------------+-----------+
|                 |                 |                 |           |
| cg              |                 |                 |           |
| -SDT-TA-Validit |                 |                 |           |
| ationConfig-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| c               | dB10            |                 |           |
| g-SDT-RSRP-Chan |                 |                 |           |
| geThreshold-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cg-             | Not present     |                 |           |
| SDT-CS-RNTI-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.13.1.3.3-4: *ConfiguredGrantConfig* (Table 8.1.5.13.1.3.3-3)

+----------------+----------------+----------------+----------------+
| Derivation     |                |                |                |
| Path: TS       |                |                |                |
| 38.508-1 \[4\] |                |                |                |
| Table          |                |                |                |
| 4.6.3-26,      |                |                |                |
| condition      |                |                |                |
| CG\            |                |                |                |
| _Config\_Type1 |                |                |                |
+================+================+================+================+
| Information    | Value/Remark   | Comment        | Condition      |
| Element        |                |                |                |
+----------------+----------------+----------------+----------------+
| Configu        |                |                |                |
| redGrantConfig |                |                |                |
| ::= SEQUENCE { |                |                |                |
+----------------+----------------+----------------+----------------+
| rrc-Configu    |                |                |                |
| redUplinkGrant |                |                |                |
| SEQUENCE{      |                |                |                |
+----------------+----------------+----------------+----------------+
| frequencyDo    | BIT STRING     | Equals to      | SCS15 AND      |
| mainAllocation | (SIZE(18)      |                | CBW5, SCS30    |
|                |                | NBWPsize \*    | AND CBW10      |
|                |                | (NBWPsize --   |                |
|                |                | LRB + 1) +     |                |
|                |                | (NBWPsize -1 - |                |
|                |                | RBstart),      |                |
|                |                | where          |                |
|                |                |                |                |
|                |                | LRB = 24 PRB,  |                |
|                |                |                |                |
|                |                | RBstart = 0,   |                |
|                |                |                |                |
|                |                | NBWPsize is    |                |
|                |                | the size       |                |
|                |                | \[PRBs\] of    |                |
|                |                | the carrier    |                |
|                |                | bandwidth and  |                |
|                |                | contained in   |                |
|                |                | TS.38.508-1    |                |
|                |                | \[4\] clause   |                |
|                |                | 6.2.3.1        |                |
+----------------+----------------+----------------+----------------+
|                | BIT STRING     | Equal to       |                |
|                | (SIZE(18)      |                |                |
|                |                | NBWPsize \*    |                |
|                |                | (LRB-1) +      |                |
|                |                | RBstart),      |                |
|                |                | where          |                |
|                |                |                |                |
|                |                | LRB = 24 PRB,  |                |
|                |                |                |                |
|                |                | RBstart = 0,   |                |
|                |                |                |                |
|                |                | NBWPsize is    |                |
|                |                | the size       |                |
|                |                | \[PRBs\] of    |                |
|                |                | the carrier    |                |
|                |                | bandwidth and  |                |
|                |                | contained in   |                |
|                |                | TS.38.508-1    |                |
|                |                | \[4\] clause   |                |
|                |                | 6.2.3.1        |                |
+----------------+----------------+----------------+----------------+
| dmrs-Seq       | 0              |                |                |
| Initialization |                |                |                |
+----------------+----------------+----------------+----------------+
| mcsAndTBS      | 0              |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| Note:          |                |                |                |
| Configured UL  |                |                |                |
| grant for      |                |                |                |
| CG-SDT is 888  |                |                |                |
| bits (L~RBs~ & |                |                |                |
| I~MCS~ as per  |                |                |                |
| 38.523-3\[3\]  |                |                |                |
| annex B) is    |                |                |                |
| chosen to      |                |                |                |
| enable UE to   |                |                |                |
| transmit       |                |                |                |
| RR             |                |                |                |
| CResumeRequest |                |                |                |
| and Loop       |                |                |                |
| backed RLC PDU |                |                |                |
| in a MAC PDU ( |                |                |                |
| 97 bytes for   |                |                |                |
| Loop backed    |                |                |                |
| RLC PDU + 2    |                |                |                |
| bytes for MAC  |                |                |                |
| Sub Header + 6 |                |                |                |
| bytes for      |                |                |                |
| RR             |                |                |                |
| CResumeRequest |                |                |                |
| message + 2    |                |                |                |
| bytes for MAC  |                |                |                |
| Sub Header + 4 |                |                |                |
| bytes for BSR  |                |                |                |
| and Padding )  |                |                |                |
+----------------+----------------+----------------+----------------+

Table 8.1.5.13.1.3.3-5: *RRCResumeRequest* (steps 3, 21 and 31, Table
8.1.5.13.1.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19                            
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeRequest ::= SEQUENCE {                                               
  rrcResumeRequest SEQUENCE {                                                   
  resumeCause                                          mo-data                  
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

##### 8.1.5.13.2 RRC SDT / CG based SDT ongoing / Data and Signalling on non-SDT Radio Bearers

##### 8.1.5.13.2.1 Test Purpose (TP) {#test-purpose-tp-42 .H6}

##### (1) {#section-84 .H6}

**with** { UE in NR RRC\_INACTIVE state and CG based SDT procedure is
ongoing }

**ensure that** {

**when** { UE has data and signalling to transmit on non-SDT Radio
Bearers }

**then** { UE shall send UEAssistanceInformation message with
nonSDT-DataIndication set }

}

##### 8.1.5.13.2.2 Conformance requirements {#conformance-requirements-42 .H6}

References: The conformance requirements covered in the present TC are
specified in: 3GPP TS 38.331, clause 5.3.1.1, 5.3.8.3, 5.3.13.1,
5.3.13.1b, 5.3.13.2, 5.3.13.3, 5.7.4.2, 5.7.4.3. Unless otherwise
stated, these are Rel-17 requirements.

\[TS 38.331, clause 5.3.1.1\]

The suspension of the RRC connection is initiated by the network. When
the RRC connection is suspended, the UE stores the UE Inactive AS
context and any configuration received from the network, and transits to
RRC\_INACTIVE state. The RRC message to suspend the RRC connection is
integrity protected and ciphered.

The resumption of a suspended RRC connection is initiated by upper
layers when the UE needs to transit from RRC\_INACTIVE state to
RRC\_CONNECTED state or by RRC layer to perform a RNA update or by RAN
paging from NG-RAN or for SDT. When the RRC connection is resumed,
network configures the UE according to the RRC connection resume
procedure based on the stored UE Inactive AS context and any RRC
configuration received from the network. The RRC connection resume
procedure re-activates AS security and re-establishes SRB(s) and DRB(s)
and/or multicast MRB(s), if configured.

Upon initiating the resume procedure for SDT, AS security (both
ciphering and integrity protection) is re-activated for SRB2 (if
configured for SDT) and for SRB1. In addition, AS security is also
re-activated (if security is configured) for all the DRBs configured for
SDT. Further, the PDCP entities of SRB1 and PDCP entities of the radio
bearers configured for SDT are re-established and resumed whilst the UE
remains in RRC\_INACTIVE state. Transmission and reception of data
and/or signalling messages over radio bearers configured for SDT can
happen whilst the UE is in RRC\_INACTIVE state and SDT procedure is
ongoing.

In response to a request to resume the RRC connection or in response to
a resume procedure initiated for SDT, the network may resume the
suspended RRC connection and send UE to RRC\_CONNECTED, or reject the
request to resume and send UE to RRC\_INACTIVE (with a wait timer), or
directly re-suspend the RRC connection and send UE to RRC\_INACTIVE, or
directly release the RRC connection and send UE to RRC\_IDLE, or
instruct the UE to initiate NAS level recovery (in this case the network
sends an RRC setup message).

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

1\> delay the following actions defined in this clause 60 ms from the
moment the *RRCRelease* message was received or optionally when lower
layers indicate that the receipt of the *RRCRelease* message has been
successfully acknowledged, whichever is earlier;

1\> if the *RRCRelease* includes *suspendConfig*:

2\> reset MAC and release the default MAC Cell Group configuration, if
any;

2\> apply the received *suspendConfig except the received
nextHopChainingCount*;

2\> if the *sdt-Config* is configured:

3\> for each of the DRB in the *sdt-DRB-List*:

4\> consider the DRB to be configured for SDT;

3\> if *sdt-SRB2-Indication* is configured:

4\> consider the SRB2 to be configured for SDT;

3\> for each RLC bearer that is not suspended:

4\> re-establish the RLC entity as specified in TS 38.322 \[4\];

3\> for SRB2 (if it is resumed) and for SRB1:

4\> trigger the PDCP entity to perform SDU discard as specified in TS
38.323 \[5\];

3\> if *sdt-MAC-PHY-CG-Config* is configured:

4\> configure the PCell with the configured grant resources for SDT and
instruct the MAC entity to start the *cg-SDT-TimeAlignmentTimer*;

...

2\> if the *RRCRelease* message with *suspendConfig* was received in
response to an *RRCResumeRequest* or an *RRCResumeRequest1*:

3\> stop the timer T319 if running;

3\> in the stored UE Inactive AS context:

4\> replace the K~gNB~ and K~RRCint~ keys with the current K~gNB~ and
K~RRCint~ keys;

4\> replace the *nextHopChainingCount* with the value of
*nextHopChainingCount* received in the *RRCRelease message;*

4\> replace the *cellIdentity* with the *cellIdentity* of the cell the
UE has received the *RRCRelease* message;

4\> if the *suspendConfig* contains the *sl-UEIdentityRemote* (i.e. the
UE is a L2 U2N Remote UE):

...

4\> else:

5\> replace the C-RNTI with the C-RNTI used in the cell (see TS 38.321
\[3\]) the UE has received the *RRCRelease* message;

5\> replace the physical cell identity with the physical cell identity
of the cell the UE has received the *RRCRelease* message;

3\> replace the *nextHopChainingCount* with the value associated with
the current K~gNB~;

3\> stop the timer T319a if running and consider SDT procedure is not
ongoing;

2\> else:

3\> store in the UE Inactive AS Context the *nextHopChainingCount*
received in the *RRCRelease message,* the current K~gNB~ and K~RRCint~
keys, the ROHC state, the EHC context(s), the UDC state, the stored QoS
flow to DRB mapping rules, the application layer measurement
configuration, the C-RNTI used in the source PCell, the *cellIdentity*
and the physical cell identity of the source PCell, the
*spCellConfigCommon* within *ReconfigurationWithSync* of the NR PSCell
(if configured) and all other parameters configured except for:

\- parameters within *ReconfigurationWithSync* of the PCell;

\- parameters within *ReconfigurationWithSync* of the NR PSCell, if
configured;

\- parameters within *MobilityControlInfoSCG* of the E-UTRA PSCell, if
configured;

\- *servingCellConfigCommonSIB*;

\- ...

NOTE 1c: *suspendConfig* is not stored as part of UE Inactive AS
Context, except for the fields explicitly specified.

3\> store any previously or subsequently received application layer
measurement reports for which no segment, or full message, has been
submitted to lower layers for transmission;

NOTE 2: NR sidelink communication/discovery related configurations and
logged measurement configuration are not stored as UE Inactive AS
Context, when UE enters RRC\_INACTIVE.

2\> suspend all SRB(s) and DRB(s) and multicast MRB(s), except SRB0 and
broadcast MRBs;

2\> indicate PDCP suspend to lower layers of all DRBs and multicast
MRBs;

2\> release the SRAP entity, if configured;

2\> if the *t380* is included:

3\> start timer T380, with the timer value set to *t380*;

2\> if the *RRCRelease* message is including the *waitTime*:

3\> start timer T302 with the value set to the *waitTime*;

3\> inform upper layers that access barring is applicable for all access
categories except categories \'0\' and \'2\';

2\> if T390 is running:

3\> stop timer T390 for all access categories;

3\> perform the actions as specified in 5.3.14.4;

2\> indicate the suspension of the RRC connection to upper layers;

2\> if the UE is capable of L2 U2N Remote UE:

3\> enter RRC\_INACTIVE, and perform either cell selection as specified
in TS 38.304 \[20\], or relay selection as specified in clause 5.8.15.3,
or both;

2\> else:

3\> enter RRC\_INACTIVE and perform cell selection as specified in TS
38.304 \[20\];

1\> else:

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with the release cause \'other\'.

NOTE 3: Whether to release the PC5 unicast link is left to L2 U2N Remote
UE\'s implementation.

NOTE 4: It is left to UE implementation whether to stop T430, if
running, when going to RRC\_INACTIVE.

\[TS 38.331, clause 5.3.13.1\]

The purpose of this procedure is to resume a suspended RRC connection,
including resuming SRB(s), DRB(s) and multicast MRB(s) or perform an RNA
update. This procedure is also used to initiate SDT in RRC\_INACTIVE.

\[TS 38.331, clause 5.3.13.1b\]

A UE in RRC\_INACTIVE initiates the resume procedure for SDT when all of
the following conditions are fulfilled:

1\> the upper layers request resumption of RRC connection; and

1\> *SIB1* includes *sdt-ConfigCommon*; and

1\> *sdt-Config* is configured; and

1\> all the pending data in UL is mapped to the radio bearers configured
for SDT; and

1\> lower layers indicate that conditions for initiating SDT as
specified in TS 38.321 \[3\] are fulfilled.

NOTE: How the UE determines that all pending data in UL is mapped to
radio bearers configured for SDT is left to UE implementation.

\[TS 38.331, clause 5.3.13.2\]

The UE initiates the procedure when upper layers or AS (when responding
to RAN paging, upon triggering RNA updates while the UE is in
RRC\_INACTIVE, for NR sidelink communication/discovery/V2X sidelink
communication as specified in clause 5.3.13.1a) requests the resume of a
suspended RRC connection or requests the resume for initiating SDT as
specified in clause 5.3.13.1b.

The UE shall ensure having valid and up to date essential system
information as specified in clause 5.2.2.2 before initiating this
procedure.

Upon initiation of the procedure, the UE shall:

...

1\> else:

2\> apply the default L1 parameter values as specified in corresponding
physical layer specifications, except for the parameters for which
values are provided in *SIB1*;

2\> apply the default SRB1 configuration as specified in 9.2.1;

2\> apply the default MAC Cell Group configuration as specified in
9.2.2;

1\> else:

2\> apply the CCCH configuration as specified in 9.1.1.2;

2\> apply the *timeAlignmentTimerCommon* included in *SIB1*;

1\> if *sdt-MAC-PHY-CG-Config* is configured:

2\> if the resume procedure is initiated in a cell that is different to
the PCell in which the UE received the stored *sdt-MAC-PHY-CG-Config*:

3\> release the stored *sdt-MAC-PHY-CG-Config*;

3\> instruct the MAC entity to stop the *cg-SDT-TimeAlignmentTimer*, if
it is running;

1\> if conditions for initiating SDT in accordance with 5.3.13.1b are
fulfilled:

2\> consider the resume procedure is initiated for SDT;

2\> start timer T319a when the lower layers first transmit the CCCH
message;

2\> consider SDT procedure is ongoing;

1\> else:

2\> start timer T319;

2\> instruct the MAC entity to stop the *cg*-*SDT*-*TimeAlignmentTimer*,
if it is running;

...

1\> initiate transmission of the *RRCResumeRequest* message or
*RRCResumeRequest1* in accordance with 5.3.13.3.

\[TS 38.331, clause 5.3.13.3\]

The UE shall set the contents of *RRCResumeRequest* or
*RRCResumeRequest1* message as follows:

...

1\> if the resume procedure is initiated for SDT:

2\> for each radio bearer that is configured for SDT and for SRB1:

3\> restore the *RLC-BearerConfig* associated with the RLC bearers of
*masterCellGroup* and *pdcp-Config* from the UE Inactive AS context;

> ...

3\> re-establish PDCP entity for the radio bearer that is configured for
SDT without triggering PDCP status report;

2\> resume all the radio bearers that are configured for SDT;

1\> submit the selected message *RRCResumeRequest* or
*RRCResumeRequest1* for transmission to lower layers.

NOTE 2: Only DRBs with previously configured UP ciphering shall resume
ciphering.

If lower layers indicate an integrity check failure while T319 is
running or SDT procedure is ongoing, perform actions specified in
5.3.13.5.

If the UE is a RedCap UE and the RedCap-specific initial downlink BWP is
not associated with CD-SSB, the UE may continue cell re-selection
related measurements as well as cell re-selection evaluation, otherwise
the UE shall continue cell re-selection related measurements as well as
cell re-selection evaluation. If the conditions for cell re-selection
are fulfilled, the UE shall perform cell re-selection as specified in
5.3.13.6.

\[TS 38.331, clause 5.7.4.2\]

A UE capable of SDT initiates this procedure when data and/or signalling
mapped to radio bearers that are not configured for SDT becomes
available during SDT (i.e. while SDT procedure is ongoing).

Upon initiating the procedure, the UE shall:

1\> if data and/or signalling mapped to radio bearers not configured for
SDT becomes available during SDT (i.e., while SDT procedure is ongoing):

2\> if the UE did not transmit a *UEAssistanceInformation* message with
*nonSDT-DataIndication* since the initiation of the current resume
procedure for SDT:

3\> initiate transmission of the *UEAssistanceInformation* message in
accordance with 5.7.4.3 to provide *nonSDT-DataIndication*.

\[TS 38.331, clause 5.7.4.3\]

The UE shall set the contents of the *UEAssistanceInformation* message
as follows:

1\> if transmission of the *UEAssistanceInformation* message is
initiated to indicate availability of data mapped to radio bearers not
configured for SDT according to 5.7.4.2:

2\> include the *nonSDT-DataIndication* in the *UEAssistanceInformation*
message;

2\> include and set the *resumeCause* according to the information
received from the upper layers, if provided.

##### 8.1.5.13.2.3 Test Description {#test-description-42 .H6}

##### 8.1.5.13.2.3.1 Pre-test conditions {#pre-test-conditions-42 .H6}

##### System Simulator: {#system-simulator-34 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell with modifications to SIB1 given in
Table 8.1.5.13.2.3.3-1.

##### UE: {#ue-31 .H6}

\- The UE does not have any stored SMS message.

##### Preamble: {#preamble-30 .H6}

\- The UE is in 5GS state 3N-A according to clause 4.4A.2 Table 4.4A.2-3
of TS 38.508-1 \[4\], registered with \"SMS over NAS supported\" as per
test specific messages in table 8.1.5.13.2.3.3-2 and table
8.1.5.13.2.3.3-3 and test state parameter UE test loop mode B prepared
according to clause 4.4A.3 Table 4.4A.3-1 of TS 38.508-1 \[4\].

##### 8.1.5.13.2.3.2 Test procedure sequence {#test-procedure-sequence-42 .H6}

Table 8.1.5.13.2.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | **NR RRC: | \-      | \- |
|           | transmits |           | *DLInfo   |         |    |
|           | a CLOSE   |           | rmationTr |         |    |
|           | UE TEST   |           | ansfer*** |         |    |
|           | LOOP      |           |           |         |    |
|           | message   |           | TC: CLOSE |         |    |
|           | with *UE  |           | UE TEST   |         |    |
|           | test loop |           | LOOP      |         |    |
|           | mode B    |           |           |         |    |
|           | selected  |           |           |         |    |
|           | and IP    |           |           |         |    |
|           | PDU delay |           |           |         |    |
|           | in        |           |           |         |    |
|           | T\_del    |           |           |         |    |
|           | ay\_modeB |           |           |         |    |
|           | timer     |           |           |         |    |
|           | c         |           |           |         |    |
|           | onfigured |           |           |         |    |
|           | as        |           |           |         |    |
|           | defined   |           |           |         |    |
|           | in Table  |           |           |         |    |
|           | 8.1.5.13. |           |           |         |    |
|           | 2.3.3-4.* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The UE    | \--\>     | **NR RRC: | \-      | \- |
|           | transmits |           | *ULInfo   |         |    |
|           | a CLOSE   |           | rmationTr |         |    |
|           | UE TEST   |           | ansfer*** |         |    |
|           | LOOP      |           |           |         |    |
|           | COMPLETE  |           | TC: CLOSE |         |    |
|           | message.  |           | UE TEST   |         |    |
|           |           |           | LOOP      |         |    |
|           |           |           | COMPLETE  |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | The SS    | \-        | \-        | \-      | \- |
|           | transmits |           |           |         |    |
|           | one IP    |           |           |         |    |
|           | Packet to |           |           |         |    |
|           | the UE on |           |           |         |    |
|           | the DRB   |           |           |         |    |
|           | a         |           |           |         |    |
|           | ssociated |           |           |         |    |
|           | with the  |           |           |         |    |
|           | first PDU |           |           |         |    |
|           | session   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 1.   |           |           |         |    |
|           | The IP    |           |           |         |    |
|           | Packet is |           |           |         |    |
|           | less than |           |           |         |    |
|           | sdt-Da    |           |           |         |    |
|           | taVolumeT |           |           |         |    |
|           | hreshold. |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The UE    | \-        | \-        | \-      | \- |
|           | buffers   |           |           |         |    |
|           | the       |           |           |         |    |
|           | received  |           |           |         |    |
|           | IP Packet |           |           |         |    |
|           | and       |           |           |         |    |
|           | starts    |           |           |         |    |
|           | T\_del    |           |           |         |    |
|           | ay\_modeB |           |           |         |    |
|           | timer.    |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with      |           |           |         |    |
|           | s*usp     |           |           |         |    |
|           | endConfig |           |           |         |    |
|           | which*    |           |           |         |    |
|           | includes  |           |           |         |    |
|           | *SDT-CG-C |           |           |         |    |
|           | onfig-r17 |           |           |         |    |
|           | and       |           |           |         |    |
|           | sdt-DRB-  |           |           |         |    |
|           | List-r17* |           |           |         |    |
|           | IEs. The  |           |           |         |    |
|           | default   |           |           |         |    |
|           | DRB in    |           |           |         |    |
|           | *sdt-DRB  |           |           |         |    |
|           | -List-r17 |           |           |         |    |
|           | is        |           |           |         |    |
|           | enabled   |           |           |         |    |
|           | for SDT.* |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | After     | \-        | \-        | \-      | \- |
|           | some time |           |           |         |    |
|           | when      |           |           |         |    |
|           | T\_del    |           |           |         |    |
|           | ay\_modeB |           |           |         |    |
|           | timer     |           |           |         |    |
|           | expires,  |           |           |         |    |
|           | buffered  |           |           |         |    |
|           | IP        |           |           |         |    |
|           | Packets   |           |           |         |    |
|           | are       |           |           |         |    |
|           | submitted |           |           |         |    |
|           | in the    |           |           |         |    |
|           | same      |           |           |         |    |
|           | order as  |           |           |         |    |
|           | received  |           |           |         |    |
|           | (fi       |           |           |         |    |
|           | rst-in-fi |           |           |         |    |
|           | rst-out). |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | UE        | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *RRCResum |         |    |
|           | an        |           | eRequest* |         |    |
|           | *RRCResum |           |           |         |    |
|           | eRequest* |           |           |         |    |
|           | and the   |           |           |         |    |
|           | looped    |           |           |         |    |
|           | back IP   |           |           |         |    |
|           | Packet    |           |           |         |    |
|           | received  |           |           |         |    |
|           | in step 3 |           |           |         |    |
|           | in a CG   |           |           |         |    |
|           | PUSCH     |           |           |         |    |
|           | occasion. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8         | Sending   | \-        | \-        | \-      | \- |
|           | of a      |           |           |         |    |
|           | 160-      |           |           |         |    |
|           | character |           |           |         |    |
|           | MO SMS is |           |           |         |    |
|           | initiated |           |           |         |    |
|           | at the UE |           |           |         |    |
|           | via MMI   |           |           |         |    |
|           | or AT     |           |           |         |    |
|           | command.  |           |           |         |    |
|           | (non-SDT  |           |           |         |    |
|           | s         |           |           |         |    |
|           | ignalling |           |           |         |    |
|           | arrives)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 9         | Check:    | \--\>     | **NR      | 1       | P  |
|           | Does the  |           | RRC:**    |         |    |
|           | UE        |           | *UEAssi   |         |    |
|           | transmit  |           | stanceInf |         |    |
|           | an        |           | ormation* |         |    |
|           | *UEAssi   |           |           |         |    |
|           | stanceInf |           |           |         |    |
|           | ormation* |           |           |         |    |
|           | message   |           |           |         |    |
|           | c         |           |           |         |    |
|           | ontaining |           |           |         |    |
|           | *nonSDT-D |           |           |         |    |
|           | ataIndica |           |           |         |    |
|           | tion-r17* |           |           |         |    |
|           | IE        |           |           |         |    |
|           | including |           |           |         |    |
|           | *resumeCa |           |           |         |    |
|           | use-r17*? |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 10        | The SS    | \<\--     | **NR RRC: | \-      | \- |
|           | transmits |           | *RRC      |         |    |
|           | *R        |           | Resume*** |         |    |
|           | RCResume* |           |           |         |    |
|           | message   |           |           |         |    |
|           | as        |           |           |         |    |
|           | defined   |           |           |         |    |
|           | in Table  |           |           |         |    |
|           | 4.6.1-17  |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\] to  |           |           |         |    |
|           | get UE to |           |           |         |    |
|           | RRC\_     |           |           |         |    |
|           | CONNECTED |           |           |         |    |
|           | mode.     |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11        | The UE    | \--\>     | **NR RRC: | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | *         |           | CResumeCo |         |    |
|           | RRCResume |           | mplete*** |         |    |
|           | Complete* |           |           |         |    |
|           | message   |           | **5GMM:   |         |    |
|           | to SS and |           | UL NAS    |         |    |
|           | buffered  |           | TR        |         |    |
|           | MO SMS    |           | ANSPORT** |         |    |
|           | message   |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 12        | The SS    | \<\--     | **5GMM:   | \-      | \- |
|           | transmits |           | DL NAS    |         |    |
|           | a CP-ACK  |           | TR        |         |    |
|           | enc       |           | ANSPORT** |         |    |
|           | apsulated |           |           |         |    |
|           | in a      |           |           |         |    |
|           | Downlink  |           |           |         |    |
|           | NAS       |           |           |         |    |
|           | Transport |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| RLC PDU   |           |           |           |         |    |
| for IP    |           |           |           |         |    |
| packet is |           |           |           |         |    |
| 97 bytes  |           |           |           |         |    |
| (RLC SDU  |           |           |           |         |    |
| is 94     |           |           |           |         |    |
| bytes for |           |           |           |         |    |
| 3 bytes   |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| header    |           |           |           |         |    |
| and 95    |           |           |           |         |    |
| bytes for |           |           |           |         |    |
| 2 bytes   |           |           |           |         |    |
| RLC       |           |           |           |         |    |
| header)   |           |           |           |         |    |
| and       |           |           |           |         |    |
| sdt-D     |           |           |           |         |    |
| ataVolume |           |           |           |         |    |
| Threshold |           |           |           |         |    |
| is 100    |           |           |           |         |    |
| bytes.    |           |           |           |         |    |
| T         |           |           |           |         |    |
| herefore, |           |           |           |         |    |
| the size  |           |           |           |         |    |
| of RLC    |           |           |           |         |    |
| SDU is    |           |           |           |         |    |
| less than |           |           |           |         |    |
| the       |           |           |           |         |    |
| sdt-Da    |           |           |           |         |    |
| taVolumeT |           |           |           |         |    |
| hreshold. |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.5.13.2.3.3 Specific message contents {#specific-message-contents-42 .H6}

Table 8.1.5.13.2.3.3-1: *SIB1* (Preamble and all steps, Table
8.1.5.13.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-28 with condition SDT                                                     
  ---------------------------------------------------------------------- -------------- ---------------------------------- -----------
  Information Element                                                    Value/Remark   Comment                            Condition
  SIB1 ::= SEQUENCE {                                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                          
  sdt-ConfigCommon-r17 SEQUENCE {                                                                                          
  sdt-RSRP-Threshold-r17                                                 60             (IE value -- 156) dBm = - 96 dBm   
  sdt-LogicalChannelSR-DelayTimer-r17                                    Not present                                       
  sdt-DataVolumeThreshold-r17                                            byte100                                           
  t319a-r17                                                              ms4000                                            
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        

Table 8.1.5.13.2.3.3-2: REGISTRATION REQUEST (Preamble)

  ----------------------------------------------- -------------- ------------------------ -----------
  Derivation Path: 38.508-1 \[4\] Table 4.7.1-6                                           
  Information Element                             Value/remark   Comment                  Condition
  5GS update type                                                                         
  SMS requested                                   '1'B           SMS over NAS supported   
  ----------------------------------------------- -------------- ------------------------ -----------

Table 8.1.5.13.2.3.3-3: REGISTRATION ACCEPT (Preamble)

  ----------------------------------------------- -------------- ---------------------- -----------
  Derivation Path: 38.508-1 \[4\] Table 4.7.1-7                                         
  Information Element                             Value/remark   Comment                Condition
  5GS registration result                                                               
  SMS allowed                                     '1'B           SMS over NAS allowed   
  ----------------------------------------------- -------------- ---------------------- -----------

Table 8.1.5.13.2.3.3-4: CLOSE UE TEST LOOP (Step 1, Table
8.1.5.13.2.3.2-1)

  Derivation path: 38.508-1 \[4\] Table 4.7A-3 condition UE test loop mode B                     
  ---------------------------------------------------------------------------- ----------------- -----------
  Information Element                                                          Value/Remark      Comment
  UE test loop mode B LB setup                                                                   
  IP PDU delay                                                                 0 0 0 0 0 0 1 0   2 seconds

Table 8.1.5.13.2.3.3-5: *RRCRelease* (Step 5, Table 8.1.5.13.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE and SDT                                                                                                                                    
  ------------------------------------------------------------------------------------------------------------------------ ----------------------- ----------------------------------------------------------------------------- -----------
  Information Element                                                                                                      Value/Remark            Comment                                                                       Condition
  RRCRelease ::= SEQUENCE {                                                                                                                                                                                                      
  criticalExtensions CHOICE {                                                                                                                                                                                                    
  rrcRelease SEQUENCE {                                                                                                                                                                                                          
  suspendConfig SEQUENCE {                                                                                                                                                                                                       
  sdt-Config-r17 CHOICE {                                                                                                                                                                                                        
  setup SEQUENCE {                                                                                                                                                                                                               
  sdt-MAC-PHY-CG-Config-r17 CHOICE {                                                                                                                                                                                             
  setup SEQUENCE {                                                                                                                                                                                                               
  cg-SDT-ConfigInitialBWP-NUL-r17 CHOICE {                                                                                                                                                                                       
  setup SEQUENCE {                                                                                                                                                                                                               
  pusch-Config-r17 CHOICE {                                                                                                                                                                                                      
  setup                                                                                                                    PUSCH-Config            Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-118                           
  }                                                                                                                                                                                                                              
  configuredGrantConfigToAddModList-r17 SEQUENCE (SIZE (1..maxNrofConfiguredGrantConfig-r16)) OF ConfiguredGrantConfig {                                                                                                         
  ConfiguredGrantConfig                                                                                                    ConfiguredGrantConfig   Table 8.1.5.13.2.3.3-4                                                        
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  cg-SDT-ConfigInitialBWP-DL-r17 CHOICE {                                                                                                                                                                                        
  setup SEQUENCE {                                                                                                                                                                                                               
  pdcch-Config-r17                                                                                                         Not present                                                                                           
  pdsch-Config-r17 CHOICE {                                                                                                                                                                                                      
  setup                                                                                                                    PDSCH-Config            Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-100                           
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  cg-SDT-TimeAlignmentTimer-r17                                                                                            infinity                To ensure that the timer does not expire before the AT command is finished.   
  cg-SDT-RSRP-ThresholdSSB-r17                                                                                             60                      (IE value -- 156) dBm = - 96 dBm                                              
  cg-SDT-TA-ValiditationConfig-r17 CHOICE {                                                                                                                                                                                      
  setup SEQUENCE {                                                                                                                                                                                                               
  cg-SDT-RSRP-ChangeThreshold-r17                                                                                          dB10                                                                                                  
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              

Table 8.1.5.13.2.3.3-6: *ConfiguredGrantConfig*

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-26 with condition CG\_Config\_Type1
  -------------------------------------------------------------------------------------

Table 8.1.5.13.2.3.3-7: *RRCResumeRequest* (Step 7, Table
8.1.5.13.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeRequest ::= SEQUENCE {                                               
  rrcResumeRequest SEQUENCE {                                                   
  resumeCause                                          mo-data                  
  }                                                                             
  }                                                                             

Table 8.1.5.13.2.3.3-8: *UEAssistanceInformation* (Step 9, Table
8.1.5.13.2.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-30 with condition SDT                            
  ---------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                    Value/remark   Comment   Condition
  UEAssistanceInformation ::= SEQUENCE {                                                          
  criticalExtensions CHOICE {                                                                     
  ueAssistanceInformation SEQUENCE {                                                              
  nonCriticalExtension SEQUENCE {                                                                 
  nonCriticalExtension SEQUENCE {                                                                 
  nonCriticalExtension SEQUENCE {                                                                 
  nonSDT-DataIndication-r17 SEQUENCE {                                                            
  resumeCause-r17                                                        mo-SMS                   
  }                                                                                               
  }                                                                                               
  }                                                                                               
  }                                                                                               
  }                                                                                               
  }                                                                                               
  }                                                                                               

Table 8.1.5.13.2.3.3-9: DL NAS TRANSPORT (step 10, Table
8.1.5.13.2.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.7.1-11                            
  Information Element                                  Value/remark   Comment   Condition
  Payload container type                               '0010'B        SMS       
  Payload container                                    CP-ACK                   
  ---------------------------------------------------- -------------- --------- -----------

##### 8.1.5.13.3 RRC SDT / CG based SDT / SDT-SRB2-Indication

##### 8.1.5.13.3.1 Test Purpose (TP) {#test-purpose-tp-43 .H6}

##### (1) {#section-85 .H6}

**with** { UE in NR RRC\_INACTIVE state, CG based SDT is configured,
SRB2 is configured for SDT and indicated to UE through
*sdt-SRB2-Indication* }

**ensure that** {

**when** { UE has any NAS message to transmit in the UL }

**then** { UE shall transmit the UL NAS message through SRB2 }

}

##### 8.1.5.13.3.2 Conformance requirements {#conformance-requirements-43 .H6}

References: The conformance requirements covered in the present TC are
specified in: 3GPP TS 38.331, clause 5.3.1.1, 5.3.8.3, 5.3.13.1,
5.3.13.1b, 5.3.13.2, 5.3.13.3, and TS 24.501 clause 5.3.1.4. Unless
otherwise stated, these are Rel-17 requirements.

\[TS 38.331, clause 5.3.1.1\]

...

In response to a request to resume the RRC connection or in response to
a resume procedure initiated for SDT, the network may resume the
suspended RRC connection and send UE to RRC\_CONNECTED, or reject the
request to resume and send UE to RRC\_INACTIVE (with a wait timer), or
directly re-suspend the RRC connection and send UE to RRC\_INACTIVE, or
directly release the RRC connection and send UE to RRC\_IDLE, or
instruct the UE to initiate NAS level recovery (in this case the network
sends an RRC setup message).

\[TS 38.331, clause 5.3.8.3\]

The UE shall:

...

1\> if the *RRCRelease* includes *suspendConfig*:

...

2\> if the *sdt-Config* is configured:

3\> for each of the DRB in the *sdt-DRB-List*:

4\> consider the DRB to be configured for SDT;

3\> if *sdt-SRB2-Indication* is configured:

4\> consider the SRB2 to be configured for SDT;

...

3\> if *sdt-MAC-PHY-CG-Config* is configured:

4\> configure the PCell with the configured grant resources for SDT and
instruct the MAC entity to start the *cg-SDT-TimeAlignmentTimer*;

...

\[TS 38.331, clause 5.3.13.1\]

The purpose of this procedure is to resume a suspended RRC connection,
including resuming SRB(s), DRB(s) and multicast MRB(s) or perform an RNA
update. This procedure is also used to initiate SDT in RRC\_INACTIVE.

\[TS 38.331, clause 5.3.13.1b\]

A UE in RRC\_INACTIVE initiates the resume procedure for SDT when all of
the following conditions are fulfilled:

1\> the upper layers request resumption of RRC connection; and

1\> *SIB1* includes *sdt-ConfigCommon*; and

1\> *sdt-Config* is configured; and

1\> all the pending data in UL is mapped to the radio bearers configured
for SDT; and

1\> lower layers indicate that conditions for initiating SDT as
specified in TS 38.321 \[3\] are fulfilled.

NOTE: How the UE determines that all pending data in UL is mapped to
radio bearers configured for SDT is left to UE implementation.

\[TS 38.331, clause 5.3.13.2\]

The UE initiates the procedure when upper layers or AS (when responding
to RAN paging, upon triggering RNA updates while the UE is in
RRC\_INACTIVE, for NR sidelink communication/discovery/V2X sidelink
communication as specified in clause 5.3.13.1a) requests the resume of a
suspended RRC connection or requests the resume for initiating SDT as
specified in clause 5.3.13.1b.

The UE shall ensure having valid and up to date essential system
information as specified in clause 5.2.2.2 before initiating this
procedure.

Upon initiation of the procedure, the UE shall:

...

1\> else if the resumption of the RRC connection is triggered by upper
layers:

...

2\> if the resumption occurs after release with redirect with
*mpsPriorityIndication*:

3\> set the *resumeCause* to *mps-PriorityAccess*;

2\> else:

3\> set the *resumeCause* in accordance with the information received
from upper layers;

...

1\> if *sdt-MAC-PHY-CG-Config* is configured:

2\> if the resume procedure is initiated in a cell that is different to
the PCell in which the UE received the stored *sdt-MAC-PHY-CG-Config*:

3\> release the stored *sdt-MAC-PHY-CG-Config*;

3\> instruct the MAC entity to stop the *cg-SDT-TimeAlignmentTimer*, if
it is running;

1\> if conditions for initiating SDT in accordance with 5.3.13.1b are
fulfilled:

2\> consider the resume procedure is initiated for SDT;

2\> start timer T319a when the lower layers first transmit the CCCH
message;

2\> consider SDT procedure is ongoing;

> ...

1\> initiate transmission of the *RRCResumeRequest* message or
*RRCResumeRequest1* in accordance with 5.3.13.3.

\[TS 38.331, clause 5.3.13.3\]

The UE shall set the contents of *RRCResumeRequest* or
*RRCResumeRequest1* message as follows:

...

1\> if the resume procedure is initiated for SDT:

2\> for each radio bearer that is configured for SDT and for SRB1:

3\> restore the *RLC-BearerConfig* associated with the RLC bearers of
*masterCellGroup* and *pdcp-Config* from the UE Inactive AS context;

> ...

3\> re-establish PDCP entity for the radio bearer that is configured for
SDT without triggering PDCP status report;

2\> resume all the radio bearers that are configured for SDT;

1\> submit the selected message *RRCResumeRequest* or
*RRCResumeRequest1* for transmission to lower layers.

NOTE 2: Only DRBs with previously configured UP ciphering shall resume
ciphering.

If lower layers indicate an integrity check failure while T319 is
running or SDT procedure is ongoing, perform actions specified in
5.3.13.5.

...

\[TS 24.501, clause 5.3.1.4\]

...

The UE is in 5GMM-CONNECTED mode with RRC inactive indication when the
UE is in:

a\) 5GMM-CONNECTED mode over 3GPP access at the NAS layer; and

b\) RRC\_INACTIVE state at the AS layer (see 3GPP TS 38.300 \[27\]).

Unless stated otherwise, the UE behaviour in 5GMM-CONNECTED mode with
RRC inactive indication follows the UE behaviour in 5GMM-CONNECTED over
3GPP access, except that:

a\) the UE shall apply the mobility restrictions; and

b\) the UE shall perform the PLMN selection procedures

as in 5GMM-IDLE mode over 3GPP access.

The UE shall transition from 5GMM-CONNECTED mode over 3GPP access to
5GMM-CONNECTED mode with RRC inactive indication upon receiving an
indication from the lower layers that the RRC connection has been
suspended.

NOTE 1: Any pending procedure or uplink data packet when receiving an
indication from the lower layers that the RRC connection has been
suspended, triggers a request to the lower layers to transition to
RRC\_CONNECTED state. This is also the case when the pending procedure
or uplink data packet triggered a previous request to the lower layers
to transition to RRC\_CONNECTED state.

If the UE in 3GPP access is configured for eCall only mode as specified
in 3GPP TS 31.102 \[22\] then:

\- if the UE with the N1 NAS signalling connection established for eCall
over IMS moved to 5GMM-CONNECTED mode with RRC inactive indication, the
UE shall start timer T3444; and

\- if the UE with the N1 NAS signalling connection established for a
call to an HPLMN designated non-emergency MSISDN or URI for test or
terminal reconfiguration service moved to 5GMM-CONNECTED mode with RRC
inactive indication, the UE shall start timer T3445.

Upon:

a\) a trigger of a procedure which requires sending of a NAS message
different from a REGISTRATION REQUEST message with the NG-RAN-RCU bit of
the 5GS update type IE set to \"UE radio capability update needed\";

b\) an uplink user data packet to be sent for a PDU session with
suspended user-plane resources;

c\) a trigger to request resources for 5G ProSe direct discovery over
PC5 or 5G ProSe direct communication over PC5; or

d\) a trigger to request resources for V2X communication over PC5 (see
3GPP TS 23.287 \[6C\]);

the UE in 5GMM-CONNECTED mode with RRC inactive indication over 3GPP
access shall request the lower layers to transition to RRC\_CONNECTED
state (see 3GPP TS 38.300 \[27\]).

NOTE 2: If the UE supports Small Data Transmission (SDT) (see
3GPP TS 38.300 \[27\]), the following applies:

a\) if the UE due to pending uplink NAS messages or user data packets is
requesting the lower layers to transition to RRC\_CONNECTED state, but
has not received a response from the lower layers, the UE can send the
pending NAS messages or user data packets to the lower layers, and can
receive multiple downlink NAS messages or multiple downlink user data
packets from the lower layers while the UE remains in 5GMM-CONNECTED
mode with RRC inactive indication over 3GPP access (i.e., without
transitioning to 5GMM-CONNECTED mode). When the NAS layer triggers the
transmission of pending uplink NAS messages or user data packets, and if
the SDT is ongoing, the NAS layer will receive the response from the
lower layers only after the SDT session has completed or failed;

b\) the NAS layer is not aware of the classification of NAS messages or
the user data packets as belonging to the SDT session at the lower
layers; and

c\) the setting of access category and the RRC establishment cause
indicated to the lower layers when sending the pending uplink user data
packets while the UE remains in 5GMM-CONNECTED mode with RRC inactive
indication, is left to implementation.

...

The UE shall transition from 5GMM-CONNECTED mode with RRC inactive
indication to 5GMM-CONNECTED mode over 3GPP access upon receiving an
indication from the lower layers that the UE has transitioned to
RRC\_CONNECTED state (see 3GPP TS 38.300 \[27\]).

NOTE 3: The AMF can be aware of the transition between 5GMM-CONNECTED
mode and 5GMM-CONNECTED mode with RRC inactive indication for a UE (see
3GPP TS 23.502 \[9\]).

...

If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives
an indication from the lower layers that the RRC connection has been
suspended, the UE shall stay in 5GMM-CONNECTED mode with RRC inactive
indication. The UE shall re-initiate any pending procedure that had
triggered the request to the lower layers to transition to
RRC\_CONNECTED state, if still needed.

##### 8.1.5.13.3.3 Test Description {#test-description-43 .H6}

##### 8.1.5.13.3.3.1 Pre-test conditions {#pre-test-conditions-43 .H6}

#####  System Simulator: {#system-simulator-35 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell with modifications to SIB1 given in
Table 8.1.5.13.3.3.3-1.

##### UE: {#ue-32 .H6}

\- The UE does not have any stored SMS message.

##### Preamble: {#preamble-31 .H6}

\- The UE is in 5GS state 3N-A according to clause 4.4A.2 Table 4.4A.2-3
of TS 38.508-1 \[4\], registered with \"SMS over NAS supported\". as per
test specific messages in table 8.1.5.13.3.3.3-7 and table
8.1.5.13.3.3.3-8

##### 8.1.5.13.3.3.2 Test procedure sequence {#test-procedure-sequence-43 .H6}

Table 8.1.5.13.3.3.2-1: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message   |           |           |         |    |
|           | with      |           |           |         |    |
|           | s*usp     |           |           |         |    |
|           | endConfig |           |           |         |    |
|           | which     |           |           |         |    |
|           | *includes |           |           |         |    |
|           | *SDT-CG-C |           |           |         |    |
|           | onfig-r17 |           |           |         |    |
|           |  *and     |           |           |         |    |
|           | *sdt-SR   |           |           |         |    |
|           | B2-Indica |           |           |         |    |
|           | tion-r17* |           |           |         |    |
|           | IEs.      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | Sending   | \<\--     | \-        | \-      | \- |
|           | of a 160  |           |           |         |    |
|           | character |           |           |         |    |
|           | MO SMS is |           |           |         |    |
|           | initiated |           |           |         |    |
|           | at the UE |           |           |         |    |
|           | via MMI   |           |           |         |    |
|           | or AT     |           |           |         |    |
|           | command.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCResume |         |    |
|           | *RRCResum |           | Request*  |         |    |
|           | eRequest* |           |           |         |    |
|           | using     |           |           |         |    |
|           | SRB0      |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | Check:    | \--\>     | NR RRC:   | 1       | P  |
|           | Does the  |           | *ULIn     |         |    |
|           | UE        |           | formation |         |    |
|           | transmit  |           | Transfer* |         |    |
|           | a CP-DATA |           |           |         |    |
|           | c         |           | 5GMM: UL  |         |    |
|           | ontaining |           | NAS       |         |    |
|           | an        |           | TRANSPORT |         |    |
|           | RP-DATA   |           |           |         |    |
|           | RPDU (SMS |           |           |         |    |
|           | SUBMIT    |           |           |         |    |
|           | TPDU)     |           |           |         |    |
|           | enc       |           |           |         |    |
|           | apsulated |           |           |         |    |
|           | in an     |           |           |         |    |
|           | Uplink    |           |           |         |    |
|           | NAS       |           |           |         |    |
|           | transport |           |           |         |    |
|           | message   |           |           |         |    |
|           | using     |           |           |         |    |
|           | SRB2?     |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | The SS    | \<\--     | NR RRC:   |         |    |
|           | transmits |           | *DLIn     |         |    |
|           | a CP-ACK  |           | formation |         |    |
|           | enc       |           | Transfer* |         |    |
|           | apsulated |           |           |         |    |
|           | in a      |           | 5GMM: DL  |         |    |
|           | Downlink  |           | NAS       |         |    |
|           | NAS       |           | TRANSPORT |         |    |
|           | Transport |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | The SS    | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *RR       |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note:     |           |           |           |         |    |
| *RRCResum |           |           |           |         |    |
| eRequest* |           |           |           |         |    |
| and       |           |           |           |         |    |
| *ULIn     |           |           |           |         |    |
| formation |           |           |           |         |    |
| Transfer* |           |           |           |         |    |
| messages  |           |           |           |         |    |
| (in step  |           |           |           |         |    |
| 3 & 4)    |           |           |           |         |    |
| are sent  |           |           |           |         |    |
| at the    |           |           |           |         |    |
| same MAC  |           |           |           |         |    |
| PDU       |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.5.13.3.3.3 Specific message contents {#specific-message-contents-43 .H6}

Table 8.1.5.13.3.3.3-1: *SIB1* (Preamble and all steps, Table
8.1.5.13.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-28 with condition SDT                                                     
  ---------------------------------------------------------------------- -------------- ---------------------------------- -----------
  Information Element                                                    Value/Remark   Comment                            Condition
  SIB1 ::= SEQUENCE {                                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                          
  sdt-ConfigCommon-r17 SEQUENCE {                                                                                          
  sdt-RSRP-Threshold-r17                                                 60             (IE value -- 156) dBm = - 96 dBm   
  sdt-LogicalChannelSR-DelayTimer-r17                                    Not present                                       
  sdt-DataVolumeThreshold-r17                                            byte200                                           
  t319a-r17                                                              ms4000                                            
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        

Table 8.1.5.13.3.3.3-2: *RRCRelease* (Step 1, Table 8.1.5.13.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE and SDT                                                                                                                                   
  ------------------------------------------------------------------------------------------------------------------------ ----------------------- ---------------------------------------------------------------------------- -----------
  Information Element                                                                                                      Value/Remark            Comment                                                                      Condition
  RRCRelease ::= SEQUENCE {                                                                                                                                                                                                     
  criticalExtensions CHOICE {                                                                                                                                                                                                   
  rrcRelease SEQUENCE {                                                                                                                                                                                                         
  suspendConfig SEQUENCE {                                                                                                                                                                                                      
  sdt-Config-r17 CHOICE {                                                                                                                                                                                                       
  setup SEQUENCE {                                                                                                                                                                                                              
  sdt-SRB2-Indication-r17                                                                                                  allowed                                                                                              
  sdt-MAC-PHY-CG-Config-r17 CHOICE {                                                                                                                                                                                            
  setup SEQUENCE {                                                                                                                                                                                                              
  cg-SDT-ConfigInitialBWP-NUL-r17 CHOICE {                                                                                                                                                                                      
  setup SEQUENCE {                                                                                                                                                                                                              
  pusch-Config-r17 CHOICE {                                                                                                                                                                                                     
  setup                                                                                                                    PUSCH-Config            Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-118                          
  }                                                                                                                                                                                                                             
  configuredGrantConfigToAddModList-r17 SEQUENCE (SIZE (1..maxNrofConfiguredGrantConfig-r16)) OF ConfiguredGrantConfig {                                                                                                        
  ConfiguredGrantConfig                                                                                                    ConfiguredGrantConfig   Table 8.1.5.13.3.3.3-3                                                       
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  cg-SDT-ConfigInitialBWP-DL-r17 CHOICE {                                                                                                                                                                                       
  setup SEQUENCE {                                                                                                                                                                                                              
  pdcch-Config-r17                                                                                                         Not present                                                                                          
  pdsch-Config-r17 CHOICE {                                                                                                                                                                                                     
  setup                                                                                                                    PDSCH-Config            Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-100                          
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  cg-SDT-TimeAlignmentTimer-r17                                                                                            infinity                To ensure that the timer does not expire before the AT command is finished   
  cg-SDT-RSRP-ThresholdSSB-r17                                                                                             60                      (IE value -- 156) dBm = - 96 dBm                                             
  cg-SDT-TA-ValiditationConfig-r17 CHOICE {                                                                                                                                                                                     
  setup SEQUENCE {                                                                                                                                                                                                              
  cg-SDT-RSRP-ChangeThreshold-r17                                                                                          dB10                                                                                                 
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             
  }                                                                                                                                                                                                                             

Table 8.1.5.13.3.3.3-3: *ConfiguredGrantConfig*

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19 with condition CG\_Config\_Type1 and the following exceptions:                                    
  ------------------------------------------------------------------------------------------------------------------- ------------------ ------------- ---------------
  **Information Element**                                                                                             **Value/remark**   **Comment**   **Condition**
  ConfiguredGrantConfig ::= SEQUENCE {                                                                                                                 
  rrc-ConfiguredUplinkGrant SEQUENCE {                                                                                                                 
  mcsAndTBS                                                                                                           4                                
  }                                                                                                                                                    
  }                                                                                                                                                    

Table 8.1.5.13.3.3.3-4: *RRCResumeRequest* (Step 3, Table
8.1.5.13.3.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeRequest ::= SEQUENCE {                                               
  rrcResumeRequest SEQUENCE {                                                   
  resumeCause                                          mo-data                  
  }                                                                             
  }                                                                             

Table 8.1.5.13.3.3.3-5: UL NAS TRANSPORT (Step 4, Table
8.1.5.13.3.3.2-1)

  Derivation path: TS 38.508-1 \[4\], Table 4.7.1-10                                 
  ---------------------------------------------------- -------------- -------------- -----------
  Information Element                                  Value/remark   Comment        Condition
  Payload container type                               '0010'B        SMS            
  Payload container                                    CP-DATA        RP-DATA RPDU   

Table 8.1.5.13.3.3.3-6: DL NAS TRANSPORT (Step 5, Table
8.1.5.13.3.3.2-1)

  Derivation path: TS 38.508-1 \[4\], Table 4.7.1-10                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  Payload container type                               '0010'B        SMS       
  Payload container                                    CP-ACK                   

Table 8.1.5.13.3.3.3-7: REGISTRATION REQUEST (Preamble)

  ----------------------------------------------- -------------- ------------------------ -----------
  Derivation Path: 38.508-1 \[4\] Table 4.7.1-6                                           
  Information Element                             Value/remark   Comment                  Condition
  5GS update type                                                                         
  SMS requested                                   '1'B           SMS over NAS supported   
  ----------------------------------------------- -------------- ------------------------ -----------

Table 8.1.5.13.3.3.3-8: REGISTRATION ACCEPT (Preamble)

  ----------------------------------------------- -------------- ---------------------- -----------
  Derivation Path: 38.508-1 \[4\] Table 4.7.1-7                                         
  Information Element                             Value/remark   Comment                Condition
  5GS registration result                                                               
  SMS allowed                                     '1'B           SMS over NAS allowed   
  ----------------------------------------------- -------------- ---------------------- -----------

##### 8.1.5.13.4 RRC MT SDT / CG based SDT / Success

##### 8.1.5.13.4.1 Test Purpose (TP) {#test-purpose-tp-44 .H6}

##### (1) {#section-86 .H6}

**with** { UE in NR RRC\_INACTIVE state and CG-SDT resource is
configured }

**ensure that** {

**when** { UE receives a Paging message with MT-SDT Paging and DL RSRP
is above mt-sdt-RSRP-Threshold configured and cg-SDT-TimeAlignmentTimer
is running }

**then** { UE Initiates RRC Resume on CG resource and successfully
completes MT SDT Procedure }

}

##### 8.1.5.13.4.2 Conformance requirements {#conformance-requirements-44 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.2.3, 5.3.13.1b, and TS 38.321
clause 5.27.1. Unless otherwise stated these are Rel-18 requirements.

\[TS 38.331 clause 5.3.2.3\]

Upon receiving the *Paging* message by the UE or receiving
*PagingRecord* from its connected L2 U2N Relay UE by a L2 U2N Remote UE,
the UE shall:

1\> if in RRC\_IDLE, for each of the *PagingRecord*, if any, included in
the *Paging* message, or

1\> if in RRC\_IDLE, for the *PagingRecord*, if any, included in the
*UuMessageTransferSidelink* message received from the connected L2 U2N
Relay UE:

2\> if the *ue-Identity* included in the *PagingRecord* matches the UE
identity allocated by upper layers:

3\> if upper layers indicate the support of paging cause:

4\> forward the *ue-Identity,* *accessType* (if present) and paging
cause (if determined) to the upper layers;

3\> else:

4\> forward the *ue-Identity* and *accessType* (if present) to the upper
layers;

> NOTE 1: If the L2 U2N Relay UE supports the MUSIM feature, it can
> forward the paging cause to the connected L2 U2N Remote UE.

1\> if in RRC\_INACTIVE, for each of the *PagingRecord*, if any,
included in the *Paging* message, or

1\> if in RRC\_INACTIVE, for the *PagingRecord*, if any, included in the
*UuMessageTransferSidelink* message received from the connected L2 U2N
Relay UE:

2\> if the *ue-Identity* included in the *PagingRecord* matches the
UE\'s stored *fullI-RNTI*:

3\> if the UE is configured by upper layers with Access Identity 1:

4\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *mps-PriorityAccess*;

3\> else if the UE is configured by upper layers with Access Identity 2:

4\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *mcs-PriorityAccess*;

3\> else if the UE is configured by upper layers with one or more Access
Identities equal to 11-15:

4\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *highPriorityAccess*;

3\> else if *mt-SDT* indication was included in the *Paging* message and
if the conditions for initiating SDT for a resume procedure initiated in
response to RAN paging according to 5.3.13.1b are fulfilled:

4\> if *pagingGroupList* was not included in the *Paging* message*; or:*

4\> if *pagingGroupList* was included in the *Paging* message but the UE
has not joined any MBS session(s) indicated by the *TMGI(s)* included in
the *pagingGroupList or:*

4\> if *pagingGroupList* was included in the *Paging* message, the UE is
configured to receive MBS multicast in RRC\_INACTIVE, and
*inactiveReceptionAllowed* was included for all the MBS session(s)
indicated by the TMGI(s) that the UE has joined:

5\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *mt-SDT*:

4\> else:

5\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *mt-Access*;

3\> else:

4\> initiate the RRC connection resumption procedure according to 5.3.13
with *resumeCause* set to *mt-Access*;

NOTE 2: If both conditions for initiating MT-SDT and MO-SDT according to
5.3.13.1b are fulfilled, UE may initiate RRC connection resumption
procedure for MT-SDT or MO-SDT based on implementation.

NOTE 3: A MUSIM UE may not initiate the RRC connection resumption
procedure, e.g. when it decides not to respond to the *Paging* message
due to UE implementation constraints as specified in TS 24.501 \[23\].

2\> else if the *ue-Identity* included in the *PagingRecord* matches the
UE identity allocated by upper layers:

3\> if upper layers indicate the support of paging cause:

4\> forward the *ue-Identity,* *accessType* (if present) and paging
cause (if determined) to the upper layers;

3\> else:

4\> forward the *ue-Identity* and *accessType* (if present) to the upper
layers;

3\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11
with release cause \'other\';

1\> if in RRC\_IDLE, for each *TMGI* included in *pagingGroupList*, if
any, included in the *Paging* message:

2\> if the UE has joined an MBS session indicated by the *TMGI* included
in the *pagingGroupList*:

3\> forward the *TMGI* to the upper layers;

\[TS 38.331 clause 5.3.13.1b\]

When requesting lower layers to check the conditions for initiating SDT,
RRC indicates to lower layers whether the resume procedure is initiated
for mobile originated or mobile terminated case.

A UE in RRC\_INACTIVE initiates the resume procedure for SDT when all of
the following conditions are fulfilled:

1\> for the resume procedure initiated by the upper layers (i.e. mobile
originated case):

2\> SIB1 includes sdt-ConfigCommon; and

2\> *sdt-Config* is configured; and

2\> all the pending data in UL is mapped to the radio bearers configured
for SDT; and

2\> for an (e)RedCap UE when RedCap-specific initial downlink BWP
includes no CD-SSB, *ncd-SSB-RedCapInitialBWP-SDT* is configured; and

2\> lower layers indicate that conditions for initiating MO-SDT as
specified in TS 38.321 \[3\] are fulfilled.

1\> for the resume procedure initiated in response to RAN paging (i.e.
mobile terminated case):

2\> lower layers indicate that conditions for initiating MT-SDT as
specified in TS 38.321 \[3\] are fulfilled.

NOTE: How the UE determines that all pending data in UL is mapped to
radio bearers configured for SDT is left to UE implementation.

\[TS 38.321 clause 5.27.1\]

The MAC entity may be configured by RRC with SDT and the SDT procedure
may be initiated by RRC layer for MO-SDT or MT-SDT. The SDT procedure
initiated for MO-SDT can be performed either by Random Access procedure
with 2-step RA type or 4-step RA type (i.e., RA-SDT) or by configured
grant Type 1 (i.e., CG-SDT). The SDT procedure initiated for MT-SDT
cannot be performed by RA-SDT (i.e., RA-SDT is not applicable as
specified in clause 5.1.1b), but can be performed either by Random
Access procedure (i.e., with 2-step RA type or 4-step RA type) or by
configured grant Type 1 (i.e., CG-SDT).

RRC configures the following parameters for SDT procedure:

\- *sdt-DataVolumeThreshold*: data volume threshold for the UE to
determine whether to perform SDT procedure initiated for MO-SDT;

\- *sdt-RSRP-Threshold*: RSRP threshold for UE to determine whether to
perform SDT procedure initiated for MO-SDT;

\- *mt-SDT-RSRP-Threshold*: RSRP threshold for UE to determine whether
to perform SDT procedure initiated for MT-SDT;

\- *cg-SDT-RSRP-ThresholdSSB*: an RSRP threshold configured for SSB
selection for CG-SDT;

*- cg-MT-SDT-MaxDurationToNextCG-Occasion*: time threshold which is used
by the UE to determine whether to perform CG-SDT for MT-SDT;

\- *cg-SDT-MaxDurationToNextCG-Occasion*: time threshold configured per
logical channel which is used by the UE to determine whether to perform
CG-SDT for MO-SDT;

*- sdt-BeamFailureRecoveryProhibitTimer*: prohibit timer to avoid
frequent triggering of Random Access procedure due to beam failure
recovery during RA-SDT procedure or during MT-SDT procedure initiated by
Random Access procedure.

The following UE variable is used for the SDT procedure:

\- *MAX\_DURATION\_TO\_NEXT\_CG\_OCCASION;*

\- *RSRP\_THRESHOLD*.

The MAC entity shall, if initiated by the upper layers for SDT
procedure:

1\> if SDT procedure is initiated for MO-SDT as specified in TS 38.331
\[5\]:

2\> set the *MAX\_DURATION\_TO\_NEXT\_CG\_OCCASION* to the shortest
value of *cg-SDT-MaxDurationToNextCG-Occasion, if configured,* among all
the logical channels configured with this parameter by upper layer and
having data for transmission;

2\> set the *RSRP\_THRESHOLD* to the value of *sdt-RSRP-Threshold,* if
configured.

1\> else if SDT procedure is initiated for MT-SDT as specified in TS
38.331 \[5\]:

2\> set the *MAX\_DURATION\_TO\_NEXT\_CG\_OCCASION* to the value of
*cg-MT-SDT-MaxDurationToNextCG-Occasion, if configured;*

2\> if *mt-SDT-RSRP-Threshold* is configured:

3\> set the *RSRP\_THRESHOLD* to the value of *mt-SDT-RSRP-Threshold.*

2\> else if *sdt-RSRP-Threshold* is configured:

3\> set the *RSRP\_THRESHOLD* to the value of *sdt-RSRP-Threshold.*

1\> if the SDT procedure is initiated for MO-SDT as specified in TS
38.331 \[5\], and the data volume of the pending UL data across all RBs
configured for SDT is less than or equal to *sdt-DataVolumeThreshold*,
or if the SDT procedure is initiated for MT-SDT as specified in TS
38.331 \[5\]; and

NOTE 1: For SDT procedure, the MAC entity also considers the suspended
RBs configured with SDT for data volume calculation. It is up to the
UE\'s implementation how the UE calculates the data volume for the
suspended RBs. Size of the CCCH message is not considered for data
volume calculation

1\> if the RSRP of the downlink pathloss reference is higher than
*RSRP\_THRESHOLD* or if *RSRP\_THRESHOLD* is not set:

2\> if the Serving Cell is configured with supplementary uplink as
specified in TS 38.331 \[5\]; and

2\> if the RSRP of the downlink pathloss reference is less than
*rsrp-ThresholdSSB-SUL*:

3\> select the SUL carrier.

2\> else:

3\> select the NUL carrier.

2\> if CG-SDT is configured on the selected UL carrier, and TA for
CG-SDT is valid according to clause 5.27.2 in the first available CG
occasion for initial CG-SDT transmission with CCCH message according to
clause 5.8.2; and

2\> if the SDT procedure is initiated for MO-SDT as specified in TS
38.331 \[5\], and, for each RB having data available for transmission,
*configuredGrantType1Allowed, if configured for CG-SDT,* is configured
with value *true* for the corresponding logical channel, *or* if the SDT
procedure is initiated for MT-SDT as specified in TS 38.331 \[5\]; and

2\> if at least one SSB configured for CG-SDT with SS-RSRP above
*cg-SDT-RSRP-ThresholdSSB* is available, and if either the time gap
between the initiation of the SDT procedure and first available CG
occasion for initial CG-SDT transmission with CCCH message according to
clause 5.8.2 is less than *MAX\_DURATION\_TO\_NEXT\_CG\_OCCASION*, or if
the *MAX\_DURATION\_TO\_NEXT\_CG\_OCCASION* is not set:

3\> indicate to the upper layers that the conditions for initiating SDT
procedure are fulfilled;

3\> perform CG-SDT procedure on the selected UL carrier according to
clause 5.8.2.

2\> else if a set of Random Access resources for RA-SDT is configured
and can be selected according to clause 5.1.1b on the selected UL
carrier on the BWP configured by *initialUplinkBWP-RedCap*, if
configured for an (e)RedCap UE; otherwise, on the BWP configured by
*initialUplinkBWP*; or

2\> if the SDT procedure is initiated for MT-SDT as specified in TS
38.331 \[5\]:

3\> if *cg-SDT-TimeAlignmentTimer* is running, consider
*cg-SDT-TimeAlignmentTimer* as expired and perform the corresponding
actions in clause 5.2;

3\> indicate to the upper layers that the conditions for initiating SDT
procedure are fulfilled.

2\> else:

3\> indicate to the upper layers that the conditions for initiating SDT
procedure are not fulfilled.

1\> else:

2\> indicate to the upper layers that the conditions for initiating SDT
procedure are not fulfilled.

If Random Access procedure is selected above for SDT procedure initiated
for MO-SDT or MT-SDT and after the Random Access procedure is
successfully completed (see clause 5.1.6), the UE monitors PDCCH
addressed to C-RNTI received in random access response until the SDT
procedure is terminated. If CG-SDT is selected above and after the
initial transmission for CG-SDT is performed, the UE monitors PDCCH
addressed to C-RNTI as stored in UE Inactive AS context as specified in
TS 38.331 \[5\] and CS-RNTI until the SDT procedure is terminated.

The MAC entity shall:

1\> if *sdt-BeamFailureRecoveryProhibitTimer* is configured and not
running; and

> 1\> if RA-SDT procedure for MO-SDT or MT-SDT procedure initiated by
> Random Access procedure is ongoing:

2\> if SS-RSRP of the SSB selected in the last successfully completed
Random Access procedure during ongoing RA-SDT procedure or ongoing
MT-SDT procedure initiated by Random Access procedure is less than
*rsrp-ThresholdSSB*:

3\> start the *sdt-BeamFailureRecoveryProhibitTimer*;

3\> initiate a Random Access procedure (see clause 5.1).

NOTE 1a: It is up to UE implementation when to measure SSBs during
ongoing RA-SDT procedure or ongoing MT-SDT procedure initiated by Random
Access procedure. Based on implementation the UE need not initiate the
Random Access procedure if there is no SSB with SS-RSRP above
*rsrp-ThresholdSSB*. The UE uses *rsrp-ThresholdSSB* in Random Access
configuration selected by the UE when RA-SDT or MT-SDT procedure was
initiated.

NOTE 2: When the UE determines if there is an SSB with SS-RSRP above
*cg-SDT-RSRP-ThresholdSSB* or less than *rsrp-ThresholdSSB*, the UE uses
the latest unfiltered L1-RSRP measurement.

##### 8.1.5.13.4.3 Test description {#test-description-44 .H6}

##### 8.1.5.13.4.3.1 Pre-test conditions {#pre-test-conditions-44 .H6}

##### System Simulator: {#system-simulator-36 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used in NR cell.

##### UE: {#ue-33 .H6}

\- None.

##### Preamble: {#preamble-32 .H6}

\- The UE is in state 2N-A as defined in TS 38.508-1 \[4\], Table
4.4A.2-2 on NR Cell 1.

##### 8.1.5.13.4.3.2 Test procedure sequence {#test-procedure-sequence-44 .H6}

Table 8.1.5.13.4.3.2-1: Main behaviour

  St                                                                                                                                                                                                                                Procedure                                                                                                       Message Sequence   TP                           Verdict   
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------- ------------------ ---------------------------- --------- ----
                                                                                                                                                                                                                                                                                                                                                    U - S              Message                                
  1                                                                                                                                                                                                                                 The SS transmits a Paging message with MT-SDT indication.                                                       \<\--              NR RRC: *Paging*             \-        \-
  2                                                                                                                                                                                                                                 Check: Does the UE transmit an *RRCResumeRequest* message on the CG resource with resume cause set to MT-SDT?   \--\>              NR RRC: *RRCResumeRequest*   1         P
  3                                                                                                                                                                                                                                 The SS transmits a DL assignment using UE's C-RNTI.                                                             \<\--              (DL Grant)                   \-        \-
  4                                                                                                                                                                                                                                 The SS transmits a DL MAC PDU containing a RLC PDU (Note1).                                                     \<\--              MAC PDU                      \-        \-
  5                                                                                                                                                                                                                                 Check: Does the UE transmit a HARQ ACK?                                                                         \--\>              HARQ ACK                     1         P
  6                                                                                                                                                                                                                                 The SS transmits an *RRCRelease* message.                                                                       \<\--              NR RRC: *RRCRelease*         \-        \-
  Note 1: RLC PDU is 97 bytes (RLC SDU is 94 bytes for 3 bytes RLC header and 95 bytes for 2 bytes RLC header) and sdt-DataVolumeThreshold is 100 bytes. Therefore, the size of RLC SDU is less than the sdt-DataVolumeThreshold.                                                                                                                                                                             

##### 8.1.5.13.4.3.3 Specific message contents {#specific-message-contents-44 .H6}

Table 8.1.5.13.4.3.3-1: *RRCRelease* (Preamble, Table 8.1.5.13.4.3.2-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.1-16  |                 |                 |           |
| with condition  |                 |                 |           |
| NR              |                 |                 |           |
| \_RRC\_INACTIVE |                 |                 |           |
| and SDT         |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/Remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| RRCRelease ::=  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rrc-Transa      | RRC-Transa      |                 |           |
| ctionIdentifier | ctionIdentifier |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cri             |                 |                 |           |
| ticalExtensions |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rrcRelease      |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| suspendConfig   |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sdt-Config-r17  |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| s               | 1 entry         |                 |           |
| dt-DRB-List-r17 |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (0..maxDRB)) OF |                 |                 |           |
| DRB-Identity {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| DR              | DRB-Identity    | Entry 1         |           |
| B-Identity\[1\] | using condition |                 |           |
|                 | DRBj            | j is the ID of  |           |
|                 |                 | the DRB         |           |
|                 |                 | established     |           |
|                 |                 | during the      |           |
|                 |                 | preamble which  |           |
|                 |                 | is allocated    |           |
|                 |                 | according to    |           |
|                 |                 | internal TTCN   |           |
|                 |                 | mapping         |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sdt-MAC-PH      |                 |                 |           |
| Y-CG-Config-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| c               |                 |                 |           |
| g-SDT-ConfigIni |                 |                 |           |
| tialBWP-NUL-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| p               |                 |                 |           |
| usch-Config-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup           | PUSCH-Config    | TS              |           |
|                 |                 | 38.508-1\[4\]   |           |
|                 |                 | Table           |           |
|                 |                 | 4.6.3-118:      |           |
|                 |                 | *PUSCH-Config*  |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| configu         |                 |                 |           |
| redGrantConfigT |                 |                 |           |
| oAddModList-r17 |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..maxN        |                 |                 |           |
| rofConfiguredGr |                 |                 |           |
| antConfig-r16)) |                 |                 |           |
| OF              |                 |                 |           |
| Config          |                 |                 |           |
| uredGrantConfig |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ConfiguredG     | Config          | Table           |           |
| rantConfig\[1\] | uredGrantConfig | 8               |           |
|                 |                 | .1.5.13.4.3.3-2 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| c               | Not present     |                 |           |
| g-SDT-ConfigIni |                 |                 |           |
| tialBWP-SUL-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cg-SDT-ConfigIn |                 |                 |           |
| itialBWP-DL-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| p               | Not present     |                 |           |
| dcch-Config-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
|                 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| p               |                 |                 |           |
| dsch-Config-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup           | PDSCH-Config    | TS              |           |
|                 |                 | 38.508-1\[4\]   |           |
|                 |                 | Table           |           |
|                 |                 | 4.6.3-100:      |           |
|                 |                 | *PDSCH-Config*  |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cg-SDT-TimeAli  | ms5120          | TimeAlignm      |           |
| gnmentTimer-r17 |                 | entTimer(5.12s) |           |
|                 |                 | is larger than  |           |
|                 |                 | IP PDU delay    |           |
|                 |                 | timer(2s) for   |           |
|                 |                 | Loop mode B.    |           |
+-----------------+-----------------+-----------------+-----------+
| cg-SDT-RSRP-T   | 60              | (IE value --    | Preamble  |
| hresholdSSB-r17 |                 | 156) dBm = - 96 |           |
|                 |                 | dBm             |           |
+-----------------+-----------------+-----------------+-----------+
| cg              |                 |                 |           |
| -SDT-TA-Validit |                 |                 |           |
| ationConfig-r17 |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| setup SEQUENCE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| c               | dB10            |                 |           |
| g-SDT-RSRP-Chan |                 |                 |           |
| geThreshold-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| cg-             | Not present     |                 |           |
| SDT-CS-RNTI-r17 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.5.13.4.3.3-2: *ConfiguredGrantConfig* (Table 8.1.5.13.4.3.3-1)

+----------------+----------------+----------------+----------------+
| Derivation     |                |                |                |
| Path: TS       |                |                |                |
| 38.508-1 \[4\] |                |                |                |
| Table          |                |                |                |
| 4.6.3-26,      |                |                |                |
| condition      |                |                |                |
| CG\            |                |                |                |
| _Config\_Type1 |                |                |                |
+================+================+================+================+
| Information    | Value/Remark   | Comment        | Condition      |
| Element        |                |                |                |
+----------------+----------------+----------------+----------------+
| Configu        |                |                |                |
| redGrantConfig |                |                |                |
| ::= SEQUENCE { |                |                |                |
+----------------+----------------+----------------+----------------+
| rrc-Configu    |                |                |                |
| redUplinkGrant |                |                |                |
| SEQUENCE{      |                |                |                |
+----------------+----------------+----------------+----------------+
| frequencyDo    | BIT STRING     | Equals to      | SCS15 AND      |
| mainAllocation | (SIZE(18)      |                | CBW5, SCS30    |
|                |                | NBWPsize \*    | AND CBW10      |
|                |                | (NBWPsize --   |                |
|                |                | LRB + 1) +     |                |
|                |                | (NBWPsize -1 - |                |
|                |                | RBstart),      |                |
|                |                | where          |                |
|                |                |                |                |
|                |                | LRB = 24 PRB,  |                |
|                |                |                |                |
|                |                | RBstart = 0,   |                |
|                |                |                |                |
|                |                | NBWPsize is    |                |
|                |                | the size       |                |
|                |                | \[PRBs\] of    |                |
|                |                | the carrier    |                |
|                |                | bandwidth and  |                |
|                |                | contained in   |                |
|                |                | TS.38.508-1    |                |
|                |                | \[4\] clause   |                |
|                |                | 6.2.3.1        |                |
+----------------+----------------+----------------+----------------+
|                | BIT STRING     | Equal to       |                |
|                | (SIZE(18)      |                |                |
|                |                | NBWPsize \*    |                |
|                |                | (LRB-1) +      |                |
|                |                | RBstart),      |                |
|                |                | where          |                |
|                |                |                |                |
|                |                | LRB = 24 PRB,  |                |
|                |                |                |                |
|                |                | RBstart = 0,   |                |
|                |                |                |                |
|                |                | NBWPsize is    |                |
|                |                | the size       |                |
|                |                | \[PRBs\] of    |                |
|                |                | the carrier    |                |
|                |                | bandwidth and  |                |
|                |                | contained in   |                |
|                |                | TS.38.508-1    |                |
|                |                | \[4\] clause   |                |
|                |                | 6.2.3.1        |                |
+----------------+----------------+----------------+----------------+
| dmrs-Seq       | 0              |                |                |
| Initialization |                |                |                |
+----------------+----------------+----------------+----------------+
| mcsAndTBS      | 0              |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| }              |                |                |                |
+----------------+----------------+----------------+----------------+
| Note:          |                |                |                |
| Configured UL  |                |                |                |
| grant for      |                |                |                |
| CG-SDT is 888  |                |                |                |
| bits (L~RBs~ & |                |                |                |
| I~MCS~ as per  |                |                |                |
| 38.523-3\[3\]  |                |                |                |
| annex B) is    |                |                |                |
| chosen to      |                |                |                |
| enable UE to   |                |                |                |
| transmit       |                |                |                |
| RR             |                |                |                |
| CResumeRequest |                |                |                |
| and Loop       |                |                |                |
| backed RLC PDU |                |                |                |
| in a MAC PDU ( |                |                |                |
| 97 bytes for   |                |                |                |
| Loop backed    |                |                |                |
| RLC PDU + 2    |                |                |                |
| bytes for MAC  |                |                |                |
| Sub Header + 6 |                |                |                |
| bytes for      |                |                |                |
| RR             |                |                |                |
| CResumeRequest |                |                |                |
| message + 2    |                |                |                |
| bytes for MAC  |                |                |                |
| Sub Header + 4 |                |                |                |
| bytes for BSR  |                |                |                |
| and Padding )  |                |                |                |
+----------------+----------------+----------------+----------------+

Table 8.1.5.13.4.3.3-3: RRC Resume Request (step 2, Table
8.1.5.13.4.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19                            
  Information Element                                  Value/remark   Comment   Condition
  RRCResumeRequest ::= SEQUENCE {                                               
  rrcResumeRequest SEQUENCE {                                                   
  resumeCause                                          mt-SDT-v1810             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

#### 8.1.5.14 Non-Terrestrial Network

##### 8.1.5.14.1 NR NTN / SIB19 / T430 with the timer value set to ntn-UlSyncValidityDuration / T430 Expiry

##### 8.1.5.14.1.1 Test Purpose (TP) {#test-purpose-tp-45 .H6}

##### (1) {#section-87 .H6}

**with** { UE has acquired SIB19 and in RRC\_CONNECTED state and starts
timer T430 with *ntn-UlSyncValidityDuration* }

**ensure that** {

**when** { T430 expires in RRC\_CONNECTED state }

**then** { UE informs lower layers that the UL synchronization is lost
and initiates the UL synchronization restoration procedure }

}

##### 8.1.5.14.1.2 Conformance requirements {#conformance-requirements-45 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS38.331 clauses 5.2.2.1, 5.2.2.4.21 , 5.2.2.6, 5.2.2.3.2

Unless otherwise stated these are Rel-17 requirements.

\[38.331, clause 5.2.2.1\]

Figure 5.2.2.1-1: System information acquisition

The UE applies the SI acquisition procedure to acquire the AS, NAS- and
positioning assistance data information. The procedure applies to UEs in
RRC\_IDLE, in RRC\_INACTIVE and in RRC\_CONNECTED.

The UE in RRC\_IDLE and RRC\_INACTIVE shall ensure having a valid
version of (at least) the *MIB*, *SIB1* through *SIB4,* *SIB5* (if the
UE supports E-UTRA), *SIB11* (if the UE is configured for idle/inactive
measurements), *SIB12* (if UE is capable of NR sidelink
communication/discovery and is configured by upper layers to receive or
transmit NR sidelink communication/discovery), and *SIB13*, *SIB14* (if
UE is capable of V2X sidelink communication and is configured by upper
layers to receive or transmit V2X sidelink communication), *SIB15* (if
UE is configured by upper layers to report disaster roaming related
information), *SIB16* (if the UE is capable of slice-based cell
reselection and the UE receives NSAG information for cell reselection
from upper layer), *SIB17* (if the UE is using TRS resources for power
saving in RRC\_IDLE and RRC\_INACTIVE) and *SIB19* (if UE is accessing
NR via NTN access).

\[38.331, clause 5.2.2.4.21\]

Upon receiving *SIB19*, the UE in RRC\_CONNECTED shall:

1\> start or restart T430 for serving cell with the timer value set to
*ntn-UlSyncValidityDuration* for the serving cell from the subframe
indicated by *epochTime* for the serving cell;

NOTE: UE should attempt to re-acquire *SIB19* before the end of the
duration indicated by *ntn-UlSyncValidityDuration* and *epochTime* by UE
implementation.

\[38.331, clause 5.2.2.6\]

The UE shall:

1\> if T430 for serving cell expires and if in RRC\_CONNECTED:

2\> inform lower layers that UL synchronisation is lost;

2\> acquire *SIB19* as defined in clause 5.2.2.3.2;

2\> upon successful acquisition of *SIB19*:

3\> inform lower layers when UL synchronisation is obtained;

NOTE: The exact time when UL synchronisation is obtained (after SIB19 is
acquired) is left to UE implementation, which can be from the subframe
indicated by *epochTime* and optionally before the subframe indicated by
*epochTime*.

\[38.331, clause 5.2.2.3.2\]

For SI message acquisition PDCCH monitoring occasion(s) are determined
according to *searchSpaceOtherSystemInformation*. If
*searchSpaceOtherSystemInformation* is set to zero, PDCCH monitoring
occasions for SI message reception in SI-window are same as PDCCH
monitoring occasions for *SIB1* where the mapping between PDCCH
monitoring occasions and SSBs is specified in TS 38.213\[13\]. If
*searchSpaceOtherSystemInformation* is not set to zero, PDCCH monitoring
occasions for SI message are determined based on search space indicated
by *searchSpaceOtherSystemInformation*. PDCCH monitoring occasions for
SI message which are not overlapping with UL symbols (determined
according to *tdd-UL-DL-ConfigurationCommon*) are sequentially numbered
from one in the SI window. The \[x×N+K\]^th^ PDCCH monitoring occasion
(s) for SI message in SI-window corresponds to the K^th^ transmitted
SSB, where x = 0, 1, \...X-1, K = 1, 2, ...N, N is the number of actual
transmitted SSBs determined according to *ssb-PositionsInBurst* in
*SIB1* and X is equal to CEIL(number of PDCCH monitoring occasions in
SI-window/N). The actual transmitted SSBs are sequentially numbered from
one in ascending order of their SSB indexes. The UE assumes that, in the
SI window, PDCCH for an SI message is transmitted in at least one PDCCH
monitoring occasion corresponding to each transmitted SSB and thus the
selection of SSB for the reception SI messages is up to UE
implementation.

When acquiring an SI message, the UE shall:

1\> determine the start of the SI-window for the concerned SI message as
follows:

2\> if the concerned SI message is configured in the
*schedulingInfoList*:

3\> for the concerned SI message, determine the number *n* which
corresponds to the order of entry in the list of SI messages configured
by *schedulingInfoList* in *si-SchedulingInfo* in *SIB1*;

3\> determine the integer value *x = (n -- 1) × w*, where *w* is the
*si-WindowLength*;

3\> the SI-window starts at the slot \#*a*, where *a* = *x* mod N, in
the radio frame for which SFN mod *T* = FLOOR(*x*/N), where *T* is the
*si-Periodicity* of the concerned SI message and N is the number of
slots in a radio frame as specified in TS 38.211 \[16\];

2\> else if the concerned SI message is configured in the
*schedulingInfoList2*;

3\> determine the integer value *x = (si-WindowPosition -1) × w*, where
*w* is the *si-WindowLength*;

3\> the SI-window starts at the slot \#*a*, where *a* = *x* mod N, in
the radio frame for which SFN mod *T* = FLOOR(*x*/N), where *T* is the
*si-Periodicity* of the concerned SI message and N is the number of
slots in a radio frame as specified in TS 38.211 \[16\];

2\> else if the concerned SI message is configured in the
*posSchedulingInfoList* and *offsetToSI-Used* is not configured:

3\> create a concatenated list of SI messages by appending the
*posSchedulingInfoList* in *posSI-SchedulingInfo* in *SIB1 to
schedulingInfoList* in *si-SchedulingInfo* in *SIB1;*

3\> for the concerned SI message, determine the number *n* which
corresponds to the order of entry in the concatenated list;

3\> determine the integer value *x = (n -- 1) × w*, where *w* is the
*si-WindowLength*;

3\> the SI-window starts at the slot \#*a*, where *a* = *x* mod N, in
the radio frame for which SFN mod *T* = FLOOR(*x*/N), where *T* is the
*posSI-Periodicity* of the concerned SI message and N is the number of
slots in a radio frame as specified in TS 38.211 \[16\];

2\> else if the concerned SI message is configured by the
*posSchedulingInfoList* and *offsetToSI-Used* is configured:

3\> determine the number *m* which corresponds to the number of SI
messages with an associated *si-Periodicity* of 8 radio frames (80 ms),
configured by *schedulingInfoList* in *SIB1*;

3\> for the concerned SI message, determine the number *n* which
corresponds to the order of entry in the list of SI messages configured
by *posSchedulingInfoList* in *SIB1*;

3\> determine the integer value *x* = *m* *× w +* (*n* -- 1*)* *× w*,
where *w* is the *si-WindowLength;*

3\> the SI-window starts at the slot \#*a*, where *a* = *x* mod N, in
the radio frame for which SFN mod *T* = FLOOR(*x*/N) +8, where *T* is
the *posSI-Periodicity* of the concerned SI message and N is the number
of slots in a radio frame as specified in TS 38.211 \[16\];

1\> receive the PDCCH containing the scheduling RNTI, i.e. SI-RNTI in
the PDCCH monitoring occasion(s) for SI message acquisition, from the
start of the SI-window and continue until the end of the SI-window whose
absolute length in time is given by *si-WindowLength*, or until the SI
message was received;

1\> if the SI message was not received by the end of the SI-window,
repeat reception at the next SI-window occasion for the concerned SI
message in the current modification period;

1\> if all the SIB(s) and/or posSIB(s) requested in
*DedicatedSIBRequest* message have been acquired:

2\> stop timer T350, if running;

NOTE 1: The UE is only required to acquire broadcasted SI message if the
UE can acquire it without disrupting unicast or MBS multicast data
reception, i.e. the broadcast and unicast/MBS multicast beams are quasi
co-located.

NOTE 2: The UE is not required to monitor PDCCH monitoring occasion(s)
corresponding to each transmitted SSB in SI-window.

NOTE 3: If the concerned SI message was not received in the current
modification period, handling of SI message acquisition is left to UE
implementation.

NOTE 4: A UE in RRC\_CONNECTED may stop the PDCCH monitoring during the
SI window for the concerned SI message when the requested SIB(s) are
acquired.

NOTE 5: A UE capable of NR sidelink communication/discovery and
configured by upper layers to perform NR sidelink
communication/discovery on a frequency, may acquire *SIB12* or
*SystemInformationBlockType28* from a cell other than current serving
cell (for RRC\_INACTIVE or RRC\_IDLE) or current PCell (for
RRC\_CONNECTED), if *SIB12* of current serving cell (for RRC\_INACTIVE
or RRC\_IDLE) or current PCell (for RRC\_CONNECTED) does not provide
configuration for NR sidelink communication/discovery for the frequency,
and if the other cell providing configuration for NR sidelink
communication/discovery for the frequency meets the S-criteria as
defined in TS 38.304 \[20\] or TS 36.304 \[27\].

1\> perform the actions for the acquired SI message as specified in
clause 5.2.2.4.

8.1.5.14.1.3 Test description

8.1.5.14.1.3.1 Pre-test conditions

##### System Simulator: {#system-simulator-37 .H6}

\- NR Cell 1 as specified in TS 38.508-1 \[4\] Table 4.4.2.1.

\- System information combination NR-28 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used.

##### UE: {#ue-34 .H6}

\- The pre-configured UE location is defined in TS 38.508-1 \[4\] Clause
4.5C.

##### Preamble {#preamble-33 .H6}

\- The UE is in state Switched OFF (state 0N-B) as defined in TS
38.508-1 \[4\], subclause 4.4A on NR Cell 1.

8.1.5.14.1.3.2 Test procedure sequence

Table 8.1.5.14.1.3.2-1: Main behaviour

+------+-------------+-------------+-------------+---------+----+
| St   | Procedure   | Message     | TP          | Verdict |    |
|      |             | Sequence    |             |         |    |
+======+=============+=============+=============+=========+====+
|      |             | U - S       | Message     |         |    |
+------+-------------+-------------+-------------+---------+----+
| 1    | Power on    | \-          | \-          | \-      | \- |
|      | UE.         |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 2-19 | Steps 2 to  | \-          | \-          | \-      | \- |
|      | 19a1 of the |             |             |         |    |
|      | r           |             |             |         |    |
|      | egistration |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | described   |             |             |         |    |
|      | in TS       |             |             |         |    |
|      | 38.508-1    |             |             |         |    |
|      | \[4\] table |             |             |         |    |
|      | 4.5.2.2-2   |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 20   | IF          | \<\--       | NR RRC:     | \-      | \- |
|      | *connected  |             | *           |         |    |
|      | without     |             | DLInformati |         |    |
|      | release* is |             | onTransfer* |         |    |
|      | *On* AND    |             |             |         |    |
|      | Test Loop   |             | TC: CLOSE   |         |    |
|      | Fu          |             | UE TEST     |         |    |
|      | nction=*On* |             | LOOP        |         |    |
|      | THEN the SS |             |             |         |    |
|      | transmits a |             |             |         |    |
|      | CLOSE UE    |             |             |         |    |
|      | TEST LOOP   |             |             |         |    |
|      | message to  |             |             |         |    |
|      | enter the   |             |             |         |    |
|      | UE test     |             |             |         |    |
|      | loop mode.  |             |             |         |    |
|      | The CLOSE   |             |             |         |    |
|      | UE TEST     |             |             |         |    |
|      | LOOP is     |             |             |         |    |
|      | using the   |             |             |         |    |
|      | associated  |             |             |         |    |
|      | condition   |             |             |         |    |
|      | for the     |             |             |         |    |
|      | test loop.  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 21   | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | transmits a |             | *           |         |    |
|      | CLOSE UE    |             | ULInformati |         |    |
|      | TEST LOOP   |             | onTransfer* |         |    |
|      | COMPLETE    |             |             |         |    |
|      | message to  |             | TC: CLOSE   |         |    |
|      | confirm     |             | UE TEST     |         |    |
|      | that        |             | LOOP        |         |    |
|      | loopback    |             | COMPLETE    |         |    |
|      | entities    |             |             |         |    |
|      | for the     |             |             |         |    |
|      | radio       |             |             |         |    |
|      | bearer(s)   |             |             |         |    |
|      | have been   |             |             |         |    |
|      | created and |             |             |         |    |
|      | loop back   |             |             |         |    |
|      | is          |             |             |         |    |
|      | activated.  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 22   | SS start a  | \-          | \-          | \-      | \- |
|      | timer T1    |             |             |         |    |
|      | with value  |             |             |         |    |
|      | = T430      |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 23   | SS stops    | \-          | \-          | \-      | \- |
|      | b           |             |             |         |    |
|      | roadcasting |             |             |         |    |
|      | SIB19       |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 24   | SS stops UL | \-          | \-          | \-      | \- |
|      | periodic    |             |             |         |    |
|      | grant       |             |             |         |    |
|      | allocation  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 25   | The SS      | \<\--       | PDCP PDU    | \-      | \- |
|      | transmits   |             | DATA \#0    |         |    |
|      | one IP      |             |             |         |    |
|      | packet to   |             |             |         |    |
|      | the UE on   |             |             |         |    |
|      | the DRB     |             |             |         |    |
|      | associated  |             |             |         |    |
|      | with the    |             |             |         |    |
|      | first PDU   |             |             |         |    |
|      | session on  |             |             |         |    |
|      | NR Cell 1.  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 26   | Wait until  | \-          | \-          | \-      | \- |
|      | expiry of   |             |             |         |    |
|      | T1.         |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 27   | The SS      | \-          | \-          | \-      | \- |
|      | starts the  |             |             |         |    |
|      | UL periodic |             |             |         |    |
|      | grant       |             |             |         |    |
|      | t           |             |             |         |    |
|      | ransmission |             |             |         |    |
|      | allowing    |             |             |         |    |
|      | the UE to   |             |             |         |    |
|      | return the  |             |             |         |    |
|      | IP packet   |             |             |         |    |
|      | as received |             |             |         |    |
|      | at step 25. |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 28   | SS resumes  | \-          | \-          | \-      | \- |
|      | b           |             |             |         |    |
|      | roadcasting |             |             |         |    |
|      | SIB19*.*    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 29   | Check: Does | \--\>       | PDCP PDU    | 1       | P  |
|      | the UE loop |             | DATA \#0    |         |    |
|      | back the IP |             |             |         |    |
|      | packet      |             |             |         |    |
|      | received at |             |             |         |    |
|      | step 25 in  |             |             |         |    |
|      | NR Cell 1?  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+

##### 8.1.5.14.1.3.3 Specific message contents {#specific-message-contents-45 .H6}

Table 8.1.5.14.1.3.3-1: *SIB19* for NR Cell1(preamble and all steps)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.2-18C                                    
  ----------------------------------------------------- -------------- ----------------- --------------
  Information Element                                   Value/remark   Comment           Condition
  SIB19-r17 ::= SEQUENCE {                                                               
  ntn-Config-r17 SEQUENCE {                                                              
  ntn-UlSyncValidityDuration-r17                        s60            *Value of T430*   GSO and NGSO
  }                                                                                      
  }                                                                                      

### *8.1.6* SON and MDT support for NR

#### 8.1.6.1 Intra NR MDT

##### 8.1.6.1.1 Immediate MDT

###### 8.1.6.1.1.1 Immediate MDT / Measurement reporting / Location information

##### 8.1.6.1.1.1.1 Test Purpose (TP) {#test-purpose-tp-46 .H6}

##### (1) {#section-88 .H6}

**with** { UE in RRC\_CONNECTED state **and** measurement with event A2
configured with *includeLocationInfo* included in the *reportConfig* }

**ensure that** {

**when** { Entry condition for event A2 is met and *detailed location
information that has not been reported is available* }

**then** { UE sends *MeasurementReport* message with *locationInfo*
included }

}

##### (2) {#section-89 .H6}

**with** { UE in RRC\_CONNECTED state **and** measurement configured for
event A2 }

**ensure that** {

**when** { Exit condition for event A2 is met }

**then** { UE stops sending *MeasurementReport* message }

}

##### 8.1.6.1.1.1.2 Conformance requirements {#conformance-requirements-46 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.5.3, 5.5.4.1, 5.5.4.3, 5.3.5.9, 6.3.4
and 5.5.5.1.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

\...

1\> if the *RRCReconfiguration* message includes the *measConfig*:

2\> perform the measurement configuration procedure as specified in
5.5.2;

\...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

2\> if the corresponding *reportConfig* includes a *reportType* set to
*eventTriggered* or *periodical*:

3\> if the corresponding *measObject* concerns NR:

4\> if the *eventA1* or *eventA2* is configured in the corresponding
*reportConfig*:

5\> consider only the serving cell to be applicable;

4\> if the *eventA3* or *eventA5* is configured in the corresponding
*reportConfig*:

5\> if a serving cell is associated with a *measObjectNR* and neighbours
are associated with another *measObjectNR*, consider any serving cell
associated with the other *measObjectNR* to be a neighbouring cell as
well;

4\> if corresponding *reportConfig* includes *reportType* set to
*periodical*; or

4\> for measurement events other than *eventA1* or *eventA2*:

5\> if *useAllowedCellList* is set to *true*:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
included in the *allowedCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

5\> else:

6\> consider any neighbouring cell detected based on parameters in the
associated *measObjectNR* to be applicable when the concerned cell is
not included in the *excludedCellsToAddModList* defined within the
*VarMeasConfig* for this *measId*;

\...

2\> if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells for all
measurements after layer 3 filtering taken during *timeToTrigger*
defined for this event within the *VarMeasConfig*, while the
*VarMeasReportList* does not include a measurement reporting entry for
this *measId* (a first cell triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

> 3\> if *useT312* is set to *true* in *reportConfig* for this event:

4\> if T310 for the corresponding SpCell is running; and

4\> if T312 is not running for corresponding SpCell:

5\> start timer T312 for the corresponding SpCell with the value of T312
configured in the corresponding *measObjectNR*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable cells not
included in the *cellsTriggeredList* for all measurements after layer 3
filtering taken during *timeToTrigger* defined for this event within the
*VarMeasConfig* (a subsequent cell triggers the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

> 3\> if *useT312* is set to *true* in *reportConfig* for this event:

4\> if T310 for the corresponding SpCell is running; and

4\> if T312 is not running for corresponding SpCell:

5\> start timer T312 for the corresponding SpCell with the value of T312
configured in the corresponding *measObjectNR*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
of the cells included in the *cellsTriggeredList* defined within the
*VarMeasReportList* for this *measId* for all measurements after layer 3
filtering taken during *timeToTrigger* defined within the
*VarMeasConfig* for this event:

3\> remove the concerned cell(s) in the *cellsTriggeredList* defined
within the *VarMeasReportList* for this *measId*;

3\> if *reportOnLeave* is set to *true* for the corresponding reporting
configuration:

4\> initiate the measurement reporting procedure, as specified in 5.5.5;

3\> if the *cellsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable transmission
resource pools for all measurements taken during *timeToTrigger* defined
for this event within the *VarMeasConfig*, while the *VarMeasReportList*
does not include an measurement reporting entry for this *measId* (a
first transmission resource pool triggers the event):

3\> include a measurement reporting entry within the *VarMeasReportList*
for this *measId*;

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned transmission resource pool(s) in the
*poolsTriggeredList* defined within the *VarMeasReportList* for this
*measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the entry
condition applicable for this event, i.e. the event corresponding with
the *eventId* of the corresponding *reportConfig* within
*VarMeasConfig*, is fulfilled for one or more applicable transmission
resource pools not included in the *poolsTriggeredList* for all
measurements taken during *timeToTrigger* defined for this event within
the *VarMeasConfig* (a subsequent transmission resource pool triggers
the event):

3\> set the *numberOfReportsSent* defined within the *VarMeasReportList*
for this *measId* to 0;

3\> include the concerned transmission resource pool(s) in the
*poolsTriggeredList* defined within the *VarMeasReportList* for this
*measId*;

3\> initiate the measurement reporting procedure, as specified in 5.5.5;

2\> else if the *reportType* is set to *eventTriggered* and if the
leaving condition applicable for this event is fulfilled for one or more
applicable transmission resource pools included in the
*poolsTriggeredList* defined within the *VarMeasReportList* for this
*measId* for all measurements taken during *timeToTrigger* defined
within the *VarMeasConfig* for this event:

3\> remove the concerned transmission resource pool(s) in the
*poolsTriggeredList* defined within the *VarMeasReportList* for this
*measId*;

3\> if the *poolsTriggeredList* defined within the *VarMeasReportList*
for this *measId* is empty:

4\> remove the measurement reporting entry within the
*VarMeasReportList* for this *measId*;

4\> stop the periodical reporting timer for this *measId*, if running

\...

\[TS 38.331, clause 5.5.4.3\]

The UE shall:

1\> consider the entering condition for this event to be satisfied when
condition A2-1, as specified below, is fulfilled;

1\> consider the leaving condition for this event to be satisfied when
condition A2-2, as specified below, is fulfilled;

1\> for this measurement, consider the serving cell indicated by the
*measObjectNR* associated to this event.

Inequality A2-1 (Entering condition)

*Ms + Hys \< Thresh*

Inequality A2-2 (Leaving condition)

*Ms -- Hys \> Thresh*

The variables in the formula are defined as follows:

***Ms*** is the measurement result of the serving cell, not taking into
account any offsets.

***Hys*** is the hysteresis parameter for this event (i.e. *hysteresis*
as defined within *reportConfigNR* for this event).

***Thresh*** is the threshold parameter for this event (i.e.
*a2-Threshold* as defined within *reportConfigNR* for this event).

***Ms*** is expressed in dBm in case of RSRP, or in dB in case of RSRQ
and RS-SINR.

***Hys*** is expressed in dB.

***Thresh*** is expressed in the same unit as ***Ms***.

\[TS 38.331, clause 5.3.5.9\]

The UE shall:

...

1\> if the received *otherConfig* includes the *obtainCommonLocation*:

2\> include available detailed location information for any subsequent
measurement report or any subsequent RLF report and
SCGFailureInformation;

\[TS 38.331, clause 6.3.4\]

+----------------------------------------------------------------------+
| ***obtainCommonLocation***                                           |
|                                                                      |
| **Requests the UE to attempt to have detailed location information   |
| available using GNSS. NR configures the field if                     |
| *includeCommonLocationInfo* is configured for one or more            |
| measurements.**                                                      |
+----------------------------------------------------------------------+

\[TS 38.331, clause 5.5.5.1\]

...

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

1\> set the *measId* to the measurement identity that triggered the
measurement reporting;

...

1\> if there is at least one applicable neighbouring cell to report:

...

1\> if the *includeCommonLocationInfo* is configured in the
corresponding *reportConfig* for this *measId* and detailed location
information that has not been reported is available, set the content of
*commonLocationInfo* of the *locationInfo* as follows:

2\> include the *locationTimestamp*;

2\> include the *locationCoordinate*, if available;

2\> include the *velocityEstimate*, if available;

2\> include the *locationError*, if available;

2\> include the *locationSource*, if available;

2\> if available, include the *gnss-TOD-msec*,

...

1\> increment the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* by 1;

1\> stop the periodical reporting timer, if running;

1\> if the *numberOfReportsSent* as defined within the
*VarMeasReportList* for this *measId* is less than the *reportAmount* as
defined within the corresponding *reportConfig* for this *measId*:

2\> start the periodical reporting timer with the value of
*reportInterval* as defined within the corresponding *reportConfig* for
this *measId*;

1\> else:

2\> if the *reportType* is set to *periodical* or *cli-Periodical*:

3\> remove the entry within the *VarMeasReportList* for this *measId*;

3\> remove this *measId* from the *measIdList* within *VarMeasConfig*;

##### 8.1.6.1.1.1.3 Test description {#test-description-45 .H6}

##### 8.1.6.1.1.1.3.1 Pre-test conditions {#pre-test-conditions-45 .H6}

##### System Simulator: {#system-simulator-38 .H6}

\- NR Cell 1

##### Preamble: {#preamble-34 .H6}

\- The UE\'s positioning engine (e.g. standalone GNSS receiver) should
be provided with any necessary stimulus to allow it to provide the
position. This shall be done by use of the test function Update UE
Location Information defined in TS 38.509 \[6\], if supported by the UE
according to pc\_UpdateUE\_LocationInformation. Otherwise, or in
addition any other suitable method may also be used.

\- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
4.4A on NR Cell 1.

##### 8.1.6.1.1.1.3.2 Test procedure sequence {#test-procedure-sequence-45 .H6}

Table 8.1.6.1.1.1.3.2-1 and Table 8.1.6.1.1.1.3.2-1a illustrate the
downlink power levels to be applied for NR Cell 1 at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after the preamble, while rows marked \"T1\" and \"T2\" are
to be applied subsequently. The exact instants on which these values
shall be applied are described in the texts in this clause.

Table 8.1.6.1.1.1.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                       |
+====+===========+=========+===========+==============================+
| T0 | SS/PBCH   | dBm/SCS | -78       | Power level is such that *Ms |
|    |           |         |           | \> Thresh + Hys*             |
|    | SSS EPRE  |         |           |                              |
+----+-----------+---------+-----------+------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -98       | Power level is such that     |
|    |           |         |           | entry condition for event A2 |
|    | SSS EPRE  |         |           | is satisfied *Ms + Hys \<    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+
| T2 | SS/PBCH   | dBm/SCS | -78       | Power level is such that     |
|    |           |         |           | exit condition for event A2  |
|    | SSS EPRE  |         |           | is satisfied *Ms - Hys \>    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+

Table 8.1.6.1.1.1.3.2-1a: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                       |
+====+===========+=========+===========+==============================+
| T0 | SS/PBCH   | dBm/SCS | -82       | Power level is such that *Ms |
|    |           |         |           | \> Thresh + Hys*             |
|    | SSS EPRE  |         |           |                              |
+----+-----------+---------+-----------+------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -100      | Power level is such that     |
|    |           |         |           | entry condition for event A2 |
|    | SSS EPRE  |         |           | is satisfied *Ms + Hys \<    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+
| T2 | SS/PBCH   | dBm/SCS | -82       | Power level is such that     |
|    |           |         |           | exit condition for event A2  |
|    | SSS EPRE  |         |           | is satisfied *Ms - Hys \>    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+

Table 8.1.6.1.1.1.3.2-2: Main behaviour

  St   Procedure                                                                                                                                                                 Message Sequence   TP                                     Verdict   
  ---- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ -------------------------------------- --------- ----
                                                                                                                                                                                 U - S              Message                                          
  1    The SS transmits an *RRCReconfiguration* message including *measConfig* to setup intra NR measurement and reporting for event A2 with *includeLocationInfo* configured.   \<\--              *NR RRC: RRCReconfiguration*           \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                 \--\>              *NR RRC: RRCReconfigurationComplete*   \-        \-
  3    SS re-adjusts the SS/PBCH EPRE level according to row \"T1\" in Table 8.1.6.1.1.1.3.2-1 or Table 8.1.6.1.1.1.3.2-1a.                                                      \-                 \-                                     \-        \-
  4    Check: Does the UE transmit a *MeasurementReport* message to report event A2 with the UE *commonLocationInfo* included?                                                   \--\>              *NR RRC: MeasurementReport*            1         P
  5    SS re-adjusts the SS/PBCH EPRE level according to row \"T2\" in Table 8.1.6.1.1.1.3.2-1 or Table 8.1.6.1.1.1.3.2-1a.                                                      \-                 \-                                     \-        \-
  6    Wait and ignore *MeasurementReport* messages for 5 s to allow change of power levels for NR Cell 1.                                                                       \-                 \-                                     \-        \-
  7    Check: Does the UE attempt to transmit *MeasurementReport* message within the next 10s??                                                                                  \-                                                        2         F

##### 8.1.6.1.1.1.3.3 Specific message contents {#specific-message-contents-46 .H6}

Table 8.1.6.1.1.1.3.3-1: ***RRCReconfiguration*** (step 1 Table
8.1.6.1.1.1.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS                            
  ---------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                          Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                     
  criticalExtensions CHOICE {                                                                           
  rrcReconfiguration SEQUENCE {                                                                         
  nonCriticalExtension SEQUENCE {                                                                       
  nonCriticalExtension SEQUENCE {                                                                       
  nonCriticalExtension SEQUENCE {                                                                       
  nonCriticalExtension SEQUENCE {                                                                       
  otherConfig-v1610 SEQUENCE {                                                                          
  obtainCommonLocation-r16                                                     true                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     

Table 8.1.6.1.1.1.3.3-2: MeasConfig (Table 8.1.6.1.1.1.3.3-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| Table 4.6.3-69  |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/Remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measConfig ::=  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObj         | 1 entry         |                 |           |
| ectToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| ma              |                 |                 |           |
| xNrofObjectId)) |                 |                 |           |
| OF              |                 |                 |           |
| Mea             |                 |                 |           |
| sObjectToAddMod |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| MeasObje        |                 | entry 1         |           |
| ctToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectId    | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObject      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectNR    | M               | T               |           |
|                 | easObjectNR(57) | hres=57(-100dBm |           |
|                 |                 |                 |           |
|                 |                 | ≤               |           |
|                 |                 | S               |           |
|                 |                 | S-RSRP\<-99dBm) |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportCon       | 1 entry         |                 |           |
| figToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..maxR        |                 |                 |           |
| eportConfigId)) |                 |                 |           |
| OF              |                 |                 |           |
| Repor           |                 |                 |           |
| tConfigToAddMod |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConf      |                 | entry 1         |           |
| igToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfig    | ReportC         |                 |           |
|                 | onfigNR-EventA2 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| mea             | 1 entry         |                 |           |
| sIdToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofMeasId)) |                 |                 |           |
| OF              |                 |                 |           |
| MeasIdToAddMod  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Meas            |                 | entry 1         |           |
| IdToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measId          | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectId    | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.6.1.1.1.3.3-3: ReportConfigNR-EventA2 (Table
8.1.6.1.1.1.3.3-2)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.3-142 |                 |                 |           |
| with condition  |                 |                 |           |
| EVENT\_A2       |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Re              |                 |                 |           |
| portConfigNR::= |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportType      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventTriggered  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventId CHOICE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventA2         |                 |                 | EVENT\_A2 |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| a2-Threshold    |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | 69              | -88dBm          | FR1       |
|                 |                 |                 |           |
|                 |                 | ≤               |           |
|                 |                 | SS-RSRP\<-87dBm |           |
+-----------------+-----------------+-----------------+-----------+
|                 | 65 +            | SS RSRP         | FR2       |
|                 | Delta(NRfs)     | corresponding   |           |
|                 |                 | to -91dBm       |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| hysteresis      | 0               | 0 dB            | FR1/FR2   |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportAmount    | r1              |                 |           |
+-----------------+-----------------+-----------------+-----------+
| includeCommonL  | True            |                 |           |
| ocationInfo-r16 |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| NOTE 1:         |                 |                 |           |
| Delta(NRfs) is  |                 |                 |           |
| derived based   |                 |                 |           |
| on calibration  |                 |                 |           |
| procedure       |                 |                 |           |
| defined in the  |                 |                 |           |
| TS 38.508-1     |                 |                 |           |
| \[4\], clause   |                 |                 |           |
| 6.1.3.3         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.6.1.1.1.3.3-4: MeasurementReport (steps 4, Table
8.1.6.1.1.1.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-5A                                                
  ---------------------------------------------------- ---------------------------------- --------- --------------------
  Information Element                                  Value/remark                       Comment   Condition
  MeasurementReport ::= SEQUENCE {                                                                  
  criticalExtensions CHOICE {                                                                       
  measurementReport SEQUENCE {                                                                      
  measResults SEQUENCE {                                                                            
  measId                                               1                                            Step 4
  measResultServingMOList SEQUENCE {                   1 entry                                      
  servCellId                                           ServCellIndex of NR Cell 1                   
  measResultServingCell SEQUENCE {                                                                  
  physCellId                                           Physical CellID of the NR Cell 1             
  measResult SEQUENCE {                                                                             
  cellResults SEQUENCE {                                                                            
  resultsSSB-Cell SEQUENCE {                                                                        
  rsrp                                                 (0..127)                                     
  rsrq                                                 (0..127)                                     
  sinr                                                 Not present                                  
                                                       (0..127)                                     pc\_ss\_SINR\_Meas
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  locationInfo-r16 SEQUENCE {                                                                       
  commonLocationInfo-r16                               Any allowed value                            
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 

###### 8.1.6.1.1.2 Immediate MDT / Measurement / Latency metrics for UL PDCP Packet Delay per DRB

##### 8.1.6.1.1.2.1 Test Purpose (TP) {#test-purpose-tp-47 .H6}

##### (1) {#section-90 .H6}

**with** {UE supporting UL PDCP Packet Delay per DRB measurement and in
RRC\_CONNECTED state}

**ensure that** {

**when** {UE receives *RRCReconfiguration* containing *ReportConfigNR*
IE with *ul-DelayValueConfig* IE set to "setup"}

**then** {UE sends the *RRCReconfigurationComplete* message}

}

##### (2) {#section-91 .H6}

**with** {UE in RRC\_CONNECTED and measurement configured for UL PDCP
Packet Delay per DRB and having DRBs established}

**ensure that** {\
**when** {UE determines that UL PDCP SDUs per DRB}

**then** {UE sends the *MeasurementReport* message with
ul-PDCP-DelayResultList for corresponding DRB}

}

##### (3) {#section-92 .H6}

**with** { UE in RRC\_CONNECTED and measurement configured for UL PDCP
Packet Delay per DRB}

**ensure that** {

**when** {UE receives *RRCReconfiguration* containing *ReportConfigNR*
IE with ul-DelayConfig IE set to "release")

**then** {UE stops monitoring the UL PDCP Packet Delay per DRB}

}

##### 8.1.6.1.1.2.2 Conformance requirements {#conformance-requirements-47 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clause 5.5.3.1, 5.5.4.1, 5.5.5.1 & TS 38.314,
clause 4.3.1.1

\[TS 38.331, clause 5.5.3.1\]

...

The UE shall:

...

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

...

2\> if the *ul-DelayValueConfig* is configured for the associated
*reportConfig*:

3\> ignore the *measObject;*

3\> for each of the configured DRBs*,* configure the PDCP layer to
perform corresponding average UL PDCP packet delay measurement per DRB;

...

\[TS 38.331, clause 5.5.4.1\]

If AS security has been activated successfully, the UE shall:

1\> for each *measId* included in the *measIdList* within
*VarMeasConfig*:

...

2\> if the corresponding *reportConfig* includes the
*ul-DelayValueConfig*:

3\> initiate the measurement reporting procedure, as specified in 5.5.5,
immediately after a first measurement result is provided by all lower
layers of the associated DRB identity;

...

\[TS 38.331, clause 5.5.5.1\]

...

For the *measId* for which the measurement reporting procedure was
triggered, the UE shall set the *measResults* within the
*MeasurementReport* message as follows:

...

1\> if average uplink PDCP delay values are available:

2\> set the *ul-PDCP-DelayValueResultList* to include the corresponding
average uplink PDCP delay values;

...

\[TS 38.314, clause 4.3.1.1\]

The objective of this measurement performed by UE is to measure Packet
Delay in Layer PDCP for QoS verification of MDT or for the QoS
monitoring as defined in TS 23.501.

Protocol Layer: PDCP

Table 4.3.1.1-1: Definition for UL PDCP Packet Average Delay per DRB per
UE

+------------+--------------------------------------------------------+
| Definition | PDCP Packet Delay in the UL per DRB. This measurement  |
|            | refers to PDCP queuing delay for DRBs in the UE, which |
|            | captures the delay from packet arrival at PDCP upper   |
|            | SAP until the UL grant to transmit the packet is       |
|            | available, which has included the delay the UE gets    |
|            | resources granted (from sending SR/RACH to get the     |
|            | first grant). The measurement is done separately per   |
|            | DRB.                                                   |
|            |                                                        |
|            | Detailed Definition:                                   |
|            |                                                        |
|            | $M\left( T,drbid \right) =                             |
|            | \left\lfloor \frac{\sum_{\forall i}^{}{\text{tDeliv}\l |
|            | eft( i,\ drbid \right) - \text{tArrival}\left( i,\ drb |
|            | id \right)}}{I\left( T \right)} \right\rfloor,\ $where |
|            |                                                        |
|            | explanations can be found in the table 4.3.1.1-2       |
|            | below.                                                 |
+------------+--------------------------------------------------------+

NOTE: UE measures UL PDCP queueing delay at DRB level. It is up to gNB
to convert DRB level delay to QoS level delay with the assumption that
all QoS flows mapped to the same DRB get the same QoS treatment, and it
is up to gNB to calculate QoS level delay if multiple DRBs mapped with
the same QoS.

Table 4.3.1.1-2: Parameter description for UL PDCP Packet Average Delay
per DRB per UE

+------------------------+--------------------------------------------+
| $$M(T,\text{drbid})$$  | PDCP average delay in the UL per DRB,      |
|                        | averaged during time period 𝑇. Unit: 0.1   |
|                        | ms.                                        |
|                        |                                            |
|                        | PDCP average delay in the UL per DRB is 1s |
|                        | if the actual value is larger than 1s.     |
+========================+============================================+
| $$\text{tArrival}(i)$$ | The point in time when the UL PDCP SDU i   |
|                        | arrivals at PDCP upper SAP.                |
+------------------------+--------------------------------------------+
| $$\text{tDeliv}(i)$$   | The point in time when the UL MAC PDU k    |
|                        | including the first part of UL PDCP SDU i  |
|                        | is scheduled for transmission.             |
+------------------------+--------------------------------------------+
| $$i$$                  | A UL PDCP SDU that is received by the PDCP |
|                        | during time period 𝑇.                      |
+------------------------+--------------------------------------------+
| $$I(T)$$               | Total number of UL PDCP SDUs received      |
|                        | during time period 𝑇.                      |
+------------------------+--------------------------------------------+
| $$T$$                  | Time Period during which the measurement   |
|                        | is performed                               |
+------------------------+--------------------------------------------+
| $$\text{drbid}$$       | The identity of the measured DRB.          |
+------------------------+--------------------------------------------+

##### 8.1.6.1.1.2.3 Test description {#test-description-46 .H6}

##### 8.1.6.1.1.2.3.1 Pre-test conditions {#pre-test-conditions-46 .H6}

##### System Simulator: {#system-simulator-39 .H6}

\- NR Cell 1

##### UE: {#ue-35 .H6}

> \- None

##### Preamble: {#preamble-35 .H6}

\- The UE is in 5GS state 3N-A with one PDU session active according to
TS 38.508-1 \[4\], clause 4.4A.3 Table 4.4A.3-1.and using the message
condition UE TEST LOOP MODE B active. 3 DRBs are configured where DRB\#j
is defined as default DRB.

##### 8.1.6.1.1.2.3.2 Test procedure sequence {#test-procedure-sequence-46 .H6}

Table 8.1.6.1.1.2.3.2-1: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCReco      |         |    |
|    |              |              | nfiguration* |         |    |
|    | *RRCReco     |              |              |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    |              |              |              |         |    |
|    | including    |              |              |         |    |
|    | *MeasConfig* |              |              |         |    |
|    | to setup     |              |              |         |    |
|    | *ul-Delay    |              |              |         |    |
|    | ValueConfig* |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | The UE       | \--\>        | *NR RRC:     | 1       | P  |
|    | transmits an |              | RRC          |         |    |
|    |              |              | Reconfigurat |         |    |
|    | *RRC         |              | ionComplete* |         |    |
|    | Reconfigurat |              |              |         |    |
|    | ionComplete* |              |              |         |    |
|    | message      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
|    | EXCEPTION:   |              |              |         |    |
|    | In parallel  |              |              |         |    |
|    | with steps   |              |              |         |    |
|    | 3-9,         |              |              |         |    |
|    | parallel     |              |              |         |    |
|    | behaviour    |              |              |         |    |
|    | defined in   |              |              |         |    |
|    | table        |              |              |         |    |
|    | 8.1.6        |              |              |         |    |
|    | .1.1.2.3.2-3 |              |              |         |    |
|    | is executed  |              |              |         |    |
|    | to receive   |              |              |         |    |
|    | periodic     |              |              |         |    |
|    | measurement  |              |              |         |    |
|    | report.      |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | The SS       |              |              |         |    |
|    | transmits UL |              |              |         |    |
|    | grant to the |              |              |         |    |
|    | UE at every  |              |              |         |    |
|    | 5ms in PDCCH |              |              |         |    |
|    | occasion     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | The SS       |              |              |         |    |
|    | transmits an |              |              |         |    |
|    | IP Packet on |              |              |         |    |
|    | the          |              |              |         |    |
|    |              |              |              |         |    |
|    | data radio   |              |              |         |    |
|    | bearer       |              |              |         |    |
|    | associated   |              |              |         |    |
|    | with the     |              |              |         |    |
|    |              |              |              |         |    |
|    | dedicated    |              |              |         |    |
|    | 5GC bearer   |              |              |         |    |
|    | context \#2  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | The UE loop  |              |              |         |    |
|    | backs the IP |              |              |         |    |
|    | packet       |              |              |         |    |
|    | received in  |              |              |         |    |
|    | step 4 on    |              |              |         |    |
|    | DRB\#j+1     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5A | Check: Does  | \--\>        | *NR RRC:     | 2       | P  |
|    | the UE       |              | Measur       |         |    |
|    | transmit a   |              | ementReport* |         |    |
|    |              |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message      |              |              |         |    |
|    | containing   |              |              |         |    |
|    | UL-PDCP-Dela |              |              |         |    |
|    | yValueResult |              |              |         |    |
|    | with         |              |              |         |    |
|    | averageDelay |              |              |         |    |
|    | set to non   |              |              |         |    |
|    | zero value   |              |              |         |    |
|    | for DRB\#j+1 |              |              |         |    |
|    | and zero for |              |              |         |    |
|    | DRB\# j+2?   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | The SS       |              |              |         |    |
|    | transmits an |              |              |         |    |
|    | IP Packet on |              |              |         |    |
|    | the          |              |              |         |    |
|    |              |              |              |         |    |
|    | data radio   |              |              |         |    |
|    | bearer       |              |              |         |    |
|    | associated   |              |              |         |    |
|    | with the     |              |              |         |    |
|    |              |              |              |         |    |
|    | dedicated    |              |              |         |    |
|    | 5GC bearer   |              |              |         |    |
|    | context \#3  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | The UE loop  |              |              |         |    |
|    | backs the IP |              |              |         |    |
|    | packet       |              |              |         |    |
|    | received in  |              |              |         |    |
|    | step 6 on    |              |              |         |    |
|    | DRB\# j+2    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8  | Check: Does  | \--\>        | *Measur      | 2       | P  |
|    | the UE       |              | ementReport* |         |    |
|    | transmit a   |              |              |         |    |
|    |              |              |              |         |    |
|    | *Measur      |              |              |         |    |
|    | ementReport* |              |              |         |    |
|    | message      |              |              |         |    |
|    | containing   |              |              |         |    |
|    | UL-PDCP-Dela |              |              |         |    |
|    | yValueResult |              |              |         |    |
|    | for DRB\#    |              |              |         |    |
|    | j+1 and with |              |              |         |    |
|    | with         |              |              |         |    |
|    | averageDelay |              |              |         |    |
|    | set to non   |              |              |         |    |
|    | zero value   |              |              |         |    |
|    | DRB\# j+2    |              |              |         |    |
|    | and zero for |              |              |         |    |
|    | DRB\#j+1?    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|    | transmits an |              | RRCReco      |         |    |
|    |              |              | nfiguration* |         |    |
|    | *RRCReco     |              |              |         |    |
|    | nfiguration* |              |              |         |    |
|    | message      |              |              |         |    |
|    |              |              |              |         |    |
|    | including    |              |              |         |    |
|    | MeasConfig   |              |              |         |    |
|    | to release   |              |              |         |    |
|    | the          |              |              |         |    |
|    | *ul-Delay    |              |              |         |    |
|    | ValueConfig* |              |              |         |    |
|    | measurement  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 10 | The UE       | \--\>        | *NR RRC:     |         |    |
|    | transmits an |              | RRC          |         |    |
|    |              |              | Reconfigurat |         |    |
|    | *RRC         |              | ionComplete* |         |    |
|    | Reconfigurat |              |              |         |    |
|    | ionComplete* |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| \- | EXCEPTION:   | \-           | *-*          | \-      | \- |
|    | In parallel  |              |              |         |    |
|    | with steps   |              |              |         |    |
|    | 11-14,       |              |              |         |    |
|    | parallel     |              |              |         |    |
|    | behaviour    |              |              |         |    |
|    | defined in   |              |              |         |    |
|    | table        |              |              |         |    |
|    | 8.1.6        |              |              |         |    |
|    | .1.1.2.3.2-2 |              |              |         |    |
|    | is executed. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 11 | The SS       |              |              |         |    |
|    | transmits an |              |              |         |    |
|    | IP Packet on |              |              |         |    |
|    | the          |              |              |         |    |
|    |              |              |              |         |    |
|    | data radio   |              |              |         |    |
|    | bearer       |              |              |         |    |
|    | associated   |              |              |         |    |
|    | with the     |              |              |         |    |
|    |              |              |              |         |    |
|    | dedicated    |              |              |         |    |
|    | 5GC bearer   |              |              |         |    |
|    | context \#2  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 12 | The UE loop  |              |              |         |    |
|    | backs the IP |              |              |         |    |
|    | packet       |              |              |         |    |
|    | received in  |              |              |         |    |
|    | step 11 on   |              |              |         |    |
|    | DRB\# j+1    |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 13 | The SS       |              |              |         |    |
|    | transmits an |              |              |         |    |
|    | IP Packet on |              |              |         |    |
|    | the          |              |              |         |    |
|    |              |              |              |         |    |
|    | data radio   |              |              |         |    |
|    | bearer       |              |              |         |    |
|    | associated   |              |              |         |    |
|    | with the     |              |              |         |    |
|    |              |              |              |         |    |
|    | dedicated    |              |              |         |    |
|    | 5GC bearer   |              |              |         |    |
|    | context \#3  |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 14 | The UE loop  |              |              |         |    |
|    | backs the IP |              |              |         |    |
|    | packet       |              |              |         |    |
|    | received in  |              |              |         |    |
|    | step 13 on   |              |              |         |    |
|    | DRB\#j+2     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 15 | Void         | \-           | *-*          | \-      | \- |
+----+--------------+--------------+--------------+---------+----+

Table 8.1.6.1.1.2.3.2-2: Parallel behaviour

+--------+------------+------------+------------+------------+---+
| **St** | **P        | **Message  | **TP**     | *          |   |
|        | rocedure** | Sequence** |            | *Verdict** |   |
+========+============+============+============+============+===+
|        |            | **U - S**  | *          |            |   |
|        |            |            | *Message** |            |   |
+--------+------------+------------+------------+------------+---+
| 1      | Check:     | \--\>      | *Measurem  | 3          | F |
|        | Does the   |            | entReport* |            |   |
|        | UE         |            |            |            |   |
|        | transmit a |            |            |            |   |
|        |            |            |            |            |   |
|        | *Measurem  |            |            |            |   |
|        | entReport* |            |            |            |   |
|        | message    |            |            |            |   |
|        | containing |            |            |            |   |
|        | UL-PD      |            |            |            |   |
|        | CP-DelayVa |            |            |            |   |
|        | lueResult? |            |            |            |   |
+--------+------------+------------+------------+------------+---+

Table 8.1.6.1.1.2.3.2-3: Parallel behaviour

+--------+------------+------------+------------+------------+----+
| **St** | **P        | **Message  | **TP**     | *          |    |
|        | rocedure** | Sequence** |            | *Verdict** |    |
+========+============+============+============+============+====+
|        |            | **U - S**  | *          |            |    |
|        |            |            | *Message** |            |    |
+--------+------------+------------+------------+------------+----+
| 1      | The UE     | \--\>      | *Measurem  | \-         | \- |
|        | transmit a |            | entReport* |            |    |
|        |            |            |            |            |    |
|        | *Measurem  |            |            |            |    |
|        | entReport* |            |            |            |    |
|        | message    |            |            |            |    |
+--------+------------+------------+------------+------------+----+

##### 8.1.6.1.1.2.3.3 Specific message contents {#specific-message-contents-47 .H6}

Table 8.1.6.1.1.2.3.3-1: ***RRCReconfiguration*** (step 1 and 9, Table
8.1.6.1.1.2.3.2-1)

  ----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS
  ----------------------------------------------------------------------------

Table 8.1.6.1.1.2.3.3-2: MeasConfig (Table 8.1.6.1.1.2.3.3-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| Table 4.6.3-69  |                 |                 |           |
+=================+=================+=================+===========+
| Information     | Value/Remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measConfig ::=  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObj         | 1 entry         |                 |           |
| ectToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| ma              |                 |                 |           |
| xNrofObjectId)) |                 |                 |           |
| OF              |                 |                 |           |
| Mea             |                 |                 |           |
| sObjectToAddMod |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| MeasObje        |                 | entry 1         |           |
| ctToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectId    | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObject      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectNR    | M               | T               |           |
|                 | easObjectNR(57) | hres=57(-100dBm |           |
|                 |                 |                 |           |
|                 |                 | ≤               |           |
|                 |                 | S               |           |
|                 |                 | S-RSRP\<-99dBm) |           |
+-----------------+-----------------+-----------------+-----------+
|                 | MeasObjectNR(56 | SS RSRP         |           |
|                 | + Delta(NRfs))  | corresponding   |           |
|                 |                 | to -100dBm      |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportCon       | 1 entry         |                 |           |
| figToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..maxR        |                 |                 |           |
| eportConfigId)) |                 |                 |           |
| OF              |                 |                 |           |
| Repor           |                 |                 |           |
| tConfigToAddMod |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConf      |                 | entry 1         |           |
| igToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfig    | ReportConfigNR- |                 |           |
|                 | PERIODICAL      |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| mea             | 1 entry         |                 |           |
| sIdToAddModList |                 |                 |           |
| SEQUENCE (SIZE  |                 |                 |           |
| (1..            |                 |                 |           |
| maxNrofMeasId)) |                 |                 |           |
| OF              |                 |                 |           |
| MeasIdToAddMod  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Meas            |                 | entry 1         |           |
| IdToAddMod\[1\] |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measId          | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| measObjectId    | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportConfigId  | 1               |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.6.1.1.2.3.3-3: ReportConfigNR- PERIODICAL (Table
8.1.6.1.1.2.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-142 with condition PERIODICAL, MDT\_DELAY                            
  ------------------------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                                         Value/remark   Comment   Condition
  ReportConfigNR::= SEQUENCE {                                                                                         
  reportType CHOICE {                                                                                                  
  periodical SEQUENCE {                                                                                                
  ul-DelayValueConfig-r16 CHOICE {                                                                                     
  setup SEQUENCE {                                                                                                     Step1
  delay-DRBlist SEQUENCE (SIZE(1..maxDRB)) OF DRB-Identity {                                  2 entries                
  DRB-Identity\[1\]                                                                           j+1            entry 1   
  DRB-Identity\[2\]                                                                           j+2            entry 2   
  }                                                                                                                    
  }                                                                                                                    
  Release                                                                                     NULL                     Step9
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    

Table 8.1.6.1.1.2.3.3-4: MeasurementReport (steps 5A and 8, Table
8.1.6.1.1.2.3.2-1 and step 1, Table 8.1.6.1.1.2.3.2-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-5A                                                                                                                    
  ----------------------------------------------------------------------------------------------- ---------------------------------- ---------------------------------- -----------
  Information Element                                                                             Value/remark                       Comment                            Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                                      
  criticalExtensions CHOICE {                                                                                                                                           
  measurementReport SEQUENCE {                                                                                                                                          
  measResults SEQUENCE {                                                                                                                                                
  measId                                                                                          1                                                                     
  measResultServingMOList SEQUENCE {                                                              1 entry                                                               
  servCellId                                                                                      ServCellIndex of NR Cell 1                                            
  measResultServingCell SEQUENCE {                                                                                                                                      
  physCellId                                                                                      Physical CellID of the NR Cell 1                                      
  measResult SEQUENCE {                                                                                                                                                 
  cellResults SEQUENCE {                                                                                                                                                
  resultsSSB-Cell SEQUENCE {                                                                                                                                            
  rsrp                                                                                            (0..127)                                                              
  rsrq                                                                                            (0..127)                                                              
  sinr                                                                                            Not checked                                                           
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  ul-PDCP-DelayValueResultList-r16 SEQUENCE (SIZE (1..maxDRB)) OF UL-PDCP-DelayValueResult-r16{   2 entries                          Step 5A, Table 8.1.6.1.1.2.3.2-1   
  drb-Id-r16\[1\]                                                                                 j+1                                entry 1                            
  averageDelay-r16\[1\]                                                                           Any value other than 0                                                
  drb-Id-r16\[2\]                                                                                 j+2                                entry 2                            
  averageDelay-r16\[2\]                                                                           0                                                                     
  }                                                                                                                                                                     
  ul-PDCP-DelayValueResultList-r16 SEQUENCE (SIZE (1..maxDRB)) OF UL-PDCP-DelayValueResult-r16{   2 entries                          Step8, Table 8.1.6.1.1.2.3.2-1     
  drb-Id-r16\[1\]                                                                                 j+1                                entry 1                            
  averageDelay-r16\[1\]                                                                           0                                                                     
  drb-Id-r16\[2\]                                                                                 j+2                                entry 2                            
  averageDelay-r16\[2\]                                                                           Any value other than 0                                                
  }                                                                                                                                                                     
  ul-PDCP-DelayValueResultList-r16                                                                Present                            Step 1, Table 8.1.6.1.1.2.3.2-2    
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     

Table 8.1.6.1.1.2.3.3-5: RRCReconfiguration (Preamble, Table
8.1.6.1.1.2.3.3-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-13 with condition NR                                                                         
  ---------------------------------------------------------------------- ------------------------- ------------------------------------------- -----------
  Information Element                                                    Value/remark              Comment                                     Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                            
  criticalExtensions CHOICE {                                                                                                                  
  rrcReconfiguration SEQUENCE {                                                                                                                
  radioBearerConfig                                                      RadioBearerConfig-3DRBs                                               
  nonCriticalExtension SEQUENCE {                                                                                                              
  masterCellGroup                                                        CellGroupConfig-3DRBs     OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            
  }                                                                                                                                            

Table 8.1.6.1.1.2.3.3-6: RadioBearerConfig-3DRBs (Table
8.1.6.1.1.2.3.3-4)

  --------------------------------------------------------------------------------- ------------------------------------ -------------------------------------------------------------------------------------------------------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-132 and condition SRB2 and DRB1                                                                                                                                                       
  **Information Element**                                                           **Value/remark**                     **Comment**                                                                                                    **Condition**
  RadioBearerConfig ::= SEQUENCE {                                                                                                                                                                                                      
  drb-ToAddModList SEQUENCE (SIZE (1..maxDRB)) OF DRB-ToAddMod {                    3 entries                                                                                                                                           
  DRB-ToAddMod\[1\] SEQUENCE {                                                                                           entry 1                                                                                                        
  cnAssociation CHOICE {                                                                                                                                                                                                                
  sdap-Config::= SEQUENCE {                                                                                                                                                                                                             
  pdu-Session                                                                       PDU session ID                       Same as the PDU session ID in PDU SESSION ESTABLISHMENT REQUEST                                                
  defaultDRB                                                                        true                                                                                                                                                
  mappedQoS-FlowsToAdd SEQUENCE {                                                                                                                                                                                                       
  QFI                                                                               1                                                                                                                                                   
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  drb-Identity                                                                      DRB-Identity with Condition DRBj     j is the ID of the DRB established during the preamble which is allocated according to internal TTCN mapping   
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  DRB-ToAddMod\[2\] SEQUENCE                                                                                             entry 2                                                                                                        
  cnAssociation CHOICE {                                                                                                                                                                                                                
  sdap-Config SEQUENCE {                                                                                                                                                                                                                
  pdu-Session                                                                       PDU session ID                       Same as the PDU session ID in PDU SESSION ESTABLISHMENT REQUEST                                                
  defaultDRB                                                                        false                                                                                                                                               
  mappedQoS-FlowsToAdd SEQUENCE {                                                                                                                                                                                                       
  QFI                                                                               5                                                                                                                                                   
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  drb-Identity                                                                      DRB-Identity with Condition DRBj+1                                                                                                                  
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  DRB-ToAddMod\[3\] SEQUENCE                                                                                             entry 3                                                                                                        
  cnAssociation CHOICE {                                                                                                                                                                                                                
  sdap-Config SEQUENCE {                                                                                                                                                                                                                
  pdu-Session                                                                       PDU session ID                       Same as the PDU session ID in PDU SESSION ESTABLISHMENT REQUEST                                                
  defaultDRB                                                                        false                                                                                                                                               
  mappedQoS-FlowsToAdd SEQUENCE {                                                                                                                                                                                                       
  QFI                                                                               2                                                                                                                                                   
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  drb-Identity                                                                      DRB-Identity with Condition DRBj+2                                                                                                                  
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                                     
  --------------------------------------------------------------------------------- ------------------------------------ -------------------------------------------------------------------------------------------------------------- ---------------

Table 8.1.6.1.1.2.3.3-7: CellGroupConfig-3DRBs (Table 8.1.6.1.1.2.3.3-4)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.3-19 and condition SRB2\_DRB1                                                              
  ----------------------------------------------------------------------------- ------------------------------------------------ --------- -----------
  Information Element                                                           Value/remark                                     Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                           
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLC-ID)) OF RLC-BearerConfig {     4 entries                                                  
  RLC-BearerConfig\[1\]                                                         RLC-BearerConfig with condition SRB2             entry 1   
  RLC-BearerConfig\[2\]                                                         RLC-BearerConfig with conditions AM and DRBj     entry 2   
  RLC-BearerConfig\[3\]                                                         RLC-BearerConfig with conditions AM and DRBj+1   entry 3   
  RLC-BearerConfig\[3\]                                                         RLC-BearerConfig with conditions AM and DRBj+2   entry 4   
  }                                                                                                                                        
  }                                                                                                                                        

Table 8.1.6.1.1.2.3.3-8: PDU SESSION ESTABLISHMENT ACCEPT (Preamble)
(Table 8.1.6.1.1.2.3.3-1)

  Derivation Path: TS 38.508-1, table 4.7.2-2                                                                                                
  --------------------------------------------- ---------------------------------------------------------------------------------- --------- -----------
  Information Element                           Value/remark                                                                       Comment   Condition
  PDU session ID                                The same as the PDU session ID in PDU SESSION ESTABLISHMENT REQUEST                          
  Authorized QoS rules                          3 entries                                                                                    
  QoS rule \[1\]                                Reference QoS rule \#1 as defined in Table 4.8.2.1-1.                              QFI=1     
  QoS rule \[2\]                                Reference QoS rule \#4 as defined in Table 4.8.2.1-4 except DQR bit set to '0'B.   QFI=2     
  QoS rule \[3\]                                Reference QoS rule \#5 as defined in Table 4.8.2.1-5.                              QFI=5     
  Mapped EPS Bearer contexts                    Not Present                                                                                  
  Authorized QoS flow descriptions              3 entries                                                                                    
  QoS flow \[1\]                                Reference QoS flow \#1 as defined in Table8.1.5.4.1.3.3-7.                         QFI=1     
  QoS flow \[2\]                                Reference QoS flow \#2 as defined in Table8.1.5.4.1.3.3-8.                         QFI=2     
  QoS flow \[3\]                                Reference QoS flow \#3 as defined in Table 4.8.2.3-3.                              QFI=5     

##### 8.1.6.1.2 Logged MDT

###### 8.1.6.1.2.1 Logged MDT / RRC\_IDLE / Logging and reporting / Intra-frequency measurement

##### 8.1.6.1.2.1.1 Test Purpose (TP) {#test-purpose-tp-48 .H6}

##### (1) {#section-93 .H6}

**with** { UE in NR RRC\_IDLE state camping normally on an NR cell where
logged measurement is configured without areaConfiguration and the UE is
able to detect an NR intra-frequency cell }

**ensure that** {

**when** { T330 is running }

**then** { UE is logging serving cell idle mode measurements and
Intra-frequency neighbouring cell measurements }

}

##### (2) {#section-94 .H6}

**with** { UE in NR RRC\_IDLE state and UE has one or more logged
Intra-frequency neighbouring cell measurement entries stored in
VarLogMeasReport }

**ensure that** {

**when** { receiving RRCSetup message }

**then** { UE includes the logMeasAvailable IE in the RRCSetupComplete
message }

}

##### (3) {#section-95 .H6}

**with** { UE in NR RRC\_CONNECTED state and UE has one or more logged
Intra-frequency neighbouring cell measurement entries stored in
VarLogMeasReport }

**ensure that** {

**when** { receiving UEInformationRequest message }

**then** { UE transmits UEInformationResponse messages with
absoluteTimeStamp set equal to the value configured when the logged
measurement configuration was received and a relativeTimeStamp for each
logged measurement indicating the elapsed time since the logged
measurement configuration was received }

}

##### (4) {#section-96 .H6}

**with** { UE in NR RRC\_CONNECTED state and UE has one or more logged
Intra-frequency neighbouring cell measurement entries stored in
VarLogMeasReport }

**ensure that** {

**when** { receiving UEInformationRequest message }

**then** { UE transmits UEInformationResponse messages with
traceReference, traceRecordingSessionRef and tce-Id being set to same
values as configured when the logged measurement configuration was
received }

}

##### 8.1.6.1.2.1.2 Conformance requirements {#conformance-requirements-48 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3, 5.5a.3.2, 5.7.10.3
and 6.2.2. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical* in the
*VarLogMeasConfig*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*:

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in the *VarLogMeasConfig*;

2\> else if the *reportType* is set to *eventTriggered*, and *eventType*
is set to *outOfCoverage*:

3\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the UE is in any cell
selection state;

3\> perform the logging immediately upon transitioning from the any cell
selection state to the camped normally state;

2\> else if the *reportType* is set to *eventTriggered* and *eventType*
is set to *eventL1*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*;

4\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the conditions
indicated by the *eventL1* are met;

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if detailed location information became available during the last
logging interval, set the content of the *locationInfo* as in 5.3.3.7:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> set *anyCellSelectionDetected* to indicate the detection of no
suitable or no acceptable cell found;

4\> set the *servCellIdentity* to indicate global cell identity of the
last logged cell that the UE was camping on;

4\> set the *measResultServingCell* to include the quantities of the
last logged cell the UE was camping on;

3\> else:

4\> set the *servCellIdentity* to indicate global cell identity of the
cell the UE is camping on;

4\> set the *measResultServingCell* to include the quantities of the
cell the UE is camping on;

4\> if available, set the *measResultNeighCells*, in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements that became available during the last logging interval
for at most the following number of neighbouring cells: 6
intra-frequency and 3 inter-frequency neighbours per frequency as well
as 3 inter-RAT neighbours, per frequency/ set of frequencies per RAT and
according to the following:

5\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation in RRC\_IDLE or RRC\_INACTIVE,
which are performed in accordance with the performance requirements as
specified in TS 38.133 \[14\].

2\> when the memory reserved for the logged measurement information
becomes full, stop timer T330 and perform the same actions as performed
upon expiry of T330, as specified in 5.5a.1.4.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

\[TS 38.331, clause 6.2.2\]

##### -- LoggedMeasurementConfiguration {#loggedmeasurementconfiguration .H6}

The *LoggedMeasurementConfiguration* message is used to perform logging
of measurement results while in RRC\_IDLE or RRC\_INACTIVE. It is used
to transfer the logged measurement configuration for network performance
optimisation.

Signalling radio bearer: SRB1

RLC-SAP: AM

Logical channel: DCCH

Direction: Network to UE

***LoggedMeasurementConfiguration message***

\-- ASN1START

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-START

LoggedMeasurementConfiguration-r16 ::= SEQUENCE {

criticalExtensions CHOICE {

loggedMeasurementConfiguration-r16
LoggedMeasurementConfiguration-r16-IEs,

criticalExtensionsFuture SEQUENCE {}

}

}

LoggedMeasurementConfiguration-r16-IEs ::= SEQUENCE {

traceReference-r16 TraceReference-r16,

traceRecordingSessionRef-r16 OCTET STRING (SIZE (2)),

tce-Id-r16 OCTET STRING (SIZE (1)),

absoluteTimeInfo-r16 AbsoluteTimeInfo-r16,

areaConfiguration-r16 AreaConfiguration-r16 OPTIONAL, \--Need R

plmn-IdentityList-r16 PLMN-IdentityList2-r16 OPTIONAL, \--Need R

bt-NameList-r16 SetupRelease {BT-NameList-r16} OPTIONAL, \--Need M

wlan-NameList-r16 SetupRelease {WLAN-NameList-r16} OPTIONAL, \--Need M

sensor-NameList-r16 SetupRelease {Sensor-NameList-r16} OPTIONAL, \--Need
M

loggingDuration-r16 LoggingDuration-r16,

reportType CHOICE {

periodical LoggedPeriodicalReportConfig-r16,

eventTriggered LoggedEventTriggerConfig-r16,

\...

},

lateNonCriticalExtension OCTET STRING OPTIONAL,

nonCriticalExtension SEQUENCE {} OPTIONAL

}

LoggedPeriodicalReportConfig-r16 ::= SEQUENCE {

loggingInterval-r16 LoggingInterval-r16,

\...

}

LoggedEventTriggerConfig-r16 ::= SEQUENCE {

eventType-r16 EventType-r16,

loggingInterval-r16 LoggingInterval-r16,

\...

}

EventType-r16 ::= CHOICE {

outOfCoverage NULL,

eventL1 SEQUENCE {

l1-Threshold MeasTriggerQuantity,

hysteresis Hysteresis,

timeToTrigger TimeToTrigger

},

\...

}

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-STOP

\-- ASN1STOP

+----------------------------------------------------------------------+
| ***LoggedMeasurementConfiguration field descriptions***              |
+======================================================================+
| ***absoluteTimeInfo***                                               |
|                                                                      |
| *Indicates* the absolute time in the current cell.                   |
+----------------------------------------------------------------------+
| ***areaConfiguration***                                              |
|                                                                      |
| ***Used*** to **restrict the area in which the UE performs           |
| measurement logging to cells broadcasting either one of the included |
| cell identities or one of the included tracking area codes/          |
| frequencies**.                                                       |
+----------------------------------------------------------------------+
| ***eventType***                                                      |
|                                                                      |
| ***The value outOfCoverage indicates the UE to perform logging of    |
| measurements when the UE enters any cell selection state, and the    |
| value eventL1 indicates the UE to perform logging of measurements    |
| when the triggering condition (similar as event A2 as specified in   |
| 5.5.4.3) as configured in the event is met for the camping cell in   |
| camped normally state.***                                            |
+----------------------------------------------------------------------+
| ***plmn-IdentityList***                                              |
|                                                                      |
| **Indicates a set of PLMNs defining when the UE performs measurement |
| logging as well as the associated status indication and information  |
| retrieval i.e. the UE performs these actions when the RPLMN is part  |
| of this set of PLMNs.**                                              |
+----------------------------------------------------------------------+
| ***tce-Id***                                                         |
|                                                                      |
| ***Parameter Trace Collection Entity Id: See TS 32.422 \[52\].***    |
+----------------------------------------------------------------------+
| ***traceRecordingSessionRef***                                       |
|                                                                      |
| ***Parameter Trace Recording Session Reference: See TS 32.422        |
| \[52\].***                                                           |
+----------------------------------------------------------------------+
| ***reportType***                                                     |
|                                                                      |
| Parameter configures the type of MDT configuration, specifically     |
| Periodic MDT conifguraiton or Event Triggerd MDT configuration.      |
+----------------------------------------------------------------------+

##### 8.1.6.1.2.1.3 Test description {#test-description-47 .H6}

##### 8.1.6.1.2.1.3.1 Pre-test conditions {#pre-test-conditions-47 .H6}

System Simulator:

\- NR Cell 1 and NR Cell 11.

\- System information combination NR-2 as defined in TS 38.508-1\[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-36 .H6}

> \- None.

##### Preamble: {#preamble-36 .H6}

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.2.1.3.2 Test procedure sequence {#test-procedure-sequence-47 .H6}

Table 8.1.6.1.2.1.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. The configuration \"T0\" indicates the initial
conditions. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.2.1.3.2-1: Time instances of cell power level for FR1

+--------+----------+----------+----------+----------+----------+
|        | **Par    | **Unit** | **NR     | **NR     | **       |
|        | ameter** |          | Cell 1** | Cell     | Remark** |
|        |          |          |          | 11**     |          |
+========+==========+==========+==========+==========+==========+
| **T0** | SS/PBCH  | dBm/SCS  | -78      | -85      | NR Cell  |
|        |          |          |          |          | 1        |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+
| **T1** | SS/PBCH  | dBm/SCS  | -85      | -78      | NR Cell  |
|        |          |          |          |          | 11       |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+

Table 8.1.6.1.2.1.3.2-2: Time instances of cell power level for FR2

+--------+----------+----------+----------+----------+----------+
|        | **Par    | **Unit** | **NR     | **NR     | **       |
|        | ameter** |          | Cell 1** | Cell     | Remark** |
|        |          |          |          | 11**     |          |
+========+==========+==========+==========+==========+==========+
| **T0** | SS/PBCH  | dBm/SCS  | -82      | -91      | NR Cell  |
|        |          |          |          |          | 1        |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+
| **T1** | SS/PBCH  | dBm/SCS  | -91      | -82      | NR Cell  |
|        |          |          |          |          | 11       |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+

Table 8.1.6.1.2.1.3.2-3: Main behaviour

+-----------+-----------+-----------+-----------+---------+----+
| St        | Procedure | Message   | TP        | Verdict |    |
|           |           | Sequence  |           |         |    |
+===========+===========+===========+===========+=========+====+
|           |           | U - S     | Message   |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 1         | SS        | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *Logg     |         |    |
|           | a         |           | edMeasure |         |    |
|           | *Logg     |           | mentConfi |         |    |
|           | edMeasure |           | guration* |         |    |
|           | mentConfi |           |           |         |    |
|           | guration* |           |           |         |    |
|           | message   |           |           |         |    |
|           | to        |           |           |         |    |
|           | configure |           |           |         |    |
|           | the UE to |           |           |         |    |
|           | perform   |           |           |         |    |
|           | logging   |           |           |         |    |
|           | of        |           |           |         |    |
|           | me        |           |           |         |    |
|           | asurement |           |           |         |    |
|           | results   |           |           |         |    |
|           | while in  |           |           |         |    |
|           | R         |           |           |         |    |
|           | RC\_IDLE. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 2         | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | RR        |         |    |
|           | an        |           | CRelease* |         |    |
|           | *RR       |           |           |         |    |
|           | CRelease* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 3         | Wait 5s   | \-        | *-*       | \-      | \- |
|           | to allow  |           |           |         |    |
|           | UE to     |           |           |         |    |
|           | activate  |           |           |         |    |
|           | logging.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 4         | The SS    | \-        | *-*       | \-      | \- |
|           | changes   |           |           |         |    |
|           | NR Cell 1 |           |           |         |    |
|           | and NR    |           |           |         |    |
|           | Cell 11   |           |           |         |    |
|           | levels    |           |           |         |    |
|           | according |           |           |         |    |
|           | to the    |           |           |         |    |
|           | row       |           |           |         |    |
|           | \"T1\" in |           |           |         |    |
|           | table     |           |           |         |    |
|           | 8.        |           |           |         |    |
|           | 1.6.1.2.1 |           |           |         |    |
|           | .3.2-1/2. |           |           |         |    |
|           |           |           |           |         |    |
|           | (Note 1)  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 5         | The UE    | \--\>     | NR RRC:   | \-      | \- |
|           | transmits |           | *RRCSetu  |         |    |
|           | an        |           | pRequest* |         |    |
|           | *RRCSetu  |           |           |         |    |
|           | pRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 11   |           |           |         |    |
|           | to        |           |           |         |    |
|           | initiate  |           |           |         |    |
|           | a         |           |           |         |    |
|           | tracking  |           |           |         |    |
|           | area      |           |           |         |    |
|           | update    |           |           |         |    |
|           | p         |           |           |         |    |
|           | rocedure. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 6         | SS        | \<\--     | NR RRC:   | \-      | \- |
|           | transmits |           | *         |         |    |
|           | an        |           | RRCSetup* |         |    |
|           | *         |           |           |         |    |
|           | RRCSetup* |           |           |         |    |
|           | message.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 7         | Check:    | \--\>     | NR RRC:   | 2       | P  |
|           | Does the  |           | *RRCSetup |         |    |
|           | UE        |           | Complete* |         |    |
|           | include   |           |           |         |    |
|           | the IE    |           | 5GMM:     |         |    |
|           | *logMeasA |           | *REG      |         |    |
|           | vailable* |           | ISTRATION |         |    |
|           | in the    |           | REQUEST*  |         |    |
|           | *RRCSetup |           |           |         |    |
|           | Complete* |           |           |         |    |
|           | message?  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 8-10      | Steps 4   | \-        | *-*       | \-      | \- |
|           | to 6a1 of |           |           |         |    |
|           | generic   |           |           |         |    |
|           | test      |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.5      |           |           |         |    |
|           | 08-1\[4\] |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.        |           |           |         |    |
|           | 9.5.2.2-1 |           |           |         |    |
|           | are       |           |           |         |    |
|           | performed |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 11.  |           |           |         |    |
|           |           |           |           |         |    |
|           | NOTE: The |           |           |         |    |
|           | UE        |           |           |         |    |
|           | performs  |           |           |         |    |
|           | a         |           |           |         |    |
|           | REG       |           |           |         |    |
|           | ISTRATION |           |           |         |    |
|           | procedure |           |           |         |    |
|           | update    |           |           |         |    |
|           | the       |           |           |         |    |
|           | reg       |           |           |         |    |
|           | istration |           |           |         |    |
|           | of the    |           |           |         |    |
|           | actual    |           |           |         |    |
|           | tracking  |           |           |         |    |
|           | area and  |           |           |         |    |
|           | the RRC   |           |           |         |    |
|           | c         |           |           |         |    |
|           | onnection |           |           |         |    |
|           | is        |           |           |         |    |
|           | released. |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 11-18     | Steps 1   | \-        | *-*       | \-      | \- |
|           | to 8 of   |           |           |         |    |
|           | the       |           |           |         |    |
|           | generic   |           |           |         |    |
|           | radio     |           |           |         |    |
|           | bearer    |           |           |         |    |
|           | esta      |           |           |         |    |
|           | blishment |           |           |         |    |
|           | procedure |           |           |         |    |
|           | in TS     |           |           |         |    |
|           | 38.508-1  |           |           |         |    |
|           | \[4\],    |           |           |         |    |
|           | Table     |           |           |         |    |
|           | 4.5.4.2-3 |           |           |         |    |
|           | are       |           |           |         |    |
|           | executed  |           |           |         |    |
|           | to        |           |           |         |    |
|           | suc       |           |           |         |    |
|           | cessfully |           |           |         |    |
|           | complete  |           |           |         |    |
|           | the       |           |           |         |    |
|           | service   |           |           |         |    |
|           | request   |           |           |         |    |
|           | procedure |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 11.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 19        | The SS    | \<\--     | *NR RRC:  | \-      | \- |
|           | transmits |           | UEI       |         |    |
|           | a         |           | nformatio |         |    |
|           | *UEI      |           | nRequest* |         |    |
|           | nformatio |           |           |         |    |
|           | nRequest* |           |           |         |    |
|           | message   |           |           |         |    |
|           | on NR     |           |           |         |    |
|           | Cell 11.  |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| 20        | Check:    | \--\>     | *NR RRC:  | 1, 3, 4 | P  |
|           | Does the  |           | UEIn      |         |    |
|           | UE        |           | formation |         |    |
|           | transmit  |           | Response* |         |    |
|           | a         |           |           |         |    |
|           | *UEI      |           |           |         |    |
|           | nformatio |           |           |         |    |
|           | nResponse |           |           |         |    |
|           | message   |           |           |         |    |
|           | with the  |           |           |         |    |
|           | IEs       |           |           |         |    |
|           | absoluteT |           |           |         |    |
|           | imeStamp, |           |           |         |    |
|           | traceRe   |           |           |         |    |
|           | ference*, |           |           |         |    |
|           | *traceRe  |           |           |         |    |
|           | cordingSe |           |           |         |    |
|           | ssionRef* |           |           |         |    |
|           | and       |           |           |         |    |
|           | *tce-Id*  |           |           |         |    |
|           | set to    |           |           |         |    |
|           | same      |           |           |         |    |
|           | value as  |           |           |         |    |
|           | received  |           |           |         |    |
|           | in the    |           |           |         |    |
|           | *Log      |           |           |         |    |
|           | gedMeasur |           |           |         |    |
|           | ementConf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | message   |           |           |         |    |
|           | in step   |           |           |         |    |
|           | 1; and a  |           |           |         |    |
|           | LogMeas   |           |           |         |    |
|           | InfoList* |           |           |         |    |
|           | with at   |           |           |         |    |
|           | least two |           |           |         |    |
|           | entries   |           |           |         |    |
|           | with      |           |           |         |    |
|           | serving   |           |           |         |    |
|           | cell idle |           |           |         |    |
|           | mode      |           |           |         |    |
|           | mea       |           |           |         |    |
|           | surements |           |           |         |    |
|           | and where |           |           |         |    |
|           | in at     |           |           |         |    |
|           | least one |           |           |         |    |
|           | of the    |           |           |         |    |
|           | entries   |           |           |         |    |
|           | the IE    |           |           |         |    |
|           | *measResu |           |           |         |    |
|           | ltListNR* |           |           |         |    |
|           | include a |           |           |         |    |
|           | nei       |           |           |         |    |
|           | ghbouring |           |           |         |    |
|           | cell      |           |           |         |    |
|           | me        |           |           |         |    |
|           | asurement |           |           |         |    |
|           | of NR     |           |           |         |    |
|           | Cell 11;  |           |           |         |    |
|           | and where |           |           |         |    |
|           | the       |           |           |         |    |
|           | relative  |           |           |         |    |
|           | TimeStamp |           |           |         |    |
|           | is        |           |           |         |    |
|           | increased |           |           |         |    |
|           | between   |           |           |         |    |
|           | the       |           |           |         |    |
|           | s         |           |           |         |    |
|           | ubsequent |           |           |         |    |
|           | LogMea    |           |           |         |    |
|           | sInfoList |           |           |         |    |
|           | entries   |           |           |         |    |
|           | by at     |           |           |         |    |
|           | least the |           |           |         |    |
|           | value of  |           |           |         |    |
|           | c         |           |           |         |    |
|           | onfigured |           |           |         |    |
|           | *logging  |           |           |         |    |
|           | Interval* |           |           |         |    |
|           | in the    |           |           |         |    |
|           | received  |           |           |         |    |
|           | *Log      |           |           |         |    |
|           | gedMeasur |           |           |         |    |
|           | ementConf |           |           |         |    |
|           | iguration |           |           |         |    |
|           | message   |           |           |         |    |
|           | in step   |           |           |         |    |
|           | 1*.       |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+
| Note 1:   |           |           |           |         |    |
| The       |           |           |           |         |    |
| change of |           |           |           |         |    |
| power     |           |           |           |         |    |
| levels is |           |           |           |         |    |
| to        |           |           |           |         |    |
| trigger a |           |           |           |         |    |
| cell      |           |           |           |         |    |
| re-       |           |           |           |         |    |
| selection |           |           |           |         |    |
| procedure |           |           |           |         |    |
| to make   |           |           |           |         |    |
| sure that |           |           |           |         |    |
| the UE is |           |           |           |         |    |
| logging   |           |           |           |         |    |
| nei       |           |           |           |         |    |
| ghbouring |           |           |           |         |    |
| cell      |           |           |           |         |    |
| mea       |           |           |           |         |    |
| surements |           |           |           |         |    |
| (logging  |           |           |           |         |    |
| inte      |           |           |           |         |    |
| rval=2.56 |           |           |           |         |    |
| seconds)  |           |           |           |         |    |
| of Cell   |           |           |           |         |    |
| NR 11     |           |           |           |         |    |
| while     |           |           |           |         |    |
| t-Re      |           |           |           |         |    |
| selection |           |           |           |         |    |
| timer is  |           |           |           |         |    |
| running   |           |           |           |         |    |
| (7        |           |           |           |         |    |
| seconds). |           |           |           |         |    |
+-----------+-----------+-----------+-----------+---------+----+

##### 8.1.6.1.2.1.3.3 Specific message contents {#specific-message-contents-48 .H6}

Table 8.1.6.1.2.1.3.3-1: *SIB2* for NR cell 1 (preamble*)*

  --------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], table 4.6.2-1                            
  Information Element                                 Value/remark   Comment   Condition
  SIB2 ::= SEQUENCE {                                                          
  intraFreqCellReselectionInfo SEQUENCE {                                      
  t-ReselectionNR                                     7              seconds   
  }                                                                            
  }                                                                            
  --------------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.2.1.3.3-2: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.1.3.2-3)

  -------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], table 4.6.1-5AA with condition PERIODICAL
  -------------------------------------------------------------------------------

Table 8.1.6.1.2.1.3.3-3: *RRCSetupComplete* (steps 7 and 14, Table
8.1.6.1.2.1.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.2.1.3.3-4: *UEInformationRequest* (step 19, Table
8.1.6.1.2.1.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.1.3.3-5: *UEInformationResponse* (step 20, Table
8.1.6.1.2.1.3.2-3)

+----------------------+----------------------+---------+-----------+
| Derivation path: TS  |                      |         |           |
| 38.508-1 \[4\],      |                      |         |           |
| table 4.6.1-32B      |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| UEInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| criticalExtensions   |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ueInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasReport-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| a                    | Same value as sent   |         |           |
| bsoluteTimeStamp-r16 | by SS in             |         |           |
|                      | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| traceReference-r16   |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| plmn-Identity-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| mcc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (3)) OF              | by SS in             |         |           |
| MCC-NMC-Digit        | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| mnc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (2..3)) OF           | by SS in             |         |           |
| MCC-NMC-Digit        | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceId-r16          | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceRec             | Same value as sent   |         |           |
| ordingSessionRef-r16 | by SS in             |         |           |
|                      | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| tce-Id-r16           | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasInfoList-r16  | At least 2 entries   |         |           |
| SEQUENCE (SIZE       | where at least one   |         |           |
| (1..ma               | entry complies to    |         |           |
| xLogMeasReport-r16)) | entry with index 'x' |         |           |
| OF LogMeasInfo-r16   | below. SS records    |         |           |
| SEQUENCE {           | the                  |         |           |
|                      | relativeTimeStamp    |         |           |
|                      | value for each entry |         |           |
+----------------------+----------------------+---------+-----------+
| LogMeasInfo-r16\[x\] |                      | entry x |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| locationInfo-r16     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| r                    | SS record the value  |         |           |
| elativeTimeStamp-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| servCellIdentity-r16 | Same as NR Cell 1    |         |           |
+----------------------+----------------------+---------+-----------+
| m                    |                      |         |           |
| easResultServCell-16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of NR Cell 1         |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB SEQUENCE  |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Index       | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Results     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB      | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| meas                 |                      |         |           |
| ResultNeighCells-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measR                | 1 entry              |         |           |
| esultNeighCellListNR |                      |         |           |
| SEQUENCE (SIZE       |                      |         |           |
| (1..maxFreq)) OF     |                      |         |           |
| Meas                 |                      |         |           |
| ResultLogging2NR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| carrierFreq-r16      | Same as NR Cell 11   |         |           |
+----------------------+----------------------+---------+-----------+
| mea                  | 1 entry              |         |           |
| sResultListLoggingNR |                      |         |           |
|                      |                      |         |           |
| -r16 SEQUENCE (SIZE  |                      |         |           |
| (1..maxCellReport))  |                      |         |           |
| OF                   |                      |         |           |
| Mea                  |                      |         |           |
| sResultLoggingNR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResu             |                      | entry 1 |           |
| ltLoggingNR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId-r16       | Same as NR Cell 11   |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of NR Cell 11        |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB-r16  | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measResu             | Not present          |         |           |
| ltNeighCellListEUTRA |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| anyCellS             | Not present          |         |           |
| electionDetected-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasAvailable-r16 | Not present          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

###### 8.1.6.1.2.2 Logged MDT / RRC\_INACTIVE / Logging and reporting / Inter-frequency measurement

##### 8.1.6.1.2.2.1 Test Purpose (TP) {#test-purpose-tp-49 .H6}

##### (1) {#section-97 .H6}

**with** { UE in NR RRC\_INACTIVE state camping normally on an NR cell
where logged measurement is configured without areaConfiguration and the
UE is able to detect an NR inter-frequency cell }

**ensure that** {

**when** { T330 is running }

**then** { UE is logging serving cell measurements and Inter-frequency
neighbouring cell measurements }

}

##### (2) {#section-98 .H6}

**with** { UE in NR RRC\_INACTIVE state and has sent RRCResumeRequest
message and UE has one or more logged Inter-frequency neighbouring cell
measurement entries stored in VarLogMeasReport }

**ensure that** {

**when** { receiving RRCResume message }

**then** { UE includes the logMeasAvailable IE in the RRCResumeComplete
message }

}

##### (3) {#section-99 .H6}

**with** { UE in NR RRC\_CONNECTED state and UE has one or more logged
Inter-frequency neighbouring cell measurement entries stored in
VarLogMeasReport }

**ensure that** {

**when** { receiving UEInformationRequest message }

**then** { UE transmits UEInformationResponse messages with a
logMeasReport with Inter-frequency neighbouring cell measurements }

}

##### (4) {#section-100 .H6}

**with** { UE in NR RRC\_CONNECTED state and UE has one or more logged
Inter-frequency neighbouring cell measurement entries stored in
VarLogMeasReport }

**ensure that** {

**when** { receiving UEInformationRequest message and the UE has not
transferred the total log in the UEInformationResponse message }

**then** { UE transmits UEInformationResponse messages with the
logMeasAvailable IE }

}

##### 8.1.6.1.2.2.2 Conformance requirements {#conformance-requirements-49 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.13.4, 5 5.5a.1.3, 5.5a.3.2,
5.7.10.3 and 6.2.2. Unless otherwise stated these are Rel-16
requirements. \[TS 38.331, clause 5.3.13.4\]

The UE shall:

1\> stop timer T319;

1\> stop timer T380, if running;

...

1\> set the content of the of *RRCResumeComplete* message as follows:

2\> if the upper layer provides NAS PDU, set the *dedicatedNAS-Message*
to include the information received from upper layers;

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCResumeComplete* message*;*

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCResumeComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCResumeComplete*
message;

...

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical* in the
*VarLogMeasConfig*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*:

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in the *VarLogMeasConfig*;

2\> else if the *reportType* is set to *eventTriggered*, and *eventType*
is set to *outOfCoverage*:

3\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the UE is in any cell
selection state;

3\> perform the logging immediately upon transitioning from the any cell
selection state to the camped normally state;

2\> else if the *reportType* is set to *eventTriggered* and *eventType*
is set to *eventL1*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*;

4\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the conditions
indicated by the *eventL1* are met;

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if detailed location information became available during the last
logging interval, set the content of the *locationInfo* as in 5.3.3.7:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> set *anyCellSelectionDetected* to indicate the detection of no
suitable or no acceptable cell found;

4\> set the *servCellIdentity* to indicate global cell identity of the
last logged cell that the UE was camping on;

4\> set the *measResultServingCell* to include the quantities of the
last logged cell the UE was camping on;

3\> else:

4\> set the *servCellIdentity* to indicate global cell identity of the
cell the UE is camping on;

4\> set the *measResultServingCell* to include the quantities of the
cell the UE is camping on;

4\> if available, set the *measResultNeighCells*, in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements that became available during the last logging interval
for at most the following number of neighbouring cells: 6
intra-frequency and 3 inter-frequency neighbours per frequency as well
as 3 inter-RAT neighbours, per frequency/ set of frequencies per RAT and
according to the following:

5\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation in RRC\_IDLE or RRC\_INACTIVE,
which are performed in accordance with the performance requirements as
specified in TS 38.133 \[14\].

2\> when the memory reserved for the logged measurement information
becomes full, stop timer T330 and perform the same actions as performed
upon expiry of T330, as specified in 5.5a.1.4.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

\[TS 38.331, clause 6.2.2\]

##### -- LoggedMeasurementConfiguration {#loggedmeasurementconfiguration-1 .H6}

The *LoggedMeasurementConfiguration* message is used to perform logging
of measurement results while in RRC\_IDLE or RRC\_INACTIVE. It is used
to transfer the logged measurement configuration for network performance
optimisation.

Signalling radio bearer: SRB1

RLC-SAP: AM

Logical channel: DCCH

Direction: Network to UE

***LoggedMeasurementConfiguration message***

\-- ASN1START

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-START

LoggedMeasurementConfiguration-r16 ::= SEQUENCE {

criticalExtensions CHOICE {

loggedMeasurementConfiguration-r16
LoggedMeasurementConfiguration-r16-IEs,

criticalExtensionsFuture SEQUENCE {}

}

}

LoggedMeasurementConfiguration-r16-IEs ::= SEQUENCE {

traceReference-r16 TraceReference-r16,

traceRecordingSessionRef-r16 OCTET STRING (SIZE (2)),

tce-Id-r16 OCTET STRING (SIZE (1)),

absoluteTimeInfo-r16 AbsoluteTimeInfo-r16,

areaConfiguration-r16 AreaConfiguration-r16 OPTIONAL, \--Need R

plmn-IdentityList-r16 PLMN-IdentityList2-r16 OPTIONAL, \--Need R

bt-NameList-r16 SetupRelease {BT-NameList-r16} OPTIONAL, \--Need M

wlan-NameList-r16 SetupRelease {WLAN-NameList-r16} OPTIONAL, \--Need M

sensor-NameList-r16 SetupRelease {Sensor-NameList-r16} OPTIONAL, \--Need
M

loggingDuration-r16 LoggingDuration-r16,

reportType CHOICE {

periodical LoggedPeriodicalReportConfig-r16,

eventTriggered LoggedEventTriggerConfig-r16,

\...

},

lateNonCriticalExtension OCTET STRING OPTIONAL,

nonCriticalExtension SEQUENCE {} OPTIONAL

}

LoggedPeriodicalReportConfig-r16 ::= SEQUENCE {

loggingInterval-r16 LoggingInterval-r16,

\...

}

LoggedEventTriggerConfig-r16 ::= SEQUENCE {

eventType-r16 EventType-r16,

loggingInterval-r16 LoggingInterval-r16,

\...

}

EventType-r16 ::= CHOICE {

outOfCoverage NULL,

eventL1 SEQUENCE {

l1-Threshold MeasTriggerQuantity,

hysteresis Hysteresis,

timeToTrigger TimeToTrigger

},

\...

}

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-STOP

\-- ASN1STOP

+----------------------------------------------------------------------+
| ***LoggedMeasurementConfiguration field descriptions***              |
+======================================================================+
| ***absoluteTimeInfo***                                               |
|                                                                      |
| *Indicates* the absolute time in the current cell.                   |
+----------------------------------------------------------------------+
| ***areaConfiguration***                                              |
|                                                                      |
| ***Used*** to **restrict the area in which the UE performs           |
| measurement logging to cells broadcasting either one of the included |
| cell identities or one of the included tracking area codes/          |
| frequencies**.                                                       |
+----------------------------------------------------------------------+
| ***eventType***                                                      |
|                                                                      |
| ***The value outOfCoverage indicates the UE to perform logging of    |
| measurements when the UE enters any cell selection state, and the    |
| value eventL1 indicates the UE to perform logging of measurements    |
| when the triggering condition (similar as event A2 as specified in   |
| 5.5.4.3) as configured in the event is met for the camping cell in   |
| camped normally state.***                                            |
+----------------------------------------------------------------------+
| ***plmn-IdentityList***                                              |
|                                                                      |
| **Indicates a set of PLMNs defining when the UE performs measurement |
| logging as well as the associated status indication and information  |
| retrieval i.e. the UE performs these actions when the RPLMN is part  |
| of this set of PLMNs.**                                              |
+----------------------------------------------------------------------+
| ***tce-Id***                                                         |
|                                                                      |
| ***Parameter Trace Collection Entity Id: See TS 32.422 \[52\].***    |
+----------------------------------------------------------------------+
| ***traceRecordingSessionRef***                                       |
|                                                                      |
| ***Parameter Trace Recording Session Reference: See TS 32.422        |
| \[52\].***                                                           |
+----------------------------------------------------------------------+
| ***reportType***                                                     |
|                                                                      |
| Parameter configures the type of MDT configuration, specifically     |
| Periodic MDT conifguraiton or Event Triggerd MDT configuration.      |
+----------------------------------------------------------------------+

##### 8.1.6.1.2.2.3 Test description {#test-description-48 .H6}

##### 8.1.6.1.2.2.3.1 Pre-test conditions {#pre-test-conditions-48 .H6}

System Simulator:

\- NR Cell 1 is the serving cell and NR Cell 3 is a suitable neighbour
inter-frequency cell.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-37 .H6}

> \- None.

##### Preamble: {#preamble-37 .H6}

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.2.2.3.2 Test procedure sequence {#test-procedure-sequence-48 .H6}

Table 8.1.6.1.2.2.3.2-1: Main behaviour

+----+--------------+--------------+--------------+---------+----+
| St | Procedure    | Message      | TP           | Verdict |    |
|    |              | Sequence     |              |         |    |
+====+==============+==============+==============+=========+====+
|    |              | U - S        | Message      |         |    |
+----+--------------+--------------+--------------+---------+----+
| 1  | SS transmits | \<\--        | *NR RRC:     | \-      | \- |
|    | a            |              | LoggedM      |         |    |
|    | *LoggedM     |              | easurementCo |         |    |
|    | easurementCo |              | nfiguration* |         |    |
|    | nfiguration* |              |              |         |    |
|    | message with |              |              |         |    |
|    | log          |              |              |         |    |
|    | gingInterval |              |              |         |    |
|    | is set to    |              |              |         |    |
|    | '320ms' to   |              |              |         |    |
|    | configure    |              |              |         |    |
|    | the UE to    |              |              |         |    |
|    | perform      |              |              |         |    |
|    | logging of   |              |              |         |    |
|    | measurement  |              |              |         |    |
|    | results      |              |              |         |    |
|    | while in     |              |              |         |    |
|    | RR           |              |              |         |    |
|    | C\_INACTIVE. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 2  | The SS       | \<\--        | *NR          | \-      | \- |
|    | transmits an |              | RRC          |         |    |
|    | *RRCRelease* |              | :RRCRelease* |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 3  | Wait 5       | \-           | *-*          | \-      | \- |
|    | minutes to   |              |              |         |    |
|    | allow UE to  |              |              |         |    |
|    | activate     |              |              |         |    |
|    | logging.     |              |              |         |    |
|    |              |              |              |         |    |
|    | Note: Make   |              |              |         |    |
|    | the UE to    |              |              |         |    |
|    | log more     |              |              |         |    |
|    | than 520     |              |              |         |    |
|    | entires of   |              |              |         |    |
|    | LogMeasInfo, |              |              |         |    |
|    | and UE can't |              |              |         |    |
|    | transfer the |              |              |         |    |
|    | total log in |              |              |         |    |
|    | one          |              |              |         |    |
|    | UEInforma    |              |              |         |    |
|    | tionResponse |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 4  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits a  |              | *Paging*     |         |    |
|    | *Paging*     |              |              |         |    |
|    | message      |              |              |         |    |
|    | including a  |              |              |         |    |
|    | matched      |              |              |         |    |
|    | identity     |              |              |         |    |
|    | (correct     |              |              |         |    |
|    | *f           |              |              |         |    |
|    | ullI-RNTI*). |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 5  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRCRe       |         |    |
|    | *RRCRe       |              | sumeRequest* |         |    |
|    | sumeRequest* |              |              |         |    |
|    | message by   |              |              |         |    |
|    | setting      |              |              |         |    |
|    | *res         |              |              |         |    |
|    | umeIdentity* |              |              |         |    |
|    | to the       |              |              |         |    |
|    | stored       |              |              |         |    |
|    | *            |              |              |         |    |
|    | shortI-RNTI* |              |              |         |    |
|    | value.       |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 6  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits an |              | *RRCResume*  |         |    |
|    | *RRCResume*  |              |              |         |    |
|    | message.     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 7  | Check: Does  | \--\>        | NR RRC:      | 2       | P  |
|    | the UE       |              | *RRCRes      |         |    |
|    | include the  |              | umeComplete* |         |    |
|    | IE           |              |              |         |    |
|    | *logMe       |              |              |         |    |
|    | asAvailable* |              |              |         |    |
|    | in the       |              |              |         |    |
|    | *RRCRes      |              |              |         |    |
|    | umeComplete* |              |              |         |    |
|    | message?     |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 8  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|    | transmits a  |              | *UEInforma   |         |    |
|    | *UEInforma   |              | tionRequest* |         |    |
|    | tionRequest* |              |              |         |    |
|    | message on   |              |              |         |    |
|    | NR Cell 1.   |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 9  | Check: Does  | \--\>        | NR RRC:      | 1, 3, 4 | P  |
|    | the UE       |              | *UEInformat  |         |    |
|    | transmit a   |              | ionResponse* |         |    |
|    | *UEInforma   |              |              |         |    |
|    | tionResponse |              |              |         |    |
|    | message with |              |              |         |    |
|    | a            |              |              |         |    |
|    | LogM         |              |              |         |    |
|    | easInfoList* |              |              |         |    |
|    | with at      |              |              |         |    |
|    | least one    |              |              |         |    |
|    | neighbouring |              |              |         |    |
|    | cell         |              |              |         |    |
|    | measurement  |              |              |         |    |
|    | of NR Cell 3 |              |              |         |    |
|    | *and the     |              |              |         |    |
|    | logM         |              |              |         |    |
|    | easAvailable |              |              |         |    |
|    | IE?*         |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 10 | The SS sends | \<\--        | NR RRC:      | \-      | \- |
|    | an           |              | *UEInforma   |         |    |
|    | UEInform     |              | tionRequest* |         |    |
|    | ationRequest |              |              |         |    |
|    | message to   |              |              |         |    |
|    | get          |              |              |         |    |
|    | lo           |              |              |         |    |
|    | gMeasReport. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+
| 11 | The UE sends | \--\>        | NR RRC:      | \-      | \- |
|    | an           |              | *UEInformat  |         |    |
|    | UEInforma    |              | ionResponse* |         |    |
|    | tionResponse |              |              |         |    |
|    | message      |              |              |         |    |
|    | including    |              |              |         |    |
|    | lo           |              |              |         |    |
|    | gMeasReport. |              |              |         |    |
+----+--------------+--------------+--------------+---------+----+

##### 8.1.6.1.2.2.3.3 Specific message contents {#specific-message-contents-49 .H6}

Table 8.1.6.1.2.2.3.3-1: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.2.3.2-1)

  ----------------------------------------------------- -------------- -------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA                                 
  Information Element                                   Value/remark   Comment        Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                   
  criticalExtensions CHOICE {                                                         
  loggedMeasurementConfiguration-r16 SEQUENCE {                                       
  reportType CHOICE {                                                                 
  periodical SEQUENCE {                                                               
  loggingInterval-r16                                   ms320          0.32 seconds   
  }                                                                                   
  }                                                                                   
  }                                                                                   
  }                                                                                   
  }                                                                                   
  ----------------------------------------------------- -------------- -------------- -----------

Table 8.1.6.1.2.2.3.3-2: *RRCRelease* (step 2, Table 8.1.6.1.2.2.3.2-1)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-16 with condition NR\_RRC\_INACTIVE
  -------------------------------------------------------------------------------------

Table 8.1.6.1.2.2.3.3-3: *RRCResumeComplete* (step 7, Table
8.1.6.1.2.2.3.2-1)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-18                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCResumeComplete ::= SEQUENCE {                                                                                 
  criticalExtensions CHOICE {                                                                                      
  rrcResumeComplete SEQUENCE {                                                                                     
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.2.2.3.3-4: *UEInformationRequest* (steps 8 and 10, Table
8.1.6.1.2.2.3.2-1)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.2.3.3-5: *UEInformationResponse* (steps 9 and 11, Table
8.1.6.1.2.2.3.2-1)

+----------------------+----------------------+---------+-----------+
| Derivation path: TS  |                      |         |           |
| 38.508-1 \[4\],      |                      |         |           |
| Table 4.6.1-32B      |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| criticalExtensions   |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ueInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| UEInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasReport-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| a                    | Same value as sent   |         |           |
| bsoluteTimeStamp-r16 | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| traceReference-r16   |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| plmn-Identity-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| mcc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (3)) OF              | by SS in             |         |           |
| MCC-NMC-Digit        | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| mnc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (2..3)) OF           | by SS in             |         |           |
| MCC-NMC-Digit        | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceId-r16          | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceRec             | Same value as sent   |         |           |
| ordingSessionRef-r16 | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| tce-Id-r16           | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasInfoList-r16  | Total number of      |         |           |
| SEQUENCE (SIZE       | entries in step 9    |         |           |
| (1..ma               | and 11 exceeds 520   |         |           |
| xLogMeasReport-r16)) | and all entries      |         |           |
| OF LogMeasInfo-r16   | complies to entry    |         |           |
| SEQUENCE {           | with index 'x'       |         |           |
|                      | below.               |         |           |
+----------------------+----------------------+---------+-----------+
| LogMeasInfo-r16\[x\] |                      | entry x |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| locationInfo-r16     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| r                    | SS record the value  |         |           |
| elativeTimeStamp-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| servCellIdentity-r16 | Same as NR Cell 1    |         |           |
+----------------------+----------------------+---------+-----------+
| m                    |                      |         |           |
| easResultServCell-16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of NR Cell 1         |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB SEQUENCE  |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Index       | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Results     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB      | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| meas                 |                      |         |           |
| ResultNeighCells-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measR                | 1 entry              |         |           |
| esultNeighCellListNR |                      |         |           |
| SEQUENCE (SIZE       |                      |         |           |
| (1..maxFreq)) OF     |                      |         |           |
| Meas                 |                      |         |           |
| ResultLogging2NR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResul            |                      | entry 1 |           |
| tLogging2NR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| carrierFreq-r16      | Same as NR Cell 3    |         |           |
+----------------------+----------------------+---------+-----------+
| mea                  | 1 entry              |         |           |
| sResultListLoggingNR |                      |         |           |
|                      |                      |         |           |
| -r16 SEQUENCE (SIZE  |                      |         |           |
| (1..maxCellReport))  |                      |         |           |
| OF                   |                      |         |           |
| Mea                  |                      |         |           |
| sResultLoggingNR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResu             |                      | entry 1 |           |
| ltLoggingNR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId-r16       | Same as NR Cell 3    |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of NR Cell 3         |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB-r16  | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measResu             | Not present          |         |           |
| ltNeighCellListEUTRA |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| anyCellS             | Not present          |         |           |
| electionDetected-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasAvailable-r16 | True                 |         | Step 9    |
+----------------------+----------------------+---------+-----------+
|                      | Not checked          |         | Step 11   |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

###### 8.1.6.1.2.3 Logged MDT / Intra-frequency measurement, logging and reporting

##### 8.1.6.1.2.3.1 Test Purpose (TP) {#test-purpose-tp-50 .H6}

##### (1) {#section-101 .H6}

**with** { UE received *LoggedMeasurementConfiguration* message with a
cellGlobalIdList on a NR cell }

**ensure that** {

**when** { UE camps on a NR cell in the cellGlobalIdList }

**then** { UE performs logged measurements }

}

##### (2) {#section-102 .H6}

**with** { UE received *LoggedMeasurementConfiguration* message with a
cellGlobalIdList on a NR cell }

**ensure that** {\
**when** { UE camps on a NR cell not in the cellGlobalIdList }

**then** { UE does not perform logged measurements }

}

##### (3) {#section-103 .H6}

**with** { UE received *LoggedMeasurementConfiguration* message with a
trackingAreaCodeList on a NR cell }

**ensure that** {\
**when** { UE camps on a NR cell in the trackingAreaCodeList }

**then** { UE performs logged measurements }

}

##### (4) {#section-104 .H6}

**with** { UE received *LoggedMeasurementConfiguration* message with a
trackingAreaCodeList on a NR cell }

**ensure that** {\
**when** { UE camps on a NR cell not in the trackingAreaCodeList }

**then** { UE does not perform logged measurements }

}

##### 8.1.6.1.2.3.2 Conformance requirements {#conformance-requirements-50 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3, 5.5a.3.2, and
5.7.10.3. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

2\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical* in the
*VarLogMeasConfig*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*:

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in the *VarLogMeasConfig*;

2\> else if the *reportType* is set to *eventTriggered*, and *eventType*
is set to *outOfCoverage*:

3\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the UE is in any cell
selection state;

3\> perform the logging immediately upon transitioning from the any cell
selection state to the camped normally state;

2\> else if the *reportType* is set to *eventTriggered* and *eventType*
is set to *eventL1*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*;

4\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the conditions
indicated by the *eventL1* are met;

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if detailed location information became available during the last
logging interval, set the content of the *locationInfo* as in 5.3.3.7:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> set *anyCellSelectionDetected* to indicate the detection of no
suitable or no acceptable cell found;

4\> set the *servCellIdentity* to indicate global cell identity of the
last logged cell that the UE was camping on;

4\> set the *measResultServingCell* to include the quantities of the
last logged cell the UE was camping on;

3\> else:

4\> set the *servCellIdentity* to indicate global cell identity of the
cell the UE is camping on;

4\> set the *measResultServingCell* to include the quantities of the
cell the UE is camping on;

4\> if available, set the *measResultNeighCells*, in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements that became available during the last logging interval
for at most the following number of neighbouring cells: 6
intra-frequency and 3 inter-frequency neighbours per frequency as well
as 3 inter-RAT neighbours, per frequency/ set of frequencies per RAT and
according to the following:

5\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation in RRC\_IDLE or RRC\_INACTIVE,
which are performed in accordance with the performance requirements as
specified in TS 38.133 \[14\].

2\> when the memory reserved for the logged measurement information
becomes full, stop timer T330 and 8.1.6.1.2.3.3 Test description

##### 8.1.6.1.2.3.3.1 Pre-test conditions {#pre-test-conditions-49 .H6}

System Simulator:

\- NR Cell 1, NR Cell 2 and NR Cell 11.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-38 .H6}

> \- None.

##### Preamble: {#preamble-38 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3 on NR Cell 1.

##### 8.1.6.1.2.3.3.2 Test procedure sequence {#test-procedure-sequence-49 .H6}

Table 8.1.6.1.2.3.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. The configuration \"T0\" indicates the initial
conditions. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.2.3.3.2-1: Time instances of cell power level for FR1

+---------+---------+---------+---------+---------+---------+---------+
|         | **Para  | *       | **NR    | **NR    | **NR    | **R     |
|         | meter** | *Unit** | Cell    | Cell    | Cell    | emark** |
|         |         |         | 1**     | 2**     | 11**    |         |
+=========+=========+=========+=========+=========+=========+=========+
| **T0**  | SS/PBCH | dBm/SCS | -78     | \"Off\" | \"Off\" | NR Cell |
|         |         |         |         |         |         | 1       |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| **T1**  | SS/PBCH | dBm/SCS | -85     | \"Off\" | -78     | NR Cell |
|         |         |         |         |         |         | 11      |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| **T2**  | SS/PBCH | dBm/SCS | -85     | -78     | \"Off\" | NR Cell |
|         |         |         |         |         |         | 2       |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| **T3**  | SS/PBCH | dBm/SCS | -85     | \"Off\" | -78     | NR Cell |
|         |         |         |         |         |         | 11      |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| **T4**  | SS/PBCH | dBm/SCS | -78     | \"Off\" | -85     | NR Cell |
|         |         |         |         |         |         | 1       |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| Note:   |         |         |         |         |         |         |
| The     |         |         |         |         |         |         |
| d       |         |         |         |         |         |         |
| ownlink |         |         |         |         |         |         |
| signal  |         |         |         |         |         |         |
| level   |         |         |         |         |         |         |
| unce    |         |         |         |         |         |         |
| rtainty |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| sp      |         |         |         |         |         |         |
| ecified |         |         |         |         |         |         |
| in TS   |         |         |         |         |         |         |
| 3       |         |         |         |         |         |         |
| 8.508-1 |         |         |         |         |         |         |
| \[4\]   |         |         |         |         |         |         |
| clause  |         |         |         |         |         |         |
| 6       |         |         |         |         |         |         |
| .2.2.1. |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.6.1.2.3.3.2-2: Time instances of cell power level for FR2

+---------+---------+---------+---------+---------+---------+---------+
|         | **Para  | *       | **NR    | **NR    | **NR    | **R     |
|         | meter** | *Unit** | Cell    | Cell    | Cell    | emark** |
|         |         |         | 1**     | 2**     | 11**    |         |
+=========+=========+=========+=========+=========+=========+=========+
| **T0**  | SS/PBCH | dBm/SCS | -82     | \"Off\" | \"Off\" | NR Cell |
|         |         |         |         |         |         | 1       |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| **T1**  | SS/PBCH | dBm/SCS | -91     | \"Off\" | -82     | NR Cell |
|         |         |         |         |         |         | 11      |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| **T2**  | SS/PBCH | dBm/SCS | -91     | -82     | \"Off\" | NR Cell |
|         |         |         |         |         |         | 2       |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| **T3**  | SS/PBCH | dBm/SCS | -91     | \"Off\" | -82     | NR Cell |
|         |         |         |         |         |         | 11      |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| **T4**  | SS/PBCH | dBm/SCS | -82     | \"Off\" | -91     | NR Cell |
|         |         |         |         |         |         | 1       |
|         | SSS     |         |         |         |         | becomes |
|         | EPRE    |         |         |         |         | the     |
|         |         |         |         |         |         | highest |
|         |         |         |         |         |         | ranked  |
|         |         |         |         |         |         | cell.   |
+---------+---------+---------+---------+---------+---------+---------+
| Note:   |         |         |         |         |         |         |
| The     |         |         |         |         |         |         |
| d       |         |         |         |         |         |         |
| ownlink |         |         |         |         |         |         |
| signal  |         |         |         |         |         |         |
| level   |         |         |         |         |         |         |
| unce    |         |         |         |         |         |         |
| rtainty |         |         |         |         |         |         |
| is      |         |         |         |         |         |         |
| sp      |         |         |         |         |         |         |
| ecified |         |         |         |         |         |         |
| in TS   |         |         |         |         |         |         |
| 3       |         |         |         |         |         |         |
| 8.508-1 |         |         |         |         |         |         |
| \[4\]   |         |         |         |         |         |         |
| clause  |         |         |         |         |         |         |
| 6.2     |         |         |         |         |         |         |
| .2.2.2. |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

Table 8.1.6.1.2.3.3.2-3: Main behaviour

  St          Procedure                                                                                                                                                                                  Message Sequence   TP                                         Verdict   
  ----------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ ------------------------------------------ --------- ----
                                                                                                                                                                                                         U - S              Message                                              
  1           The SS transmits a *LoggedMeasurementConfiguration* message *with a* cellGlobalIdList on NR Cell 1.                                                                                        \<\--              NR RRC: *LoggedMeasurementConfiguration*   \-        \-
  2           SS transmits a *RRCRelease* message to release the RRC connection.                                                                                                                         \<\--              NR RRC: *RRCRelease*                       \-        \-
  3           The SS changes NR Cell 1, NR Cell 2 and NR Cell 11 level according to the row \"T1\" in Table 8.1.6.1.2.3.3.2-1/2.                                                                         \-                 \-                                         \-        \-
  4-9         Steps 1 to 6a1 of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.5.2.2-1 are performed on NR Cell 11.                                                                           \-                 \-                                         \-        \-
  10          Wait 30 seconds for UE logging interval timer to expire at least once.                                                                                                                     \-                 \-                                         \-        \-
  11-18       Steps 1 to 8 of the generic radio bearer establishment procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure on NR Cell 11.   \-                 *-*                                        \-        \-
  19          Void                                                                                                                                                                                       \-                 *-*                                        \-        \-
  20          The SS sends a *UEInformationRequest* message to get *logMeasReport*.                                                                                                                      \<\--              NR RRC: *UEInformationRequest*             \-        \-
  21          Check: Does the UE send a *UEInformationResponse message including at least one logMeasReport* with serving cell measurements for NR Cell 11*?*                                            \--\>              NR RRC: *UEInformationResponse*            1         P
  22          SS transmits a *RRCRelease* message to release the RRC connection.                                                                                                                         \<\--              NR RRC: *RRCRelease*                       \-        \-
  23          The SS changes NR Cell 1, NR Cell 2 and NR Cell 11 level according to the row \"T2\" in Table 8.1.6.1.2.3.3.2-1/2.                                                                         \-                 \-                                         \-        \-
  24-29       Steps 1 to 6a1 of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.5.2.2-1 are performed on NR Cell 2.                                                                            \-                 \-                                         \-        \-
  30          Wait 30 seconds for UE logging interval timer to expire at least once.                                                                                                                     \-                 \-                                         \-        \-
  31          The SS transmits a *Paging* message.                                                                                                                                                       \<\--              NR RRC: *Paging*                           \-        \-
  32          The UE transmits an *RRCSetupRequest* message.                                                                                                                                             \--\>              NR RRC: *RRCSetupRequest*                  \-        \-
  33          The SS transmits an *RRCSetup* message.                                                                                                                                                    \<\--              NR RRC: *RRCSetup*                         \-        \-
  \-          EXCEPTION: In case the UE had performed a logging before the cell re-selection to NR Cell 2 then the steps 34a1-34a7 are executed.                                                         \-                 *-*                                        \-        \-
  34a1        The UE transmits an *RRCSetupComplete* message including *logMeasAvailable* IE set it to *true*.                                                                                           \--\>              NR RRC: *RRCSetupComplete*                 \-        \-
  34a2-34a5   Steps 5 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                            \-                 *-*                                        \-        \-
  34a6        The SS sends a *UEInformationRequest* message to get *logMeasReport*.                                                                                                                      \<\--              NR RRC: *UEInformationRequest*             \-        \-
  34a7        Check: Does the UE send a *UEInformationResponse message with logged serving cell measurements of NR Cell 2?*                                                                              \--\>              NR RRC: *UEInformationResponse*            2         F
  \-          EXCEPTION: In case the UE had not performed any logging before the cell re-selection to NR Cell 2 then the step 34b1 is executed.                                                          \-                 *-*                                        \-        \-
  34b1        Check: Does UE transmit an *RRCSetupComplete* message with *logMeasAvailable* IE not present?                                                                                              \--\>              NR RRC: *RRCSetupComplete*                 2         P
  34b2-34b5   Steps 5 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                            \-                 \-                                                   
  35          The SS transmits a *LoggedMeasurementConfiguration* message *with a* trackingAreaCodeList on NR Cell 2.                                                                                    \<\--              NR RRC: *LoggedMeasurementConfiguration*   \-        \-
  36          The SS transmits an *RRCRelease* message to release RRC connection and move to RRC\_IDLE on NR Cell 2.                                                                                     \<\--              NR RRC: *RRCRelease*                       \-        \-
  37          The SS changes NR Cell 1, NR Cell 2 and NR Cell 11 level according to the row \"T3\" in Table 8.1.6.1.2.3.3.2-1/2.                                                                         \-                 *-*                                        \-        \-
  38-43       Steps 1 to 6a1 of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.5.2.2-1 are performed on NR Cell 11.                                                                           \-                 \-                                         \-        \-
  44          The SS transmits a *Paging* message on NR Cell 11.                                                                                                                                         \<\--              NR RRC: *Paging*                           \-        \-
  45          The UE transmits an *RRCSetupRequest* message on NR Cell 11.                                                                                                                               \--\>              NR RRC: *RRCSetupRequest*                  \-        \-
  46          The SS transmits an *RRCSetup* message on NR Cell 11.                                                                                                                                      \<\--              NR RRC: *RRCSetup*                         \-        \-
  \-          EXCEPTION: In case the UE had performed a logging before the cell re-selection to NR Cell 11 then the steps 47a1-47a7 are executed.                                                        \-                 *-*                                        \-        \-
  47a1        The UE transmits an *RRCSetupComplete* message including *logMeasAvailable* IE set it to *true*.                                                                                           \--\>              NR RRC: *RRCSetupComplete*                 \-        \-
  47a2-47a5   Steps 5 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                            \-                 *-*                                        \-        \-
  47a6        The SS sends a *UEInformationRequest* message to get *logMeasReport*.                                                                                                                      \<\--              NR RRC: *UEInformationRequest*             \-        \-
  47a7        Check: Does the UE send a *UEInformationResponse* message with logged serving cell measurements *of NR* Cell 11*?*                                                                         \--\>              NR RRC: *UEInformationResponse*            4         F
  \-          EXCEPTION: In case the UE had not performed any logging before the cell re-selection to NR Cell 11 then the step 47b1-47b5 are executed.                                                   \-                 *-*                                        \-        \-
  47b1        Check: Does UE transmit an *RRCSetupComplete* message with *logMeasAvailable* IE not present?                                                                                              \--\>              NR RRC: *RRCSetupComplete*                 4         P
  47b2-47b5   Steps 5 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                            \-                 \-                                         \-        \-
  48          The SS transmits an *RRCRelease* message to release the RRC connection.                                                                                                                    \<\--              NR RRC: *RRCRelease*                       \-        \-
  49          The SS changes NR Cell 1, NR Cell 2 and NR Cell 11 level according to the row \"T4\" in Table 8.1.6.1.2.3.3.2-1/2.                                                                         \-                 *-*                                        \-        \-
  50-55       Steps 1 to 6a1 of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.5.2.2-1 are performed on NR Cell 1.                                                                            \-                 *-*                                        \-        \-
  56          Wait 30 seconds for UE logging interval timer to expire at least once.                                                                                                                     \-                 *-*                                        \-        \-
  57-64       Steps 1 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                            \-                 *-*                                        \-        \-
  65          Void                                                                                                                                                                                       \-                 *-*                                        \-        \-
  66          The SS sends a *UEInformationRequest* message to get *logMeasReport*.                                                                                                                      \<\--              NR RRC: *UEInformationRequest*             \-        \-
  67          Check: Does the UE send a *UEInformationResponse include logMeasRepor*t *with logged serving cell measurements of* NR *Cell 1?*                                                            \--\>              NR RRC: *UEInformationResponse*            3         P

##### 8.1.6.1.2.3.3.3 Specific message contents {#specific-message-contents-50 .H6}

Table 8.1.6.1.2.3.3.3-1: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.3.3.2-3)

+----------------------+----------------------+---------+-----------+
|                      |                      |         |           |
|  ------------------- |                      |         |           |
| -------------------- |                      |         |           |
| -------------------- |                      |         |           |
| -------------------- |                      |         |           |
|   Derivation path:   |                      |         |           |
| TS 38.508-1 \[4\], T |                      |         |           |
| able 4.6.1-5AA with  |                      |         |           |
| condition PERIODICAL |                      |         |           |
|                      |                      |         |           |
|  ------------------- |                      |         |           |
| -------------------- |                      |         |           |
| -------------------- |                      |         |           |
| -------------------- |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| LoggedMeasurem       |                      |         |           |
| entConfiguration-r16 |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| criticalExtensions   |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| loggedMeasurem       |                      |         |           |
| entConfiguration-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| a                    |                      |         |           |
| reaConfiguration-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| areaConfig-r16       |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| CellGlobalIdList-r16 |                      |         |           |
| SEQUENCE (SIZE (1))  |                      |         |           |
| OF                   |                      |         |           |
| CGI-Info-Logging-r16 |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| plmn-Identity-r16    | Set to the same      |         |           |
|                      | Mobile Country Code  |         |           |
|                      | and Mobile Network   |         |           |
|                      | Code stored in       |         |           |
|                      | EFIMSI on the test   |         |           |
|                      | USIM card            |         |           |
+----------------------+----------------------+---------+-----------+
| cellIdentity-r16     | Same as NR Cell 11   |         |           |
+----------------------+----------------------+---------+-----------+
| trackingAreaCode-r16 | 2                    |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

Table 8.1.6.1.2.3.3.3-2: *LoggedMeasurementConfiguration* (step 35,
Table 8.1.6.1.2.3.3.2-3)

+------------------------------+--------------+---------+-----------+
|   -----------------------    |              |         |           |
| ---------------------------- |              |         |           |
| ---------------------------- |              |         |           |
|   Derivation path: TS 3      |              |         |           |
| 8.508-1 \[4\], Table 4.6.1-5 |              |         |           |
| AA with condition PERIODICAL |              |         |           |
|   -----------------------    |              |         |           |
| ---------------------------- |              |         |           |
| ---------------------------- |              |         |           |
+------------------------------+--------------+---------+-----------+
| Information Element          | Value/remark | Comment | Condition |
+------------------------------+--------------+---------+-----------+
| Logged                       |              |         |           |
| MeasurementConfiguration-r16 |              |         |           |
| ::= SEQUENCE {               |              |         |           |
+------------------------------+--------------+---------+-----------+
| criticalExtensions CHOICE {  |              |         |           |
+------------------------------+--------------+---------+-----------+
| logged                       |              |         |           |
| MeasurementConfiguration-r16 |              |         |           |
| SEQUENCE {                   |              |         |           |
+------------------------------+--------------+---------+-----------+
| areaConfiguration-r16        |              |         |           |
| SEQUENCE {                   |              |         |           |
+------------------------------+--------------+---------+-----------+
| areaConfig-r16 CHOICE {      |              |         |           |
+------------------------------+--------------+---------+-----------+
| trackingAreaCodeList-r16     | 1 entry      |         |           |
| SEQUENCE (SIZE (1...)) OF    |              |         |           |
| TrackingAreaCode {           |              |         |           |
+------------------------------+--------------+---------+-----------+
| TrackingAreaCode             | 1            | Entry 1 |           |
+------------------------------+--------------+---------+-----------+
| }                            |              |         |           |
+------------------------------+--------------+---------+-----------+
| }                            |              |         |           |
+------------------------------+--------------+---------+-----------+
| }                            |              |         |           |
+------------------------------+--------------+---------+-----------+
| }                            |              |         |           |
+------------------------------+--------------+---------+-----------+
| }                            |              |         |           |
+------------------------------+--------------+---------+-----------+
| }                            |              |         |           |
+------------------------------+--------------+---------+-----------+

Table 8.1.6.1.2.3.3.3-3: *RRCSetupComplete* (steps 34b1 and 47b1, Table
8.1.6.1.2.3.3.2-3)

+--------------------+--------------+---------+--------------------+
|   ---------------- |              |         |                    |
| ------------------ |              |         |                    |
| ------------------ |              |         |                    |
|   Derivation pat   |              |         |                    |
| h: TS 38.508-1 \[4 |              |         |                    |
| \], Table 4.6.1-22 |              |         |                    |
|   ---------------- |              |         |                    |
| ------------------ |              |         |                    |
| ------------------ |              |         |                    |
+--------------------+--------------+---------+--------------------+
| Information        | Value/remark | Comment | Condition          |
| Element            |              |         |                    |
+--------------------+--------------+---------+--------------------+
| RRCSetupComplete   |              |         |                    |
| ::= SEQUENCE {     |              |         |                    |
+--------------------+--------------+---------+--------------------+
| criticalExtensions |              |         |                    |
| CHOICE {           |              |         |                    |
+--------------------+--------------+---------+--------------------+
| rrcSetupComplete   |              |         |                    |
| SEQUENCE {         |              |         |                    |
+--------------------+--------------+---------+--------------------+
| no                 | Checked      | Note 1  |                    |
| nCriticalExtension |              |         |                    |
| SEQUENCE {         |              |         |                    |
+--------------------+--------------+---------+--------------------+
| ue-Measure         |              |         | If                 |
| mentsAvailable-r16 |              |         | no                 |
| SEQUENCE {         |              |         | nCriticalExtension |
|                    |              |         | is present         |
+--------------------+--------------+---------+--------------------+
| lo                 | Not present  |         | If                 |
| gMeasAvailable-r16 |              |         | ue-Measure         |
|                    |              |         | mentsAvailable-r16 |
|                    |              |         | is present         |
+--------------------+--------------+---------+--------------------+
| }                  |              |         |                    |
+--------------------+--------------+---------+--------------------+
| }                  |              |         |                    |
+--------------------+--------------+---------+--------------------+
| }                  |              |         |                    |
+--------------------+--------------+---------+--------------------+
| }                  |              |         |                    |
+--------------------+--------------+---------+--------------------+

  Condition                                                                                                                                                                                                                                                                        Explanation
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------------------------------------------------------------
  If nonCriticalExtension and ue-MeasurementsAvailable-r16 are present                                                                                                                                                                                                             Contents of ue-MeasurementsAvailable-r16 shall be checked only if nonCriticalExtension and ue-MeasurementsAvailable-r16 are present
  Note 1: If the UE has no underlying information to report to the network, this information element may be absent. If this information element and MeasurementsAvailable-r16 are present, further check on the contents of the ue-MeasurementsAvailable-r16 shall be performed.   

Table 8.1.6.1.2.3.3.3-4: *RRCSetupComplete* (steps 14, 34a1, 47a1, and
60, Table 8.1.6.1.2.3.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.2.3.3.3-5: *UEInformationRequest* (steps 20, 34a6, 47a6,
and 66, Table 8.1.6.1.2.3.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.3.3.3-6: *UEInformationResponse* (steps 21 and 34a7,
Table 8.1.6.1.2.3.3.2-3)

  --------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------- --------------------------------------------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                            
  Information Element                                                                           Value/remark                                                                 Comment                                             Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                       
  criticalExtensions CHOICE {                                                                                                                                                                                                    
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                           
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                   
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                           
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                  
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                   
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                           
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                           
  }                                                                                                                                                                                                                              
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                             
  }                                                                                                                                                                                                                              
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                           
  tce-Id-r16                                                                                    Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                           
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least one entry and all entries complies to entry with index 'x' below.                                                       
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                            entry x                                             
  locationInfo-r16                                                                              Not checked                                                                                                                      
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                              
  servCellIdentity-r16                                                                          Same as NR Cell 11                                                           *No logged serving cell measurement of NR Cell 2*   
  measResultServCell-16 SEQUENCE {                                                                                                                                                                                               
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 11                                                                                                
  resultsSSB SEQUENCE {                                                                                                                                                                                                          
  best-ssb-Index                                                                                Not checked                                                                                                                      
  best-ssb-Results                                                                              Not checked                                                                                                                      
  numberOfGoodSSB                                                                               Not checked                                                                                                                      
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                                
  anyCellSelectionDetected-r16                                                                  Not present                                                                                                                      
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  logMeasAvailable-r16                                                                          Not present                                                                                                                      
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  }                                                                                                                                                                                                                              
  --------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------- --------------------------------------------------- -----------

Table 8.1.6.1.2.3.3.3-7: *UEInformationResponse* (step 47a7, Table
8.1.6.1.2.3.3.2-3)

  --------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------- ---------------------------------------------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                             
  Information Element                                                                           Value/remark                                                                 Comment                                              Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                                                                                     
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                            
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                    
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in *LoggedMeasurementConfiguration in step 35*                                                           
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                   
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                    
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in *LoggedMeasurementConfiguration in step 35*                                                           
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in *LoggedMeasurementConfiguration in step 35*                                                           
  }                                                                                                                                                                                                                               
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 35                                                             
  }                                                                                                                                                                                                                               
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in *LoggedMeasurementConfiguration in step 35*                                                           
  tce-Id-r16                                                                                    Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                            
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least one entry and all entries complies to entry with index 'x' below.                                                        
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                            entry x                                              
  locationInfo-r16                                                                              Not checked                                                                                                                       
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                               
  servCellIdentity-r16                                                                          Same as NR Cell 2                                                            *No logged serving cell measurement of NR Cell 11*   
  measResultServCell-16 SEQUENCE {                                                                                                                                                                                                
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 2                                                                                                  
  resultsSSB SEQUENCE {                                                                                                                                                                                                           
  best-ssb-Index                                                                                Not checked                                                                                                                       
  best-ssb-Results                                                                              Not checked                                                                                                                       
  numberOfGoodSSB                                                                               Not checked                                                                                                                       
  }                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                               
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                                 
  anyCellSelectionDetected-r16                                                                  Not present                                                                                                                       
  }                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                               
  logMeasAvailable-r16                                                                          Not present                                                                                                                       
  }                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                               
  --------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------- ---------------------------------------------------- -----------

Table 8.1.6.1.2.3.3.3-8: *UEInformationResponse* (step 67, Table
8.1.6.1.2.3.3.2-3)

  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------- ---------------------------------------------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                          
  Information Element                                                                           Value/remark                                                              Comment                                              Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                     
  criticalExtensions CHOICE {                                                                                                                                                                                                  
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                         
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                 
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in *LoggedMeasurementConfiguration in step 35*                                                        
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                 
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in *LoggedMeasurementConfiguration in step 35*                                                        
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in *LoggedMeasurementConfiguration in step 35*                                                        
  }                                                                                                                                                                                                                            
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 35                                                          
  }                                                                                                                                                                                                                            
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in *LoggedMeasurementConfiguration in step 35*                                                        
  tce-Id-r16                                                                                    Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                         
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least one entry complies to entry with index 'x' below.                                                                     
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                         entry x                                              
  locationInfo-r16                                                                              Not checked                                                                                                                    
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                            
  servCellIdentity-r16                                                                          Same as NR Cell 1                                                         *No logged serving cell measurement of NR Cell 11*   
  measResultServCell-16 \[x\] SEQUENCE {                                                                                                                                                                                       
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 1                                                                                               
  resultsSSB SEQUENCE {                                                                                                                                                                                                        
  best-ssb-Index                                                                                Not checked                                                                                                                    
  best-ssb-Results                                                                              Not checked                                                                                                                    
  numberOfGoodSSB                                                                               Not checked                                                                                                                    
  }                                                                                                                                                                                                                            
  }                                                                                                                                                                                                                            
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                              
  anyCellSelectionDetected-r16                                                                  Not present                                                                                                                    
  }                                                                                                                                                                                                                            
  }                                                                                                                                                                                                                            
  logMeasAvailable-r16                                                                          Not present                                                                                                                    
  }                                                                                                                                                                                                                            
  }                                                                                                                                                                                                                            
  }                                                                                                                                                                                                                            
  }                                                                                                                                                                                                                            
  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------- ---------------------------------------------------- -----------

###### 8.1.6.1.2.4 Logged MDT/ RRC\_IDLE / Logging and reporting / periodic measurement trigger

##### 8.1.6.1.2.4.1 Test Purpose (TP) {#test-purpose-tp-51 .H6}

\(1\)

**with** { UE in NR RRC\_IDLE state camping normally on an NR cell where
reportType is set to periodical and the UE is able to detect an
intra-frequency cell }

**ensure that** {

**when** { T330 is running }

**then** { UE is logging serving cell idle mode measurements and
intra-frequency neighbouring cell measurements at regular time intervals
}

}

##### 8.1.6.1.2.4.2 Conformance requirements {#conformance-requirements-51 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3, 5.5a.3.2, 5.7.10.3
and 6.2.2. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

3\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical* in the
*VarLogMeasConfig*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*:

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in the *VarLogMeasConfig*;

2\> else if the *reportType* is set to *eventTriggered*, and *eventType*
is set to *outOfCoverage*:

3\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the UE is in any cell
selection state;

3\> perform the logging immediately upon transitioning from the any cell
selection state to the camped normally state;

2\> else if the *reportType* is set to *eventTriggered* and *eventType*
is set to *eventL1*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*;

4\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the conditions
indicated by the *eventL1* are met;

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if detailed location information became available during the last
logging interval, set the content of the *locationInfo* as in 5.3.3.7:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> set *anyCellSelectionDetected* to indicate the detection of no
suitable or no acceptable cell found;

4\> set the *servCellIdentity* to indicate global cell identity of the
last logged cell that the UE was camping on;

4\> set the *measResultServingCell* to include the quantities of the
last logged cell the UE was camping on;

3\> else:

4\> set the *servCellIdentity* to indicate global cell identity of the
cell the UE is camping on;

4\> set the *measResultServingCell* to include the quantities of the
cell the UE is camping on;

4\> if available, set the *measResultNeighCells*, in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements that became available during the last logging interval
for at most the following number of neighbouring cells: 6
intra-frequency and 3 inter-frequency neighbours per frequency as well
as 3 inter-RAT neighbours, per frequency/ set of frequencies per RAT and
according to the following:

5\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation in RRC\_IDLE or RRC\_INACTIVE,
which are performed in accordance with the performance requirements as
specified in TS 38.133 \[14\].

2\> when the memory reserved for the logged measurement information
becomes full, stop timer T330 and perform the same actions as performed
upon expiry of T330, as specified in 5.5a.1.4.

\[TS 38.331, clause 6.2.2\]

##### -- LoggedMeasurementConfiguration {#loggedmeasurementconfiguration-2 .H6}

The *LoggedMeasurementConfiguration* message is used to perform logging
of measurement results while in RRC\_IDLE or RRC\_INACTIVE. It is used
to transfer the logged measurement configuration for network performance
optimisation.

> Signalling radio bearer: SRB1
>
> RLC-SAP: AM
>
> Logical channel: DCCH
>
> Direction: Network to UE

***LoggedMeasurementConfiguration message***

\-- ASN1START

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-START

LoggedMeasurementConfiguration-r16 ::= SEQUENCE {

criticalExtensions CHOICE {

loggedMeasurementConfiguration-r16
LoggedMeasurementConfiguration-r16-IEs,

criticalExtensionsFuture SEQUENCE {}

}

}

LoggedMeasurementConfiguration-r16-IEs ::= SEQUENCE {

traceReference-r16 TraceReference-r16,

traceRecordingSessionRef-r16 OCTET STRING (SIZE (2)),

tce-Id-r16 OCTET STRING (SIZE (1)),

absoluteTimeInfo-r16 AbsoluteTimeInfo-r16,

areaConfiguration-r16 AreaConfiguration-r16 OPTIONAL, \--Need R

plmn-IdentityList-r16 PLMN-IdentityList2-r16 OPTIONAL, \--Need R

bt-NameList-r16 SetupRelease {BT-NameList-r16} OPTIONAL, \--Need M

wlan-NameList-r16 SetupRelease {WLAN-NameList-r16} OPTIONAL, \--Need M

sensor-NameList-r16 SetupRelease {Sensor-NameList-r16} OPTIONAL, \--Need
M

loggingDuration-r16 LoggingDuration-r16,

reportType CHOICE {

periodical LoggedPeriodicalReportConfig-r16,

eventTriggered LoggedEventTriggerConfig-r16,

\...

},

lateNonCriticalExtension OCTET STRING OPTIONAL,

nonCriticalExtension SEQUENCE {} OPTIONAL

}

LoggedPeriodicalReportConfig-r16 ::= SEQUENCE {

loggingInterval-r16 LoggingInterval-r16,

\...

}

LoggedEventTriggerConfig-r16 ::= SEQUENCE {

eventType-r16 EventType-r16,

loggingInterval-r16 LoggingInterval-r16,

\...

}

EventType-r16 ::= CHOICE {

outOfCoverage NULL,

eventL1 SEQUENCE {

l1-Threshold MeasTriggerQuantity,

hysteresis Hysteresis,

timeToTrigger TimeToTrigger

},

\...

}

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-STOP

\-- ASN1STOP

+----------------------------------------------------------------------+
| ***LoggedMeasurementConfiguration field descriptions***              |
+======================================================================+
| ***absoluteTimeInfo***                                               |
|                                                                      |
| *Indicates* the absolute time in the current cell.                   |
+----------------------------------------------------------------------+
| ***areaConfiguration***                                              |
|                                                                      |
| ***Used*** to **restrict the area in which the UE performs           |
| measurement logging to cells broadcasting either one of the included |
| cell identities or one of the included tracking area codes/          |
| frequencies**.                                                       |
+----------------------------------------------------------------------+
| ***eventType***                                                      |
|                                                                      |
| ***The value outOfCoverage indicates the UE to perform logging of    |
| measurements when the UE enters any cell selection state, and the    |
| value eventL1 indicates the UE to perform logging of measurements    |
| when the triggering condition (similar as event A2 as specified in   |
| 5.5.4.3) as configured in the event is met for the camping cell in   |
| camped normally state.***                                            |
+----------------------------------------------------------------------+
| ***plmn-IdentityList***                                              |
|                                                                      |
| **Indicates a set of PLMNs defining when the UE performs measurement |
| logging as well as the associated status indication and information  |
| retrieval i.e. the UE performs these actions when the RPLMN is part  |
| of this set of PLMNs.**                                              |
+----------------------------------------------------------------------+
| ***tce-Id***                                                         |
|                                                                      |
| ***Parameter Trace Collection Entity Id: See TS 32.422 \[52\].***    |
+----------------------------------------------------------------------+
| ***traceRecordingSessionRef***                                       |
|                                                                      |
| ***Parameter Trace Recording Session Reference: See TS 32.422        |
| \[52\].***                                                           |
+----------------------------------------------------------------------+
| ***reportType***                                                     |
|                                                                      |
| Parameter configures the type of MDT configuration, specifically     |
| Periodic MDT conifguraiton or Event Triggerd MDT configuration.      |
+----------------------------------------------------------------------+

##### 8.1.6.1.2.4.3 Test description {#test-description-49 .H6}

##### 8.1.6.1.2.4.3.1 Pre-test conditions {#pre-test-conditions-50 .H6}

System Simulator:

\- NR Cell 1 and NR Cell 11.

\- System information combination NR-2 as defined in TS 38.508-1\[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-39 .H6}

> \- None.

##### Preamble: {#preamble-39 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3 on NR Cell 1.

##### 8.1.6.1.2.4.3.2 Test procedure sequence {#test-procedure-sequence-50 .H6}

Table 8.1.6.1.2.4.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions
after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.2.4.3.2-1: Time instances of cell power level and
parameter changes for FR1

+--------+----------+----------+----------+----------+----------+
|        | **Par    | **Unit** | **NR     | **NR     | **       |
|        | ameter** |          | Cell 1** | Cell     | Remark** |
|        |          |          |          | 11**     |          |
+========+==========+==========+==========+==========+==========+
| **T0** | SS/PBCH  | dBm/SCS  | -78      | -85      | NR Cell  |
|        |          |          |          |          | 1        |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+
| **T1** | SS/PBCH  | dBm/SCS  | -85      | -78      | NR Cell  |
|        |          |          |          |          | 11       |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+

Table 8.1.6.1.2.4.3.2-2: Time instances of cell power level and
parameter changes for FR2

+--------+----------+----------+----------+----------+----------+
|        | **Par    | **Unit** | **NR     | **NR     | **       |
|        | ameter** |          | Cell 1** | Cell     | Remark** |
|        |          |          |          | 11**     |          |
+========+==========+==========+==========+==========+==========+
| **T0** | SS/PBCH  | dBm/SCS  | -82      | -91      | NR Cell  |
|        |          |          |          |          | 1        |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+
| **T1** | SS/PBCH  | dBm/SCS  | -91      | -82      | NR Cell  |
|        |          |          |          |          | 11       |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+

Table 8.1.6.1.2.4.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | SS          | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *LoggedMea  |         |    |
|       | *LoggedMea  |             | surementCon |         |    |
|       | surementCon |             | figuration* |         |    |
|       | figuration* |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | reportType  |             |             |         |    |
|       | is set to   |             |             |         |    |
|       | '           |             |             |         |    |
|       | periodical' |             |             |         |    |
|       | and         |             |             |         |    |
|       | Logg        |             |             |         |    |
|       | ingInterval |             |             |         |    |
|       | is set to   |             |             |         |    |
|       | 'ms10240',  |             |             |         |    |
|       | to          |             |             |         |    |
|       | configure   |             |             |         |    |
|       | the UE to   |             |             |         |    |
|       | perform     |             |             |         |    |
|       | logging of  |             |             |         |    |
|       | measurement |             |             |         |    |
|       | results     |             |             |         |    |
|       | while in    |             |             |         |    |
|       | RRC\_IDLE.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRelease* |         |    |
|       | an          |             |             |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | Wait 5s and | \-          | *-*         | \-      | \- |
|       | the         |             |             |         |    |
|       | Logg        |             |             |         |    |
|       | ingInterval |             |             |         |    |
|       | will not be |             |             |         |    |
|       | expired.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The SS      | \-          | *-*         | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1 and  |             |             |         |    |
|       | NR Cell 11  |             |             |         |    |
|       | levels      |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.2   |             |             |         |    |
|       | .4.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 11  |             |             |         |    |
|       | to initiate |             |             |         |    |
|       | a tracking  |             |             |         |    |
|       | area update |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | SS          | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSetup*  |         |    |
|       | an          |             |             |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | Check: Does | \--\>       | NR RRC:     | 1       | F  |
|       | the UE      |             | *RRCSet     |         |    |
|       | include the |             | upComplete* |         |    |
|       | IE          |             |             |         |    |
|       | *logMea     |             | 5GMM:       |         |    |
|       | sAvailable* |             | *R          |         |    |
|       | in the      |             | EGISTRATION |         |    |
|       | *RRCSet     |             | REQUEST*    |         |    |
|       | upComplete* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 8-10  | Steps 4 to  | \-          | *-*         | \-      | \- |
|       | 6a1 of      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | test        |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed   |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 11.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11    | Wait 30s to | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12-14 | Steps 1 to  | \-          | *-*         | \-      | \- |
|       | 3 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *RRCSet     |         |    |
|       | include the |             | upComplete* |         |    |
|       | IE          |             |             |         |    |
|       | logMe       |             | 5GMM:       |         |    |
|       | asAvailable |             | SERVICE     |         |    |
|       | in the      |             | REQUEST     |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16-19 | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 11. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 21    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *           |         |    |
|       | transmit a  |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message?*   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.2.4.3.3 Specific message contents {#specific-message-contents-51 .H6}

Table 8.1.6.1.2.4.3.3-1: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.4.3.2-3)

  ----------------------------------------------------- -------------- --------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA                                  
  Information Element                                   Value/remark   Comment         Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                    
  criticalExtensions CHOICE {                                                          
  loggedMeasurementConfiguration-r16 SEQUENCE {                                        
  reportType CHOICE {                                                                  
  periodical SEQUENCE {                                                                
  loggingInterval-r16                                   ms10240        10.24 seconds   
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  ----------------------------------------------------- -------------- --------------- -----------

Table 8.1.6.1.2.4.3.3-2: Void

Table 8.1.6.1.2.4.3.3-3: *RRCSetupComplete* (steps 7 and 15, Table
8.1.6.1.2.4.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- -------------------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                                                                                
  Information Element                                  Value/remark                                      Comment                    Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                                   
  criticalExtensions CHOICE {                                                                                                       
  rrcSetupComplete SEQUENCE {                                                                                                       
  nonCriticalExtension {                                                                                                            
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG                              Step 15
  ue-MeasurementsAvailable-r16                         UE-logMeasurements-NotAvailable                   Table 8.1.6.1.2.4.3.3-3A   Step 7
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  ---------------------------------------------------- ------------------------------------------------- -------------------------- -----------

Table 8.1.6.1.2.4.3.3-3A: *UE-logMeasurements-NotAvailable* (step 7,
Table 8.1.6.1.2.5.3.2-3)

  --------------------------------------------------- -------------- --------- -----------
  Derivation path: TS 38.508-1\[4\], Table 4.6.5-15                            
  Information Element                                 Value/remark   Comment   Condition
  UE-MeasurementsAvailable-r16 ::= SEQUENCE {                                  
  logMeasAvailable-r16                                Not Present              
  --------------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.2.4.3.3-4: *UEInformationRequest* (step 20, Table
8.1.6.1.2.4.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.4.3.3-5: *UEInformationResponse* (step 21, Table
8.1.6.1.2.4.3.2-3)

+----------------------+----------------------+---------+-----------+
| Derivation path: TS  |                      |         |           |
| 38.508-1 \[4\],      |                      |         |           |
| Table 4.6.1-32B      |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| UEInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| criticalExtensions   |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ueInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasReport-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| a                    | Same value as sent   |         |           |
| bsoluteTimeStamp-r16 | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| traceReference-r16   |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| plmn-Identity-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| mcc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (3)) OF              | by SS in             |         |           |
| MCC-NMC-Digit        | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| mnc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (2..3)) OF           | by SS in             |         |           |
| MCC-NMC-Digit        | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceId-r16          | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceRec             | Same value as sent   |         |           |
| ordingSessionRef-r16 | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| tce-Id-r16           | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasInfoList-r16  | At least 2 entries   |         |           |
| SEQUENCE (SIZE       | where at least one   |         |           |
| (1..ma               | entry complies to    |         |           |
| xLogMeasReport-r16)) | entry with index 'x' |         |           |
| OF LogMeasInfo-r16   | below. SS records    |         |           |
| SEQUENCE {           | the                  |         |           |
|                      | relativeTimeStamp    |         |           |
|                      | value for each entry |         |           |
+----------------------+----------------------+---------+-----------+
| LogMeasInfo-r16\[x\] |                      | entry x |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| locationInfo-r16     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| r                    | SS record the value  |         |           |
| elativeTimeStamp-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| servCellIdentity-r16 | Same as NR Cell 11   |         |           |
+----------------------+----------------------+---------+-----------+
| m                    |                      |         |           |
| easResultServCell-16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of NR Cell 11        |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB SEQUENCE  |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Index       | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Results     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB      | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| meas                 |                      |         |           |
| ResultNeighCells-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measR                | 1 entry              |         |           |
| esultNeighCellListNR |                      |         |           |
| SEQUENCE (SIZE       |                      |         |           |
| (1..maxFreq)) OF     |                      |         |           |
| Meas                 |                      |         |           |
| ResultLogging2NR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResul            |                      | entry 1 |           |
| tLogging2NR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| carrierFreq-r16      | Same as NR Cell 1    |         |           |
+----------------------+----------------------+---------+-----------+
| mea                  | 1 entry              |         |           |
| sResultListLoggingNR |                      |         |           |
|                      |                      |         |           |
| -r16 SEQUENCE (SIZE  |                      |         |           |
| (1..maxCellReport))  |                      |         |           |
| OF                   |                      |         |           |
| Mea                  |                      |         |           |
| sResultLoggingNR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResu             |                      | entry 1 |           |
| ltLoggingNR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId-r16       | Same as NR Cell 1    |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of NR Cell 1         |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB-r16  | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measResu             | Not present          |         |           |
| ltNeighCellListEUTRA |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| anyCellS             | Not present          |         |           |
| electionDetected-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasAvailable-r16 | Not present          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

###### 8.1.6.1.2.5 Logged MDT/ RRC\_IDLE / Logging and reporting / event-based trigger

##### 8.1.6.1.2.5.1 Test Purpose (TP) {#test-purpose-tp-52 .H6}

\(1\)

**with** { UE in NR RRC\_IDLE state camping normally on an NR cell where
reportType is set to eventTriggered and eventType is set to eventL1 }

**ensure that** {

**when** { T330 is running }

**then** { UE is logging serving cell idle mode measurements only when
the conditions indicated by the eventL1 are met }

}

##### 8.1.6.1.2.5.2 Conformance requirements {#conformance-requirements-52 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3, 5.5a.3.2, 5.7.10.3
and 6.2.2. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

4\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical* in the
*VarLogMeasConfig*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*:

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in the *VarLogMeasConfig*;

2\> else if the *reportType* is set to *eventTriggered*, and *eventType*
is set to *outOfCoverage*:

3\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the UE is in any cell
selection state;

3\> perform the logging immediately upon transitioning from the any cell
selection state to the camped normally state;

2\> else if the *reportType* is set to *eventTriggered* and *eventType*
is set to *eventL1*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*;

4\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the conditions
indicated by the *eventL1* are met;

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if detailed location information became available during the last
logging interval, set the content of the *locationInfo* as in 5.3.3.7:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> set *anyCellSelectionDetected* to indicate the detection of no
suitable or no acceptable cell found;

4\> set the *servCellIdentity* to indicate global cell identity of the
last logged cell that the UE was camping on;

4\> set the *measResultServingCell* to include the quantities of the
last logged cell the UE was camping on;

3\> else:

4\> set the *servCellIdentity* to indicate global cell identity of the
cell the UE is camping on;

4\> set the *measResultServingCell* to include the quantities of the
cell the UE is camping on;

4\> if available, set the *measResultNeighCells*, in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements that became available during the last logging interval
for at most the following number of neighbouring cells: 6
intra-frequency and 3 inter-frequency neighbours per frequency as well
as 3 inter-RAT neighbours, per frequency/ set of frequencies per RAT and
according to the following:

5\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation in RRC\_IDLE or RRC\_INACTIVE,
which are performed in accordance with the performance requirements as
specified in TS 38.133 \[14\].

2\> when the memory reserved for the logged measurement information
becomes full, stop timer T330 and perform the same actions as performed
upon expiry of T330, as specified in 5.5a.1.4.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

\[TS 38.331, clause 6.2.2\]

##### -- LoggedMeasurementConfiguration {#loggedmeasurementconfiguration-3 .H6}

The *LoggedMeasurementConfiguration* message is used to perform logging
of measurement results while in RRC\_IDLE or RRC\_INACTIVE. It is used
to transfer the logged measurement configuration for network performance
optimisation.

> Signalling radio bearer: SRB1
>
> RLC-SAP: AM
>
> Logical channel: DCCH
>
> Direction: Network to UE

***LoggedMeasurementConfiguration message***

\-- ASN1START

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-START

LoggedMeasurementConfiguration-r16 ::= SEQUENCE {

criticalExtensions CHOICE {

loggedMeasurementConfiguration-r16
LoggedMeasurementConfiguration-r16-IEs,

criticalExtensionsFuture SEQUENCE {}

}

}

LoggedMeasurementConfiguration-r16-IEs ::= SEQUENCE {

traceReference-r16 TraceReference-r16,

traceRecordingSessionRef-r16 OCTET STRING (SIZE (2)),

tce-Id-r16 OCTET STRING (SIZE (1)),

absoluteTimeInfo-r16 AbsoluteTimeInfo-r16,

areaConfiguration-r16 AreaConfiguration-r16 OPTIONAL, \--Need R

plmn-IdentityList-r16 PLMN-IdentityList2-r16 OPTIONAL, \--Need R

bt-NameList-r16 SetupRelease {BT-NameList-r16} OPTIONAL, \--Need M

wlan-NameList-r16 SetupRelease {WLAN-NameList-r16} OPTIONAL, \--Need M

sensor-NameList-r16 SetupRelease {Sensor-NameList-r16} OPTIONAL, \--Need
M

loggingDuration-r16 LoggingDuration-r16,

reportType CHOICE {

periodical LoggedPeriodicalReportConfig-r16,

eventTriggered LoggedEventTriggerConfig-r16,

\...

},

lateNonCriticalExtension OCTET STRING OPTIONAL,

nonCriticalExtension SEQUENCE {} OPTIONAL

}

LoggedPeriodicalReportConfig-r16 ::= SEQUENCE {

loggingInterval-r16 LoggingInterval-r16,

\...

}

LoggedEventTriggerConfig-r16 ::= SEQUENCE {

eventType-r16 EventType-r16,

loggingInterval-r16 LoggingInterval-r16,

\...

}

EventType-r16 ::= CHOICE {

outOfCoverage NULL,

eventL1 SEQUENCE {

l1-Threshold MeasTriggerQuantity,

hysteresis Hysteresis,

timeToTrigger TimeToTrigger

},

\...

}

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-STOP

\-- ASN1STOP

+----------------------------------------------------------------------+
| ***LoggedMeasurementConfiguration field descriptions***              |
+======================================================================+
| ***absoluteTimeInfo***                                               |
|                                                                      |
| *Indicates* the absolute time in the current cell.                   |
+----------------------------------------------------------------------+
| ***areaConfiguration***                                              |
|                                                                      |
| ***Used*** to **restrict the area in which the UE performs           |
| measurement logging to cells broadcasting either one of the included |
| cell identities or one of the included tracking area codes/          |
| frequencies**.                                                       |
+----------------------------------------------------------------------+
| ***eventType***                                                      |
|                                                                      |
| ***The value outOfCoverage indicates the UE to perform logging of    |
| measurements when the UE enters any cell selection state, and the    |
| value eventL1 indicates the UE to perform logging of measurements    |
| when the triggering condition (similar as event A2 as specified in   |
| 5.5.4.3) as configured in the event is met for the camping cell in   |
| camped normally state.***                                            |
+----------------------------------------------------------------------+
| ***plmn-IdentityList***                                              |
|                                                                      |
| **Indicates a set of PLMNs defining when the UE performs measurement |
| logging as well as the associated status indication and information  |
| retrieval i.e. the UE performs these actions when the RPLMN is part  |
| of this set of PLMNs.**                                              |
+----------------------------------------------------------------------+
| ***tce-Id***                                                         |
|                                                                      |
| ***Parameter Trace Collection Entity Id: See TS 32.422 \[52\].***    |
+----------------------------------------------------------------------+
| ***traceRecordingSessionRef***                                       |
|                                                                      |
| ***Parameter Trace Recording Session Reference: See TS 32.422        |
| \[52\].***                                                           |
+----------------------------------------------------------------------+
| ***reportType***                                                     |
|                                                                      |
| Parameter configures the type of MDT configuration, specifically     |
| Periodic MDT conifguraiton or Event Triggerd MDT configuration.      |
+----------------------------------------------------------------------+

##### 8.1.6.1.2.5.3 Test description {#test-description-50 .H6}

##### 8.1.6.1.2.5.3.1 Pre-test conditions {#pre-test-conditions-51 .H6}

System Simulator:

\- NR Cell 1.

##### UE: {#ue-40 .H6}

> \- None.

##### Preamble: {#preamble-40 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3.

##### 8.1.6.1.2.5.3.2 Test procedure sequence {#test-procedure-sequence-51 .H6}

Table 8.1.6.1.2.5.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions,
while columns marked \"T1\" is to be applied subsequently. The exact
instants on which these values shall be applied are described in the
texts in this clause.

Table 8.1.6.1.2.5.3.2-1: Time instances of cell power level in FR1

+----+-----------+---------+-----------+------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                       |
+====+===========+=========+===========+==============================+
| T0 | SS/PBCH   | dBm/SCS | -85       |                              |
|    |           |         |           |                              |
|    | SSS EPRE  |         |           |                              |
+----+-----------+---------+-----------+------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -98       | Power level is such that     |
|    |           |         |           | entry condition for eventL1  |
|    | SSS EPRE  |         |           | is satisfied *Ms + Hys \<    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+

Table 8.1.6.1.2.5.3.2-2: Time instances of cell power level in FR2

+----+-----------+---------+-----------+------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                       |
+====+===========+=========+===========+==============================+
| T0 | SS/PBCH   | dBm/SCS | -82       |                              |
|    |           |         |           |                              |
|    | SSS EPRE  |         |           |                              |
+----+-----------+---------+-----------+------------------------------+
| T1 | SS/PBCH   | dBm/SCS | -100      | Power level is such that     |
|    |           |         |           | entry condition for eventL1  |
|    | SSS EPRE  |         |           | is satisfied *Ms + Hys \<    |
|    |           |         |           | Thresh*                      |
+----+-----------+---------+-----------+------------------------------+

Table 8.1.6.1.2.5.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | SS          | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits a |             | LoggedMea   |         |    |
|       | *LoggedMea  |             | surementCon |         |    |
|       | surementCon |             | figuration* |         |    |
|       | figuration* |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | reportType  |             |             |         |    |
|       | is set to   |             |             |         |    |
|       | eve         |             |             |         |    |
|       | ntTriggered |             |             |         |    |
|       | and         |             |             |         |    |
|       | eventType   |             |             |         |    |
|       | is set to   |             |             |         |    |
|       | eventL1, to |             |             |         |    |
|       | configure   |             |             |         |    |
|       | the UE to   |             |             |         |    |
|       | perform     |             |             |         |    |
|       | logging of  |             |             |         |    |
|       | measurement |             |             |         |    |
|       | results     |             |             |         |    |
|       | while in    |             |             |         |    |
|       | RRC\_IDLE.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | Wait 30s to | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4-6   | Steps 1 to  | \-          | *-*         | \-      | \- |
|       | 3 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | Check: Does | \--\>       | NR RRC:     | 1       | F  |
|       | the UE      |             | *RRCSet     |         |    |
|       | include the |             | upComplete* |         |    |
|       | IE          |             |             |         |    |
|       | logMe       |             | 5GMM:       |         |    |
|       | asAvailable |             | SERVICE     |         |    |
|       | in the      |             | REQUEST     |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 8-11  | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | *logMea     |             |             |         |    |
|       | sReportReq* |             |             |         |    |
|       | present.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 13    | Check: Does | \--\>       | NR RRC:     | 1       | F  |
|       | the UE      |             | *           |         |    |
|       | transmit a  |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message on  |             |             |         |    |
|       | SRB1        |             |             |         |    |
|       | including   |             |             |         |    |
|       | logM        |             |             |         |    |
|       | easReport*? |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | The SS      | \-          | *-*         | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1      |             |             |         |    |
|       | levels      |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.2   |             |             |         |    |
|       | .5.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | Wait 30s to | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 17-19 | Steps 1 to  | \-          | *-*         | \-      | \- |
|       | 3 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed.   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *RRCSet     |         |    |
|       | include the |             | upComplete* |         |    |
|       | IE          |             |             |         |    |
|       | logMe       |             | 5GMM:       |         |    |
|       | asAvailable |             | SERVICE     |         |    |
|       | in the      |             | REQUEST     |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 21-24 | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of of the |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 25    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 26    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *           |         |    |
|       | transmit a  |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message on  |             |             |         |    |
|       | SRB2?*      |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.2.5.3.3 Specific message contents {#specific-message-contents-52 .H6}

Table 8.1.6.1.2.5.3.3-1: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.5.3.2-3)

  ---------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA with condition EVENTL1                                                                                            
  Information Element                                                                                              Value/remark       Comment                           Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                                                                                                     
  criticalExtensions CHOICE {                                                                                                                                           
  loggedMeasurementConfiguration-r16 SEQUENCE {                                                                                                                         
  reportType CHOICE {                                                                                                                                                   
  eventTriggered SEQUENCE {                                                                                                                                             
  eventType-r16 CHOICE {                                                                                                                                                
  eventL1 SEQUENCE {                                                                                                                                                    
  l1-Threshold CHOICE {                                                                                                                                                 
  rsrp                                                                                                             69                 -87dBm                            FR1
                                                                                                                   65 + Delta(NRfs)   SS RSRP corresponding to -91dBm   FR2
  }                                                                                                                                                                     
  hysteresis                                                                                                       0                                                    
  timeToTrigger                                                                                                    ms100              0.1s                              
  }                                                                                                                                                                     
  loggingInterval-r16                                                                                              ms2560             2.56s                             
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  }                                                                                                                                                                     
  NOTE 1: Delta(NRfs) is derived based on calibration procedure defined in the TS 38.508-1 \[4\], clause 6.1.3.3                                                        
  ---------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- -----------

Table 8.1.6.1.2.5.3.3-2: Void

Table 8.1.6.1.2.5.3.3-3: *UEInformationRequest* (step 12 and step 25,
Table 8.1.6.1.2.5.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.5.3.3-4: *UEInformationResponse* (step 13, Table
8.1.6.1.2.5.3.2-3)

  ----------------------------------------------------- -------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                            
  Information Element                                   Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                    
  ueInformationResponse-r16 SEQUENCE {                                           
  logMeasReport-r16                                     Not present              
  }                                                                              
  }                                                                              
  }                                                                              
  ----------------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.2.5.3.3-5: *RRCSetupComplete* (steps 7 and 20, Table
8.1.6.1.2.5.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- -------------------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                                                                                
  Information Element                                  Value/remark                                      Comment                    Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                                   
  criticalExtensions CHOICE {                                                                                                       
  rrcSetupComplete SEQUENCE {                                                                                                       
  nonCriticalExtension {                                                                                                            
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG                              Step 20
  ue-MeasurementsAvailable-r16                         UE-logMeasurements-NotAvailable                   Table 8.1.6.1.2.5.3.3-5A   Step 7
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  }                                                                                                                                 
  ---------------------------------------------------- ------------------------------------------------- -------------------------- -----------

Table 8.1.6.1.2.5.3.3-5A: *UE-logMeasurements-NotAvailable* (step 7,
Table 8.1.6.1.2.5.3.2-3)

  --------------------------------------------------- -------------- --------- -----------
  Derivation path: TS 38.508-1\[4\], Table 4.6.5-15                            
  Information Element                                 Value/remark   Comment   Condition
  UE-MeasurementsAvailable-r16 ::= SEQUENCE {                                  
  logMeasAvailable-r16                                Not Present              
  --------------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.2.5.3.3-6: *UEInformationResponse* (step 26, Table
8.1.6.1.2.5.3.2-3)

  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1\[4\], Table 4.6.1-32B                                                                                                                                                                                                  
  Information Element                                                                           Value/remark                                                                                                                                Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                                                
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                                        
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                                       
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                                        
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                
  }                                                                                                                                                                                                                                                   
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                  
  }                                                                                                                                                                                                                                                   
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                
  tce-Id-r16                                                                                    Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least 2 entries where at least one entry complies to entry with index 'x' below. SS records the relativeTimeStamp value for each entry             
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                                                                                           entry x   
  locationInfo-r16                                                                              Not checked                                                                                                                                           
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                                                   
  servCellIdentity-r16                                                                          Same as NR Cell 1                                                                                                                                     
  measResultServCell-16 SEQUENCE {                                                                                                                                                                                                                    
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 1                                                                                                                      
  resultsSSB SEQUENCE {                                                                                                                                                                                                                               
  best-ssb-Index                                                                                Not checked                                                                                                                                           
  best-ssb-Results                                                                              Not checked                                                                                                                                           
  numberOfGoodSSB                                                                               Not checked                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                                                     
  anyCellSelectionDetected-r16                                                                  Not present                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  logMeasAvailable-r16                                                                          Not present                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------

###### 8.1.6.1.2.6 Logged MDT/ RRC\_IDLE / Logging and reporting / event-based trigger/ out-of-coverage

##### 8.1.6.1.2.6.1 Test Purpose (TP) {#test-purpose-tp-53 .H6}

\(1\)

**with** {UE has received LoggedMeasurementConfiguration message with
reportType is set to eventTriggered and eventType is set to
outOfCoverage }

**ensure that** {

**when** { T330 is running }

**then** { UE performs the logging at regular time intervals as defined
by the loggingInterval in VarLogMeasConfig only when the UE is in any
cell selection state }

}

\(2\)

**with** {UE has received LoggedMeasurementConfiguration message with
reportType is set to eventTriggered and eventType is set to
outOfCoverage }

**ensure that** {

**when** { T330 is running }

**then** { UE performs the logging immediately upon transitioning from
the any cell selection state to the camped normally state }

}

##### 8.1.6.1.2.6.2 Conformance requirements {#conformance-requirements-53 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3, 5.5a.3.2, 5.7.10.3
and 6.2.2. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

5\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical* in the
*VarLogMeasConfig*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*:

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in the *VarLogMeasConfig*;

2\> else if the *reportType* is set to *eventTriggered*, and *eventType*
is set to *outOfCoverage*:

3\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the UE is in any cell
selection state;

3\> perform the logging immediately upon transitioning from the any cell
selection state to the camped normally state;

2\> else if the *reportType* is set to *eventTriggered* and *eventType*
is set to *eventL1*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*;

4\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the conditions
indicated by the *eventL1* are met;

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if detailed location information became available during the last
logging interval, set the content of the *locationInfo* as in 5.3.3.7:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> set *anyCellSelectionDetected* to indicate the detection of no
suitable or no acceptable cell found;

4\> set the *servCellIdentity* to indicate global cell identity of the
last logged cell that the UE was camping on;

4\> set the *measResultServingCell* to include the quantities of the
last logged cell the UE was camping on;

3\> else:

4\> set the *servCellIdentity* to indicate global cell identity of the
cell the UE is camping on;

4\> set the *measResultServingCell* to include the quantities of the
cell the UE is camping on;

4\> if available, set the *measResultNeighCells*, in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements that became available during the last logging interval
for at most the following number of neighbouring cells: 6
intra-frequency and 3 inter-frequency neighbours per frequency as well
as 3 inter-RAT neighbours, per frequency/ set of frequencies per RAT and
according to the following:

5\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation in RRC\_IDLE or RRC\_INACTIVE,
which are performed in accordance with the performance requirements as
specified in TS 38.133 \[14\].

2\> when the memory reserved for the logged measurement information
becomes full, stop timer T330 and perform the same actions as performed
upon expiry of T330, as specified in 5.5a.1.4.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

\[TS 38.331, clause 6.2.2\]

##### -- LoggedMeasurementConfiguration {#loggedmeasurementconfiguration-4 .H6}

The *LoggedMeasurementConfiguration* message is used to perform logging
of measurement results while in RRC\_IDLE or RRC\_INACTIVE. It is used
to transfer the logged measurement configuration for network performance
optimisation.

Signalling radio bearer: SRB1

RLC-SAP: AM

Logical channel: DCCH

Direction: Network to UE

***LoggedMeasurementConfiguration message***

\-- ASN1START

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-START

LoggedMeasurementConfiguration-r16 ::= SEQUENCE {

criticalExtensions CHOICE {

loggedMeasurementConfiguration-r16
LoggedMeasurementConfiguration-r16-IEs,

criticalExtensionsFuture SEQUENCE {}

}

}

LoggedMeasurementConfiguration-r16-IEs ::= SEQUENCE {

traceReference-r16 TraceReference-r16,

traceRecordingSessionRef-r16 OCTET STRING (SIZE (2)),

tce-Id-r16 OCTET STRING (SIZE (1)),

absoluteTimeInfo-r16 AbsoluteTimeInfo-r16,

areaConfiguration-r16 AreaConfiguration-r16 OPTIONAL, \--Need R

plmn-IdentityList-r16 PLMN-IdentityList2-r16 OPTIONAL, \--Need R

bt-NameList-r16 SetupRelease {BT-NameList-r16} OPTIONAL, \--Need M

wlan-NameList-r16 SetupRelease {WLAN-NameList-r16} OPTIONAL, \--Need M

sensor-NameList-r16 SetupRelease {Sensor-NameList-r16} OPTIONAL, \--Need
M

loggingDuration-r16 LoggingDuration-r16,

reportType CHOICE {

periodical LoggedPeriodicalReportConfig-r16,

eventTriggered LoggedEventTriggerConfig-r16,

\...

},

lateNonCriticalExtension OCTET STRING OPTIONAL,

nonCriticalExtension SEQUENCE {} OPTIONAL

}

LoggedPeriodicalReportConfig-r16 ::= SEQUENCE {

loggingInterval-r16 LoggingInterval-r16,

\...

}

LoggedEventTriggerConfig-r16 ::= SEQUENCE {

eventType-r16 EventType-r16,

loggingInterval-r16 LoggingInterval-r16,

\...

}

EventType-r16 ::= CHOICE {

outOfCoverage NULL,

eventL1 SEQUENCE {

l1-Threshold MeasTriggerQuantity,

hysteresis Hysteresis,

timeToTrigger TimeToTrigger

},

\...

}

\-- TAG-LOGGEDMEASUREMENTCONFIGURATION-STOP

\-- ASN1STOP

+----------------------------------------------------------------------+
| ***LoggedMeasurementConfiguration field descriptions***              |
+======================================================================+
| ***absoluteTimeInfo***                                               |
|                                                                      |
| *Indicates* the absolute time in the current cell.                   |
+----------------------------------------------------------------------+
| ***areaConfiguration***                                              |
|                                                                      |
| ***Used*** to **restrict the area in which the UE performs           |
| measurement logging to cells broadcasting either one of the included |
| cell identities or one of the included tracking area codes/          |
| frequencies**.                                                       |
+----------------------------------------------------------------------+
| ***eventType***                                                      |
|                                                                      |
| ***The value outOfCoverage indicates the UE to perform logging of    |
| measurements when the UE enters any cell selection state, and the    |
| value eventL1 indicates the UE to perform logging of measurements    |
| when the triggering condition (similar as event A2 as specified in   |
| 5.5.4.3) as configured in the event is met for the camping cell in   |
| camped normally state.***                                            |
+----------------------------------------------------------------------+
| ***plmn-IdentityList***                                              |
|                                                                      |
| **Indicates a set of PLMNs defining when the UE performs measurement |
| logging as well as the associated status indication and information  |
| retrieval i.e. the UE performs these actions when the RPLMN is part  |
| of this set of PLMNs.**                                              |
+----------------------------------------------------------------------+
| ***tce-Id***                                                         |
|                                                                      |
| ***Parameter Trace Collection Entity Id: See TS 32.422 \[52\].***    |
+----------------------------------------------------------------------+
| ***traceRecordingSessionRef***                                       |
|                                                                      |
| ***Parameter Trace Recording Session Reference: See TS 32.422        |
| \[52\].***                                                           |
+----------------------------------------------------------------------+
| ***reportType***                                                     |
|                                                                      |
| Parameter configures the type of MDT configuration, specifically     |
| Periodic MDT conifguraiton or Event Triggerd MDT configuration.      |
+----------------------------------------------------------------------+

##### 8.1.6.1.2.6.3 Test description {#test-description-51 .H6}

##### 8.1.6.1.2.6.3.1 Pre-test conditions {#pre-test-conditions-52 .H6}

System Simulator:

\- NR Cell 1.

##### UE: {#ue-41 .H6}

> \- None.

##### Preamble: {#preamble-41 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3.

##### 8.1.6.1.2.6.3.2 Test procedure sequence {#test-procedure-sequence-52 .H6}

Table 8.1.6.1.2.6.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions,
while columns marked \"T1\" is to be applied subsequently. The exact
instants on which these values shall be applied are described in the
texts in this clause.

Table 8.1.6.1.2.6.3.2-1: Time instances of cell power level in FR1

+----+-----------+---------+-----------+----------------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                                 |
+====+===========+=========+===========+========================================+
| T0 | SS/PBCH   | dBm/SCS | -85       |                                        |
|    |           |         |           |                                        |
|    | SSS EPRE  |         |           |                                        |
+----+-----------+---------+-----------+----------------------------------------+
| T1 | SS/PBCH   | dBm/SCS | Off       | Make UE go to any cell selection state |
|    |           |         |           |                                        |
|    | SSS EPRE  |         |           |                                        |
+----+-----------+---------+-----------+----------------------------------------+
| T2 | SS/PBCH   | dBm/SCS | -85       | Cell 1 become suitable cell            |
|    |           |         |           |                                        |
|    | SSS EPRE  |         |           |                                        |
+----+-----------+---------+-----------+----------------------------------------+

Table 8.1.6.1.2.6.3.2-2: Time instances of cell power level in FR2

+----+-----------+---------+-----------+----------------------------------------+
|    | Parameter | Unit    | NR Cell 1 | Remark                                 |
+====+===========+=========+===========+========================================+
| T0 | SS/PBCH   | dBm/SCS | -82       |                                        |
|    |           |         |           |                                        |
|    | SSS EPRE  |         |           |                                        |
+----+-----------+---------+-----------+----------------------------------------+
| T1 | SS/PBCH   | dBm/SCS | Off       | Make UE go to any cell selection state |
|    |           |         |           |                                        |
|    | SSS EPRE  |         |           |                                        |
+----+-----------+---------+-----------+----------------------------------------+
| T2 | SS/PBCH   | dBm/SCS | -82       | Cell 1 become suitable cell            |
|    |           |         |           |                                        |
|    | SSS EPRE  |         |           |                                        |
+----+-----------+---------+-----------+----------------------------------------+

Table 8.1.6.1.2.6.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | SS          | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits a |             | LoggedMea   |         |    |
|       | *LoggedMea  |             | surementCon |         |    |
|       | surementCon |             | figuration* |         |    |
|       | figuration* |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | reportType  |             |             |         |    |
|       | is set to   |             |             |         |    |
|       | eve         |             |             |         |    |
|       | ntTriggered |             |             |         |    |
|       | and         |             |             |         |    |
|       | eventType   |             |             |         |    |
|       | is set to   |             |             |         |    |
|       | out         |             |             |         |    |
|       | OfCoverage, |             |             |         |    |
|       | to          |             |             |         |    |
|       | configure   |             |             |         |    |
|       | the UE to   |             |             |         |    |
|       | perform     |             |             |         |    |
|       | logging of  |             |             |         |    |
|       | measurement |             |             |         |    |
|       | results.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | Wait 30s to | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4-6   | Steps 1 to  | \-          | *-*         | \-      | \- |
|       | 3 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\],      |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed.   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | Check: Does | \--\>       | NR RRC:     | 1       | F  |
|       | the UE      |             | *RRCSet     |         |    |
|       | include the |             | upComplete* |         |    |
|       | IE          |             |             |         |    |
|       | logMe       |             | 5GMM:       |         |    |
|       | asAvailable |             | SERVICE     |         |    |
|       | in the      |             | REQUEST     |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 8-11  | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\],      |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | *logMea     |             |             |         |    |
|       | sReportReq* |             |             |         |    |
|       | present.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 13    | Check: Does | \--\>       | NR RRC:     | 1       | F  |
|       | the UE      |             | *           |         |    |
|       | transmit a  |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message on  |             |             |         |    |
|       | SRB1        |             |             |         |    |
|       | including   |             |             |         |    |
|       | logM        |             |             |         |    |
|       | easReport*? |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | The SS      | \-          | *-*         | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1      |             |             |         |    |
|       | level       |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.2   |             |             |         |    |
|       | .6.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | Wait 30s to | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 17    | The SS      | \-          | \-          | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1      |             |             |         |    |
|       | level       |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T2\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.2   |             |             |         |    |
|       | .6.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 18    | Wait 10s to | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | go to camp  |             |             |         |    |
|       | normaly     |             |             |         |    |
|       | state and   |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 19    | Steps 1 to  | \-          | *-*         | \-      | \- |
|       | 3 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\],      |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed.   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20    | Check: Does | \--\>       | NR RRC:     | 1, 2    | P  |
|       | the UE      |             | *RRCSet     |         |    |
|       | include the |             | upComplete* |         |    |
|       | IE          |             |             |         |    |
|       | logMe       |             | 5GMM:       |         |    |
|       | asAvailable |             | SERVICE     |         |    |
|       | in the      |             | REQUEST     |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             |             |         |    |
|       | message?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 21-24 | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\],      |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 25    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | get         |             |             |         |    |
|       | log         |             |             |         |    |
|       | MeasReport. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 26    | Check: Does | \--\>       | NR RRC:     | 1, 2    | P  |
|       | the UE      |             | *           |         |    |
|       | transmit a  |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message on  |             |             |         |    |
|       | SRB2 with   |             |             |         |    |
|       | lo          |             |             |         |    |
|       | gMeasReport |             |             |         |    |
|       | including   |             |             |         |    |
|       | at least    |             |             |         |    |
|       | one         |             |             |         |    |
|       | LogMeasInfo |             |             |         |    |
|       | for any     |             |             |         |    |
|       | cell        |             |             |         |    |
|       | selection   |             |             |         |    |
|       | state and   |             |             |         |    |
|       | one         |             |             |         |    |
|       | LogMeasInfo |             |             |         |    |
|       | for         |             |             |         |    |
|       | tr          |             |             |         |    |
|       | ansitioning |             |             |         |    |
|       | from the    |             |             |         |    |
|       | any cell    |             |             |         |    |
|       | selection   |             |             |         |    |
|       | state to    |             |             |         |    |
|       | the camped  |             |             |         |    |
|       | normally    |             |             |         |    |
|       | state?*     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.2.6.3.3 Specific message contents {#specific-message-contents-53 .H6}

Table 8.1.6.1.2.6.3.3-1: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.6.3.2-3)

  ----------------------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA with condition EVENT and OUT-OF-COVERAGE
  ----------------------------------------------------------------------------------------------

Table 8.1.6.1.2.6.3.3-2: Void

Table 8.1.6.1.2.6.3.3-3: *RRCSetupComplete* (step 7, Table
8.1.6.1.2.6.3.2-3)

+--------------------+--------------+---------+--------------------+
|   ---------------- |              |         |                    |
| ------------------ |              |         |                    |
| ------------------ |              |         |                    |
|   Derivation pat   |              |         |                    |
| h: TS 38.508-1 \[4 |              |         |                    |
| \], Table 4.6.1-22 |              |         |                    |
|   ---------------- |              |         |                    |
| ------------------ |              |         |                    |
| ------------------ |              |         |                    |
+--------------------+--------------+---------+--------------------+
| Information        | Value/remark | Comment | Condition          |
| Element            |              |         |                    |
+--------------------+--------------+---------+--------------------+
| RRCSetupComplete   |              |         |                    |
| ::= SEQUENCE {     |              |         |                    |
+--------------------+--------------+---------+--------------------+
| criticalExtensions |              |         |                    |
| CHOICE {           |              |         |                    |
+--------------------+--------------+---------+--------------------+
| rrcSetupComplete   |              |         |                    |
| SEQUENCE {         |              |         |                    |
+--------------------+--------------+---------+--------------------+
| no                 | Checked      | Note 1  |                    |
| nCriticalExtension |              |         |                    |
| SEQUENCE {         |              |         |                    |
+--------------------+--------------+---------+--------------------+
| ue-Measure         |              |         | If                 |
| mentsAvailable-r16 |              |         | no                 |
| SEQUENCE {         |              |         | nCriticalExtension |
|                    |              |         | is present         |
+--------------------+--------------+---------+--------------------+
| lo                 | Not present  |         | If                 |
| gMeasAvailable-r16 |              |         | ue-Measure         |
|                    |              |         | mentsAvailable-r16 |
|                    |              |         | is present         |
+--------------------+--------------+---------+--------------------+
| }                  |              |         |                    |
+--------------------+--------------+---------+--------------------+
| }                  |              |         |                    |
+--------------------+--------------+---------+--------------------+
| }                  |              |         |                    |
+--------------------+--------------+---------+--------------------+
| }                  |              |         |                    |
+--------------------+--------------+---------+--------------------+

  Condition                                                                                                                                                                                                                                                                           Explanation
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------------------------------------------------------------
  If nonCriticalExtension and ue-MeasurementsAvailable-r16 are present                                                                                                                                                                                                                Contents of ue-MeasurementsAvailable-r16 shall be checked only if nonCriticalExtension and ue-MeasurementsAvailable-r16 are present
  Note 1: If the UE has no underlying information to report to the network, this information element may be absent. If this information element and ue-MeasurementsAvailable-r16 are present, further check on the contents of the ue-MeasurementsAvailable-r16 shall be performed.   

Table 8.1.6.1.2.6.3.3-4: *UEInformationRequest* (steps 12 and 25, Table
8.1.6.1.2.6.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.6.3.3-5: *UEInformationResponse* (step 13, Table
8.1.6.1.2.6.3.2-3)

  ----------------------------------------------------- -------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                            
  Information Element                                   Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                    
  ueInformationResponse-r16 SEQUENCE {                                           
  logMeasReport-r16                                     Not present              
  }                                                                              
  }                                                                              
  }                                                                              
  ----------------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.2.6.3.3-6: *RRCSetupComplete* (steps 20, Table
8.1.6.1.2.6.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension {                                                                                           
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG             Step 20
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.2.6.3.3-7: *UEInformationResponse* (step 26, Table
8.1.6.1.2.6.3.2-3)

  --------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                                                                                                                                  
  Information Element                                                                           Value/remark                                                                                                                                                                                                                 Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                                                                                                                             
  criticalExtensions CHOICE {                                                                                                                                                                                                                                                                                                          
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                                                                                                                                 
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                                                                                                                         
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                                 
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                                                                                                                        
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                                                                                                                         
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                                 
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                                                                    
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                                                                                                   
  }                                                                                                                                                                                                                                                                                                                                    
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                                 
  tce-Id-r16                                                                                    Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                                 
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least 2 entries where at least one entry complies to entry with index 'x' below. SS records the relativeTimeStamp value for each entry. And the relative TimeStamp of first entry is more than 10s before the last one.             
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                                                                                                                                                                            entry x   
  locationInfo-r16                                                                              Not checked                                                                                                                                                                                                                            
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                                                                                                                                    
  servCellIdentity-r16                                                                          Same as NR Cell 1                                                                                                                                                                                                                      
  measResultServCell-16 SEQUENCE {                                                                                                                                                                                                                                                                                                     
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 1                                                                                                                                                                                                       
  resultsSSB SEQUENCE {                                                                                                                                                                                                                                                                                                                
  best-ssb-Index                                                                                Not checked                                                                                                                                                                                                                            
  best-ssb-Results                                                                              Not checked                                                                                                                                                                                                                            
  numberOfGoodSSB                                                                               Not checked                                                                                                                                                                                                                            
  }                                                                                                                                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                                                                                                                                    
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                                                                                                                                      
  anyCellSelectionDetected-r16                                                                  Not checked                                                                                                                                                                                                                            
  }                                                                                                                                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                                                                                                                                    
  logMeasAvailable-r16                                                                          Not present                                                                                                                                                                                                                            
  }                                                                                                                                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                                                                                                                                    
  }                                                                                                                                                                                                                                                                                                                                    
  --------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------

###### 8.1.6.1.2.7 Logged MDT / Logging and reporting / Indication of logged measurements at NR reestablishment

##### 8.1.6.1.2.7.1 Test Purpose (TP) {#test-purpose-tp-54 .H6}

##### (1) {#section-105 .H6}

**with** { UE has one or more logged measurement entries stored in
VarLogMeasReport }

**ensure that** {

**when** { receiving RRCReestablishment message }

**then** { UE includes the logMeasAvailable IE in the
RRCReestablishmentComplete message }

}

##### 8.1.6.1.2.7.2 Conformance requirements {#conformance-requirements-54 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.7.5. Unless otherwise stated these
are Rel-16 requirements.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

1\> stop timer T301;

1\> consider the current cell to be the PCell;

1\> store the *nextHopChainingCount* value indicated in the
*RRCReestablishment message*;

1\> update the K~gNB~ key based on the current K~gNB~ key or the NH*,*
using the stored *nextHopChainingCount* value, as specified in TS 33.501
\[11\];

1\> derive the K~RRCenc~ and K~UPenc~ keys associated with the
previously configured *cipheringAlgorithm,* as specified in TS 33.501
\[11\];

1\> derive the K~RRCint~ and K~UPint~ keys associated with the
previously configured *integrityProtAlgorithm,* as specified in TS
33.501 \[11\].

1\> request lower layers to verify the integrity protection of the
*RRCReestablishment* message, using the previously configured algorithm
and the K~RRCint~ key;

1\> if the integrity protection check of the *RRCReestablishment*
message fails:

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\', upon which the procedure
ends;

1\> configure lower layers to resume integrity protection for SRB1 using
the previously configured algorithm and the K~RRCint~ key immediately,
i.e., integrity protection shall be applied to all subsequent messages
received and sent by the UE, including the message used to indicate the
successful completion of the procedure;

1\> configure lower layers to resume ciphering for SRB1 using the
previously configured algorithm and, the K~RRCenc~ key immediately,
i.e., ciphering shall be applied to all subsequent messages received and
sent by the UE, including the message used to indicate the successful
completion of the procedure;

1\> release the measurement gap configuration indicated by the
*measGapConfig*, if configured;

1\> set the content of *RRCReestablishmentComplete* message as follows:

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable in the RRCReestablishmentComplete*
message;

3\> if Bluetooth measurement results are included in the logged
measurements the UE has available for NR and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

4\> include the *logMeasAvailableBT* *in the RRCReestablishmentComplete*
message;

3\> if WLAN measurement results are included in the logged measurements
the UE has available for NR and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

4\> include the *logMeasAvailableWLAN* *in the
RRCReestablishmentComplete* message;

2\> if the UE has connection establishment failure or connection resume
failure information available in *VarConnEstFailReport* and if the RPLMN
is equal to *plmn-Identity* stored in *VarConnEstFailReport*:

3\> include *connEstFailInfoAvailable in the RRCReestablishmentComplete*
message;

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report; or*

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* of TS 36.331 \[10\] and if the UE is
capable of cross-RAT RLF reporting and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report* of TS 36.331 \[10\]:

3\> include *rlf-InfoAvailable in the RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

1\> the procedure ends.

##### 8.1.6.1.2.7.3 Test description {#test-description-52 .H6}

##### 8.1.6.1.2.7.3.1 Pre-test conditions {#pre-test-conditions-53 .H6}

System Simulator:

\- NR Cell 1 and NR Cell 2.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-42 .H6}

> \- None.

##### Preamble: {#preamble-42 .H6}

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.2.7.3.2 Test procedure sequence {#test-procedure-sequence-53 .H6}

Table 8.1.6.1.2.7.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. The exact instants on which these values shall be
applied are described in the texts in this clause.

Table 8.1.6.1.2.7.3.2-1: Time instances of cell power level for FR1

+--------+---------------+----------+---------------+---------------+
|        | **Parameter** | **Unit** | **NR Cell 1** | **NR Cell 2** |
+========+===============+==========+===============+===============+
| **T0** | SS/PBCH       | dBm/SCS  | -85           | -91           |
|        |               |          |               |               |
|        | SSS EPRE      |          |               |               |
+--------+---------------+----------+---------------+---------------+
| **T1** | SS/PBCH       | dBm/SCS  | Off           | -85           |
|        |               |          |               |               |
|        | SSS EPRE      |          |               |               |
+--------+---------------+----------+---------------+---------------+

Table 8.1.6.1.2.7.3.2-2: Time instances of cell power level for FR2

+--------+---------------+----------+---------------+---------------+
|        | **Parameter** | **Unit** | **NR Cell 1** | **NR Cell 2** |
+========+===============+==========+===============+===============+
| **T0** | SS/PBCH       | dBm/SCS  | -82           | -91           |
|        |               |          |               |               |
|        | SSS EPRE      |          |               |               |
+--------+---------------+----------+---------------+---------------+
| **T1** | SS/PBCH       | dBm/SCS  | Off           | -82           |
|        |               |          |               |               |
|        | SSS EPRE      |          |               |               |
+--------+---------------+----------+---------------+---------------+

Table 8.1.6.1.2.7.3.2-3: Main behaviour

+------+-------------+-------------+-------------+---------+----+
| St   | Procedure   | Message     | TP          | Verdict |    |
|      |             | Sequence    |             |         |    |
+======+=============+=============+=============+=========+====+
|      |             | U - S       | Message     |         |    |
+------+-------------+-------------+-------------+---------+----+
| 1    | SS          | \<\--       | *LoggedMea  | \-      | \- |
|      | transmits a |             | surementCon |         |    |
|      | *LoggedMea  |             | figuration* |         |    |
|      | surementCon |             |             |         |    |
|      | figuration* |             |             |         |    |
|      | message     |             |             |         |    |
|      | with        |             |             |         |    |
|      | reportType  |             |             |         |    |
|      | is set to   |             |             |         |    |
|      | '           |             |             |         |    |
|      | periodical' |             |             |         |    |
|      | and         |             |             |         |    |
|      | Logg        |             |             |         |    |
|      | ingInterval |             |             |         |    |
|      | is set to   |             |             |         |    |
|      | 'ms10240',  |             |             |         |    |
|      | to          |             |             |         |    |
|      | configure   |             |             |         |    |
|      | the UE to   |             |             |         |    |
|      | perform     |             |             |         |    |
|      | logging of  |             |             |         |    |
|      | measurement |             |             |         |    |
|      | results     |             |             |         |    |
|      | while in    |             |             |         |    |
|      | RRC\_IDLE.  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 2    | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|      | transmits   |             | RRCRelease* |         |    |
|      | an          |             |             |         |    |
|      | *           |             |             |         |    |
|      | RRCRelease* |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 3    | Wait 30s to | \-          | *-*         | \-      | \- |
|      | allow UE to |             |             |         |    |
|      | activate    |             |             |         |    |
|      | logging.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 4-11 | Steps 1 to  | \-          | \-          | \-      | \- |
|      | 8 of the    |             |             |         |    |
|      | generic     |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | in TS       |             |             |         |    |
|      | 38.508-1    |             |             |         |    |
|      | \[4\] Table |             |             |         |    |
|      | 4.5.4.2-3   |             |             |         |    |
|      | are         |             |             |         |    |
|      | executed to |             |             |         |    |
|      | s           |             |             |         |    |
|      | uccessfully |             |             |         |    |
|      | complete    |             |             |         |    |
|      | the service |             |             |         |    |
|      | request     |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | on NR Cell  |             |             |         |    |
|      | 1.          |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 12   | The SS      | \-          | *-*         | \-      | \- |
|      | changes NR  |             |             |         |    |
|      | Cell 1 and  |             |             |         |    |
|      | NR Cell 2   |             |             |         |    |
|      | levels      |             |             |         |    |
|      | according   |             |             |         |    |
|      | to the row  |             |             |         |    |
|      | \"T1\" in   |             |             |         |    |
|      | table       |             |             |         |    |
|      | 8.1.6.      |             |             |         |    |
|      | 1.2.7.3.2-1 |             |             |         |    |
|      | for FR1 or  |             |             |         |    |
|      | table       |             |             |         |    |
|      | 8.1.6.      |             |             |         |    |
|      | 1.2.7.3.2-2 |             |             |         |    |
|      | for FR2.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 13   | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | sends       |             | *RRCRe      |         |    |
|      | *RRCR       |             | establishme |         |    |
|      | eestablishm |             | ntRequest*  |         |    |
|      | entRequest* |             |             |         |    |
|      | message on  |             |             |         |    |
|      | NR Cell 2.  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 14   | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits   |             | *RRCReest   |         |    |
|      | *RRCReest   |             | ablishment* |         |    |
|      | ablishment* |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 15   | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|      | the UE      |             |             |         |    |
|      | transmit    |             | *RRCRe      |         |    |
|      | *RRCRe      |             | establishme |         |    |
|      | establishme |             | ntComplete* |         |    |
|      | ntComplete* |             |             |         |    |
|      | message     |             |             |         |    |
|      | including   |             |             |         |    |
|      | logMe       |             |             |         |    |
|      | asAvailable |             |             |         |    |
|      | IE?         |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 16   | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits   |             | *RRCRecon   |         |    |
|      | an          |             | figuration* |         |    |
|      | *RRCR       |             |             |         |    |
|      | econfigurat |             |             |         |    |
|      | ion*message |             |             |         |    |
|      | to resume   |             |             |         |    |
|      | existing    |             |             |         |    |
|      | radio       |             |             |         |    |
|      | bearer.     |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 17   | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | transmits   |             | *RRCRec     |         |    |
|      | an          |             | onfiguratio |         |    |
|      | *RRCRe      |             | ntComplete* |         |    |
|      | configurati |             |             |         |    |
|      | onComplete* |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 18   | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | sends an    |             | *UEInformat |         |    |
|      | *UEInformat |             | ionRequest* |         |    |
|      | ionRequest* |             |             |         |    |
|      | message to  |             |             |         |    |
|      | get         |             |             |         |    |
|      | lo          |             |             |         |    |
|      | gMeasReport |             |             |         |    |
|      | and         |             |             |         |    |
|      | rlf-Report. |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 19   | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | sends an    |             | *           |         |    |
|      | *           |             | UEInformati |         |    |
|      | UEInformati |             | onResponse* |         |    |
|      | onResponse* |             |             |         |    |
|      | message on  |             |             |         |    |
|      | SRB2        |             |             |         |    |
|      | including   |             |             |         |    |
|      | lo          |             |             |         |    |
|      | gMeasReport |             |             |         |    |
|      | and         |             |             |         |    |
|      | rlf-Report. |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.2.7.3.3 Specific message contents {#specific-message-contents-54 .H6}

Table 8.1.6.1.2.7.3.3-1: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.7.3.2-3)

  ----------------------------------------------------- -------------- --------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA                                  
  Information Element                                   Value/remark   Comment         Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                    
  criticalExtensions CHOICE {                                                          
  loggedMeasurementConfiguration-r16 SEQUENCE {                                        
  reportType CHOICE {                                                                  
  periodical SEQUENCE {                                                                
  loggingInterval-r16                                   ms10240        10.24 seconds   
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  ----------------------------------------------------- -------------- --------------- -----------

Table 8.1.6.1.2.7.3.3-2: *RRCReestablishmentComplete* (step 15, Table
8.1.6.1.2.7.3.2-3)

  ---------------------------------------------------- --------------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-11                                                                       
  Information Element                                  Value/remark                                              Comment   Condition
  RRCReestablishmentComplete ::= SEQUENCE {                                                                                
  criticalExtensions CHOICE {                                                                                              
  rrcReestablishmentComplete SEQUENCE {                                                                                    
  nonCriticalExtension SEQUENCE {                                                                                          
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG and RLF             
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  }                                                                                                                        
  ---------------------------------------------------- --------------------------------------------------------- --------- -----------

Table 8.1.6.1.2.7.3.3-3: *UEInformationRequest* (step 18, Table
8.1.6.1.2.7.3.2-3)

  --------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG and RLF
  --------------------------------------------------------------------------------

###### 8.1.6.1.2.8 Logged MDT / Logging and reporting / Reporting at RRC reconfiguration

##### 8.1.6.1.2.8.1 Test Purpose (TP) {#test-purpose-tp-55 .H6}

##### (1) {#section-106 .H6}

**with** { UE received LoggedMeasurementConfiguration message and has
stored *logMeas*Report in VarLogMeasReport }

**ensure that** {\
**when** { UE receives an RRCReconfiguration message including a
reconfigurationWithSyn }

**then** { UE transmits an *RRCReconfigurationComplete* message with
logMeasAvailable set to true }

}

##### (2) {#section-107 .H6}

**with** { UE having indicated availability of logged measurements in
*RRCReconfigurationComplete* message }

**ensure that** {

**when** { UE has completed intra NR handover procedure and receives a
*UEInformationRequest* message with *logMeasReportReq* present }

**then** { UE transmits an *UEInformationResponse* message including
*logMeasReport* }

}

##### 8.1.6.1.2.8.2 Conformance requirements {#conformance-requirements-55 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3 and and 5.7.10.3. Unless
otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

> 1\> if the *RRCReconfiguration* is applied due to a conditional
> reconfiguration execution upon cell selection while timer T311 is
> running, as defined in 5.3.7.3:
>
> 2\> remove all the entries within *VarConditionalReconfig*, if any;
>
> ...
>
> 1\> set the content of the *RRCReconfigurationComplete* message as
> follows:
>
> 2\> if the *RRCReconfiguration* includes the *masterCellGroup*
> containing the *reportUplinkTxDirectCurrent*:
>
> 3\> include the *uplinkTxDirectCurrentList* for each MCG serving cell
> with UL;
>
> 3\> include *uplinkDirectCurrentBWP-SUL* for each MCG serving cell
> configured with SUL carrier, if any, within the
> *uplinkTxDirectCurrentList*;
>
> 2\> if the *RRCReconfiguration* includes the *secondaryCellGroup*
> containing the *reportUplinkTxDirectCurrent*:
>
> 3\> include the *uplinkTxDirectCurrentList* for each SCG serving cell
> with UL;
>
> 3\> include *uplinkDirectCurrentBWP-SUL* for each SCG serving cell
> configured with SUL carrier, if any, within the
> *uplinkTxDirectCurrentList*;
>
> 2\> if the *RRCReconfiguration* message includes the
> *mrdc-SecondaryCellGroupConfig* with *mrdc-SecondaryCellGroup* set to
> *eutra-SCG*:
>
> 3\> include in the *eutra-SCG-Response* the E-UTRA
> *RRCConnectionReconfigurationComplete* message in accordance with TS
> 36.331 \[10\] clause 5.3.5.3;
>
> 2\> if the *RRCReconfiguration* message includes the
> *mrdc-SecondaryCellGroupConfig* with *mrdc-SecondaryCellGroup* set to
> *nr-SCG*:
>
> 3\> include in the *nr-SCG-Response* the *RRCReconfigurationComplete*
> message;
>
> 2\> if the *RRCReconfiguration* message was included in an *RRCResume*
> message:
>
> 3\> include the *RRCReconfigurationComplete* message in the
> *nr-SCG-Response* within the *scg-Response* in the *RRCResumeComplete*
> message;
>
> 2\> if the *RRCReconfiguration* message was included in E-UTRA
> *RRCConnectionResume* message:
>
> 3\> include the *RRCReconfigurationComplete* message in the E-UTRA MCG
> RRC message *RRCConnectionResumeComplete* in accordance with TS 36.331
> \[10\], clause 5.3.3.4a;
>
> 2\> if the UE has logged measurements available for NR and if the
> RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:
>
> 3\> include the *logMeasAvailable* in the *RRCReconfigurationComplete*
> message;
>
> 3\> if Bluetooth measurement results are included in the logged
> measurements the UE has available for NR and if the RPLMN is included
> in *plmn-IdentityList* stored in *VarLogMeasReport*:
>
> 4\> include the *logMeasAvailableBT* in the
> *RRCReconfigurationComplete* message;
>
> 3\> if WLAN measurement results are included in the logged
> measurements the UE has available for NR and if the RPLMN is included
> in *plmn-IdentityList* stored in *VarLogMeasReport*:
>
> 4\> include the logMeasAvailableWLAN in the RRCReconfigurationComplete
> message;
>
> ...

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.2.8.3 Test description {#test-description-53 .H6}

##### 8.1.6.1.2.8.3.1 Pre-test conditions {#pre-test-conditions-54 .H6}

##### System Simulator: {#system-simulator-40 .H6}

\- NR Cell 1 and NR Cell 2

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-43 .H6}

\- None.

##### Preamble: {#preamble-43 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3 on NR Cell 1.

##### 8.1.6.1.2.8.3.2 Test procedure sequence {#test-procedure-sequence-54 .H6}

Table 8.1.6.1.2.8.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. Row marked \"T0\" denotes the conditions after
the preamble, while the configuration marked \"T1\" shall be applied as
described in the texts in this clause.

Table 8.1.6.1.2.8.3.2-1: Power levels in FR1

+----+--------------+------+-----------+--------+--------------+
|    | Parameter    | Unit | NR Cell 1 | NR     | Remark       |
|    |              |      |           |        |              |
|    |              |      |           | Cell 2 |              |
+====+==============+======+===========+========+==============+
| T0 | SS/PBCH SSS  | dBm/ | -85       | -91    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is not       |
|    |              |      |           |        | satisfied    |
|    |              |      |           |        | for NR Cell  |
|    |              |      |           |        | 2            |
+----+--------------+------+-----------+--------+--------------+
| T1 | SS/PBCH SSS  | dBm/ | -85       | -79    | Power levels |
|    | EPRE         |      |           |        | are such     |
|    |              | SCS  |           |        | that entry   |
|    |              |      |           |        | condition    |
|    |              |      |           |        | for event A3 |
|    |              |      |           |        | is satisfied |
|    |              |      |           |        | for NR Cell  |
|    |              |      |           |        | 2            |
+----+--------------+------+-----------+--------+--------------+

Table 8.1.6.1.2.8.3.2-2: Power levels in FR2

+----+-------------+----------+--------+--------+-------------+
|    | Parameter   | Unit     | NR     | NR     | Remark      |
|    |             |          |        |        |             |
|    |             |          | Cell 1 | Cell 2 |             |
+====+=============+==========+========+========+=============+
| T0 | SS/PBCH SSS | dBm/ SCS | -91    | -100   | Power       |
|    | EPRE        |          |        |        | levels are  |
|    |             |          |        |        | such that   |
|    |             |          |        |        | entry       |
|    |             |          |        |        | condition   |
|    |             |          |        |        | for event   |
|    |             |          |        |        | A3 is not   |
|    |             |          |        |        | satisfied   |
|    |             |          |        |        | for NR Cell |
|    |             |          |        |        | 2           |
+----+-------------+----------+--------+--------+-------------+
| T1 | SS/PBCH SSS | dBm/ SCS | -91    | -82    | Power       |
|    | EPRE        |          |        |        | levels are  |
|    |             |          |        |        | such that   |
|    |             |          |        |        | entry       |
|    |             |          |        |        | condition   |
|    |             |          |        |        | for event   |
|    |             |          |        |        | A3 is       |
|    |             |          |        |        | satisfied   |
|    |             |          |        |        | for NR Cell |
|    |             |          |        |        | 2           |
+----+-------------+----------+--------+--------+-------------+

Table 8.1.6.1.2.8.3.2-3: Main behaviour

  St     Procedure                                                                                                                                                                                    Message Sequence   TP                                         Verdict   
  ------ -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ------------------------------------------ --------- ----
                                                                                                                                                                                                      U - S              Message                                              
  1      The SS transmits a *LoggedMeasurementConfiguration* message on NR Cell 1.                                                                                                                    \<\--              NR RRC: *LoggedMeasurementConfiguration*   \-        \-
  2      The SS transmits a *RRCRelease* message to release the RRC connection.                                                                                                                       \<\--              NR RRC: *RRCRelease*                       \-        \-
  3      Wait 30 seconds for the UE to perform the logging at regular time intervals.                                                                                                                 \-                 \-                                         \-        \-
  4-11   Steps 1 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                              \-                 *-*                                        \-        \-
  12     The SS transmits an *RRCReconfiguration* message including *MeasConfig* to setup intra NR measurement and reporting for intra-frequency event A3.                                            \<\--              NR RRC: *RRCReconfiguration*               \-        \-
  13     The UE transmits an *RRCReconfigurationComplete* message.                                                                                                                                    \--\>              NR RRC: *RRCReconfigurationComplete*       \-        \-
  14     The SS changes NR Cell 1 and NR Cell 2 parameters according to the row \"T1\" in tables 8.1.6.1.2.8.3.2-1/2.                                                                                 \-                 \-                                         \-        \-
  15     The UE transmits a *MeasurementReport* message to report event A3 with the measured RSRP value for NR Cell 2.                                                                                \--\>              *NR RRC: MeasurementReport*                \-        \-
  16     The SS transmits an *RRCReconfiguration* message on NR Cell 1 to order the UE to perform intra frequency handover to NR Cell 2.                                                              \<\--              NR RRC: *RRCReconfiguration*               \-        \-
  17     Check: Does the UE transmit an *RRCReconfigurationComplete* message on NR Cell 2 with *logMeasAvailable* set to true to confirm the successful completion of the intra frequency handover?   \--\>              NR RRC: *RRCReconfigurationComplete*       1         P
  18     The SS sends an *UEInformationRequest* message to get *logMeasReport*.                                                                                                                       \<\--              NR RRC: *UEInformationRequest*             \-        \-
  19     Check: Does the UE send an *UEInformationReponse message including logMeasReport?*                                                                                                           \--\>              NR RRC: *UEInformationResponse*            2         P

##### 8.1.6.1.2.8.3.3 Specific message contents {#specific-message-contents-55 .H6}

Table 8.1.6.1.2.8.3.3-1: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.8.3.2-3)

  ----------------------------------------------------- -------------- --------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA                                  
  Information Element                                   Value/remark   Comment         Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                    
  criticalExtensions CHOICE {                                                          
  loggedMeasurementConfiguration-r16 SEQUENCE {                                        
  reportType CHOICE {                                                                  
  periodical SEQUENCE {                                                                
  loggingInterval-r16                                   ms10240        10.24 seconds   
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  }                                                                                    
  ----------------------------------------------------- -------------- --------------- -----------

Table 8.1.6.1.2.8.3.3-2: *RRCReconfiguration* (step 12, Table
8.1.6.1.2.8.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13, condition NR\_MEAS
  ------------------------------------------------------------------------

Table 8.1.6.1.2.8.3.3-3: *MeasConfig* (Table 8.1.6.1.2.8.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-69                                                                                                         
  ------------------------------------------------------------------------------------------- ------------------------------------------------ ------------- ---------------
  **Information Element**                                                                     **Value/remark**                                 **Comment**   **Condition**
  MeasConfig ::= SEQUENCE {                                                                                                                                  
  measObjectToAddModList SEQUENCE (SIZE (1..maxObjectId)) OF MeasObjectToAddMod {             1 entry                                                        
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                           entry 1       
  measObjectId                                                                                1                                                              
  measObject CHOICE {                                                                                                                                        
  measObjectNR SEQUENCE {                                                                                                                                    
  ssbFrequency                                                                                ssbFrequency IE equals the ARFCN for NR Cell 1                 
  absThreshSS-BlocksConsolidation                                                             Not present                                                    
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  reportConfigToAddModList SEQUENCE (SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                        
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                         entry 1       
  reportConfigId                                                                              1                                                              
  reportConfig CHOICE {                                                                                                                                      
  reportConfigNR                                                                              ReportConfigNR-EventA3                                         
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  measIdToAddModList::= SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                1 entry                                                        
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                               entry 1       
  measId                                                                                      1                                                              
  measObjectId                                                                                1                                                              
  reportConfigId                                                                              1                                                              
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          

Table 8.1.6.1.2.8.3.3-4: *ReportConfigNR-EventA3* (Table
8.1.6.1.2.8.3.3-3)

  ----------------------------------------------------------------------------- -------------- ------------------ -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition EVENT\_A3                                     
  Information Element                                                           Value/remark   Comment            Condition
  ReportConfigNR ::= SEQUENCE {                                                                                   
  reportType CHOICE {                                                                                             
  eventTriggered SEQUENCE {                                                                                       
  eventId CHOICE {                                                                                                
  eventA3 SEQUENCE {                                                                                              
  a3-Offset CHOICE {                                                                                              
  rsrp                                                                          2              1 dB (2\*0.5 dB)   
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  reportAmount                                                                  r1                                
  reportQuantityCell SEQUENCE {                                                                                   
  rsrp                                                                          true                              
  rsrq                                                                          false                             
  sinr                                                                          false                             
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  ----------------------------------------------------------------------------- -------------- ------------------ -----------

Table 8.1.6.1.2.8.3.3-4A: *RRCReconfiguration-HO* (step 16, Table
8.1.6.1.2.8.3.2-3)

  ---------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with condition RBConfig\_KeyChange
  ---------------------------------------------------------------------------------------

Table 8.1.6.1.2.8.3.3-5: *RRCReconfigurationComplete* (step 17, Table
8.1.6.1.2.8.3.2-3)

  --------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\] Table 4.6.1-14                                                               
  Information Element                                 Value/remark                                      Comment   Condition
  RRCReconfigurationComplete ::= SEQUENCE {                                                                       
  criticalExtensions CHOICE {                                                                                     
  rrcReconfigurationComplete SEQUENCE {                                                                           
  nonCriticalExtension {                                                                                          
  nonCriticalExtension {                                                                                          
  nonCriticalExtension {                                                                                          
  ue-MeasurementsAvailable-r16                        UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  --------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.2.8.3.3-6: *UEInformationRequest* (step 18, Table
8.1.6.1.2.8.3.2-3)

  -----------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\] Table 4.6.1-32A with condition LOG
  -----------------------------------------------------------------------

Table 8.1.6.1.2.8.3.3-7: *UEInformationResponse* (step 19, Table
8.1.6.1.2.8.3.2-3)

+----------------------+----------------------+---------+-----------+
| Derivation path: TS  |                      |         |           |
| 38.508-1 \[4\] Table |                      |         |           |
| 4.6.1-32B            |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| UEInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| criticalExtensions   |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ueInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasReport-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| a                    | Same value as sent   |         |           |
| bsoluteTimeStamp-r16 | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| traceReference-r16   |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| plmn-Identity-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| mcc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (3)) OF              | by SS in             |         |           |
| MCC-NMC-Digit        | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| mnc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (2..3)) OF           | by SS in             |         |           |
| MCC-NMC-Digit        | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceId-r16          | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceRec             | Same value as sent   |         |           |
| ordingSessionRef-r16 | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| tce-Id-r16           | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasInfoList-r16  | At least 2 entries   |         |           |
| SEQUENCE (SIZE       | where at least one   |         |           |
| (1..ma               | entry complies to    |         |           |
| xLogMeasReport-r16)) | entry with index 'x' |         |           |
| OF LogMeasInfo-r16   | below. SS records    |         |           |
| SEQUENCE {           | the                  |         |           |
|                      | relativeTimeStamp    |         |           |
|                      | value for each entry |         |           |
+----------------------+----------------------+---------+-----------+
| LogMeasInfo-r16\[x\] |                      | entry x |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| locationInfo-r16     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| r                    | SS record the value  |         |           |
| elativeTimeStamp-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| servCellIdentity-r16 | Same as NR Cell 1    |         |           |
+----------------------+----------------------+---------+-----------+
| m                    |                      |         |           |
| easResultServCell-16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of NR Cell 1         |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB SEQUENCE  |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Index       | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Results     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB      | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| meas                 |                      |         |           |
| ResultNeighCells-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measR                | 1 entry              |         |           |
| esultNeighCellListNR |                      |         |           |
| SEQUENCE (SIZE       |                      |         |           |
| (1..maxFreq)) OF     |                      |         |           |
| Meas                 |                      |         |           |
| ResultLogging2NR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResul            |                      | entry 1 |           |
| tLogging2NR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| carrierFreq-r16      | Same as NR Cell 2    |         |           |
+----------------------+----------------------+---------+-----------+
| mea                  | 1 entry              |         |           |
| sResultListLoggingNR |                      |         |           |
|                      |                      |         |           |
| -r16 SEQUENCE (SIZE  |                      |         |           |
| (1..maxCellReport))  |                      |         |           |
| OF                   |                      |         |           |
| Mea                  |                      |         |           |
| sResultLoggingNR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResu             |                      | entry 1 |           |
| ltLoggingNR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId-r16       | Same as NR Cell 2    |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of NR Cell 2         |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB-r16  | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measResu             | Not present          |         |           |
| ltNeighCellListEUTRA |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| anyCellS             | Not present          |         |           |
| electionDetected-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasAvailable-r16 | Not present          |         |           |
+----------------------+----------------------+---------+-----------+
| lo                   | Not present          |         |           |
| gMeasAvailableBT-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logM                 | Not present          |         |           |
| easAvailableWLAN-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

Table 8.1.6.1.2.8.3.3-8: *RRCSetupComplete* (step 7, Table
8.1.6.1.2.8.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

###### 8.1.6.1.2.9 Logged MDT / Location information 

##### 8.1.6.1.2.9.1 Test Purpose (TP) {#test-purpose-tp-56 .H6}

##### (1) {#section-108 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and has
stored logMeasReport* with detailed

location information in *VarLogMeasReport* }

**ensure that** {

**when** { receiving UEInformationRequest message }

**then** { UE transmits UEInformationResponse messages with a
logMeasReport with locationCoordinate in the locationInfo in the logged
measurement entries }

}

##### 8.1.6.1.2.9.2 Conformance requirements {#conformance-requirements-56 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3, 5.5a.3.2, 5.3.3.7
and 5.7.10.3. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause 5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

...

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if location information became available during the last logging
interval, set the content of the *locationInfo* as in 5.3.3.7:

\[TS 38.331, clause 5.3.3.7\]

3\> if available, set the *locationInfo* as follows:

4\> if available, set the *commonLocationInfo* to include the detailed
location information;

4\> if available, set the *bt-LocationInfo* to include the Bluetooth
measurement results, in order of decreasing RSSI for Bluetooth beacons;

4\> if available, set the *wlan-LocationInfo* to include the WLAN
measurement results, in order of decreasing RSSI for WLAN APs;

4\> if available, set the *sensor-LocationInfo* to include the sensor
measurement results as follows;

5\> if available, include the *sensor-MeasurementInformation*;

5\> if available, include the sensor-MotionInformation;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.2.9.3 Test description {#test-description-54 .H6}

##### 8.1.6.1.2.9.3.1 Pre-test conditions {#pre-test-conditions-55 .H6}

System Simulator:

\- NR Cell 1 and NR Cell 11.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-44 .H6}

> \- None.

##### Preamble: {#preamble-44 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3 on Cell 1.

\- The UE\'s positioning engine (e.g. standalone GNSS receiver) should
be provided with any necessary stimulus to allow it to provide the
position. This shall be done by use of the test function Update UE
Location Information defined in TS 38.509 \[6\] clause5.6.2. Or in
addition any other suitable method may also be used.

##### 8.1.6.1.2.9.3.2 Test procedure sequence {#test-procedure-sequence-55 .H6}

Table 8.1.6.1.2.9.3.2-1/2 illustrate the downlink power levels and other
changing parameters to be applied for the cell at various time instants
of the test execution. The exact instants on which these values shall be
applied are described in the texts in this clause.

Table 8.1.6.1.2.9.3.2-1: Time instances of cell power level for FR1

+--------+----------+----------+----------+----------+----------+
|        | **Par    | **Unit** | **NR     | **NR     | **       |
|        | ameter** |          | Cell 1** | Cell     | Remark** |
|        |          |          |          | 11**     |          |
+========+==========+==========+==========+==========+==========+
| **T0** | SS/PBCH  | dBm/SCS  | -78      | -85      | NR Cell  |
|        |          |          |          |          | 1        |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+
| **T1** | SS/PBCH  | dBm/SCS  | -85      | -78      | NR Cell  |
|        |          |          |          |          | 11       |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+

Table 8.1.6.1.2.9.3.2-2: Time instances of cell power level for FR2

+--------+----------+----------+----------+----------+----------+
|        | **Par    | **Unit** | **NR     | **NR     | **       |
|        | ameter** |          | Cell 1** | Cell     | Remark** |
|        |          |          |          | 11**     |          |
+========+==========+==========+==========+==========+==========+
| **T0** | SS/PBCH  | dBm/SCS  | -82      | -91      | NR Cell  |
|        |          |          |          |          | 1        |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+
| **T1** | SS/PBCH  | dBm/SCS  | -91      | -82      | NR Cell  |
|        |          |          |          |          | 11       |
|        | SSS EPRE |          |          |          | becomes  |
|        |          |          |          |          | the      |
|        |          |          |          |          | highest  |
|        |          |          |          |          | ranked   |
|        |          |          |          |          | cell.    |
+--------+----------+----------+----------+----------+----------+

Table 8.1.6.1.2.9.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | SS          | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *LoggedMea  |         |    |
|       | *LoggedMea  |             | surementCon |         |    |
|       | surementCon |             | figuration* |         |    |
|       | figuration* |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | to          |             |             |         |    |
|       | configure   |             |             |         |    |
|       | the UE to   |             |             |         |    |
|       | perform     |             |             |         |    |
|       | logging of  |             |             |         |    |
|       | measurement |             |             |         |    |
|       | results     |             |             |         |    |
|       | while in    |             |             |         |    |
|       | RRC\_IDLE.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | Wait 5s to  | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The SS      | \-          | *-*         | \-      | \- |
|       | changes     |             |             |         |    |
|       | Cell 1 and  |             |             |         |    |
|       | Cell 11     |             |             |         |    |
|       | levels      |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.2   |             |             |         |    |
|       | .9.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | Cell 11 to  |             |             |         |    |
|       | initiate a  |             |             |         |    |
|       | tracking    |             |             |         |    |
|       | area update |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | SS transmit | \<\--       | NR RRC:     | \-      | \- |
|       | an          |             | *RRCSetup*  |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | includes    |             | *RRCSet     |         |    |
|       | the IE      |             | upComplete* |         |    |
|       | *logMea     |             |             |         |    |
|       | sAvailable* |             | 5GMM:       |         |    |
|       | in the      |             | *R          |         |    |
|       | *RRCSet     |             | EGISTRATION |         |    |
|       | upComplete* |             | REQUEST*    |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 8-10  | Steps 4 to  | \-          | *-*         | \-      | \- |
|       | 6a1 of      |             |             |         |    |
|       | generic     |             |             |         |    |
|       | test        |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed   |             |             |         |    |
|       | on Cell 11. |             |             |         |    |
|       |             |             |             |         |    |
|       | NOTE: The   |             |             |         |    |
|       | UE performs |             |             |         |    |
|       | a           |             |             |         |    |
|       | R           |             |             |         |    |
|       | EGISTRATION |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | update the  |             |             |         |    |
|       | r           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | of the      |             |             |         |    |
|       | actual      |             |             |         |    |
|       | tracking    |             |             |         |    |
|       | area and    |             |             |         |    |
|       | the RRC     |             |             |         |    |
|       | connection  |             |             |         |    |
|       | is          |             |             |         |    |
|       | released.   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11-18 | Steps 1 to  | \-          | *-*         | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 19    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | Cell 11.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *           |         |    |
|       | transmit a  |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message*    |             |             |         |    |
|       | where the   |             |             |         |    |
|       | IE          |             |             |         |    |
|       | *CommonL    |             |             |         |    |
|       | ocationInfo |             |             |         |    |
|       | is          |             |             |         |    |
|       | present?*   |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.2.9.3.3 Specific message contents {#specific-message-contents-56 .H6}

Table 8.1.6.1.2.9.3.3-1: *LoggedMeasurementConfiguration* (step 1, Table
8.1.6.1.2.9.3.2-3)

  -------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA with condition PERIODICAL
  -------------------------------------------------------------------------------

Table 8.1.6.1.2.9.3.3-2: *RRCSetupComplete* (step 7, Table
8.1.6.1.2.9.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.2.9.3.3-3: *UEInformationRequest* (step 19, Table
8.1.6.1.2.9.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.9.3.3-4: *UEInformationResponse* (step 20, Table
8.1.6.1.2.9.3.2-3)

+----------------------+----------------------+---------+-----------+
| Derivation path: TS  |                      |         |           |
| 38.508-1 \[4\],      |                      |         |           |
| Table 4.6.1-32B      |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| UEInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| criticalExtensions   |                      |         |           |
| CHOICE {             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ueInf                |                      |         |           |
| ormationResponse-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasReport-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| a                    | Same value as sent   |         |           |
| bsoluteTimeStamp-r16 | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| traceReference-r16   |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| plmn-Identity-r16    |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| mcc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (3)) OF              | by SS in             |         |           |
| MCC-NMC-Digit        | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| mnc SEQUENCE (SIZE   | Same value as sent   |         |           |
| (2..3)) OF           | by SS in             |         |           |
| MCC-NMC-Digit        | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceId-r16          | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | LoggedMeas           |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1            |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| traceRec             | Same value as sent   |         |           |
| ordingSessionRef-r16 | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| tce-Id-r16           | Same value as sent   |         |           |
|                      | by SS in             |         |           |
|                      | *LoggedMeas          |         |           |
|                      | urementConfiguration |         |           |
|                      | in step 1*           |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasInfoList-r16  | At least 1 entrie    |         |           |
| SEQUENCE (SIZE       | where at least one   |         |           |
| (1..ma               | entry complies to    |         |           |
| xLogMeasReport-r16)) | entry with index 'x' |         |           |
| OF LogMeasInfo-r16   | below.               |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| LogMeasInfo-r16\[x\] |                      | entry x |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| locationInfo-r16     |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| co                   |                      |         |           |
| mmonLocationInfo-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| gnss-TOD-msec-r16    | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| l                    | Not checked          |         |           |
| ocationTimestamp-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| lo                   | OCTET STRING         |         |           |
| cationCoordinate-r16 | including            |         |           |
|                      | LocationCoordinates  |         |           |
|                      | message according to |         |           |
|                      | TS 37.355            |         |           |
+----------------------+----------------------+---------+-----------+
| locationError-r16    | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| locationSource-r16   | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| velocityEstimate-r16 | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| bt-LocationInfo-r16  | Not present          |         |           |
+----------------------+----------------------+---------+-----------+
| w                    | Not present          |         |           |
| lan-LocationInfo-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| sen                  | Not present          |         |           |
| sor-LocationInfo-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| r                    | SS record the value  |         |           |
| elativeTimeStamp-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| servCellIdentity-r16 | Same as Cell 1       |         |           |
+----------------------+----------------------+---------+-----------+
| m                    |                      |         |           |
| easResultServCell-16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of Cell 1            |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB SEQUENCE  |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Index       | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| best-ssb-Results     | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB      | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| meas                 |                      |         |           |
| ResultNeighCells-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measR                | 1 entry              |         |           |
| esultNeighCellListNR |                      |         |           |
| SEQUENCE (SIZE       |                      |         |           |
| (1..maxFreq)) OF     |                      |         |           |
| Meas                 |                      |         |           |
| ResultLogging2NR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResul            |                      | entry 1 |           |
| tLogging2NR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| carrierFreq-r16      | Same as Cell 11      |         |           |
+----------------------+----------------------+---------+-----------+
| mea                  | 1 entry              |         |           |
| sResultListLoggingNR |                      |         |           |
|                      |                      |         |           |
| -r16 SEQUENCE (SIZE  |                      |         |           |
| (1..maxCellReport))  |                      |         |           |
| OF                   |                      |         |           |
| Mea                  |                      |         |           |
| sResultLoggingNR-r16 |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| MeasResu             |                      | entry 1 |           |
| ltLoggingNR-r16\[1\] |                      |         |           |
| SEQUENCE {           |                      |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId-r16       | Same as Cell 11      |         |           |
+----------------------+----------------------+---------+-----------+
| resultsSSB-Cell-r16  | MeasQuantityResults  |         |           |
|                      | of Cell 11           |         |           |
+----------------------+----------------------+---------+-----------+
| numberOfGoodSSB-r16  | Not checked          |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| measResu             | Not present          |         |           |
| ltNeighCellListEUTRA |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| anyCellS             | Not present          |         |           |
| electionDetected-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logMeasAvailable-r16 | Not present          |         |           |
+----------------------+----------------------+---------+-----------+
| lo                   | Not present          |         |           |
| gMeasAvailableBT-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| logM                 | Not present          |         |           |
| easAvailableWLAN-r16 |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

###### 8.1.6.1.2.10 Logged MDT / Maintaining logged measurement configuration / UE mobility

##### 8.1.6.1.2.10.1 Test Purpose (TP) {#test-purpose-tp-57 .H6}

##### (1) {#section-109 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and has
stored logMeasReport* in *VarLogMeasReport* }

**ensure that** {

**when** { UE reselected to a cell belong to non MDT PLMN }

**then** { UE does not indicate availability of Logged MDT measurements
}

}

##### (2) {#section-110 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and has
stored logMeasReport* in *VarLogMeasReport* }

**ensure that** {

**when** { UE reselects to a cell belong to non MDT PLMN }

**then** { UE suspends Logged MDT measurements }

}

##### (3) {#section-111 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and has*
reselected to a cell belong to non MDT PLMN }

**ensure that** {

**when** { UE returns to a cell belong to MDT PLMN }

**then** { UE indicate availability of Logged MDT measurements }

}

##### (4) {#section-112 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and has*
reselected to a cell belong to non MDT PLMN }

**ensure that** {

**when** { UE returns to a cell belong to MDT PLMN }

**then** { UE resumes Logged MDT measurements }

}

##### 8.1.6.1.2.10.2 Conformance requirements {#conformance-requirements-57 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3 and 5.7.10.3.
Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

> 1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.2.10.3 Test description {#test-description-55 .H6}

##### 8.1.6.1.2.10.3.1 Pre-test conditions {#pre-test-conditions-56 .H6}

System Simulator:

\- NR Cell 1, NR Cell 3, NR Cell 11

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

\- When NR Cell 3 is used its PLMN will be set to PLMN2.

##### UE: {#ue-45 .H6}

> \- None.

##### Preamble: {#preamble-45 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3 on NR Cell 1.

##### 8.1.6.1.2.10.3.2 Test procedure sequence {#test-procedure-sequence-56 .H6}

Table 8.1.6.1.2.10.3.2-1/2 illustrate the downlink power levels and
other changing parameters to be applied for the cell at various time
instants of the test execution. The exact instants on which these values
shall be applied are described in the texts in this clause.

Table 8.1.6.1.2.10.3.2-1: Time instances of cell power level for FR1

+----------+----------+----------+----------+----------+----------+
|          | **Par    | **Unit** | **NR     | **NR     | **NR     |
|          | ameter** |          | Cell 1** | Cell     | Cell 3** |
|          |          |          |          | 11**     |          |
+==========+==========+==========+==========+==========+==========+
| **T0**   | SS/PBCH  | dBm/SCS  | -85      | Off      | Off      |
|          |          |          |          |          |          |
|          | SSS EPRE |          |          |          |          |
+----------+----------+----------+----------+----------+----------+
| **T1**   | SS/PBCH  | dBm/SCS  | Off      | Off      | -85      |
|          |          |          |          |          |          |
|          | SSS EPRE |          |          |          |          |
+----------+----------+----------+----------+----------+----------+
| **T2**   | SS/PBCH  | dBm/SCS  | Off      | -85      | Off      |
|          |          |          |          |          |          |
|          | SSS EPRE |          |          |          |          |
+----------+----------+----------+----------+----------+----------+
| Note:    |          |          |          |          |          |
| The      |          |          |          |          |          |
| downlink |          |          |          |          |          |
| signal   |          |          |          |          |          |
| level    |          |          |          |          |          |
| unc      |          |          |          |          |          |
| ertainty |          |          |          |          |          |
| is       |          |          |          |          |          |
| s        |          |          |          |          |          |
| pecified |          |          |          |          |          |
| in TS    |          |          |          |          |          |
| 38.508-1 |          |          |          |          |          |
| \[4\]    |          |          |          |          |          |
| clause   |          |          |          |          |          |
| 6.2.2.1. |          |          |          |          |          |
+----------+----------+----------+----------+----------+----------+

Table 8.1.6.1.2.10.3.2-2: Time instances of cell power level for FR2

+----------+----------+----------+----------+----------+----------+
|          | **Par    | **Unit** | **NR     | **NR     | **NR     |
|          | ameter** |          | Cell 1** | Cell     | Cell 3** |
|          |          |          |          | 11**     |          |
+==========+==========+==========+==========+==========+==========+
| **T0**   | SS/PBCH  | dBm/SCS  | -82      | Off      | Off      |
|          |          |          |          |          |          |
|          | SSS EPRE |          |          |          |          |
+----------+----------+----------+----------+----------+----------+
| **T1**   | SS/PBCH  | dBm/SCS  | Off      | Off      | -82      |
|          |          |          |          |          |          |
|          | SSS EPRE |          |          |          |          |
+----------+----------+----------+----------+----------+----------+
| **T2**   | SS/PBCH  | dBm/SCS  | Off      | -82      | Off      |
|          |          |          |          |          |          |
|          | SSS EPRE |          |          |          |          |
+----------+----------+----------+----------+----------+----------+
| Note:    |          |          |          |          |          |
| The      |          |          |          |          |          |
| downlink |          |          |          |          |          |
| signal   |          |          |          |          |          |
| level    |          |          |          |          |          |
| unc      |          |          |          |          |          |
| ertainty |          |          |          |          |          |
| is       |          |          |          |          |          |
| s        |          |          |          |          |          |
| pecified |          |          |          |          |          |
| in TS    |          |          |          |          |          |
| 38.508-1 |          |          |          |          |          |
| \[4\]    |          |          |          |          |          |
| clause   |          |          |          |          |          |
| 6.       |          |          |          |          |          |
| 2.2.2.2. |          |          |          |          |          |
+----------+----------+----------+----------+----------+----------+

Table 8.1.6.1.2.10.3.2-3: Main behaviour

  St        Procedure                                                                                                                                                                                                          Message Sequence   TP                                         Verdict   
  --------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ------------------ ------------------------------------------ --------- ----
                                                                                                                                                                                                                               U - S              Message                                              
  1         The SS transmits a LoggedMeasurementConfiguration message on NR Cell 1.                                                                                                                                            \<\--              NR RRC: *LoggedMeasurementConfiguration*   \-        \-
  2         The SS transmits a *RRCRelease* message to release the RRC connection.                                                                                                                                             \<\--              NR RRC: *RRCRelease*                       \-        \-
  3         Wait 10 seconds for UE performing the logging at regular time intervals.                                                                                                                                           \-                 \-                                         \-        \-
  4         The SS changes NR Cell 1 and NR Cell 3 level according to the row \"T1\" in Table 8.1.6.1.2.10.3.2-1/2.                                                                                                            \-                 \-                                         \-        \-
  5-10      Steps 1 to 6a1 of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.5.2.2-1 are performed on NR Cell 3.                                                                                                    \-                 \-                                         \-        \-
  11        Wait 10 seconds for UE not to perform the logging at regular time intervals.                                                                                                                                       \-                 \-                                         \-        \-
  12        The SS transmits a *Paging* message.                                                                                                                                                                               \<\--              NR RRC: *Paging*                           \-        \-
  13        The UE transmits an *RRCRequest* message.                                                                                                                                                                          \--\>              NR RRC: *RRCRequest*                       \-        \-
  14        The SS transmits an *RRCSetup* message.                                                                                                                                                                            \<\--              NR RRC: *RRCSetup*                         \-        \-
  15        Check: Does UE transmit an *RRCSetupComplete* message with *logMeasAvailable* IE not present?                                                                                                                      \--\>              NR RRC: *RRCSetupComplete*                 1         P
  15A-15D   Steps 5 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                                                    \-                 \-                                         \-        \-
  16        The SS transmits a *RRCRelease* message to release RRC connection and move to RRC\_IDLE on NR Cell 3.                                                                                                              \<\--              NR RRC: *RRCRelease*                       \-        \-
  17        The SS changes NR Cell 1, NR Cell 11 and NR Cell 3 level according to the row \"T2\" in Table 8.1.6.1.2.10.3.2-1/2.                                                                                                \-                 \-                                         \-        \-
  18-23     Steps 1 to 6a1 of generic test procedure in TS 38.508-1 \[4\] subclause 4.9.5.2.2-1 are performed on NR Cell 11.                                                                                                   \-                 \-                                         \-        \-
  24        Wait 10 seconds for UE performing the logging at regular time intervals.                                                                                                                                           \-                 \-                                         \-        \-
  25        The SS transmits a *Paging* message.                                                                                                                                                                               \<\--              NR RRC: *Paging*                           \-        \-
  26        The UE transmits an *RRCRequest* message.                                                                                                                                                                          \--\>              NR RRC: *RRCRequest*                       \-        \-
  27        The SS transmits an *RRCSetup* message.                                                                                                                                                                            \<\--              NR RRC: *RRCSetup*                         \-        \-
  28        Check: Does UE transmit an *RRCSetupComplete* message with *logMeasAvailable* set as true?                                                                                                                         \--\>              NR RRC: *RRCSetupComplete*                 3         P
  29-31     Steps 5 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                                                    \-                 \-                                         \-        \-
  32        The SS send a *UEInformationRequest* message to get logMeasReport.                                                                                                                                                 \<\--              NR RRC: *UEInformationRequest*             \-        \-
  33        Check: Does the UE send an *UEInformationResponse* message including at least one logMeasReport with serving cell measurements for NR Cell 1 and NR Cell 11 and without serving cell measurements for NR Cell 3?   \--\>              NR RRC: *UEInformationResponse*            2, 4,     P

##### 8.1.6.1.2.10.3.3 Specific message contents {#specific-message-contents-57 .H6}

Table 8.1.6.1.2.10.3.3-1: *LoggedMeasurementConfiguration* (step 1,
Table 8.1.6.1.2.10.3.2-3)

  -------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], table 4.6.1-5AA with condition PERIODICAL
  -------------------------------------------------------------------------------

Table 8.1.6.1.2.10.3.3-1A: *RRCSetupComplete* (step 15, Table
8.1.6.1.2.10.3.2-3)

  ---------------------------------------------------- -------------- --------- --------------------------------------------
  Derivation path: TS 38.508-1 \[4\], table 4.6.1-22                            
  Information Element                                  Value/remark   Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                               
  criticalExtensions CHOICE {                                                   
  rrcSetupComplete SEQUENCE {                                                   
  nonCriticalExtension SEQUENCE {                      Checked        Note 1    
  ue-MeasurementsAvailable-r16 SEQUENCE {                                       If nonCriticalExtension is present
  logMeasAvailable-r16                                 Not present              If ue-MeasurementsAvailable-r16 is present
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- --------------------------------------------

  Condition                                                                                                                                                                                                                                                                       Explanation
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------------------------------------------------------------
  If nonCriticalExtension and ue-MeasurementsAvailable-r16 arepresent                                                                                                                                                                                                             Contents of ue-MeasurementsAvailable-r16 shall be checked only if nonCriticalExtension and ue-MeasurementsAvailable-r16 are present
  Note 1: If the UE has no underlying information to report to the network, this information element may be absent. If this information element and MeasurementsAvailable-r16 are present, further check on the contents of the ue-MeasurementsAvailable-r16 shall be performed   

Table 8.1.6.1.2.10.3.3-2: *RRCSetupComplete* (step 28, Table
8.1.6.1.2.10.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.2.10.3.3-3: *UEInformationRequest* (step 32, Table
8.1.6.1.2.10.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.10.3.3-4: *UEInformationResponse* (step 33, Table
8.1.6.1.2.10.3.2-3)

  --------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                                                                                                                             
  Information Element                                                                           Value/remark                                                                                                                                                                                                            Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                                                                                                                        
  criticalExtensions CHOICE {                                                                                                                                                                                                                                                                                                     
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                                                                                                                            
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                                                                                                                    
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                            
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                                                                                                                   
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                                                                                                                    
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                            
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                            
  }                                                                                                                                                                                                                                                                                                                               
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                                                                                              
  }                                                                                                                                                                                                                                                                                                                               
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                            
  tce-Id-r16                                                                                    Same value as sent by SS in *LoggedMeasurementConfiguration in step 1*                                                                                                                                                            
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least 2 entries where at least one entry complies to entry with index 'x' below. At least 1 entry with "servCellIdentity-r16" set to NR Cell 1 and at least 1 entry with "servCellIdentity-r16" set to NR Cell 11.             
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                                                                                                                                                                       entry x   
  locationInfo-r16                                                                              Not checked                                                                                                                                                                                                                       
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                                                                                                                               
  servCellIdentity-r16                                                                          Same as NR Cell 1 or NR Cell 11                                                                                                                                                                                                   
  measResultServCell-16 SEQUENCE {                                                                                                                                                                                                                                                                                                
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 1 or NR Cell 11                                                                                                                                                                                    
  resultsSSB SEQUENCE {                                                                                                                                                                                                                                                                                                           
  best-ssb-Index                                                                                Not checked                                                                                                                                                                                                                       
  best-ssb-Results                                                                              Not checked                                                                                                                                                                                                                       
  numberOfGoodSSB                                                                               Not checked                                                                                                                                                                                                                       
  }                                                                                                                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                                                                                                                               
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                                                                                                                                 
  anyCellSelectionDetected-r16                                                                  Not present                                                                                                                                                                                                                       
  }                                                                                                                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                                                                                                                               
  logMeasAvailable-r16                                                                          Not present                                                                                                                                                                                                                       
  logMeasAvailableBT-r16                                                                        Not present                                                                                                                                                                                                                       
  logMeasAvailableWLAN-r16                                                                      Not present                                                                                                                                                                                                                       
  }                                                                                                                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                                                                                                                               
  }                                                                                                                                                                                                                                                                                                                               
  --------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------

###### 8.1.6.1.2.11 Logged MDT / UE state transitions

##### 8.1.6.1.2.11.1 Test Purpose (TP) {#test-purpose-tp-58 .H6}

##### (1) {#section-113 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and has
stored logMeasReport* in *VarLogMeasReport* }

**ensure that** {

**when** { UE moves to RRC\_CONNECTED state }

**then** { UE maintains the Logged measurement configurations and logged
measurement reports }

}

##### (2) {#section-114 .H6}

**Void**

##### (3) {#section-115 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and* is
not in 'camped normally' state }

**ensure that** {

**when** { UE is again in 'camped normally' state on an NR cell }

**then** { UE performs logged MDT measurements }

}

##### 8.1.6.1.2.11.2 Conformance requirements {#conformance-requirements-58 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.5.4.1, 5.5.4.2 and 5.5.5.
Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical in the VarLogMeasConfig*:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in *the VarLogMeasConfig*;

3\> if the UE is in camped normally state on an NR cell and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport:*

4\> if areaConfiguration is not included in *VarLogMeasConfig*; or

4\> if the serving cell is part of the area indicated by *areaConfig* in
*areaConfiguration* in *VarLogMeasConfig*:

5\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in *the VarLogMeasConfig*;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.2.11.3 Test description {#test-description-56 .H6}

##### 8.1.6.1.2.11.3.1 Pre-test conditions {#pre-test-conditions-57 .H6}

System Simulator:

\- NR Cell 1 and NR Cell 11.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-46 .H6}

> \- None.

##### Preamble: {#preamble-46 .H6}

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.2.11.3.2 Test procedure sequence {#test-procedure-sequence-57 .H6}

Table 8.1.6.1.2.11.3.2-1/2 illustrate the downlink power levels and
other changing parameters to be applied for the cell at various time
instants of the test execution. The exact instants on which these values
shall be applied are described in the texts in this clause.

Table 8.1.6.1.2.11.3.2-1: Time instances of cell power level for FR1

+--------+---------------+----------+---------------+----------------+
|        | **Parameter** | **Unit** | **NR Cell 1** | **NR Cell 11** |
+========+===============+==========+===============+================+
| **T0** | SS/PBCH       | dBm/SCS  | -85           | Off            |
|        |               |          |               |                |
|        | SSS EPRE      |          |               |                |
+--------+---------------+----------+---------------+----------------+
| **T1** | SS/PBCH       | dBm/SCS  | Off           | Off            |
|        |               |          |               |                |
|        | SSS EPRE      |          |               |                |
+--------+---------------+----------+---------------+----------------+
| **T2** | SS/PBCH       | dBm/SCS  | Off           | -85            |
|        |               |          |               |                |
|        | SSS EPRE      |          |               |                |
+--------+---------------+----------+---------------+----------------+

Table 8.1.6.1.2.11.3.2-2: Time instances of cell power level for FR2

+--------+---------------+----------+---------------+----------------+
|        | **Parameter** | **Unit** | **NR Cell 1** | **NR Cell 11** |
+========+===============+==========+===============+================+
| **T0** | SS/PBCH       | dBm/SCS  | -82           | Off            |
|        |               |          |               |                |
|        | SSS EPRE      |          |               |                |
+--------+---------------+----------+---------------+----------------+
| **T1** | SS/PBCH       | dBm/SCS  | Off           | Off            |
|        |               |          |               |                |
|        | SSS EPRE      |          |               |                |
+--------+---------------+----------+---------------+----------------+
| **T2** | SS/PBCH       | dBm/SCS  | Off           | -82            |
|        |               |          |               |                |
|        | SSS EPRE      |          |               |                |
+--------+---------------+----------+---------------+----------------+

Table 8.1.6.1.2.11.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | SS          | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *LoggedMea  |         |    |
|       | *LoggedMea  |             | surementCon |         |    |
|       | surementCon |             | figuration* |         |    |
|       | figuration* |             |             |         |    |
|       | message     |             |             |         |    |
|       | including   |             |             |         |    |
|       | to          |             |             |         |    |
|       | configure   |             |             |         |    |
|       | the UE to   |             |             |         |    |
|       | perform     |             |             |         |    |
|       | logging of  |             |             |         |    |
|       | measurement |             |             |         |    |
|       | results     |             |             |         |    |
|       | while in    |             |             |         |    |
|       | RRC\_IDLE.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | move the UE |             |             |         |    |
|       | to          |             |             |         |    |
|       | RRC\_IDLE   |             |             |         |    |
|       | state.      |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | Wait 10s to | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The SS      | \-          | *-*         | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1 and  |             |             |         |    |
|       | NR Cell 11  |             |             |         |    |
|       | levels      |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.2.  |             |             |         |    |
|       | 11.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | Wait 15     | \-          | *-*         | \-      | \- |
|       | seconds.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | The SS      | \-          | *-*         | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1 and  |             |             |         |    |
|       | NR Cell 11  |             |             |         |    |
|       | levels      |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T2\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.2.  |             |             |         |    |
|       | 11.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7-11  | Steps 1 to  | \-          | *-*         | \-      | \- |
|       | 5 of        |             |             |         |    |
|       | generic     |             |             |         |    |
|       | test        |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed   |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 11.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12    | Wait 8      | \-          | *-*         | \-      | \- |
|       | seconds.    |             |             |         |    |
|       |             |             |             |         |    |
|       | Note: It is |             |             |         |    |
|       | checked     |             |             |         |    |
|       | that UE     |             |             |         |    |
|       | does not    |             |             |         |    |
|       | perform the |             |             |         |    |
|       | logging     |             |             |         |    |
|       | while in    |             |             |         |    |
|       | RRC         |             |             |         |    |
|       | \_CONNECTED |             |             |         |    |
|       | state.      |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 13    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | an          |             | RRCRelease* |         |    |
|       | *           |             |             |         |    |
|       | RRCRelease* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | move the UE |             |             |         |    |
|       | to          |             |             |         |    |
|       | RRC\        |             |             |         |    |
|       | _IDLEstate. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | Wait 10s to | \-          | *-*         | \-      | \- |
|       | allow UE to |             |             |         |    |
|       | activate    |             |             |         |    |
|       | logging.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15-22 | Steps 1 to  | \-          | *-*         | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | are         |             |             |         |    |
|       | executed to |             |             |         |    |
|       | s           |             |             |         |    |
|       | uccessfully |             |             |         |    |
|       | complete    |             |             |         |    |
|       | the service |             |             |         |    |
|       | request     |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 11.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 23    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 11. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 24    | Check: Does | \--\>       | NR RRC:     | 1, 3    | P  |
|       | the UE      |             | *           |         |    |
|       | transmit a  |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message*    |             |             |         |    |
|       | including   |             |             |         |    |
|       | *log        |             |             |         |    |
|       | MeasReport* |             |             |         |    |
|       | with        |             |             |         |    |
|       | serving     |             |             |         |    |
|       | cell        |             |             |         |    |
|       | m           |             |             |         |    |
|       | easurements |             |             |         |    |
|       | for NR Cell |             |             |         |    |
|       | 1 and NR    |             |             |         |    |
|       | Cell 11?    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.2.11.3.3 Specific message contents {#specific-message-contents-58 .H6}

Table 8.1.6.1.2.11.3.3-1: *LoggedMeasurementConfiguration* (step 1,
Table 8.1.6.1.2.11.3.2-3)

  -------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA with condition PERIODICAL
  -------------------------------------------------------------------------------

Table 8.1.6.1.2.11.3.3-2: *UEInformationRequest* (step 23, Table
8.1.6.1.2.11.3.2-3)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.11.3.3-3: *UEInformationResponse* (step 24, Table
8.1.6.1.2.11.3.2-3)

  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                                                                                                 
  Information Element                                                                           Value/remark                                                                                                                                                                                Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                                                                                            
  rrc-TransactionIdentifier                                                                                                                                                                                                                                                                           
  criticalExtensions CHOICE {                                                                                                                                                                                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                                                                                                
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                                                                                        
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                                                                  
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                                                                                       
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                                                                                        
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                                                                  
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                                                                  
  }                                                                                                                                                                                                                                                                                                   
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                                                                  
  }                                                                                                                                                                                                                                                                                                   
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                                                                  
  tce-Id-r16                                                                                    Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                                                                  
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least 2 entries, Where at least 1 entry with servCellIdentity-r16 set to cell Identity of NR Cell 1 and at least 1 entry with servCellIdentity-r16 set to cell Identity of NR Cell 11.             
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                                                                                                                                           entry x   
  locationInfo-r16                                                                              Not checked                                                                                                                                                                                           
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                                                                                                   
  servCellIdentity-r16                                                                          Same as NR Cell 1 or NR Cell 11                                                                                                                                                                       
  measResultServCell-16 SEQUENCE {                                                                                                                                                                                                                                                                    
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 1 or NR Cell 11                                                                                                                                                        
  resultsSSB SEQUENCE {                                                                                                                                                                                                                                                                               
  best-ssb-Index                                                                                Not checked                                                                                                                                                                                           
  best-ssb-Results                                                                              Not checked                                                                                                                                                                                           
  numberOfGoodSSB                                                                               Not checked                                                                                                                                                                                           
  }                                                                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                                                                   
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                                                                                                     
  anyCellSelectionDetected-r16                                                                  Not checked                                                                                                                                                                                           
  }                                                                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                                                                   
  logMeasAvailable-r16                                                                          Not present                                                                                                                                                                                           
  logMeasAvailableBT-r16                                                                        Not present                                                                                                                                                                                           
  logMeasAvailableWLAN-r16                                                                      Not present                                                                                                                                                                                           
  }                                                                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                                                                   
  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------

###### 8.1.6.1.2.12 Logged MDT / Release of logged MDT measurement configuration / Expire of duration timer

##### 8.1.6.1.2.12.1 Test Purpose (TP) {#test-purpose-tp-59 .H6}

##### (1) {#section-116 .H6}

**with** { UE received LoggedMeasurementConfiguration message and has
stored *logMeas*Report in VarLogMeasReport }

**ensure that** {\
**when** { The logging duration timer T330 expires }

**then** { UE releases VarLogMeasConfig and will not perform logged
measurements }

}

##### (2) {#section-117 .H6}

**with** { UE received LoggedMeasurementConfiguration message and has
stored *logMeas*Report in VarLogMeasReport }

**ensure that** {

**when** { UE has released VarlogMeasConfig due to timer T330 has
expired and UE receives *UEInformationRequest message* with
*logMeas*ReportReq present }

**then** { UE transmits an *UEInformationResponse message including
logMeas*Report }

}

##### (3) {#section-118 .H6}

**with** { UE received LoggedMeasurementConfiguration message and has
stored *logMeas*Report in VarLogMeasReport }

**ensure that** {

**when** { UE has transmitted all the stored *logMeas*Report and UE
receives *UEInformationRequest message* with *logMeas*ReportReq present
}

**then** { UE transmits an *UEInformationResponse message without
logMeas*Report }

}

##### 8.1.6.1.2.12.2 Conformance requirements {#conformance-requirements-59 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3, 5.5a.1.4,
5.5a.3.2, and 5.7.10.3. Unless otherwise stated these are Rel-16
requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

2\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical* in the
*VarLogMeasConfig*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*:

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in the *VarLogMeasConfig*;

2\> else if the *reportType* is set to *eventTriggered*, and *eventType*
is set to *outOfCoverage*:

3\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the UE is in any cell
selection state;

3\> perform the logging immediately upon transitioning from the any cell
selection state to the camped normally state;

2\> else if the *reportType* is set to *eventTriggered* and *eventType*
is set to *eventL1*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*;

4\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the conditions
indicated by the *eventL1* are met;

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if detailed location information became available during the last
logging interval, set the content of the *locationInfo* as in 5.3.3.7:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> set *anyCellSelectionDetected* to indicate the detection of no
suitable or no acceptable cell found;

4\> set the *servCellIdentity* to indicate global cell identity of the
last logged cell that the UE was camping on;

4\> set the *measResultServingCell* to include the quantities of the
last logged cell the UE was camping on;

3\> else:

4\> set the *servCellIdentity* to indicate global cell identity of the
cell the UE is camping on;

4\> set the *measResultServingCell* to include the quantities of the
cell the UE is camping on;

4\> if available, set the *measResultNeighCells*, in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements that became available during the last logging interval
for at most the following number of neighbouring cells: 6
intra-frequency and 3 inter-frequency neighbours per frequency as well
as 3 inter-RAT neighbours, per frequency/ set of frequencies per RAT and
according to the following:

5\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation in RRC\_IDLE or RRC\_INACTIVE,
which are performed in accordance with the performance requirements as
specified in TS 38.133 \[14\].

2\> when the memory reserved for the logged measurement information
becomes full, stop timer T330 and perform the same actions as performed
upon expiry of T330, as specified in 5.5a.1.4.

\[TS 38.331, clause 5.5a.1.4\]

Upon expiry of T330 the UE shall:

1\> release *VarLogMeasConfig*;

The UE is allowed to discard stored logged measurements, i.e. to release
*VarLogMeasReport*, 48 hours after T330 expiry.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.2.12.3 Test description {#test-description-57 .H6}

##### 8.1.6.1.2.12.3.1 Pre-test conditions {#pre-test-conditions-58 .H6}

System Simulator:

\- NR Cell 1.

##### UE: {#ue-47 .H6}

> \- None.

##### Preamble: {#preamble-47 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3.

##### 8.1.6.1.2.12.3.2 Test procedure sequence {#test-procedure-sequence-58 .H6}

Table 8.1.6.1.2.12.3.2-1: Main behaviour

  St      Procedure                                                                                                                                                      Message Sequence   TP                                         Verdict   
  ------- -------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ------------------------------------------ --------- ----
                                                                                                                                                                         U - S              Message                                              
  1       The SS transmits a *LoggedMeasurementConfiguration* message on NR Cell 1.                                                                                      \<\--              NR RRC: *LoggedMeasurementConfiguration*   \-        \-
  2       The SS transmits a *RRCRelease* message to release the RRC connection.                                                                                         \<\--              NR RRC: *RRCRelease*                       \-        \-
  3       Wait 30 seconds for the UE to perform the logging at regular time intervals.                                                                                   \-                 \-                                         \-        \-
  4-11    Steps 1 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                \-                 *-*                                        \-        \-
  12      Void                                                                                                                                                           \-                 *-*                                        \-        \-
  13      The SS sends an *UEInformationRequest* message to get *logMeasReport*.                                                                                         \<\--              NR RRC: *UEInformationRequest*             \-        \-
  14      The UE sends an *UEInformationResponse message* on SRB2 including *logMeasReport.*                                                                             \--\>              NR RRC: *UEInformationResponse*            \-        \-
  \-      EXCEPTION: In case the *logMeasAvailable* in *logMeasReport* is True, steps 14a1 and 14a2 will be executed.                                                    \-                 *-*                                        \-        \-
  14a1    The SS sends an *UEInformationRequest* message to get *logMeasReport*.                                                                                         \<\--              NR RRC: *UEInformationRequest*             \-        \-
  14a2    The UE sends an *UEInformationResponse message* on SRB2 including *logMeasReport.*                                                                             \--\>              NR RRC: *UEInformationResponse*            \-        \-
  15      The SS sends an *UEInformationRequest* message to get *logMeasReport*.                                                                                         \<\--              NR RRC: *UEInformationRequest*             \-        \-
  16      Check: Does the UE send an *UEInformationResponse message* on SRB1 *without logMeasReport?*                                                                    \--\>              NR RRC: *UEInformationResponse*            3         P
  17      The SS transmits a *RRCRelease* message to release the RRC connection.                                                                                         \<\--              NR RRC: *RRCRelease*                       \-        \-
  18      Wait 10 minutes for UE to perform the logging at regular time intervals as to ensure timer T330 has expired.                                                   \-                 \-                                         \-        \-
  19-26   Steps 1 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                \-                 *-*                                        \-        \-
  27      Void                                                                                                                                                           \-                 *-*                                        \-        \-
  28      The SS sends an *UEInformationRequest* message to get *logMeasReport*.                                                                                         \<\--              NR RRC: *UEInformationRequest*             \-        \-
  29      Check: Does the UE send an *UEInformationResponse message* on SRB2 including *logMeasReport?*                                                                  \--\>              NR RRC: *UEInformationResponse*            2         P
  \-      EXCEPTION: In case the *logMeasAvailable* in *logMeasReport* is True, steps 29a1 and 29a2 will be executed until all the stored *logMeas*Report transmitted.   \-                 *-*                                        \-        \-
  29a1    The SS sends an *UEInformationRequest* message to get *logMeasReport*.                                                                                         \<\--              NR RRC: *UEInformationRequest*             \-        \-
  29a2    UE sends an *UEInformationResponse message* on SRB2 including l*ogMeasReport.*                                                                                 \--\>              NR RRC: *UEInformationResponse*            \-        \-
  30      The SS transmits a *RRCRelease* message to release the RRC connection.                                                                                         \<\--              NR RRC: *RRCRelease*                       \-        \-
  31      Wait 30 seconds.                                                                                                                                               \-                 \-                                         \-        \-
  32      The SS transmits a *Paging* message on NR Cell 1.                                                                                                              \<\--              NR RRC: *Paging*                           \-        \-
  33      The UE transmits an *RRCRequest* message on NR Cell 1.                                                                                                         \--\>              NR RRC: *RRCRequest*                       \-        \-
  34      The SS transmits an *RRCSetup* message on NR Cell 1.                                                                                                           \<\--              NR RRC: *RRCSetup*                         \-        \-
  35      Check: Does UE transmit an *RRCSetupComplete* message with *logMeasAvailable* IE not present?                                                                  \--\>              NR RRC: *RRCSetupComplete*                 1         P
  36-39   Steps 5 to 8 of the generic procedure in TS 38.508-1 \[4\] Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                \-                 *-*                                        \-        \-

##### 8.1.6.1.2.12.3.3 Specific message contents {#specific-message-contents-59 .H6}

Table 8.1.6.1.2.12.3.3-1: *LoggedMeasurementConfiguration* (step 1,
Table 8.1.6.1.2.12.3.2-1)

  ------------------------------------------------------------------------------- -------------- --------------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA with condition PERIODICAL                                        
  Information Element                                                             Value/remark   Comment               Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                                                    
  criticalExtensions CHOICE {                                                                                          
  loggedMeasurementConfiguration-r16 SEQUENCE {                                                                        
  loggingDuration-r16                                                             min10          10 minutes for T330   
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    
  ------------------------------------------------------------------------------- -------------- --------------------- -----------

Table 8.1.6.1.2.12.3.3-2: *RRCSetupComplete* (step 35, Table
8.1.6.1.2.12.3.2-1)

  ---------------------------------------------------- -------------- --------- --------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                            
  Information Element                                  Value/remark   Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                               
  criticalExtensions CHOICE {                                                   
  rrcSetupComplete SEQUENCE {                                                   
  nonCriticalExtension SEQUENCE {                      Checked        Note 1    
  ue-MeasurementsAvailable-r16 SEQUENCE {                                       If nonCriticalExtension is present
  logMeasAvailable-r16                                 Not present              If ue-MeasurementsAvailable-r16 is present
  }                                                                             
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- --------------------------------------------

  Condition                                                                                                                                                                                                                                        Explanation
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ -------------------------------------------------------------------------------------------------------------------------------------
  If nonCriticalExtension and ue-MeasurementsAvailable-r16 are present                                                                                                                                                                             Contents of ue-MeasurementsAvailable-r16 shall be checked only if nonCriticalExtension and ue-MeasurementsAvailable-r16 are present
  Note 1: If the UE has no underlying information to report to the network, this information element may be absent. If this information element is present, futher check on the contents of the ue-MeasurementsAvailable-r16 shall be performed.   

Table 8.1.6.1.2.12.3.3-3: *UEInformationRequest* (steps 13, 14a1, 15, 28
and 29a1, Table 8.1.6.1.2.12.3.2-1)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.12.3.3-4: *UEInformationResponse* (steps 14, 14a2, 29
and 29a2, Table 8.1.6.1.2.12.3.2-1)

  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                                                 
  Information Element                                                                           Value/remark                                                                                                                                Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                                                
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                                        
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                  
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                                       
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                                        
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                  
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                  
  }                                                                                                                                                                                                                                                   
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                  
  }                                                                                                                                                                                                                                                   
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                  
  tce-Id-r16                                                                                    Same value as sent by SS in LoggedMeasurementConfiguration in step 1                                                                                  
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least 2 entries where at least one entry complies to entry with index 'x' below. SS records the relativeTimeStamp value for each entry             
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                                                                                           entry x   
  locationInfo-r16                                                                              Not checked                                                                                                                                           
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                                                   
  servCellIdentity-r16                                                                          Same as NR Cell 1                                                                                                                                     
  measResultServCell-16 SEQUENCE {                                                                                                                                                                                                                    
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 1                                                                                                                      
  resultsSSB SEQUENCE {                                                                                                                                                                                                                               
  best-ssb-Index                                                                                Not checked                                                                                                                                           
  best-ssb-Results                                                                              Not checked                                                                                                                                           
  numberOfGoodSSB                                                                               Not checked                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                                                     
  anyCellSelectionDetected-r16                                                                  Not present                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  logMeasAvailable-r16                                                                          Not checked                                                                                                                                           
  logMeasAvailableBT-r16                                                                        Not present                                                                                                                                           
  logMeasAvailableWLAN-r16                                                                      Not present                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------

Table 8.1.6.1.2.12.3.3-5: *UEInformationResponse* (step 16, Table
8.1.6.1.2.12.3.2-1)

  ---------------------------------------------------- -------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\] Table 4.6.1-32B                            
  Information Element                                  Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                      
  rrc-TransactionIdentifier                                                     
  criticalExtensions CHOICE {                                                   
  ueInformationResponse-r16 SEQUENCE {                                          
  logMeasReport-r16                                    Not present              
  }                                                                             
  }                                                                             
  }                                                                             
  ---------------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.2.12.3.3-6: *RRCSetupComplete* (steps 7 and 22, Table
8.1.6.1.2.12.3.2-1)

  Derivation path: TS 38.508-1 \[4\] Table 4.6.1-22                                                               
  --------------------------------------------------- ------------------------------------------------- --------- -----------
  Information Element                                 Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                 
  criticalExtensions CHOICE {                                                                                     
  rrcSetupComplete SEQUENCE {                                                                                     
  nonCriticalExtension SEQUENCE {                                                                                 
  ue-MeasurementsAvailable-r16                        UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               

###### 8.1.6.1.2.13 Logged MDT / Release of logged MDT measurement configuration / Reception of new logged measurement configuration

##### 8.1.6.1.2.13.1 Test Purpose (TP) {#test-purpose-tp-60 .H6}

##### (1) {#section-119 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and has
stored logMeasReport* in *VarLogMeasReport* }

**ensure that** {

**when** { UE receive a new *LoggedMeasurementConfiguration message* }

**then** { UE discards the *stored logMeasReport* }

}

##### (2) {#section-120 .H6}

**with** { UE received *LoggedMeasurementConfiguration message and has
stored logMeasReport* in *VarLogMeasReport* }

**ensure that** {

**when** { UE receive a new *LoggedMeasurementConfiguration message* }

**then** { UE discards the old logged measurement configuration }

}

##### 8.1.6.1.2.13.2 Conformance requirements {#conformance-requirements-60 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5 5.5a.1.3 and 5.5a.3.2.
Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

3\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable* in the *RRCSetupComplete* message;

2\> if the UE has Bluetooth logged measurements available and if the
RPLMN is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableBT* in the *RRCSetupComplete* message;

2\> if the UE has WLAN logged measurements available and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailableWLAN* in the *RRCSetupComplete*
message;

...

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* in the
*UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged first;

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable*;

3\> if the *VarLogMeasReport* includes one or more additional logged
Bluetooth measurement entries that are not included in the
*logMeasInfoList* within the *UEInformationResponse* message:

4\> include the *logMeasAvailableBT*;

3\> if the *VarLogMeasReport* includes one or more additional logged
WLAN measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailableWLAN*;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport* upon successful delivery of
the *UEInformationResponse* message confirmed by lower layers;

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

\[TS 38.331, clause 5.5a.1.3\]

Upon receiving the *LoggedMeasurementConfiguration* message the UE
shall:

1\> discard the logged measurement configuration as well as the logged
measurement information as specified in 5.5a.2;

1\> store the received *loggingDuration*, *reportType* and
*areaConfiguration*, if included, in *VarLogMeasConfig*;

1\> if the *LoggedMeasurementConfiguration* message includes
*plmn-IdentityList*:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN
as well as the PLMNs included in *plmn-IdentityList*;

1\> else:

2\> set *plmn-IdentityList* in *VarLogMeasReport* to include the RPLMN;

1\> store the received *absoluteTimeInfo*, *traceReference,*
*traceRecordingSessionRef*, and *tce-Id* in *VarLogMeasReport*;

1\> store the received *bt-NameList*, if included, in
*VarLogMeasConfig*;

1\> store the received *wlan-Namelist*, if included, in
*VarLogMeasConfig*;

1\> store the received *sensor-Namelist*, if included, in
*VarLogMeasConfig*;

1\> start timer T330 with the timer value set to the *loggingDuration*;

\[TS 38.331, clause5.5a.3.2\]

While T330 is running, the UE shall:

1\> perform the logging in accordance with the following:

2\> if the *reportType* is set to *periodical* in the
*VarLogMeasConfig*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*:

4\> perform the logging at regular time intervals, as defined by the
*loggingInterval* in the *VarLogMeasConfig*;

2\> else if the *reportType* is set to *eventTriggered*, and *eventType*
is set to *outOfCoverage*:

3\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the UE is in any cell
selection state;

3\> perform the logging immediately upon transitioning from the any cell
selection state to the camped normally state;

2\> else if the *reportType* is set to *eventTriggered* and *eventType*
is set to *eventL1*:

3\> if the UE is camping normally on an NR cell and if the RPLMN is
included in *plmn-IdentityList* stored in *VarLogMeasReport* and, if the
cell is part of the area indicated by *areaConfiguration* if configured
in *VarLogMeasConfig*;

4\> perform the logging at regular time intervals as defined by the
*loggingInterval* in *VarLogMeasConfig* only when the conditions
indicated by the *eventL1* are met;

2\> when performing the logging:

3\> set the *relativeTimeStamp* to indicate the elapsed time since the
moment at which the logged measurement configuration was received;

3\> if detailed location information became available during the last
logging interval, set the content of the *locationInfo* as in 5.3.3.7:

3\> if the UE is in any cell selection state (as specified in TS 38.304
\[20\]):

4\> set *anyCellSelectionDetected* to indicate the detection of no
suitable or no acceptable cell found;

4\> set the *servCellIdentity* to indicate global cell identity of the
last logged cell that the UE was camping on;

4\> set the *measResultServingCell* to include the quantities of the
last logged cell the UE was camping on;

3\> else:

4\> set the *servCellIdentity* to indicate global cell identity of the
cell the UE is camping on;

4\> set the *measResultServingCell* to include the quantities of the
cell the UE is camping on;

4\> if available, set the *measResultNeighCells*, in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements that became available during the last logging interval
for at most the following number of neighbouring cells: 6
intra-frequency and 3 inter-frequency neighbours per frequency as well
as 3 inter-RAT neighbours, per frequency/ set of frequencies per RAT and
according to the following:

5\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation in RRC\_IDLE or RRC\_INACTIVE,
which are performed in accordance with the performance requirements as
specified in TS 38.133 \[14\].

2\> when the memory reserved for the logged measurement information
becomes full, stop timer T330 and perform the same actions as performed
upon expiry of T330, as specified in 5.5a.1.4.

##### 8.1.6.1.2.13.3 Test description {#test-description-58 .H6}

##### 8.1.6.1.2.13.3.1 Pre-test conditions {#pre-test-conditions-59 .H6}

System Simulator:

\- NR Cell 1.

##### UE: {#ue-48 .H6}

> \- None.

##### Preamble: {#preamble-48 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3.

##### 8.1.6.1.2.13.3.2 Test procedure sequence {#test-procedure-sequence-59 .H6}

Table 8.1.6.1.2.13.3.2-1: Main behaviour

  St      Procedure                                                                                                                                                                                                                                      Message Sequence   TP                                         Verdict   
  ------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ------------------------------------------ --------- ----
                                                                                                                                                                                                                                                         U - S              Message                                              
  1       The SS transmits a *LoggedMeasurementConfiguration* message on NR Cell 1.                                                                                                                                                                      \<\--              NR RRC: *LoggedMeasurementConfiguration*   \-        \-
  2       The SS transmits a *RRCRelease* message to release the RRC connection.                                                                                                                                                                         \<\--              NR RRC: *RRCRelease*                       \-        \-
  3       Wait 30 seconds for the UE to perform the logging at regular time intervals.                                                                                                                                                                   \-                 \-                                         \-        \-
  4-11    Steps 1 to 8 of the generic procedure in TS 38.508-1 \[4\], Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                                                                               \-                 *-*                                        \-        \-
  12      Void                                                                                                                                                                                                                                           \-                 *-*                                        \-        \-
  13      The SS transmits a *LoggedMeasurementConfiguration* message on NR Cell 1.                                                                                                                                                                      \<\--              NR RRC: *LoggedMeasurementConfiguration*   \-        \-
  14      The SS sends an *UEInformationRequest* message to get *logMeasReport*.                                                                                                                                                                         \<\--              NR RRC: *UEInformationRequest*             \-        \-
  15      Check: Does the UE send an *UEInformationResponse message* on SRB1 without *logMeasReport?*                                                                                                                                                    \--\>              NR RRC: *UEInformationResponse*            1         P
  16      The SS transmits a *RRCRelease* message to release the RRC connection.                                                                                                                                                                         \<\--              NR RRC: *RRCRelease*                       \-        \-
  17      Wait 30 seconds for the UE to perform the logging at regular time intervals.                                                                                                                                                                   \-                 \-                                         \-        \-
  18-25   Steps 1 to 8 of the generic procedure in TS 38.508-1 \[4\], Table 4.5.4.2-3 are executed to successfully complete the service request procedure.                                                                                               \-                 *-*                                        \-        \-
  26      Void                                                                                                                                                                                                                                           \-                 *-*                                        \-        \-
  27      The SS sends an *UEInformationRequest* message to get *logMeasReport*.                                                                                                                                                                         \<\--              NR RRC: *UEInformationRequest*             \-        \-
  28      Check: Does the UE send an *UEInformationResponse message* on SRB2 without *logMeasReport* based on the *LoggedMeasurementConfiguration* as in step 1, but with *logMeasReport* based on the *LoggedMeasurementConfiguration* as in step 13?   \--\>              NR RRC: *UEInformationResponse*            2         P

##### 8.1.6.1.2.13.3.3 Specific message contents {#specific-message-contents-60 .H6}

Table 8.1.6.1.2.13.3.3-1: *LoggedMeasurementConfiguration* (step 1,
Table 8.1.6.1.2.13.3.2-1)

  -------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA with condition PERIODICAL
  -------------------------------------------------------------------------------

Table 8.1.6.1.2.13.3.3-1A: *LoggedMeasurementConfiguration* (step 13,
Table 8.1.6.1.2.13.3.2-1)

  ----------------------------------------------------- -------------- -------------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA                                 
  Information Element                                   Value/remark   Comment        Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                   
  criticalExtensions CHOICE {                                                         
  loggedMeasurementConfiguration-r16 SEQUENCE {                                       
  reportType CHOICE {                                                                 
  periodical SEQUENCE {                                                               
  loggingInterval-r16                                   ms5120         5.12 seconds   
  }                                                                                   
  }                                                                                   
  }                                                                                   
  }                                                                                   
  }                                                                                   
  ----------------------------------------------------- -------------- -------------- -----------

Table 8.1.6.1.2.13.3.3-2: *RRCSetupComplete* (steps 7 and 21, Table
8.1.6.1.2.13.3.2-1)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition LOG             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.2.13.3.3-3: *UEInformationRequest* (steps 14 and 27, Table
8.1.6.1.2.13.3.2-1)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.13.3.3-4: *UEInformationResponse* (step 15, Table
8.1.6.1.2.13.3.2-1)

  ----------------------------------------------------- -------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                            
  Information Element                                   Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                    
  ueInformationResponse-r16 SEQUENCE {                                           
  logMeasReport-r16                                     Not present              
  }                                                                              
  }                                                                              
  }                                                                              
  ----------------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.2.13.3.3-5: *UEInformationResponse* (step 28, Table
8.1.6.1.2.13.3.2-1)

  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                                                 
  Information Element                                                                           Value/remark                                                                                                                                Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                                                
  logMeasReport-r16 SEQUENCE {                                                                                                                                                                                                                        
  absoluteTimeStamp-r16                                                                         Same value as sent by SS in LoggedMeasurementConfiguration in step 13                                                                                 
  traceReference-r16 SEQUENCE {                                                                                                                                                                                                                       
  plmn-Identity-r16 SEQUENCE {                                                                                                                                                                                                                        
  mcc SEQUENCE (SIZE (3)) OF MCC-NMC-Digit                                                      Same value as sent by SS in LoggedMeasurementConfiguration in step 13                                                                                 
  mnc SEQUENCE (SIZE (2..3)) OF MCC-NMC-Digit                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 13                                                                                 
  }                                                                                                                                                                                                                                                   
  traceId-r16                                                                                   Same value as sent by SS in LoggedMeasurementConfiguration in step 13                                                                                 
  }                                                                                                                                                                                                                                                   
  traceRecordingSessionRef-r16                                                                  Same value as sent by SS in LoggedMeasurementConfiguration in step 13                                                                                 
  tce-Id-r16                                                                                    Same value as sent by SS in LoggedMeasurementConfiguration in step 13                                                                                 
  logMeasInfoList-r16 SEQUENCE (SIZE (1..maxLogMeasReport-r16)) OF LogMeasInfo-r16 SEQUENCE {   At least 1 entries where at least one entry complies to entry with index 'x' below. SS records the relativeTimeStamp value for each entry             
  LogMeasInfo-r16\[x\] SEQUENCE {                                                                                                                                                                                                           entry x   
  locationInfo-r16                                                                              Not checked                                                                                                                                           
  relativeTimeStamp-r16                                                                         SS record the value                                                                                                                                   
  servCellIdentity-r16                                                                          Same as NR Cell 1                                                                                                                                     
  measResultServCell-16 SEQUENCE {                                                                                                                                                                                                                    
  resultsSSB-Cell-r16                                                                           MeasQuantityResults of NR Cell 1                                                                                                                      
  resultsSSB SEQUENCE {                                                                                                                                                                                                                               
  best-ssb-Index                                                                                Not checked                                                                                                                                           
  best-ssb-Results                                                                              Not checked                                                                                                                                           
  numberOfGoodSSB                                                                               Not checked                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  measResultNeighCells-r16                                                                      Any allowed value                                                                                                                                     
  anyCellSelectionDetected-r16                                                                  Not present                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  logMeasAvailable-r16                                                                          Not present                                                                                                                                           
  logMeasAvailableBT-r16                                                                        Not present                                                                                                                                           
  logMeasAvailableWLAN-r16                                                                      Not present                                                                                                                                           
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  }                                                                                                                                                                                                                                                   
  --------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------- --------- -----------

###### 8.1.6.1.2.14 Logged MDT / RRC\_IDLE / Logging and reporting / IDC mechanism

##### 8.1.6.1.2.14.1 Test Purpose (TP) {#test-purpose-tp-61 .H6}

##### (1) {#section-121 .H6}

**with** { UE is performing measurement logging and T330 is running }

**ensure that** {

**when** { UE detects IDC problem }

**then** { UE suspend measurement logging and tag MDT report with
inDeviceCoexDetected-r17 flag in logMeasInfoList-r16 in VarLogMeasReport
}

}

##### (2) {#section-122 .H6}

**with** { UE has suspended measurement logging and T330 is running }

**ensure that** {

**when** { The IDC problems detected by the UE is resolved during the
last logging interval }

**then** { UE resume measurement logging }

}

##### 8.1.6.1.2.14.2 Conformance requirements {#conformance-requirements-61 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.5a.3.2. Unless otherwise stated these
are Rel-17 requirements.

\[TS 38.331 clause 5.5a.3.2\]

While T330 is running and SDT procedure is not ongoing, the UE shall:

1\> if measurement logging is suspended:

2\> if during the last logging interval the IDC problems detected by the
UE is resolved, resume measurement logging;

1\> if not suspended, perform the logging in accordance with the
following:

\...

2\> when performing the logging:

3\> if InterFreqTargetInfo is configured and if the UE detected IDC
problems on at least one of the frequencies included in
InterFreqTargetInfo during the last logging interval, or

3\> if InterFreqTargetInfo is not configured and if the UE detected IDC
problems during the last logging interval:

> 4\> if measResultServingCell in the VarLogMeasReport is not empty:
>
> 5\> include inDeviceCoexDetected;
>
> 5\> suspend measurement logging from the next logging interval;
>
> 4\> else:
>
> 5\> suspend measurement logging;

##### 8.1.6.1.2.14.3 Test description {#test-description-59 .H6}

##### 8.1.6.1.2.14.3.1 Pre-test conditions {#pre-test-conditions-60 .H6}

##### System Simulator: {#system-simulator-41 .H6}

\- NR Cell 14/NRf4 (2390-2400MHz for band n40), WLAN AP 1 (Cell 27) as
specified in cl. 4.13 TS 38.508-1\[4\];

##### UE: {#ue-49 .H6}

UE's WLAN is on;

##### Preamble: {#preamble-49 .H6}

The UE is in state 3N-A on NR Cell 14 according to TS 38.508-1 \[4\],
clause 4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.2.14.3.2 Test procedure sequence {#test-procedure-sequence-60 .H6}

Table 8.1.6.1.2.14.3.2-1a for FR1 illustrate the downlink power levels
and other changing parameters to be applied for the cells at various
time instants of the test execution. The exact instants on which these
values shall be applied are described in the texts in this clause. The
configuration "C1" for \"T0\" indicates the initial conditions.
Subsequent configurations marked \"T1\" and \"T2\" are applied at the
points indicated in the Main behaviour description in Table
8.1.6.1.2.14.3.2-1. The configuration "C1" for "T0" and "C2" for "T1"
are specified in TS 38.508-1 \[4\] Table 4.13-1.

Table 8.1.6.1.2.14.3.2-1a: Time instances of cell power level and
parameter changes for FR1

       Parameter                            Unit   NR Cell 14   WLAN AP 1 (Cell 27)   Remark
  ---- ------------------------------------ ------ ------------ --------------------- --------
  T0   Refer to "C1" in TS 38.508-1 \[4\]                                             
  T1   Refer to "C2" in TS 38.508-1 \[4\]                                             
  T2   Refer to "C1" in TS 38.508-1 \[4\]                                             

Table 8.1.6.1.2.14.3.2-1: Main behaviour

+--------+------------+------------+------------+------------+----+
| **St** | **P        | **Message  | **TP**     | *          |    |
|        | rocedure** | Sequence** |            | *Verdict** |    |
+========+============+============+============+============+====+
|        |            | **U - S**  | *          |            |    |
|        |            |            | *Message** |            |    |
+--------+------------+------------+------------+------------+----+
| 1      | The SS     | \<\--      | NR RRC:    | \-         | \- |
|        | transmits  |            | LoggedMeas |            |    |
|        | a          |            | urementCon |            |    |
|        | LoggedMeas |            | figuration |            |    |
|        | urementCon |            |            |            |    |
|        | figuration |            |            |            |    |
|        | message on |            |            |            |    |
|        | NR Cell    |            |            |            |    |
|        | 14.        |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 2      | The SS     | \<\--      | NR RRC:    | \-         | \- |
|        | transmits  |            | RRCRelease |            |    |
|        | a          |            |            |            |    |
|        | RRCRelease |            |            |            |    |
|        | message to |            |            |            |    |
|        | release    |            |            |            |    |
|        | the RRC    |            |            |            |    |
|        | c          |            |            |            |    |
|        | onnection. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 3      | Wait 5s    | \-         | \-         | \-         | \- |
|        | for UE to  |            |            |            |    |
|        | activate   |            |            |            |    |
|        | logging.   |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 3A     | The SS     | \-         | \-         | \-         | \- |
|        | re-adjusts |            |            |            |    |
|        | the power  |            |            |            |    |
|        | levels     |            |            |            |    |
|        | according  |            |            |            |    |
|        | to row     |            |            |            |    |
|        | \"T1\" in  |            |            |            |    |
|        | Table      |            |            |            |    |
|        | 8.1.6.1.2. |            |            |            |    |
|        | 14.3.2-1a. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 3B     | Void       | \-         | \-         | \-         | \- |
+--------+------------+------------+------------+------------+----+
| 3C     | Void       | \-         | \-         | \-         | \- |
+--------+------------+------------+------------+------------+----+
| 3D     | The UE     | \-         | \-         | \-         | \- |
|        | associates |            |            |            |    |
|        | with the   |            |            |            |    |
|        | WLAN AP    |            |            |            |    |
|        | and        |            |            |            |    |
|        | obtains    |            |            |            |    |
|        | the local  |            |            |            |    |
|        | IP         |            |            |            |    |
|        | address.   |            |            |            |    |
|        |            |            |            |            |    |
|        | Note: The  |            |            |            |    |
|        | UL signal  |            |            |            |    |
|        | to WLAN AP |            |            |            |    |
|        | shall      |            |            |            |    |
|        | generate   |            |            |            |    |
|        | IDC        |            |            |            |    |
|        | problem.   |            |            |            |    |
|        | The UE     |            |            |            |    |
|        | shall      |            |            |            |    |
|        | detect IDC |            |            |            |    |
|        | problem in |            |            |            |    |
|        | RRC\_IDLE  |            |            |            |    |
|        | in         |            |            |            |    |
|        | con        |            |            |            |    |
|        | figuration |            |            |            |    |
|        | "C2" with  |            |            |            |    |
|        | UL signal  |            |            |            |    |
|        | to WLAN    |            |            |            |    |
|        | AP.        |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 4      | Void       | \-         | \-         | \-         | \- |
+--------+------------+------------+------------+------------+----+
| 4A     | The SS     | \-         | \-         | \-         | \- |
|        | re-adjusts |            |            |            |    |
|        | the power  |            |            |            |    |
|        | levels     |            |            |            |    |
|        | according  |            |            |            |    |
|        | to row     |            |            |            |    |
|        | \"T2\" in  |            |            |            |    |
|        | Table      |            |            |            |    |
|        | 8.1.6.1.2. |            |            |            |    |
|        | 14.3.2-1a. |            |            |            |    |
|        |            |            |            |            |    |
|        | Note: UE   |            |            |            |    |
|        | shall not  |            |            |            |    |
|        | detect IDC |            |            |            |    |
|        | problem in |            |            |            |    |
|        | RRC\_IDLE  |            |            |            |    |
|        | with       |            |            |            |    |
|        | con        |            |            |            |    |
|        | figuration |            |            |            |    |
|        | "T2"       |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 5      | Wait 5s    | \-         | \-         | \-         | \- |
|        | for UE to  |            |            |            |    |
|        | resume     |            |            |            |    |
|        | logging..  |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 6-13   | Steps 1 to | \-         | \-         | \-         | \- |
|        | 8 of the   |            |            |            |    |
|        | generic    |            |            |            |    |
|        | procedure  |            |            |            |    |
|        | for NR     |            |            |            |    |
|        | RRC\       |            |            |            |    |
|        | _CONNECTED |            |            |            |    |
|        | specified  |            |            |            |    |
|        | in TS      |            |            |            |    |
|        | 38.508-1   |            |            |            |    |
|        | \[4\]      |            |            |            |    |
|        | Table      |            |            |            |    |
|        | 4.5.4.2-3  |            |            |            |    |
|        | are        |            |            |            |    |
|        | performed. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 14-20  | Void       | \-         | \-         | \-         | \- |
+--------+------------+------------+------------+------------+----+
| 21     | The SS     | \<\--      | NR RRC:    | \-         | \- |
|        | transmits  |            | UEInformat |            |    |
|        | an         |            | ionRequest |            |    |
|        | UEInformat |            |            |            |    |
|        | ionRequest |            |            |            |    |
|        | message to |            |            |            |    |
|        | get        |            |            |            |    |
|        | logM       |            |            |            |    |
|        | easReport. |            |            |            |    |
+--------+------------+------------+------------+------------+----+
| 22     | Check:     | \--\>      | NR RRC:    | 1, 2       | P  |
|        | Does the   |            | U          |            |    |
|        | UE         |            | EInformati |            |    |
|        | transmit   |            | onResponse |            |    |
|        | an         |            |            |            |    |
|        | U          |            |            |            |    |
|        | EInformati |            |            |            |    |
|        | onResponse |            |            |            |    |
|        | message    |            |            |            |    |
|        | including  |            |            |            |    |
|        | log        |            |            |            |    |
|        | MeasReport |            |            |            |    |
|        | with a     |            |            |            |    |
|        | LogMe      |            |            |            |    |
|        | asInfoList |            |            |            |    |
|        | consisting |            |            |            |    |
|        | of at      |            |            |            |    |
|        | least      |            |            |            |    |
|        | three      |            |            |            |    |
|        | L          |            |            |            |    |
|        | ogMeasInfo |            |            |            |    |
|        | entries,   |            |            |            |    |
|        | one of the |            |            |            |    |
|        | L          |            |            |            |    |
|        | ogMeasInfo |            |            |            |    |
|        | entries,   |            |            |            |    |
|        | except for |            |            |            |    |
|        | the first  |            |            |            |    |
|        | one and    |            |            |            |    |
|        | the last   |            |            |            |    |
|        | one, is    |            |            |            |    |
|        | tagged     |            |            |            |    |
|        | with       |            |            |            |    |
|        | inDev      |            |            |            |    |
|        | iceCoexDet |            |            |            |    |
|        | ected-r17? |            |            |            |    |
|        |            |            |            |            |    |
|        | Note 1:    |            |            |            |    |
|        | The        |            |            |            |    |
|        | relativ    |            |            |            |    |
|        | eTimeStamp |            |            |            |    |
|        | is         |            |            |            |    |
|        | increased  |            |            |            |    |
|        | between    |            |            |            |    |
|        | the        |            |            |            |    |
|        | subsequent |            |            |            |    |
|        | LogMe      |            |            |            |    |
|        | asInfoList |            |            |            |    |
|        | entries.   |            |            |            |    |
+--------+------------+------------+------------+------------+----+

##### 8.1.6.1.2.14.3.3 Specific message contents {#specific-message-contents-61 .H6}

Table 8.1.6.1.2.14.3.3-1: LoggedMeasurementConfiguration (step 1, Table
8.1.6.1.2.14.3.2-1)

  -------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-5AA with condition PERIODICAL
  -------------------------------------------------------------------------------

Table 8.1.6.1.2.14.3.3-2: UEInformationRequest (steps 21, Table
8.1.6.1.2.14.3.2-1)

  ------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition LOG
  ------------------------------------------------------------------------

Table 8.1.6.1.2.14.3.3-3: UEInformationResponse (step 22, Table
8.1.6.1.2.14.3.2-1)

+----------------+----------------+----------------+---------------+
| Derivation     |                |                |               |
| path: TS       |                |                |               |
| 38.508-1       |                |                |               |
| \[4\], Table   |                |                |               |
| 4.6.1-32B      |                |                |               |
+================+================+================+===============+
| **Information  | **             | **Comment**    | **Condition** |
| Element**      | Value/remark** |                |               |
+----------------+----------------+----------------+---------------+
| UEInformati    |                |                |               |
| onResponse-r16 |                |                |               |
| ::= SEQUENCE { |                |                |               |
+----------------+----------------+----------------+---------------+
| crit           |                |                |               |
| icalExtensions |                |                |               |
| CHOICE {       |                |                |               |
+----------------+----------------+----------------+---------------+
| ueInformati    |                |                |               |
| onResponse-r16 |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| log            |                |                |               |
| MeasReport-r16 |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| absolut        | Same value as  |                |               |
| eTimeStamp-r16 | sent by SS in  |                |               |
|                | Lo             |                |               |
|                | ggedMeasuremen |                |               |
|                | tConfiguration |                |               |
|                | in step 1      |                |               |
+----------------+----------------+----------------+---------------+
| trac           |                |                |               |
| eReference-r16 |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| plm            |                |                |               |
| n-Identity-r16 |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| mcc SEQUENCE   | Same value as  |                |               |
| (SIZE (3)) OF  | sent by SS in  |                |               |
| MCC-NMC-Digit  | Lo             |                |               |
|                | ggedMeasuremen |                |               |
|                | tConfiguration |                |               |
|                | in step 1      |                |               |
+----------------+----------------+----------------+---------------+
| mnc SEQUENCE   | Same value as  |                |               |
| (SIZE (2..3))  | sent by SS in  |                |               |
| OF             | Lo             |                |               |
| MCC-NMC-Digit  | ggedMeasuremen |                |               |
|                | tConfiguration |                |               |
|                | in step 1      |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| traceId-r16    | Same value as  |                |               |
|                | sent by SS in  |                |               |
|                | Lo             |                |               |
|                | ggedMeasuremen |                |               |
|                | tConfiguration |                |               |
|                | in step 1      |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| traceRecording | Same value as  |                |               |
| SessionRef-r16 | sent by SS in  |                |               |
|                | Lo             |                |               |
|                | ggedMeasuremen |                |               |
|                | tConfiguration |                |               |
|                | in step 1      |                |               |
+----------------+----------------+----------------+---------------+
| tce-Id-r16     | Same value as  |                |               |
|                | sent by SS in  |                |               |
|                | Lo             |                |               |
|                | ggedMeasuremen |                |               |
|                | tConfiguration |                |               |
|                | in step 1      |                |               |
+----------------+----------------+----------------+---------------+
| logMe          | At least 3     |                |               |
| asInfoList-r16 | entries where  |                |               |
| SEQUENCE (SIZE | at least 3     |                |               |
| (1..maxLogMe   | entry complies |                |               |
| asReport-r16)) | to the entries |                |               |
| OF             | with index     |                |               |
| L              | 'x-1', 'x',    |                |               |
| ogMeasInfo-r16 | 'x+1' below.   |                |               |
| SEQUENCE {     | SS records the |                |               |
|                | rel            |                |               |
|                | ativeTimeStamp |                |               |
|                | value for each |                |               |
|                | entry          |                |               |
+----------------+----------------+----------------+---------------+
| LogMeasI       |                | entry x-1      |               |
| nfo-r16\[x-1\] |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| lo             | Not checked    |                |               |
| cationInfo-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| relativ        | SS record the  | relativeTime   |               |
| eTimeStamp-r16 | value          | Stamp-r16\_x-1 |               |
+----------------+----------------+----------------+---------------+
| servCe         | Same as NR     |                |               |
| llIdentity-r16 | Cell 14        |                |               |
+----------------+----------------+----------------+---------------+
| measRes        | Not checked    |                |               |
| ultServCell-16 |                |                |               |
+----------------+----------------+----------------+---------------+
| measResult     |                |                |               |
| NeighCells-r16 |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| measResultN    | Not present    |                |               |
| eighCellListNR |                |                |               |
+----------------+----------------+----------------+---------------+
| measResultNeig | Not present    |                |               |
| hCellListEUTRA |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| anyCellSelecti | Not present    |                |               |
| onDetected-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| inDeviceCo     | Not present    |                |               |
| exDetected-r17 |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| LogMea         |                | entry x        |               |
| sInfo-r16\[x\] |                |                |               |
| SEQUENCE {     |                | (x can be any  |               |
|                |                | but the first  |               |
|                |                | and last entry |               |
|                |                | number within  |               |
|                |                | logMea         |               |
|                |                | sInfoList-r16) |               |
+----------------+----------------+----------------+---------------+
| lo             | Not checked    |                |               |
| cationInfo-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| relativ        | SS record the  | relativeTi     |               |
| eTimeStamp-r16 | value          | meStamp-r16\_x |               |
+----------------+----------------+----------------+---------------+
| servCe         | Same as NR     |                |               |
| llIdentity-r16 | Cell 14        |                |               |
+----------------+----------------+----------------+---------------+
| measRes        | Not checked    |                |               |
| ultServCell-16 |                |                |               |
+----------------+----------------+----------------+---------------+
| measResult     |                |                |               |
| NeighCells-r16 |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| measResultN    | Not present    |                |               |
| eighCellListNR |                |                |               |
+----------------+----------------+----------------+---------------+
| measResultNeig | Not present    |                |               |
| hCellListEUTRA |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| anyCellSelecti | Not present    |                |               |
| onDetected-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| inDeviceCo     | true           |                |               |
| exDetected-r17 |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| LogMeasI       |                | entry x+1      |               |
| nfo-r16\[x+1\] |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| lo             | Not checked    |                |               |
| cationInfo-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| relativ        | SS record the  | relativeTime   |               |
| eTimeStamp-r16 | value          | Stamp-r16\_x+1 |               |
+----------------+----------------+----------------+---------------+
| servCe         | Same as NR     |                |               |
| llIdentity-r16 | Cell 14        |                |               |
+----------------+----------------+----------------+---------------+
| measRes        | Not checked    |                |               |
| ultServCell-16 |                |                |               |
+----------------+----------------+----------------+---------------+
| measResult     |                |                |               |
| NeighCells-r16 |                |                |               |
| SEQUENCE {     |                |                |               |
+----------------+----------------+----------------+---------------+
| measResultN    | Not present    |                |               |
| eighCellListNR |                |                |               |
+----------------+----------------+----------------+---------------+
| measResultNeig | Not present    |                |               |
| hCellListEUTRA |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| anyCellSelecti | Not present    |                |               |
| onDetected-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| inDeviceCo     | Not present    |                |               |
| exDetected-r17 |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| logMea         | Not present    |                |               |
| sAvailable-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| logMeasA       | Not present    |                |               |
| vailableBT-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| logMeasAva     | Not present    |                |               |
| ilableWLAN-r16 |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+
| }              |                |                |               |
+----------------+----------------+----------------+---------------+

###### 8.1.6.1.2.15 Logged MDT / RRC\_IDLE / early measurements

##### 8.1.6.1.2.15.1 Test Purpose (TP) {#test-purpose-tp-62 .H6}

##### (1) {#section-123 .H6}

**with** { UE in NR RRC\_IDLE state and has already received
*LoggedMeasurementConfiguration* message sending by the network }

**ensure that** {

**when** { The earlyMeasIndication-r17 is configured in
*LoggedMeasurementConfiguration* }

**then** { UE is allowed to log measurements on early measurement
frequencies in logged MDT }

}

##### (2) {#section-124 .H6}

**with** { UE in NR RRC\_IDLE state and has already received
*LoggedMeasurementConfiguration* message sending by the network }

**ensure that** {

**when** { The earlyMeasIndication-r17 is not configured in
*LoggedMeasurementConfiguration* }

**then** { UE shall not log measurements on early measurement
frequencies in logged MDT }

}

##### 8.1.6.1.2.15.2 Conformance requirements {#conformance-requirements-62 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clause 5.5a.3.2. Unless otherwise
stated these are Rel-17 requirements.

\[TS 38.331, clause 5.5a.3.2\]

While T330 is running and SDT procedure is not ongoing, the UE shall:

1\> if measurement logging is suspended:

> 2\> if during the last logging interval the IDC problems detected by
> the UE is resolved, resume measurement logging;

1\> if not suspended, perform the logging in accordance with the
following:

...

2\> when performing the logging:

...

3\> if available, set the *measResultNeighCells,* in order of decreasing
ranking-criterion as used for cell re-selection, to include measurements
of neighbouring cell that became available during the last logging
interval and according to the following:

4\> include measurement results for at most 6 neighbouring cells on the
NR serving frequency and for at most 3 cells per NR neighbouring
frequency and for the NR neighbouring frequencies in accordance with the
following:

5\> if *interFreqTargetInfo* is included in *VarLogMeasConfig*:

6\> if *earlyMeasIndication* is included in *VarLogMeasConfig*;

7\> include measurement results for NR neighbouring frequencies that are
included in both *interFreqTargetInfo* and either in
*measIdleCarrierListNR* (within the *VarMeasIdleConfig*) or *SIB4*;

6\> else:

7\> include measurement results for NR neighbouring frequencies that are
included in both *interFreqTargetInfo* and *SIB4*;

5\> else:

6\> if *earlyMeasIndication* is included in *VarLogMeasConfig*;

7\> include measurement results for NR neighbouring frequencies that are
included in either *measIdleCarrierListNR* (within the
*VarMeasIdleConfig*) or *SIB4*;

6\> else:

7\> include measurement results for NR neighbouring frequencies that are
included in *SIB4*;

4\> include measurement results for at most 3 neighbours per inter-RAT
frequency in accordance with the following:

5\> if *earlyMeasIndication* is included in *VarLogMeasConfig*:

6\> include measurement results for inter-RAT neighbouring frequencies
that are included in either *measIdleCarrierListEUTRA* (within the
*VarMeasIdleConfig*) or *SIB5*;

5\> else:

6\> include measurement results for inter-RAT frequencies that are
included in *SIB5*;

> 4\> for each neighbour cell included, include the optional fields that
> are available;

##### 8.1.6.1.2.15.3 Test description {#test-description-60 .H6}

##### 8.1.6.1.2.15.3.1 Pre-test conditions {#pre-test-conditions-61 .H6}

##### System Simulator: {#system-simulator-42 .H6}

\- NR Cell 1.

##### UE: {#ue-50 .H6}

> \- None

##### Preamble: {#preamble-50 .H6}

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A on NR Cell 1.

##### 8.1.6.1.2.15.3.2 Test procedure sequence {#test-procedure-sequence-61 .H6}

Table 8.1.6.1.2.15.3.2-1: Main behaviour

  St      Procedure                                                                                                                                          Message Sequence   TP                                 Verdict   
  ------- -------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ ---------------------------------- --------- ----
                                                                                                                                                             U - S              Message                                      
  1       The SS transmits an *LoggedMeasurementConfiguration* message with *earlyMeasIndication* set to 'true'.                                             \<\--              *LoggedMeasurementConfiguration*   \-        \-
  2       The SS transmits a *RRCRelease* message with *measIdleConfig* including *measIdleCarrierListNR* with *ssb-MeasConfig* *to the UE.*                 \<\--              NR RRC: *RRCRelease*               \-        \-
  3       Wait 30 seconds for the UE to perform the logging at regular time intervals.                                                                       \-                 \-                                 \-        \-
  4-11    Steps 1 to 8 of the generic procedure in TS 38.508-1 \[4\], Table 4.5.4.2-3 are executed to successfully complete the service request procedure.   \-                 \-                                 \-        \-
  12      SS transmits an *LoggedMeasurementConfiguration* message without *earlyMeasIndication*.                                                            \<\--              *LoggedMeasurementConfiguration*   \-        \-
  13      The SS sends an *UEInformationRequest* message including *idleModeMeasurementReq and logMeasReportReq*.                                            \<\--              NR RRC: *UEInformationRequest*     \-        \-
  14      Check: Does the UE send an *UEInformationResponse message* with measurement results on early measurement frequencies?                              \--\>              NR RRC: *UEInformationResponse*    1         P
  15      The SS transmits a *RRCRelease* message with *measIdleConfig* including *measIdleCarrierListNR* with *ssb-MeasConfig* *to the UE.*                 \<\--              NR RRC: *RRCRelease*               \-        \-
  16      Wait 30 seconds for the UE to perform the logging at regular time intervals.                                                                       \-                 \-                                 \-        \-
  17-24   Steps 1 to 8 of the generic procedure in TS 38.508-1 \[4\], Table 4.5.4.2-3 are executed to successfully complete the service request procedure.   \-                 \-                                 \-        \-
  25      The SS sends an *UEInformationRequest* message including *idleModeMeasurementReq and logMeasReportReq*.                                            \<\--              NR RRC: *UEInformationRequest*     \-        \-
  26      Check: Does the UE send an *UEInformationResponse message* without measurement results on early measurement frequencies?                           \--\>              NR RRC: *UEInformationResponse*    2         P

##### 8.1.6.1.2.15.3.3 Specific message contents {#specific-message-contents-62 .H6}

Table 8.1.6.1.2.15.3.3-1: LoggedMeasurementConfiguration (step 1, Table
8.1.6.1.2.15.3.2-1)

  Derivation Path: TS 38.508-1 Table 4.6.1-5AA with condition EarlyMeas                            
  ----------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                     Value/remark   Comment   Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                                
  criticalExtensions CHOICE {                                                                      
  loggedMeasurementConfiguration-r16 SEQUENCE {                                                    
  reportType CHOICE {                                                                              
  periodical SEQUENCE {                                                                            
  loggingInterval-r16                                                     ms61440        61.44s    
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                
  }                                                                                                

Table 8.1.6.1.2.15.3.3-2: LoggedMeasurementConfiguration (step 12, Table
8.1.6.1.2.15.3.2-1)

  Derivation Path: TS 38.508-1 Table 4.6.1-5AA                                 
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                            
  criticalExtensions CHOICE {                                                  
  loggedMeasurementConfiguration-r16 SEQUENCE {                                
  reportType CHOICE {                                                          
  periodical SEQUENCE {                                                        
  loggingInterval-r16                                 ms61440        61.44s    
  }                                                                            
  }                                                                            
  nonCriticalExtension SEQUENCE {                                              
  earlyMeasIndication-r17                             Not present              
  }                                                                            
  }                                                                            
  }                                                                            
  }                                                                            

Table 8.1.6.1.2.15.3.3-3: *UEInformationRequest* (steps 13 and 25, Table
8.1.6.1.2.15.3.2-1)

  ---------------------------------------------------------------------------------
  Derivation path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition IDLE and LOG
  ---------------------------------------------------------------------------------

Table 8.1.6.1.2.15.3.3-4: *UEInformationResponse* (steps 14, Table
8.1.6.1.2.15.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                                                                                                                 
  ---------------------------------------------------------------------------------------------------------------- ---------------------------------------- --------- -----------
  Information Element                                                                                              Value/remark                             Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                
  measResultIdleNR-r16 SEQUENCE {                                                                                                                                     
  measResultServingCell-r16 SEQUENCE {                                                                                                                                
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                                                   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  measResultsPerCarrierListIdleNR-r16 SEQUENCE (SIZE (1.. maxFreqIdle-r16)) OF MeasResultsPerCarrierIdleNR-r16 {   1 entry                                            
  MeasResultsPerCarrierIdleNR-r16\[1\] SEQUENCE {                                                                                                           entry 1   
  carrierFreq-r16                                                                                                  ARFCN value corresponding to NR cell 1             
  measResultsPerCellListIdleNR-r16 SEQUENCE (SIZE (1..maxCellMeasIdle-r16)) OF MeasResultsPerCellIdleNR-r16 {      1 entry                                            
  MeasResultsPerCellIdleNR-r16\[1\] SEQUENCE {                                                                                                              entry 1   
  physCellId-r16                                                                                                   PhysCellId corresponding to NR cell 1              
  measIdleResultNR-r16 SEQUENCE {                                                                                                                                     
  rsrp-Result-r16                                                                                                  Any allowed value                                  
  rsrq-Result-r16                                                                                                  Any allowed value                                  
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                                                   
  ssb-Index-r16                                                                                                    Any allowed value                                  
  ssb-Results-r16 SEQUENCE {                                                                                                                                          
  ssb-RSRP-Result-r16                                                                                              Any allowed value                                  
  ssb-RSRQ-Result-r16                                                                                              Any allowed value                                  
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  logMeasReport-r16                                                                                                Not checked                                        
  }                                                                                                                                                                   
  }                                                                                                                                                                   
  }                                                                                                                                                                   

Table 8.1.6.1.2.15.3.3-5: *UEInformationResponse* (step 26, Table
8.1.6.1.2.15.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], table 4.6.1-32B                            
  ----------------------------------------------------- -------------- --------- -----------
  Information Element                                   Value/remark   Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                                    
  ueInformationResponse-r16 SEQUENCE {                                           
  measResultIdleNR-r16                                  Not present              
  logMeasReport-r16                                     Not checked              
  }                                                                              
  }                                                                              
  }                                                                              

###### 8.1.6.1.2.16 Logged MDT / RRC\_IDLE / sig-based logged MDT

##### 8.1.6.1.2.16.1 Test Purpose (TP) {#test-purpose-tp-63 .H6}

##### (1) {#section-125 .H6}

**with** { UE in NR RRC\_IDLE state with logged measurements available
for NR and T330 timer is running }

**ensure that** {

**when** { The sigLoggedMeasType is included in VarLogMeasReport }

**then** { UE includes the sigLogMeasConfigAvailable set to true in the
RRCSetupComplete message after receiving an RRCSetup message }

}

##### 8.1.6.1.2.16.2 Conformance requirements {#conformance-requirements-63 .H6}

References: The conformance requirements covered in the present test
case are specified in: TS 38.331, clause 5.3.3.4. Unless otherwise
stated these are Rel-17 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable in the RRCSetupComplete* message;

3\> if Bluetooth measurement results are included in the logged
measurements the UE has available for NR:

4\> include the *logMeasAvailableBT* *in the RRCSetupComplete* message;

3\> if WLAN measurement results are included in the logged measurements
the UE has available for NR:

4\> include the *logMeasAvailableWLAN* *in the RRCSetupComplete*
message;

2\> if the *sigLoggedMeasType* in *VarLogMeasReport* is included:

3\> if T330 timer is running and the logged measurements configuration
is for NR:

4\> set *sigLogMeasConfigAvailable* to *true* in the *RRCSetupComplete*
message;

3\> else:

4\> if the UE has logged measurements available for NR:

5\> set *sigLogMeasConfigAvailable* to *false* in the *RRCSetupComplete*
message;

##### 8.1.6.1.2.16.3 Test description {#test-description-61 .H6}

##### 8.1.6.1.2.16.3.1 Pre-test conditions {#pre-test-conditions-62 .H6}

##### System Simulator: {#system-simulator-43 .H6}

\- NR Cell 1.

##### UE: {#ue-51 .H6}

> \- None

##### Preamble: {#preamble-51 .H6}

> \- The UE is in state 3N-A as defined in TS 38.508-1 \[4\], subclause
> 4.4A on NR Cell 1.

##### 8.1.6.1.2.16.3.2 Test procedure sequence {#test-procedure-sequence-62 .H6}

Table 8.1.6.1.2.16.3.2-1: Main behaviour

+------+-------------+-------------+-------------+---------+----+
| St   | Procedure   | Message     | TP          | Verdict |    |
|      |             | Sequence    |             |         |    |
+======+=============+=============+=============+=========+====+
|      |             | U - S       | Message     |         |    |
+------+-------------+-------------+-------------+---------+----+
| 1    | The SS      | \<\--       | *LoggedMea  | \-      | \- |
|      | transmits   |             | surementCon |         |    |
|      | an          |             | figuration* |         |    |
|      | *LoggedMea  |             |             |         |    |
|      | surementCon |             |             |         |    |
|      | figuration* |             |             |         |    |
|      | message     |             |             |         |    |
|      | with        |             |             |         |    |
|      | *sigLogg    |             |             |         |    |
|      | edMeasType* |             |             |         |    |
|      | set to      |             |             |         |    |
|      | 'true'.     |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 2    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits a |             | *           |         |    |
|      | *           |             | RRCRelease* |         |    |
|      | RRCRelease* |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 3    | Wait 30     | \-          | \-          | \-      | \- |
|      | seconds for |             |             |         |    |
|      | the UE to   |             |             |         |    |
|      | perform the |             |             |         |    |
|      | logging at  |             |             |         |    |
|      | regular     |             |             |         |    |
|      | time        |             |             |         |    |
|      | intervals.  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 4-6  | Steps 1 to  | \-          | \-          | \-      | \- |
|      | 3 of the    |             |             |         |    |
|      | generic     |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | in TS       |             |             |         |    |
|      | 38.508-1    |             |             |         |    |
|      | \[4\],      |             |             |         |    |
|      | Table       |             |             |         |    |
|      | 4.5.4.2-3   |             |             |         |    |
|      | are         |             |             |         |    |
|      | performed.  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 7    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|      | the UE      |             | *RRCSet     |         |    |
|      | transmit an |             | upComplete* |         |    |
|      | *RRCSet     |             |             |         |    |
|      | upComplete* |             | 5GMM:       |         |    |
|      | message     |             | SERVICE     |         |    |
|      | including   |             | REQUEST     |         |    |
|      | *sigL       |             |             |         |    |
|      | ogMeasConfi |             |             |         |    |
|      | gAvailable* |             |             |         |    |
|      | IE set it   |             |             |         |    |
|      | to *true    |             |             |         |    |
|      | when T330   |             |             |         |    |
|      | is          |             |             |         |    |
|      | running*?   |             |             |         |    |
|      | UE          |             |             |         |    |
|      | initiates   |             |             |         |    |
|      | the session |             |             |         |    |
|      | management  |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | by          |             |             |         |    |
|      | including   |             |             |         |    |
|      | the SERVICE |             |             |         |    |
|      | REQUEST     |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 8-11 | Steps 5 to  | \-          | \-          | \-      | \- |
|      | 8 of the    |             |             |         |    |
|      | generic     |             |             |         |    |
|      | radio       |             |             |         |    |
|      | bearer      |             |             |         |    |
|      | es          |             |             |         |    |
|      | tablishment |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | in TS       |             |             |         |    |
|      | 38.508-1    |             |             |         |    |
|      | \[4\] table |             |             |         |    |
|      | 4.5.4.2-3.  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.2.16.3.3 Specific message contents {#specific-message-contents-63 .H6}

Table 8.1.6.1.2.16.3.3-1: LoggedMeasurementConfiguration (step 1, Table
8.1.6.1.2.16.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5AA with condition SigLogMDT                            
  ----------------------------------------------------------------------------- -------------- --------- -----------
  Information Element                                                           Value/remark   Comment   Condition
  LoggedMeasurementConfiguration-r16 ::= SEQUENCE {                                                      
  criticalExtensions CHOICE {                                                                            
  loggedMeasurementConfiguration-r16 SEQUENCE {                                                          
  reportType CHOICE {                                                                                    
  periodical SEQUENCE {                                                                                  
  loggingInterval-r16                                                           ms61440        61.44s    
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      
  }                                                                                                      

Table 8.1.6.1.2.16.3.3-2: RRCSetupComplete (step 7, Table
8.1.6.1.2.16.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                                                                    
  ---------------------------------------------------- ------------------------------------------------------ --------- -----------
  Information Element                                  Value/remark                                           Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                       
  criticalExtensions CHOICE {                                                                                           
  rrcSetupComplete SEQUENCE {                                                                                           
  nonCriticalExtension SEQUENCE {                                                                                       
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition sig\_LOG             
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     

##### 8.1.6.1.3 Radio Link Failure report

###### 8.1.6.1.3.1 Radio Link Failure / Reporting of Intra-frequency measurements

##### 8.1.6.1.3.1.1 Test Purpose (TP) {#test-purpose-tp-64 .H6}

##### (1) {#section-126 .H6}

with { UE in RRC\_CONNECTED having performed the intra-frequency
measurement and reported that the UE has radio link failure information
available }

ensure that {

when { UE receives the *UEInformationRequest* message containing
*rlf-ReportReq* }

then { UE sends the *UEInformationResponse* message containing the
measurement result for intra-frequency neighbour cell }

}

##### (2) {#section-127 .H6}

with { UE sends the UEInformationResponse message containing the
measurement result for intra-frequency neighbour cell }

ensure that {

when { The latest radio measurement results of the serving and
neighbouring cells are available }

then { UE includes SSB index and associated measurements in the
measResultLastServCell }

}

##### 8.1.6.1.3.1.2 Conformance requirements {#conformance-requirements-64 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.10.5, 5.3.7.4, 5.3.7.5, 5.3.10.3
and 5.7.10.3. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.10.5\]

The UE shall determine the content in the *VarRLF-Report* as follows:

1\> clear the information included in *VarRLF-Report*, if any;

1\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e. includes the RPLMN);

1\> set the *measResultLastServCell* to include the cell level RSRP,
RSRQ and the available SINR, of the source PCell(in case HO failure) or
PCell (in case RLF) based on the available SSB and CSI-RS measurements
collected up to the moment the UE detected failure;

1\> if the SS/PBCH block-based measurement quantities are available:

2\> set the *rsIndexResults* in *measResultLastServCell* to include all
the available measurement quantities of the source PCell (in case HO
failure) or PCell (in case RLF), ordered such that the highest SS/PBCH
block RSRP is listed first if SS/PBCH block RSRP measurement results are
available, otherwise the highest SS/PBCH block RSRQ is listed first if
SS/PBCH block RSRQ measurement results are available, otherwise the
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

...

1\> set the *ssbRLMConfigBitmap* and/or *csi-rsRLMConfigBitmap* in
*measResultLastServCell* to include the radio link monitoring
configuration of the source PCell(in case HO failure) or PCell (in case
RLF);

1\> for each of the configured *measObjectNR* in which measurements are
available:

2\> if the SS/PBCH block-based measurement quantities are available:

3\> set the *measResultListNR* in *measResultNeighCells* to include all
the available measurement quantities of the best measured cells, other
than the source PCell(in case HO failure) or PCell (in case RLF),
ordered such that the cell with highest SS/PBCH block RSRP is listed
first if SS/PBCH block RSRP measurement results are available, otherwise
the cell with highest SS/PBCH block RSRQ is listed first if SS/PBCH
block RSRQ measurement results are available, otherwise the cell with
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

4\> for each neighbour cell included, include the optional fields that
are available;

...

1\> set the *c-RNTI* to the C-RNTI used in the source PCell(in case HO
failure) or PCell (in case RLF);

...

1\> else if the failure is detected due to radio link failure as
described in 5.3.10.3, set the fields in *VarRLF-report* as follows:

2\> set the *connectionFailureType* to *rlf*;

2\> set the *rlf-Cause* to the trigger for detecting radio link failure
in accordance with clause 5.3.10.4;

2\> set the *nrFailedPCellId* *in* *failedPCellId* to the global cell
identity and the tracking area code, if available, and otherwise to the
physical cell identity and carrier frequency of the PCell where radio
link failure is detected;

...

1\> if location information is available, set the content of
*locationInfo* as follows:

2\> if available, set the *commonLocationInfo* to include the detailed
location information;

2\> if available, set the *bt-LocationInfo* in *locationInfo* to include
the Bluetooth measurement results, in order of decreasing RSSI for
Bluetooth beacons;

2\> if available, set the *wlan-LocationInfo* in *locationInfo* to
include the WLAN measurement results, in order of decreasing RSSI for
WLAN APs;

2\> if available, set the *sensor-LocationInfo* in *locationInfo* to
include the sensor measurement results;

\[TS 38.331, clause 5.3.7.4\]

The UE shall set the contents of *RRCReestablishmentRequest* message as
follows:

1\> if the procedure was initiated due to radio link failure as
specified in 5.3.10.3 or handover failure as specified in 5.3.5.8.3:

2\> set the *reestablishmentCellId* in the *VarRLF-Report* to the global
cell identity of the selected cell;

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable in the RRCReestablishmentComplete*
message;

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report; or*

*...*

3\> include *rlf-InfoAvailable in the RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

...

1\> else:

2\> during a DAPS handover: the following only applies for the target
PCell;

2\> upon T310 expiry in PCell; or

...

2\> upon consistent uplink LBT failure indication from MCG MAC while
T304 is not running:

...

3\> else:

4\> consider radio link failure to be detected for the MCG i.e. RLF;

4\> discard any segments of segmented RRC messages stored according to
5.7.6.3;

NOTE: Void.

4\> if AS security has not been activated:

5\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'other\';-

4\> else if AS security has been activated but SRB2 and at least one DRB
or, for IAB, SRB2, have not been setup:

5\> store the radio link failure information in the *VarRLF-Report* as
described in subclause 5.3.10.5;

5\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\';

4\> else:

5\> store the radio link failure information in the *VarRLF-Report* as
described in subclause 5.3.10.5;

...

5\> else:

6\> initiate the connection re-establishment procedure as specified in
5.3.7.

The UE may discard the radio link failure information, i.e. release the
UE variable *VarRLF-Report*, 48 hours after the radio link failure is
detected.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* *in the
UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged
first*;*

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable;*

...

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport upon successful* delivery *of
the UEInformationResponse* message confirmed by lower layers*;*

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.1.3 Test description {#test-description-62 .H6}

##### 8.1.6.1.3.1.3.1 Pre-test conditions {#pre-test-conditions-63 .H6}

##### System Simulator: {#system-simulator-44 .H6}

\- NR Cell 1 is the serving cell.

\- NR Cell 2 is the intra-frequency neighbor cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-52 .H6}

None.

##### Preamble: {#preamble-52 .H6}

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.

##### 8.1.6.1.3.1.3.2 Test procedure sequence {#test-procedure-sequence-63 .H6}

Table 8.1.6.1.3.1.3.2-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble, while columns marked \"T1\" and \"T2\" are to
be applied subsequently. The exact instants on which these values shall
be applied are described in the texts in this clause.

Table 8.1.6.1.3.1.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -88       | -94       | The power |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | values    |
|    |           |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | me        |
|    |           |         |           |           | asurement |
|    |           |         |           |           | results   |
|    |           |         |           |           | for Cell  |
|    |           |         |           |           | 1 (M1)    |
|    |           |         |           |           | and Cell  |
|    |           |         |           |           | 2 (M2)    |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | exit      |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 (M2 \< |
|    |           |         |           |           | M1).      |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -88       | -82       | The power |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | values    |
|    |           |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | me        |
|    |           |         |           |           | asurement |
|    |           |         |           |           | results   |
|    |           |         |           |           | for Cell  |
|    |           |         |           |           | 1 (M1)    |
|    |           |         |           |           | and Cell  |
|    |           |         |           |           | 2 (M2)    |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 (M2 \> |
|    |           |         |           |           | M1).      |
+----+-----------+---------+-----------+-----------+-----------+
| T2 | SS/PBCH   | dBm/SCS | \"Off\"   | -82       | Only Cell |
|    |           |         |           |           | 2 is      |
|    | SSS EPRE  |         |           |           | a         |
|    |           |         |           |           | vailable. |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.6.1.3.1.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -91       | -100      | The power |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | values    |
|    |           |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | me        |
|    |           |         |           |           | asurement |
|    |           |         |           |           | results   |
|    |           |         |           |           | for Cell  |
|    |           |         |           |           | 1 (M1)    |
|    |           |         |           |           | and Cell  |
|    |           |         |           |           | 2 (M2)    |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | exit      |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 (M2 \< |
|    |           |         |           |           | M1).      |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -91       | -82       | The power |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | values    |
|    |           |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | me        |
|    |           |         |           |           | asurement |
|    |           |         |           |           | results   |
|    |           |         |           |           | for Cell  |
|    |           |         |           |           | 1 (M1)    |
|    |           |         |           |           | and Cell  |
|    |           |         |           |           | 2 (M2)    |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 (M2 \> |
|    |           |         |           |           | M1).      |
+----+-----------+---------+-----------+-----------+-----------+
| T2 | SS/PBCH   | dBm/SCS | \"Off\"   | -82       | Only Cell |
|    |           |         |           |           | 2 is      |
|    | SSS EPRE  |         |           |           | a         |
|    |           |         |           |           | vailable. |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.6.1.3.1.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                  Message Sequence   TP                                      Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                  U - S              Message                                           
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* to setup NR measurement and reporting for intra-frequency event A3 (*measId* 1).   \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message.                                                                                                  \--\>              *NR RRC: RRCReconfigurationComplete*    \-        \-
  3    The SS changes NR Cell 2 parameters according to the row \"T1\" in Table 8.1.6.1.3.1.3.2-1/2.                                                              \-                 \-                                      \-        \-
  4    The UE transmit a *MeasurementReport* message to report event A3 (*measId* 1) with the measured RSRP value for NR Cell 2.                                  \--\>              *NR RRC: MeasurementReport*             \-        \-
  5    The SS changes NR Cell 1 parameter according to the row \"T2\" in Table 8.1.6.1.3.1.3.2-1/2.                                                               \-                 \-                                      \-        \-
  6    The UE transmits an *RRCReestablishmentRequest* message on NR Cell 2.                                                                                      \--\>              *NR RRC: RRCReestablishmentRequest*     \-        \-
  7    The SS transmits an *RRCReestablishment* message.                                                                                                          \<\--              *NR RRC: RRCReestablishment*            \-        \-
  8    Check: Does the UE transmit an *RRCReestablishmentComplete* message with *rlf-InfoAvailable* included?                                                     \--\>              *NR RRC: RRCReestablishmentComplete*    1         P
  9    The SS transmits an *RRCReconfiguration* message to establish SRB2 and DRB.                                                                                \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  10   The UE transmits an *RRCReconfigurationtComplete* message.                                                                                                 \--\>              *NR RRC: RRCReconfigurationtComplete*   \-        \-
  11   The SS transmits a *UEInformationRequest* message.                                                                                                         \<\--              *NR RRC: UEInformationRequest*          \-        \-
  12   Check: Does the UE transmit a *UEInformationResponse* message on NR Cell 2?                                                                                \--\>              *NR RRC: UEInformationResponse*         1, 2      P

##### 8.1.6.1.3.1.3.3 Specific message contents {#specific-message-contents-64 .H6}

Table 8.1.6.1.3.1.3.3-1: *RRCReconfiguration* (step 1, Table
8.1.6.1.3.1.3.2-3)

  ----------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS
  ----------------------------------------------------------------------------

Table 8.1.6.1.3.1.3.3-2: *MeasConfig* (Table 8.1.6.1.3.1.3.3-1)

  ------------------------------------------------------------------------------------------ ------------------------ ------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-69                                                                                            
  Information Element                                                                        Value/remark             Comment                   Condition
  MeasConfig ::= SEQUENCE {                                                                                                                     
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                            
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                   
  measObjectId                                                                               1                                                  
  measObject CHOICE {                                                                                                                           
  measObjectNR                                                                               MeasObjectNR             Table 8.1.6.1.3.1.3.3-3   
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                            
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                   
  reportConfigId                                                                             1                                                  
  reportConfig CHOICE {                                                                                                                         
  reportConfigNR                                                                             ReportConfigNR-EventA3   Table 8.1.6.1.3.1.3.3-4   
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                            
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                   
  measId                                                                                     1                                                  
  measObjectId                                                                               1                                                  
  reportConfigId                                                                             1                                                  
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  ------------------------------------------------------------------------------------------ ------------------------ ------------------------- -----------

Table 8.1.6.1.3.1.3.3-3: *MeasObjectNR* (Table 8.1.6.1.3.1.3.3-2)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.6.1.3.1.3.3-4: *ReportConfigNR-EventA3* (Table
8.1.6.1.3.1.3.3-2)

  ------------------------------------------------------------------------------ -------------- ----------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-142 with condition EVENT\_A3                                    
  Information Element                                                            Value/remark   Comment           Condition
  ReportConfigNR ::= SEQUENCE {                                                                                   
  reportType CHOICE {                                                                                             
  eventTriggered SEQUENCE {                                                                                       
  eventId CHOICE {                                                                                                
  eventA3 SEQUENCE {                                                                                              
  a3-Offset CHOICE {                                                                                              
  rsrp                                                                           2              1 dB(2\*0.5 dB)   
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  reportAmount                                                                   r1                               
  reportQuantityCell SEQUENCE {                                                                                   
  rsrp                                                                           true                             
  rsrq                                                                           false                            
  sinr                                                                           false                            
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  ------------------------------------------------------------------------------ -------------- ----------------- -----------

Table 8.1.6.1.3.1.3.3-5: *MeasurementReport* (step 4, Table
8.1.6.1.3.1.3.2-3)

  ---------------------------------------------------------------------------------------- ---------------------------- ---------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-5A                                                                                                       
  Information Element                                                                      Value/remark                 Comment                            Condition
  MeasurementReport ::= SEQUENCE {                                                                                                                         
  criticalExtensions CHOICE {                                                                                                                              
  measurementReport SEQUENCE {                                                                                                                             
  measResults SEQUENCE {                                                                                                                                   
  measId                                                                                   1                                                               
  measResultServingMOList SEQUENCE (SIZE (1..maxNrofServingCells)) OF MeasResultServMO {   1 entry                      Measurement result for NR Cell 1   
  MeasResultServMO\[1\] SEQUENCE {                                                                                      entry 1                            
  servCellId                                                                               ServCellIndex of NR Cell 1                                      
  measResultServingCell SEQUENCE {                                                                                                                         
  physCellId                                                                               PCI of NR Cell 1                                                
  measResult SEQUENCE {                                                                                                                                    
  cellResults SEQUENCE {                                                                                                                                   
  resultsSSB-Cell SEQUENCE {                                                                                                                               
  rsrp                                                                                     (0..127)                                                        
  rsrq                                                                                     (0..127)                                                        
  sinr                                                                                     Not checked                                                     
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  measResultNeighCells CHOICE {                                                                                                                            
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                   1 entry                      Measurement result for NR Cell 2   
  MeasResultNR\[1\] SEQUENCE {                                                                                          entry 1                            
  physCellId                                                                               PCI of NR Cell 2                                                
  measResult SEQUENCE {                                                                                                                                    
  cellResults SEQUENCE {                                                                                                                                   
  resultsSSB-Cell SEQUENCE {                                                                                                                               
  rsrp                                                                                     (0..127)                                                        
  rsrq                                                                                     Not present                                                     
  sinr                                                                                     Not present                                                     
  }                                                                                                                                                        
  resultsCSI-RS-Cell                                                                       Not present                                                     
  }                                                                                                                                                        
  rsIndexResults                                                                           Not present                                                     
  }                                                                                                                                                        
  cgi-Info                                                                                 Not present                                                     
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  }                                                                                                                                                        
  ---------------------------------------------------------------------------------------- ---------------------------- ---------------------------------- -----------

Table 8.1.6.1.3.1.3.3-6: *RRCReestablishmentRequest* (step 6, Table
8.1.6.1.3.1.3.2-3)

  ---------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-12                                                                                                    
  Information Element                                  Value/remark                                                                           Comment   Condition
  RRCReestablishmentRequest ::= SEQUENCE {                                                                                                              
  ue-Identity SEQUENCE {                                                                                                                                
  c-RNTI                                               the value of the C-RNTI of the UE                                                                
  physCellId                                           PCI of NR Cell 1                                                                                 
  shortMAC-I                                           The same value as the 16 least significant bits of the XMAC-I value calculated by SS             
  }                                                                                                                                                     
  reestablishmentCause                                 otherFailure                                                                                     
  }                                                                                                                                                     
  ---------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------

Table 8.1.6.1.3.1.3.3-7: *RRCReestablishmentComplete* (step 8, Table
8.1.6.1.3.1.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-11                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCReestablishmentComplete ::= SEQUENCE {                                                                        
  criticalExtensions CHOICE {                                                                                      
  rrcReestablishmentComplete SEQUENCE {                                                                            
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition RLF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.3.1.3.3-8: *RRCReconfiguration* (step 9, Table
8.1.6.1.3.1.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

Table 8.1.6.1.3.1.3.3-9: *UEInformationRequest* (step 11, Table
8.1.6.1.3.1.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

Table 8.1.6.1.3.1.3.3-10: *UEInformationResponse* (step 12, Table
8.1.6.1.3.1.3.2-3)

  ----------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                   
  Information Element                                   Value/remark                                                              Comment                                                               Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                                                           
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                  
  rlf-Report-r16 CHOICE {                                                                                                                                                                               
  nr-RLF-Report-r16 SEQUENCE {                                                                                                                                                                          
  measResultLastServCell-r16 SEQUENCE {                                                                                                                                                                 
  measResult-r16 SEQUENCE {                                                                                                                                                                             
  cellResults-r16 SEQUENCE {                                                                                                                                                                            
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                                                                                        
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  (0..127)                                                                                                                                        
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  resultsCSI-RS-Cell-r16                                Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  rsIndexResults-r16 SEQUENCE {                                                                                                                                                                         
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                                                                                     
  ssb-Index                                             1                                                                                                                                               
  ssb-Results SEQUENCE {                                                                                                                                                                                
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  (0..127)                                                                                                                                        
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  ssbRLMConfigBitmap-r16                                01000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000                                                                         
  resultsCSI-RS-Indexes-r16                             Not present                                                                                                                                     
  csi-rsRLMConfigBitmap-r16                             Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                                                   
  measResultListNR-r16 SEQUENCE {                                                                                                                                                                       
  ssbFrequency-r16                                      ARFCN-ValueNR for SSB of NR Cell 2                                                                                                              
  refFreqCSI-RS-r16                                     Not present                                                                                                                                     
  measResultList-r16 SEQUENCE {                                                                                                                                                                         
  physCellId                                            PCI of NR Cell 2                                                                                                                                
  measResult SEQUENCE {                                                                                                                                                                                 
  cellResults SEQUENCE {                                                                                                                                                                                
  resultsSSB-Cell SEQUENCE {                                                                                                                                                                            
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  Not checked                                                                                                                                     
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  rsIndexResults                                        Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  c-RNTI-r16                                            the old value of the C-RNTI of the UE used in NR Cell 1                                                                                         
  previousPCellId-r16                                   Not present                                                                                                                                     
  failedPCellId-r16 CHOICE {                                                                                                                                                                            
  nrFailedPCellId-r16                                   Any Allowed Value                                                         Either pci-arfcn-r16 or cellGlobalId-r16 corresponding to NR Cell 1   
  eutraFailedPCellId-r16                                Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  reconnectCellId-r16                                   Not present                                                                                                                                     
  timeUntilReconnection-16                              Not present                                                                                                                                     
  reestablishmentCellId-r16 SEQUENCE {                                                                                                                                                                  
  plmn-Identity-r16                                     PLMN ID of NR Cell 2                                                                                                                            
  cellIdentity-r16                                      CGI of NR Cell 2                                                                                                                                
  trackingAreaCode-r16                                  TAC of NR Cell 2                                                                                                                                
  }                                                                                                                                                                                                     
  timeConnFailure-r16                                   Not present                                                                                                                                     
  timeSinceFailure-r16                                  Any allowed value                                                                                                                               
  connectionFailureType-r16                             rlf                                                                                                                                             
  rlf-Cause-r16                                         t310-Expiry                                                                                                                                     
  locationInfo-r16                                      Not checked                                                                                                                                     
  noSuitableCellFound-r16                               Not present                                                                                                                                     
  ra-InformationCommon-r16                              Not present                                                                                                                                     
  csi-rsRLMConfigBitmap-v1650                           Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  eutra-RLF-Report-r16                                  Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  ----------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------

###### 8.1.6.1.3.2 Radio Link Failure / Reporting of Inter-frequency measurements

##### 8.1.6.1.3.2.1 Test Purpose (TP) {#test-purpose-tp-65 .H6}

##### (1) {#section-128 .H6}

with { UE in RRC\_CONNECTED having performed the inter-frequency
measurement and reported that the UE has radio link failure information
available }

ensure that {

when { UE receives the *UEInformationRequest* message containing
*rlf-ReportReq* }

then { UE sends the *UEInformationResponse* message containing the
measurement result for inter-frequency neighbour cell }

}

##### (2) {#section-129 .H6}

with { UE sends the UEInformationResponse message containing the
measurement result for inter-frequency neighbour cell }

ensure that {

when { The latest radio measurement results of the serving and
neighbouring cells are available }

then { UE includs SSB index and associated measurements in the
measResultLastServCell }

}

##### 8.1.6.1.3.2.2 Conformance requirements {#conformance-requirements-65 .H6}

Same as test case 8.1.6.1.3.1.

##### 8.1.6.1.3.2.3 Test description {#test-description-63 .H6}

##### 8.1.6.1.3.2.3.1 Pre-test conditions {#pre-test-conditions-64 .H6}

Same as test case 8.1.6.1.3.1 with the following differences:

\- Cells configuration: NR Cell 3 replaces NR Cell 2.

\- System information combination: NR-4 repleaces NR-2.

##### 8.1.6.1.3.2.3.2 Test procedure sequence {#test-procedure-sequence-64 .H6}

Same as test case 8.1.6.1.3.1 with the following differences:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

##### 8.1.6.1.3.2.3.3 Specific message contents {#specific-message-contents-65 .H6}

Same as test case 8.1.6.1.3.1 with the following difference:

> \- Cells configuration: NR Cell 3 replaces NR Cell 2.

Table 8.1.6.1.3.2.3.3-1: *MeasConfig* (Table 8.1.6.1.3.1.3.3-2)

  ------------------------------------------------------------------------------------------ ------------------------ ------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                             
  Information Element                                                                        Value/remark             Comment                   Condition
  MeasConfig ::= SEQUENCE {                                                                                                                     
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          2 entries                                          
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                  entry 1                   
  measObjectId                                                                               1                                                  
  measObject CHOICE {                                                                                                                           
  measObjectNR                                                                               MeasObjectNR-f1          Table 8.1.6.1.3.2.3.3-2   
  }                                                                                                                                             
  }                                                                                                                                             
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                  entry 2                   
  measObjectId                                                                               2                                                  
  measObject CHOICE {                                                                                                                           
  measObjectNR                                                                               MeasObjectNR-f2          Table 8.1.6.1.3.2.3.3-3   
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                            
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                entry 1                   
  reportConfigId                                                                             1                                                  
  reportConfig CHOICE {                                                                                                                         
  reportConfigNR                                                                             ReportConfigNR-EventA3   Table 8.1.6.1.3.1.3.3-4   
  }                                                                                                                                             
  }                                                                                                                                             
  }                                                                                                                                             
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                            
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                      entry 1                   
  measId                                                                                     1                                                  
  measObjectId                                                                               2                                                  
  reportConfigId                                                                             1                                                  
  }                                                                                                                                             
  }                                                                                                                                             
  measGapConfig                                                                              MeasGapConfig                                      
  }                                                                                                                                             
  ------------------------------------------------------------------------------------------ ------------------------ ------------------------- -----------

Table 8.1.6.1.3.2.3.3-2: *MeasObjectNR-f1* (Table 8.1.6.1.3.2.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 1             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.6.1.3.2.3.3-3: *MeasObjectNR-f2* (Table 8.1.6.1.3.2.3.3-1)

  ---------------------------------------------------- ------------------------------------ --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-76                                                  
  Information Element                                  Value/remark                         Comment   Condition
  MeasObjectNR::= SEQUENCE {                                                                          
  ssbFrequency                                         ARFCN-ValueNR for SSB of NR Cell 3             
  absThreshSS-BlocksConsolidation                      Not present                                    
  nrofSS-BlocksToAverage                               Not present                                    
  }                                                                                                   
  ---------------------------------------------------- ------------------------------------ --------- -----------

Table 8.1.6.1.3.2.3.3-4: *ReportConfigNR-EventA3* (Table
8.1.6.1.3.2.3.3-1)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\], |                 |                 |           |
| Table 4.6.3-142 |                 |                 |           |
| with condition  |                 |                 |           |
| EVENT\_A3       |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConfigNR  |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportType      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventTriggered  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventId CHOICE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventA3         |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| a3-Offset       |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | 2               | 1 dB (2\*0.5    | FR1       |
|                 |                 | dB)             |           |
+-----------------+-----------------+-----------------+-----------+
|                 | 2+              | a3-Offset value | FR2       |
|                 | Delta(NRf~2~) - | set to (2+      |           |
|                 | Delta(NRf~1~)   | Delta(NRf~2~) - |           |
|                 |                 | Delta(NRf~1~)). |           |
|                 |                 |                 |           |
|                 |                 | (Note 1)        |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportAmount    | r1              |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rep             |                 |                 |           |
| ortQuantityCell |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrp            | true            |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rsrq            | false           |                 |           |
+-----------------+-----------------+-----------------+-----------+
| sinr            | false           |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Note 1:         |                 |                 |           |
| Delta(NRf2) and |                 |                 |           |
| Delta(NRf1) are |                 |                 |           |
| derived based   |                 |                 |           |
| on calibration  |                 |                 |           |
| procedure       |                 |                 |           |
| defined in the  |                 |                 |           |
| TS 38.508-1     |                 |                 |           |
| \[4\], clause   |                 |                 |           |
| 6.1.3.3 where   |                 |                 |           |
| Delta(NRf1) is  |                 |                 |           |
| derived for the |                 |                 |           |
| carrier of NR   |                 |                 |           |
| PCell and       |                 |                 |           |
| Delta(NRf2) is  |                 |                 |           |
| derived for the |                 |                 |           |
| carrier of      |                 |                 |           |
| neighbour cell. |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

###### 8.1.6.1.3.3 Radio Link Failure / Reporting at RRC connection establishment and reestablishment

##### 8.1.6.1.3.3.1 Test Purpose (TP) {#test-purpose-tp-66 .H6}

##### (1) {#section-130 .H6}

with { UE in NR RRC\_CONNECTED state detecting radio link failure }

ensure that {

when { T301 expires after UE having sent an *RRCReestablishmentRequest*
message, the UE has radio link failure information available in
*VarRLF-Report* and *plmn-Identity* stored in *VarRLF-Report* is equal
to the RPLMN }

then { UE sends the *RRCSetupComplete* message with rlf-InfoAvailable
included after receiving an *RRCSetup* message }

}

##### (2) {#section-131 .H6}

with { UE in NR RRC\_CONNECTED state detecting radio link failure }

ensure that {

when { UE has radio link failure information available in
*VarRLF-Report* and *plmn-Identity* stored in *VarRLF-Report* is equal
to the RPLMN }

then { UE sends the *RRCReestablishmentComplete* message with
rlf-InfoAvailable included after receiving an *RRCReestablishment*
message }

}

##### (3) {#section-132 .H6}

with { UE in NR RRC\_CONNECTED state with the radio link failure
information available and *plmn-Identity* stored in *VarRLF-Report* is
equal to the RPLMN }

ensure that {

when { UE receives the *UEInformationRequest* message containing
*rlf-ReportReq* set to *true* }

then { UE sends the *UEInformationResponse* message with rlf-Report
included }

}

##### 8.1.6.1.3.3.2 Conformance requirements {#conformance-requirements-66 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.3.4, 5.3.7.5, 5.3.10.3, 5.3.7.4 and
5.7.10.3. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

1\> if the *RRCSetup* is received in response to an
*RRCReestablishmentRequest*; or

...

1\> perform the cell group configuration procedure in accordance with
the received *masterCellGroup* and as specified in 5.3.5.5;

1\> perform the radio bearer configuration procedure in accordance with
the received *radioBearerConfig* and as specified in 5.3.5.6;

1\> if stored, discard the cell reselection priority information
provided by the *cellReselectionPriorities* or inherited from another
RAT;

...

1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable in the RRCSetupComplete* message;

...

2\> if the UE has connection establishment failure or connection resume
failure information available in *VarConnEstFailReport* and if the RPLMN
is equal to *plmn-Identity* stored in *VarConnEstFailReport*:

3\> include *connEstFailInfoAvailable in the RRCSetupComplete* message;

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> if *reconnectCellId* in *VarRLF-Report* is not set:

4\> set *timeUntilReconnection* in *VarRLF-Report* to the time that
elapsed since the last radio link or handover failure;

4\> set *nrReconnectCellId* in *reconnectCellId* in *VarRLF-Report* to
the global cell identity and the tracking area code of the PCell;

3\> include *rlf-InfoAvailable in the RRCSetupComplete* message;

...

1\> submit the *RRCSetupComplete* message to lower layers for
transmission, upon which the procedure ends.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable in the RRCReestablishmentComplete*
message;

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report; or*

*...*

3\> include *rlf-InfoAvailable in the RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

...

1\> else:

2\> during a DAPS handover: the following only applies for the target
PCell;

2\> upon T310 expiry in PCell; or

...

2\> upon consistent uplink LBT failure indication from MCG MAC while
T304 is not running:

...

3\> else:

4\> consider radio link failure to be detected for the MCG i.e. RLF;

4\> discard any segments of segmented RRC messages stored according to
5.7.6.3;

NOTE: Void.

4\> if AS security has not been activated:

5\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'other\';-

4\> else if AS security has been activated but SRB2 and at least one DRB
or, for IAB, SRB2, have not been setup:

5\> store the radio link failure information in the *VarRLF-Report* as
described in subclause 5.3.10.5;

5\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\';

4\> else:

5\> store the radio link failure information in the *VarRLF-Report* as
described in subclause 5.3.10.5;

...

5\> else:

6\> initiate the connection re-establishment procedure as specified in
5.3.7.

The UE may discard the radio link failure information, i.e. release the
UE variable *VarRLF-Report*, 48 hours after the radio link failure is
detected.

\[TS 38.331, clause 5.3.7.4\]

The UE shall set the contents of *RRCReestablishmentRequest* message as
follows:

1\> if the procedure was initiated due to radio link failure as
specified in 5.3.10.3 or handover failure as specified in 5.3.5.8.3:

2\> set the *reestablishmentCellId* in the *VarRLF-Report* to the global
cell identity of the selected cell;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *logMeasReportReq* is present and if the RPLMN is included in
*plmn-IdentityList* stored in *VarLogMeasReport*:

2\> if *VarLogMeasReport* includes one or more logged measurement
entries, set the contents of the *logMeasReport* *in the
UEInformationResponse* message as follows:

3\> include the *absoluteTimeStamp* and set it to the value of
*absoluteTimeInfo* in the *VarLogMeasReport*;

> 3\> include the *traceReference* and set it to the value of
> *traceReference* in the *VarLogMeasReport*;

3\> include the *traceRecordingSessionRef* and set it to the value of
*traceRecordingSessionRef* in the *VarLogMeasReport;*

3\> include the *tce-Id* and set it to the value of *tce-Id* in the
*VarLogMeasReport*;

3\> include the *logMeasInfoList* and set it to include one or more
entries from *VarLogMeasReport* starting from the entries logged
first*;*

3\> if the *VarLogMeasReport* includes one or more additional logged
measurement entries that are not included in the *logMeasInfoList*
within the *UEInformationResponse* message:

4\> include the *logMeasAvailable;*

...

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

...

1\> if the *logMeasReport* is included in the *UEInformationResponse*:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB2;

2\> discard the logged measurement entries included in the
*logMeasInfoList* from *VarLogMeasReport upon successful* delivery *of
the UEInformationResponse* message confirmed by lower layers*;*

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.3.3 Test description {#test-description-64 .H6}

##### 8.1.6.1.3.3.3.1 Pre-test conditions {#pre-test-conditions-65 .H6}

##### System Simulator: {#system-simulator-45 .H6}

\- NR Cell 1 (TAI-1) is the serving cell.

\- NR Cell 2 and Cell 4 are the inter-frequency neighbor cells.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

NOTE: For NR Cell 2 and Cell 4 TAI is set to TAI-2.

##### UE: {#ue-53 .H6}

None.

##### Preamble: {#preamble-53 .H6}

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.

##### 8.1.6.1.3.3.3.2 Test procedure sequence {#test-procedure-sequence-65 .H6}

Table 8.1.6.1.3.3.3.2-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble, while columns marked \"T1\" and \"T2\" are to
be applied subsequently. The exact instants on which these values shall
be applied are described in the texts in this clause.

Table 8.1.6.1.3.3.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+-----------+-----------+---------------------------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | NR Cell 4 | Remark                    |
+====+===========+=========+===========+===========+===========+===========================+
| T0 | SS/PBCH   | dBm/SCS | -88       | \"Off\"   | \"Off\"   | Only Cell 1 is available. |
|    |           |         |           |           |           |                           |
|    | SSS EPRE  |         |           |           |           |                           |
+----+-----------+---------+-----------+-----------+-----------+---------------------------+
| T1 | SS/PBCH   | dBm/SCS | \"Off\"   | -88       | \"Off\"   | Only Cell 2 is available. |
|    |           |         |           |           |           |                           |
|    | SSS EPRE  |         |           |           |           |                           |
+----+-----------+---------+-----------+-----------+-----------+---------------------------+
| T2 | SS/PBCH   | dBm/SCS | \"Off\"   | \"Off\"   | -88       | Only Cell 4 is available. |
|    |           |         |           |           |           |                           |
|    | SSS EPRE  |         |           |           |           |                           |
+----+-----------+---------+-----------+-----------+-----------+---------------------------+

Table 8.1.6.1.3.3.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+-----------+-----------+---------------------------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | NR Cell 4 | Remark                    |
+====+===========+=========+===========+===========+===========+===========================+
| T0 | SS/PBCH   | dBm/SCS | -82       | \"Off\"   | \"Off\"   | Only Cell 1 is available. |
|    |           |         |           |           |           |                           |
|    | SSS EPRE  |         |           |           |           |                           |
+----+-----------+---------+-----------+-----------+-----------+---------------------------+
| T1 | SS/PBCH   | dBm/SCS | \"Off\"   | -82       | \"Off\"   | Only Cell 2 is available. |
|    |           |         |           |           |           |                           |
|    | SSS EPRE  |         |           |           |           |                           |
+----+-----------+---------+-----------+-----------+-----------+---------------------------+
| T2 | SS/PBCH   | dBm/SCS | \"Off\"   | \"Off\"   | -82       | Only Cell 4 is available. |
|    |           |         |           |           |           |                           |
|    | SSS EPRE  |         |           |           |           |                           |
+----+-----------+---------+-----------+-----------+-----------+---------------------------+

Table 8.1.6.1.3.3.3.2-3: Main behaviour

+-----+--------------+--------------+--------------+---------+----+
| St  | Procedure    | Message      | TP           | Verdict |    |
|     |              | Sequence     |              |         |    |
+=====+==============+==============+==============+=========+====+
|     |              | U - S        | Message      |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1   | The SS       | \-           | \-           | \-      | \- |
|     | changes NR   |              |              |         |    |
|     | Cell 1 and   |              |              |         |    |
|     | Cell 2       |              |              |         |    |
|     | parameters   |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T1\" in    |              |              |         |    |
|     | Table        |              |              |         |    |
|     | 8.1.6.1.     |              |              |         |    |
|     | 3.3.3.2-1/2. |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2   | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RR          |         |    |
|     | *RR          |              | CReestablish |         |    |
|     | CReestablish |              | mentRequest* |         |    |
|     | mentRequest* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 2.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 3   | The SS does  | \-           | *-*          | \-      | \- |
|     | not respond  |              |              |         |    |
|     | to any       |              |              |         |    |
|     | *RR          |              |              |         |    |
|     | CReestablish |              |              |         |    |
|     | mentRequest* |              |              |         |    |
|     | message and  |              |              |         |    |
|     | waits for 1s |              |              |         |    |
|     | to ensure    |              |              |         |    |
|     | that T301    |              |              |         |    |
|     | expires and  |              |              |         |    |
|     | the UE goes  |              |              |         |    |
|     | to NR        |              |              |         |    |
|     | RRC\_IDLE    |              |              |         |    |
|     | state on NR  |              |              |         |    |
|     | Cell 2.      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 4-5 | Steps 1-2 of | \-           | \-           | \-      | \- |
|     | Table        |              |              |         |    |
|     | 4.9.5.2.2-1  |              |              |         |    |
|     | of the       |              |              |         |    |
|     | generic      |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | \[4\] are    |              |              |         |    |
|     | performed on |              |              |         |    |
|     | NR Cell 2.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6   | Check: Does  | \--\>        | NR RRC:      | 1       | P  |
|     | the UE       |              | *RRCSe       |         |    |
|     | transmit an  |              | tupComplete* |         |    |
|     | *RRCSe       |              |              |         |    |
|     | tupComplete* |              | 5GMM:        |         |    |
|     | message with |              | REGISTRATION |         |    |
|     | *rlf-In      |              | REQUEST      |         |    |
|     | foAvailable* |              |              |         |    |
|     | included and |              |              |         |    |
|     | a            |              |              |         |    |
|     | REGISTRATION |              |              |         |    |
|     | REQUEST      |              |              |         |    |
|     | message      |              |              |         |    |
|     | indicating   |              |              |         |    |
|     | \"mobility   |              |              |         |    |
|     | registration |              |              |         |    |
|     | updating\"   |              |              |         |    |
|     | is sent to   |              |              |         |    |
|     | update the   |              |              |         |    |
|     | registration |              |              |         |    |
|     | of the       |              |              |         |    |
|     | actual       |              |              |         |    |
|     | tracking     |              |              |         |    |
|     | area?        |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6A  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *Security    |         |    |
|     | *Security    |              | ModeCommand* |         |    |
|     | ModeCommand* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 6B  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *SecurityM   |         |    |
|     | *SecurityM   |              | odeComplete* |         |    |
|     | odeComplete* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 7-8 | Steps 4-5 of | \-           | \-           | \-      | \- |
|     | Table        |              |              |         |    |
|     | 4.9.5.2.2-1  |              |              |         |    |
|     | of the       |              |              |         |    |
|     | generic      |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | \[4\] are    |              |              |         |    |
|     | performed.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 8A  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCReco      |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message to   |              |              |         |    |
|     | establish    |              |              |         |    |
|     | SRB2 and     |              |              |         |    |
|     | DRB.         |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 8B  | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCR         |         |    |
|     | *RRCR        |              | econfigurati |         |    |
|     | econfigurati |              | ontComplete* |         |    |
|     | ontComplete* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 9   | The SS       | \-           | \-           | \-      | \- |
|     | changes NR   |              |              |         |    |
|     | Cell 2 and   |              |              |         |    |
|     | Cell 4       |              |              |         |    |
|     | parameters   |              |              |         |    |
|     | according to |              |              |         |    |
|     | the row      |              |              |         |    |
|     | \"T2\" in    |              |              |         |    |
|     | Table        |              |              |         |    |
|     | 8.1.6.1.     |              |              |         |    |
|     | 3.3.3.2-1/2. |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 10  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RR          |         |    |
|     | *RR          |              | CReestablish |         |    |
|     | CReestablish |              | mentRequest* |         |    |
|     | mentRequest* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | NR Cell 4.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCRees     |         |    |
|     | *RRCRees     |              | tablishment* |         |    |
|     | tablishment* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 12  | Check: Does  | \--\>        | NR RRC:      | 2       | P  |
|     | the UE       |              | *RRC         |         |    |
|     | transmit an  |              | Reestablishm |         |    |
|     | *RRC         |              | entComplete* |         |    |
|     | Reestablishm |              |              |         |    |
|     | entComplete* |              |              |         |    |
|     | message with |              |              |         |    |
|     | *rlf-In      |              |              |         |    |
|     | foAvailable* |              |              |         |    |
|     | included?    |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 13  | The SS       | \<\--        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCReco      |         |    |
|     | *RRCReco     |              | nfiguration* |         |    |
|     | nfiguration* |              |              |         |    |
|     | message to   |              |              |         |    |
|     | establish    |              |              |         |    |
|     | SRB2 and     |              |              |         |    |
|     | DRB.         |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 14  | The UE       | \--\>        | *NR RRC:     | \-      | \- |
|     | transmits an |              | RRCR         |         |    |
|     | *RRCR        |              | econfigurati |         |    |
|     | econfigurati |              | ontComplete* |         |    |
|     | ontComplete* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 15  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *UEInforma   |         |    |
|     | *UEInforma   |              | tionRequest* |         |    |
|     | tionRequest* |              |              |         |    |
|     | message with |              |              |         |    |
|     | *rl          |              |              |         |    |
|     | f-ReportReq* |              |              |         |    |
|     | set to       |              |              |         |    |
|     | *true*.      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 16  | Check: Does  | \--\>        | NR RRC:      | 3       | P  |
|     | the UE       |              | *UEInformat  |         |    |
|     | transmit a   |              | ionResponse* |         |    |
|     | *UEInformat  |              |              |         |    |
|     | ionResponse* |              |              |         |    |
|     | message on   |              |              |         |    |
|     | Cell 4 with  |              |              |         |    |
|     | *rlf-Report* |              |              |         |    |
|     | included?    |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+

##### 8.1.6.1.3.3.3.3 Specific message contents {#specific-message-contents-66 .H6}

Table 8.1.6.1.3.3.3.3-0: *RRCSetup (preamble and step 5 in Table
8.1.6.1.3.3.3.2-3)*

  ---------------------------------------------------- ------------------------------------------------- ------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-21                                                                                                 
  Information Element                                  Value/remark                                      Comment                                     Condition
  RRCSetup ::= SEQUENCE {                                                                                                                            
  criticalExtensions CHOICE {                                                                                                                        
  rrcSetup SEQUENCE {                                                                                                                                
  masterCellGroup                                      CellGroupConfig as per table 8.1.6.1.3.3.3.3-0A   OCTET STRING (CONTAINING CellGroupConfig)   
  }                                                                                                                                                  
  }                                                                                                                                                  
  }                                                                                                                                                  
  ---------------------------------------------------- ------------------------------------------------- ------------------------------------------- -----------

Table 8.1.6.1.3.3.3.3-0A: *CellGroupConfig (preamble)*

  ------------------------------------------------------------------------ -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-19 with condition SRB1                            
  Information Element                                                      Value/remark   Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                    
  spCellConfig SEQUENCE {                                                                           
  rlf-TimersAndConstants CHOICE {                                                                   
  Setup SEQUENCE {                                                                                  
  t311                                                                     ms10000                  
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  }                                                                                                 
  ------------------------------------------------------------------------ -------------- --------- -----------

Table 8.1.6.1.3.3.3.3-1: *RRCReestablishmentRequest* (steps 2 and 10,
Table 8.1.6.1.3.3.3.2-3)

  ---------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-12                                                                                                    
  Information Element                                  Value/remark                                                                           Comment   Condition
  RRCReestablishmentRequest ::= SEQUENCE {                                                                                                              
  ue-Identity SEQUENCE {                                                                                                                                
  c-RNTI                                               the value of the C-RNTI of the UE                                                                
  physCellId                                           PCI of NR Cell 1                                                                                 Step 2
                                                       PCI of NR Cell 2                                                                                 Step 10
  shortMAC-I                                           The same value as the 16 least significant bits of the XMAC-I value calculated by SS             
  }                                                                                                                                                     
  reestablishmentCause                                 otherFailure                                                                                     
  }                                                                                                                                                     
  ---------------------------------------------------- -------------------------------------------------------------------------------------- --------- -----------

Table 8.1.6.1.3.3.3.3-2: *RRCSetupComplete* (step 6, Table
8.1.6.1.3.3.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition RLF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.3.3.3.3-3: *RRCReestablishmentComplete* (step 12, Table
8.1.6.1.3.3.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-11                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCReestablishmentComplete ::= SEQUENCE {                                                                        
  criticalExtensions CHOICE {                                                                                      
  rrcReestablishmentComplete SEQUENCE {                                                                            
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition RLF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.3.3.3.3-4: *UEInformationRequest* (step 15, Table
8.1.6.1.3.3.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

Table 8.1.6.1.3.3.3.3-5: *UEInformationResponse* (step 16, Table
8.1.6.1.3.3.3.2-3)

  ----------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                   
  Information Element                                   Value/remark                                                              Comment                                                               Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                                                           
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                  
  rlf-Report-r16 CHOICE {                                                                                                                                                                               
  nr-RLF-Report-r16 SEQUENCE {                                                                                                                                                                          
  measResultLastServCell-r16 SEQUENCE {                                                                                                                                                                 
  measResult-r16 SEQUENCE {                                                                                                                                                                             
  cellResults-r16 SEQUENCE {                                                                                                                                                                            
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                                                                                        
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  (0..127)                                                                                                                                        
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  resultsCSI-RS-Cell-r16                                Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  rsIndexResults-r16 SEQUENCE {                                                                                                                                                                         
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                                                                                     
  ssb-Index                                             0                                                                         Cell 2 SSB index                                                      
  ssb-Results SEQUENCE {                                                                                                                                                                                
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  (0..127)                                                                                                                                        
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  ssbRLMConfigBitmap-r16                                10000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000   Radio LinkMonitoring configuration for Cell 2                         
  resultsCSI-RS-Indexes-r16                             Not present                                                                                                                                     
  csi-rsRLMConfigBitmap-r16                             Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  measResultNeighCells-r16                              Not present                                                                                                                                     
  c-RNTI-r16                                            the old value of the C-RNTI of the UE used in NR Cell 2                                                                                         
  previousPCellId-r16                                   Not present                                                                                                                                     
  failedPCellId-r16 CHOICE {                                                                                                                                                                            
  nrFailedPCellId-r16                                   Any Allowed Value                                                         Either pci-arfcn-r16 or cellGlobalId-r16 corresponding to NR Cell 2   
  eutraFailedPCellId-r16                                Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  reconnectCellId-r16                                   Not present                                                                                                                                     
  timeUntilReconnection-16                              Not present                                                                                                                                     
  reestablishmentCellId-r16 SEQUENCE {                                                                                                                                                                  
  plmn-Identity-r16                                     PLMN ID of NR Cell 4                                                                                                                            
  cellIdentity-r16                                      CGI of NR Cell 4                                                                                                                                
  trackingAreaCode-r16                                  TAC of NR Cell 4                                                                                                                                
  }                                                                                                                                                                                                     
  timeConnFailure-r16                                   Not present                                                                                                                                     
  timeSinceFailure-r16                                  Not checked                                                                                                                                     
  connectionFailureType-r16                             rlf                                                                                                                                             
  rlf-Cause-r16                                         t310-Expiry                                                                                                                                     
  locationInfo-r16                                      Not checked                                                                                                                                     
  noSuitableCellFound-r16                               Not present                                                                                                                                     
  ra-InformationCommon-r16                              Not present                                                                                                                                     
  csi-rsRLMConfigBitmap-v1650                           Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  eutra-RLF-Report-r16                                  Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  ----------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------

###### 8.1.6.1.3.4 Radio Link Failure / Reporting at NR handover

##### 8.1.6.1.3.4.1 Test Purpose (TP) {#test-purpose-tp-67 .H6}

##### (1) {#section-133 .H6}

with { UE in RRC\_CONNECTED state with handover failure information
available }

ensure that {

when { UE receives *RRCReestablishment* message }

then { UE sends the *RRCReestablishmentComplete* message with
*rlf-InfoAvailable* }

}

##### (2) {#section-134 .H6}

with { UE in RRC\_CONNECTED state with the handover failure information
available }

ensure that {

when { UE receives the *UEInformationRequest* message containing
*rlf-ReportReq* }

then { UE sends the *UEInformationResponse* message with *rlf-Report*
included }

}

##### 8.1.6.1.3.4.2 Conformance requirements {#conformance-requirements-67 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.7.4, 5.3.10.5, 5.3.5.8.3, 5.3.5.3
and 5.7.10.3. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.7.4\]

The UE shall set the contents of *RRCReestablishmentRequest* message as
follows:

1\> if the procedure was initiated due to radio link failure as
specified in 5.3.10.3 or reconfiguration with sync failure as specified
in 5.3.5.8.3:

2\> set the *reestablishmentCellId* in the *VarRLF-Report* to the global
cell identity of the selected cell;

...

\[TS 38.331, clause 5.3.7.4\]

The UE shall:

...

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

...

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* of TS 36.331 \[10\] and if the UE is
capable of cross-RAT RLF reporting and if the RPLMN is included in
plmn-IdentityList stored in *VarRLF-Report* of TS 36.331 \[10\]:

3\> include *rlf-InfoAvailable* in the *RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

\[TS 38.331, clause 5.3.10.5\]

The UE shall determine the content in the *VarRLF-Report* as follows:

1\> clear the information included in *VarRLF-Report*, if any;

1\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e. includes the RPLMN);

1\> set the *measResultLastServCell* to include the cell level RSRP,
RSRQ and the available SINR, of the source PCell(in case HO failure) or
PCell (in case RLF) based on the available SSB and CSI-RS measurements
collected up to the moment the UE detected failure;

1\> if the SS/PBCH block-based measurement quantities are available:

2\> set the *rsIndexResults* in *measResultLastServCell* to include all
the available measurement quantities of the source PCell (in case HO
failure) or PCell (in case RLF), ordered such that the highest SS/PBCH
block RSRP is listed first if SS/PBCH block RSRP measurement results are
available, otherwise the highest SS/PBCH block RSRQ is listed first if
SS/PBCH block RSRQ measurement results are available, otherwise the
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

...

1\> set the *c-RNTI* to the C-RNTI used in the source PCell(in case HO
failure) or PCell (in case RLF);

1\> if the failure is detected due to reconfiguration with sync failure
as described in 5.3.5.8.3, set the fields in *VarRLF-report* as follows:

2\> set the *connectionFailureType* to *hof*;

2\> set the *nrFailedPCellId* in *failedPCellId* to the global cell
identity and tracking area code, if available, and otherwise to the
physical cell identity and carrier frequency of the target PCell of the
failed handover;

2\> include *nrPreviousCell* in *previousPCellId* and set it to the
global cell identity and tracking area code of the PCell where the last
*RRCReconfiguration* message including *reconfigurationWithSync* was
received;

2\> set the *timeConnFailure* to the elapsed time since reception of the
last *RRCReconfiguration* message including the
*reconfigurationWithSync*;

...

1\> if available, set the *locationInfo* as in 5.3.3.7.

The UE may discard the radio link failure information or handover
failure information, i.e. release the UE variable *VarRLF-Report*, 48
hours after the radio link failure/handover failure is detected.

NOTE 2: In this clause, the term \'handover failure\' has been used to
refer to \'reconfiguration with sync failure\'.

\[TS 38.331, clause 5.3.5.8.3\]

The UE shall:

1\> if T304 of the MCG expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated* if
configured;

2\> release dedicated msgA PUSCH resources provided in
*rach-ConfigDedicated* if configured;

...

2\> else:

3\> revert back to the UE configuration used in the source PCell;

3\> store the handover failure information in *VarRLF-Report* as
described in the subclause 5.3.10.5;

3\> initiate the connection re-establishment procedure as specified in
subclause 5.3.7.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> set the content of the *RRCReconfigurationComplete* message as
follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*; or

...

3\> include *rlf-InfoAvailable in the RRCReconfigurationComplete*
message;

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link failure or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.4.3 Test description {#test-description-65 .H6}

##### 8.1.6.1.3.4.3.1 Pre-test conditions {#pre-test-conditions-66 .H6}

##### System Simulator: {#system-simulator-46 .H6}

\- NR Cell 1 is the serving cell.

\- NR Cell 2 is the Suitable neighbour intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-54 .H6}

None.

##### Preamble: {#preamble-54 .H6}

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.

##### 8.1.6.1.3.4.3.2 Test procedure sequence {#test-procedure-sequence-66 .H6}

Table 8.1.6.1.3.4.3.2-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.3.4.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+-----------+---------------------------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark                    |
+====+===========+=========+===========+===========+===========================+
| T0 | SS/PBCH   | dBm/SCS | -88       | -94       |                           |
|    |           |         |           |           |                           |
|    | SSS EPRE  |         |           |           |                           |
+----+-----------+---------+-----------+-----------+---------------------------+
| T1 | SS/PBCH   | dBm/SCS | -88       | \"Off\"   | Only Cell 1 is available. |
|    |           |         |           |           |                           |
|    | SSS EPRE  |         |           |           |                           |
+----+-----------+---------+-----------+-----------+---------------------------+

Table 8.1.6.1.3.4.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+-----------+---------------------------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark                    |
+====+===========+=========+===========+===========+===========================+
| T0 | SS/PBCH   | dBm/SCS | -82       | -91       |                           |
|    |           |         |           |           |                           |
|    | SSS EPRE  |         |           |           |                           |
+----+-----------+---------+-----------+-----------+---------------------------+
| T1 | SS/PBCH   | dBm/SCS | -82       | \"Off\"   | Only Cell 1 is available. |
|    |           |         |           |           |                           |
|    | SSS EPRE  |         |           |           |                           |
+----+-----------+---------+-----------+-----------+---------------------------+

Table 8.1.6.1.3.4.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                          Message Sequence   TP                                      Verdict   
  ---- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                                          U - S              Message                                           
  1    The SS transmits an *RRCReconfiguration* message on NR Cell 1 to order the UE to perform handover to NR Cell 2.                                                                    \<\--              NR RRC: *RRCReconfiguration*            \-        \-
  \-   EXCEPTION: In parallel to the events described in step 2 the steps specified in Table 8.1.6.1.3.4.3.2-4 should take place.                                                         \-                 \-                                      \-        \-
  2    The SS changes the power level setting according to the row \"T1\".                                                                                                                \-                 \-                                      \-        \-
  3    The UE transmits an *RRCReestablishmentRequest* message on NR Cell 1.                                                                                                              \--\>              NR RRC: *RRCReestablishmentRequest*     \-        \-
  4    The SS transmits an *RRCReestablishment* message to resume SRB1 operation and re-activate security on NR Cell 1.                                                                   \<\--              NR RRC: *RRCReestablishment*            \-        \-
  5    Check: Does the UE transmit an *RRCReestablishmentComplete* message with *rlf-InfoAvailable* included using the security key derived from the nextHopChainingCount on NR Cell 1.   \--\>              NR RRC: *RRCReestablishmentComplete*    1         P
  6    The SS transmits an *RRCReconfiguration* message to resume existing radio bearers on NR Cell 1.                                                                                    \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  7    The UE transmit an *RRCReconfigurationtComplete* message.                                                                                                                          \--\>              *NR RRC: RRCReconfigurationtComplete*   \-        \-
  8    The SS transmits a *UEInformationRequest* message.                                                                                                                                 \<\--              *NR RRC: UEInformationRequest*          \-        \-
  9    Check: Does the UE transmit a *UEInformationResponse* message on NR Cell 1?                                                                                                        \--\>              *NR RRC: UEInformationResponse*         2         P

Table 8.1.6.1.3.4.3.2-4: Parallel behaviour

  St   Procedure                                                                                Message Sequence   TP        Verdict   
  ---- ---------------------------------------------------------------------------------------- ------------------ --------- --------- ----
                                                                                                U - S              Message             
  \-   EXCEPTION: The steps 1 and 2 below are repeated for the duration of T304.                \-                 *-*       \-        \-
  1    The UE attempts to perform the handover using MAC Random Access Preamble on NR Cell 2.   \-                 *-*       \-        \-
  2    The SS does not respond.                                                                 \-                 *-*       \-        \-

##### 8.1.6.1.3.4.3.3 Specific message contents {#specific-message-contents-67 .H6}

Table 8.1.6.1.3.4.3.3-1: *RRCReconfiguration-HO* (step 1, Table
8.1.6.1.3.4.3.2-3)

  ---------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with condition RBConfig\_KeyChange
  ---------------------------------------------------------------------------------------

Table 8.1.6.1.3.4.3.3-2: *RRCReestablishmentRequest* (step 3, Table
8.1.6.1.3.4.3.2-3)

+----------------------+----------------------+---------+-----------+
| Derivation Path: TS  |                      |         |           |
| 38.508-1, Table      |                      |         |           |
| 4.6.1-12             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| RRCRe                |                      |         |           |
| establishmentRequest |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ue-Identity SEQUENCE |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| c-RNTI               | the value of the     |         |           |
|                      | C-RNTI of the UE     |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId           | PhysicalCellIdentity |         |           |
|                      | of NR Cell 1         |         |           |
+----------------------+----------------------+---------+-----------+
| shortMAC-I           | The same value as    |         |           |
|                      | the 16 least         |         |           |
|                      | significant bits of  |         |           |
|                      | the MAC-I value      |         |           |
|                      |                      |         |           |
|                      | calculated by SS.    |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| reestablishmentCause | handoverFailure      |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

Table 8.1.6.1.3.4.3.3-3: *RRCReestablishment* (step 4, Table
8.1.6.1.3.4.3.2-3)

  ---------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1, Table 4.6.1-10                            
  Information Element                            Value/remark   Comment   Condition
  RRCReestablishment ::= SEQUENCE {                                       
  criticalExtensions CHOICE {                                             
  rrcReestablishment SEQUENCE {                                           
  nextHopChainingCount                           2                        
  }                                                                       
  }                                                                       
  }                                                                       
  ---------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.3.4.3.3-4: *RRCReestablishmentComplete* (step 5, Table
8.1.6.1.3.4.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-11                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCReestablishmentComplete ::= SEQUENCE {                                                                        
  criticalExtensions CHOICE {                                                                                      
  rrcReestablishmentComplete SEQUENCE {                                                                            
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition RLF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.3.4.3.3-5: *RRCReconfiguration* (step 6, Table
8.1.6.1.3.4.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

Table 8.1.6.1.3.4.3.3-6: Void

Table 8.1.6.1.3.4.3.3-7: *UEInformationRequest* (step 8, Table
8.1.6.1.3.4.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

Table 8.1.6.1.3.4.3.3-8: *UEInformationResponse* (step 9, Table
8.1.6.1.3.4.3.2-3)

  ----------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                   
  Information Element                                   Value/remark                                                              Comment                                                               Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                                                           
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                  
  rlf-Report-r16 CHOICE {                                                                                                                                                                               
  nr-RLF-Report-r16 SEQUENCE {                                                                                                                                                                          
  measResultLastServCell-r16 SEQUENCE {                                                                                                                                                                 
  measResult-r16 SEQUENCE {                                                                                                                                                                             
  cellResults-r16 SEQUENCE {                                                                                                                                                                            
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                                                                                        
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  (0..127)                                                                                                                                        
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  resultsCSI-RS-Cell-r16                                Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  rsIndexResults-r16 SEQUENCE {                                                                                                                                                                         
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                                                                                     
  ssb-Index                                             1                                                                                                                                               
  ssb-Results SEQUENCE {                                                                                                                                                                                
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  (0..127)                                                                                                                                        
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  ssbRLMConfigBitmap-r16                                01000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000                                                                         
  resultsCSI-RS-Indexes-r16                             Not present                                                                                                                                     
  csi-rsRLMConfigBitmap-r16                             Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  measResultNeighCells-r16                              Not present                                                                                                                                     
  c-RNTI-r16                                            the old value of the C-RNTI of the UE used in NR Cell 1                                                                                         
  previousPCellId-r16 CHOICE {                                                                                                                                                                          
  nrPreviousCell-r16 SEQUENCE {                                                                                                                                                                         
  plmn-Identity-r16                                     PLMN ID of NR Cell 1                                                                                                                            
  cellIdentity-r16                                      CGI of NR Cell 1                                                                                                                                
  trackingAreaCode-r16                                  TAC of NR Cell 1                                                                                                                                
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  failedPCellId-r16 CHOICE {                                                                                                                                                                            
  nrFailedPCellId-r16                                   Any Allowed Value                                                         Either pci-arfcn-r16 or cellGlobalId-r16 corresponding to NR Cell 2   
  eutraFailedPCellId-r16                                Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  reconnectCellId-r16                                   Not present                                                                                                                                     
  timeUntilReconnection-16                              Not present                                                                                                                                     
  reestablishmentCellId-r16 SEQUENCE {                                                                                                                                                                  
  plmn-Identity-r16                                     PLMN ID of NR Cell 1                                                                                                                            
  cellIdentity-r16                                      CGI of NR Cell 1                                                                                                                                
  trackingAreaCode-r16                                  TAC of NR Cell 1                                                                                                                                
  }                                                                                                                                                                                                     
  timeConnFailure-r16                                   Any allowed value                                                                                                                               
  timeSinceFailure-r16                                  Any allowed value                                                                                                                               
  connectionFailureType-r16                             hof                                                                                                                                             
  rlf-Cause-r16                                         Not checked                                                                                                                                     
  locationInfo-r16                                      Not checked                                                                                                                                     
  noSuitableCellFound-r16                               Not present                                                                                                                                     
  ra-InformationCommon-r16                              Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  ----------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------

###### 8.1.6.1.3.5 Radio Link Failure / Location information

##### 8.1.6.1.3.5.1 Test Purpose (TP) {#test-purpose-tp-68 .H6}

##### (1) {#section-135 .H6}

with { UE in RRC\_CONNECTED having performed the intra-frequency
measurement and reported that the UE has radio link failure information
with location information available }

ensure that {

when { UE receives the *UEInformationRequest* message containing
*rlf-ReportReq* }

then { UE sends the *UEInformationResponse* containing the measurement
result for intra-frequency neighbour cell including *locationInfo* }

}

##### 8.1.6.1.3.5.2 Conformance requirements {#conformance-requirements-68 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.306 clause 4.2.18; TS 38.331, clauses 5.3.10.3,
5.3.10.5, 5.3.3.7, 5.3.7.4, 5.3.7.5, 5.3.5.9 and 5.7.10.3. Unless
otherwise stated these are Rel-16 requirements.

\[TS 38.306, clause 4.2.18\]

+-------------------------------------------------+----+----+----+----+
| ***gnss-Location-r16***                         | UE | No | No | No |
|                                                 |    |    |    |    |
| Indicates whether the UE is equipped with a     |    |    |    |    |
| GNSS or A-GNSS receiver that may be used to     |    |    |    |    |
| provide detailed location information along     |    |    |    |    |
| with SON or MDT related measurements in         |    |    |    |    |
| RRC\_CONNECTED, RRC\_IDLE and RRC\_INACTIVE.    |    |    |    |    |
+-------------------------------------------------+----+----+----+----+

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

...

1\> else:

2\> during a DAPS handover: the following only applies for the target
PCell;

2\> upon T310 expiry in PCell; or

...

2\> upon consistent uplink LBT failure indication from MCG MAC while
T304 is not running:

...

3\> else:

4\> consider radio link failure to be detected for the MCG i.e. RLF;

4\> discard any segments of segmented RRC messages stored according to
5.7.6.3;

NOTE: Void.

4\> if AS security has not been activated:

5\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'other\';-

4\> else if AS security has been activated but SRB2 and at least one DRB
or, for IAB, SRB2, have not been setup:

5\> store the radio link failure information in the *VarRLF-Report* as
described in subclause 5.3.10.5;

5\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\';

4\> else:

5\> store the radio link failure information in the *VarRLF-Report* as
described in subclause 5.3.10.5;

...

5\> else:

6\> initiate the connection re-establishment procedure as specified in
5.3.7.

The UE may discard the radio link failure information, i.e. release the
UE variable *VarRLF-Report*, 48 hours after the radio link failure is
detected.

\[TS 38.331, clause 5.3.10.5\]

The UE shall determine the content in the *VarRLF-Report* as follows:

1\> clear the information included in *VarRLF-Report*, if any;

1\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e. includes the RPLMN);

1\> set the *measResultLastServCell* to include the cell level RSRP,
RSRQ and the available SINR, of the source PCell(in case HO failure) or
PCell (in case RLF) based on the available SSB and CSI-RS measurements
collected up to the moment the UE detected failure;

1\> if the SS/PBCH block-based measurement quantities are available:

2\> set the *rsIndexResults* in *measResultLastServCell* to include all
the available measurement quantities of the source PCell (in case HO
failure) or PCell (in case RLF), ordered such that the highest SS/PBCH
block RSRP is listed first if SS/PBCH block RSRP measurement results are
available, otherwise the highest SS/PBCH block RSRQ is listed first if
SS/PBCH block RSRQ measurement results are available, otherwise the
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

...

1\> set the *ssbRLMConfigBitmap* and/or *csi-rsRLMConfigBitmap* in
*measResultLastServCell* to include the radio link monitoring
configuration of the source PCell(in case HO failure) or PCell (in case
RLF);

...

1\> set the *c-RNTI* to the C-RNTI used in the source PCell(in case HO
failure) or PCell (in case RLF);

...

1\> else if the failure is detected due to radio link failure as
described in 5.3.10.3, set the fields in *VarRLF-report* as follows:

2\> set the *connectionFailureType* to *rlf*;

2\> set the *rlf-Cause* to the trigger for detecting radio link failure
in accordance with clause 5.3.10.4;

2\> set the *nrFailedPCellId* *in* *failedPCellId* to the global cell
identity and the tracking area code, if available, and otherwise to the
physical cell identity and carrier frequency of the PCell where radio
link failure is detected;

...

1\> if available, set the *locationInfo* as in 5.3.3.7.

The UE may discard the radio link failure information or handover
failure information, i.e. release the UE variable *VarRLF-Report*, 48
hours after the radio link failure/handover failure is detected.

NOTE 2: In this clause, the term \'handover failure\' has been used to
refer to \'reconfiguration with sync failure\'.

\[TS 38.331, clause 5.3.3.7\]

The UE shall:

1\> if timer T300 expires:

2\> reset MAC, release the MAC configuration and re-establish RLC for
all RBs that are established;

2\> if the UE supports RRC Connection Establishment failure with
temporary offset and the T300 has expired a consecutive
*connEstFailCount* times on the same cell for which
*connEstFailureControl* is included in *SIB1*:

3\> for a period as indicated by *connEstFailOffsetValidity*:

4\> use *connEstFailOffset* for the parameter *Qoffsettemp* for the
concerned cell when performing cell selection and reselection according
to TS 38.304 \[20\] and TS 36.304 \[27\];

NOTE 1: When performing cell selection, if no suitable or acceptable
cell can be found, it is up to UE implementation whether to stop using
*connEstFailOffset* for the parameter *Qoffsettemp* during
*connEstFailOffsetValidity* for the concerned cell.

2\> if the UE has connection establishment failure informaton or
connection resume failure information available in
*VarConnEstFailReport* and if the RPLMN is not equal to *plmn-identity*
stored in *VarConnEstFailReport*; or

2\> if the cell identity of current cell is not equal to the cell
identity stored in *measResultFailedCell* in *VarConnEstFailReport*:

3\> reset the *numberOfConnFail* to 0;

2\> clear the content included in *VarConnEstFailReport* except for the
*numberOfConnFail*, if any;

2\> store the following connection establishment failure information in
the *VarConnEstFailReport* by setting its fields as follows:

...

3\> if available, set the *locationInfo* as follows:

4\> if available, set the *commonLocationInfo* to include the detailed
location information;

4\> if available, set the *bt-LocationInfo* to include the Bluetooth
measurement results, in order of decreasing RSSI for Bluetooth beacons;

4\> if available, set the *wlan-LocationInfo* to include the WLAN
measurement results, in order of decreasing RSSI for WLAN APs;

4\> if available, set the *sensor-LocationInfo* to include the sensor
measurement results as follows;

5\> if available, include the *sensor-MeasurementInformation*;

5\> if available, include the *sensor-MotionInformation*;

\[TS 38.331, clause 5.3.7.4\]

The UE shall set the contents of *RRCReestablishmentRequest* message as
follows:

1\> if the procedure was initiated due to radio link failure as
specified in 5.3.10.3 or handover failure as specified in 5.3.5.8.3:

2\> set the *reestablishmentCellId* in the *VarRLF-Report* to the global
cell identity of the selected cell;

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable in the RRCReestablishmentComplete*
message;

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report; or*

*...*

3\> include *rlf-InfoAvailable in the RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

\[TS 38.331, clause 5.3.5.9\]

The UE shall:

...

1\> if the received *otherConfig* includes the *obtainCommonLocation*:

2\> include available detailed location information for any subsequent
measurement report or any subsequent RLF report and
SCGFailureInformation;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link failure or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.5.3 Test description {#test-description-66 .H6}

##### 8.1.6.1.3.5.3.1 Pre-test conditions {#pre-test-conditions-67 .H6}

##### System Simulator: {#system-simulator-47 .H6}

\- NR Cell 1 is the serving cell.

\- NR Cell 2 is the Suitable neighbour intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-55 .H6}

None.

##### Preamble: {#preamble-55 .H6}

\- The UE\'s positioning engine (e.g. standalone GNSS receiver) should
be provided with any necessary stimulus to allow it to provide the
position. This shall be done by use of the test function Update UE
Location Information defined in TS 38.509 \[6\] or any other suitable
method may also be used.

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.

##### 8.1.6.1.3.5.3.2 Test procedure sequence {#test-procedure-sequence-67 .H6}

Same test procedure as specified in 8.1.6.1.3.1.3.2 with the following
exception:

\- The specific message content for the RRCReconfiguration message in
Table 8.1.6.1.3.1.3.3-1 is replaced by the specific message content in
Table 8.1.6.1.3.5.3.3-0.

\- The specific message content for the *UEInformationResponse* message
in Table 8.1.6.1.3.1.3.3-10 is replaced by the specific message content
in Table 8.1.6.1.3.5.3.3-1.

##### 8.1.6.1.3.5.3.3 Specific message contents {#specific-message-contents-68 .H6}

Table 8.1.6.1.3.5.3.3-0: *RRCReconfiguration* (step 1, Table
8.1.6.1.3.1.3.2-3)

  ---------------------------------------------------------------------------- -------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS                            
  Information Element                                                          Value/remark   Comment   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                     
  criticalExtensions CHOICE {                                                                           
  rrcReconfiguration SEQUENCE {                                                                         
  nonCriticalExtension SEQUENCE {                                                                       
  nonCriticalExtension SEQUENCE {                                                                       
  nonCriticalExtension SEQUENCE {                                                                       
  nonCriticalExtension SEQUENCE {                                                                       
  otherConfig-v1610 SEQUENCE {                                                                          
  obtainCommonLocation-r16                                                     true                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  }                                                                                                     
  ---------------------------------------------------------------------------- -------------- --------- -----------

Table 8.1.6.1.3.5.3.3-1: *UEInformationResponse* (step 9, Table
8.1.6.1.3.1.3.2-3)

  ----------------------------------------------------- ------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                       
  Information Element                                   Value/remark                                                              Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                  
  criticalExtensions CHOICE {                                                                                                               
  ueInformationResponse-r16 SEQUENCE {                                                                                                      
  rlf-Report-r16 CHOICE {                                                                                                                   
  nr-RLF-Report-r16 SEQUENCE {                                                                                                              
  measResultLastServCell-r16 SEQUENCE {                                                                                                     
  measResult-r16 SEQUENCE {                                                                                                                 
  cellResults-r16 SEQUENCE {                                                                                                                
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                            
  rsrp                                                  (0..127)                                                                            
  rsrq                                                  (0..127)                                                                            
  sinr                                                  Not checked                                                                         
  }                                                                                                                                         
  resultsCSI-RS-Cell-r16                                Not checked                                                                         
  }                                                                                                                                         
  rsIndexResults-r16 SEQUENCE {                                                                                                             
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                         
  ssb-Index                                             1                                                                                   
  ssb-Results SEQUENCE {                                                                                                                    
  rsrp                                                  (0..127)                                                                            
  rsrq                                                  (0..127)                                                                            
  sinr                                                  Not checked                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ssbRLMConfigBitmap-r16                                01000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000             
  resultsCSI-RS-Indexes-r16                             Not present                                                                         
  csi-rsRLMConfigBitmap-r16                             Not present                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  measResultNeighCells-r16 SEQUENCE {                                                                                                       
  measResultListNR-r16 SEQUENCE {                                                                                                           
  ssbFrequency-r16                                      ARFCN-ValueNR for SSB of NR Cell 2                                                  
  refFreqCSI-RS-r16                                     Not present                                                                         
  measResultList-r16 SEQUENCE {                                                                                                             
  physCellId                                            PCI of NR Cell 2                                                                    
  measResult SEQUENCE {                                                                                                                     
  cellResults SEQUENCE {                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                
  rsrp                                                  (0..127)                                                                            
  rsrq                                                  Not present                                                                         
  sinr                                                  Not present                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  c-RNTI-r16                                            the old value of the C-RNTI of the UE used in NR Cell 1                             
  previousPCellId-r16                                   Not present                                                                         
  failedPCellId-r16 CHOICE {                                                                                                                
  nrFailedPCellId-r16 CHOICE {                                                                                                              
  pci-arfcn-r16 SEQUENCE {                                                                                                                  
  physCellId-r16                                        PCI of NR Cell 1                                                                    
  carrierFreq-r16                                       NARFCN of NR Cell 1                                                                 
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  reconnectCellId-r16                                   Not present                                                                         
  timeUntilReconnection-16                              Not present                                                                         
  reestablishmentCellId-r16 SEQUENCE {                                                                                                      
  plmn-Identity-r16                                     PLMN ID of NR Cell 2                                                                
  cellIdentity-r16                                      CGI of NR Cell 2                                                                    
  trackingAreaCode-r16                                  TAC of NR Cell 2                                                                    
  }                                                                                                                                         
  timeConnFailure-r16                                   Not present                                                                         
  timeSinceFailure-r16                                  Any allowed value                                                                   
  connectionFailureType-r16                             rlf                                                                                 
  rlf-Cause-r16                                         t310-Expiry                                                                         
  locationInfo-r16 SEQUENCE {                                                                                                               
  commonLocationInfo-r16                                Any allowed value                                                                   
  bt-LocationInfo-r16                                   Not checked                                                                         
  wlan-LocationInfo-r16                                 Not checked                                                                         
  sensor-LocationInfo-r16                               Not checked                                                                         
  }                                                                                                                                         
  noSuitableCellFound-r16                               Not present                                                                         
  ra-InformationCommon-r16                              Not present                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ----------------------------------------------------- ------------------------------------------------------------------------- --------- -----------

###### 8.1.6.1.3.6 Radio Link Failure / Random access problem

##### 8.1.6.1.3.6.1 Test Purpose (TP) {#test-purpose-tp-69 .H6}

##### (1) {#section-136 .H6}

with { UE in RRC\_CONNECTED state with the radio link failure
information with cause randomAccessProblem available }

ensure that {

when { UE receives the *UEInformationRequest* message containing
*rlf-ReportReq* }

then { UE sends the *UEInformationResponse* message with *rlf-Report*
with rlf-cause randomAccesProblem included }

}

##### 8.1.6.1.3.6.2 Conformance requirements {#conformance-requirements-69 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.3.7, 5.7.10.5, 5.3.10.3, 5.3.10.5
and 5.7.10.3. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.3.7\]

The UE shall:

1\> if timer T300 expires:

...

2\> store the following connection establishment failure information in
the *VarConnEstFailReport* by setting its fields as follows:

3\> set the *plmn-Identity* to the PLMN selected by upper layers (see TS
24.501 \[23\]) from the PLMN(s) included in the *plmn-IdentityList* in
*SIB1*;

...

3\> set *perRAInfoList* to indicate random access failure information as
specified in 5.7.10.5;

...

2\> inform upper layers about the failure to establish the RRC
connection, upon which the procedure ends;

The UE may discard the connection establishment failure or connection
resume failure information, i.e. release the UE variable
*VarConnEstFailReport*, 48 hours after the last connection establishment
failure is detected.

\[TS 38.331, clause 5.7.10.5\]

The UE shall set the content in *ra-InformationCommon* as follows:

1\> set the *absoluteFrequencyPointA* to indicate the absolute frequency
of the reference resource block associated to the random-access
resources used in the random-access procedure;

1\> set the *locationAndBandwidth* and *subcarrierSpacing* associated to
the UL BWP of the random-access resources used in the random-access
procedure;

1\> set the *msg1-FrequencyStart,* *msg1-FDM* and
*msg1-SubcarrierSpacing* associated to the contention based
random-access resources if used in the random-access procedure;

1\> set the *msg1-FrequencyStartCFRA*, *msg1-FDMCFRA* and
*msg1-SubcarrierSpacingCFRA* associated to the contention free
random-access resources if used in the random-access procedure;

1\> set the parameters associated to individual random-access attempt in
the chronological order of attempts in the *perRAInfoList* as follows:

2\> if the random-access resource used is associated to a SS/PBCH block,
set the associated random-access parameters for the successive
random-access attempts associated to the same SS/PBCH block for one or
more random-access attempts as follows:

3\> set the *ssb-Index* to include the SS/PBCH block index associated to
the used random-access resource;

3\> set the *numberOfPreamblesSentOnSSB* to indicate the number of
successive random-access attempts associated to the SS/PBCH block;

3\> for each random-access attempt performed on the random-access
resource, include the following parameters in the chronological order of
the random-access attempt:

4\> if the random-access attempt is performed on the contention based
random-access resource and if *raPurpose* is not equal to
\'*requestForOtherSI*\', include *contentionDetected* as follows:

5\> if contention resolution was not successful as specified in TS
38.321 \[6\] for the transmitted preamble:

6\> set the *contentionDetected* to *true*;

5\> else:

6\> set the *contentionDetected* to *false*;

4\> if the random-access attempt is performed on the contention based
random-access resource; or

4\> if the random-access attempt is performed on the contention free
random-access resource and if the random-access procedure was initiated
due to the PDCCH ordering:

5\> if the SS/PBCH block RSRP of the SS/PBCH block corresponding to the
random-access resource used in the random-access attempt is above
*rsrp-ThresholdSSB*:

6\> set the *dlRSRPAboveThreshold* to *true*;

5\> else:

6\> set the *dlRSRPAboveThreshold* to *false*;

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

...

1\> else:

...

2\> upon random access problem indication from MCG MAC while neither
T300, T301, T304, T311 nor T319 are running; or

\[TS 38.331, clause 5.3.10.5\]

The UE shall determine the content in the *VarRLF-Report* as follows:

1\> clear the information included in *VarRLF-Report*, if any;

1\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e. includes the RPLMN);

1\> set the *measResultLastServCell* to include the cell level RSRP,
RSRQ and the available SINR, of the source PCell(in case HO failure) or
PCell (in case RLF) based on the available SSB and CSI-RS measurements
collected up to the moment the UE detected failure;

1\> if the SS/PBCH block-based measurement quantities are available:

2\> set the *rsIndexResults* in *measResultLastServCell* to include all
the available measurement quantities of the source PCell (in case HO
failure) or PCell (in case RLF), ordered such that the highest SS/PBCH
block RSRP is listed first if SS/PBCH block RSRP measurement results are
available, otherwise the highest SS/PBCH block RSRQ is listed first if
SS/PBCH block RSRQ measurement results are available, otherwise the
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

...

1\> set the *ssbRLMConfigBitmap* and/or *csi-rsRLMConfigBitmap* in
*measResultLastServCell* to include the radio link monitoring
configuration of the source PCell(in case HO failure) or PCell (in case
RLF);

...

1\> set the *c-RNTI* to the C-RNTI used in the source PCell(in case HO
failure) or PCell (in case RLF);

...

1\> else if the failure is detected due to radio link failure as
described in 5.3.10.3, set the fields in *VarRLF-report* as follows:

2\> set the *connectionFailureType* to *rlf*;

2\> set the *rlf-Cause* to the trigger for detecting radio link failure
in accordance with clause 5.3.10.4;

2\> set the *nrFailedPCellId* *in* *failedPCellId* to the global cell
identity and the tracking area code, if available, and otherwise to the
physical cell identity and carrier frequency of the PCell where radio
link failure is detected;

...

1\> if *connectionFailureType* is *rlf* and the *rlf-Cause* is set to
*randomAccessProblem* or *beamFailureRecoveryFailure*; or

1\> if *connectionFailureType* is *hof and if the failed handover is an
intra-RAT handover*:

2\> set the *ra-InformationCommon* to include the random-access related
information as described in subclause 5.7.10.5;

1\> if available, set the *locationInfo* as in 5.3.3.7.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link failure or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.6.3 Test description {#test-description-67 .H6}

##### 8.1.6.1.3.6.3.1 Pre-test conditions {#pre-test-conditions-68 .H6}

\- NR Cell 1 is the serving cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-56 .H6}

None.

##### Preamble: {#preamble-56 .H6}

\- The UE is in state 3N-A according to TS 38.508-1 \[4\], clause 4.4A.2
Table 4.4A.2-3.

##### 8.1.6.1.3.6.3.2 Test procedure sequence {#test-procedure-sequence-68 .H6}

Table 8.1.6.1.3.6.3.2-1: Void

Table 8.1.6.1.3.6.3.2-2: Void

Table 8.1.6.1.3.6.3.2-3: Main behaviour

  **St**   **Procedure**                                                                               **Message Sequence**   **TP**                                  **Verdict**   
  -------- ------------------------------------------------------------------------------------------- ---------------------- --------------------------------------- ------------- ----
                                                                                                       **U - S**              **Message**                                           
  1-11     Void                                                                                                                                                                     
  12       The SS is configured to ignore the preambles transmitted by the UE on PRACH.                \-                     *-*                                     \-            \-
  13       The SS sends a PDCCH order with ra-PreambleIndex = \'000000\'B.                             \-                     *-*                                     \-            \-
  14       The UE transmits Preamble on PRACH preambleTransMax times.                                  \-                     *-*                                     \-            \-
  14A      The SS is configured to reply the preambles transmitted by the UE on PRACH.                                                                                              
  15       The UE transmits an *RRCReestablishmentRequest* message                                     \--\>                  NR RRC: *RRCReestablishmentRequest*     \-            \-
  16       The SS transmits an *RRCReestablishment* message.                                           \<\--                  NR RRC: *RRCReestablishment*            \-            \-
  17       The UE transmita an *RRCReestablishmentComplete* message.                                   \--\>                  NR RRC: *RRCReestablishmentComplete*    \-            \-
  18       The SS transmits an *RRCReconfiguration* message to establish SRB2 and DRB.                 \<\--                  *NR RRC: RRCReconfiguration*            \-            \-
  19       The UE transmits an *RRCReconfigurationtComplete* message.                                  \--\>                  *NR RRC: RRCReconfigurationtComplete*   \-            \-
  20       The SS transmits a *UEInformationRequest* message with *rlf-ReportReq* set to *true*.       \<\--                  NR RRC: *UEInformationRequest*          \-            \-
  21       Check: Does the UE transmit a *UEInformationResponse* message with *rlf-Report* included?   \--\>                  NR RRC: *UEInformationResponse*         2             P

##### 8.1.6.1.3.6.3.3 Specific message contents {#specific-message-contents-69 .H6}

Table 8.1.6.1.3.6.3.3-1: *RRCReestablishmentComplete* (step 17, Table
8.1.6.1.3.6.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-11                                                                   
  ---------------------------------------------------- ------------------------------------------------- ------------- ---------------
  **Information Element**                              **Value/remark**                                  **Comment**   **Condition**
  RRCReestablishmentComplete ::= SEQUENCE {                                                                            
  criticalExtensions CHOICE {                                                                                          
  rrcReestablishmentComplete SEQUENCE {                                                                                
  nonCriticalExtension SEQUENCE {                                                                                      
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition RLF                 
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    

Table 8.1.6.1.3.6.3.3-2: *UEInformationRequest* (step 20, Table
8.1.6.1.3.6.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

Table 8.1.6.1.3.6.3.3-3: *UEInformationResponse* (step 21, Table
8.1.6.1.3.6.3.2-3)

  ----------------------------------------------------- ------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                       
  Information Element                                   Value/remark                                                              Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                  
  criticalExtensions CHOICE {                                                                                                               
  ueInformationResponse-r16 SEQUENCE {                                                                                                      
  rlf-Report-r16 CHOICE {                                                                                                                   
  nr-RLF-Report-r16 SEQUENCE {                                                                                                              
  measResultLastServCell-r16 SEQUENCE {                                                                                                     
  measResult-r16 SEQUENCE {                                                                                                                 
  cellResults-r16 SEQUENCE {                                                                                                                
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                            
  rsrp                                                  (0..127)                                                                            
  rsrq                                                  (0..127)                                                                            
  sinr                                                  Not checked                                                                         
  }                                                                                                                                         
  resultsCSI-RS-Cell-r16                                Not checked                                                                         
  }                                                                                                                                         
  rsIndexResults-r16 SEQUENCE {                                                                                                             
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                         
  ssb-Index                                             1                                                                                   
  ssb-Results SEQUENCE {                                                                                                                    
  rsrp                                                  (0..127)                                                                            
  rsrq                                                  (0..127)                                                                            
  sinr                                                  Not checked                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ssbRLMConfigBitmap-r16                                01000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000             
  resultsCSI-RS-Indexes-r16                             Not present                                                                         
  csi-rsRLMConfigBitmap-r16                             Not present                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  measResultNeighCells-r16                              Not present                                                                         
  c-RNTI-r16                                            the value of the C-RNTI of the UE used in the pre-amble                             
  previousPCellId-r16 CHOICE {                          Not present                                                                         
  failedPCellId-r16 CHOICE {                                                                                                                
  nrFailedPCellId-r16 CHOICE {                                                                                                              
  cellGlobalId-r16 SEQUENCE {                                                                                                               
  plmn-Identity-r16                                     PLMN ID of NR Cell 1                                                                
  cellIdentity-r16                                      CGI of NR Cell 1                                                                    
  trackingAreaCode-r16                                  TAC of NR Cell 1                                                                    
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  reconnectCellId-r16                                   Not present                                                                         
  timeUntilReconnection-16                              Not present                                                                         
  reestablishmentCellId-r16                             Not checked                                                                         
  timeConnFailure-r16                                   Not present                                                                         
  timeSinceFailure-r16                                  Any allowed value                                                                   
  connectionFailureType-r16                             rlf                                                                                 
  rlf-Cause-r16                                         randomAccessProblem                                                                 
  locationInfo-r16                                      Not checked                                                                         
  noSuitableCellFound-r16                               Not present                                                                         
  ra-InformationCommon-r16 SEQUENCE {                                                                                                       
  absoluteFrequencyPointA-r16                           Any allowed value                                                                   
  locationAndBandwidth-r16                              Any allowed value                                                                   
  subcarrierSpacing-r16                                 Any allowed value                                                                   
  msg1-FrequencyStart-r16                               Not checked                                                                         
  msg1-FrequencyStartCFRA-r16                           Not checked                                                                         
  msg1-SubcarrierSpacing-r16                            Not checked                                                                         
  msg1-SubcarrierSpacingCFRA-r16                        Not checked                                                                         
  msg1-FDM-r16                                          Not checked                                                                         
  msg1-FDMCFRA-r16                                      Not checked                                                                         
  perRAInfoList-r16 SEQUENCE {                                                                                                              
  PerRAInfo-r16\[1\] CHOICE {                                                                                                               
  perRASSBInfoList-r16 SEQUENCE {                                                                                                           
  PerRASSBInfo-r16\[1\] SEQUENCE {                                                                                                          
  ssb-Index-r16                                         Any allowed value                                                                   
  numberOfPreamblesSentOnSSB-r16                        Any allowed value                                                                   
  perRAAttemptInfoList-r16 SEQUENCE {                                                                                                       
  PerRAAttemptInfo-r16\[1\] SEQUENCE {                                                                                                      
  contentionDetected-r16                                Any allowed value                                                                   
  dlRSRPAboveThreshold-r16                              True                                                                                
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ----------------------------------------------------- ------------------------------------------------------------------------- --------- -----------

###### 8.1.6.1.3.7 Radio Link Failure / Logging and reporting / Reporting at intra NR handover / PLMN list

##### 8.1.6.1.3.7.1 Test Purpose (TP) {#test-purpose-tp-70 .H6}

##### (1) {#section-137 .H6}

**with { UE having completed the radio bearer establishment and initial
security activation procedure }**

**ensure that** {

**when** { UE performs RRC connection re-establishment procedure **and**
intra-NR handover procedure}

**then** { UE sends an *RRCReconfigurationComplete* message with
*rlf-InfoAvailable* }

}

##### (2) {#section-138 .H6}

**with {** UE receives a *UEInformationRequest* message with
*rlf-ReportReq* set to true **}**

**ensure that** {

**when** { The RPLMN is included in plmn-IdentityList stored in
VarRLF-Report }

**then** { UE sends a *UEInformationResponse* message with *rlf-Report*
}

}

##### 8.1.6.1.3.7.2 Conformance requirements {#conformance-requirements-70 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.5.3, 5.3.10.3, 5.3.10.5 and
5.7.10.3. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> if the *RRCReconfiguration* includes the *masterCellGroup*:

2\> perform the cell group configuration for the received
*masterCellGroup* according to 5.3.5.5;

...

1\> if the *RRCReconfiguration* message includes the
*radioBearerConfig*:

2\> perform the radio bearer configuration according to 5.3.5.6;

...

1\> set the content of the *RRCReconfigurationComplete* message as
follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*; or

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* of TS 36.331 \[10\] and if the UE is
capable of cross-RAT RLF reporting and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report* of TS 36.331 \[10\]:

3\> include *rlf-InfoAvailable in the RRCReconfigurationComplete*
message;

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

...

1\> else:

2\> during a DAPS handover: the following only applies for the target
PCell;

2\> upon T310 expiry in PCell; or

2\> upon T312 expiry in PCell; or

2\> upon random access problem indication from MCG MAC while neither
T300, T301, T304, T311 nor T319 are running; or

2\> upon indication from MCG RLC that the maximum number of
retransmissions has been reached; or

2\> if connected as an IAB-node, upon BH RLF indication received on BAP
entity from the MCG; or

2\> upon consistent uplink LBT failure indication from MCG MAC while
T304 is not running:

...

3\> else:

4\> consider radio link failure to be detected for the MCG, i.e. MCG
RLF;

4\> discard any segments of segmented RRC messages stored according to
5.7.6.3;

NOTE: Void.

4\> if AS security has not been activated:

5\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'other\';-

4\> else if AS security has been activated but SRB2 and at least one DRB
or, for IAB, SRB2, have not been setup:

5\> store the radio link failure information in the *VarRLF-Report* as
described in subclause 5.3.10.5;

5\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11,
with release cause \'RRC connection failure\';

4\> else:

5\> store the radio link failure information in the *VarRLF-Report* as
described in subclause 5.3.10.5;

...

5\> else:

6\> initiate the connection re-establishment procedure as specified in
5.3.7.

\[TS 38.331, clause 5.3.10.5\]

The UE shall determine the content in the *VarRLF-Report* as follows:

1\> clear the information included in *VarRLF-Report*, if any;

1\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e. includes the RPLMN);

1\> set the *measResultLastServCell* to include the cell level RSRP,
RSRQ and the available SINR, of the source PCell(in case HO failure) or
PCell (in case RLF) based on the available SSB and CSI-RS measurements
collected up to the moment the UE detected failure;

1\> if the SS/PBCH block-based measurement quantities are available:

2\> set the *rsIndexResults* in *measResultLastServCell* to include all
the available measurement quantities of the source PCell (in case HO
failure) or PCell (in case RLF), ordered such that the highest SS/PBCH
block RSRP is listed first if SS/PBCH block RSRP measurement results are
available, otherwise the highest SS/PBCH block RSRQ is listed first if
SS/PBCH block RSRQ measurement results are available, otherwise the
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

...

1\> set the *ssbRLMConfigBitmap* and/or *csi-rsRLMConfigBitmap* in
*measResultLastServCell* to include the radio link monitoring
configuration of the source PCell(in case HO failure) or PCell (in case
RLF);

...

1\> set the *c-RNTI* to the C-RNTI used in the source PCell(in case HO
failure) or PCell (in case RLF);

...

1\> else if the failure is detected due to radio link failure as
described in 5.3.10.3, set the fields in *VarRLF-report* as follows:

2\> set the *connectionFailureType* to *rlf*;

2\> set the *rlf-Cause* to the trigger for detecting radio link failure
in accordance with clause 5.3.10.4;

2\> set the *nrFailedPCellId* *in* *failedPCellId* to the global cell
identity and the tracking area code, if available, and otherwise to the
physical cell identity and carrier frequency of the PCell where radio
link failure is detected;

...

1\> if available, set the *locationInfo* as in 5.3.3.7.

The UE may discard the radio link failure information or handover
failure information, i.e. release the UE variable *VarRLF-Report*, 48
hours after the radio link failure/handover failure is detected.

NOTE 2: In this clause, the term \'handover failure\' has been used to
refer to \'reconfiguration with sync failure\'.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link failure or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

\...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.7.3 Test description {#test-description-68 .H6}

##### 8.1.6.1.3.7.3.1 Pre-test conditions {#pre-test-conditions-69 .H6}

##### System Simulator: {#system-simulator-48 .H6}

\- NR Cell 1 is the serving cell.

\- NR Cell 12 is the Suitable neighbour inter-frequency cell.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

\- The PLMNs are identified in the test by the identifiers in Table
8.1.6.1.3.7.3.1-1.

Table 8.1.6.1.3.7.3.1-1: PLMN identifiers

  Cell   PLMN ID
  ------ ---------
  1      PLMN1
  12     PLMN2

##### UE: {#ue-57 .H6}

None.

##### Preamble: {#preamble-57 .H6}

\- The UE is registered on PLMN1 (NR Cell 1) using the procedure
described in TS 38.508-1\[4\] clause 4.5.2.2-2 except that the
REGISTRATION ACCEPT message indicates PLMN2 in the Equivalent PLMN list.

\- The UE is in state 3N-A on NR Cell 1 according to TS 38.508-1 \[4\],
clause 4.4A.

##### 8.1.6.1.3.7.3.2 Test procedure sequence {#test-procedure-sequence-69 .H6}

Table 8.1.6.1.3.7.3.2-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.3.7.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+------------+---------------------------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 12 | Remark                    |
+====+===========+=========+===========+============+===========================+
| T0 | SS/PBCH   | dBm/SCS | -88       | \"Off\"    |                           |
|    |           |         |           |            |                           |
|    | SSS EPRE  |         |           |            |                           |
+----+-----------+---------+-----------+------------+---------------------------+
| T1 | SS/PBCH   | dBm/SCS | \"Off\"   | \"Off\"    |                           |
|    |           |         |           |            |                           |
|    | SSS EPRE  |         |           |            |                           |
+----+-----------+---------+-----------+------------+---------------------------+
| T2 | SS/PBCH   | dBm/SCS | -88       | \"Off\"    | Only Cell 1 is available. |
|    |           |         |           |            |                           |
|    | SSS EPRE  |         |           |            |                           |
+----+-----------+---------+-----------+------------+---------------------------+
| T3 | SS/PBCH   | dBm/SCS | -88       | -82        |                           |
|    |           |         |           |            |                           |
|    | SSS EPRE  |         |           |            |                           |
+----+-----------+---------+-----------+------------+---------------------------+

Table 8.1.6.1.3.7.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+------------+---------------------------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 12 | Remark                    |
+====+===========+=========+===========+============+===========================+
| T0 | SS/PBCH   | dBm/SCS | -82       | \"Off\"    |                           |
|    |           |         |           |            |                           |
|    | SSS EPRE  |         |           |            |                           |
+----+-----------+---------+-----------+------------+---------------------------+
| T1 | SS/PBCH   | dBm/SCS | \"Off\"   | \"Off\"    |                           |
|    |           |         |           |            |                           |
|    | SSS EPRE  |         |           |            |                           |
+----+-----------+---------+-----------+------------+---------------------------+
| T2 | SS/PBCH   | dBm/SCS | -82       | \"Off\"    | Only Cell 1 is available. |
|    |           |         |           |            |                           |
|    | SSS EPRE  |         |           |            |                           |
+----+-----------+---------+-----------+------------+---------------------------+
| T3 | SS/PBCH   | dBm/SCS | -82       | -73        |                           |
|    |           |         |           |            |                           |
|    | SSS EPRE  |         |           |            |                           |
+----+-----------+---------+-----------+------------+---------------------------+

Table 8.1.6.1.3.7.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The SS      | \-          | \-          | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1      |             |             |         |    |
|       | parameters  |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 8.1.6.1.3   |             |             |         |    |
|       | .7.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \-          | \-          | \-      | \- |
|       | waits for   |             |             |         |    |
|       | 3s to       |             |             |         |    |
|       | ensure that |             |             |         |    |
|       | the UE      |             |             |         |    |
|       | detects     |             |             |         |    |
|       | T310        |             |             |         |    |
|       | expiry.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | The SS      | \-          | \-          | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1      |             |             |         |    |
|       | parameters  |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T2\" in   |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 8.1.6.1.3   |             |             |         |    |
|       | .7.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The UE      | \--\>       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCR        |         |    |
|       | an          |             | eestablishm |         |    |
|       | *RRCR       |             | entRequest* |         |    |
|       | eestablishm |             |             |         |    |
|       | entRequest* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 1.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCReest    |         |    |
|       | an          |             | ablishment* |         |    |
|       | *RRCReest   |             |             |         |    |
|       | ablishment* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | The UE      | \--\>       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRe       |         |    |
|       | an          |             | establishme |         |    |
|       | *RRCRe      |             | ntComplete* |         |    |
|       | establishme |             |             |         |    |
|       | ntComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRecon    |         |    |
|       | an          |             | figuration* |         |    |
|       | *RRCRecon   |             |             |         |    |
|       | figuration* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | establish   |             |             |         |    |
|       | SRB2 and    |             |             |         |    |
|       | DRB.        |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 8     | The UE      | \--\>       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRec      |         |    |
|       | an          |             | onfiguratio |         |    |
|       | *RRCRec     |             | ntComplete* |         |    |
|       | onfiguratio |             |             |         |    |
|       | ntComplete* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 9     | The SS      | \-          |             | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 12     |             |             |         |    |
|       | parameters  |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T3\" in   |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 8.1.6.1.3   |             |             |         |    |
|       | .7.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 10    | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits   |             | RRCRecon    |         |    |
|       | an          |             | figuration* |         |    |
|       | *RRCRecon   |             |             |         |    |
|       | figuration* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | Cell 1 to   |             |             |         |    |
|       | order the   |             |             |         |    |
|       | UE to       |             |             |         |    |
|       | perform     |             |             |         |    |
|       | inter       |             |             |         |    |
|       | frequency   |             |             |         |    |
|       | handover to |             |             |         |    |
|       | Cell 12.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11    | Check: Does | \--\>       | *NR RRC:    | 1       | P  |
|       | the UE send |             | RRCRe       |         |    |
|       | an          |             | configurati |         |    |
|       | *RRCRe      |             | onComplete* |         |    |
|       | configurati |             |             |         |    |
|       | onComplete* |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | *rlf-Inf    |             |             |         |    |
|       | oAvailable* |             |             |         |    |
|       | on Cell 12? |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmit a  |             | *           |         |    |
|       | R           |             | ULInformati |         |    |
|       | EGISTRATION |             | onTransfer* |         |    |
|       | REQUEST     |             |             |         |    |
|       | message     |             | 5GMM:       |         |    |
|       | with        |             | R           |         |    |
|       | r           |             | EGISTRATION |         |    |
|       | egistration |             | REQUEST     |         |    |
|       | type value  |             |             |         |    |
|       | set to      |             |             |         |    |
|       | "mobility   |             |             |         |    |
|       | r           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | updating".  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 13-14 | Steps 4 to  | \-          | \-          | \-      | \- |
|       | 5 of        |             |             |         |    |
|       | generic     |             |             |         |    |
|       | test        |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\]       |             |             |         |    |
|       | subclause   |             |             |         |    |
|       | 4.9.5.2.2-1 |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed   |             |             |         |    |
|       | on Cell 12. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | The SS      | \<\--       | *NR RRC:    | \-      | \- |
|       | transmits a |             | UEInformat  |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | rl          |             |             |         |    |
|       | f-ReportReq |             |             |         |    |
|       | set to      |             |             |         |    |
|       | true.       |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | Check: Does | \--\>       | *NR RRC:    | 2       | P  |
|       | the UE      |             | UEInformati |         |    |
|       | transmit a  |             | onResponse* |         |    |
|       | *           |             |             |         |    |
|       | UEInformati |             |             |         |    |
|       | onResponse* |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 12? |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.3.7.3.3 Specific message contents {#specific-message-contents-70 .H6}

Table 8.1.6.1.3.7.3.3-0: *CellGroupConfig* (preamble RRCSetup)

  ---------------------------------------------------- ------------------ ------------- ---------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19                                    
  **Information Element**                              **Value/remark**   **Comment**   **Condition**
  CellGroupConfig ::= SEQUENCE {                                                        
  spCellConfig SEQUENCE {                                                               
  rlf-TimersAndConstants SEQUENCE {                                                     
  t311                                                 ms10000                          
  }                                                                                     
  }                                                                                     
  }                                                                                     
  ---------------------------------------------------- ------------------ ------------- ---------------

Table 8.1.6.1.3.7.3.3-1: *RRCReestablishmentRequest* (step 4, Table
8.1.6.1.3.7.3.2-3)

+----------------------+----------------------+---------+-----------+
| Derivation Path: TS  |                      |         |           |
| 38.508-1, Table      |                      |         |           |
| 4.6.1-12             |                      |         |           |
+----------------------+----------------------+---------+-----------+
| Information Element  | Value/remark         | Comment | Condition |
+----------------------+----------------------+---------+-----------+
| RRCRe                |                      |         |           |
| establishmentRequest |                      |         |           |
| ::= SEQUENCE {       |                      |         |           |
+----------------------+----------------------+---------+-----------+
| ue-Identity SEQUENCE |                      |         |           |
| {                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| c-RNTI               | the value of the     |         |           |
|                      | C-RNTI of the UE     |         |           |
+----------------------+----------------------+---------+-----------+
| physCellId           | PhysicalCellIdentity |         |           |
|                      | of NR Cell 1         |         |           |
+----------------------+----------------------+---------+-----------+
| shortMAC-I           | The same value as    |         |           |
|                      | the 16 least         |         |           |
|                      | significant bits of  |         |           |
|                      | the MAC-I value      |         |           |
|                      |                      |         |           |
|                      | calculated by SS.    |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+
| reestablishmentCause | otherFailure         |         |           |
+----------------------+----------------------+---------+-----------+
| }                    |                      |         |           |
+----------------------+----------------------+---------+-----------+

Table 8.1.6.1.3.7.3.3-2: *RRCReconfiguration* (step 7, Table
8.1.6.1.3.7.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

Table 8.1.6.1.3.7.3.3-3: *RRCReconfiguration-HO* (step 10, Table
8.1.6.1.3.7.3.2-3)

  ---------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with condition RBConfig\_KeyChange
  ---------------------------------------------------------------------------------------

Table 8.1.6.1.3.7.3.3-4: *RRCReconfigurationComplete* (step 11, Table
8.1.6.1.3.7.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-14                                                               
  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Information Element                                  Value/remark                                      Comment   Condition
  RRCReconfigurationComplete ::= SEQUENCE {                                                                        
  criticalExtensions CHOICE {                                                                                      
  rrcReconfigurationComplete SEQUENCE {                                                                            
  nonCriticalExtension SEQUENCE {                                                                                  
  nonCriticalExtension SEQUENCE {                                                                                  
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition RLF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                

Table 8.1.6.1.3.7.3.3-5: *UEInformationRequest* (step 15, Table
8.1.6.1.3.7.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

Table 8.1.6.1.3.7.3.3-6: *UEInformationResponse* (step 16, Table
8.1.6.1.3.7.3.2-3)

  ----------------------------------------------------- ------------------------------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                       
  Information Element                                   Value/remark                                                              Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                  
  criticalExtensions CHOICE {                                                                                                               
  ueInformationResponse-r16 SEQUENCE {                                                                                                      
  rlf-Report-r16 CHOICE {                                                                                                                   
  nr-RLF-Report-r16 SEQUENCE {                                                                                                              
  measResultLastServCell-r16 SEQUENCE {                                                                                                     
  measResult-r16 SEQUENCE {                                                                                                                 
  cellResults-r16 SEQUENCE {                                                                                                                
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                            
  rsrp                                                  (0..127)                                                                            
  rsrq                                                  (0..127)                                                                            
  sinr                                                  Not checked                                                                         
  }                                                                                                                                         
  resultsCSI-RS-Cell-r16                                Not checked                                                                         
  }                                                                                                                                         
  rsIndexResults-r16 SEQUENCE {                                                                                                             
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                         
  ssb-Index                                             1                                                                                   
  ssb-Results SEQUENCE {                                                                                                                    
  rsrp                                                  (0..127)                                                                            
  rsrq                                                  (0..127)                                                                            
  sinr                                                  Not checked                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ssbRLMConfigBitmap-r16                                01000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000             
  resultsCSI-RS-Indexes-r16                             Not present                                                                         
  csi-rsRLMConfigBitmap-r16                             Not present                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  measResultNeighCells-r16                              Not present                                                                         
  c-RNTI-r16                                            the old value of the C-RNTI of the UE used in NR Cell 1                             
  previousPCellId-r16                                   Not present                                                                         
  failedPCellId-r16 CHOICE {                                                                                                                
  nrFailedPCellId-r16 CHOICE {                                                                                                              
  cellGlobalId-r16 SEQUENCE {                                                                                                               
  plmn-Identity-r16                                     the first PLMN entry of plmn-IdentityList (in SIB1)                                 
  cellIdentity-r16                                      CGI of NR Cell 1                                                                    
  trackingAreaCode-r16                                  TAC of NR Cell 1                                                                    
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  reconnectCellId-r16                                   Not present                                                                         
  timeUntilReconnection-16                              Not present                                                                         
  reestablishmentCellId-r16 SEQUENCE {                                                                                                      
  plmn-Identity-r16                                     the first PLMN entry of plmn-IdentityList (in SIB1)                                 
  cellIdentity-r16                                      CGI of NR Cell 1                                                                    
  trackingAreaCode-r16                                  TAC of NR Cell 1                                                                    
  }                                                                                                                                         
  timeConnFailure-r16                                   Not present                                                                         
  timeSinceFailure-r16                                  Any allowed value                                                                   
  connectionFailureType-r16                             rlf                                                                                 
  rlf-Cause-r16                                         t310-Expiry                                                                         
  locationInfo-r16                                      Not checked                                                                         
  noSuitableCellFound-r16                               Not present                                                                         
  ra-InformationCommon-r16                              Not present                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  }                                                                                                                                         
  ----------------------------------------------------- ------------------------------------------------------------------------- --------- -----------

###### 8.1.6.1.3.8 Radio Link Failure / Logging and reporting / Event A3 / CHO

##### 8.1.6.1.3.8.1 Test Purpose (TP) {#test-purpose-tp-71 .H6}

##### (1) {#section-139 .H6}

**with** { UE performed conditional handover to the neighbour cell
triggered in conditional configuration execution A3 and UE detected
handover failure }

**ensure that** {

**when** { UE re-establishes the RRC connection on source cell and
receives RRCReestablishment message }

**then** { UE sends the RRCReestablishmentComplete message with
rlf-InfoAvailable }

}

##### (2) {#section-140 .H6}

**with** { UE performed conditional handover to the neighbour cell
triggered in conditional configuration execution A3 and UE detected
handover failure }

**ensure that** {

**when** { UE receives the UEInformationRequest message containing
rlf-ReportReq }

**then** { UE sends the UEInformationResponse message with rlf-Report
for conditional handover failure }

}

##### 8.1.6.1.3.8.2 Conformance requirements {#conformance-requirements-71 .H6}

##### 8.1.6.1.3.8.2 Conformance requirements {#conformance-requirements-72 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.7.5, 5.3.10.5, 5.3.5.8.3, 5.3.5.3
and 5.7.10.3. Unless otherwise stated these are Rel-17 requirements.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* of TS 36.331 \[10\] and if the UE is
capable of cross-RAT RLF reporting and if the RPLMN is included in
plmn-IdentityList stored in *VarRLF-Report* of TS 36.331 \[10\]:

3\> include *rlf-InfoAvailable* in the *RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

\[TS 38.331, clause 5.3.10.5\]

The UE shall determine the content in the *VarRLF-Report* as follows:

1\> clear the information included in *VarRLF-Report*, if any;

1\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e. includes the RPLMN);

1\> set the *measResultLastServCell* to include the cell level RSRP,
RSRQ and the available SINR, of the source PCell(in case HO failure) or
PCell (in case RLF) based on the available SSB and CSI-RS measurements
collected up to the moment the UE detected failure;

1\> if the SS/PBCH block-based measurement quantities are available:

2\> set the *rsIndexResults* in *measResultLastServCell* to include all
the available measurement quantities of the source PCell (in case HO
failure) or PCell (in case RLF), ordered such that the highest SS/PBCH
block RSRP is listed first if SS/PBCH block RSRP measurement results are
available, otherwise the highest SS/PBCH block RSRQ is listed first if
SS/PBCH block RSRQ measurement results are available, otherwise the
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

1\> for each of the configured *measObjectNR* in which measurements are
available:

...

2\> for each neighbour cell, if any, included in *measResultListNR* in
*measResultNeighCells:*

3\> if the UE supports RLF-Report for conditional handover and if the
neighbour cell is one of the candidate cells for which the
*reconfigurationWithSync* is included in the *masterCellGroup* in the
MCG *VarConditionalReconfig at the moment of the detected failure:*

4\> set *choConfig* in *MeasResult2NR* to the execution condition for
each *measId* within *condTriggerConfig* associated to the neighbour
cell within the MCG *VarConditionalReconfig*;

4\> if the first entry of *choConfig* corresponds to a fulfilled
execution condition at the moment of handover failure, or radio link
failure; or

4\> if the second entry of *choConfig*, if available, corresponds to a
fulfilled execution condition at the moment of handover failure, or
radio link failure:

5\> set *firstTriggeredEvent* to the execution condition
*condFirstEvent* corresponding to the first entry of *choConfig* or to
the execution condition *condSecondEvent* corresponding to the second
entry of *choConfig*, whichever execution condition was fulfilled first
in time;

5\> set *timeBetweenEvents* to the elapsed time between the point in
time of fullfilling the condition in *choConfig* that was fulfilled
first in time, and the point in time of fullfilling the condition in
*choConfig* that was fulfilled second in time, if both the first
execution condition corresponding to the first entry and the second
execution condition corresponding to the second entry in the *choConfig*
were fullfilled;

1\> if the failure is detected due to reconfiguration with sync failure
as described in 5.3.5.8.3, set the fields in *VarRLF-report* as follows:

2\> set the *connectionFailureType* to *hof*;

2\> if the UE supports RLF-Report for DAPS handover and if any DAPS
bearer was configured while T304 was running:

3\> set *lastHO-Type* to *daps*;

3\> if radio link failure was detected in the source PCell, according to
clause 5.3.10.3:

4\> set *timeConnSourceDAPS-Failure* to the time between the initiation
of the DAPS handover execution and the radio link failure detected in
the source PCell while T304 was running;

4\> set the *rlf-Cause* to the trigger for detecting the source radio
link failure in accordance with clause 5.3.10.4;

2\> if the UE supports RLF-Report for conditional handover and if
*configuration of the conditional handover is available in the MCG
VarConditionalReconfig at the moment of the handover failure*:

3\> if the UE executed a conditional handover toward target PCell
according to the *condRRCReconfig* of the target PCell:

4\> set *timeSinceCHO-Reconfig* to the time elapsed between the
execution of the last *RRCReconfiguration* message including
*reconfigurationWithSync* for the target PCell of the failed conditional
handover, and the reception in the source PCell of the last
*conditionalReconfiguration* including the *condRRCReconfig* of the
target PCell of the failed conditional handover;

3\> else:

4\> set *timeSinceCHO-Reconfig* to the time elapsed between the
execution of the last *RRCReconfiguration* message including
*reconfigurationWithSync* for the target PCell of the failed handover,
and the reception in the source PCell of the last
*conditionalReconfiguration* including the *condRRCReconfig*;

3\> set *choCandidateCellList* to include the global cell identity, if
available, and otherwise to the physical cell identity and carrier
frequency of each of the candidate target cells for conditional handover
included in *condRRCReconfig* within *the MCG VarConditionalReconfig* at
the time of the failed handover, excluding the candidate target cells
included in *measResulNeighCells*;

2\> if the UE supports RLF-Report for conditional handover and if the
last executed *RRCReconfiguration* message including
*reconfigurationWithSync* was concerning a conditional handover:

3\> set *lastHO-Type* to *cho*;

2\> set the *nrFailedPCellId* in *failedPCellId* to the global cell
identity and tracking area code, if available, and otherwise to the
physical cell identity and carrier frequency of the target PCell of the
failed handover;

2\> include *nrPreviousCell* in *previousPCellId* and set it to the
global cell identity and tracking area code of the PCell where the last
*RRCReconfiguration* message including *reconfigurationWithSync* was
received;

2\> set the timeConnFailure to the elapsed time since the execution of
the last RRCReconfiguration message including the
reconfigurationWithSync;

...

1\> if available, set the *locationInfo* as in 5.3.3.7.

The UE may discard the radio link failure information or handover
failure information, i.e. release the UE variable *VarRLF-Report*, 48
hours after the radio link failure/handover failure is detected.

NOTE 2: In this clause, the term \'handover failure\' has been used to
refer to \'reconfiguration with sync failure\'.

\[TS 38.331, clause 5.3.5.8.3\]

The UE shall:

1\> if T304 of the MCG expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated* if
configured;

2\> release dedicated msgA PUSCH resources provided in
*rach-ConfigDedicated* if configured;

...

2\> else:

3\> revert back to the UE configuration used in the source PCell;

3\> store the handover failure information in *VarRLF-Report* as
described in the subclause 5.3.10.5;

3\> initiate the connection re-establishment procedure as specified in
subclause 5.3.7.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> set the content of the *RRCReconfigurationComplete* message as
follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*; or

...

3\> include *rlf-InfoAvailable in the RRCReconfigurationComplete*
message;

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link failure or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.8.3 Test description {#test-description-69 .H6}

##### 8.1.6.1.3.8.3.1 Pre-test conditions {#pre-test-conditions-70 .H6}

##### System Simulator: {#system-simulator-49 .H6}

\- NR Cell 1 is the Serving cell and NR Cell 2 is the Suitable neighbour
intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR Cells.

##### UE: {#ue-58 .H6}

\- None.

##### Preamble: {#preamble-58 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1 \[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.3.8.3.2 Test procedure sequence {#test-procedure-sequence-70 .H6}

Table 8.1.6.1.3.8.3.2-1 and Table 8.1.6.1.3.8.3.2-2 illustrates the
downlink power levels and other changing parameters to be applied for
the NR cells at various time instants of the test execution. The exact
instants on which these values shall be applied are described in the
texts in this clause. The configuration \"T0\" indicates the initial
conditions. Subsequent configurations marked \"T1\" and \"T2\" are
applied at the points indicated in the Main behaviour description in
Table 8.1.6.1.3.8.3.2-3.

Table 8.1.6.1.3.8.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -88       | -94       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -88       | -75       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 is     |
|    |           |         |           |           | satisfied |
|    |           |         |           |           | for NR    |
|    |           |         |           |           | Cell 2    |
+----+-----------+---------+-----------+-----------+-----------+
| T2 | SS/PBCH   | dBm/SCS | -88       | off       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.6.1.3.8.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -82       | -91       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -91       | -82       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A3 is     |
|    |           |         |           |           | satisfied |
|    |           |         |           |           | for NR    |
|    |           |         |           |           | Cell 2    |
+----+-----------+---------+-----------+-----------+-----------+
| T2 | SS/PBCH   | dBm/SCS | -82       | off       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.6.1.3.8.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                 Message Sequence   TP                                      Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                 U - S              Message                                           
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* and *ConditionalReconfiguration* to set NR Cell 2 as the target candidate cell.   \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message in NR Cell 1.                                                                                    \--\>              *NR RRC: RRCReconfigurationComplete*    \-        \-
  3    SS adjusts the cell-specific reference signal level according to row \"T1\".                                                                              \-                 *-*                                     \-        \-
  \-   EXCEPTION: The steps 4 and 5 below are repeated for the duration of T304.                                                                                 \-                 \-                                      \-        \-
  4    The UE attempts to perform the intra frequency handover using MAC Random Access Preamble on NR Cell 2.                                                    \-                 *-*                                     \-        \-
  5    The SS does not respond.                                                                                                                                  \-                 *-*                                     \-        \-
  6    SS adjusts the cell-specific reference signal level according to row \"T2\" right before T304 expire.                                                     \-                 *-*                                     \-        \-
  7    The UE transmits an *RRCReestablishmentRequest* message in NR Cell 1.                                                                                     \--\>              NR RRC: *RRCReestablishmentRequest*     \-        \-
  8    The SS transmits an *RRCReestablishment* message to resume SRB1 operation and re-activate security in NR Cell 1.                                          \<\--              NR RRC: *RRCReestablishment*            \-        \-
  9    Check: Does the UE transmit an *RRCReestablishmentComplete* message with *rlf-InfoAvailable* in NR Cell 1?                                                \--\>              NR RRC: *RRCReestablishmentComplete*    1         P
  10   The SS transmits an *RRCReconfiguration* message to resume existing radio bearers on NR Cell 1.                                                           \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  11   The UE transmits an *RRCReconfigurationtComplete* message.                                                                                                \--\>              *NR RRC: RRCReconfigurationtComplete*   \-        \-
  12   The SS transmits a *UEInformationRequest* message.                                                                                                        \<\--              *NR RRC: UEInformationRequest*          \-        \-
  13   Check: Does the UE transmit a *UEInformationResponse* message including rlf-Report for conditional handover failure?                                      \--\>              *NR RRC: UEInformationResponse*         2         P

##### 8.1.6.1.3.8.3.3 Specific message contents {#specific-message-contents-71 .H6}

Table 8.1.6.1.3.8.3.3-1: *RRCReconfiguration* (Step 1, Table
8.1.6.1.3.8.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                          
  ------------------------------------------------------------------------------------ ---------------------------- ------------------------- -----------
  Information Element                                                                  Value/remark                 Comment                   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                           
  criticalExtensions CHOICE {                                                                                                                 
  rrcReconfiguration SEQUENCE {                                                                                                               
  measConfig                                                                           MeasConfig                   Table 8.1.6.1.3.8.3.3-2   
  nonCriticalExtension SEQUENCE {                                                                                                             
  nonCriticalExtension SEQUENCE {                                                                                                             
  nonCriticalExtension SEQUENCE {                                                                                                             
  nonCriticalExtension SEQUENCE {                                                                                                             
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.6.1.3.8.3.3-5   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           

Table 8.1.6.1.3.8.3.3-2: *MeasConfig* (Table 8.1.6.1.3.8.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                   
  ------------------------------------------------------------------------------------------ ------------------------------ ------------------------- -----------
  Information Element                                                                        Value/remark                   Comment                   Condition
  MeasConfig ::= SEQUENCE {                                                                                                                           
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                  
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                   
  measObjectId                                                                               1                                                        
  measObject CHOICE {                                                                                                                                 
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.6.1.3.8.3.3-3   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                  
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                   
  reportConfigId                                                                             1                                                        
  reportConfig CHOICE {                                                                                                                               
  reportConfigNR                                                                             *ReportConfigNR-condEventA3*   Table 8.1.6.1.3.8.3.3-4   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                  
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                   
  measId                                                                                     1                                                        
  measObjectId                                                                               1                                                        
  reportConfigId                                                                             1                                                        
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   

Table 8.1.6.1.3.8.3.3-3: *MeasObjectNR* (Table 8.1.6.1.3.8.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-76                                                                                                                                                      
  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------- -----------
  Information Element                                 Value/remark                         Comment                                                                                                       Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                                                                                            
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 1   The SSB of NR Cell 1 and NR Cell 2 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                     Not present                                                                                                                                        
  nrofSS-BlocksToAverage                              Not present                                                                                                                                        
  }                                                                                                                                                                                                      

Table 8.1.6.1.3.8.3.3-4: *ReportConfigNR-condEventA3* (Table
8.1.6.1.3.8.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition CHO AND EVENT\_A3                                    
  ------------------------------------------------------------------------------------- -------------- ----------------- -----------
  Information Element                                                                   Value/remark   Comment           Condition
  ReportConfigNR ::= SEQUENCE {                                                                                          
  reportType CHOICE {                                                                                                    
  condTriggerConfig-r16 SEQUENCE {                                                                                       
  condEventId CHOICE {                                                                                                   
  condEventA3 SEQUENCE {                                                                                                 
  a3-Offset CHOICE {                                                                                                     
  rsrp                                                                                  2              1 dB(2\*0.5 dB)   
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      
  }                                                                                                                      

Table 8.1.6.1.3.8.3.3-5: *ConditionalReconfiguration* (Table
8.1.6.1.3.8.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                            
  ---------------------------------------------------- ------------------------------ ------------------------- -----------
  Information Element                                  Value/remark                   Comment                   Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                                 
  condReconfigToAddModList-r16                         CondReconfigToAddModList-r16   Table 8.1.6.1.3.8.3.3-6   
  }                                                                                                             

Table 8.1.6.1.3.8.3.3-6: *CondReconfigToAddModList-r16* (Table
8.1.6.1.3.8.3.3-5)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                            
  ----------------------------------------------------------------------------------------------------------- ----------------------- ------------------------- -----------
  Information Element                                                                                         Value/remark            Comment                   Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   1 entry                                           
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                            entry 1                   
  condReconfigId-r16                                                                                          1                                                 
  condExecutionCond-r16 SEQUENCE (SIZE (1..2)) OF MeasId {                                                    1 entry                                           
  MeasId\[1\]                                                                                                 1                       entry 1                   
  }                                                                                                                                                             
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO   Table 8.1.6.1.3.8.3.3-7   
  }                                                                                                                                                             
  }                                                                                                                                                             

Table 8.1.6.1.3.8.3.3-7: RRCReconfiguration-HO (Table 8.1.6.1.3.8.3.3-6)

  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                               
  -------------------------------------------------------------------------------------- ----------------- ------------------------- -----------
  Information Element                                                                    Value/remark      Comment                   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                  
  criticalExtensions CHOICE {                                                                                                        
  rrcReconfiguration SEQUENCE {                                                                                                      
  nonCriticalExtension SEQUENCE{                                                                                                     
  masterCellGroup                                                                        CellGroupConfig   Table 8.1.6.1.3.8.3.3-8   
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  

8.1.6.1.3.8.3.3-8: *CellGroupConfig* (Table 8.1.6.1.3.8.3.3-7)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- -----------
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 2             
  }                                                                                                                                          
  t304                                                                                       ms2000                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          

Table 8.1.6.1.3.8.3.3-9: *RRCReestablishment* (step 8, Table
8.1.6.1.3.8.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-10                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  RRCReestablishment ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                   
  rrcReestablishment SEQUENCE {                                                 
  nextHopChainingCount                                 2                        
  }                                                                             
  }                                                                             
  }                                                                             

Table 8.1.6.1.3.8.3.3-10: *RRCReestablishmentComplete* (step 9, Table
8.1.6.1.3.8.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-11                                                               
  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Information Element                                  Value/remark                                      Comment   Condition
  RRCReestablishmentComplete ::= SEQUENCE {                                                                        
  criticalExtensions CHOICE {                                                                                      
  rrcReestablishmentComplete SEQUENCE {                                                                            
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition RLF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                

Table 8.1.6.1.3.8.3.3-11: *RRCReconfiguration* (step 10, Table
8.1.6.1.3.8.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

Table 8.1.6.1.3.8.3.3-12: *UEInformationRequest* (step 12, Table
8.1.6.1.3.8.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

Table 8.1.6.1.3.8.3.3-13: *UEInformationResponse* (step 13, Table
8.1.6.1.3.8.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                        
  -------------------------------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------
  Information Element                                                        Value/remark                                                              Comment                                                               Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                   
  criticalExtensions CHOICE {                                                                                                                                                                                                
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                       
  rlf-Report-r16 CHOICE {                                                                                                                                                                                                    
  nr-RLF-Report-r16 SEQUENCE {                                                                                                                                                                                               
  measResultLastServCell-r16 SEQUENCE {                                                                                                                                                                                      
  measResult-r16 SEQUENCE {                                                                                                                                                                                                  
  cellResults-r16 SEQUENCE {                                                                                                                                                                                                 
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                                                                                                             
  rsrp                                                                       (0..127)                                                                                                                                        
  rsrq                                                                       (0..127)                                                                                                                                        
  sinr                                                                       Not checked                                                                                                                                     
  }                                                                                                                                                                                                                          
  resultsCSI-RS-Cell-r16                                                     Not checked                                                                                                                                     
  }                                                                                                                                                                                                                          
  rsIndexResults-r16 SEQUENCE {                                                                                                                                                                                              
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                                                                                                          
  ssb-Index                                                                  1                                                                                                                                               
  ssb-Results SEQUENCE {                                                                                                                                                                                                     
  rsrp                                                                       (0..127)                                                                                                                                        
  rsrq                                                                       (0..127)                                                                                                                                        
  sinr                                                                       Not checked                                                                                                                                     
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  ssbRLMConfigBitmap-r16                                                     01000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000                                                                         
  resultsCSI-RS-Indexes-r16                                                  Not present                                                                                                                                     
  csi-rsRLMConfigBitmap-r16                                                  Not present                                                                                                                                     
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                                                                        
  measResultListNR-r16 SEQUENCE (SIZE (1..maxFreq)) OF MeasResult2NR-r16 {   1 entry                                                                                                                                         
  MeasResult2NR-r16\[1\] SEQUENCE {                                                                                                                    entry 1                                                               
  ssbFrequency-r16                                                           Not checked                                                                                                                                     
  refFreqCSI-RS-r16                                                          Not checked                                                                                                                                     
  measResultList-r16 SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR {    1 entry                                                                                                                                         
  MeasResultNR\[1\] SEQUENCE {                                                                                                                         entry 1                                                               
  physCellId                                                                 PCI of NR Cell 2                                                                                                                                
  measResult SEQUENCE {                                                                                                                                                                                                      
  cellResults SEQUENCE {                                                                                                                                                                                                     
  resultsSSB-Cell SEQUENCE {                                                                                                                                                                                                 
  rsrp                                                                       (0..127)                                                                                                                                        
  rsrq                                                                       Not present                                                                                                                                     
  sinr                                                                       Not present                                                                                                                                     
  }                                                                                                                                                                                                                          
  resultsCSI-RS-Cell                                                         Not present                                                                                                                                     
  }                                                                                                                                                                                                                          
  rsIndexResults                                                             Not present                                                                                                                                     
  }                                                                                                                                                                                                                          
  cgi-Info                                                                   Not present                                                                                                                                     
  choCandidate-r17                                                           Not present                                                                                                                                     
  choConfig-r17 SEQUENCE (SIZE (1..2)) OF CondTriggerConfig-r16 {            1 entry                                                                                                                                         
  CondTriggerConfig-r16\[1\] SEQUENCE {                                                                                                                entry 1                                                               
  condEventId CHOICE {                                                                                                                                                                                                       
  condEventA3 SEQUENCE {                                                                                                                                                                                                     
  a3-Offset CHOICE {                                                                                                                                                                                                         
  rsrp                                                                       2                                                                         1 dB (2\*0.5 dB)                                                      
  }                                                                                                                                                                                                                          
  hysteresis                                                                 Not checked                                                                                                                                     
  timeToTrigger                                                              Not checked                                                                                                                                     
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  triggeredEvent-r17 SEQUENCE {                                                                                                                                                                                              
  timeBetweenEvents-r17                                                      Not present                                                                                                                                     
  firstTriggeredEvent                                                        condFirstEvent                                                                                                                                  
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  measResultListEUTRA-r16                                                    Not present                                                                                                                                     
  }                                                                                                                                                                                                                          
  c-RNTI-r16                                                                 the old value of the C-RNTI of the UE used in NR Cell 1                                                                                         
  previousPCellId-r16 CHOICE {                                                                                                                                                                                               
  nrPreviousCell-r16 SEQUENCE {                                                                                                                                                                                              
  plmn-Identity-r16                                                          PLMN ID of NR Cell 1                                                                                                                            
  cellIdentity-r16                                                           CGI of NR Cell 1                                                                                                                                
  trackingAreaCode-r16                                                       TAC of NR Cell 1                                                                                                                                
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  failedPCellId-r16 CHOICE {                                                                                                                                                                                                 
  nrFailedPCellId-r16                                                        Any Allowed Value                                                         Either pci-arfcn-r16 or cellGlobalId-r16 corresponding to NR Cell 2   
  }                                                                                                                                                                                                                          
  reconnectCellId-r16                                                        Not present                                                                                                                                     
  timeUntilReconnection-16                                                   Not present                                                                                                                                     
  reestablishmentCellId-r16 **SEQUENCE {**                                                                                                                                                                                   
  **plmn-Identity-r16**                                                      **PLMN ID of NR Cell 1**                                                                                                                        
  **cellIdentity-r16**                                                       **CGI of NR Cell 1**                                                                                                                            
  **trackingAreaCode-r16**                                                   **TAC of NR Cell 1**                                                                                                                            
  **}**                                                                                                                                                                                                                      
  timeConnFailure-r16                                                        Any allowed value                                                                                                                               
  timeSinceFailure-r16                                                       Any allowed value                                                                                                                               
  connectionFailureType-r16                                                  hof                                                                                                                                             
  rlf-Cause-r16                                                              Not checked                                                                                                                                     
  locationInfo-r16                                                           Not checked                                                                                                                                     
  noSuitableCellFound-r16                                                    Not present                                                                                                                                     
  ra-InformationCommon-r16                                                   Not checked                                                                                                                                     
  lastHO-Type-r17                                                            cho                                                                                                                                             
  timeConnSourceDAPS-Failure-r17                                             Not checked                                                                                                                                     
  timeSinceCHO-Reconfig-r17                                                  (0..1023)                                                                 Less than the value of T304                                           
  choCellId-r17                                                              Not checked                                                                                                                                     
  choCandidateCellList-r17                                                   Not checked                                                                                                                                     
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                          

###### 8.1.6.1.3.9 Radio Link Failure / Logging and reporting / Event A5 / CHO

##### 8.1.6.1.3.9.1 Test Purpose (TP) {#test-purpose-tp-72 .H6}

##### (1) {#section-141 .H6}

**with** { UE performed conditional handover to the neighbour cell
triggered in conditional configuration execution A5 and UE detected
handover failure }

**ensure that** {

**when** { UE re-establishes the RRC connection on source cell and
receives RRCReestablishment message }

**then** { UE sends the RRCReestablishmentComplete message with
rlf-InfoAvailable }

}

##### (2) {#section-142 .H6}

**with** { UE performed conditional handover to the neighbour cell
triggered in conditional configuration execution A5 and UE detected
handover failure }

**ensure that** {

**when** { UE receives the UEInformationRequest message containing
rlf-ReportReq }

**then** { UE sends the UEInformationResponse message with rlf-Report
for conditional handover failure }

}

##### 8.1.6.1.3.9.2 Conformance requirements {#conformance-requirements-73 .H6}

##### 8.1.6.1.3.9.2 Conformance requirements {#conformance-requirements-74 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.7.5, 5.3.10.5, 5.3.5.8.3, 5.3.5.3
and 5.7.10.3. Unless otherwise stated these are Rel-17 requirements.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* of TS 36.331 \[10\] and if the UE is
capable of cross-RAT RLF reporting and if the RPLMN is included in
plmn-IdentityList stored in *VarRLF-Report* of TS 36.331 \[10\]:

3\> include *rlf-InfoAvailable* in the *RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

\[TS 38.331, clause 5.3.10.5\]

The UE shall determine the content in the *VarRLF-Report* as follows:

1\> clear the information included in *VarRLF-Report*, if any;

1\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e. includes the RPLMN);

1\> set the *measResultLastServCell* to include the cell level RSRP,
RSRQ and the available SINR, of the source PCell(in case HO failure) or
PCell (in case RLF) based on the available SSB and CSI-RS measurements
collected up to the moment the UE detected failure;

1\> if the SS/PBCH block-based measurement quantities are available:

2\> set the *rsIndexResults* in *measResultLastServCell* to include all
the available measurement quantities of the source PCell (in case HO
failure) or PCell (in case RLF), ordered such that the highest SS/PBCH
block RSRP is listed first if SS/PBCH block RSRP measurement results are
available, otherwise the highest SS/PBCH block RSRQ is listed first if
SS/PBCH block RSRQ measurement results are available, otherwise the
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

1\> for each of the configured *measObjectNR* in which measurements are
available:

...

2\> for each neighbour cell, if any, included in *measResultListNR* in
*measResultNeighCells:*

3\> if the UE supports RLF-Report for conditional handover and if the
neighbour cell is one of the candidate cells for which the
*reconfigurationWithSync* is included in the *masterCellGroup* in the
MCG *VarConditionalReconfig at the moment of the detected failure:*

4\> set *choConfig* in *MeasResult2NR* to the execution condition for
each *measId* within *condTriggerConfig* associated to the neighbour
cell within the MCG *VarConditionalReconfig*;

4\> if the first entry of *choConfig* corresponds to a fulfilled
execution condition at the moment of handover failure, or radio link
failure; or

4\> if the second entry of *choConfig*, if available, corresponds to a
fulfilled execution condition at the moment of handover failure, or
radio link failure:

5\> set *firstTriggeredEvent* to the execution condition
*condFirstEvent* corresponding to the first entry of *choConfig* or to
the execution condition *condSecondEvent* corresponding to the second
entry of *choConfig*, whichever execution condition was fulfilled first
in time;

5\> set *timeBetweenEvents* to the elapsed time between the point in
time of fullfilling the condition in *choConfig* that was fulfilled
first in time, and the point in time of fullfilling the condition in
*choConfig* that was fulfilled second in time, if both the first
execution condition corresponding to the first entry and the second
execution condition corresponding to the second entry in the *choConfig*
were fullfilled;

1\> if the failure is detected due to reconfiguration with sync failure
as described in 5.3.5.8.3, set the fields in *VarRLF-report* as follows:

2\> set the *connectionFailureType* to *hof*;

2\> if the UE supports RLF-Report for DAPS handover and if any DAPS
bearer was configured while T304 was running:

3\> set *lastHO-Type* to *daps*;

3\> if radio link failure was detected in the source PCell, according to
clause 5.3.10.3:

4\> set *timeConnSourceDAPS-Failure* to the time between the initiation
of the DAPS handover execution and the radio link failure detected in
the source PCell while T304 was running;

4\> set the *rlf-Cause* to the trigger for detecting the source radio
link failure in accordance with clause 5.3.10.4;

2\> if the UE supports RLF-Report for conditional handover and if
*configuration of the conditional handover is available in the MCG
VarConditionalReconfig at the moment of the handover failure*:

3\> if the UE executed a conditional handover toward target PCell
according to the *condRRCReconfig* of the target PCell:

4\> set *timeSinceCHO-Reconfig* to the time elapsed between the
execution of the last *RRCReconfiguration* message including
*reconfigurationWithSync* for the target PCell of the failed conditional
handover, and the reception in the source PCell of the last
*conditionalReconfiguration* including the *condRRCReconfig* of the
target PCell of the failed conditional handover;

3\> else:

4\> set *timeSinceCHO-Reconfig* to the time elapsed between the
execution of the last *RRCReconfiguration* message including
*reconfigurationWithSync* for the target PCell of the failed handover,
and the reception in the source PCell of the last
*conditionalReconfiguration* including the *condRRCReconfig*;

3\> set *choCandidateCellList* to include the global cell identity, if
available, and otherwise to the physical cell identity and carrier
frequency of each of the candidate target cells for conditional handover
included in *condRRCReconfig* within *the MCG VarConditionalReconfig* at
the time of the failed handover, excluding the candidate target cells
included in *measResulNeighCells*;

2\> if the UE supports RLF-Report for conditional handover and if the
last executed *RRCReconfiguration* message including
*reconfigurationWithSync* was concerning a conditional handover:

3\> set *lastHO-Type* to *cho*;

2\> set the *nrFailedPCellId* in *failedPCellId* to the global cell
identity and tracking area code, if available, and otherwise to the
physical cell identity and carrier frequency of the target PCell of the
failed handover;

2\> include *nrPreviousCell* in *previousPCellId* and set it to the
global cell identity and tracking area code of the PCell where the last
*RRCReconfiguration* message including *reconfigurationWithSync* was
received;

2\> set the timeConnFailure to the elapsed time since the execution of
the last RRCReconfiguration message including the
reconfigurationWithSync;

...

1\> if available, set the *locationInfo* as in 5.3.3.7.

The UE may discard the radio link failure information or handover
failure information, i.e. release the UE variable *VarRLF-Report*, 48
hours after the radio link failure/handover failure is detected.

NOTE 2: In this clause, the term \'handover failure\' has been used to
refer to \'reconfiguration with sync failure\'.

\[TS 38.331, clause 5.3.5.8.3\]

The UE shall:

1\> if T304 of the MCG expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated* if
configured;

2\> release dedicated msgA PUSCH resources provided in
*rach-ConfigDedicated* if configured;

...

2\> else:

3\> revert back to the UE configuration used in the source PCell;

3\> store the handover failure information in *VarRLF-Report* as
described in the subclause 5.3.10.5;

3\> initiate the connection re-establishment procedure as specified in
subclause 5.3.7.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> set the content of the *RRCReconfigurationComplete* message as
follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*; or

...

3\> include *rlf-InfoAvailable in the RRCReconfigurationComplete*
message;

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link failure or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.9.3 Test description {#test-description-70 .H6}

##### 8.1.6.1.3.9.3.1 Pre-test conditions {#pre-test-conditions-71 .H6}

##### System Simulator: {#system-simulator-50 .H6}

\- NR Cell 1 is the Serving cell and NR Cell 2 is the Suitable neighbour
intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR Cells.

##### UE: {#ue-59 .H6}

\- None.

##### Preamble: {#preamble-59 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.3.9.3.2 Test procedure sequence {#test-procedure-sequence-71 .H6}

Table 8.1.6.1.3.9.3.2-1 and Table 8.1.6.1.3.9.3.2-2 illustrate the
downlink power levels and other changing parameters to be applied for
the NR cells at various time instants of the test execution. The exact
instants on which these values shall be applied are described in the
texts in this clause. The configuration \"T0\" indicates the initial
conditions. Subsequent configurations marked \"T1\" and \"T2\" are
applied at the points indicated in the Main behaviour description in
Table 8.1.6.1.3.9.3.2-3.

Table 8.1.6.1.3.9.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -88       | -94       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -91       | -75       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A5 is     |
|    |           |         |           |           | satisfied |
|    |           |         |           |           | for NR    |
|    |           |         |           |           | Cell 2    |
+----+-----------+---------+-----------+-----------+-----------+
| T2 | SS/PBCH   | dBm/SCS | -88       | off       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.6.1.3.9.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -82       | -91       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -91       | -82       | Power     |
|    |           |         |           |           | levels    |
|    | SSS EPRE  |         |           |           | are such  |
|    |           |         |           |           | that      |
|    |           |         |           |           | entry     |
|    |           |         |           |           | condition |
|    |           |         |           |           | for event |
|    |           |         |           |           | A5 is     |
|    |           |         |           |           | satisfied |
|    |           |         |           |           | for NR    |
|    |           |         |           |           | Cell 2    |
+----+-----------+---------+-----------+-----------+-----------+
| T2 | SS/PBCH   | dBm/SCS | -82       | off       |           |
|    |           |         |           |           |           |
|    | SSS EPRE  |         |           |           |           |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.6.1.3.9.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                 Message Sequence   TP                                      Verdict   
  ---- --------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                 U - S              Message                                           
  1    The SS transmits an *RRCReconfiguration* message *including MeasConfig* and *ConditionalReconfiguration* to set NR Cell 2 as the target candidate cell.   \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  2    The UE transmits an *RRCReconfigurationComplete* message in NR Cell 1.                                                                                    \--\>              *NR RRC: RRCReconfigurationComplete*    \-        \-
  3    SS adjusts the cell-specific reference signal level according to row \"T1\".                                                                              \-                 *-*                                     \-        \-
  \-   EXCEPTION: The steps 4 and 5 below are repeated for the duration of T304.                                                                                 \-                 \-                                      \-        \-
  4    The UE attempts to perform the intra frequency handover using MAC Random Access Preamble on NR Cell 2.                                                    \-                 *-*                                     \-        \-
  5    The SS does not respond.                                                                                                                                  \-                 *-*                                     \-        \-
  6    SS adjusts the cell-specific reference signal level according to row \"T2\" right before T304 expire.                                                     \-                 *-*                                     \-        \-
  7    The UE transmits an *RRCReestablishmentRequest* message in NR Cell 1.                                                                                     \--\>              NR RRC: *RRCReestablishmentRequest*     \-        \-
  8    The SS transmits an *RRCReestablishment* message to resume SRB1 operation and re-activate security in NR Cell 1.                                          \<\--              NR RRC: *RRCReestablishment*            \-        \-
  9    Check: Does the UE transmit an *RRCReestablishmentComplete* message with *rlf-InfoAvailable* in NR Cell 1?                                                \--\>              NR RRC: *RRCReestablishmentComplete*    1         P
  10   The SS transmits an *RRCReconfiguration* message to resume existing radio bearers on NR Cell 1.                                                           \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  11   The UE transmits an *RRCReconfigurationtComplete* message.                                                                                                \--\>              *NR RRC: RRCReconfigurationtComplete*   \-        \-
  12   The SS transmits a *UEInformationRequest* message.                                                                                                        \<\--              *NR RRC: UEInformationRequest*          \-        \-
  13   Check: Does the UE transmit a *UEInformationResponse* message including rlf-Report for conditional handover failure?                                      \--\>              *NR RRC: UEInformationResponse*         2         P

##### 8.1.6.1.3.9.3.3 Specific message contents {#specific-message-contents-72 .H6}

Table 8.1.6.1.3.9.3.3-1: *RRCReconfiguration* (Step 1, Table
8.1.6.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition NR\_MEAS and CHO                                                          
  ------------------------------------------------------------------------------------ ---------------------------- ------------------------- -----------
  Information Element                                                                  Value/remark                 Comment                   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                           
  criticalExtensions CHOICE {                                                                                                                 
  rrcReconfiguration SEQUENCE {                                                                                                               
  measConfig                                                                           MeasConfig                   Table 8.1.6.1.3.9.3.3-2   
  nonCriticalExtension SEQUENCE {                                                                                                             
  nonCriticalExtension SEQUENCE {                                                                                                             
  nonCriticalExtension SEQUENCE {                                                                                                             
  nonCriticalExtension SEQUENCE {                                                                                                             
  conditionalReconfiguration-r16                                                       ConditionalReconfiguration   Table 8.1.6.1.3.9.3.3-5   
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           
  }                                                                                                                                           

Table 8.1.6.1.3.9.3.3-2: *MeasConfig* (Table 8.1.6.1.3.9.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-69                                                                                                   
  ------------------------------------------------------------------------------------------ ------------------------------ ------------------------- -----------
  Information Element                                                                        Value/remark                   Comment                   Condition
  MeasConfig ::= SEQUENCE {                                                                                                                           
  measObjectToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasObjectToAddMod {          1 entry                                                  
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                        entry 1                   
  measObjectId                                                                               1                                                        
  measObject CHOICE {                                                                                                                                 
  measObjectNR                                                                               MeasObjectNR                   Table 8.1.6.1.3.9.3.3-3   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  reportConfigToAddModList SEQUENCE(SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                  
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                      entry 1                   
  reportConfigId                                                                             1                                                        
  reportConfig CHOICE {                                                                                                                               
  reportConfigNR                                                                             *ReportConfigNR-condEventA5*   Table 8.1.6.1.3.9.3.3-4   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  measIdToAddModList SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                  1 entry                                                  
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                            entry 1                   
  measId                                                                                     1                                                        
  measObjectId                                                                               1                                                        
  reportConfigId                                                                             1                                                        
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   

Table 8.1.6.1.3.9.3.3-3: *MeasObjectNR* (Table 8.1.6.1.3.9.3.3-2)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-76                                                                                                                                                      
  --------------------------------------------------- ------------------------------------ ------------------------------------------------------------------------------------------------------------- -----------
  Information Element                                 Value/remark                         Comment                                                                                                       Condition
  MeasObjectNR ::= SEQUENCE {                                                                                                                                                                            
  ssbFrequency                                        ARFCN-ValueNR for SSB of NR Cell 1   The SSB of NR Cell 1 and NR Cell 2 have the same ARFCN value as specified in TS 38.508-1 \[4\] clause 6.2.3   
  absThreshSS-BlocksConsolidation                     Not present                                                                                                                                        
  nrofSS-BlocksToAverage                              Not present                                                                                                                                        
  }                                                                                                                                                                                                      

Table 8.1.6.1.3.9.3.3-4: *ReportConfigNR-condEventA5* (Table
8.1.6.1.3.9.3.3-2)

  -------------------------------------------------------------------------------------- ------------------ ------------------------- -----------
  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-142 with condition CHO AND EVENT\_ A5                                                
  Information Element                                                                    Value/remark       Comment                   Condition
  ReportConfigNR ::= SEQUENCE {                                                                                                       
  reportType CHOICE {                                                                                                                 
  condTriggerConfig-r16 SEQUENCE {                                                                                                    
  condEventId CHOICE {                                                                                                                
  condEventA5 SEQUENCE {                                                                                                              
  a5-Threshold1 CHOICE {                                                                                                              
  rsrp                                                                                   76                 -80dBm                    FR1
                                                                                         66 + Delta(NRfs)   Threshold set to -91dBm   FR2
  }                                                                                                                                   
  a5-Threshold2 CHOICE {                                                                                                              
  rsrp                                                                                   70                 -86dBm                    FR1
                                                                                         66 + Delta(NRfs)   Threshold set to -91dBm   FR2
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  -------------------------------------------------------------------------------------- ------------------ ------------------------- -----------

Table 8.1.6.1.3.9.3.3-5: *ConditionalReconfiguration* (Table
8.1.6.1.3.9.3.3-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25D                                                            
  ---------------------------------------------------- ------------------------------ ------------------------- -----------
  Information Element                                  Value/remark                   Comment                   Condition
  ConditionalReconfiguration-r16 ::= SEQUENCE {                                                                 
  condReconfigToAddModList-r16                         CondReconfigToAddModList-r16   Table 8.1.6.1.3.9.3.3-6   
  }                                                                                                             

Table 8.1.6.1.3.9.3.3-6: *CondReconfigToAddModList-r16* (Table
8.1.6.1.3.9.3.3-5)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.3-25C                                                                                                            
  ----------------------------------------------------------------------------------------------------------- ----------------------- ------------------------- -----------
  Information Element                                                                                         Value/remark            Comment                   Condition
  CondReconfigToAddModList-r16 ::= SEQUENCE (SIZE (1.. maxNrofCondCells-r16)) OF CondReconfigToAddMod-r16 {   1 entry                                           
  CondReconfigToAddMod-r16\[1\] SEQUENCE {                                                                                            entry 1                   
  condReconfigId-r16                                                                                          1                                                 
  condExecutionCond-r16 SEQUENCE (SIZE (1..2)) OF MeasId {                                                    1 entry                                           
  MeasId\[1\]                                                                                                 1                       entry 1                   
  }                                                                                                                                                             
  condRRCReconfig-r16                                                                                         RRCReconfiguration-HO   Table 8.1.6.1.3.9.3.3-7   
  }                                                                                                                                                             
  }                                                                                                                                                             

Table 8.1.6.1.3.9.3.3-7: RRCReconfiguration-HO (Table 8.1.6.1.3.9.3.3-6)

  Derivation Path: TS 38.508-1 \[4\] Table 4.8.1-1A with condition RBConfig\_KeyChange                                               
  -------------------------------------------------------------------------------------- ----------------- ------------------------- -----------
  Information Element                                                                    Value/remark      Comment                   Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                  
  criticalExtensions CHOICE {                                                                                                        
  rrcReconfiguration SEQUENCE {                                                                                                      
  nonCriticalExtension SEQUENCE{                                                                                                     
  masterCellGroup                                                                        CellGroupConfig   Table 8.1.6.1.3.9.3.3-8   
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  

8.1.6.1.3.9.3.3-8: *CellGroupConfig* (Table 8.1.6.1.3.9.3.3-7)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with Condition PCell\_change and CFRA                                                   
  ------------------------------------------------------------------------------------------ ------------------------------------- --------- -----------
  Information Element                                                                        Value/remark                          Comment   Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                             
  spCellConfig SEQUENCE {                                                                                                                    
  reconfigurationWithSync SEQUENCE {                                                                                                         
  spCellConfigCommon SEQUENCE {                                                                                                              
  physCellId                                                                                 Physical Cell Identity of NR Cell 2             
  }                                                                                                                                          
  t304                                                                                       ms2000                                          
  }                                                                                                                                          
  }                                                                                                                                          
  }                                                                                                                                          

Table 8.1.6.1.3.9.3.3-9: *RRCReestablishment* (step 8, Table
8.1.6.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-10                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  RRCReestablishment ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                   
  rrcReestablishment SEQUENCE {                                                 
  nextHopChainingCount                                 2                        
  }                                                                             
  }                                                                             
  }                                                                             

Table 8.1.6.1.3.9.3.3-10: *RRCReestablishmentComplete* (step 9, Table
8.1.6.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-11                                                               
  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Information Element                                  Value/remark                                      Comment   Condition
  RRCReestablishmentComplete ::= SEQUENCE {                                                                        
  criticalExtensions CHOICE {                                                                                      
  rrcReestablishmentComplete SEQUENCE {                                                                            
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition RLF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                

Table 8.1.6.1.3.9.3.3-11: *RRCReconfiguration* (step 10, Table
8.1.6.1.3.9.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

Table 8.1.6.1.3.9.3.3-12: *UEInformationRequest* (step 12, Table
8.1.6.1.3.9.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

Table 8.1.6.1.3.9.3.3-13: *UEInformationResponse* (step 13, Table
8.1.6.1.3.9.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                       
  ------------------------------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------
  Information Element                                                       Value/remark                                                              Comment                                                               Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                  
  criticalExtensions CHOICE {                                                                                                                                                                                               
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                      
  rlf-Report-r16 CHOICE {                                                                                                                                                                                                   
  nr-RLF-Report-r16 SEQUENCE {                                                                                                                                                                                              
  measResultLastServCell-r16 SEQUENCE {                                                                                                                                                                                     
  measResult-r16 SEQUENCE {                                                                                                                                                                                                 
  cellResults-r16 SEQUENCE {                                                                                                                                                                                                
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                                                                                                            
  rsrp                                                                      (0..127)                                                                                                                                        
  rsrq                                                                      (0..127)                                                                                                                                        
  sinr                                                                      Not checked                                                                                                                                     
  }                                                                                                                                                                                                                         
  resultsCSI-RS-Cell-r16                                                    Not checked                                                                                                                                     
  }                                                                                                                                                                                                                         
  rsIndexResults-r16 SEQUENCE {                                                                                                                                                                                             
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                                                                                                         
  ssb-Index                                                                 1                                                                                                                                               
  ssb-Results SEQUENCE {                                                                                                                                                                                                    
  rsrp                                                                      (0..127)                                                                                                                                        
  rsrq                                                                      (0..127)                                                                                                                                        
  sinr                                                                      Not checked                                                                                                                                     
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  ssbRLMConfigBitmap-r16                                                    01000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000                                                                         
  resultsCSI-RS-Indexes-r16                                                 Not present                                                                                                                                     
  csi-rsRLMConfigBitmap-r16                                                 Not present                                                                                                                                     
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                                                                       
  measResultListNR-r16 SEQUENCE SIZE (1..maxFreq)) OF MeasResult2NR-r16 {   1 entry                                                                                                                                         
  MeasResult2NR-r16\[1\] SEQUENCE {                                                                                                                   entry 1                                                               
  ssbFrequency-r16                                                          Not checked                                                                                                                                     
  refFreqCSI-RS-r16                                                         Not checked                                                                                                                                     
  measResultList-r16 SEQUENCE SIZE (1..maxCellReport)) OF MeasResultNR {    1 entry                                                                                                                                         
  MeasResultNR\[1\] SEQUENCE {                                                                                                                        entry 1                                                               
  physCellId                                                                PCI of NR Cell 2                                                                                                                                
  measResult SEQUENCE {                                                                                                                                                                                                     
  cellResults SEQUENCE {                                                                                                                                                                                                    
  resultsSSB-Cell SEQUENCE {                                                                                                                                                                                                
  rsrp                                                                      (0..127)                                                                                                                                        
  rsrq                                                                      Not present                                                                                                                                     
  sinr                                                                      Not present                                                                                                                                     
  }                                                                                                                                                                                                                         
  resultsCSI-RS-Cell                                                        Not present                                                                                                                                     
  }                                                                                                                                                                                                                         
  rsIndexResults                                                            Not present                                                                                                                                     
  }                                                                                                                                                                                                                         
  cgi-Info                                                                  Not present                                                                                                                                     
  choCandidate-r17                                                          Not present                                                                                                                                     
  choConfig-r17 SEQUENCE (SIZE (1..2)) OF CondTriggerConfig-r16 {           1 entry                                                                                                                                         
  CondTriggerConfig-r16\[1\] SEQUENCE {                                                                                                               entry 1                                                               
  condEventId CHOICE {                                                                                                                                                                                                      
  condEventA5 SEQUENCE {                                                                                                                                                                                                    
  a5-Threshold1 CHOICE {                                                                                                                                                                                                    
  rsrp                                                                      76                                                                        -80dBm                                                                FR1
                                                                            66 + Delta(NRfs)                                                          Threshold set to -91dBm                                               FR2
  }                                                                                                                                                                                                                         
  a5-Threshold2 CHOICE {                                                                                                                                                                                                    
  rsrp                                                                      70                                                                        -86dBm                                                                FR1
                                                                            66 + Delta(NRfs)                                                          Threshold set to -91dBm                                               FR2
  }                                                                                                                                                                                                                         
  hysteresis                                                                Not checked                                                                                                                                     
  timeToTrigger                                                             Not checked                                                                                                                                     
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  triggeredEvent-r17 SEQUENCE {                                                                                                                                                                                             
  timeBetweenEvents-r17                                                     Not present                                                                                                                                     
  firstTriggeredEvent                                                       condFirstEvent                                                                                                                                  
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  measResultListEUTRA-r16                                                   Not present                                                                                                                                     
  }                                                                                                                                                                                                                         
  c-RNTI-r16                                                                the old value of the C-RNTI of the UE used in NR Cell 1                                                                                         
  previousPCellId-r16 CHOICE {                                                                                                                                                                                              
  nrPreviousCell-r16 SEQUENCE {                                                                                                                                                                                             
  plmn-Identity-r16                                                         PLMN ID of NR Cell 1                                                                                                                            
  cellIdentity-r16                                                          CGI of NR Cell 1                                                                                                                                
  trackingAreaCode-r16                                                      TAC of NR Cell 1                                                                                                                                
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  failedPCellId-r16 CHOICE {                                                                                                                                                                                                
  nrFailedPCellId-r16                                                       Any Allowed Value                                                         Either pci-arfcn-r16 or cellGlobalId-r16 corresponding to NR Cell 2   
  }                                                                                                                                                                                                                         
  reconnectCellId-r16                                                       Not present                                                                                                                                     
  timeUntilReconnection-16                                                  Not present                                                                                                                                     
  reestablishmentCellId-r16 **SEQUENCE {**                                                                                                                                                                                  
  **plmn-Identity-r16**                                                     **PLMN ID of NR Cell 1**                                                                                                                        
  **cellIdentity-r16**                                                      **CGI of NR Cell 1**                                                                                                                            
  **trackingAreaCode-r16**                                                  **TAC of NR Cell 1**                                                                                                                            
  **}**                                                                                                                                                                                                                     
  timeConnFailure-r16                                                       Any allowed value                                                                                                                               
  timeSinceFailure-r16                                                      Any allowed value                                                                                                                               
  connectionFailureType-r16                                                 hof                                                                                                                                             
  rlf-Cause-r16                                                             Not checked                                                                                                                                     
  locationInfo-r16                                                          Not checked                                                                                                                                     
  noSuitableCellFound-r16                                                   Not present                                                                                                                                     
  ra-InformationCommon-r16                                                  Not checked                                                                                                                                     
  lastHO-Type-r17                                                           cho                                                                                                                                             
  timeConnSourceDAPS-Failure-r17                                            Not checked                                                                                                                                     
  timeSinceCHO-Reconfig-r17                                                 (0..1023)                                                                 Less than the value of T304                                           
  choCellId-r17                                                             Not checked                                                                                                                                     
  choCandidateCellList-r17                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                         

###### 8.1.6.1.3.10 Radio Link Failure / Logging and reporting / DAPS HO

##### 8.1.6.1.3.10.1 Test Purpose (TP) {#test-purpose-tp-73 .H6}

##### (1) {#section-143 .H6}

**with** { UE having detected DAPS handover failure and radio link
failure in source PCell while T304 was running }

**ensure that** {

**when** { UE receives RRCReestablishment message }

**then** { UE sends the RRCReestablishmentComplete message with
rlf-InfoAvailable }

}

##### (2) {#section-144 .H6}

**with** { UE having detected DAPS handover failure and radio link
failure in source PCell while T304 was running }

**ensure that** {

**when** { UE receives the UEInformationRequest message containing
rlf-ReportReq }

**then** { UE sends the UEInformationResponse message with rlf-Report
for DAPS handover failure }

}

##### 8.1.6.1.3.10.2 Conformance requirements {#conformance-requirements-75 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.7.5, 5.3.10.3, 5.3.10.5, 5.3.5.8.3,
5.3.5.3 and 5.7.10.3. Unless otherwise stated these are Rel-17
requirements.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* of TS 36.331 \[10\] and if the UE is
capable of cross-RAT RLF reporting and if the RPLMN is included in
plmn-IdentityList stored in *VarRLF-Report* of TS 36.331 \[10\]:

3\> include *rlf-InfoAvailable* in the *RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

1\> if any DAPS bearer is configured and T304 is running:

2\> upon T310 expiry in source SpCell; or

2\> upon random access problem indication from source MCG MAC; or

2\> upon indication from source MCG RLC that the maximum number of
retransmissions has been reached; or

2\> upon consistent uplink LBT failure indication from source MCG MAC:

3\> consider radio link failure to be detected for the source MCG i.e.
source RLF;

3\> suspend the transmission and reception of all DRBs and multicast
MRBs in the source MCG;

3\> reset MAC for the source MCG;

3\> release the source connection.

\[TS 38.331, clause 5.3.10.5\]

The UE shall determine the content in the *VarRLF-Report* as follows:

1\> clear the information included in *VarRLF-Report*, if any;

1\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e. includes the RPLMN);

1\> set the *measResultLastServCell* to include the cell level RSRP,
RSRQ and the available SINR, of the source PCell(in case HO failure) or
PCell (in case RLF) based on the available SSB and CSI-RS measurements
collected up to the moment the UE detected failure;

1\> if the SS/PBCH block-based measurement quantities are available:

2\> set the *rsIndexResults* in *measResultLastServCell* to include all
the available measurement quantities of the source PCell (in case HO
failure) or PCell (in case RLF), ordered such that the highest SS/PBCH
block RSRP is listed first if SS/PBCH block RSRP measurement results are
available, otherwise the highest SS/PBCH block RSRQ is listed first if
SS/PBCH block RSRQ measurement results are available, otherwise the
highest SS/PBCH block SINR is listed first, based on the available
SS/PBCH block based measurements collected up to the moment the UE
detected failure;

...

1\> if the failure is detected due to reconfiguration with sync failure
as described in 5.3.5.8.3, set the fields in *VarRLF-report* as follows:

2\> set the *connectionFailureType* to *hof*;

2\> if any DAPS bearer was configured while T304 was running:

3\> set *lastHO-Type* to *daps*;

3\> if radio link failure was detected in the source PCell, according to
clause 5.3.10.3:

4\> set timeConnSourceDAPS-Failure to the time between the initiation of
the DAPS handover execution and the radio link failure detected in the
source PCell while T304 was running;

4\> set the rlf-Cause to the trigger for detecting the source radio link
failure in accordance with clause 5.3.10.4;

2\> set the *nrFailedPCellId* in *failedPCellId* to the global cell
identity and tracking area code, if available, and otherwise to the
physical cell identity and carrier frequency of the target PCell of the
failed handover;

2\> include *nrPreviousCell* in *previousPCellId* and set it to the
global cell identity and tracking area code of the PCell where the last
*RRCReconfiguration* message including *reconfigurationWithSync* was
received;

2\> set the *timeConnFailure* to the elapsed time since reception of the
last *RRCReconfiguration* message including the
*reconfigurationWithSync*;

...

1\> if available, set the *locationInfo* as in 5.3.3.7.

The UE may discard the radio link failure information or handover
failure information, i.e. release the UE variable *VarRLF-Report*, 48
hours after the radio link failure/handover failure is detected.

NOTE 2: In this clause, the term \'handover failure\' has been used to
refer to \'reconfiguration with sync failure\'.

\[TS 38.331, clause 5.3.5.8.3\]

The UE shall:

1\> if T304 of the MCG expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated* if
configured;

2\> release dedicated msgA PUSCH resources provided in
*rach-ConfigDedicated* if configured;

...

2\> else:

3\> revert back to the UE configuration used in the source PCell;

3\> store the handover failure information in *VarRLF-Report* as
described in the subclause 5.3.10.5;

3\> initiate the connection re-establishment procedure as specified in
subclause 5.3.7.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> set the content of the *RRCReconfigurationComplete* message as
follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*; or

...

3\> include *rlf-InfoAvailable in the RRCReconfigurationComplete*
message;

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *rlf-ReportReq* is set to *true*:

2\> if the UE has radio link failure information or handover failure
information available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*:

3\> set *timeSinceFailure* in *VarRLF-Report* to the time that elapsed
since the last radio link failure or handover failure in NR;

3\> set the *rlf-Report* in the *UEInformationResponse* message to the
value of *rlf-Report* in *VarRLF-Report*;

3\> discard the *rlf-Report* from *VarRLF-Report* upon successful
delivery of the *UEInformationResponse* message confirmed by lower
layers;

...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.3.10.3 Test description {#test-description-71 .H6}

##### 8.1.6.1.3.10.3.1 Pre-test conditions {#pre-test-conditions-72 .H6}

##### System Simulator: {#system-simulator-51 .H6}

\- NR Cell 1 is the Serving cell and NR Cell 2 is the Suitable neighbour
intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR Cells.

##### UE: {#ue-60 .H6}

\- None.

##### Preamble: {#preamble-60 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.3.10.3.2 Test procedure sequence {#test-procedure-sequence-72 .H6}

Table 8.1.6.1.3.10.3.2-1 and Table 8.1.6.1.3.10.3.2-2 illustrates the
downlink power levels and other changing parameters to be applied for
the NR cells at various time instants of the test execution. The exact
instants on which these values shall be applied are described in the
texts in this clause. The configuration \"T0\" indicates the initial
conditions. Subsequent configurations marked \"T1\", \"T2\" are applied
at the points indicated in the Main behaviour description in Table
8.1.6.1.3.10.3.2-3.

Table 8.1.6.1.3.10.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T0 | SS/PBCH   | dBm/SCS | -88       | -94       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T1 | SS/PBCH   | dBm/SCS | off       | off       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -88       | off       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.6.1.3.10.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T0 | SS/PBCH   | dBm/SCS | -82       | -91       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T1 | SS/PBCH   | dBm/SCS | off       | off       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -82       | off       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.6.1.3.10.3.2-3: Main behaviour

  St   Procedure                                                                                                                                                                                                Message Sequence   TP                                      Verdict   
  ---- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------------- --------- ----
                                                                                                                                                                                                                U - S              Message                                           
  1    The SS transmits an *RRCReconfiguration* message containing *reconfigurationWithSync* to order UE to perform DAPS handover to NR Cell 2. DRB\#n of the first PDU session is configured as DAPS bearer.   \<\--              NR RRC: *RRCReconfiguration*            \-        \-
  \-   EXCEPTION: In parallel with step 2, parallel behaviour defined in table 8.1.6.1.3.10.3.2-4 is executed repeatedly.                                                                                       \-                 \-                                      \-        \-
  2    The SS changes the power level setting according to the row \"T1\".                                                                                                                                      \-                 \-                                      \-        \-
  3    Waiting for T304 expiring.                                                                                                                                                                               \-                 \-                                      \-        \-
  4    The SS changes the power level setting according to the row \"T2\".                                                                                                                                      \-                 \-                                      \-        \-
  5    The UE transmits an *RRCReestablishmentRequest* message in NR Cell 1.                                                                                                                                    \--\>              NR RRC: *RRCReestablishmentRequest*     \-        \-
  6    The SS transmits an *RRCReestablishment* message to resume SRB1 operation and re-activate security in NR Cell 1.                                                                                         \<\--              NR RRC: *RRCReestablishment*            \-        \-
  7    Check: Does the UE transmit an *RRCReestablishmentComplete* message with *rlf-InfoAvailable* in NR Cell 1?                                                                                               \--\>              NR RRC: *RRCReestablishmentComplete*    1         P
  8    The SS transmits an *RRCReconfiguration* message to resume existing radio bearers on NR Cell 1.                                                                                                          \<\--              *NR RRC: RRCReconfiguration*            \-        \-
  9    The UE transmits an *RRCReconfigurationtComplete* message.                                                                                                                                               \--\>              *NR RRC: RRCReconfigurationtComplete*   \-        \-
  10   The SS transmits a *UEInformationRequest* message.                                                                                                                                                       \<\--              *NR RRC: UEInformationRequest*          \-        \-
  11   Check: Does the UE transmit a *UEInformationResponse* message including lastHO-Type-r17 set to daps and timeConnSourceDAPS-Failure-r17 in NR Cell 1?                                                     \--\>              *NR RRC: UEInformationResponse*         2         P

Table 8.1.6.1.3.10.3.2-4: Parallel behaviour

  St   Procedure                                 Message Sequence   TP                 Verdict   
  ---- ----------------------------------------- ------------------ ------------------ --------- ----
                                                 U - S              Message                      
  1    The UE transmits preamble to NR Cell 2.   -\>                (PRACH Preamble)   \-        \-
  2    The SS does not respond.                  \-                 \-                 \-        \-

##### 8.1.6.1.3.10.3.3 Specific message contents {#specific-message-contents-73 .H6}

Table 8.1.6.1.3.10.3.3-1: *SIB1* for NR Cell 1 (all steps)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/Remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                          
  ue-TimersAndConstants SEQUENCE {                                             
  t310                                                ms0            0 ms      
  }                                                                            
  }                                                                            

Table 8.1.6.1.3.10.3.3-2: *RRCReconfiguration* (step 1, Table
8.1.6.1.3.10.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with Condition RBConfig\_KeyChange                                                                                                                                                     
  --------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ------------------------------------------------------------------- -----------
  Information Element                                                                     Value/remark                                                                  Comment                                                             Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                                                                                                         
  criticalExtensions CHOICE {                                                                                                                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                                                                                                                             
  radioBearerConfig                                                                       RadioBearerConfig with conditions (SRB\_NR\_PDCP) and (DRBn AND DAPS\_PDCP)                                                                       
  nonCriticalExtension SEQUENCE{                                                                                                                                                                                                            
  masterCellGroup                                                                         CellGroupConfig                                                               OCTET STRING (CONTAINING CellGroupConfig)Table 8.1.6.1.3.10.3.3-3   
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         

Table 8.1.6.1.3.10.3.3-3: *CellGroupConfig* (Table 8.1.6.1.3.10.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change and CFRA                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------------- -------------------------- -----------
  Information Element                                                                        Value/remark                                Comment                    Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                                    
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLCH)) OF RLC-BearerConfig {                    3 entries                                                              
  RLC-BearerConfig\[1\]                                                                      RLC-BearerConfig with conditions SRB1       entry 1                    
  RLC-BearerConfig\[2\]                                                                      RLC-BearerConfig with conditions SRB2       entry 2                    
  RLC-BearerConfig\[3\]                                                                      RLC-BearerConfig with conditions AM, DRBn   entry 3                    
  }                                                                                                                                                                 
  spCellConfig SEQUENCE {                                                                                                                                           
  reconfigurationWithSync SEQUENCE {                                                                                                                                
  spCellConfigCommon SEQUENCE {                                                                                                                                     
  physCellId                                                                                 Physical Cell Identity of NR Cell 2                                    
  uplinkConfigCommon SEQUENCE {                                                                                                                                     
  initialUplinkBWP SEQUENCE {                                                                                                                                       
  rach-ConfigCommon CHOICE {                                                                                                                                        
  setup SEQUENCE {                                                                                                                                                  
  rach-ConfigGeneric                                                                         RACH-ConfigGeneric                          Table 8.1.6.1.3.10.3.3-4   
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 

Table 8.1.6.1.3.10.3.3-4: *RACH-ConfigGeneric* (Table
8.1.6.1.3.10.3.3-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-130                            
  ----------------------------------------------------- -------------- --------- -----------
  Information Element                                   Value/remark   Comment   Condition
  RACH-ConfigGeneric ::= SEQUENCE {                                              
  preambleTransMax                                      n200                     
  }                                                                              

Table 8.1.6.1.3.10.3.3-5: *RRCReestablishment* (step 6, Table
8.1.6.1.3.10.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-10                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  RRCReestablishment ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                   
  rrcReestablishment SEQUENCE {                                                 
  nextHopChainingCount                                 2                        
  }                                                                             
  }                                                                             
  }                                                                             

Table 8.1.6.1.3.10.3.3-6: *RRCReestablishmentComplete* (step 7, Table
8.1.6.1.3.10.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-11                                                           
  ---------------------------------------------------- --------------------------------------------- --------- -----------
  Information Element                                  Value/remark                                  Comment   Condition
  RRCReestablishmentComplete ::= SEQUENCE {                                                                    
  criticalExtensions CHOICE {                                                                                  
  rrcReestablishmentComplete SEQUENCE {                                                                        
  nonCriticalExtension SEQUENCE {                                                                              
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable with condition RLF             
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            

Table 8.1.6.1.3.10.3.3-7: *RRCReconfiguration* (step 8, Table
8.1.6.1.3.10.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

Table 8.1.6.1.3.10.3.3-8: *UEInformationRequest* (step 10, Table
8.1.6.1.3.10.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

Table 8.1.6.1.3.10.3.3-9: *UEInformationResponse* (step 11, Table
8.1.6.1.3.10.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                   
  ----------------------------------------------------- ------------------------------------------------------------------------- --------------------------------------------------------------------- -----------
  Information Element                                   Value/remark                                                              Comment                                                               Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                                                           
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                  
  rlf-Report-r16 CHOICE {                                                                                                                                                                               
  nr-RLF-Report-r16 SEQUENCE {                                                                                                                                                                          
  measResultLastServCell-r16 SEQUENCE {                                                                                                                                                                 
  measResult-r16 SEQUENCE {                                                                                                                                                                             
  cellResults-r16 SEQUENCE {                                                                                                                                                                            
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                                                                                        
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  (0..127)                                                                                                                                        
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  resultsCSI-RS-Cell-r16                                Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  rsIndexResults-r16 SEQUENCE {                                                                                                                                                                         
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                                                                                                     
  ssb-Index                                             1                                                                                                                                               
  ssb-Results SEQUENCE {                                                                                                                                                                                
  rsrp                                                  (0..127)                                                                                                                                        
  rsrq                                                  (0..127)                                                                                                                                        
  sinr                                                  Not checked                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  ssbRLMConfigBitmap-r16                                01000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000                                                                         
  resultsCSI-RS-Indexes-r16                             Not present                                                                                                                                     
  csi-rsRLMConfigBitmap-r16                             Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  measResultNeighCells-r16                              Not present                                                                                                                                     
  c-RNTI-r16                                            the old value of the C-RNTI of the UE used in NR Cell 1                                                                                         
  previousPCellId-r16 CHOICE {                                                                                                                                                                          
  nrPreviousCell-r16 SEQUENCE {                                                                                                                                                                         
  plmn-Identity-r16                                     PLMN ID of NR Cell 1                                                                                                                            
  cellIdentity-r16                                      CGI of NR Cell 1                                                                                                                                
  trackingAreaCode-r16                                  TAC of NR Cell 1                                                                                                                                
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  failedPCellId-r16 CHOICE {                                                                                                                                                                            
  nrFailedPCellId-r16                                   Any Allowed Value                                                         Either pci-arfcn-r16 or cellGlobalId-r16 corresponding to NR Cell 2   
  }                                                                                                                                                                                                     
  reconnectCellId-r16                                   Not present                                                                                                                                     
  timeUntilReconnection-16                              Not present                                                                                                                                     
  reestablishmentCellId-r16 SEQUENCE {                                                                                                                                                                  
  plmn-Identity-r16                                     PLMN ID of NR Cell 1                                                                                                                            
  cellIdentity-r16                                      CGI of NR Cell 1                                                                                                                                
  trackingAreaCode-r16                                  TAC of NR Cell 1                                                                                                                                
  }                                                                                                                                                                                                     
  timeConnFailure-r16                                   Any allowed value                                                                                                                               
  timeSinceFailure-r16                                  Any allowed value                                                                                                                               
  connectionFailureType-r16                             hof                                                                                                                                             
  rlf-Cause-r16                                         Any allowed value                                                                                                                               
  locationInfo-r16                                      Not checked                                                                                                                                     
  noSuitableCellFound-r16                               Not present                                                                                                                                     
  ra-InformationCommon-r16                              Not checked                                                                                                                                     
  lastHO-Type-r17                                       daps                                                                                                                                            
  timeConnSourceDAPS-Failure-r17                        (0..1023)                                                                                                                                       
  timeSinceCHO-Reconfig-r17                             Not present                                                                                                                                     
  choCellId-r17                                         Not present                                                                                                                                     
  choCandidateCellList-r17                              Not present                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     
  }                                                                                                                                                                                                     

###### 8.1.6.1.3.11 Radio Link Failure / Logging and reporting / Successful Handovers Reports

##### 8.1.6.1.3.11.1 Test Purpose (TP)  {#test-purpose-tp-74 .H6}

##### (1) {#section-145 .H6}

**with** { UE having received RRC reconfiguration message and
*sourceDAPS-FailureReporting* is included in the *successHO-Config with
value 'true',* and having detected radio link failure in source PCell
during the DAPS handover while T304 was running }

**ensure that** {

**when** { UE receives RRCReestablishment message }

**then** { UE sends the RRCReestablishmentComplete message with
*successHO-InfoAvailable* }

}

##### (2) {#section-146 .H6}

**with** { UE having received RRC reconfiguration meesage and
sourceDAPS-FailureReporting is included in the successHO-Config with
value 'true', and having detected radio link failure in source PCell
during the DAPS handover while T304 was running }

**ensure that** {

**when** { UE receives the UEInformationRequest message containing
successHO-ReportReq }

**then** { UE sends the UEInformationResponse message with
successHO-Report }

}

##### 8.1.6.1.3.11.2 Conformance requirements {#conformance-requirements-76 .H6}

References: The conformance requirements covered in the present TC are
specified in: TS 38.331, clauses 5.3.7.5, 5.3.10.3, 5.3.5.8.3, 5.3.5.3,
5.7.10.3, and 5.7.10.6. Unless otherwise stated these are Rel-17
requirements.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

...

2\> if the UE has successful handover information available in
*VarSuccessHO-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarSuccessHO-Report:*

3\> include *successHO-InfoAvailable in the RRCReestablishmentComplete*
message;

1\> submit the *RRCReestablishmentComplete* message to lower layers for
transmission;

\[TS 38.331, clause 5.3.10.3\]

The UE shall:

1\> if any DAPS bearer is configured and T304 is running:

2\> upon T310 expiry in source SpCell; or

2\> upon random access problem indication from source MCG MAC; or

2\> upon indication from source MCG RLC that the maximum number of
retransmissions has been reached; or

2\> upon consistent uplink LBT failure indication from source MCG MAC:

3\> consider radio link failure to be detected for the source MCG i.e.
source RLF;

3\> suspend the transmission and reception of all DRBs and multicast
MRBs in the source MCG;

3\> reset MAC for the source MCG;

3\> release the source connection.

\[TS 38.331, clause 5.3.5.8.3\]

The UE shall:

1\> if T304 of the MCG expires:

2\> release dedicated preambles provided in *rach-ConfigDedicated* if
configured;

2\> release dedicated msgA PUSCH resources provided in
*rach-ConfigDedicated* if configured;

...

2\> else:

3\> revert back to the UE configuration used in the source PCell;

3\> store the handover failure information in *VarRLF-Report* as
described in the subclause 5.3.10.5;

3\> initiate the connection re-establishment procedure as specified in
subclause 5.3.7.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> set the content of the *RRCReconfigurationComplete* message as
follows:

...

2\> if the UE has radio link failure or handover failure information
available in *VarRLF-Report* and if the RPLMN is included in
*plmn-IdentityList* stored in *VarRLF-Report*; or

...

3\> include *rlf-InfoAvailable in the RRCReconfigurationComplete*
message;

...

1\> else *(RRCReconfiguration* was received via SRB1*)*:

2\> submit the *RRCReconfigurationComplete* message via SRB1 to lower
layers for transmission using the new configuration;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if the *successHO-ReportReq* is set to *true* and if the UE has
successful handover related information available in
*VarSuccessHO-Report* and if the RPLMN is included in the
*plmn-IdentityList* stored in *VarSuccessHO-Report*:

2\> if the *successHO-Report* in the *VarSuccessHO-Report concerns a
DAPS handover and if* a PDCP PDU has been received from the source cell
of the concerned HO and a non-duplicated PDCP PDU has been received from
the target cell of the concerned HO*:*

3\> set *upInterruptionTimeAtHO* in *VarSuccessHO-Report* to include the
time elapsed between the time of arrival of the last PDCP PDU received
from the source cell of the concerned handover and the time of arrival
of the first non-duplicate PDCP PDU received from the target cell of the
concerned handover, as measured at the time of arrival of the first
non-duplicate PDCP PDU received from the target cell;

2\> set the *successHO-Report* in the *UEInformationResponse* message to
the value of *successHO-Report* in the *VarSuccessHO-Report*, if
available*;*

2\> discard the *VarSuccessHO-Report* upon successful delivery of the
*UEInformationResponse* message confirmed by lower layers;

...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

\[TS 38.331, clause 5.7.10.6\]

The UE shall for the PCell:

...

1\> if *sourceDAPS-FailureReporting* is included in the
*successHO-Config* before executing the last reconfiguration with sync
and is set to *true* and if the last executed handover was a DAPS
handover and if an RLF occurred at the source PCell during the DAPS
handover while T304 was running:

2\> store the successful handover information in *VarSuccessHO-Report*
and determine the content in *VarSuccessHO-Report* as follows:

3\> clear the information included in *VarSuccessHO-Report*, if any;

3\> set the *plmn-IdentityList* to include the list of EPLMNs stored by
the UE (i.e., includes the RPLMN);

3\> set the *c-RNTI* to the C-RNTI assigned by the target PCell of the
handover;

3\> for the source PCell in which the last *RRCReconfiguration* message
including *reconfigurationWithSync was applied:*

4\> set the *sourceCellID* in *sourceCellInfo* to the global cell
identity and tracking area code, if available, of the source PCell;

4\> set the *sourceCellMeas* in *sourceCellInfo* to include the cell
level RSRP, RSRQ and the available SINR, of the source PCell based on
the available SSB and CSI-RS measurements collected up to the moment the
UE sends *RRCReconfigurationComplete* message*;*

4\> set the *rsIndexResults* in *sourceCellMeas* to include all the
available SSB and CSI-RS measurement quantities of the source PCell
collected up to the moment the UE sends *RRCReconfigurationComplete*
message;

4\> if the last executed handover was a DAPS handover and if an RLF
occurred at the source PCell during the DAPS handover while T304 was
running:

5\> set the *rlf-InSourceDAPS* in *sourceCellInfo* to *true;*

3\> for the target PCell indicated in the last applied
*RRCReconfiguration* message including *reconfigurationWithSync:*

4\> set the *targetCellID* in *targetCellInfo* to the global cell
identity and tracking area code, if available, of the target PCell;

4\> set the *targetCellMeas* in *targetCellInfo* to include the cell
level RSRP, RSRQ and the available SINR, of the target PCell based on
the available SSB and CSI-RS measurements collected up to the moment the
UE sends *RRCReconfigurationComplete* message;

4\> set the *rsIndexResults* in *targetCellMeas* to include all the
available SSB and CSI-RS measurement quantities of the target PCell
collected up to the moment the UE sends *RRCReconfigurationComplete*
message;

4\> if the last applied *RRCReconfiguration* message including
*reconfigurationWithSync* was included in the stored *condRRCReconfig*:

5\> set the *timeSinceCHO-Reconfig* to the time elapsed between the
initiation of the execution of conditional reconfiguration for the
target PCell and the reception of the last *conditionalReconfiguration*
including the *condRRCReconfig* of the target PCell in the source PCell;

3\> if the ratio between the value of the elapsed time of the timer T304
and the configured value of the T304 timer, included in the last applied
*RRCReconfiguration* message including the *reconfigurationWithSync,* is
greater than *thresholdPercentageT304* if included in the
*successHO-Config* received before executing the last reconfiguration
with sync:

4\> set *t304-cause* in *shr-Cause* to *true*;

4\> set the *ra-InformationCommon* to include the random-access related
information associated to the random access procedure in the target
PCell, as specified in clause 5.7.10.5;

3\> if the ratio between the value of the elapsed time of the timer T310
and the configured value of the T310 timer, configured while the UE was
connected to the source PCell before executing the last reconfiguration
with sync, is greater than *thresholdPercentageT310* included in the
*successHO-Config* if configured by the source PCell before executing
the last reconfiguration with sync:

4\> set *t310-cause* in *shr-Cause* to *true*;

3\> if the T312 associated to the measurement identity of the target
cell was running at the time of initiating the execution of the
reconfiguration with sync procedure and if the ratio between the value
of the elapsed time of the timer T312 and the configured value of the
T312 timer, configured while the UE was connected to the source PCell
before executing the last reconfiguration with sync, is greater than
*thresholdPercentageT312* included in the s*uccessHO-Config* if
configured by the source PCell before executing the last reconfiguration
with sync:

4\> set *t312-cause* in *shr-Cause* to *true*;

3\> if *sourceDAPS-FailureReporting* included in the *successHO-Config*
if configured by the source PCell before executing the last
reconfiguration with sync is set to *true,* and if the last executed
handover was a DAPS handover and if an RLF occurred at the source PCell
during the DAPS handover while T304 was running:

4\> set *sourceDAPS-Failure* in *shr-Cause* to *true*;

3\> for each of the *measObjectNR*, configured by the source PCell, in
which the last *RRCReconfiguration* message including
*reconfigurationWithSync was applied*:

4\> if measurements are available for the *measObjectNR*:

5\> if the SS/PBCH block-based measurement quantities are available:

6\> set the measResultListNR in measResultNeighCells to include all the
available measurement quantities of the best measured cells, other than
the source PCell or target PCell, ordered such that the cell with
highest SS/PBCH block RSRP is listed first if SS/PBCH block RSRP
measurement results are available, otherwise the cell with highest
SS/PBCH block RSRQ is listed first if SS/PBCH block RSRQ measurement
results are available, otherwise the cell with highest SS/PBCH block
SINR is listed first, based on the available SS/PBCH block based
measurements collected up to the moment the UE sends the
RRCReconfigurationComplete message;

6\> for each neighbour cell included, include the optional fields that
are available;

NOTE 1: For the neighboring cells set included in *measResultListNR* in
*measResultNeighCells ordered* based on the SS/PBCH block measurement
quantities, the UE includes also the CSI-RS based measurement
quantities, if available.

5\> if the CSI-RS measurement quantities are available:

6\> set the measResultListNR in measResultNeighCells to include all the
available measurement quantities of the best measured cells, other than
the source PCell and target PCell, ordered such that the cell with
highest CSI-RS RSRP is listed first if CSI-RS RSRP measurement results
are available, otherwise the cell with highest CSI-RS RSRQ is listed
first if CSI-RS RSRQ measurement results are available, otherwise the
cell with highest CSI-RS SINR is listed first, based on the available
CSI-RS based measurements collected up to the moment the UE sends the
RRCReconfigurationComplete message;

6\> for each neighbour cell included, include the optional fields that
are available;

NOTE 2: For the neighboring cells set ordered based on the CSI-RS
measurement quantities, the UE includes measurements only for the cells
not yet included in measResultListNR in measResultNeighCells to avoid
*overriding* SS/PBCH block-based *ordered measurements*.

3\> for each of the *measObjectEUTRA*, configured by the source PCell in
which the last *RRCReconfiguration* message including
*reconfigurationWithSync was applied:*

4\> if measurements are available for the *measObjectEUTRA*:

5\> set the *measResultListEUTRA* in *measResultNeighCells* to include
the best measured cells ordered such that the cell with highest RSRP is
listed first if RSRP measurement results are available, otherwise the
cell with highest RSRQ is listed first, based on measurements collected
up to the moment the UE sends the *RRCReconfigurationComplete* message;

5\> for each neighbour cell included, include the optional fields that
are available;

3\> for each of the neighbour cells included in *measResultNeighCells*:

4\> if the cell was a candidate target cell included in the
*condRRCReconfig* within the *conditionalReconfiguration* configured by
the source PCell, in which the last *RRCReconfiguration* message
including *reconfigurationWithSync was applied*:

5\> set the *choCandidate* to *true* in *measResultNR*;

3\> if available, set the *locationInfo* as in 5.3.3.7;

1\> release *successHO-Config* configured by the source PCell and
*thresholdPercentageT304* if configured by the target PCell.

The UE may discard the successful handover information, i.e., release
the UE variable *VarSuccessHO-Report*, 48 hours after the last
successful handover information is added to the *VarSuccessHO-Report*.

##### 8.1.6.1.3.11.3 Test description {#test-description-72 .H6}

##### 8.1.6.1.3.11.3.1 Pre-test conditions {#pre-test-conditions-73 .H6}

##### System Simulator: {#system-simulator-52 .H6}

\- NR Cell 1 is the Serving cell and NR Cell 2 is the Suitable neighbour
intra-frequency cell.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.3 is used for NR Cells.

##### UE: {#ue-61 .H6}

\- None.

##### Preamble: {#preamble-61 .H6}

\- If pc\_IP\_Ping is set to TRUE then, the UE is in 5GS state 3N-A on
NR Cell 1 according to TS 38.508-1 \[4\], clause 4.4A.2 Table 4.4A.2-3.

\- Else, the UE is in 5GS state 3N-A and Test Loop Function (*On*) with
UE test loop mode B on NR Cell 1 according to TS 38.508-1\[4\], clause
4.4A.2 Table 4.4A.2-3.

##### 8.1.6.1.3.11.3.2 Test procedure sequence {#test-procedure-sequence-73 .H6}

Table 8.1.6.1.3.11.3.2-1 and Table 8.1.6.1.3.11.3.2-2 illustrate the
downlink power levels and other changing parameters to be applied for
the NR cells at various time instants of the test execution. The exact
instants on which these values shall be applied are described in the
texts in this clause. The configuration \"T0\" indicates the initial
conditions. Subsequent configurations marked \"T1\" and \"T2\" are
applied at the points indicated in the Main behaviour description in
Table 8.1.6.1.3.11.3.2-3.

Table 8.1.6.1.3.11.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T0 | SS/PBCH   | dBm/SCS | -88       | -94       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T1 | SS/PBCH   | dBm/SCS | off       | -94       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -88       | -94       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.6.1.3.11.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+-----------+--------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 2 | Remark |
+====+===========+=========+===========+===========+========+
| T0 | SS/PBCH   | dBm/SCS | -82       | -91       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T1 | SS/PBCH   | dBm/SCS | off       | -91       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+
| T2 | SS/PBCH   | dBm/SCS | -82       | -91       |        |
|    |           |         |           |           |        |
|    | SSS EPRE  |         |           |           |        |
+----+-----------+---------+-----------+-----------+--------+

Table 8.1.6.1.3.11.3.2-3: Main behaviour

+----+--------------+--------------+--------------+---------+-----+
| St | Procedure    | Message      | TP           | Verdict |     |
|    |              | Sequence     |              |         |     |
+====+==============+==============+==============+=========+=====+
|    |              | U - S        | Message      |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 1  | The SS       | \<\--        | NR RRC:      | \-      | \-  |
|    | transmits an |              | *RRCReco     |         |     |
|    | *RRCReco     |              | nfiguration* |         |     |
|    | nfiguration* |              |              |         |     |
|    | message      |              |              |         |     |
|    | containing   |              |              |         |     |
|    | *            |              |              |         |     |
|    | reconfigurat |              |              |         |     |
|    | ionWithSync* |              |              |         |     |
|    | to order UE  |              |              |         |     |
|    | to perform   |              |              |         |     |
|    | DAPS         |              |              |         |     |
|    | handover to  |              |              |         |     |
|    | NR Cell 2.   |              |              |         |     |
|    | DRB\#n of    |              |              |         |     |
|    | the first    |              |              |         |     |
|    | PDU session  |              |              |         |     |
|    | is           |              |              |         |     |
|    | configured   |              |              |         |     |
|    | as DAPS      |              |              |         |     |
|    | bearer.      |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| \- | EXCEPTION:   | \-           | \-           | \-      | \-  |
|    | In parallel  |              |              |         |     |
|    | with step    |              |              |         |     |
|    | 2-3,         |              |              |         |     |
|    | parallel     |              |              |         |     |
|    | behaviour    |              |              |         |     |
|    | defined in   |              |              |         |     |
|    | table        |              |              |         |     |
|    | 8.1.6.       |              |              |         |     |
|    | 1.3.11.3.2-4 |              |              |         |     |
|    | is executed. |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 2  | The SS       | \-           | \-           | \-      | \-  |
|    | changes the  |              |              |         |     |
|    | power level  |              |              |         |     |
|    | setting      |              |              |         |     |
|    | according to |              |              |         |     |
|    | the row      |              |              |         |     |
|    | \"T1\".      |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 3  | Waiting for  | \-           | \-           | \-      | \-  |
|    | T310         |              |              |         |     |
|    | expiring.    |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 3A | The SS       | \<\--        | Random       | \-      | \-  |
|    | transmits    |              | Access       |         |     |
|    | Random       |              | Response     |         |     |
|    | Access       |              |              |         |     |
|    | Response to  |              |              |         |     |
|    | respond to   |              |              |         |     |
|    | the latest   |              |              |         |     |
|    | preamble on  |              |              |         |     |
|    | NR Cell 2.   |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 3B | The UE       | \--\>        | NR RRC:      | \--     | \-- |
|    | transmits an |              | RR           |         |     |
|    | RR           |              | CReconfigura |         |     |
|    | CReconfigura |              | tionComplete |         |     |
|    | tionComplete |              |              |         |     |
|    | message in   |              |              |         |     |
|    | NR Cell 2.   |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 4  | The SS       | \-           | \-           | \-      | \-  |
|    | changes the  |              |              |         |     |
|    | power level  |              |              |         |     |
|    | setting      |              |              |         |     |
|    |              |              |              |         |     |
|    | according to |              |              |         |     |
|    | the row      |              |              |         |     |
|    | \"T2\".-     |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 5  | The UE       | \--\>        | NR RRC:      | \-      | \-  |
|    | transmits an |              | *RR          |         |     |
|    | *RR          |              | CReestablish |         |     |
|    | CReestablish |              | mentRequest* |         |     |
|    | mentRequest* |              |              |         |     |
|    | message in   |              |              |         |     |
|    | NR Cell 1.   |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 6  | The SS       | \<\--        | NR RRC:      | \-      | \-  |
|    | transmits an |              | *RRCRees     |         |     |
|    | *RRCRees     |              | tablishment* |         |     |
|    | tablishment* |              |              |         |     |
|    | message to   |              |              |         |     |
|    | resume SRB1  |              |              |         |     |
|    | operation    |              |              |         |     |
|    | and          |              |              |         |     |
|    | re-activate  |              |              |         |     |
|    | security in  |              |              |         |     |
|    | NR Cell 1.   |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 7  | Check: Does  | \--\>        | NR RRC:      | 1       | P   |
|    | the UE       |              | *RRC         |         |     |
|    | transmit an  |              | Reestablishm |         |     |
|    | *RRC         |              | entComplete* |         |     |
|    | Reestablishm |              |              |         |     |
|    | entComplete* |              |              |         |     |
|    | message with |              |              |         |     |
|    | *            |              |              |         |     |
|    | successHO-In |              |              |         |     |
|    | foAvailable* |              |              |         |     |
|    | in NR Cell   |              |              |         |     |
|    | 1?           |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 8  | The SS       | \<\--        | *NR RRC:     | \-      | \-  |
|    | transmits an |              | RRCReco      |         |     |
|    | *RRCReco     |              | nfiguration* |         |     |
|    | nfiguration* |              |              |         |     |
|    | message to   |              |              |         |     |
|    | resume       |              |              |         |     |
|    | existing     |              |              |         |     |
|    | radio        |              |              |         |     |
|    | bearers on   |              |              |         |     |
|    | NR Cell 1.   |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 9  | The UE       | \--\>        | *NR RRC:     | \-      | \-  |
|    | transmits an |              | RRCR         |         |     |
|    | *RRCR        |              | econfigurati |         |     |
|    | econfigurati |              | ontComplete* |         |     |
|    | ontComplete* |              |              |         |     |
|    | message.     |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 10 | The SS       | \<\--        | NR RRC:      | \-      | \-  |
|    | transmits an |              | *RRCReco     |         |     |
|    | *RRCReco     |              | nfiguration* |         |     |
|    | nfiguration* |              |              |         |     |
|    | message with |              |              |         |     |
|    | condition    |              |              |         |     |
|    | DAPS\_HO\_R  |              |              |         |     |
|    | eleaseSource |              |              |         |     |
|    | in NR Cell   |              |              |         |     |
|    | 2.           |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 11 | The UE       | \--\>        | NR RRC:      | \-      | \-  |
|    | transmits an |              | *RRC         |         |     |
|    | *RRC         |              | Reconfigurat |         |     |
|    | Reconfigurat |              | ionComplete* |         |     |
|    | ionComplete* |              |              |         |     |
|    | message in   |              |              |         |     |
|    | NR Cell 2.   |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 12 | The SS       | \<\--        | *NR RRC:     | \-      | \-  |
|    | transmits a  |              | UEInforma    |         |     |
|    | *UEInforma   |              | tionRequest* |         |     |
|    | tionRequest* |              |              |         |     |
|    | message.     |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+
| 13 | Check: Does  | \--\>        | *NR RRC:     | 2       | P   |
|    | the UE       |              | UEInformat   |         |     |
|    | transmit a   |              | ionResponse* |         |     |
|    | *UEInformat  |              |              |         |     |
|    | ionResponse* |              |              |         |     |
|    | message      |              |              |         |     |
|    | including    |              |              |         |     |
|    | *succe       |              |              |         |     |
|    | ssHO-Report* |              |              |         |     |
|    | in NR Cell   |              |              |         |     |
|    | 2?           |              |              |         |     |
+----+--------------+--------------+--------------+---------+-----+

Table 8.1.6.1.3.11.3.2-4: Parallel behaviour

  St   Procedure                                 Message Sequence   TP                 Verdict   
  ---- ----------------------------------------- ------------------ ------------------ --------- ----
                                                 U - S              Message                      
  1    The UE transmits preamble to NR Cell 2.   \--\>              (PRACH Preamble)   \-        \-
  2    The SS does not respond.                  \-                 *-*                \-        \-

##### 8.1.6.1.3.11.3.3 Specific message contents {#specific-message-contents-74 .H6}

Table 8.1.6.1.3.11.3.3-1: *SIB1* for NR Cell 1 (all steps)

  Derivation Path: TS 38.508-1 \[4\] table 4.6.1-28                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/Remark   Comment   Condition
  SIB1 ::= SEQUENCE {                                                          
  ue-TimersAndConstants SEQUENCE {                                             
  t310                                                ms50           50 ms     
  }                                                                            
  }                                                                            

Table 8.1.6.1.3.11.3.3-2: *RRCReconfiguration* (step 1, Table
8.1.6.1.3.11.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A with Condition RBConfig\_KeyChange                                                                                                                                                     
  --------------------------------------------------------------------------------------- ----------------------------------------------------------------------------- ------------------------------------------------------------------- -----------
  Information Element                                                                     Value/remark                                                                  Comment                                                             Condition
  RRCReconfiguration ::= SEQUENCE {                                                                                                                                                                                                         
  criticalExtensions CHOICE {                                                                                                                                                                                                               
  rrcReconfiguration SEQUENCE {                                                                                                                                                                                                             
  radioBearerConfig                                                                       RadioBearerConfig with conditions (SRB\_NR\_PDCP) and (DRBn AND DAPS\_PDCP)                                                                       
  nonCriticalExtension SEQUENCE{                                                                                                                                                                                                            
  masterCellGroup                                                                         CellGroupConfig                                                               OCTET STRING (CONTAINING CellGroupConfig)Table 8.1.6.1.3.11.3.3-3   
  nonCriticalExtension SEQUENCE{                                                                                                                                                                                                            
  nonCriticalExtension SEQUENCE{                                                                                                                                                                                                            
  nonCriticalExtension SEQUENCE{                                                                                                                                                                                                            
  nonCriticalExtension SEQUENCE{                                                                                                                                                                                                            
  otherConfig-v1700 SEQUENCE {                                                                                                                                                                                                              
  successHO-Config-r17 CHOICE {                                                                                                                                                                                                             
  setup SEQUENCE {                                                                                                                                                                                                                          
  sourceDAPS-FailureReporting-r17                                                         true                                                                                                                                              
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         
  }                                                                                                                                                                                                                                         

Table 8.1.6.1.3.11.3.3-3: *CellGroupConfig* (Table 8.1.6.1.3.11.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-19 with condition PCell\_change and CFRA                                                                          
  ------------------------------------------------------------------------------------------ ------------------------------------------- -------------------------- -----------
  Information Element                                                                        Value/remark                                Comment                    Condition
  CellGroupConfig ::= SEQUENCE {                                                                                                                                    
  rlc-BearerToAddModList SEQUENCE (SIZE(1..maxLCH)) OF RLC-BearerConfig {                    3 entries                                                              
  RLC-BearerConfig\[1\]                                                                      RLC-BearerConfig with conditions SRB1       entry 1                    
  RLC-BearerConfig\[2\]                                                                      RLC-BearerConfig with conditions SRB2       entry 2                    
  RLC-BearerConfig\[3\]                                                                      RLC-BearerConfig with conditions AM, DRBn   entry 3                    
  }                                                                                                                                                                 
  spCellConfig SEQUENCE {                                                                                                                                           
  reconfigurationWithSync SEQUENCE {                                                                                                                                
  spCellConfigCommon SEQUENCE {                                                                                                                                     
  physCellId                                                                                 Physical Cell Identity of NR Cell 2                                    
  uplinkConfigCommon SEQUENCE {                                                                                                                                     
  initialUplinkBWP SEQUENCE {                                                                                                                                       
  rach-ConfigCommon CHOICE {                                                                                                                                        
  setup SEQUENCE {                                                                                                                                                  
  rach-ConfigGeneric                                                                         RACH-ConfigGeneric                          Table 8.1.6.1.3.11.3.3-4   
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 
  }                                                                                                                                                                 

Table 8.1.6.1.3.11.3.3-4: *RACH-ConfigGeneric* (Table
8.1.6.1.3.11.3.3-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-130                            
  ----------------------------------------------------- -------------- --------- -----------
  Information Element                                   Value/remark   Comment   Condition
  RACH-ConfigGeneric ::= SEQUENCE {                                              
  preambleTransMax                                      n200                     
  }                                                                              

able 8.1.6.1.3.11.3.3-5: *RRCReestablishment* (step 6, Table
8.1.6.1.3.11.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-10                            
  ---------------------------------------------------- -------------- --------- -----------
  Information Element                                  Value/remark   Comment   Condition
  RRCReestablishment ::= SEQUENCE {                                             
  criticalExtensions CHOICE {                                                   
  rrcReestablishment SEQUENCE {                                                 
  nextHopChainingCount                                 2                        
  }                                                                             
  }                                                                             
  }                                                                             

Table 8.1.6.1.3.11.3.3-6: *RRCReestablishmentComplete* (step 7, Table
8.1.6.1.3.11.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-11                                                           
  ---------------------------------------------------- --------------------------------------------- --------- -----------
  Information Element                                  Value/remark                                  Comment   Condition
  RRCReestablishmentComplete ::= SEQUENCE {                                                                    
  criticalExtensions CHOICE {                                                                                  
  rrcReestablishmentComplete SEQUENCE {                                                                        
  nonCriticalExtension SEQUENCE {                                                                              
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable with condition SHR             
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            
  }                                                                                                            

Table 8.1.6.1.3.11.3.3-7: *RRCReconfiguration* (step 8, Table
8.1.6.1.3.11.3.2-3)

  -------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with condition REEST
  -------------------------------------------------------------------------

Table 8.1.6.1.3.11.3.3-8: *RRCReconfiguration* (step 10, Table
8.1.6.1.3.11.3.2-3)

  -------------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13 with Condition DAPS\_HO\_ReleaseSource
  -------------------------------------------------------------------------------------------

Table 8.1.6.1.3.11.3.3-9: *UEInformationRequest* (step 12, Table
8.1.6.1.3.11.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition SHR
  ------------------------------------------------------------------------

Table 8.1.6.1.3.11.3.3-10: *UEInformationResponse* (step 13, Table
8.1.6.1.3.11.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                   
  ----------------------------------------------------- ----------------------------------------------------- --------- -----------
  Information Element                                   Value/remark                                          Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                              
  criticalExtensions CHOICE {                                                                                           
  ueInformationResponse-r16 SEQUENCE {                                                                                  
  nonCriticalExtension CHOICE {                                                                                         
  successHO-Report-r17 SEQUENCE {                                                                                       
  sourceCellInfo-r17 SEQUENCE {                                                                                         
  sourcePCellId-r17 SEQUENCE {                                                                                          
  plmn-Identity-r16                                     PLMN ID of NR Cell 1                                            
  cellIdentity-r16                                      CGI of NR Cell 1                                                
  trackingAreaCode-r16                                  TAC of NR Cell 1                                                
  }                                                                                                                     
  sourceCellMeas-r17 SEQUENCE {                                                                                         
  measResult-r17 SEQUENCE {                                                                                             
  cellResults-r17 SEQUENCE {                                                                                            
  resultsSSB-Cell-r17 SEQUENCE {                                                                                        
  rsrp                                                  (0..127)                                                        
  rsrq                                                  (0..127)                                                        
  sinr                                                  Not checked                                                     
  }                                                                                                                     
  resultsCSI-RS-Cell-r16                                Not checked                                                     
  }                                                                                                                     
  rsIndexResults-r17 SEQUENCE {                                                                                         
  resultsSSB-Indexes-r17 SEQUENCE {                                                                                     
  ssb-Index                                             1                                                               
  ssb-Results SEQUENCE {                                                                                                
  rsrp                                                  (0..127)                                                        
  rsrq                                                  (0..127)                                                        
  sinr                                                  Not checked                                                     
  }                                                                                                                     
  }                                                                                                                     
  resultsCSI-RS-Indexes-r17                             Not checked                                                     
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     
  rlf-InSourceDAPS-r17                                  true                                                            
  }                                                                                                                     
  targetCellInfo-r17 SEQUENCE {                                                                                         
  targetPCellId-r17 SEQUENCE {                                                                                          
  plmn-Identity-r16                                     PLMN ID of NR Cell 2                                            
  cellIdentity-r16                                      CGI of NR Cell 2                                                
  trackingAreaCode-r16                                  TAC of NR Cell 2                                                
  }                                                                                                                     
  targetCellMeas-r17 SEQUENCE {                                                                                         
  measResult-r17 SEQUENCE {                                                                                             
  cellResults-r17 SEQUENCE {                                                                                            
  resultsSSB-Cell-r16 SEQUENCE {                                                                                        
  rsrp                                                  (0..127)                                                        
  rsrq                                                  (0..127)                                                        
  sinr                                                  Not checked                                                     
  }                                                                                                                     
  resultsCSI-RS-Cell-r16                                Not checked                                                     
  }                                                                                                                     
  rsIndexResults-r17 SEQUENCE {                                                                                         
  resultsSSB-Indexes-r16 SEQUENCE {                                                                                     
  ssb-Index                                             1                                                               
  ssb-Results SEQUENCE {                                                                                                
  rsrp                                                  (0..127)                                                        
  rsrq                                                  (0..127)                                                        
  sinr                                                  Not checked                                                     
  }                                                                                                                     
  }                                                                                                                     
  resultsCSI-RS-Indexes-r17                             Not checked                                                     
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     
  measResultNeighCells-r17                              Not present                                                     
  locationInfo-r17                                      Not checked                                                     
  timeSinceCHO-Reconfig-r17                             Any allowed value                                               
  shr-Cause-r17 SEQUENCE {                                                                                              
  sourceDAPS-Failure-r17                                true                                                            
  }                                                                                                                     
  ra-InformationCommon-r17                              Not checked                                                     
  upInterruptionTimeAtHO-r17                            (0..1023)                                                       
  c-RNTI-r17                                            the value of the C-RNTI of the UE used in NR Cell 2             
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     
  }                                                                                                                     

##### 8.1.6.1.4 Connection Establishment Failure

###### 8.1.6.1.4.1 Connection Establishment Failure / Logging and reporting / T300 expiry

##### 8.1.6.1.4.1.1 Test Purpose (TP) {#test-purpose-tp-75 .H6}

##### (1) {#section-147 .H6}

**with** { UE having sent an *RRCSetupRequest* message }

**ensure that** {\
**when** { T300 is expired and random access procedure failed }

**then** { UE stores the connection establishment failure information }

}

##### (2) {#section-148 .H6}

**with** { UE having sent an *RRCSetupComplete* message with
*connEstFailInfoAvailable* }

**ensure that** {

**when** { UE receives a *UEInformationRequest* message with
*connEstFailReportReq* set to true }

**then** { UE sends a *UEInformationResponse* message with
*connEstFailReport* }

}

##### 8.1.6.1.4.1.2 Conformance requirements {#conformance-requirements-77 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.3.4, 5.3.3.7, 5.7.10.3.\[TS 38.331,
clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has connection establishment failure or connection resume
failure information available in *VarConnEstFailReport* and if the RPLMN
is equal to *plmn-Identity* stored in *VarConnEstFailReport*:

3\> include *connEstFailInfoAvailable in the RRCSetupComplete* message;

...

\[TS 38.331, clause 5.3.3.7\]

The UE shall:

1\> if timer T300 expires:

2\> reset MAC, release the MAC configuration and re-establish RLC for
all RBs that are established;

2\> if the UE supports RRC Connection Establishment failure with
temporary offset and the T300 has expired a consecutive
*connEstFailCount* times on the same cell for which
*connEstFailureControl* is included in *SIB1*:

3\> for a period as indicated by *connEstFailOffsetValidity*:

4\> use *connEstFailOffset* for the parameter *Qoffsettemp* for the
concerned cell when performing cell selection and reselection according
to TS 38.304 \[20\] and TS 36.304 \[27\];

NOTE 1: When performing cell selection, if no suitable or acceptable
cell can be found, it is up to UE implementation whether to stop using
*connEstFailOffset* for the parameter *Qoffsettemp* during
*connEstFailOffsetValidity* for the concerned cell.

2\> if the UE has connection establishment failure informaton or
connection resume failure information available in
*VarConnEstFailReport* and if the RPLMN is not equal to *plmn-identity*
stored in *VarConnEstFailReport*; or

2\> if the cell identity of current cell is not equal to the cell
identity stored in *measResultFailedCell* in *VarConnEstFailReport*:

3\> reset the *numberOfConnFail* to 0;

2\> clear the content included in *VarConnEstFailReport* except for the
*numberOfConnFail*, if any;

2\> store the following connection establishment failure information in
the *VarConnEstFailReport* by setting its fields as follows:

3\> set the *plmn-Identity* to the PLMN selected by upper layers (see TS
24.501 \[23\]) from the PLMN(s) included in the *plmn-IdentityList* in
*SIB1*;

3\> set the *measResultFailedCell* to include the global cell identity,
tracking area code, the cell level and SS/PBCH block level RSRP, and
RSRQ, and SS/PBCH block indexes, of the failed cell based on the
available SSB measurements collected up to the moment the UE detected
connection establishment failure;

3\> if available, set the *measResultNeighCells,* in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements for at most the following number of neighbouring
cells: 6 intra-frequency and 3 inter-frequency neighbours per frequency
as well as 3 inter-RAT neighbours, per frequency/ set of frequencies per
RAT and according to the following:

4\> for each neighbour cell included, include the optional fields that
are available;

NOTE 2: The UE includes the latest results of the available measurements
as used for cell reselection evaluation, which are performed in
accordance with the performance requirements as specified in TS 38.133
\[14\].

3\> if available, set the *locationInfo* as follows:

4\> if available, set the *commonLocationInfo* to include the detailed
location information;

4\> if available, set the *bt-LocationInfo* to include the Bluetooth
measurement results, in order of decreasing RSSI for Bluetooth beacons;

4\> if available, set the *wlan-LocationInfo* to include the WLAN
measurement results, in order of decreasing RSSI for WLAN APs;

4\> if available, set the *sensor-LocationInfo* to include the sensor
measurement results as follows;

5\> if available, include the *sensor-MeasurementInformation*;

5\> if available, include the *sensor-MotionInformation*;

3\> set *perRAInfoList* to indicate random access failure information as
specified in 5.7.10.5;

3\> if the *numberOfConnFail* is smaller than 8:

4\> increment the *numberOfConnFail* by 1;

2\> inform upper layers about the failure to establish the RRC
connection, upon which the procedure ends;

The UE may discard the connection establishment failure or connection
resume failure information, i.e. release the UE variable
*VarConnEstFailReport*, 48 hours after the last connection establishment
failure is detected.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *connEstFailReportReq* is set to *true* and the UE has connection
establishment failure or connection resume failure information in
*VarConnEstFailReport* and if the RPLMN is equal to *plmn-Identity*
stored in *VarConnEstFailReport*:

2\> set *timeSinceFailure* in *VarConnEstFailReport* to the time that
elapsed since the last connection establishment failure or connection
resume failure in NR;

2\> set the *connEstFailReport* in the *UEInformationResponse* message
to the value of *connEstFailReport* in *VarConnEstFailReport*;

2\> discard the *connEstFailReport* from *VarConnEstFailReport* upon
successful delivery of the *UEInformationResponse* message confirmed by
lower layers;

...

##### 8.1.6.1.4.1.3 Test description {#test-description-73 .H6}

##### 8.1.6.1.4.1.3.1 Pre-test conditions {#pre-test-conditions-74 .H6}

##### System Simulator: {#system-simulator-53 .H6}

\- NR Cell 1.

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-62 .H6}

\- None.

##### Preamble: {#preamble-62 .H6}

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.6.1.4.1.3.2 Test procedure sequence {#test-procedure-sequence-74 .H6}

Table 8.1.6.1.4.1.3.2-1: Main behaviour

+------+-------------+-------------+-------------+---------+----+
| St   | Procedure   | Message     | TP          | Verdict |    |
|      |             | Sequence    |             |         |    |
+======+=============+=============+=============+=========+====+
|      |             | U - S       | Message     |         |    |
+------+-------------+-------------+-------------+---------+----+
| 1    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits a |             | *Paging*    |         |    |
|      | *Paging*    |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 2    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | transmits   |             | *RRCSe      |         |    |
|      | an          |             | tupRequest* |         |    |
|      | *RRCSe      |             |             |         |    |
|      | tupRequest* |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 3    | The SS      | \-          | \-          | \-      | \- |
|      | waits for   |             |             |         |    |
|      | 2sec to     |             |             |         |    |
|      | ensure that |             |             |         |    |
|      | the UE      |             |             |         |    |
|      | detects     |             |             |         |    |
|      | T300        |             |             |         |    |
|      | expiry.     |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 4    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits a |             | *Paging*    |         |    |
|      | *Paging*    |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 5    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | transmits   |             | *RRCSe      |         |    |
|      | an          |             | tupRequest* |         |    |
|      | *RRCSe      |             |             |         |    |
|      | tupRequest* |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 6    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits   |             | *RRCSetup*  |         |    |
|      | an          |             |             |         |    |
|      | *RRCSetup*  |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 7    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|      | the UE      |             | *RRCSet     |         |    |
|      | transmit an |             | upComplete* |         |    |
|      | *RRCSet     |             |             |         |    |
|      | upComplete* |             | 5GMM:       |         |    |
|      | message     |             | SERVICE     |         |    |
|      | including   |             | REQUEST     |         |    |
|      | *con        |             |             |         |    |
|      | nEstFailInf |             |             |         |    |
|      | oAvailable* |             |             |         |    |
|      | IE set it   |             |             |         |    |
|      | to *true*?  |             |             |         |    |
|      | UE          |             |             |         |    |
|      | initiates   |             |             |         |    |
|      | the session |             |             |         |    |
|      | management  |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | by          |             |             |         |    |
|      | including   |             |             |         |    |
|      | the SERVICE |             |             |         |    |
|      | REQUEST     |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 8-11 | Steps 5 to  | \-          | *-*         | \-      | \- |
|      | 8 of the    |             |             |         |    |
|      | generic     |             |             |         |    |
|      | radio       |             |             |         |    |
|      | bearer      |             |             |         |    |
|      | es          |             |             |         |    |
|      | tablishment |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | in TS       |             |             |         |    |
|      | 38.508-1    |             |             |         |    |
|      | table       |             |             |         |    |
|      | 4.5.4.2-3   |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 12   | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | sends a     |             | *UEInformat |         |    |
|      | *UEInformat |             | ionRequest* |         |    |
|      | ionRequest* |             |             |         |    |
|      | message to  |             |             |         |    |
|      | get         |             |             |         |    |
|      | *           |             |             |         |    |
|      | connEstFail |             |             |         |    |
|      | ReportReq*. |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 13   | Check: Does | \--\>       | NR RRC:     | 2       | P  |
|      | the UE send |             | *           |         |    |
|      | a           |             | UEInformati |         |    |
|      | *UEInformat |             | onResponse* |         |    |
|      | ionResponse |             |             |         |    |
|      | message     |             |             |         |    |
|      | with        |             |             |         |    |
|      | connEstF    |             |             |         |    |
|      | ailReport?* |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.4.1.3.3 Specific message contents {#specific-message-contents-75 .H6}

Table 8.1.6.1.4.1.3.3-1: *RRCSetupComplete* (step 7, Table
8.1.6.1.4.1.3.2-1)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition CEF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.4.1.3.3-2: Void

Table 8.1.6.1.4.1.3.3-3: *UEInformationResponse* (step 13, Table
8.1.6.1.4.1.3.2-1)

  ----------------------------------------------------- ---------------------------------------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                 
  Information Element                                   Value/remark                                         Comment                  Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                            
  criticalExtensions CHOICE {                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                
  connEstFailReport-r16 SEQUENCE {                                                                                                    
  measResultFailedCell-r16 SEQUENCE {                                                                                                 
  cgi-Info SEQUENCE {                                                                                                                 
  plmn-Identity-r16                                     plmn-Identity within SIB1 broadcasted in NR Cell 1                            
  cellIdentity-r16                                      cellIdentity within SIB1 broadcasted in NR Cell 1    BIT STRING (SIZE (36))   
  trackingAreaCode-r16                                  Not present or any allowed value                     BIT STRING (SIZE (24))   
  }                                                                                                                                   
  measResult-r16 SEQUENCE {                                                                                                           
  cellResults-r16                                       Not present or any allowed value                                              
  rsIndexResults-r16                                    Not present or any allowed value                                              
  }                                                                                                                                   
  }                                                                                                                                   
  locationInfo-r16                                      Not present or any allowed value                                              
  measResultNeighCells-r16 SEQUENCE {                                                                                                 
  measResultNeighCellListNR                             Not present                                                                   
  measResultNeighCellListEUTRA                          Not present                                                                   
  }                                                                                                                                   
  numberOfConnFail-r16                                  Any allowed value                                    INTEGER (1..8)           
  perRAInfoList-r16                                     Any allowed value                                                             
  timeSinceFailure-r16                                  Any allowed value                                    INTEGER (0..172800)      
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  ----------------------------------------------------- ---------------------------------------------------- ------------------------ -----------

###### 8.1.6.1.4.2 Connection Establishment Failure / Logging and reporting / RRC Resume

##### 8.1.6.1.4.2.1 Test Purpose (TP) {#test-purpose-tp-76 .H6}

##### (1) {#section-149 .H6}

**with** { UE having sent an *RRCResumeRequest* message }

**ensure that** {\
**when** { T319 is expired and random access procedure failed }

**then** { UE stores the connection resume failure information }

}

##### (2) {#section-150 .H6}

**with** { UE having sent an *RRCSetupComplete* message with
*connEstFailInfoAvailable* }

**ensure that** {

**when** { UE receives a *UEInformationRequest* message with
*connEstFailReportReq* set to true }

**then** { UE sends a *UEInformationResponse* message with
*connEstFailReport* }

}

##### 8.1.6.1.4.2.2 Conformance requirements {#conformance-requirements-78 .H6}

References: The conformance requirements covered in the current TC is
specified in: TS 38.331 clause 5.3.3.4, 5.3.13.5, 5.7.10.3.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has connection establishment failure or connection resume
failure information available in *VarConnEstFailReport* and if the RPLMN
is equal to *plmn-Identity* stored in *VarConnEstFailReport*:

3\> include *connEstFailInfoAvailable in the RRCSetupComplete* message;

...

\[TS 38.331, clause 5.3.13.5\]

The UE shall:

1\> if timer T319 expires or upon receiving Integrity check failure
indication from lower layers while T319 is running:

2\> if the UE has connection establishment failure information or
connection resume failure informaton available in *VarConnEstFailReport*
and if the RPLMN is not equal to plmn-identity stored in
*VarConnEstFailReport*; or

2\> if the cell identity of current cell is not equal to the cell
identity stored in *measResultFailedCell* in *VarConnEstFailReport*:

3\> reset the *numberOfConnFail* to 0;

2\> clear the content included in *VarConnEstFailReport* except for the
*numberOfConnFail*, if any;

2\> store the following connection resume failure information in the
*VarConnEstFailReport* by setting its fields as follows:

3\> set the *plmn-Identity* to the PLMN selected by upper layers (see TS
24.501 \[23\]) from the PLMN(s) included in the *plmn-IdentityList* in
*SIB1*;

3\> set the *measResultFailedCell* to include the global cell identity,
tracking area code, the cell level and SS/PBCH block level RSRP, and
RSRQ, and SS/PBCH block indexes, of the failed cell based on the
available SSB measurements collected up to the moment the UE detected
connection resume failure;

3\> if available, set the *measResultNeighCells,* in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements for at most the following number of neighbouring
cells: 6 intra-frequency and 3 inter-frequency neighbours per frequency
as well as 3 inter-RAT neighbours, per frequency/ set of frequencies per
RAT and according to the following:

4\> for each neighbour cell included, include the optional fields that
are available;

NOTE: The UE includes the latest results of the available measurements
as used for cell reselection evaluation, which are performed in
accordance with the performance requirements as specified in TS 38.133
\[14\].

3\> if available, set the *locationInfo* as in 5.3.3.7;

3\> set *perRAInfoList* to indicate random access failure information as
specified in 5.7.10.5;

3\> if *numberOfConnFail* is smaller than 8:

4\> increment the *numberOfConnFail* by 1;

2\> perform the actions upon going to RRC\_IDLE as specified in 5.3.11
with release cause \'RRC Resume failure\'.

The UE may discard the connection resume failure or connection
establishment failure information, i.e. release the UE variable
*VarConnEstFailReport*, 48 hours after the last connection resume
failure is detected.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *connEstFailReportReq* is set to *true* and the UE has connection
establishment failure or connection resume failure information in
*VarConnEstFailReport* and if the RPLMN is equal to *plmn-Identity*
stored in *VarConnEstFailReport*:

2\> set *timeSinceFailure* in *VarConnEstFailReport* to the time that
elapsed since the last connection establishment failure or connection
resume failure in NR;

2\> set the *connEstFailReport* in the *UEInformationResponse* message
to the value of *connEstFailReport* in *VarConnEstFailReport*;

2\> discard the *connEstFailReport* from *VarConnEstFailReport* upon
successful delivery of the *UEInformationResponse* message confirmed by
lower layers;

...

\[TS 24.501, clause 5.3.1.4\]

...

If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives
an indication from the lower layers that the resumption of the RRC
connection has failed, and:

a\) if the lower layers indicate that access barring is applicable for
all access categories except categories 0 and 2, the UE shall:

1\) stay in 5GMM-CONNECTED mode with RRC inactive indication;

b\) else, the UE shall:

1\) enter 5GMM-IDLE mode; and

2\) initiate the registration procedure for mobility and periodic
registration update used for mobility (i.e. the 5GS registration type IE
set to \"mobility registration updating\" in the REGISTRATION REQUEST
message) for N1 NAS signalling connection recovery as specified in
subclause 5.5.1.3.2.

NOTE 2: An indication from the lower layer that the RRC connection has
been released with cause \"RRC resume failure\" can be considered as an
indication that the resumption of the RRC connection has failed.

##### 8.1.6.1.4.2.3 Test description {#test-description-74 .H6}

##### 8.1.6.1.4.2.3.1 Pre-test conditions {#pre-test-conditions-75 .H6}

##### System Simulator: {#system-simulator-54 .H6}

\- NR Cell 1

##### UE: {#ue-63 .H6}

\- None.

##### Preamble: {#preamble-63 .H6}

\- The UE is in state 2N-A on NR Cell 1 as defined in TS 38.508-1 \[4\],
subclause 4.4A.

##### 8.1.6.1.4.2.3.2 Test procedure sequence {#test-procedure-sequence-75 .H6}

Table 8.1.6.1.4.2.3.2-1: Void

Table 8.1.6.1.4.2.3.2-2: Void

Table 8.1.6.1.4.2.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 1.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRes     |         |    |
|       | an          |             | umeRequest* |         |    |
|       | *RRCRes     |             |             |         |    |
|       | umeRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | The SS      | \-          | \-          | \-      | \- |
|       | waits for 1 |             |             |         |    |
|       | sec to      |             |             |         |    |
|       | ensure that |             |             |         |    |
|       | the UE      |             |             |         |    |
|       | detects     |             |             |         |    |
|       | T319        |             |             |         |    |
|       | expiry.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3A    | The UE      | \--\>       | NR RRC:     |         |    |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3B    | The SS      | \<\--       | NR RRC:     |         |    |
|       | transmits   |             | *RRCSetup*  |         |    |
|       | an          |             |             |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3C    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *RRCSet     |         |    |
|       | transmit an |             | upComplete* |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             | 5GMM:       |         |    |
|       | message     |             | R           |         |    |
|       | including   |             | EGISTRATION |         |    |
|       | *con        |             | REQUEST     |         |    |
|       | nEstFailInf |             |             |         |    |
|       | oAvailable* |             |             |         |    |
|       | IE set it   |             |             |         |    |
|       | to *true*?  |             |             |         |    |
|       | UE          |             |             |         |    |
|       | initiates   |             |             |         |    |
|       | the         |             |             |         |    |
|       | mobility    |             |             |         |    |
|       | r           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | by          |             |             |         |    |
|       | including   |             |             |         |    |
|       | the         |             |             |         |    |
|       | R           |             |             |         |    |
|       | EGISTRATION |             |             |         |    |
|       | REQUEST     |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3D-3E | Steps4-5    | \-          | *-*         | \-      | \- |
|       | defined in  |             |             |         |    |
|       | TS 38.508-1 |             |             |         |    |
|       | \[4\] Table |             |             |         |    |
|       | 4           |             |             |         |    |
|       | .9.5.2.2-1, |             |             |         |    |
|       | indicate    |             |             |         |    |
|       | that the UE |             |             |         |    |
|       | has         |             |             |         |    |
|       | performed   |             |             |         |    |
|       | mobility    |             |             |         |    |
|       | r           |             |             |         |    |
|       | egistration |             |             |         |    |
|       | on NR cell  |             |             |         |    |
|       | 1 started   |             |             |         |    |
|       | in NR       |             |             |         |    |
|       | RRC\_IDLE?  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *SecurityM  |         |    |
|       | Security    |             | odeCommand* |         |    |
|       | ModeCommand |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             | *SecurityMo |         |    |
|       | SecurityM   |             | deComplete* |         |    |
|       | odeComplete |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6-12  | Void        |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 13    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | sends a     |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | get         |             |             |         |    |
|       | *           |             |             |         |    |
|       | connEstFail |             |             |         |    |
|       | ReportReq*. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | Check: Does | \--\>       | NR RRC:     | 2       | P  |
|       | the UE send |             | *           |         |    |
|       | a           |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | connEstF    |             |             |         |    |
|       | ailReport?* |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.4.2.3.3 Specific message contents {#specific-message-contents-76 .H6}

Table 8.1.6.1.4.2.3.3-1: *RRCSetupComplete* (step 3C, Table
8.1.6.1.4.2.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition CEF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.4.2.3.3-2: Void

Table 8.1.6.1.4.2.3.3-3: *UEInformationResponse* (step 14, Table
8.1.6.1.4.2.3.2-3)

  ----------------------------------------------------- ---------------------------------------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                 
  Information Element                                   Value/remark                                         Comment                  Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                            
  criticalExtensions CHOICE {                                                                                                         
  ueInformationResponse-r16 SEQUENCE {                                                                                                
  connEstFailReport-r16 SEQUENCE {                                                                                                    
  measResultFailedCell-r16 SEQUENCE {                                                                                                 
  cgi-Info SEQUENCE {                                                                                                                 
  plmn-Identity-r16                                     plmn-Identity within SIB1 broadcasted in NR Cell 1                            
  cellIdentity-r16                                      cellIdentity within SIB1 broadcasted in NR Cell 1    BIT STRING (SIZE (36))   
  trackingAreaCode-r16                                  Not checked                                          BIT STRING (SIZE (24))   
  }                                                                                                                                   
  measResult-r16 SEQUENCE {                                                                                                           
  cellResults-r16                                       Not checked                                                                   
  rsIndexResults-r16                                    Not checked                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  locationInfo-r16                                      Not checked                                                                   
  measResultNeighCells-r16 SEQUENCE {                                                                                                 
  measResultNeighCellListNR                             Not present                                                                   
  measResultNeighCellListEUTRA                          Not present                                                                   
  }                                                                                                                                   
  numberOfConnFail-r16                                  Not checked                                          INTEGER (1..8)           
  perRAInfoList-r16                                     Not checked                                                                   
  timeSinceFailure-r16                                  Not checked                                          INTEGER (0..172800)      
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  }                                                                                                                                   
  ----------------------------------------------------- ---------------------------------------------------- ------------------------ -----------

###### 8.1.6.1.4.3 Connection Establishment Failure / Logging and reporting / Reporting at intra-NR handover

##### 8.1.6.1.4.3.1 Test Purpose (TP) {#test-purpose-tp-77 .H6}

##### (1) {#section-151 .H6}

**with** { UE has connection establishment failure information available
}

**ensure that** {

**when** { UE performs an intra-NR Handover procedure }

**then** { UE sends an RRCReconfigurationComplete message with
connEstFailInfoAvailable }

}

##### 8.1.6.1.4.3.2 Conformance requirements {#conformance-requirements-79 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.5.3. Unless otherwise stated these
are Rel-16 requirements.

\[TS 38.331, clause 5.3.5.3\]

The UE shall perform the following actions upon reception of the
*RRCReconfiguration,* or upon execution of the conditional
reconfiguration (CHO or CPC):

...

1\> set the content of the *RRCReconfigurationComplete* message as
follows:

...

2\> if the UE has connection establishment failure or connection resume
failure information available in *VarConnEstFailReport* and if the RPLMN
is equal to *plmn-Identity* stored in *VarConnEstFailReport*:

3\> include *connEstFailInfoAvailable* in *the
RRCReconfigurationComplete message*;

##### 8.1.6.1.4.3.3 Test description {#test-description-75 .H6}

##### 8.1.6.1.4.3.3.1 Pre-test conditions {#pre-test-conditions-76 .H6}

##### System Simulator: {#system-simulator-55 .H6}

\- NR Cell 1 and NR Cell 3.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-64 .H6}

\- None.

##### Preamble: {#preamble-64 .H6}

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.6.1.4.3.3.2 Test procedure sequence {#test-procedure-sequence-76 .H6}

Table 8.1.6.1.4.3.3.2-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.4.3.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+--------+-------------+
|    | Parameter | Unit    | NR Cell 1 | NR     | Remark      |
|    |           |         |           |        |             |
|    |           |         |           | Cell 3 |             |
+====+===========+=========+===========+========+=============+
| T0 | SS/PBCH   | dBm/SCS | -85       | -97    | Power       |
|    |           |         |           |        | levels are  |
|    | SSS EPRE  |         |           |        | such that   |
|    |           |         |           |        | entry       |
|    |           |         |           |        | condition   |
|    |           |         |           |        | for event   |
|    |           |         |           |        | A3 is not   |
|    |           |         |           |        | satisfied   |
|    |           |         |           |        | for the     |
|    |           |         |           |        | neighbour   |
|    |           |         |           |        | NR cell.    |
+----+-----------+---------+-----------+--------+-------------+
| T1 | SS/PBCH   | dBm/SCS | -85       | -78    | Power       |
|    |           |         |           |        | levels are  |
|    | SSS EPRE  |         |           |        | such that   |
|    |           |         |           |        | entry       |
|    |           |         |           |        | condition   |
|    |           |         |           |        | for event   |
|    |           |         |           |        | A3 is       |
|    |           |         |           |        | satisfied   |
|    |           |         |           |        | for the     |
|    |           |         |           |        | neighbour   |
|    |           |         |           |        | NR cell.    |
+----+-----------+---------+-----------+--------+-------------+

Table 8.1.6.1.4.3.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+--------+-------------+
|    | Parameter | Unit    | NR Cell 1 | NR     | Remark      |
|    |           |         |           |        |             |
|    |           |         |           | Cell 3 |             |
+====+===========+=========+===========+========+=============+
| T0 | SS/PBCH   | dBm/SCS | -91       | -100   | Power       |
|    |           |         |           |        | levels are  |
|    | SSS EPRE  |         |           |        | such that   |
|    |           |         |           |        | entry       |
|    |           |         |           |        | condition   |
|    |           |         |           |        | for event   |
|    |           |         |           |        | A3 is not   |
|    |           |         |           |        | satisfied   |
|    |           |         |           |        | for the     |
|    |           |         |           |        | neighbour   |
|    |           |         |           |        | NR cell.    |
+----+-----------+---------+-----------+--------+-------------+
| T1 | SS/PBCH   | dBm/SCS | -91       | -82    | Power       |
|    |           |         |           |        | levels are  |
|    | SSS EPRE  |         |           |        | such that   |
|    |           |         |           |        | entry       |
|    |           |         |           |        | condition   |
|    |           |         |           |        | for event   |
|    |           |         |           |        | A3 is       |
|    |           |         |           |        | satisfied   |
|    |           |         |           |        | for the     |
|    |           |         |           |        | neighbour   |
|    |           |         |           |        | NR cell.    |
+----+-----------+---------+-----------+--------+-------------+

Table 8.1.6.1.4.3.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | Void        | \-          | \-          | \-      | \- |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             |             |         |    |
|       | an          |             | *RRCSe      |         |    |
|       | *RRCSe      |             | tupRequest* |         |    |
|       | tupRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The SS      | \-          | \-          | \-      | \- |
|       | waits for 2 |             |             |         |    |
|       | sec to      |             |             |         |    |
|       | ensure that |             |             |         |    |
|       | the UE      |             |             |         |    |
|       | detects     |             |             |         |    |
|       | T300        |             |             |         |    |
|       | expiry.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | Void        | \-          | \-          | \-      | \- |
+-------+-------------+-------------+-------------+---------+----+
| 6     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7-8   | Steps 2 to  | \-          | \-          | \-      | \- |
|       | 3 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | radio       |             |             |         |    |
|       | bearer      |             |             |         |    |
|       | es          |             |             |         |    |
|       | tablishment |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 1.          |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 9     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | RRCSe       |         |    |
|       | an          |             | tupComplete |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             | 5GMM:       |         |    |
|       | message and |             | SERVICE     |         |    |
|       | a SERVICE   |             | REQUEST     |         |    |
|       | REQUEST     |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 10-13 | Steps 5 to  | \-          | \-          | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | radio       |             |             |         |    |
|       | bearer      |             |             |         |    |
|       | es          |             |             |         |    |
|       | tablishment |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 1.          |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRecon   |         |    |
|       | an          |             | figuration* |         |    |
|       | *RRCRecon   |             |             |         |    |
|       | figuration* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | configure   |             |             |         |    |
|       | m           |             |             |         |    |
|       | easurement. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | UE transmit | \--\>       | NR RRC:     | \-      | \- |
|       | an          |             | *RRCRe      |         |    |
|       | *RRCRe      |             | configurati |         |    |
|       | configurati |             | onComplete* |         |    |
|       | onComplete* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | confirm the |             |             |         |    |
|       | measurement |             |             |         |    |
|       | con         |             |             |         |    |
|       | figuration. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | The SS      | \-          | \-          | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1 and  |             |             |         |    |
|       | NR Cell 3   |             |             |         |    |
|       | parameters  |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\"in    |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.4   |             |             |         |    |
|       | .3.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 17    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits a |             |             |         |    |
|       | *Measure    |             | *Measure    |         |    |
|       | mentReport* |             | mentReport* |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 18    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCRecon   |         |    |
|       | an          |             | figuration* |         |    |
|       | *RRCRecon   |             |             |         |    |
|       | figuration* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | order the   |             |             |         |    |
|       | UE to       |             |             |         |    |
|       | perform     |             |             |         |    |
|       | handover to |             |             |         |    |
|       | NR Cell 3.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 19    | Check: Dose | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *RRCRe      |         |    |
|       | transmit an |             | configurati |         |    |
|       | *RRCRe      |             | onComplete* |         |    |
|       | configurati |             |             |         |    |
|       | onComplete* |             |             |         |    |
|       | message     |             |             |         |    |
|       | containing  |             |             |         |    |
|       | *con        |             |             |         |    |
|       | nEstFailInf |             |             |         |    |
|       | oAvailable* |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 3?          |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | sends a     |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | get         |             |             |         |    |
|       | *connEstF   |             |             |         |    |
|       | ailReport*. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 21    | The UE send | \--\>       | NR RRC:     | \-      | \- |
|       | a           |             | *           |         |    |
|       | *           |             | UEInformati |         |    |
|       | UEInformati |             | onResponse* |         |    |
|       | onResponse* |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | *connEstF   |             |             |         |    |
|       | ailReport.* |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.4.3.3.3 Specific message contents {#specific-message-contents-77 .H6}

Table 8.1.6.1.4.3.3.3-1: Void

Table 8.1.6.1.4.3.3.3-1A: *RRCSetupComplete* (step 9, Table
8.1.6.1.4.3.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                                                                   
  ---------------------------------------------------- ------------------------------------------------- ------------- ---------------
  **Information Element**                              **Value/remark**                                  **Comment**   **Condition**
  RRCSetupComplete ::= SEQUENCE {                                                                                      
  criticalExtensions CHOICE {                                                                                          
  rrcSetupComplete SEQUENCE {                                                                                          
  nonCriticalExtension SEQUENCE {                                                                                      
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition CEF                 
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    
  }                                                                                                                    

Table 8.1.6.1.4.3.3.3-2: *RRCReconfiguration* (step 14, Table
8.1.6.1.4.3.3.2-3)

  --------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-13, condition MEAS
  --------------------------------------------------------------------

Table 8.1.6.1.4.3.3.3-3: *MeasConfig* (Table 8.1.6.1.4.3.3.3-2)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.3-69                                                                                                         
  ------------------------------------------------------------------------------------------- ------------------------------------------------ ------------- ---------------
  **Information Element**                                                                     **Value/remark**                                 **Comment**   **Condition**
  MeasConfig ::= SEQUENCE {                                                                                                                                  
  measObjectToAddModList SEQUENCE (SIZE (1..maxObjectId)) OF MeasObjectToAddMod {             2 entries                                                      
  MeasObjectToAddMod\[1\] SEQUENCE {                                                                                                           entry 1       
  measObjectId                                                                                1                                                              
  measObject CHOICE {                                                                                                                                        
  measObjectNR SEQUENCE {                                                                                                                                    
  ssbFrequency                                                                                ssbFrequency IE equals the ARFCN for NR Cell 3                 
  absThreshSS-BlocksConsolidation                                                             Not present                                                    
  }                                                                                                                                                          
  }                                                                                                                                                          
  MeasObjectToAddMod\[2\] SEQUENCE {                                                                                                           entry 2       
  measObjectId                                                                                2                                                              
  measObject CHOICE {                                                                                                                                        
  measObjectNR SEQUENCE {                                                                                                                                    
  ssbFrequency                                                                                ssbFrequency IE equals the ARFCN for NR Cell 1                 
  absThreshSS-BlocksConsolidation                                                             Not present                                                    
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          
  reportConfigToAddModList SEQUENCE (SIZE (1..maxReportConfigId)) OF ReportConfigToAddMod {   1 entry                                                        
  ReportConfigToAddMod\[1\] SEQUENCE {                                                                                                         entry 1       
  reportConfigId                                                                              1                                                              
  reportConfig CHOICE {                                                                                                                                      
  reportConfigNR                                                                              ReportConfigNR-EventA3                                         
  }                                                                                                                                                          
  }                                                                                                                                                          
  MeasIdToAddModList::= SEQUENCE (SIZE (1..maxNrofMeasId)) OF MeasIdToAddMod {                1 entry                                                        
  MeasIdToAddMod\[1\] SEQUENCE {                                                                                                               entry 1       
  measId                                                                                      1                                                              
  measObjectId                                                                                1                                                              
  reportConfigId                                                                              1                                                              
  }                                                                                                                                                          
  }                                                                                                                                                          
  }                                                                                                                                                          

Table 8.1.6.1.4.3.3.3-3A: *ReportConfigNR-EventA3* (Table
8.1.6.1.4.3.3.3-3)

+-----------------+-----------------+-----------------+-----------+
| Derivation      |                 |                 |           |
| Path: TS        |                 |                 |           |
| 38.508-1 \[4\]  |                 |                 |           |
| Table 4.6.3-142 |                 |                 |           |
| with condition  |                 |                 |           |
| EVENT\_A3       |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Information     | Value/remark    | Comment         | Condition |
| Element         |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| ReportConfigNR  |                 |                 |           |
| ::= SEQUENCE {  |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportType      |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventTriggered  |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventId CHOICE  |                 |                 |           |
| {               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| eventA3         |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| a3-Offset       |                 |                 |           |
| CHOICE {        |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Rsrp            | 2               | 1 dB (2\*0.5    | FR1       |
|                 |                 | dB)             |           |
+-----------------+-----------------+-----------------+-----------+
|                 | 2+ Delta(NRf2)  | a3-Offset value | FR2       |
|                 | - Delta(NRf1)   | set to (2+      |           |
|                 |                 | Delta(NRf2) -   |           |
|                 |                 | Delta(NRf1)).   |           |
|                 |                 |                 |           |
|                 |                 | (Note 1)        |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| reportAmount    | r1              |                 |           |
+-----------------+-----------------+-----------------+-----------+
| rep             |                 |                 |           |
| ortQuantityCell |                 |                 |           |
| SEQUENCE {      |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Rsrp            | true            |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Rsrq            | false           |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Sinr            | false           |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| }               |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+
| Note 1:         |                 |                 |           |
| Delta(NRf2) and |                 |                 |           |
| Delta(NRf1) are |                 |                 |           |
| derived based   |                 |                 |           |
| on calibration  |                 |                 |           |
| procedure       |                 |                 |           |
| defined in the  |                 |                 |           |
| TS 38.508-1     |                 |                 |           |
| \[4\], clause   |                 |                 |           |
| 6.1.3.3 where   |                 |                 |           |
| Delta(NRf1) is  |                 |                 |           |
| derived for the |                 |                 |           |
| carrier of NR   |                 |                 |           |
| PCell and       |                 |                 |           |
| Delta(NRf2) is  |                 |                 |           |
| derived for the |                 |                 |           |
| carrier of      |                 |                 |           |
| neighbour cell. |                 |                 |           |
+-----------------+-----------------+-----------------+-----------+

Table 8.1.6.1.4.3.3.3-4: *MeasurementReport* (step 17, Table
8.1.6.1.4.3.3.3-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-5A                                                                                                   
  ----------------------------------------------------------------------------------------- ------------------------------------------- ------------- ---------------
  **Information Element**                                                                   **Value/remark**                            **Comment**   **Condition**
  MeasurementReport ::= SEQUENCE {                                                                                                                    
  criticalExtensions ::= CHOICE {                                                                                                                     
  measurementReport ::= SEQUENCE {                                                                                                                    
  measResults ::= SEQUENCE {                                                                                                                          
  measId                                                                                    1                                                         
  measResultServingMOList SEQUENCE (SIZE (1.. maxNrofServingCells)) OF MeasResultServMO {   1 entry                                                   
  MeasResultServMO\[1\] SEQUENCE {                                                                                                      entry 1       
  servCellId                                                                                Cell index corresponding to NR Cell 1                     
  measResultServingCell SEQUENCE {                                                                                                                    
  physCellId                                                                                PhysicalCellIdentity of NR Cell 1                         
  measResult SEQUENCE {                                                                                                                               
  cellResults SEQUENCE {                                                                                                                              
  resultsSSB-Cell SEQUENCE {                                                                                                                          
  rsrp                                                                                      (0..127)                                                  
  rsrq                                                                                      (0..127)                                                  
  sinr                                                                                      Not checked                                               
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  measResultNeighCells CHOICE {                                                                                                                       
  measResultListNR SEQUENCE (SIZE (1.. maxCellReport)) OF MeasResultNR {                    1 entry                                                   
  MeasResultNR\[1\] SEQUENCE {                                                                                                                        
  physCellId                                                                                Physical layer cell identity of NR Cell 3                 
  measResult SEQUENCE {                                                                                                                               
  cellResults SEQUENCE {                                                                                                                              
  rsrp                                                                                      (0..127)                                                  
  rsrq                                                                                      Not present                                               
  sinr                                                                                      Not present                                               
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   
  }                                                                                                                                                   

Table 8.1.6.1.4.3.3.3-5: *RRCReconfiguration* (step 18, Table
8.1.6.1.4.3.3.2-3)

  -------------------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.8.1-1A, condition RBConfig\_NoKeyChange
  -------------------------------------------------------------------------------------

Table 8.1.6.1.4.3.3.3-6: *RRCReconfigurationComplete* (step 19, Table
8.1.6.1.4.3.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-14                                                                   
  --------------------------------------------------- ------------------------------------------------- ------------- ---------------
  **Information Element**                             **Value/remark**                                  **Comment**   **Condition**
  RRCReconfigurationComplete ::= SEQUENCE {                                                                           
  criticalExtensions CHOICE {                                                                                         
  rrcReconfigurationComplete SEQUENCE {                                                                               
  nonCriticalExtension SEQUENCE {                                                                                     
  nonCriticalExtension SEQUENCE {                                                                                     
  nonCriticalExtension SEQUENCE {                                                                                     
  ue-MeasurementsAvailable-r16                        UE-MeasurementsAvailable-r16 with condition CEF                 
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   

###### 8.1.6.1.4.4 Connection Establishment Failure / Logging and reporting / Reporting at RRC connection re-establishment

##### 8.1.6.1.4.4.1 Test Purpose (TP) {#test-purpose-tp-78 .H6}

##### (1) {#section-152 .H6}

**with** { UE has connection establishment failure information available
}

**ensure that** {

**when** { UE performs an RRC Connection re-establishment procedure }

**then** { UE sends an RRCReestablishmentComplete message with
connEstFailInfoAvailable }

}

##### 8.1.6.1.4.4.2 Conformance requirements {#conformance-requirements-80 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.7.5. Unless otherwise stated these
are Rel-16 requirements.

\[TS 38.331, clause 5.3.7.5\]

The UE shall:

...

1\> set the content of *RRCReestablishmentComplete* message as follows:

2\> if the UE has logged measurements available for NR and if the RPLMN
is included in *plmn-IdentityList* stored in *VarLogMeasReport*:

3\> include the *logMeasAvailable in the RRCReestablishmentComplete*
message;

...

2\> if the UE has connection establishment failure or connection resume
failure information available in *VarConnEstFailReport* and if the RPLMN
is equal to *plmn-Identity* stored in *VarConnEstFailReport*:

3\> include *connEstFailInfoAvailable in the RRCReestablishmentComplete*
message;

##### 8.1.6.1.4.4.3 Test description {#test-description-76 .H6}

##### 8.1.6.1.4.4.3.1 Pre-test conditions {#pre-test-conditions-77 .H6}

##### System Simulator: {#system-simulator-56 .H6}

\- NR Cell 1 and Cell 2.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-65 .H6}

\- None.

##### Preamble: {#preamble-65 .H6}

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.6.1.4.4.3.2 Test procedure sequence {#test-procedure-sequence-77 .H6}

Table 8.1.6.1.4.4.3.2-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.4.4.3.2-1: Time instances of cell power level and
parameter changes (FR1)

+----------+----------+---------+----------+----------+----------+
|          | P        | Unit    | NR Cell  | NR Cell  | Remark   |
|          | arameter |         | 1        | 2        |          |
+==========+==========+=========+==========+==========+==========+
| T0       | SS/PBCH  | dBm/SCS | -80      | "Off"    | Only NR  |
|          |          |         |          |          | Cell 1   |
|          | SSS EPRE |         |          |          | is       |
|          |          |         |          |          | av       |
|          |          |         |          |          | ailable. |
|          |          |         |          |          |          |
|          |          |         |          |          | (NOTE    |
|          |          |         |          |          | 1).      |
+----------+----------+---------+----------+----------+----------+
| T1       | SS/PBCH  | dBm/SCS | "Off"    | -80      | Only NR  |
|          |          |         |          |          | Cell 2   |
|          | SSS EPRE |         |          |          | is       |
|          |          |         |          |          | av       |
|          |          |         |          |          | ailable. |
|          |          |         |          |          |          |
|          |          |         |          |          | (NOTE    |
|          |          |         |          |          | 1).      |
+----------+----------+---------+----------+----------+----------+
| NOTE 1:  |          |         |          |          |          |
| Power    |          |         |          |          |          |
| level    |          |         |          |          |          |
| "Off"    |          |         |          |          |          |
| cor      |          |         |          |          |          |
| responds |          |         |          |          |          |
| to       |          |         |          |          |          |
| "Non-    |          |         |          |          |          |
| suitable |          |         |          |          |          |
| \"Off\"  |          |         |          |          |          |
| cell" as |          |         |          |          |          |
| defined  |          |         |          |          |          |
| in TS    |          |         |          |          |          |
| 38.50    |          |         |          |          |          |
| 8-1\[4\] |          |         |          |          |          |
| Table    |          |         |          |          |          |
| 6.       |          |         |          |          |          |
| 2.2.1-3. |          |         |          |          |          |
+----------+----------+---------+----------+----------+----------+

Table 8.1.6.1.4.4.3.2-2: Time instances of cell power level and
parameter changes (FR2)

+----------+----------+---------+----------+----------+----------+
|          | P        | Unit    | NR Cell  | NR Cell  | Remark   |
|          | arameter |         | 1        | 2        |          |
+==========+==========+=========+==========+==========+==========+
| T0       | SS/PBCH  | dBm/SCS | -82      | "Off"    | Only NR  |
|          |          |         |          |          | Cell 1   |
|          | SSS EPRE |         |          |          | is       |
|          |          |         |          |          | av       |
|          |          |         |          |          | ailable. |
|          |          |         |          |          |          |
|          |          |         |          |          | (NOTE    |
|          |          |         |          |          | 1).      |
+----------+----------+---------+----------+----------+----------+
| T1       | SS/PBCH  | dBm/SCS | "Off"    | -82      | Only NR  |
|          |          |         |          |          | Cell 2   |
|          | SSS EPRE |         |          |          | is       |
|          |          |         |          |          | av       |
|          |          |         |          |          | ailable. |
|          |          |         |          |          |          |
|          |          |         |          |          | (NOTE    |
|          |          |         |          |          | 1).      |
+----------+----------+---------+----------+----------+----------+
| NOTE 1:  |          |         |          |          |          |
| Power    |          |         |          |          |          |
| level    |          |         |          |          |          |
| "Off"    |          |         |          |          |          |
| cor      |          |         |          |          |          |
| responds |          |         |          |          |          |
| to       |          |         |          |          |          |
| "Non-    |          |         |          |          |          |
| suitable |          |         |          |          |          |
| \"Off\"  |          |         |          |          |          |
| cell" as |          |         |          |          |          |
| defined  |          |         |          |          |          |
| in TS    |          |         |          |          |          |
| 38.50    |          |         |          |          |          |
| 8-1\[4\] |          |         |          |          |          |
| Table    |          |         |          |          |          |
| 6.2.     |          |         |          |          |          |
| 2.2.2-2. |          |         |          |          |          |
+----------+----------+---------+----------+----------+----------+

Table 8.1.6.1.4.4.3.2-3: Main behaviour

+------+-------------+-------------+-------------+---------+----+
| St   | Procedure   | Message     | TP          | Verdict |    |
|      |             | Sequence    |             |         |    |
+======+=============+=============+=============+=========+====+
|      |             | U - S       | Message     |         |    |
+------+-------------+-------------+-------------+---------+----+
| 1    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits a |             | *Paging*    |         |    |
|      | *Paging*    |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 2    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | transmits   |             | *RRCSe      |         |    |
|      | an          |             | tupRequest* |         |    |
|      | *RRCSe      |             |             |         |    |
|      | tupRequest* |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 3    | The SS      | \-          | \-          | \-      | \- |
|      | waits for 2 |             |             |         |    |
|      | sec to      |             |             |         |    |
|      | ensure that |             |             |         |    |
|      | the UE      |             |             |         |    |
|      | detects     |             |             |         |    |
|      | T300        |             |             |         |    |
|      | expiry.     |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 4-6  | Steps 1 to  | \-          | \-          | \-      | \- |
|      | 3 of the    |             |             |         |    |
|      | generic     |             |             |         |    |
|      | radio       |             |             |         |    |
|      | bearer      |             |             |         |    |
|      | es          |             |             |         |    |
|      | tablishment |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | in TS       |             |             |         |    |
|      | 38.508-1    |             |             |         |    |
|      | table       |             |             |         |    |
|      | 4.5.4.2-3   |             |             |         |    |
|      | on NR Cell  |             |             |         |    |
|      | 1.          |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 7    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | transmits   |             | *RRCSet     |         |    |
|      | an          |             | upComplete* |         |    |
|      | *RRCSet     |             |             |         |    |
|      | upComplete* |             |             |         |    |
|      | message and |             |             |         |    |
|      | a SERVICE   |             |             |         |    |
|      | REQUEST     |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 8-11 | Steps 5 to  | \-          | \-          | \-      | \- |
|      | 8 of the    |             |             |         |    |
|      | generic     |             |             |         |    |
|      | radio       |             |             |         |    |
|      | bearer      |             |             |         |    |
|      | es          |             |             |         |    |
|      | tablishment |             |             |         |    |
|      | procedure   |             |             |         |    |
|      | in TS       |             |             |         |    |
|      | 38.508-1    |             |             |         |    |
|      | table       |             |             |         |    |
|      | 4.5.4.2-3   |             |             |         |    |
|      | on NR Cell  |             |             |         |    |
|      | 1.          |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 12   | The SS      | \-          |             | \-      | \- |
|      | changes     |             |             |         |    |
|      | Cell 1 and  |             |             |         |    |
|      | Cell 2      |             |             |         |    |
|      | parameters  |             |             |         |    |
|      | according   |             |             |         |    |
|      | to the row  |             |             |         |    |
|      | \"T1\" in   |             |             |         |    |
|      | table       |             |             |         |    |
|      | 8.1.6.1.4   |             |             |         |    |
|      | .4.3.2-1/2. |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 13   | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | transmits   |             |             |         |    |
|      | an          |             | *RRCR       |         |    |
|      | *RRCR       |             | eestablishm |         |    |
|      | eestablishm |             | entRequest* |         |    |
|      | entRequest* |             |             |         |    |
|      | message on  |             |             |         |    |
|      | Cell 2.     |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 14   | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits   |             |             |         |    |
|      | an          |             | *RRCReest   |         |    |
|      | *RRCReest   |             | ablishment* |         |    |
|      | ablishment* |             |             |         |    |
|      | message on  |             |             |         |    |
|      | Cell 2.     |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 15   | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|      | the UE send |             |             |         |    |
|      | an          |             | *RRCRe      |         |    |
|      | *RRCRe      |             | establishme |         |    |
|      | establishme |             | ntComplete* |         |    |
|      | ntComplete* |             |             |         |    |
|      | message     |             |             |         |    |
|      | with        |             |             |         |    |
|      | *con        |             |             |         |    |
|      | nEstFailInf |             |             |         |    |
|      | oAvailable* |             |             |         |    |
|      | on Cell 2?  |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 16   | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | transmits   |             | RRCReco     |         |    |
|      | an          |             | nfiguration |         |    |
|      | RRCReco     |             |             |         |    |
|      | nfiguration |             |             |         |    |
|      | message to  |             |             |         |    |
|      | establish   |             |             |         |    |
|      | SRB2 and    |             |             |         |    |
|      | DRB.        |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 17   | The UE      | \--\>       | NR RRC:     | \-      | \- |
|      | transmits   |             | RRCRe       |         |    |
|      | an          |             | configurati |         |    |
|      | RRCRe       |             | ontComplete |         |    |
|      | configurati |             |             |         |    |
|      | ontComplete |             |             |         |    |
|      | message.    |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 18   | The SS      | \<\--       | NR RRC:     | \-      | \- |
|      | sends a     |             | *UEInformat |         |    |
|      | *UEInformat |             | ionRequest* |         |    |
|      | ionRequest* |             |             |         |    |
|      | message to  |             |             |         |    |
|      | get         |             |             |         |    |
|      | *connEst    |             |             |         |    |
|      | FailReport* |             |             |         |    |
|      | and         |             |             |         |    |
|      | *r          |             |             |         |    |
|      | lf-Report*. |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+
| 19   | The UE send | \--\>       | NR RRC:     | \-      | \- |
|      | a           |             | *           |         |    |
|      | *           |             | UEInformati |         |    |
|      | UEInformati |             | onResponse* |         |    |
|      | onResponse* |             |             |         |    |
|      | message     |             |             |         |    |
|      | with        |             |             |         |    |
|      | *connEs     |             |             |         |    |
|      | tFailReport |             |             |         |    |
|      | and         |             |             |         |    |
|      | r           |             |             |         |    |
|      | lf-Report.* |             |             |         |    |
+------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.4.4.3.3 Specific message contents {#specific-message-contents-78 .H6}

Table 8.1.6.1.4.4.3.3-1: *RRCSetupComplete* (step 7, Table
8.1.6.1.4.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-22                                                                   
  --------------------------------------------------- ------------------------------------------------- ------------- ---------------
  **Information Element**                             **Value/remark**                                  **Comment**   **Condition**
  RRCSetupComplete ::= SEQUENCE {                                                                                     
  criticalExtensions CHOICE {                                                                                         
  rrcSetupComplete SEQUENCE{                                                                                          
  nonCriticalExtension EQUENCE{                                                                                       
  ue-MeasurementsAvailable-r16                        UE-MeasurementsAvailable-r16 with condition CEF                 
  }                                                                                                                   
  }                                                                                                                   
  }                                                                                                                   

Table 8.1.6.1.4.4.3.3-2: *RRCReestablishmentRequest* (step 13, Table
8.1.6.1.4.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-12                            
  --------------------------------------------------- -------------- --------- -----------
  Information Element                                 Value/remark   Comment   Condition
  RRCReestablishmentRequest ::= SEQUENCE {                                     
  reestablishmentCause                                otherFailure             

Table 8.1.6.1.4.4.3.3-3: *RRCReestablishmentComplete* (step 15, Table
8.1.6.1.4.4.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-11                                                                           
  --------------------------------------------------- --------------------------------------------------------- ------------- ---------------
  **Information Element**                             **Value/remark**                                          **Comment**   **Condition**
  RRCReestablishmentComplete ::= SEQUENCE {                                                                                   
  criticalExtensions CHOICE {                                                                                                 
  rrcReestablishmentComplete SEQUENCE {                                                                                       
  nonCriticalExtension SEQUENCE {                                                                                             
  ue-MeasurementsAvailable-r16                        UE-MeasurementsAvailable-r16 with condition CEF and RLF                 
  }                                                                                                                           
  }                                                                                                                           
  }                                                                                                                           
  }                                                                                                                           

Table 8.1.6.1.4.4.3.3-4: *UEInformationRequest* (step 18, Table
8.1.6.1.4.4.3.2-3)

  ------------------------------------------------------------------------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32A with condition RLF
  ------------------------------------------------------------------------

###### 8.1.6.1.4.5 Connection Establishment Failure / Logging and reporting / Location Information

##### 8.1.6.1.4.5.1 Test Purpose (TP) {#test-purpose-tp-79 .H6}

##### (1) {#section-153 .H6}

**with** { UE has connection establishment failure information available
with location information }

**ensure that** {

**when** { UE receives the UEInformationRequest message containing
connEstFailReportReq }

**then** { UE sends the UEInformationResponse message containing
connEstFailReport with CommonLocationInfo }

}

##### 8.1.6.1.4.5 Conformance requirements {#conformance-requirements-81 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.7, 5.7.10.3 and 6.3.2. Unless
otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *connEstFailReportReq* is set to *true* and the UE has connection
establishment failure or connection resume failure information in
*VarConnEstFailReport* and if the RPLMN is equal to *plmn-Identity*
stored in *VarConnEstFailReport*:

2\> set *timeSinceFailure* in *VarConnEstFailReport* to the time that
elapsed since the last connection establishment failure or connection
resume failure in NR;

2\> set the *connEstFailReport* in the *UEInformationResponse* message
to the value of *connEstFailReport* in *VarConnEstFailReport*;

2\> discard the *connEstFailReport* from *VarConnEstFailReport* upon
successful delivery of the *UEInformationResponse* message confirmed by
lower layers;

\[TS 38.331, clause 5.3.3.7\]

The UE shall:

1\> if timer T300 expires:

...

2\> store the following connection establishment failure information in
the *VarConnEstFailReport* by setting its fields as follows:

...

3\> if available, set the *locationInfo* as follows:

4\> if available, set the *commonLocationInfo* to include the detailed
location information;

\[TS 38.331, clause 6.3.2\]

The IE *CommonLocationInfo* is used to transfer detailed location
information available at the UE to correlate measurements and UE
position information.

+----------------------------------------------------------------------+
| *CommonLocationInfo* field descriptions                              |
+======================================================================+
| ***LocationTimeStamp***                                              |
|                                                                      |
| Parameter type DisplacementTimeStamp defined in TS 37.355 \[49\].    |
| The first/leftmost bit of the first octet contains the most          |
| significant bit.                                                     |
+----------------------------------------------------------------------+
| ***locationCoordinate***                                             |
|                                                                      |
| Parameter type LocationCoordinates defined in TS 37.355 \[49\]. The  |
| first/leftmost bit of the first octet contains the most significant  |
| bit.                                                                 |
+----------------------------------------------------------------------+
| ***locationError***                                                  |
|                                                                      |
| Parameter LocationError defined in TS 37.355 \[49\]. The             |
| first/leftmost bit of the first octet contains the most significant  |
| bit.                                                                 |
+----------------------------------------------------------------------+
| ***locationSource***                                                 |
|                                                                      |
| Parameter LocationSource defined in TS 37.355 \[49\]. The            |
| first/leftmost bit of the first octet contains the most significant  |
| bit.                                                                 |
+----------------------------------------------------------------------+
| ***velocityEstimate***                                               |
|                                                                      |
| Parameter type Velocity defined in TS 37.355 \[49\]. The             |
| first/leftmost bit of the first octet contains the most significant  |
| bit.                                                                 |
+----------------------------------------------------------------------+

##### 8.1.6.1.4.5.3 Test description {#test-description-77 .H6}

##### 8.1.6.1.4.5.3.1 Pre-test conditions {#pre-test-conditions-78 .H6}

##### System Simulator: {#system-simulator-57 .H6}

\- NR Cell 1

##### UE: {#ue-66 .H6}

\- None.

##### Preamble: {#preamble-66 .H6}

\- The UE\'s positioning engine (e.g. standalone GNSS receiver) should
be provided with any necessary stimulus to allow it to provide the
position. This shall be done by use of the test function Update UE
Location Information defined in TS 38.509 \[6\], if supported by the UE
according to pc\_UpdateUE\_LocationInformation. Otherwise, or in
addition any other suitable method may also be used.

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], subclause
4.4A.

##### 8.1.6.1.4.5.3.2 Test procedure sequence {#test-procedure-sequence-78 .H6}

Table 8.1.6.1.4.5.3.2-1: Main behaviour

  St      Procedure                                                                                                                           Message Sequence   TP                                Verdict   
  ------- ----------------------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- --------- ----
                                                                                                                                              U - S              Message                                     
  1       Void                                                                                                                                \-                 \-                                \-        \-
  2       The SS transmits a *Paging* message.                                                                                                \<\--              NR RRC: *Paging*                  \-        \-
  3       The UE transmits an *RRCSetupRequest* message.                                                                                      \--\>              NR RRC: *RRCSetupRequest*         \-        \-
  4       The SS waits for 2sec to ensure that the UE detects T300 expiry.                                                                    \-                 \-                                \-        \-
  5       Void                                                                                                                                \-                 \-                                \-        \-
  6-8     Steps 1 to 3 of the generic radio bearer establishment procedure in TS 38.508-1 table 4.5.4.2-3.                                    \-                 \-                                \-        \-
  9       The UE transmits an RRCSetupComplete message and a SERVICE REQUEST message.                                                         \--\>              NR RRC: *RRCSetupComplete*        \-        \-
  10-13   Steps 5 to 8 of the generic radio bearer establishment procedure in TS 38.508-1 table 4.5.4.2-3.                                    \-                 \-                                \-        \-
  14      The SS sends a *UEInformationRequest* message to get *connEstFailReportReq*.                                                        \<\--              NR RRC: *UEInformationRequest*    \-        \-
  15      Check: Does the UE send a *UEInformationResponse message with connEstFailReport with the IE commonLocationInfo-r16* is present*?*   \--\>              NR RRC: *UEInformationResponse*   1         P

##### 8.1.6.1.4.5.3.3 Specific message contents {#specific-message-contents-79 .H6}

Table 8.1.6.1.4.5.3.3-1: *RRCSetupComplete* (step 9, Table
8.1.6.1.4.5.3.2-1)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition CEF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.4.5.3.3-2: Void

Table 8.1.6.1.4.5.3.3-3: *UEInformationResponse* (step 15, Table
8.1.6.1.4.5.3.2-1)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-32B                                                                                 
  -------------------------------------------------------------------------------------------- --------------------------- --------- -----------
  Information Element                                                                          Value/remark                Comment   Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                           
  rrc-TransactionIdentifier                                                                    RRC-TransactionIdentifier             
  criticalExtensions CHOICE {                                                                                                        
  ueInformationResponse-r16 SEQUENCE {                                                                                               
  connEstFailReport-r16 SEQUENCE {                                                                                                   
  measResultFailedCell-r16 SEQUENCE {                                                                                                
  cgi-Info SEQUENCE {                                                                                                                
  plmn-Identity-r16                                                                            Any allowed value                     
  cellIdentity-r16                                                                             Any allowed value                     
  trackingAreaCode-r16                                                                         Not checked                           
  }                                                                                                                                  
  measResult-r16 SEQUENCE {                                                                                                          
  cellResults-r16 SEQUENCE {                                                                                                         
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                     
  rsrp                                                                                         Not checked                           
  rsrq                                                                                         Not checked                           
  sinr                                                                                         Not checked                           
  }                                                                                                                                  
  }                                                                                                                                  
  rsIndexResults-r16 SEQUENCE {                                                                                                      
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index   1 entry                               
  ssb-Index                                                                                    Any allowed value                     
  ssb-Results SEQUENCE {                                                                                                             
  rsrp                                                                                         Not checked                           
  rsrq                                                                                         Not checked                           
  sinr                                                                                         Not checked                           
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  
  locationInfo-r16 SEQUENCE {                                                                                                        
  commonLocationInfo-r16                                                                       Any allowed value                     
  bt-LocationInfo-r16                                                                          Not present                           
  wlan-LocationInfo-r16                                                                        Not present                           
  sensor-LocationInfo-r16                                                                      Not present                           
  }                                                                                                                                  
  measResultNeighCells-r16 SEQUENCE {                                                                                                
  measResultNeighCellListNR                                                                    Not present                           
  measResultNeighCellListEUTRA                                                                 Not present                           
  }                                                                                                                                  
  numberOfConnFail-r16                                                                         Any allowed value                     
  perRAInfoList-r16                                                                            Any allowed value                     
  timeSinceFailure-r16                                                                         Any allowed value                     
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  
  }                                                                                                                                  

###### 8.1.6.1.4.6 Connection Establishment Failure / Logging and reporting / Reporting of Intra-frequency measurements

##### 8.1.6.1.4.6.1 Test Purpose (TP) {#test-purpose-tp-80 .H6}

##### (1) {#section-154 .H6}

**with** { UE has connection establishment failure information available
with the intra-frequency measurement result }

**ensure that** {

**when** { UE receives a UEInformationRequest message with
connEstFailReportReq set to true }

**then** { UE sends a UEInformationResponse message containing the
measurement result for intra-frequency neighbouring cell }

}

##### 8.1.6.1.4.6.2 Conformance requirements {#conformance-requirements-82 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.7, 5.7.10.3 and 6.2.2. Unless
otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *connEstFailReportReq* is set to *true* and the UE has connection
establishment failure or connection resume failure information in
*VarConnEstFailReport* and if the RPLMN is equal to *plmn-Identity*
stored in *VarConnEstFailReport*:

2\> set *timeSinceFailure* in *VarConnEstFailReport* to the time that
elapsed since the last connection establishment failure or connection
resume failure in NR;

2\> set the *connEstFailReport* in the *UEInformationResponse* message
to the value of *connEstFailReport* in *VarConnEstFailReport*;

2\> discard the *connEstFailReport* from *VarConnEstFailReport* upon
successful delivery of the *UEInformationResponse* message confirmed by
lower layers;

\[TS 38.331, clause 5.3.3.7\]

The UE shall:

1\> if timer T300 expires:

...

2\> store the following connection establishment failure information in
the *VarConnEstFailReport* by setting its fields as follows:

...

3\> if available, set the *measResultNeighCells,* in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements for at most the following number of neighbouring
cells: 6 intra-frequency and 3 inter-frequency neighbours per frequency
as well as 3 inter-RAT neighbours, per frequency/ set of frequencies per
RAT and according to the following:

4\> for each neighbour cell included, include the optional fields that
are available;

NOTE 2: The UE includes the latest results of the available measurements
as used for cell reselection evaluation, which are performed in
accordance with the performance requirements as specified in TS 38.133
\[14\].

\[TS 38.331, clause 6.2.2\]

##### -- UEInformationResponse {#ueinformationresponse .H6}

The *UEInformationResponse* message is used by the UE to transfer
information requested by the network.

...

+----------------------------------------------------------------------+
| *ConnEstFailReport field descriptions*                               |
+======================================================================+
| ***measResultFailedCell***                                           |
|                                                                      |
| ***This field refers to the last measurement results taken in the    |
| cell, where connection establishment failure or connection resume    |
| failure happened.***                                                 |
+----------------------------------------------------------------------+
| ***measResultNeighCells***                                           |
|                                                                      |
| This field refers to the neighbour cell measurements when            |
| ***connection establishment failure or connection resume failure     |
| happened.***                                                         |
+----------------------------------------------------------------------+
| ***numberOfConnFail***                                               |
|                                                                      |
| This field is used to indicate the latest number of consecutive      |
| failed RRCSetup or RRCResume procedures in the same cell independent |
| of RRC state transition.                                             |
+----------------------------------------------------------------------+
| ***numberOfPreamblesSent***                                          |
|                                                                      |
| This field is used to indicate the number of random access preambles |
| that were transmitted.                                               |
+----------------------------------------------------------------------+
| ***timeSinceFailure***                                               |
|                                                                      |
| This field is used to indicate the time that elapsed since the       |
| connection (establishment or resume) failure. ***Value in seconds.   |
| The maximum value 172800 means 172800s or longer.***                 |
+----------------------------------------------------------------------+

##### 8.1.6.1.4.6.3 Test description {#test-description-78 .H6}

##### 8.1.6.1.4.6.3.1 Pre-test conditions {#pre-test-conditions-79 .H6}

##### System Simulator: {#system-simulator-58 .H6}

\- NR Cell 1 and Cell 2

##### UE: {#ue-67 .H6}

\- None.

##### Preamble: {#preamble-67 .H6}

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], subclause
4.4A, on cell 1.

\- System information combination NR-2 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### 8.1.6.1.4.6.3.2 Test procedure sequence {#test-procedure-sequence-79 .H6}

Table 8.1.6.1.4.6.3.2-1 illustrates the downlink power levels and other
changing parameters to be applied for the cells at various time instants
of the test execution. Row marked \"T0\" denotes the initial conditions
after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.4.6.3.2-1: Time instances of cell power level and
parameter changes (FR1)

+----------+----------+---------+----------+----------+----------+
|          | P        | Unit    | NR Cell  | NR Cell  | Remark   |
|          | arameter |         | 1        | 2        |          |
+==========+==========+=========+==========+==========+==========+
| T0       | SS/PBCH  | dBm/SCS | -85      | "Off"    | Only NR  |
|          |          |         |          |          | Cell 1   |
|          | SSS EPRE |         |          |          | is       |
|          |          |         |          |          | av       |
|          |          |         |          |          | ailable. |
|          |          |         |          |          |          |
|          |          |         |          |          | (NOTE    |
|          |          |         |          |          | 1).      |
+----------+----------+---------+----------+----------+----------+
| T1       | SS/PBCH  | dBm/SCS | -85      | -91      | The      |
|          |          |         |          |          | power    |
|          | SSS EPRE |         |          |          | level    |
|          |          |         |          |          | values   |
|          |          |         |          |          | are      |
|          |          |         |          |          | assigned |
|          |          |         |          |          | to       |
|          |          |         |          |          | satisfy  |
|          |          |         |          |          | R~       |
|          |          |         |          |          | Cell\ 1~ |
|          |          |         |          |          | \>       |
|          |          |         |          |          | R~C      |
|          |          |         |          |          | ell\ 2~. |
+----------+----------+---------+----------+----------+----------+
| NOTE 1:  |          |         |          |          |          |
| Power    |          |         |          |          |          |
| level    |          |         |          |          |          |
| "Off" is |          |         |          |          |          |
| defined  |          |         |          |          |          |
| in TS    |          |         |          |          |          |
| 38.508-1 |          |         |          |          |          |
| Table    |          |         |          |          |          |
| 6.       |          |         |          |          |          |
| 2.2.1-3. |          |         |          |          |          |
+----------+----------+---------+----------+----------+----------+

Table 8.1.6.1.4.6.3.2-2: Time instances of cell power level and
parameter changes (FR2)

+----------+----------+---------+----------+----------+----------+
|          | P        | Unit    | NR Cell  | NR Cell  | Remark   |
|          | arameter |         | 1        | 2        |          |
+==========+==========+=========+==========+==========+==========+
| T0       | SS/PBCH  | dBm/SCS | -82      | \"Off\"  | Only NR  |
|          |          |         |          |          | Cell 1   |
|          | SSS EPRE |         |          |          | is       |
|          |          |         |          |          | av       |
|          |          |         |          |          | ailable. |
|          |          |         |          |          |          |
|          |          |         |          |          | (NOTE    |
|          |          |         |          |          | 1).      |
+----------+----------+---------+----------+----------+----------+
| T1       | SS/PBCH  | dBm/SCS | -82      | -91      | The      |
|          |          |         |          |          | power    |
|          | SSS EPRE |         |          |          | level    |
|          |          |         |          |          | values   |
|          |          |         |          |          | are      |
|          |          |         |          |          | assigned |
|          |          |         |          |          | to       |
|          |          |         |          |          | satisfy  |
|          |          |         |          |          | R~       |
|          |          |         |          |          | Cell\ 1~ |
|          |          |         |          |          | \>       |
|          |          |         |          |          | R~C      |
|          |          |         |          |          | ell\ 2~. |
+----------+----------+---------+----------+----------+----------+
| NOTE 1:  |          |         |          |          |          |
| Power    |          |         |          |          |          |
| level    |          |         |          |          |          |
| "Off" is |          |         |          |          |          |
| defined  |          |         |          |          |          |
| in TS    |          |         |          |          |          |
| 38.508-1 |          |         |          |          |          |
| Table    |          |         |          |          |          |
| 6.       |          |         |          |          |          |
| 2.2.2-3. |          |         |          |          |          |
+----------+----------+---------+----------+----------+----------+

Table 8.1.6.1.4.6.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The SS      | \-          | \-          | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 1 and  |             |             |         |    |
|       | NR Cell 2   |             |             |         |    |
|       | parameter   |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | Table       |             |             |         |    |
|       | 8.1.6.1.4   |             |             |         |    |
|       | .6.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The SS      | \-          | \-          | \-      | \- |
|       | waits for   |             |             |         |    |
|       | 40s to      |             |             |         |    |
|       | ensure that |             |             |         |    |
|       | the UE      |             |             |         |    |
|       | detects     |             |             |         |    |
|       | intr        |             |             |         |    |
|       | a-frequency |             |             |         |    |
|       | cell.       |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | Void        | \-          | \-          | \-      | \- |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 6     | The SS      | \-          | \-          | \-      | \- |
|       | waits for   |             |             |         |    |
|       | 2sec to     |             |             |         |    |
|       | ensure that |             |             |         |    |
|       | the UE      |             |             |         |    |
|       | detects     |             |             |         |    |
|       | T300        |             |             |         |    |
|       | expiry.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 7     | Void        | \-          | \-          | \-      | \- |
+-------+-------------+-------------+-------------+---------+----+
| 8-10  | Steps 1 to  | \-          | \-          | \-      | \- |
|       | 3 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | radio       |             |             |         |    |
|       | bearer      |             |             |         |    |
|       | es          |             |             |         |    |
|       | tablishment |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 1.          |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 11    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSet     |         |    |
|       | an          |             | upComplete* |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             | 5GMM:       |         |    |
|       | message and |             | SERVICE     |         |    |
|       | a SERVICE   |             | REQUEST     |         |    |
|       | REQUEST     |             |             |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 1.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12-15 | Steps 5 to  | \-          | \-          | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | radio       |             |             |         |    |
|       | bearer      |             |             |         |    |
|       | es          |             |             |         |    |
|       | tablishment |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | table       |             |             |         |    |
|       | 4.5.4.2-3   |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 1.          |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | sends a     |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | get         |             |             |         |    |
|       | *connEstFa  |             |             |         |    |
|       | ilReportReq |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 1*.         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 17    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE send |             | *           |         |    |
|       | a           |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | connEs      |             |             |         |    |
|       | tFailReport |             |             |         |    |
|       | on NR Cell  |             |             |         |    |
|       | 1?*         |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.4.6.3.3 Specific message contents {#specific-message-contents-80 .H6}

Table 8.1.6.1.4.6.3.3-1: *RRCSetupComplete* (step 11, Table
8.1.6.1.4.6.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-22                                                               
  --------------------------------------------------- ------------------------------------------------- --------- -----------
  Information Element                                 Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                 
  criticalExtensions CHOICE {                                                                                     
  rrcSetupComplete SEQUENCE {                                                                                     
  nonCriticalExtension SEQUENCE {                                                                                 
  ue-MeasurementsAvailable-r16                        UE-MeasurementsAvailable-r16 with condition CEF             
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               
  }                                                                                                               

Table 8.1.6.1.4.6.3.3-2: Void

Table 8.1.6.1.4.6.3.3-3: *UEInformationResponse* (step 17, Table
8.1.6.1.4.6.3.2-3)

  Derivation Path: TS 38.508-1 \[4\] Table 4.6.1-32B                                                                                                                                                                                                                                         
  ---------------------------------------------------------------------------------------------- ------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------- -----------
  Information Element                                                                            Value/remark                                                  Comment                                                                                                                       Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                                                                                                   
  criticalExtensions CHOICE {                                                                                                                                                                                                                                                                
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                                                                                       
  connEstFailReport-r16 SEQUENCE {                                                                                                                                                                                                                                                           
  measResultFailedCell-r16 SEQUENCE {                                                                                                                                                                                                                                                        
  CGI-Info-Logging-r16 SEQUENCE {                                                                                                                              Information of NR Cell 2                                                                                                      
  plmn-Identity-r16                                                                              the same MCC and MNC stored in EFIMSI on the test USIM card                                                                                                                                 
  cellIdentity-r16                                                                               NR Cell 1                                                                                                                                                                                   
  trackingAreaCode-r16                                                                           1                                                                                                                                                                                           
  }                                                                                                                                                                                                                                                                                          
  measResult-r16 SEQUENCE {                                                                                                                                                                                                                                                                  
  cellResults-r16 SEQUENCE {                                                                                                                                   Measurement result of NR Cell 2                                                                                               
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                                                                                                                                                                             
  rsrp                                                                                           as specified in TS 38.508-1 Table 4.6.3-152                   Integer value for RSRP measurements                                                                                           
  rsrq                                                                                           as specified in TS 38.508-1 Table 4.6.3-153                   Integer value for RSRQ measurements                                                                                           
  sinr                                                                                           as specified in TS 38.508-1 Table 4.6.3-172                   Integer value for SINR measurements                                                                                           
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  rsIndexResults-r16 SEQUENCE {                                                                                                                                                                                                                                                              
  resultsSSB-Indexes-r16 SEQUENCE (SIZE (1..maxNrofIndexesToReport2)) OF ResultsPerSSB-Index {   1 entry                                                                                                                                                                                     
  ResultsPerSSB-Index\[1\] SEQUENCE {                                                                                                                          entry 1                                                                                                                       
  ssb-Index                                                                                      SSB-Index                                                     an SS-Block within an SS-Burst                                                                                                
  ssb-Results SEQUENCE {                                                                                                                                       MeasQuantityResults                                                                                                           
  rsrp                                                                                           as specified in TS 38.508-1 Table 4.6.3-152                   Integer value for RSRP measurements                                                                                           
  rsrq                                                                                           as specified in TS 38.508-1 Table 4.6.3-153                   Integer value for RSRQ measurements                                                                                           
  sinr                                                                                           as specified in TS 38.508-1 Table 4.6.3-172                   Integer value for SINR measurements                                                                                           
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  locationInfo-r16                                                                               Not checked                                                                                                                                                                                 
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                                                                                                                                        
  measResultNeighCellListNR SEQUENCE (SIZE (1..maxFreq)) OF MeasResult2NR-r16 {                  1 entry                                                                                                                                                                                     
  MeasResult2NR-r16\[1\] SEQUENCE {                                                                                                                            entry 1                                                                                                                       
  ssbFrequency-r16                                                                               ARFCN-ValueNR                                                                                                                                                                               
  refFreqCSI-RS-r16                                                                              ARFCN-ValueNR                                                                                                                                                                               
  measResultList-r16 SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR SEQUENCE {               1 entry                                                       the log measurement results taken in the PCell upon detecting radio link failure or the source PCell upon handover failure.   
  MeasResultNR\[1\] SEQUENCE {                                                                                                                                 entry 1                                                                                                                       
  physCellId                                                                                     PCI of NR Cell 2                                                                                                                                                                            
  measResult SEQUENCE {                                                                                                                                                                                                                                                                      
  cellResults SEQUENCE {                                                                                                                                                                                                                                                                     
  resultsSSB-Cell SEQUENCE {                                                                                                                                                                                                                                                                 
  rsrp                                                                                           (0..127)                                                                                                                                                                                    
  rsrq                                                                                           Not checked                                                                                                                                                                                 
  sinr                                                                                           Not checked                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                          
  resultsCSI-RS-Cell                                                                             Not checked                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                          
  rsIndexResults                                                                                 Not checked                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                          
  cgi-Info                                                                                       Not checked                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  numberOfConnFail-r16                                                                           Integer between 1-8                                                                                                                                                                         
  perRAInfoList-r16                                                                              Not checked                                                                                                                                                                                 
  timeSinceFailure-r16                                                                           Not checked                                                                                                                                                                                 
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          
  }                                                                                                                                                                                                                                                                                          

###### 8.1.6.1.4.7 Connection Establishment Failure / Logging and reporting / Reporting of Inter-frequency measurements

##### 8.1.6.1.4.7.1 Test Purpose (TP) {#test-purpose-tp-81 .H6}

##### (1) {#section-155 .H6}

**with** { UE has connection establishment failure information available
with the inter-frequency measurement result }

**ensure that** {

**when** { UE receives a UEInformationRequest message with
connEstFailReportReq set to true }

**then** { UE sends a UEInformationResponse message containing the
measurement result for inter-frequency neighbouring cell }

}

##### 8.1.6.1.4.7.2 Conformance requirements {#conformance-requirements-83 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.7, 5.7.10.3 and 6.2.2. Unless
otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *connEstFailReportReq* is set to *true* and the UE has connection
establishment failure or connection resume failure information in
*VarConnEstFailReport* and if the RPLMN is equal to *plmn-Identity*
stored in *VarConnEstFailReport*:

2\> set *timeSinceFailure* in *VarConnEstFailReport* to the time that
elapsed since the last connection establishment failure or connection
resume failure in NR;

2\> set the *connEstFailReport* in the *UEInformationResponse* message
to the value of *connEstFailReport* in *VarConnEstFailReport*;

2\> discard the *connEstFailReport* from *VarConnEstFailReport* upon
successful delivery of the *UEInformationResponse* message confirmed by
lower layers;

\[TS 38.331, clause 5.3.3.7\]

The UE shall:

1\> if timer T300 expires:

...

2\> store the following connection establishment failure information in
the *VarConnEstFailReport* by setting its fields as follows:

...

3\> if available, set the *measResultNeighCells,* in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements for at most the following number of neighbouring
cells: 6 intra-frequency and 3 inter-frequency neighbours per frequency
as well as 3 inter-RAT neighbours, per frequency/ set of frequencies per
RAT and according to the following:

4\> for each neighbour cell included, include the optional fields that
are available;

NOTE 2: The UE includes the latest results of the available measurements
as used for cell reselection evaluation, which are performed in
accordance with the performance requirements as specified in TS 38.133
\[14\].

\[TS 38.331, clause 6.2.2\]

##### -- UEInformationResponse {#ueinformationresponse-1 .H6}

The *UEInformationResponse* message is used by the UE to transfer
information requested by the network.

...

+----------------------------------------------------------------------+
| *ConnEstFailReport field descriptions*                               |
+======================================================================+
| ***measResultFailedCell***                                           |
|                                                                      |
| ***This field refers to the last measurement results taken in the    |
| cell, where connection establishment failure or connection resume    |
| failure happened.***                                                 |
+----------------------------------------------------------------------+
| ***measResultNeighCells***                                           |
|                                                                      |
| This field refers to the neighbour cell measurements when            |
| ***connection establishment failure or connection resume failure     |
| happened.***                                                         |
+----------------------------------------------------------------------+
| ***numberOfConnFail***                                               |
|                                                                      |
| This field is used to indicate the latest number of consecutive      |
| failed RRCSetup or RRCResume procedures in the same cell independent |
| of RRC state transition.                                             |
+----------------------------------------------------------------------+
| ***numberOfPreamblesSent***                                          |
|                                                                      |
| This field is used to indicate the number of random access preambles |
| that were transmitted.                                               |
+----------------------------------------------------------------------+
| ***timeSinceFailure***                                               |
|                                                                      |
| This field is used to indicate the time that elapsed since the       |
| connection (establishment or resume) failure. ***Value in seconds.   |
| The maximum value 172800 means 172800s or longer.***                 |
+----------------------------------------------------------------------+

##### 8.1.6.1.4.7.3 Test description {#test-description-79 .H6}

##### 8.1.6.1.4.7.3.1 Pre-test conditions {#pre-test-conditions-80 .H6}

##### System Simulator: {#system-simulator-59 .H6}

\- NR Cell 1 and NR Cell 3

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-68 .H6}

\- None.

##### Preamble: {#preamble-68 .H6}

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], subclause
4.4A, on NR Cell 1.

##### 8.1.6.1.4.7.3.2 Test procedure sequence {#test-procedure-sequence-80 .H6}

Tables 8.1.6.1.4.7.3.2-1/2 illustrate the downlink power levels and
other changing parameters to be applied for the cells at various time
instants of the test execution. Row marked \"T0\" denotes the initial
conditions after preamble, while columns marked \"T1\" is to be applied
subsequently. The exact instants on which these values shall be applied
are described in the texts in this clause.

Table 8.1.6.1.4.7.3.2-1: Time instances of cell power level and
parameter changes (FR1)

+----------+----------+---------+----------+----------+----------+
|          | P        | Unit    | NR Cell  | NR Cell  | Remark   |
|          | arameter |         | 1        | 3        |          |
+==========+==========+=========+==========+==========+==========+
| T0       | SS/PBCH  | dBm/SCS | -85      | "Off"    | Only NR  |
|          |          |         |          |          | Cell 1   |
|          | SSS EPRE |         |          |          | is       |
|          |          |         |          |          | av       |
|          |          |         |          |          | ailable. |
|          |          |         |          |          |          |
|          |          |         |          |          | (NOTE    |
|          |          |         |          |          | 1).      |
+----------+----------+---------+----------+----------+----------+
| T1       | SS/PBCH  | dBm/SCS | -85      | -91      | The      |
|          |          |         |          |          | power    |
|          | SSS EPRE |         |          |          | level    |
|          |          |         |          |          | values   |
|          |          |         |          |          | are      |
|          |          |         |          |          | assigned |
|          |          |         |          |          | to       |
|          |          |         |          |          | satisfy  |
|          |          |         |          |          | R~NR     |
|          |          |         |          |          | Cell\ 1~ |
|          |          |         |          |          | \>       |
|          |          |         |          |          | R~NRC    |
|          |          |         |          |          | ell\ 3~. |
+----------+----------+---------+----------+----------+----------+
| NOTE 1:  |          |         |          |          |          |
| Power    |          |         |          |          |          |
| level    |          |         |          |          |          |
| "Off" is |          |         |          |          |          |
| defined  |          |         |          |          |          |
| in TS    |          |         |          |          |          |
| 38.508-1 |          |         |          |          |          |
| \[4\],   |          |         |          |          |          |
| Table    |          |         |          |          |          |
| 6.       |          |         |          |          |          |
| 2.2.1-3. |          |         |          |          |          |
+----------+----------+---------+----------+----------+----------+

Table 8.1.6.1.4.7.3.2-2: Time instances of cell power level and
parameter changes (FR2)

+----------+----------+---------+----------+----------+----------+
|          | P        | Unit    | NR Cell  | NR Cell  | Remark   |
|          | arameter |         | 1        | 3        |          |
+==========+==========+=========+==========+==========+==========+
| T0       | SS/PBCH  | dBm/SCS | -82      | "Off"    | Only NR  |
|          |          |         |          |          | Cell 1   |
|          | SSS EPRE |         |          |          | is       |
|          |          |         |          |          | av       |
|          |          |         |          |          | ailable. |
|          |          |         |          |          |          |
|          |          |         |          |          | (NOTE    |
|          |          |         |          |          | 1).      |
+----------+----------+---------+----------+----------+----------+
| T1       | SS/PBCH  | dBm/SCS | -82      | -91      | The      |
|          |          |         |          |          | power    |
|          | SSS EPRE |         |          |          | level    |
|          |          |         |          |          | values   |
|          |          |         |          |          | are      |
|          |          |         |          |          | assigned |
|          |          |         |          |          | to       |
|          |          |         |          |          | satisfy  |
|          |          |         |          |          | R~NR     |
|          |          |         |          |          | Cell\ 1~ |
|          |          |         |          |          | \>       |
|          |          |         |          |          | R~NRC    |
|          |          |         |          |          | ell\ 3~. |
+----------+----------+---------+----------+----------+----------+
| NOTE 1:  |          |         |          |          |          |
| Power    |          |         |          |          |          |
| level    |          |         |          |          |          |
| "Off" is |          |         |          |          |          |
| defined  |          |         |          |          |          |
| in TS    |          |         |          |          |          |
| 38.508-1 |          |         |          |          |          |
| \[4\],   |          |         |          |          |          |
| Table    |          |         |          |          |          |
| 6.2.     |          |         |          |          |          |
| 2.2.2-2. |          |         |          |          |          |
+----------+----------+---------+----------+----------+----------+

Table 8.1.6.1.4.7.3.2-3: Main behaviour

  St      Procedure                                                                                                              Message Sequence   TP                                Verdict   
  ------- ---------------------------------------------------------------------------------------------------------------------- ------------------ --------------------------------- --------- ----
                                                                                                                                 U - S              Message                                     
  1       The SS changes NR Cell 1 and NR Cell 3 parameter according to the row \"T1\" in Table 8.1.6.1.4.7.3.2-1/2.             \-                 \-                                \-        \-
  2       The SS waits for 40s to ensure that the UE detects inter-frequency cell.                                               \-                 \-                                \-        \-
  3       Void                                                                                                                   \-                 \-                                \-        \-
  4       The SS transmits a *Paging* message.                                                                                   \<\--              NR RRC: *Paging*                  \-        \-
  5       The UE transmits an *RRCSetupRequest* message.                                                                         \--\>              NR RRC: *RRCSetupRequest*         \-        \-
  6       The SS waits for 2 sec to ensure that the UE detects T300 expiry.                                                      \-                 \-                                \-        \-
  7       Void                                                                                                                   \-                 \-                                \-        \-
  8-10    Steps 1 to 3 of the generic radio bearer establishment procedure in TS 38.508-1 \[4\], table 4.5.4.2-3 on NR Cell 1.   \-                 \-                                \-        \-
  11      The UE transmits an *RRCSetupComplete* message and a SERVICE REQUEST message on NR Cell 1.                             \--\>              NR RRC: *RRCSetupComplete*        \-        \-
  12-15   Steps 5 to 8 of the generic radio bearer establishment procedure in TS 38.508-1 \[4\], table 4.5.4.2-3 on NR Cell 1.   \-                 \-                                \-        \-
  16      The SS sends a *UEInformationRequest* message to get *connEstFailReportReq*.                                           \<\--              NR RRC: *UEInformationRequest*    \-        \-
  17      Check: Does the UE send a *UEInformationResponse message with connEstFailReport on NR Cell 1?*                         \--\>              NR RRC: *UEInformationResponse*   1         P

##### 8.1.6.1.4.7.3.3 Specific message contents {#specific-message-contents-81 .H6}

Table 8.1.6.1.4.7.3.3-1: RRCSetupComplete (step 11, Table
8.1.6.1.4.7.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition CEF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                

Table 8.1.6.1.4.7.3.3-2: Void

Table 8.1.6.1.4.7.3.3-3: UEInformationResponse (step 17, Table
8.1.6.1.4.7.3.2-3)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                
  ---------------------------------------------------------------------------------- ------------------------------------------------------------- --------------------------------- -----------
  Information Element                                                                Value/remark                                                  Comment                           Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                           
  criticalExtensions CHOICE {                                                                                                                                                        
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                               
  connEstFailReport-r16 SEQUENCE {                                                                                                                                                   
  measResultFailedCell-r16 SEQUENCE {                                                                                                                                                
  cgi-Info SEQUENCE {                                                                                                                              Information of NR Cell 1          
  plmn-Identity-r16                                                                  the same MCC and MNC stored in EFIMSI on the test USIM card                                     
  cellIdentity-r16                                                                   NR Cell 1                                                                                       
  trackingAreaCode-r16                                                               1                                                                                               
  }                                                                                                                                                                                  
  measResult-r16 SEQUENCE {                                                                                                                                                          
  cellResults-r16 SEQUENCE {                                                                                                                       Measurement result of NR Cell 1   
  resultsSSB-Cell-r16 SEQUENCE {                                                                                                                                                     
  rsrp                                                                               (0..127)                                                                                        
  rsrq                                                                               (0..127)                                                                                        
  sinr                                                                               Not checked                                                                                     
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  
  rsIndexResults-r16                                                                 Not checked                                                                                     
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  
  locationInfo-r16                                                                   Not checked                                                                                     
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                                
  measResultNeighCellListNR SEQUENCE (SIZE (1..maxFreq)) OF MeasResult2NR-r16 {      1 entry                                                                                         
  MeasResult2NR-r16\[1\] SEQUENCE {                                                                                                                entry 1                           
  ssbFrequency-r16                                                                   ARFCN-ValueNR for SSB of NR Cell 3                                                              
  refFreqCSI-RS-r16                                                                  Not checked                                                                                     
  measResultList-r16 SEQUENCE (SIZE (1..maxCellReport)) OF MeasResultNR SEQUENCE {   1 entry                                                                                         
  MeasResultNR\[1\] SEQUENCE {                                                                                                                     entry 1                           
  physCellId                                                                         PCI of NR Cell 3                                                                                
  measResult SEQUENCE {                                                                                                                                                              
  cellResults SEQUENCE {                                                                                                                                                             
  resultsSSB-Cell SEQUENCE {                                                                                                                                                         
  rsrp                                                                               (0..127)                                                                                        
  rsrq                                                                               Not checked                                                                                     
  sinr                                                                               Not checked                                                                                     
  }                                                                                                                                                                                  
  resultsCSI-RS-Cell                                                                 Not checked                                                                                     
  }                                                                                                                                                                                  
  rsIndexResults                                                                     Not checked                                                                                     
  }                                                                                                                                                                                  
  cgi-Info                                                                           Not checked                                                                                     
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  
  numberOfConnFail-r16                                                               Integer between 1-8                                                                             
  perRAInfoList-r16                                                                  Not checked                                                                                     
  timeSinceFailure-r16                                                               Any allowed value                                                                               
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  
  }                                                                                                                                                                                  

###### 8.1.6.1.4.8 Connection Establishment Failure / Logging and reporting / RACH failure report

##### 8.1.6.1.4.8.1 Test Purpose (TP) {#test-purpose-tp-82 .H6}

##### (1) {#section-156 .H6}

**with** { UE having previously failed the random access procedure where
contention resolution was not successful for any of the transmitted
preambles }

**ensure that** {

**when** { UE receives UEInformationRequest message with
connEstFailReportReq set to true }

**then** { UE transmits UEInformationResponse message with a
connEstFailReport including the perRAInfoList }

}

##### 8.1.6.1.4.8.2 Conformance requirements {#conformance-requirements-84 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.7, 5.7.10.3, 5.7.10.4, 5.7.10.5
and 6.2.2. Unless otherwise stated these are Rel-16 requirements.

\[TS 38.331, clause 5.7.10.3\]

1\> if timer T300 expires:

...

2\> store the following connection establishment failure information in
the *VarConnEstFailReport* by setting its fields as follows:

...

3\> set *perRAInfoList* to indicate the performed random access
procedure related information as specified in 5.7.10.5;

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *connEstFailReportReq* is set to *true* and the UE has connection
establishment failure or connection resume failure information in
*VarConnEstFailReport* and if the RPLMN is equal to *plmn-Identity*
stored in *VarConnEstFailReport*:

2\> set *timeSinceFailure* in *VarConnEstFailReport* to the time that
elapsed since the last connection establishment failure or connection
resume failure in NR;

2\> set the *connEstFailReport* in the *UEInformationResponse* message
to the value of *connEstFailReport* in *VarConnEstFailReport*;

2\> discard the *connEstFailReport* from *VarConnEstFailReport* upon
successful delivery of the *UEInformationResponse* message confirmed by
lower layers; \[TS 38.331, clause 5.7.10.5\]

The UE shall set the content in *ra-InformationCommon* as follows:

...

1\> set the parameters associated to individual random-access attempt in
the chronological order of attempts in the *perRAInfoList* as follows:

2\> if the random-access resource used is associated to a SS/PBCH block,
set the associated random-access parameters for the successive
random-access attempts associated to the same SS/PBCH block for one or
more random-access attempts as follows:

3\> set the *ssb-Index* to include the SS/PBCH block index associated to
the used random-access resource;

3\> set the *numberOfPreamblesSentOnSSB* to indicate the number of
successive random-access attempts associated to the SS/PBCH block;

3\> for each random-access attempt performed on the random-access
resource, include the following parameters in the chronological order of
the random-access attempt:

4\> if the random-access attempt is performed on the contention based
random-access resource and if *raPurpose* is not equal to
\'*requestForOtherSI*\', include *contentionDetected* as follows:

5\> if contention resolution was not successful as specified in TS
38.321 \[6\] for the transmitted preamble:

6\> set the contentionDetected to true;

5\> else:

6\> set the contentionDetected to false;

4\> if the random-access attempt is performed on the contention based
random-access resource; or

4\> if the random-access attempt is performed on the contention free
random-access resource and if the random-access procedure was initiated
due to the PDCCH ordering:

5\> if the SS/PBCH block RSRP of the SS/PBCH block corresponding to the
random-access resource used in the random-access attempt is above
*rsrp-ThresholdSSB*:

6\> set the dlRSRPAboveThreshold to true;

5\> else:

6\> set the dlRSRPAboveThreshold to false;

2\> else if the random-access resource used is associated to a CSI-RS,
set the associated random-access parameters for the successive
random-access attempts associated to the same CSI-RS for one or more
random-access attempts as follows:

3\> set the *csi-RS-Index* to include the CSI-RS index associated to the
used random-access resource;

3\> set the *numberOfPreamblesSentOnCSI-RS* to indicate the number of
successive random-access attempts associated to the CSI-RS.

\[TS 38.331, clause 6.2.2\]

##### -- UEInformationResponse {#ueinformationresponse-2 .H6}

The *UEInformationResponse* message is used by the UE to transfer
information requested by the network.

...

+----------------------------------------------------------------------+
| *UEInformationResponse-IEs* field descriptions                       |
+======================================================================+
| ***logMeasReport***                                                  |
|                                                                      |
| This field is used to provide the measurement results stored by the  |
| UE associated to logged MDT.                                         |
+----------------------------------------------------------------------+
| ***measResultIdleEUTRA***                                            |
|                                                                      |
| ***EUTRA measurement results performed during RRC\_INACTIVE or       |
| RRC\_IDLE.***                                                        |
+----------------------------------------------------------------------+
| ***measResultIdleNR***                                               |
|                                                                      |
| ***NR measurement results performed during RRC\_INACTIVE or          |
| RRC\_IDLE.***                                                        |
+----------------------------------------------------------------------+
| ***ra-Report***                                                      |
|                                                                      |
| This field is used to provide the list of RA reports that is stored  |
| by the UE for the past up to maxRAReport-r16 number of successful    |
| random access procedures.                                            |
+----------------------------------------------------------------------+
| ***rlf-Report***                                                     |
|                                                                      |
| This field is used to indicate the RLF report related contents.      |
+----------------------------------------------------------------------+

...

+----------------------------------------------------------------------+
| *RA-Report* field descriptions                                       |
+======================================================================+
| ***absoluteFrequencyPointA***                                        |
|                                                                      |
| This field indicates the absolute frequency position of the          |
| reference resource block (Common RB 0).                              |
+----------------------------------------------------------------------+
| ***cellID***                                                         |
|                                                                      |
| This field indicates the CGI of the cell in which the associated     |
| random access procedure was performed.                               |
+----------------------------------------------------------------------+
| ***contentionDetected***                                             |
|                                                                      |
| **This field is used to indicate that contention was detected for    |
| the transmitted preamble in the given random access attempt or not.  |
| This field is not included when the UE performs random access        |
| attempt is using contention free random-access resources or when the |
| *raPurpose* is set to *requestForOtherSI*.**                         |
+----------------------------------------------------------------------+
| ***csi-RS-Index***                                                   |
|                                                                      |
| This field is used to indicate the CSI-RS index corresponding to the |
| random access attempt.                                               |
+----------------------------------------------------------------------+
| ***dlRSRPAboveThreshold***                                           |
|                                                                      |
| This field is used to indicate whether the DL beam (SSB) quality     |
| associated to the random access attempt was above or below the       |
| threshold (rsrp-ThresholdSSB in beamFailureRecoveryConfig in UL BWP  |
| configuration of UL BWP selected for random access procedure         |
| initiated for beam failure recovery; Otherwise, rsrp-ThresholdSSB in |
| rach-ConfigCommon in UL BWP configuration of UL BWP selected for     |
| random access procedure.                                             |
+----------------------------------------------------------------------+
| ***locationAndBandwidth***                                           |
|                                                                      |
| Frequency domain location and bandwidth of the bandwidth part        |
| associated to the random-access resources used by the UE.            |
+----------------------------------------------------------------------+
| *numberOfPreamblesSentOn**CSI-RS***                                  |
|                                                                      |
| This field is used to indicate the total number of successive RA     |
| preambles that were transmitted on the corresponding CSI-RS.         |
+----------------------------------------------------------------------+
| ***numberOfPreamblesSentOnSSB***                                     |
|                                                                      |
| This field is used to indicate the total number of successive RA     |
| preambles that were transmitted on the corresponding SS/PBCH block.  |
+----------------------------------------------------------------------+
| ***perRAAttemptInfoList***                                           |
|                                                                      |
| This field provides detailed information about a random access       |
| attempt.                                                             |
+----------------------------------------------------------------------+
| ***perRAInfoList***                                                  |
|                                                                      |
| This field provides detailed information about each of the random    |
| access attempts in the chronological order of the random access      |
| attempts.                                                            |
+----------------------------------------------------------------------+
| per***RACSI-RSInfoList***                                            |
|                                                                      |
| This field provides detailed information about the successive random |
| access attempts associated to the same CSI-RS.                       |
+----------------------------------------------------------------------+
| ***perRASSBInfoList***                                               |
|                                                                      |
| This field provides detailed information about the successive random |
| access attempts associated to the same SS/PBCH block.                |
+----------------------------------------------------------------------+
| ***raPurpose***                                                      |
|                                                                      |
| This field is used to indicate the RA scenario for which the RA      |
| report entry is triggered. The RA accesses associated to Initial     |
| access from RRC\_IDLE, transition from RRC-INACTIVE and the MSG3     |
| based SI request are indicated using the indicator                   |
| \'accessRelated\'. The indicator *beamFailureRecovery* is used in    |
| case of beam failure recovery failure in the SpCell \[3\]. The       |
| indicator *reconfigurationWithSync* is used if the UE executes a     |
| reconfiguration with sync. The indicator *ulUnSynchronized* is used  |
| if the random access procedure is initiated in a SpCell by DL or UL  |
| data arrival during RRC\_CONNECTED when the timeAlignmentTimer is    |
| not running in the PTAG or in a serving cell by a PDCCH order \[3\]. |
| The indicator *schedulingRequestFailure* is used in case of SR       |
| failures \[3\]. The indicator *noPUCCHResourceAvailable* is used     |
| when the UE has no valid SR PUCCH resources configured \[3\]. The    |
| indicator *requestForOtherSI* is used for MSG1 based on demand SI    |
| request.                                                             |
+----------------------------------------------------------------------+
| ***ra-InformationCommon***                                           |
|                                                                      |
| ***This field is used to indicate the common random-access related   |
| information between* RA-report *and* RLF-report*. For RA report,     |
| this field is mandatory presented. For* RLF-report*, this field is   |
| optionally included when c*onnectionFailureType *is set to \'hof\'   |
| or when* connectionFailureType *is set to \'rlf\' and the* rlf-Cause |
| *equals to \'randomAccessProblem\' or \'beamRecoveryFailure\';       |
| otherwise this field is absent.***                                   |
+----------------------------------------------------------------------+
| ***ssb-Index***                                                      |
|                                                                      |
| This field is used to indicate the SS/PBCH index of the SS/PBCH      |
| block corresponding to the random access attempt.                    |
+----------------------------------------------------------------------+
| ***subcarrierSpacing***                                              |
|                                                                      |
| Subcarrier spacing used in the BWP associated to the random-access   |
| resources used by the UE.                                            |
+----------------------------------------------------------------------+

...

##### 8.1.6.1.4.8.3 Test description {#test-description-80 .H6}

##### 8.1.6.1.4.8.3.1 Pre-test conditions {#pre-test-conditions-81 .H6}

##### System Simulator: {#system-simulator-60 .H6}

\- NR Cell 1

\- System information combination NR-1 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2.

##### UE: {#ue-69 .H6}

\- None.

##### Preamble: {#preamble-69 .H6}

\- The UE is in state 1N-A on Cell 1 as defined in TS 38.508-1 \[4\],
subclause 4.4A.

##### 8.1.6.1.4.8.3.2 Test procedure sequence {#test-procedure-sequence-81 .H6}

Table 8.1.6.1.4.8.3.2-1: Main behaviour

+-----+--------------+--------------+--------------+---------+----+
| St  | Procedure    | Message      | TP           | Verdict |    |
|     |              | Sequence     |              |         |    |
+=====+==============+==============+==============+=========+====+
|     |              | U - S        | Message      |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1   | SS is        | \-           | \-           | \-      | \- |
|     | configured   |              |              |         |    |
|     | to not       |              |              |         |    |
|     | transmit MAC |              |              |         |    |
|     | control      |              |              |         |    |
|     | element and  |              |              |         |    |
|     | ignore       |              |              |         |    |
|     | subsequent   |              |              |         |    |
|     | RACH         |              |              |         |    |
|     | attempts     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1A  | The SS       | \<\--        | NR RRC:      | \-      | \- |
|     | transmits a  |              | *Paging*     |         |    |
|     | *Paging*     |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1B  | The UE       | \--\>        | NR RRC:      | \-      | \- |
|     | transmits an |              | *RRCS        |         |    |
|     | *RRCS        |              | etupRequest* |         |    |
|     | etupRequest* |              |              |         |    |
|     | message.     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1C  | The SS waits | \-           | \-           | \-      | \- |
|     | for 2sec to  |              |              |         |    |
|     | ensure that  |              |              |         |    |
|     | the UE       |              |              |         |    |
|     | detects T300 |              |              |         |    |
|     | expiry.      |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 1D  | SS is        | \-           | \-           | \-      | \- |
|     | configured   |              |              |         |    |
|     | to transmit  |              |              |         |    |
|     | MAC control  |              |              |         |    |
|     | element with |              |              |         |    |
|     | matched UE   |              |              |         |    |
|     | Contention   |              |              |         |    |
|     | Resolution   |              |              |         |    |
|     | Identity     |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 2   | SS sends a   | \<\--        | NR RRC:      | \-      | \- |
|     | Paging       |              | *Paging*     |         |    |
|     | message to   |              |              |         |    |
|     | the UE on    |              |              |         |    |
|     | the          |              |              |         |    |
|     | appropriate  |              |              |         |    |
|     | paging       |              |              |         |    |
|     | block, and   |              |              |         |    |
|     | including    |              |              |         |    |
|     | the UE       |              |              |         |    |
|     | identity in  |              |              |         |    |
|     | one entry of |              |              |         |    |
|     | the IE       |              |              |         |    |
|     | pagin        |              |              |         |    |
|     | gRecordList. |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 3-9 | Steps 2-8 of | \-           | \-           | \-      | \- |
|     | generic test |              |              |         |    |
|     | procedure in |              |              |         |    |
|     | TS 38.508-1  |              |              |         |    |
|     | Table        |              |              |         |    |
|     | 4.5.4.2-3    |              |              |         |    |
|     | are          |              |              |         |    |
|     | performed on |              |              |         |    |
|     | NR Cell 1.   |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 10  | The SS sends | \<\--        | NR RRC:      | \-      | \- |
|     | a            |              |              |         |    |
|     | *UEInforma   |              | *UEInforma   |         |    |
|     | tionRequest* |              | tionRequest* |         |    |
|     | message to   |              |              |         |    |
|     | get          |              |              |         |    |
|     | *connEstFai  |              |              |         |    |
|     | lReportReq*. |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+
| 11  | Check: Does  | \--\>        | NR RRC:      | 1       | P  |
|     | the UE send  |              |              |         |    |
|     | a            |              | *UEInformat  |         |    |
|     | *UEInforma   |              | ionResponse* |         |    |
|     | tionResponse |              |              |         |    |
|     | message with |              |              |         |    |
|     | connEs       |              |              |         |    |
|     | tFailReport* |              |              |         |    |
|     | including    |              |              |         |    |
|     | the          |              |              |         |    |
|     | *p           |              |              |         |    |
|     | erRAInfoList |              |              |         |    |
|     | on NR Cell   |              |              |         |    |
|     | 1?*          |              |              |         |    |
+-----+--------------+--------------+--------------+---------+----+

##### 8.1.6.1.4.8.3.3 Specific message contents {#specific-message-contents-82 .H6}

Table 8.1.6.1.4.8.3.3-1: Void

Table 8.1.6.1.4.8.3.3-2: *UEInformationResponse* (step 11, Table
8.1.6.1.4.8.3.2-1)

  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                                                                   
  -------------------------------------------------------------------------------- ---------------------------------------------------- ------------------------------------------------------------------------------- ---------------
  **Information Element**                                                          **Value/remark**                                     **Comment**                                                                     **Condition**
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                                                              
  criticalExtensions CHOICE {                                                                                                                                                                                           
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                                                                  
  connEstFailReport-r16 SEQUENCE {                                                                                                                                                                                      
  measResultFailedCell-r16 SEQUENCE {                                                                                                                                                                                   
  cgi-Info SEQUENCE {                                                                                                                                                                                                   
  plmn-Identity-r16                                                                plmn-Identity within SIB1 broadcasted in NR Cell 1                                                                                   
  cellIdentity-r16                                                                 cellIdentity within SIB1 broadcasted in NR Cell 1    BIT STRING (SIZE (36))                                                          
  trackingAreaCode-r16                                                             Not checked                                          BIT STRING (SIZE (24))                                                          
  }                                                                                                                                                                                                                     
  measResult-r16 SEQUENCE {                                                                                                                                                                                             
  cellResults-r16                                                                  Any allowed value                                                                                                                    
  rsIndexResults-r16                                                               Any allowed value                                                                                                                    
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  locationInfo-r16                                                                 Not checked                                                                                                                          
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                                                                   
  measResultNeighCellListNR                                                        Not present                                                                                                                          
  measResultNeighCellListEUTRA                                                     Not present                                                                                                                          
  }                                                                                                                                                                                                                     
  numberOfConnFail-r16                                                             Any allowed value                                    INTEGER (1..8)                                                                  
  **perRAInfoList-r16 SEQUENCE (SIZE (1..200)) OF PerRAInfo-r16{**                 **1 entry**                                                                                                                          
  **PerRAInfo-r16\[1\] CHOICE {**                                                                                                       **entry 1**                                                                     
  **perRASSBInfoList-r16 SEQUENCE {**                                                                                                                                                                                   
  **ssb-Index-r16**                                                                **1**                                                                                                                                
  **numberOfPreamblesSentOnSSB-r16**                                               Any allowed value                                    **total number of successive RA preambles sent by the UE before T300 expiry**   
  **perRAAttemptInfoList-r16 SEQUENCE (SIZE (1..200)) OF PerRAAttemptInfo-r16{**                                                                                                                                        
  **PerRAAttemptInfo-r16\[x\] SEQUENCE {**                                                                                              **x ranges from 1 to numberOfPreamblesSentOnSSB-r16**                           
  **contentionDetected-r16**                                                       **true**                                             **entry 1**                                                                     
                                                                                   **false**                                            **entry 2 to x**                                                                
  **dlRSRPAboveThreshold-r16**                                                     **true**                                                                                                                             
  **}**                                                                                                                                                                                                                 
  **}**                                                                                                                                                                                                                 
  **}**                                                                                                                                                                                                                 
  **}**                                                                                                                                                                                                                 
  **}**                                                                                                                                                                                                                 
  timeSinceFailure-r16                                                             Any allowed value                                    INTEGER (0..172800)                                                             
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     
  }                                                                                                                                                                                                                     

###### 8.1.6.1.4.9 Connection Establishment Failure / Logging and reporting / T300 expiry / Multiple CEF reports

##### 8.1.6.1.4.9.1 Test Purpose (TP) {#test-purpose-tp-83 .H6}

##### (1) {#section-157 .H6}

**with** { UE having sent an *RRCSetupComplete* message with
*connEstFailInfoAvailable* }

**ensure that** {

**when** { T300 is expired and random access procedure failed on the
current cell with cell identity not equal to the cell identity stored in
*measResultFailedCell and* UE receives a *UEInformationRequest* message
with *connEstFailReportReq* set to true }

**then** { UE sends a *UEInformationResponse* message with
ConnEstFailReportList-r17 }

}

##### (2) {#section-158 .H6}

**with** { UE having sent an *RRCSetupComplete* message with
*connEstFailInfoAvailable* }

**ensure that** {

**when** { T300 is expired and random access procedure failed twice on
the same cell with cell identity of current cell is equal to the cell
identity stored in *measResultFailedCell and* UE receives a
*UEInformationRequest* message with *connEstFailReportReq* set to true }

**then** { UE sends a *UEInformationResponse* message with
ConnEstFailReportList-r17 and does not append the existing
*VarConnEstFailReportList* }

}

##### 8.1.6.1.4.9.2 Conformance requirements {#conformance-requirements-85 .H6}

References: The conformance requirements covered in the current TC are
specified in: TS 38.331, clauses 5.3.3.4, 5.3.3.7 and 5.7.10.3. Unless
otherwise stated these are Rel-17 requirements.

\[TS 38.331, clause 5.3.3.4\]

The UE shall perform the following actions upon reception of the
*RRCSetup*:

...

1\> set the content of *RRCSetupComplete* message as follows:

...

2\> if the UE has connection establishment failure or connection resume
failure information available in *VarConnEstFailReport* or
*VarConnEstFailReportList* and if the RPLMN is equal to *plmn-Identity*
stored in *VarConnEstFailReport* or in at least one of the entries of
*VarConnEstFailReportList*:

3\> include *connEstFailInfoAvailable in the RRCSetupComplete* message;

...

1\> submit the *RRCSetupComplete* message to lower layers for
transmission, upon which the procedure ends.

\[TS 38.331, clause 5.3.3.7\]

The UE shall:

1\> if timer T300 expires:

2\> reset MAC, release the MAC configuration and re-establish RLC for
all RBs that are established (except broadcast MRBs);

2\> if the UE supports RRC Connection Establishment failure with
temporary offset and the T300 has expired a consecutive
*connEstFailCount* times on the same cell for which
*connEstFailureControl* is included in *SIB1*:

3\> for a period as indicated by *connEstFailOffsetValidity*:

4\> use *connEstFailOffset* for the parameter *Qoffsettemp* for the
concerned cell when performing cell selection and reselection according
to TS 38.304 \[20\] and TS 36.304 \[27\];

NOTE 1: When performing cell selection, if no suitable or acceptable
cell can be found, it is up to UE implementation whether to stop using
*connEstFailOffset* for the parameter *Qoffsettemp* during
*connEstFailOffsetValidity* for the concerned cell.

2\> if the UE supports multiple CEF report:

3\> if the UE has connection establishment failure information or
connection resume failure information available in
*VarConnEstFailReport* and if the RPLMN is equal to *plmn-identity*
stored in *VarConnEstFailReport*; and

3\> if the cell identity of current cell is not equal to the cell
identity stored in *measResultFailedCell* in *VarConnEstFailReport* and
if the *maxCEFReport-r17* has not been reached:

4\> append the *VarConnEstFailReport* as a new entry in the
*VarConnEstFailReportList;*

2\> if the UE has connection establishment failure information or
connection resume failure information available in
*VarConnEstFailReport* and if the RPLMN is not equal to *plmn-identity*
stored in *VarConnEstFailReport*; or

2\> if the cell identity of current cell is not equal to the cell
identity stored in *measResultFailedCell* in *VarConnEstFailReport*:

3\> reset the *numberOfConnFail* to 0;

2\> if the UE supports multiple CEF report and if the UE has connection
establishment failure informatoin or connection resume failure
information available in *VarConnEstFailReportList* and if the RPLMN is
not equal to *plmn-identity* stored in any entry of
*VarConnEstFailReportList*:

3\> clear the content included in *VarConnEstFailReportList*;

2\> clear the content included in *VarConnEstFailReport* except for the
*numberOfConnFail*, if any;

2\> store the following connection establishment failure information in
the *VarConnEstFailReport* by setting its fields as follows:

3\> set the *plmn-Identity* to the PLMN selected by upper layers (see TS
24.501 \[23\]) from the PLMN(s) included in the *plmn-IdentityInfoList*
in *SIB1*;

3\> set the *measResultFailedCell* to include the global cell identity,
tracking area code, the cell level and SS/PBCH block level RSRP, and
RSRQ, and SS/PBCH block indexes, of the failed cell based on the
available SSB measurements collected up to the moment the UE detected
connection establishment failure;

3\> if available, set the *measResultNeighCells,* in order of decreasing
ranking-criterion as used for cell re-selection, to include neighbouring
cell measurements for at most the following number of neighbouring
cells: 6 intra-frequency and 3 inter-frequency neighbours per frequency
as well as 3 inter-RAT neighbours, per frequency/ set of frequencies per
RAT and according to the following:

4\> for each neighbour cell included, include the optional fields that
are available;

NOTE 2: The UE includes the latest results of the available measurements
as used for cell reselection evaluation, which are performed in
accordance with the performance requirements as specified in TS 38.133
\[14\].

3\> if available, set the *locationInfo* as follows:

4\> if available, set the *commonLocationInfo* to include the detailed
location information;

4\> if available, set the *bt-LocationInfo* to include the Bluetooth
measurement results, in order of decreasing RSSI for Bluetooth beacons;

4\> if available, set the *wlan-LocationInfo* to include the WLAN
measurement results, in order of decreasing RSSI for WLAN APs;

4\> if available, set the *sensor-LocationInfo* to include the sensor
measurement results as follows;

5\> if available, include the *sensor-MeasurementInformation*;

5\> if available, include the *sensor-MotionInformation*;

NOTE 3: Which location information related configuration is used by the
UE to make the *locationInfo available for inclusion in the
VarConnEstFailReport is left to UE implementation*.

3\> set *perRAInfoList* to indicate the performed random access
procedure related information as specified in 5.7.10.5;

3\> if the *numberOfConnFail* is smaller than 8:

4\> increment the *numberOfConnFail* by 1;

2\> inform upper layers about the failure to establish the RRC
connection, upon which the procedure ends;

The UE may discard the connection establishment failure or connection
resume failure information, i.e. release the UE variable
*VarConnEstFailReport and the UE variable VarConnEstFailReportList*, 48
hours after the last connection establishment failure is detected.

The L2 U2N Relay UE either indicates to upper layers (to trigger PC5
unicast link release) or sends Notification message to the connected L2
U2N Remote UE(s) in accordance with 5.8.9.10.

\[TS 38.331, clause 5.7.10.3\]

Upon receiving the *UEInformationRequest* message, the UE shall, only
after successful security activation:

...

1\> if *connEstFailReportReq* is set to *true* and the UE has connection
establishment failure or connection resume failure information in
*VarConnEstFailReport* or *VarConnEstFailReportList* and if the RPLMN is
equal to *plmn-Identity* stored in *VarConnEstFailReport* or in at least
one of the entries of *VarConnEstFailReportList*:

2\> set *timeSinceFailure* in *VarConnEstFailReport* to the time that
elapsed since the last connection establishment failure or connection
resume failure in NR;

2\> set the *connEstFailReport* in the *UEInformationResponse* message
to the value of *connEstFailReport* in *VarConnEstFailReport*;

2\> if the UE supports multiple CEF report:

3\> for each *connEstFailReport* in the *connEstFailReportList* in
*VarConnEstFailReportList*:

4\> set *timeSinceFailure* to the time that elapsed since the associated
connection establishment failure or connection resume failure in NR;

2\> for each *connEstFailReport* in the *connEstFailReportList* in the
*UEInformationResponse* message, set the value to the value of
*connEstFailReport* in *VarConnEstFailReport* in
*VarConnEstFailReportList*;

2\> discard the *connEstFailReport* from *VarConnEstFailReport* and
*VarConnEstFailReportList* upon successful delivery of the
*UEInformationResponse* message confirmed by lower layers;

...

1\> else:

2\> submit the *UEInformationResponse* message to lower layers for
transmission via SRB1.

##### 8.1.6.1.4.9.3 Test description {#test-description-81 .H6}

##### 8.1.6.1.4.9.3.1 Pre-test conditions {#pre-test-conditions-82 .H6}

##### System Simulator: {#system-simulator-61 .H6}

\- NR Cell 1 and NR Cell 3.

\- System information combination NR-4 as defined in TS 38.508-1 \[4\]
clause 4.4.3.1.2 is used in NR cells.

##### UE: {#ue-70 .H6}

\- None.

##### Preamble: {#preamble-70 .H6}

\- The UE is in state 1N-A as defined in TS 38.508-1 \[4\], subclause
4.4A, on NR Cell 1.

##### 8.1.6.1.4.9.3.2 Test procedure sequence {#test-procedure-sequence-82 .H6}

Table 8.1.6.1.4.9.3.2-1/2 illustrates the downlink power levels and
other changing parameters to be applied for the NR cells at various time
instants of the test execution. The exact instants on which these values
shall be applied are described in the texts in this clause. The
configuration \"T0\" indicates the initial conditions. Subsequent
configurations marked \"T1\" are applied at the points indicated in the
Main behaviour description in Table 8.1.6.1.4.9.3.2-3.

Table 8.1.6.1.4.9.3.2-1: Time instances of cell power level and
parameter changes for FR1

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 3 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -88       | Off       | The power |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | values    |
|    |           |         |           |           | are       |
|    |           |         |           |           | assigned  |
|    |           |         |           |           | to ensure |
|    |           |         |           |           | the UE    |
|    |           |         |           |           | r         |
|    |           |         |           |           | egistered |
|    |           |         |           |           | on NR     |
|    |           |         |           |           | Cell 1.   |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -88       | -78       | The power |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | values    |
|    |           |         |           |           | are       |
|    |           |         |           |           | assigned  |
|    |           |         |           |           | to        |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | R~NR\     |
|    |           |         |           |           |  Cell\ 1~ |
|    |           |         |           |           | \<        |
|    |           |         |           |           | R~NR\     |
|    |           |         |           |           | Cell\ 3~. |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.6.1.4.9.3.2-2: Time instances of cell power level and
parameter changes for FR2

+----+-----------+---------+-----------+-----------+-----------+
|    | Parameter | Unit    | NR Cell 1 | NR Cell 3 | Remark    |
+====+===========+=========+===========+===========+===========+
| T0 | SS/PBCH   | dBm/SCS | -91       | Off       | The power |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | values    |
|    |           |         |           |           | are       |
|    |           |         |           |           | assigned  |
|    |           |         |           |           | to ensure |
|    |           |         |           |           | the UE    |
|    |           |         |           |           | r         |
|    |           |         |           |           | egistered |
|    |           |         |           |           | on NR     |
|    |           |         |           |           | Cell 1.   |
+----+-----------+---------+-----------+-----------+-----------+
| T1 | SS/PBCH   | dBm/SCS | -91       | -82       | The power |
|    |           |         |           |           | level     |
|    | SSS EPRE  |         |           |           | values    |
|    |           |         |           |           | are       |
|    |           |         |           |           | assigned  |
|    |           |         |           |           | to        |
|    |           |         |           |           | satisfy   |
|    |           |         |           |           | R~NR\     |
|    |           |         |           |           |  Cell\ 1~ |
|    |           |         |           |           | \<        |
|    |           |         |           |           | R~NR\     |
|    |           |         |           |           | Cell\ 3~. |
+----+-----------+---------+-----------+-----------+-----------+

Table 8.1.6.1.4.9.3.2-3: Main behaviour

+-------+-------------+-------------+-------------+---------+----+
| St    | Procedure   | Message     | TP          | Verdict |    |
|       |             | Sequence    |             |         |    |
+=======+=============+=============+=============+=========+====+
|       |             | U - S       | Message     |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 1     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 2     | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 3     | The SS      | \-          | \-          | \-      | \- |
|       | waits for   |             |             |         |    |
|       | 2sec to     |             |             |         |    |
|       | ensure that |             |             |         |    |
|       | the UE      |             |             |         |    |
|       | detects     |             |             |         |    |
|       | T300        |             |             |         |    |
|       | expiry.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 4     | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 5-11  | Steps 2 to  | \-          | *-*         | \-      | \- |
|       | 8 of        |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | described   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] table |             |             |         |    |
|       | 4.5.4.2-3:  |             |             |         |    |
|       | NR          |             |             |         |    |
|       | RRC         |             |             |         |    |
|       | \_CONNECTED |             |             |         |    |
|       | are         |             |             |         |    |
|       | performed.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 12    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *           |         |    |
|       | RRCRelease  |             | RRCRelease* |         |    |
|       | message on  |             |             |         |    |
|       | NR Cell 1.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 13    | The SS      | \-          | \-          | \-      | \- |
|       | changes NR  |             |             |         |    |
|       | Cell 3 SS   |             |             |         |    |
|       | PBCH SSS    |             |             |         |    |
|       | EPRE level  |             |             |         |    |
|       | according   |             |             |         |    |
|       | to the row  |             |             |         |    |
|       | \"T1\" in   |             |             |         |    |
|       | table       |             |             |         |    |
|       | 8.1.6.1.4   |             |             |         |    |
|       | .9.3.2-1/2. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 14    | Wait for    | \-          | \-          | \-      | \- |
|       | 66\[FR1\]   |             |             |         |    |
|       | /258\[FR2\] |             |             |         |    |
|       | seconds to  |             |             |         |    |
|       | allow UE to |             |             |         |    |
|       | recognise   |             |             |         |    |
|       | the change. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| \-    | The         | \-          | \-          | \-      | \- |
|       | following   |             |             |         |    |
|       | messages    |             |             |         |    |
|       | are to be   |             |             |         |    |
|       | observed on |             |             |         |    |
|       | NR Cell 3   |             |             |         |    |
|       | unless      |             |             |         |    |
|       | explicitly  |             |             |         |    |
|       | stated      |             |             |         |    |
|       | otherwise.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 15    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 16    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 17    | The SS      | \-          | \-          | \-      | \- |
|       | waits for   |             |             |         |    |
|       | 2sec to     |             |             |         |    |
|       | ensure that |             |             |         |    |
|       | the UE      |             |             |         |    |
|       | detects     |             |             |         |    |
|       | T300        |             |             |         |    |
|       | expiry.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 18    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 19    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 20    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSetup*  |         |    |
|       | an          |             |             |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 21    | Check: Does | \--\>       | NR RRC:     | 1       | P  |
|       | the UE      |             | *RRCSet     |         |    |
|       | transmit an |             | upComplete* |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             | 5GMM:       |         |    |
|       | message     |             | SERVICE     |         |    |
|       | including   |             | REQUEST     |         |    |
|       | *con        |             |             |         |    |
|       | nEstFailInf |             |             |         |    |
|       | oAvailable* |             |             |         |    |
|       | IE set it   |             |             |         |    |
|       | to *true*?  |             |             |         |    |
|       | UE          |             |             |         |    |
|       | initiates   |             |             |         |    |
|       | the session |             |             |         |    |
|       | management  |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | by          |             |             |         |    |
|       | including   |             |             |         |    |
|       | the SERVICE |             |             |         |    |
|       | REQUEST     |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 22-25 | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | radio       |             |             |         |    |
|       | bearer      |             |             |         |    |
|       | es          |             |             |         |    |
|       | tablishment |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] table |             |             |         |    |
|       | 4.5.4.2-3.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 26-27 | Void        | \-          | *-*         | \-      | \- |
+-------+-------------+-------------+-------------+---------+----+
| 28    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | RRCRelease  |         |    |
|       | an          |             |             |         |    |
|       | RRCRelease  |             |             |         |    |
|       | message     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 29    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 30    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 31    | The SS      | \-          | \-          | \-      | \- |
|       | waits for   |             |             |         |    |
|       | 2sec to     |             |             |         |    |
|       | ensure that |             |             |         |    |
|       | the UE      |             |             |         |    |
|       | detects     |             |             |         |    |
|       | T300        |             |             |         |    |
|       | expiry.     |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 32    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits a |             | *Paging*    |         |    |
|       | *Paging*    |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 33    | The UE      | \--\>       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSe      |         |    |
|       | an          |             | tupRequest* |         |    |
|       | *RRCSe      |             |             |         |    |
|       | tupRequest* |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 34    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | transmits   |             | *RRCSetup*  |         |    |
|       | an          |             |             |         |    |
|       | *RRCSetup*  |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 35    | Check: Does | \--\>       | NR RRC:     | 2       | P  |
|       | the UE      |             | *RRCSet     |         |    |
|       | transmit an |             | upComplete* |         |    |
|       | *RRCSet     |             |             |         |    |
|       | upComplete* |             | 5GMM:       |         |    |
|       | message     |             | SERVICE     |         |    |
|       | including   |             | REQUEST     |         |    |
|       | *con        |             |             |         |    |
|       | nEstFailInf |             |             |         |    |
|       | oAvailable* |             |             |         |    |
|       | IE set it   |             |             |         |    |
|       | to *true*?  |             |             |         |    |
|       | UE          |             |             |         |    |
|       | initiates   |             |             |         |    |
|       | the session |             |             |         |    |
|       | management  |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | by          |             |             |         |    |
|       | including   |             |             |         |    |
|       | the SERVICE |             |             |         |    |
|       | REQUEST     |             |             |         |    |
|       | message.    |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 36-39 | Steps 5 to  | \-          | *-*         | \-      | \- |
|       | 8 of the    |             |             |         |    |
|       | generic     |             |             |         |    |
|       | radio       |             |             |         |    |
|       | bearer      |             |             |         |    |
|       | es          |             |             |         |    |
|       | tablishment |             |             |         |    |
|       | procedure   |             |             |         |    |
|       | in TS       |             |             |         |    |
|       | 38.508-1    |             |             |         |    |
|       | \[4\] table |             |             |         |    |
|       | 4.5.4.2-3.  |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 40    | The SS      | \<\--       | NR RRC:     | \-      | \- |
|       | sends a     |             | *UEInformat |         |    |
|       | *UEInformat |             | ionRequest* |         |    |
|       | ionRequest* |             |             |         |    |
|       | message to  |             |             |         |    |
|       | get         |             |             |         |    |
|       | *           |             |             |         |    |
|       | connEstFail |             |             |         |    |
|       | ReportReq*. |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+
| 41    | Check: Does | \--\>       | NR RRC:     | 1,2     | P  |
|       | the UE send |             | *           |         |    |
|       | a           |             | UEInformati |         |    |
|       | *UEInformat |             | onResponse* |         |    |
|       | ionResponse |             |             |         |    |
|       | message     |             |             |         |    |
|       | with        |             |             |         |    |
|       | ConnE       |             |             |         |    |
|       | stFailRepor |             |             |         |    |
|       | tList-r17?* |             |             |         |    |
+-------+-------------+-------------+-------------+---------+----+

##### 8.1.6.1.4.9.3.3 Specific message contents {#specific-message-contents-83 .H6}

Table 8.1.6.1.4.9.3.3-1: *RRCSetupComplete* (steps 7, 21 and 35, Table
8.1.6.1.4.9.3.2-3)

  ---------------------------------------------------- ------------------------------------------------- --------- -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-22                                                               
  Information Element                                  Value/remark                                      Comment   Condition
  RRCSetupComplete ::= SEQUENCE {                                                                                  
  criticalExtensions CHOICE {                                                                                      
  rrcSetupComplete SEQUENCE {                                                                                      
  nonCriticalExtension SEQUENCE {                                                                                  
  ue-MeasurementsAvailable-r16                         UE-MeasurementsAvailable-r16 with condition CEF             
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  }                                                                                                                
  ---------------------------------------------------- ------------------------------------------------- --------- -----------

Table 8.1.6.1.4.9.3.3-2: *UEInformationResponse* (step 41, Table
8.1.6.1.4.9.3.2-3)

  -------------------------------------------------------------------------------------------- ---------------------------------------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                        
  Information Element                                                                          Value/remark                                         Comment                  Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                   
  criticalExtensions CHOICE {                                                                                                                                                
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                       
  nonCriticalExtension SEQUENCE {                                                                                                                                            
  connEstFailReportList-r17 SEQUENCE (SIZE (1..maxCEFReport-r17)) OF ConnEstFailReport-r16 {   2 entries                                                                     
  ConnEstFailReport-r16\[1\] SEQUENCE {                                                                                                             entry 1                  
  measResultFailedCell-r16 SEQUENCE {                                                                                                                                        
  cgi-Info SEQUENCE {                                                                                                                                                        
  plmn-Identity-r16                                                                            plmn-Identity within SIB1 broadcasted in NR Cell 1                            
  cellIdentity-r16                                                                             cellIdentity within SIB1 broadcasted in NR Cell 1    BIT STRING (SIZE (36))   
  trackingAreaCode-r16                                                                         Not present or any allowed value                     BIT STRING (SIZE (24))   
  }                                                                                                                                                                          
  measResult-r16 SEQUENCE {                                                                                                                                                  
  cellResults-r16                                                                              Not present or any allowed value                                              
  rsIndexResults-r16                                                                           Not present or any allowed value                                              
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  locationInfo-r16                                                                             Not present or any allowed value                                              
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                        
  measResultNeighCellListNR                                                                    Not present                                                                   
  measResultNeighCellListEUTRA                                                                 Not present                                                                   
  }                                                                                                                                                                          
  numberOfConnFail-r16                                                                         Any allowed value                                    INTEGER (1..8)           
  perRAInfoList-r16                                                                            Any allowed value                                                             
  timeSinceFailure-r16                                                                         Any allowed value                                    INTEGER (0..172800)      
  }                                                                                                                                                                          
  ConnEstFailReport-r16\[2\] SEQUENCE {                                                                                                             entry 2                  
  measResultFailedCell-r16 SEQUENCE {                                                                                                                                        
  cgi-Info SEQUENCE {                                                                                                                                                        
  plmn-Identity-r16                                                                            plmn-Identity within SIB1 broadcasted in NR Cell 3                            
  cellIdentity-r16                                                                             cellIdentity within SIB1 broadcasted in NR Cell 3    BIT STRING (SIZE (36))   
  trackingAreaCode-r16                                                                         Not present or any allowed value                     BIT STRING (SIZE (24))   
  }                                                                                                                                                                          
  measResult-r16 SEQUENCE {                                                                                                                                                  
  cellResults-r16                                                                              Not present or any allowed value                                              
  rsIndexResults-r16                                                                           Not present or any allowed value                                              
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  locationInfo-r16                                                                             Not present or any allowed value                                              
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                        
  measResultNeighCellListNR                                                                    Not present                                                                   
  measResultNeighCellListEUTRA                                                                 Not present                                                                   
  }                                                                                                                                                                          
  numberOfConnFail-r16                                                                         Any allowed value                                    INTEGER (1..8)           
  perRAInfoList-r16                                                                            Any allowed value                                                             
  timeSinceFailure-r16                                                                         Any allowed value                                    INTEGER (0..172800)      
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  -------------------------------------------------------------------------------------------- ---------------------------------------------------- ------------------------ -----------

Table 8.1.6.1.4.9.3.3-3: xx??

  -------------------------------------------------------------------------------------------- ---------------------------------------------------- ------------------------ -----------
  Derivation Path: TS 38.508-1 \[4\], Table 4.6.1-32B                                                                                                                        
  Information Element                                                                          Value/remark                                         Comment                  Condition
  UEInformationResponse-r16 ::= SEQUENCE {                                                                                                                                   
  criticalExtensions CHOICE {                                                                                                                                                
  ueInformationResponse-r16 SEQUENCE {                                                                                                                                       
  nonCriticalExtension SEQUENCE {                                                                                                                                            
  connEstFailReportList-r17 SEQUENCE (SIZE (1..maxCEFReport-r17)) OF ConnEstFailReport-r16 {   2 entries                                                                     
  ConnEstFailReport-r16\[1\] SEQUENCE {                                                                                                             entry 1                  
  measResultFailedCell-r16 SEQUENCE {                                                                                                                                        
  cgi-Info SEQUENCE {                                                                                                                                                        
  plmn-Identity-r16                                                                            plmn-Identity within SIB1 broadcasted in NR Cell 1                            
  cellIdentity-r16                                                                             cellIdentity within SIB1 broadcasted in NR Cell 1    BIT STRING (SIZE (36))   
  trackingAreaCode-r16                                                                         Not present or any allowed value                     BIT STRING (SIZE (24))   
  }                                                                                                                                                                          
  measResult-r16 SEQUENCE {                                                                                                                                                  
  cellResults-r16                                                                              Not present or any allowed value                                              
  rsIndexResults-r16                                                                           Not present or any allowed value                                              
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  locationInfo-r16                                                                             Not present or any allowed value                                              
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                        
  measResultNeighCellListNR                                                                    Not present                                                                   
  measResultNeighCellListEUTRA                                                                 Not present                                                                   
  }                                                                                                                                                                          
  numberOfConnFail-r16                                                                         Any allowed value                                    INTEGER (1..8)           
  perRAInfoList-r16                                                                            Any allowed value                                                             
  timeSinceFailure-r16                                                                         Any allowed value                                    INTEGER (0..172800)      
  }                                                                                                                                                                          
  ConnEstFailReport-r16\[2\] SEQUENCE {                                                                                                             entry 2                  
  measResultFailedCell-r16 SEQUENCE {                                                                                                                                        
  cgi-Info SEQUENCE {                                                                                                                                                        
  plmn-Identity-r16                                                                            plmn-Identity within SIB1 broadcasted in NR Cell 3                            
  cellIdentity-r16                                                                             cellIdentity within SIB1 broadcasted in NR Cell 3    BIT STRING (SIZE (36))   
  trackingAreaCode-r16                                                                         Not present or any allowed value                     BIT STRING (SIZE (24))   
  }                                                                                                                                                                          
  measResult-r16 SEQUENCE {                                                                                                                                                  
  cellResults-r16                                                                              Not present or any allowed value                                              
  rsIndexResults-r16                                                                           Not present or any allowed value                                              
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  locationInfo-r16                                                                             Not present or any allowed value                                              
  measResultNeighCells-r16 SEQUENCE {                                                                                                                                        
  measResultNeighCellListNR                                                                    Not present                                                                   
  measResultNeighCellListEUTRA                                                                 Not present                                                                   
  }                                                                                                                                                                          
  numberOfConnFail-r16                                                                         Any allowed value                                    INTEGER (1..8)           
  perRAInfoList-r16                                                                            Any allowed value                                                             
  timeSinceFailure-r16                                                                         Any allowed value                                    INTEGER (0..172800)      
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  }                                                                                                                                                                          
  -------------------------------------------------------------------------------------------- ---------------------------------------------------- ------------------------ -----------
